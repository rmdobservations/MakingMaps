parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({6:[function(require,module,exports) {

},{}],43:[function(require,module,exports) {
"use strict";function t(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.inherits=t,exports.getUid=o;let e=0;function o(t){return t.ol_uid||(t.ol_uid=++e)}const r=exports.VERSION="5.0.3";
},{}],15:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./util.js");const r=function(r){const s=e.VERSION.split("-")[0];this.message="Assertion failed. See https://openlayers.org/en/"+s+"/doc/errors/#"+r+" for details.",this.code=r,this.name="AssertionError"};(0,e.inherits)(r,Error),exports.default=r;
},{"./util.js":43}],100:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ADD:"add",REMOVE:"remove"};
},{}],96:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={PROPERTYCHANGE:"propertychange"};
},{}],74:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clear=n,exports.getValues=e,exports.isEmpty=o;const t=exports.assign="function"==typeof Object.assign?Object.assign:function(t,n){if(null==t)throw new TypeError("Cannot convert undefined or null to object");const e=Object(t);for(let t=1,n=arguments.length;t<n;++t){const n=arguments[t];if(null!=n)for(const t in n)n.hasOwnProperty(t)&&(e[t]=n[t])}return e};function n(t){for(const n in t)delete t[n]}function e(t){const n=[];for(const e in t)n.push(t[e]);return n}function o(t){let n;for(n in t)return!1;return!n}
},{}],84:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bindListener=t,exports.findListener=n,exports.getListeners=r,exports.listen=i,exports.listenOnce=s,exports.unlisten=c,exports.unlistenByKey=u,exports.unlistenAll=d;var e=require("./obj.js");function t(e){const t=function(t){const n=e.listener,r=e.bindTo||e.target;return e.callOnce&&u(e),n.call(r,t)};return e.boundListener=t,t}function n(e,t,n,r){let o;for(let l=0,i=e.length;l<i;++l)if((o=e[l]).listener===t&&o.bindTo===n)return r&&(o.deleteIndex=l),o}function r(e,t){const n=e.ol_lm;return n?n[t]:void 0}function o(e){let t=e.ol_lm;return t||(t=e.ol_lm={}),t}function l(t,n){const o=r(t,n);if(o){for(let r=0,l=o.length;r<l;++r)t.removeEventListener(n,o[r].boundListener),(0,e.clear)(o[r]);o.length=0;const r=t.ol_lm;r&&(delete r[n],0===Object.keys(r).length&&delete t.ol_lm)}}function i(e,r,l,i,s){const c=o(e);let u=c[r];u||(u=c[r]=[]);let d=n(u,l,i,!1);return d?s||(d.callOnce=!1):(d={bindTo:i,callOnce:!!s,listener:l,target:e,type:r},e.addEventListener(r,t(d)),u.push(d)),d}function s(e,t,n,r){return i(e,t,n,r,!0)}function c(e,t,o,l){const i=r(e,t);if(i){const e=n(i,o,l,!0);e&&u(e)}}function u(t){if(t&&t.target){t.target.removeEventListener(t.type,t.boundListener);const n=r(t.target,t.type);if(n){const e="deleteIndex"in t?t.deleteIndex:n.indexOf(t);-1!==e&&n.splice(e,1),0===n.length&&l(t.target,t.type)}(0,e.clear)(t)}}function d(e){const t=o(e);for(const n in t)l(e,n)}
},{"./obj.js":74}],103:[function(require,module,exports) {
"use strict";function e(){return!0}function t(){return!1}function r(){}Object.defineProperty(exports,"__esModule",{value:!0}),exports.TRUE=e,exports.FALSE=t,exports.UNDEFINED=r;
},{}],17:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./functions.js");const s=function(){};s.prototype.disposed_=!1,s.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},s.prototype.disposeInternal=e.UNDEFINED,exports.default=s;
},{"./functions.js":103}],123:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.stopPropagation=o,exports.preventDefault=e;const t=function(t){this.propagationStopped,this.type=t,this.target=null};function o(t){t.stopPropagation()}function e(t){t.preventDefault()}t.prototype.preventDefault=t.prototype.stopPropagation=function(){this.propagationStopped=!0},exports.default=t;
},{}],121:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util.js"),t=require("../Disposable.js"),i=l(t),s=require("../events.js"),n=require("../functions.js"),r=require("../events/Event.js"),o=l(r);function l(e){return e&&e.__esModule?e:{default:e}}const h=function(){i.default.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}};(0,e.inherits)(h,i.default),h.prototype.addEventListener=function(e,t){let i=this.listeners_[e];i||(i=this.listeners_[e]=[]),-1===i.indexOf(t)&&i.push(t)},h.prototype.dispatchEvent=function(e){const t="string"==typeof e?new o.default(e):e,i=t.type;t.target=this;const s=this.listeners_[i];let r;if(s){i in this.dispatching_||(this.dispatching_[i]=0,this.pendingRemovals_[i]=0),++this.dispatching_[i];for(let e=0,i=s.length;e<i;++e)if(!1===s[e].call(this,t)||t.propagationStopped){r=!1;break}if(--this.dispatching_[i],0===this.dispatching_[i]){let e=this.pendingRemovals_[i];for(delete this.pendingRemovals_[i];e--;)this.removeEventListener(i,n.UNDEFINED);delete this.dispatching_[i]}return r}},h.prototype.disposeInternal=function(){(0,s.unlistenAll)(this)},h.prototype.getListeners=function(e){return this.listeners_[e]},h.prototype.hasListener=function(e){return e?e in this.listeners_:Object.keys(this.listeners_).length>0},h.prototype.removeEventListener=function(e,t){const i=this.listeners_[e];if(i){const s=i.indexOf(t);e in this.pendingRemovals_?(i[s]=n.UNDEFINED,++this.pendingRemovals_[e]):(i.splice(s,1),0===i.length&&delete this.listeners_[e])}},exports.default=h;
},{"../util.js":43,"../Disposable.js":17,"../events.js":84,"../functions.js":103,"../events/Event.js":123}],110:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={CHANGE:"change",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",ERROR:"error",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout",MOUSEUP:"mouseup",MOUSEWHEEL:"mousewheel",MSPOINTERDOWN:"MSPointerDown",RESIZE:"resize",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",WHEEL:"wheel"};
},{}],32:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.unByKey=l;var e=require("./util.js"),t=require("./events.js"),n=require("./events/EventTarget.js"),r=o(n),i=require("./events/EventType.js"),s=o(i);function o(e){return e&&e.__esModule?e:{default:e}}const u=function(){r.default.call(this),this.revision_=0};function l(e){if(Array.isArray(e))for(let n=0,r=e.length;n<r;++n)(0,t.unlistenByKey)(e[n]);else(0,t.unlistenByKey)(e)}(0,e.inherits)(u,r.default),u.prototype.changed=function(){++this.revision_,this.dispatchEvent(s.default.CHANGE)},u.prototype.dispatchEvent,u.prototype.getRevision=function(){return this.revision_},u.prototype.on=function(e,n){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=(0,t.listen)(this,e[s],n);return i}return(0,t.listen)(this,e,n)},u.prototype.once=function(e,n){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=(0,t.listenOnce)(this,e[s],n);return i}return(0,t.listenOnce)(this,e,n)},u.prototype.un=function(e,n){if(Array.isArray(e))for(let r=0,i=e.length;r<i;++r)(0,t.unlisten)(this,e[r],n);else(0,t.unlisten)(this,e,n)},exports.default=u;
},{"./util.js":43,"./events.js":84,"./events/EventTarget.js":121,"./events/EventType.js":110}],31:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getChangeEventType=c;var t=require("./util.js"),e=require("./ObjectEventType.js"),s=l(e),i=require("./Observable.js"),n=l(i),o=require("./events/Event.js"),r=l(o),u=require("./obj.js");function l(t){return t&&t.__esModule?t:{default:t}}const a=function(t,e,s){r.default.call(this,t),this.key=e,this.oldValue=s};(0,t.inherits)(a,r.default);const h=function(e){n.default.call(this),(0,t.getUid)(this),this.values_={},void 0!==e&&this.setProperties(e)};(0,t.inherits)(h,n.default);const p={};function c(t){return p.hasOwnProperty(t)?p[t]:p[t]="change:"+t}h.prototype.get=function(t){let e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},h.prototype.getKeys=function(){return Object.keys(this.values_)},h.prototype.getProperties=function(){return(0,u.assign)({},this.values_)},h.prototype.notify=function(t,e){let i;i=c(t),this.dispatchEvent(new a(i,t,e)),i=s.default.PROPERTYCHANGE,this.dispatchEvent(new a(i,t,e))},h.prototype.set=function(t,e,s){if(s)this.values_[t]=e;else{const s=this.values_[t];this.values_[t]=e,s!==e&&this.notify(t,s)}},h.prototype.setProperties=function(t,e){for(const s in t)this.set(s,t[s],e)},h.prototype.unset=function(t,e){if(t in this.values_){const s=this.values_[t];delete this.values_[t],e||this.notify(t,s)}},exports.default=h;
},{"./util.js":43,"./ObjectEventType.js":96,"./Observable.js":32,"./events/Event.js":123,"./obj.js":74}],16:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollectionEvent=void 0;var t=require("./util.js"),e=require("./AssertionError.js"),r=a(e),i=require("./CollectionEventType.js"),n=a(i),s=require("./Object.js"),o=a(s),h=require("./events/Event.js"),u=a(h);function a(t){return t&&t.__esModule?t:{default:t}}const p={LENGTH:"length"},l=exports.CollectionEvent=function(t,e){u.default.call(this,t),this.element=e};(0,t.inherits)(l,u.default);const c=function(t,e){o.default.call(this);const r=e||{};if(this.unique_=!!r.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()};(0,t.inherits)(c,o.default),c.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},c.prototype.extend=function(t){for(let e=0,r=t.length;e<r;++e)this.push(t[e]);return this},c.prototype.forEach=function(t){const e=this.array_;for(let r=0,i=e.length;r<i;++r)t(e[r],r,e)},c.prototype.getArray=function(){return this.array_},c.prototype.item=function(t){return this.array_[t]},c.prototype.getLength=function(){return this.get(p.LENGTH)},c.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new l(n.default.ADD,e))},c.prototype.pop=function(){return this.removeAt(this.getLength()-1)},c.prototype.push=function(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()},c.prototype.remove=function(t){const e=this.array_;for(let r=0,i=e.length;r<i;++r)if(e[r]===t)return this.removeAt(r)},c.prototype.removeAt=function(t){const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new l(n.default.REMOVE,e)),e},c.prototype.setAt=function(t,e){const r=this.getLength();if(t<r){this.unique_&&this.assertUnique_(e,t);const r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new l(n.default.REMOVE,r)),this.dispatchEvent(new l(n.default.ADD,e))}else{for(let e=r;e<t;++e)this.insertAt(e,void 0);this.insertAt(t,e)}},c.prototype.updateLength_=function(){this.set(p.LENGTH,this.array_.length)},c.prototype.assertUnique_=function(t,e){for(let i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new r.default(58)},exports.default=c;
},{"./util.js":43,"./AssertionError.js":15,"./CollectionEventType.js":100,"./Object.js":31,"./events/Event.js":123}],83:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.assert=s;var e=require("./AssertionError.js"),r=t(e);function t(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!e)throw new r.default(t)}
},{"./AssertionError.js":15}],191:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};
},{}],190:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};
},{}],90:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.boundingExtent=a,exports.buffer=i,exports.clone=c,exports.closestSquaredDistanceXY=f,exports.containsCoordinate=l,exports.containsExtent=p,exports.containsXY=x,exports.coordinateRelationship=d,exports.createEmpty=h,exports.createOrUpdate=m,exports.createOrUpdateEmpty=g,exports.createOrUpdateFromCoordinate=T,exports.createOrUpdateFromCoordinates=E,exports.createOrUpdateFromFlatCoordinates=M,exports.createOrUpdateFromRings=O,exports.equals=C,exports.extend=R,exports.extendCoordinate=F,exports.extendCoordinates=I,exports.extendFlatCoordinates=N,exports.extendRings=B,exports.extendXY=L,exports.forEachCorner=y,exports.getArea=U,exports.getBottomLeft=G,exports.getBottomRight=_,exports.getCenter=A,exports.getCorner=S,exports.getEnlargedArea=H,exports.getForViewAndSize=W,exports.getHeight=q,exports.getIntersectionArea=j,exports.getIntersection=V,exports.getMargin=b,exports.getSize=P,exports.getTopLeft=X,exports.getTopRight=Y,exports.getWidth=v,exports.intersects=z,exports.isEmpty=K,exports.returnOrUpdate=w,exports.scaleFromCenter=D,exports.intersectsSegment=k,exports.applyTransform=J;var t=require("./asserts.js"),e=require("./extent/Corner.js"),n=u(e),r=require("./extent/Relationship.js"),o=u(r);function u(t){return t&&t.__esModule?t:{default:t}}function a(t){const e=h();for(let n=0,r=t.length;n<r;++n)F(e,t[n]);return e}function s(t,e,n){return m(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),n)}function i(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function c(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function f(t,e,n){let r,o;return(r=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*r+(o=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0)*o}function l(t,e){return x(t,e[0],e[1])}function p(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function x(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function d(t,e){const n=t[0],r=t[1],u=t[2],a=t[3],s=e[0],i=e[1];let c=o.default.UNKNOWN;return s<n?c|=o.default.LEFT:s>u&&(c|=o.default.RIGHT),i<r?c|=o.default.BELOW:i>a&&(c|=o.default.ABOVE),c===o.default.UNKNOWN&&(c=o.default.INTERSECTING),c}function h(){return[1/0,1/0,-1/0,-1/0]}function m(t,e,n,r,o){return o?(o[0]=t,o[1]=e,o[2]=n,o[3]=r,o):[t,e,n,r]}function g(t){return m(1/0,1/0,-1/0,-1/0,t)}function T(t,e){const n=t[0],r=t[1];return m(n,r,n,r,e)}function E(t,e){return I(g(e),t)}function M(t,e,n,r,o){return N(g(o),t,e,n,r)}function O(t,e){return B(g(e),t)}function C(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function R(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function F(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function I(t,e){for(let n=0,r=e.length;n<r;++n)F(t,e[n]);return t}function N(t,e,n,r,o){for(;n<r;n+=o)L(t,e[n],e[n+1]);return t}function B(t,e){for(let n=0,r=e.length;n<r;++n)I(t,e[n]);return t}function L(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function y(t,e,n){let r;return(r=e.call(n,G(t)))?r:(r=e.call(n,_(t)))?r:(r=e.call(n,Y(t)))?r:(r=e.call(n,X(t)))||!1}function U(t){let e=0;return K(t)||(e=v(t)*q(t)),e}function G(t){return[t[0],t[1]]}function _(t){return[t[2],t[1]]}function A(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function S(e,r){let o;return r===n.default.BOTTOM_LEFT?o=G(e):r===n.default.BOTTOM_RIGHT?o=_(e):r===n.default.TOP_LEFT?o=X(e):r===n.default.TOP_RIGHT?o=Y(e):(0,t.assert)(!1,13),o}function H(t,e){const n=Math.min(t[0],e[0]),r=Math.min(t[1],e[1]);return(Math.max(t[2],e[2])-n)*(Math.max(t[3],e[3])-r)}function W(t,e,n,r,o){const u=e*r[0]/2,a=e*r[1]/2,s=Math.cos(n),i=Math.sin(n),c=u*s,f=u*i,l=a*s,p=a*i,x=t[0],d=t[1],h=x-c+p,g=x-c-p,T=x+c-p,E=x+c+p,M=d-f-l,O=d-f+l,C=d+f+l,R=d+f-l;return m(Math.min(h,g,T,E),Math.min(M,O,C,R),Math.max(h,g,T,E),Math.max(M,O,C,R),o)}function q(t){return t[3]-t[1]}function j(t,e){return U(V(t,e))}function V(t,e,n){const r=n||h();return z(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):g(r),r}function b(t){return v(t)+q(t)}function P(t){return[t[2]-t[0],t[3]-t[1]]}function X(t){return[t[0],t[3]]}function Y(t){return[t[2],t[3]]}function v(t){return t[2]-t[0]}function z(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function K(t){return t[2]<t[0]||t[3]<t[1]}function w(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function D(t,e){const n=(t[2]-t[0])/2*(e-1),r=(t[3]-t[1])/2*(e-1);t[0]-=n,t[2]+=n,t[1]-=r,t[3]+=r}function k(t,e,n){let r=!1;const u=d(t,e),a=d(t,n);if(u===o.default.INTERSECTING||a===o.default.INTERSECTING)r=!0;else{const s=t[0],i=t[1],c=t[2],f=t[3],l=e[0],p=e[1],x=n[0],d=n[1],h=(d-p)/(x-l);let m,g;a&o.default.ABOVE&&!(u&o.default.ABOVE)&&(r=(m=x-(d-f)/h)>=s&&m<=c),r||!(a&o.default.RIGHT)||u&o.default.RIGHT||(r=(g=d-(x-c)*h)>=i&&g<=f),r||!(a&o.default.BELOW)||u&o.default.BELOW||(r=(m=x-(d-i)/h)>=s&&m<=c),r||!(a&o.default.LEFT)||u&o.default.LEFT||(r=(g=d-(x-s)*h)>=i&&g<=f)}return r}function J(t,e,n){const r=[t[0],t[1],t[0],t[3],t[2],t[1],t[2],t[3]];return e(r,r,2),s([r[0],r[2],r[4],r[6]],[r[1],r[3],r[5],r[7]],n)}
},{"./asserts.js":83,"./extent/Corner.js":191,"./extent/Relationship.js":190}],192:[function(require,module,exports) {
"use strict";function t(t,e,n,o,r,l){const s=l||[];let c=0;for(let l=e;l<n;l+=o){const e=t[l],n=t[l+1];s[c++]=r[0]*e+r[2]*n+r[4],s[c++]=r[1]*e+r[3]*n+r[5]}return l&&s.length!=c&&(s.length=c),s}function e(t,e,n,o,r,l,s){const c=s||[],f=Math.cos(r),u=Math.sin(r),h=l[0],a=l[1];let g=0;for(let r=e;r<n;r+=o){const e=t[r]-h,n=t[r+1]-a;c[g++]=h+e*f-n*u,c[g++]=a+e*u+n*f;for(let e=r+2;e<r+o;++e)c[g++]=t[e]}return s&&c.length!=g&&(c.length=g),c}function n(t,e,n,o,r,l,s,c){const f=c||[],u=s[0],h=s[1];let a=0;for(let s=e;s<n;s+=o){const e=t[s]-u,n=t[s+1]-h;f[a++]=u+r*e,f[a++]=h+l*n;for(let e=s+2;e<s+o;++e)f[a++]=t[e]}return c&&f.length!=a&&(f.length=a),f}function o(t,e,n,o,r,l,s){const c=s||[];let f=0;for(let s=e;s<n;s+=o){c[f++]=t[s]+r,c[f++]=t[s+1]+l;for(let e=s+2;e<s+o;++e)c[f++]=t[e]}return s&&c.length!=f&&(c.length=f),c}Object.defineProperty(exports,"__esModule",{value:!0}),exports.transform2D=t,exports.rotate=e,exports.scale=n,exports.translate=o;
},{}],87:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.cosh=void 0,exports.clamp=e,exports.roundUpToPowerOfTwo=o,exports.squaredSegmentDistance=n,exports.squaredDistance=s,exports.solveLinearSystem=c,exports.toDegrees=u,exports.toRadians=a,exports.modulo=i,exports.lerp=f;var t=require("./asserts.js");function e(t,e,r){return Math.min(Math.max(t,e),r)}const r=exports.cosh=function(){let t;return t="cosh"in Math?Math.cosh:function(t){const e=Math.exp(t);return(e+1/e)/2}}();function o(e){return(0,t.assert)(0<e,29),Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function n(t,e,r,o,n,c){const u=n-r,a=c-o;if(0!==u||0!==a){const s=((t-r)*u+(e-o)*a)/(u*u+a*a);s>1?(r=n,o=c):s>0&&(r+=u*s,o+=a*s)}return s(t,e,r,o)}function s(t,e,r,o){const n=r-t,s=o-e;return n*n+s*s}function c(t){const e=t.length;for(let r=0;r<e;r++){let o=r,n=Math.abs(t[r][r]);for(let s=r+1;s<e;s++){const e=Math.abs(t[s][r]);e>n&&(n=e,o=s)}if(0===n)return null;const s=t[o];t[o]=t[r],t[r]=s;for(let o=r+1;o<e;o++){const n=-t[o][r]/t[r][r];for(let s=r;s<e+1;s++)r==s?t[o][s]=0:t[o][s]+=n*t[r][s]}}const r=new Array(e);for(let o=e-1;o>=0;o--){r[o]=t[o][e]/t[o][o];for(let n=o-1;n>=0;n--)t[n][e]-=t[n][o]*r[o]}return r}function u(t){return 180*t/Math.PI}function a(t){return t*Math.PI/180}function i(t,e){const r=t%e;return r*e<0?r+e:r}function f(t,e,r){return t+r*(e-t)}
},{"./asserts.js":83}],140:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};
},{}],154:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DEFAULT_RADIUS=void 0,exports.getDistance=n,exports.getLength=c,exports.getArea=u,exports.offset=h;var t=require("./math.js"),e=require("./geom/GeometryType.js"),a=s(e);function s(t){return t&&t.__esModule?t:{default:t}}const o=exports.DEFAULT_RADIUS=6371008.8;function n(e,a,s){const n=s||o,r=(0,t.toRadians)(e[1]),c=(0,t.toRadians)(a[1]),i=(c-r)/2,u=(0,t.toRadians)(a[0]-e[0])/2,h=Math.sin(i)*Math.sin(i)+Math.sin(u)*Math.sin(u)*Math.cos(r)*Math.cos(c);return 2*n*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))}function r(t,e){let a=0;for(let s=0,o=t.length;s<o-1;++s)a+=n(t[s],t[s+1],e);return a}function c(t,e){const s=e||{},n=s.radius||o,i=s.projection||"EPSG:3857",u=t.getType();u!==a.default.GEOMETRY_COLLECTION&&(t=t.clone().transform(i,"EPSG:4326"));let h,f,l,d,M,g,I=0;switch(u){case a.default.POINT:case a.default.MULTI_POINT:break;case a.default.LINE_STRING:case a.default.LINEAR_RING:I=r(h=t.getCoordinates(),n);break;case a.default.MULTI_LINE_STRING:case a.default.POLYGON:for(l=0,d=(h=t.getCoordinates()).length;l<d;++l)I+=r(h[l],n);break;case a.default.MULTI_POLYGON:for(l=0,d=(h=t.getCoordinates()).length;l<d;++l)for(M=0,g=(f=h[l]).length;M<g;++M)I+=r(f[M],n);break;case a.default.GEOMETRY_COLLECTION:{const a=t.getGeometries();for(l=0,d=a.length;l<d;++l)I+=c(a[l],e);break}default:throw new Error("Unsupported geometry type: "+u)}return I}function i(e,a){let s=0;const o=e.length;let n=e[o-1][0],r=e[o-1][1];for(let a=0;a<o;a++){const o=e[a][0],c=e[a][1];s+=(0,t.toRadians)(o-n)*(2+Math.sin((0,t.toRadians)(r))+Math.sin((0,t.toRadians)(c))),n=o,r=c}return s*a*a/2}function u(t,e){const s=e||{},n=s.radius||o,r=s.projection||"EPSG:3857",c=t.getType();c!==a.default.GEOMETRY_COLLECTION&&(t=t.clone().transform(r,"EPSG:4326"));let h,f,l,d,M,g,I=0;switch(c){case a.default.POINT:case a.default.MULTI_POINT:case a.default.LINE_STRING:case a.default.MULTI_LINE_STRING:case a.default.LINEAR_RING:break;case a.default.POLYGON:for(h=t.getCoordinates(),I=Math.abs(i(h[0],n)),l=1,d=h.length;l<d;++l)I-=Math.abs(i(h[l],n));break;case a.default.MULTI_POLYGON:for(l=0,d=(h=t.getCoordinates()).length;l<d;++l)for(f=h[l],I+=Math.abs(i(f[0],n)),M=1,g=f.length;M<g;++M)I-=Math.abs(i(f[M],n));break;case a.default.GEOMETRY_COLLECTION:{const a=t.getGeometries();for(l=0,d=a.length;l<d;++l)I+=u(a[l],e);break}default:throw new Error("Unsupported geometry type: "+c)}return I}function h(e,a,s,n){const r=n||o,c=(0,t.toRadians)(e[1]),i=(0,t.toRadians)(e[0]),u=a/r,h=Math.asin(Math.sin(c)*Math.cos(u)+Math.cos(c)*Math.sin(u)*Math.cos(s)),f=i+Math.atan2(Math.sin(s)*Math.sin(u)*Math.cos(c),Math.cos(u)-Math.sin(c)*Math.sin(h));return[(0,t.toDegrees)(f),(0,t.toDegrees)(h)]}
},{"./math.js":87,"./geom/GeometryType.js":140}],143:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const E={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},e=exports.METERS_PER_UNIT={};e[E.DEGREES]=2*Math.PI*6370997/360,e[E.FEET]=.3048,e[E.METERS]=1,e[E.USFEET]=1200/3937,exports.default=E;
},{}],157:[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../proj/Units.js");const n=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit};n.prototype.canWrapX=function(){return this.canWrapX_},n.prototype.getCode=function(){return this.code_},n.prototype.getExtent=function(){return this.extent_},n.prototype.getUnits=function(){return this.units_},n.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||e.METERS_PER_UNIT[this.units_]},n.prototype.getWorldExtent=function(){return this.worldExtent_},n.prototype.getAxisOrientation=function(){return this.axisOrientation_},n.prototype.isGlobal=function(){return this.global_},n.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},n.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},n.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},n.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},n.prototype.setWorldExtent=function(t){this.worldExtent_=t},n.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},n.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},exports.default=n;
},{"../proj/Units.js":143}],155:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PROJECTIONS=exports.WORLD_EXTENT=exports.EXTENT=exports.HALF_SIZE=exports.RADIUS=void 0,exports.fromEPSG4326=x,exports.toEPSG4326=P;var e=require("../util.js"),t=require("../math.js"),r=require("../proj/Projection.js"),o=i(r),n=require("../proj/Units.js"),s=i(n);function i(e){return e&&e.__esModule?e:{default:e}}const l=exports.RADIUS=6378137,u=exports.HALF_SIZE=Math.PI*l,E=exports.EXTENT=[-u,-u,u,u],c=exports.WORLD_EXTENT=[-180,-85,180,85];function a(e){o.default.call(this,{code:e,units:s.default.METERS,extent:E,global:!0,worldExtent:c,getPointResolution:function(e,r){return e/(0,t.cosh)(r[1]/l)}})}(0,e.inherits)(a,o.default);const p=exports.PROJECTIONS=[new a("EPSG:3857"),new a("EPSG:102100"),new a("EPSG:102113"),new a("EPSG:900913"),new a("urn:ogc:def:crs:EPSG:6.18:3:3857"),new a("urn:ogc:def:crs:EPSG::3857"),new a("http://www.opengis.net/gml/srs/epsg.xml#3857")];function x(e,t,r){const o=e.length,n=r>1?r:2;let s=t;void 0===s&&(s=n>2?e.slice():new Array(o));const i=u;for(let t=0;t<o;t+=n){s[t]=i*e[t]/180;let r=l*Math.log(Math.tan(Math.PI*(e[t+1]+90)/360));r>i?r=i:r<-i&&(r=-i),s[t+1]=r}return s}function P(e,t,r){const o=e.length,n=r>1?r:2;let s=t;void 0===s&&(s=n>2?e.slice():new Array(o));for(let t=0;t<o;t+=n)s[t]=180*e[t]/u,s[t+1]=360*Math.atan(Math.exp(e[t+1]/l))/Math.PI-90;return s}
},{"../util.js":43,"../math.js":87,"../proj/Projection.js":157,"../proj/Units.js":143}],156:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PROJECTIONS=exports.METERS_PER_UNIT=exports.EXTENT=exports.RADIUS=void 0;var e=require("../util.js"),r=require("../proj/Projection.js"),t=o(r),n=require("../proj/Units.js"),s=o(n);function o(e){return e&&e.__esModule?e:{default:e}}const u=exports.RADIUS=6378137,i=exports.EXTENT=[-180,-90,180,90],E=exports.METERS_PER_UNIT=Math.PI*u/180;function c(e,r){t.default.call(this,{code:e,units:s.default.DEGREES,extent:i,axisOrientation:r,global:!0,metersPerUnit:E,worldExtent:i})}(0,e.inherits)(c,t.default);const d=exports.PROJECTIONS=[new c("CRS:84"),new c("EPSG:4326","neu"),new c("urn:ogc:def:crs:EPSG::4326","neu"),new c("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new c("urn:ogc:def:crs:OGC:1.3:CRS84"),new c("urn:ogc:def:crs:OGC:2:84"),new c("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new c("urn:x-ogc:def:crs:EPSG:4326","neu")];
},{"../util.js":43,"../proj/Projection.js":157,"../proj/Units.js":143}],158:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clear=t,exports.get=r,exports.add=n;let e={};function t(){e={}}function r(t){return e[t]||null}function n(t,r){e[t]=r}
},{}],159:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clear=o,exports.add=r,exports.remove=n,exports.get=s;var e=require("../obj.js");let t={};function o(){t={}}function r(e,o,r){const n=e.getCode(),s=o.getCode();n in t||(t[n]={}),t[n][s]=r}function n(o,r){const n=o.getCode(),s=r.getCode(),i=t[n][s];return delete t[n][s],(0,e.isEmpty)(t[n])&&delete t[n],i}function s(e,o){let r;return e in t&&o in t[e]&&(r=t[e][o]),r}
},{"../obj.js":74}],88:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.METERS_PER_UNIT=void 0,exports.cloneTransform=E,exports.identityTransform=P,exports.addProjection=g,exports.addProjections=j,exports.get=x,exports.getPointResolution=m,exports.addEquivalentProjections=T,exports.addEquivalentTransforms=S,exports.clearAllProjections=v,exports.createProjection=R,exports.createTransformFromCoordinateTransform=_,exports.addCoordinateTransforms=h,exports.fromLonLat=q,exports.toLonLat=C,exports.equivalent=O,exports.getTransformFromProjections=G,exports.getTransform=U,exports.transform=y,exports.transformExtent=I,exports.transformWithProjections=M,exports.addCommon=N;var t=require("./sphere.js"),e=require("./extent.js"),r=require("./math.js"),o=require("./proj/epsg3857.js"),n=require("./proj/epsg4326.js"),s=require("./proj/Projection.js"),i=p(s),u=require("./proj/Units.js"),c=p(u),f=require("./proj/projections.js"),a=l(f),d=require("./proj/transforms.js");function l(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function p(t){return t&&t.__esModule?t:{default:t}}function E(t,e,r){let o;if(void 0!==e){for(let r=0,o=t.length;r<o;++r)e[r]=t[r];o=e}else o=t.slice();return o}function P(t,e,r){if(void 0!==e&&t!==e){for(let r=0,o=t.length;r<o;++r)e[r]=t[r];t=e}return t}function g(t){a.add(t.getCode(),t),(0,d.add)(t,t,E)}function j(t){t.forEach(g)}function x(t){let e=null;if(t instanceof i.default)e=t;else if("string"==typeof t){const r=t;e=a.get(r)}return e}function m(e,r,o,n){let s;const i=(e=x(e)).getPointResolutionFunc();if(i)s=i(r,o);else{if(e.getUnits()==c.default.DEGREES&&!n||n==c.default.DEGREES)s=r;else{const i=G(e,x("EPSG:4326"));let c=[o[0]-r/2,o[1],o[0]+r/2,o[1],o[0],o[1]-r/2,o[0],o[1]+r/2];c=i(c,c,2),s=((0,t.getDistance)(c.slice(0,2),c.slice(2,4))+(0,t.getDistance)(c.slice(4,6),c.slice(6,8)))/2;const f=n?u.METERS_PER_UNIT[n]:e.getMetersPerUnit();void 0!==f&&(s/=f)}}return s}function T(t){j(t),t.forEach(function(e){t.forEach(function(t){e!==t&&(0,d.add)(e,t,E)})})}function S(t,e,r,o){t.forEach(function(t){e.forEach(function(e){(0,d.add)(t,e,r),(0,d.add)(e,t,o)})})}function v(){a.clear(),(0,d.clear)()}function R(t,e){return t?"string"==typeof t?x(t):t:x(e)}function _(t){return function(e,r,o){const n=e.length,s=void 0!==o?o:2,i=void 0!==r?r:new Array(n);for(let r=0;r<n;r+=s){const o=t([e[r],e[r+1]]);i[r]=o[0],i[r+1]=o[1];for(let t=s-1;t>=2;--t)i[r+t]=e[r+t]}return i}}function h(t,e,r,o){const n=x(t),s=x(e);(0,d.add)(n,s,_(r)),(0,d.add)(s,n,_(o))}function q(t,e){return y(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")}function C(t,e){const o=y(t,void 0!==e?e:"EPSG:3857","EPSG:4326"),n=o[0];return(n<-180||n>180)&&(o[0]=(0,r.modulo)(n+180,360)-180),o}function O(t,e){if(t===e)return!0;const r=t.getUnits()===e.getUnits();if(t.getCode()===e.getCode())return r;return G(t,e)===E&&r}function G(t,e){const r=t.getCode(),o=e.getCode();let n=(0,d.get)(r,o);return n||(n=P),n}function U(t,e){return G(x(t),x(e))}function y(t,e,r){return U(e,r)(t,void 0,t.length)}function I(t,r,o){const n=U(r,o);return(0,e.applyTransform)(t,n)}function M(t,e,r){return G(e,r)(t)}function N(){T(o.PROJECTIONS),T(n.PROJECTIONS),S(n.PROJECTIONS,o.PROJECTIONS,o.fromEPSG4326,o.toEPSG4326)}exports.METERS_PER_UNIT=u.METERS_PER_UNIT,N();
},{"./sphere.js":154,"./extent.js":90,"./math.js":87,"./proj/epsg3857.js":155,"./proj/epsg4326.js":156,"./proj/Projection.js":157,"./proj/Units.js":143,"./proj/projections.js":158,"./proj/transforms.js":159}],105:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=e,exports.reset=n,exports.multiply=o,exports.set=s,exports.setFromArray=u,exports.apply=c,exports.rotate=i,exports.scale=p,exports.translate=a,exports.compose=f,exports.invert=x,exports.determinant=l;var t=require("./asserts.js");const r=new Array(6);function e(){return[1,0,0,1,0,0]}function n(t){return s(t,1,0,0,1,0,0)}function o(t,r){const e=t[0],n=t[1],o=t[2],s=t[3],u=t[4],c=t[5],i=r[0],p=r[1],a=r[2],f=r[3],x=r[4],l=r[5];return t[0]=e*i+o*p,t[1]=n*i+s*p,t[2]=e*a+o*f,t[3]=n*a+s*f,t[4]=e*x+o*l+u,t[5]=n*x+s*l+c,t}function s(t,r,e,n,o,s,u){return t[0]=r,t[1]=e,t[2]=n,t[3]=o,t[4]=s,t[5]=u,t}function u(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t}function c(t,r){const e=r[0],n=r[1];return r[0]=t[0]*e+t[2]*n+t[4],r[1]=t[1]*e+t[3]*n+t[5],r}function i(t,e){const n=Math.cos(e),u=Math.sin(e);return o(t,s(r,n,u,-u,n,0,0))}function p(t,e,n){return o(t,s(r,e,0,0,n,0,0))}function a(t,e,n){return o(t,s(r,1,0,0,1,e,n))}function f(t,r,e,n,o,s,u,c){const i=Math.sin(s),p=Math.cos(s);return t[0]=n*p,t[1]=o*i,t[2]=-n*i,t[3]=o*p,t[4]=u*n*p-c*n*i+r,t[5]=u*o*i+c*o*p+e,t}function x(r){const e=l(r);(0,t.assert)(0!==e,32);const n=r[0],o=r[1],s=r[2],u=r[3],c=r[4],i=r[5];return r[0]=u/e,r[1]=-o/e,r[2]=-s/e,r[3]=n/e,r[4]=(s*i-u*c)/e,r[5]=-(n*i-o*c)/e,r}function l(t){return t[0]*t[3]-t[1]*t[2]}
},{"./asserts.js":83}],111:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../Object.js"),o=f(e),n=require("../extent.js"),i=require("../functions.js"),r=require("../geom/flat/transform.js"),s=require("../proj.js"),p=require("../proj/Units.js"),u=f(p),c=require("../transform.js");function f(t){return t&&t.__esModule?t:{default:t}}const a=function(){o.default.call(this),this.extent_=(0,n.createEmpty)(),this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0};(0,t.inherits)(a,o.default);const l=(0,c.create)();a.prototype.clone=function(){},a.prototype.closestPointXY=function(t,e,o,n){},a.prototype.getClosestPoint=function(t,e){const o=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],o,1/0),o},a.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},a.prototype.computeExtent=function(t){},a.prototype.containsXY=i.FALSE,a.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),(0,n.returnOrUpdate)(this.extent_,t)},a.prototype.rotate=function(t,e){},a.prototype.scale=function(t,e,o){},a.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},a.prototype.getSimplifiedGeometry=function(t){},a.prototype.getType=function(){},a.prototype.applyTransform=function(t){},a.prototype.intersectsExtent=function(t){},a.prototype.translate=function(t,e){},a.prototype.transform=function(t,e){const o=(t=(0,s.get)(t)).getUnits()==u.default.TILE_PIXELS?function(o,i,p){const u=t.getExtent(),f=t.getWorldExtent(),a=(0,n.getHeight)(f)/(0,n.getHeight)(u);return(0,c.compose)(l,f[0],f[3],a,-a,0,0,0),(0,r.transform2D)(o,0,o.length,p,l,i),(0,s.getTransform)(t,e)(o,i,p)}:(0,s.getTransform)(t,e);return this.applyTransform(o),this},exports.default=a;
},{"../util.js":43,"../Object.js":31,"../extent.js":90,"../functions.js":103,"../geom/flat/transform.js":192,"../proj.js":88,"../proj/Units.js":143,"../transform.js":105}],209:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromString=void 0,exports.asString=s,exports.asArray=c,exports.normalize=l,exports.toString=a;var e=require("./asserts.js"),t=require("./math.js");const r=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,n=/^([a-z]*)$/i;function s(e){return"string"==typeof e?e:a(e)}function o(e){const t=document.createElement("div");if(t.style.color=e,""!==t.style.color){document.body.appendChild(t);const e=getComputedStyle(t).color;return document.body.removeChild(t),e}return""}const i=exports.fromString=function(){const e={};let t=0;return function(r){let n;if(e.hasOwnProperty(r))n=e[r];else{if(t>=1024){let r=0;for(const n in e)0==(3&r++)&&(delete e[n],--t)}n=u(r),e[r]=n,++t}return n}}();function c(e){return Array.isArray(e)?e:i(e)}function u(t){let s,i,c,u,a;if(n.exec(t)&&(t=o(t)),r.exec(t)){const e=t.length-1;let r;r=e<=4?1:2;const n=4===e||8===e;s=parseInt(t.substr(1+0*r,r),16),i=parseInt(t.substr(1+1*r,r),16),c=parseInt(t.substr(1+2*r,r),16),u=n?parseInt(t.substr(1+3*r,r),16):255,1==r&&(s=(s<<4)+s,i=(i<<4)+i,c=(c<<4)+c,n&&(u=(u<<4)+u)),a=[s,i,c,u/255]}else 0==t.indexOf("rgba(")?l(a=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((a=t.slice(4,-1).split(",").map(Number)).push(1),l(a)):(0,e.assert)(!1,14);return a}function l(e){return e[0]=(0,t.clamp)(e[0]+.5|0,0,255),e[1]=(0,t.clamp)(e[1]+.5|0,0,255),e[2]=(0,t.clamp)(e[2]+.5|0,0,255),e[3]=(0,t.clamp)(e[3],0,1),e}function a(e){let t=e[0];t!=(0|t)&&(t=t+.5|0);let r=e[1];r!=(0|r)&&(r=r+.5|0);let n=e[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+t+","+r+","+n+","+(void 0===e[3]?1:e[3])+")"}
},{"./asserts.js":83,"./math.js":87}],257:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.asColorLike=r,exports.isColorLike=t;var e=require("./color.js");function r(r){return t(r)?r:(0,e.toString)(r)}function t(e){return"string"==typeof e||e instanceof CanvasPattern||e instanceof CanvasGradient}
},{"./color.js":209}],93:[function(require,module,exports) {
"use strict";function e(e,t){const o=document.createElement("CANVAS");return e&&(o.width=e),t&&(o.height=t),o.getContext("2d")}function t(e){let t=e.offsetWidth;const o=getComputedStyle(e);return t+=parseInt(o.marginLeft,10)+parseInt(o.marginRight,10)}function o(e){let t=e.offsetHeight;const o=getComputedStyle(e);return t+=parseInt(o.marginTop,10)+parseInt(o.marginBottom,10)}function r(e,t){const o=t.parentNode;o&&o.replaceChild(e,t)}function n(e){return e&&e.parentNode?e.parentNode.removeChild(e):null}function i(e){for(;e.lastChild;)e.removeChild(e.lastChild)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createCanvasContext2D=e,exports.outerWidth=t,exports.outerHeight=o,exports.replaceNode=r,exports.removeNode=n,exports.removeChildren=i;
},{}],153:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getContext=w;const e=exports.ONE=1,t=exports.SRC_ALPHA=770,o=exports.COLOR_ATTACHMENT0=36064,E=exports.COLOR_BUFFER_BIT=16384,r=exports.TRIANGLES=4,s=exports.TRIANGLE_STRIP=5,T=exports.ONE_MINUS_SRC_ALPHA=771,p=exports.ARRAY_BUFFER=34962,x=exports.ELEMENT_ARRAY_BUFFER=34963,_=exports.STREAM_DRAW=35040,R=exports.STATIC_DRAW=35044,A=exports.DYNAMIC_DRAW=35048,S=exports.CULL_FACE=2884,n=exports.BLEND=3042,N=exports.STENCIL_TEST=2960,I=exports.DEPTH_TEST=2929,U=exports.SCISSOR_TEST=3089,L=exports.UNSIGNED_BYTE=5121,C=exports.UNSIGNED_SHORT=5123,M=exports.UNSIGNED_INT=5125,c=exports.FLOAT=5126,X=exports.RGBA=6408,i=exports.FRAGMENT_SHADER=35632,D=exports.VERTEX_SHADER=35633,F=exports.LINK_STATUS=35714,O=exports.LINEAR=9729,l=exports.TEXTURE_MAG_FILTER=10240,a=exports.TEXTURE_MIN_FILTER=10241,G=exports.TEXTURE_WRAP_S=10242,P=exports.TEXTURE_WRAP_T=10243,d=exports.TEXTURE_2D=3553,f=exports.TEXTURE0=33984,u=exports.CLAMP_TO_EDGE=33071,g=exports.COMPILE_STATUS=35713,B=exports.FRAMEBUFFER=36160,H=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function w(e,t){const o=H.length;for(let E=0;E<o;++E)try{const o=e.getContext(H[E],t);if(o)return o}catch(e){}return null}const b=exports.DEBUG=!0;let m,W,y=!1;if("undefined"!=typeof window&&"WebGLRenderingContext"in window)try{const e=w(document.createElement("CANVAS"),{failIfMajorPerformanceCaveat:!0});e&&(exports.HAS=y=!0,exports.MAX_TEXTURE_SIZE=m=e.getParameter(e.MAX_TEXTURE_SIZE),exports.EXTENSIONS=W=e.getSupportedExtensions())}catch(e){}exports.HAS=y,exports.MAX_TEXTURE_SIZE=m,exports.EXTENSIONS=W;
},{}],86:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./webgl.js");Object.defineProperty(exports,"WEBGL",{enumerable:!0,get:function(){return e.HAS}});const t="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",o=exports.FIREFOX=-1!==t.indexOf("firefox"),n=exports.SAFARI=-1!==t.indexOf("safari")&&-1==t.indexOf("chrom"),r=exports.WEBKIT=-1!==t.indexOf("webkit")&&-1==t.indexOf("edge"),i=exports.MAC=-1!==t.indexOf("macintosh"),s=exports.DEVICE_PIXEL_RATIO=window.devicePixelRatio||1,a=exports.CANVAS_LINE_DASH=function(){let e=!1;try{e=!!document.createElement("CANVAS").getContext("2d").setLineDash}catch(e){}return e}(),x=exports.GEOLOCATION="geolocation"in navigator,d=exports.TOUCH="ontouchstart"in window,O=exports.POINTER="PointerEvent"in window,c=exports.MSPOINTER=!!navigator.msPointerEnabled;
},{"./webgl.js":153}],91:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3};
},{}],99:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=exports.CLASS_HIDDEN="ol-hidden",t=exports.CLASS_SELECTABLE="ol-selectable",o=exports.CLASS_UNSELECTABLE="ol-unselectable",l=exports.CLASS_UNSUPPORTED="ol-unsupported",n=exports.CLASS_CONTROL="ol-control",s=exports.CLASS_COLLAPSED="ol-collapsed",r=exports.getFontFamilies=function(){let e;const t={};return function(o){if(e||(e=document.createElement("div").style),!(o in t)){e.font=o;const l=e.fontFamily;if(e.font="",!l)return null;t[o]=l.split(/,\s?/)}return t[o]}}();
},{}],133:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util.js"),t=require("../asserts.js"),s=require("../events/EventTarget.js"),n=i(s),r=require("../events/EventType.js"),o=i(r);function i(e){return e&&e.__esModule?e:{default:e}}const l=function(e){n.default.call(this),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null};(0,e.inherits)(l,n.default),l.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},l.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(o.default.CLEAR)},l.prototype.containsKey=function(e){return this.entries_.hasOwnProperty(e)},l.prototype.forEach=function(e,t){let s=this.oldest_;for(;s;)e.call(t,s.value_,s.key_,this),s=s.newer},l.prototype.get=function(e){const s=this.entries_[e];return(0,t.assert)(void 0!==s,15),s===this.newest_?s.value_:(s===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(s.newer.older=s.older,s.older.newer=s.newer),s.newer=null,s.older=this.newest_,this.newest_.newer=s,this.newest_=s,s.value_)},l.prototype.remove=function(e){const s=this.entries_[e];return(0,t.assert)(void 0!==s,15),s===this.newest_?(this.newest_=s.older,this.newest_&&(this.newest_.newer=null)):s===this.oldest_?(this.oldest_=s.newer,this.oldest_&&(this.oldest_.older=null)):(s.newer.older=s.older,s.older.newer=s.newer),delete this.entries_[e],--this.count_,s.value_},l.prototype.getCount=function(){return this.count_},l.prototype.getKeys=function(){const e=new Array(this.count_);let t,s=0;for(t=this.newest_;t;t=t.older)e[s++]=t.key_;return e},l.prototype.getValues=function(){const e=new Array(this.count_);let t,s=0;for(t=this.newest_;t;t=t.older)e[s++]=t.value_;return e},l.prototype.peekLast=function(){return this.oldest_.value_},l.prototype.peekLastKey=function(){return this.oldest_.key_},l.prototype.peekFirstKey=function(){return this.newest_.key_},l.prototype.pop=function(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_},l.prototype.replace=function(e,t){this.get(e),this.entries_[e].value_=t},l.prototype.set=function(e,s){(0,t.assert)(!(e in this.entries_),16);const n={key_:e,newer:null,older:this.newest_,value_:s};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[e]=n,++this.count_},l.prototype.setSize=function(e){this.highWaterMark=e},l.prototype.prune=function(){for(;this.canExpireCache();)this.pop()},exports.default=l;
},{"../util.js":43,"../asserts.js":83,"../events/EventTarget.js":121,"../events/EventType.js":110}],217:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.resetTransform=exports.measureTextHeight=exports.checkFont=exports.textHeights=exports.checkedFonts=exports.labelCache=exports.defaultLineWidth=exports.defaultPadding=exports.defaultTextBaseline=exports.defaultTextAlign=exports.defaultStrokeStyle=exports.defaultMiterLimit=exports.defaultLineJoin=exports.defaultLineDashOffset=exports.defaultLineDash=exports.defaultLineCap=exports.defaultFillStyle=exports.defaultFont=void 0,exports.measureTextWidth=w,exports.rotateAtOffset=k,exports.drawImage=M;var e=require("../css.js"),t=require("../dom.js"),o=require("../obj.js"),r=require("../structs/LRUCache.js"),s=a(r),n=require("../transform.js");function a(e){return e&&e.__esModule?e:{default:e}}const l=exports.defaultFont="10px sans-serif",i=exports.defaultFillStyle=[0,0,0,1],u=exports.defaultLineCap="round",f=exports.defaultLineDash=[],p=exports.defaultLineDashOffset=0,d=exports.defaultLineJoin="round",x=exports.defaultMiterLimit=10,c=exports.defaultStrokeStyle=[0,0,0,1],h=exports.defaultTextAlign="center",m=exports.defaultTextBaseline="middle",g=exports.defaultPadding=[0,0,0,0],y=exports.defaultLineWidth=1,T=exports.labelCache=new s.default,L=exports.checkedFonts={};let b=null;const C=exports.textHeights={},F=exports.checkFont=function(){const t=60,r=L,s="32px ",n=["monospace","serif"],a=n.length,l="wmytzilWMYTZIL@#/&?$%10ï€“";let i,u;function f(e){const t=v();let o=!0;for(let r=0;r<a;++r){const a=n[r];if(t.font=s+a,u=t.measureText(l).width,e!=a){t.font=s+e+","+a;const r=t.measureText(l).width;o=o&&r!=u}}return o}function p(){let e=!0;for(const s in r)r[s]<t&&(f(s)?(r[s]=t,(0,o.clear)(C),b=null,T.clear()):(++r[s],e=!1));e&&(clearInterval(i),i=void 0)}return function(o){const s=(0,e.getFontFamilies)(o);if(s)for(let e=0,o=s.length;e<o;++e){const o=s[e];o in r||(r[o]=t,f(o)||(r[o]=0,void 0===i&&(i=setInterval(p,32))))}}}();function v(){return b||(b=(0,t.createCanvasContext2D)(1,1)),b}const j=exports.measureTextHeight=function(){let e;const t=C;return function(o){let r=t[o];return null==r&&(e||((e=document.createElement("span")).textContent="M",e.style.margin=e.style.padding="0 !important",e.style.position="absolute !important",e.style.left="-99999px !important"),e.style.font=o,document.body.appendChild(e),r=t[o]=e.offsetHeight,document.body.removeChild(e)),r}}();function w(e,t){const o=v();return e!=o.font&&(o.font=e),o.measureText(t).width}function k(e,t,o,r){0!==t&&(e.translate(o,r),e.rotate(t),e.translate(-o,-r))}const A=exports.resetTransform=(0,n.create)();function M(e,t,o,r,s,n,a,l,i,u,f){let p;1!=o&&(p=e.globalAlpha,e.globalAlpha=p*o),t&&e.setTransform.apply(e,t),e.drawImage(r,s,n,a,l,i,u,a*f,l*f),p&&(e.globalAlpha=p),t&&e.setTransform.apply(e,A)}
},{"../css.js":99,"../dom.js":93,"../obj.js":74,"../structs/LRUCache.js":133,"../transform.js":105}],284:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.snapToPixel_=t.snapToPixel};t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getSnapToPixel=function(){return this.snapToPixel_},t.prototype.getAnchor=function(){},t.prototype.getImage=function(t){},t.prototype.getHitDetectionImage=function(t){},t.prototype.getImageState=function(){},t.prototype.getImageSize=function(){},t.prototype.getHitDetectionImageSize=function(){},t.prototype.getOrigin=function(){},t.prototype.getSize=function(){},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t},t.prototype.setSnapToPixel=function(t){this.snapToPixel_=t},t.prototype.listenImageChange=function(t,o){},t.prototype.load=function(){},t.prototype.unlistenImageChange=function(t,o){},exports.default=t;
},{}],252:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),i=require("../colorlike.js"),e=require("../dom.js"),s=require("../has.js"),n=require("../ImageState.js"),o=l(n),a=require("../render/canvas.js"),h=require("../style/Image.js"),r=l(h);function l(t){return t&&t.__esModule?t:{default:t}}const u=function(t){this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=void 0!==t.radius?t.radius:t.radius1,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=t.atlasManager,this.render_(this.atlasManager_);const i=void 0===t.snapToPixel||t.snapToPixel,e=void 0!==t.rotateWithView&&t.rotateWithView;r.default.call(this,{opacity:1,rotateWithView:e,rotation:void 0!==t.rotation?t.rotation:0,scale:1,snapToPixel:i})};(0,t.inherits)(u,r.default),u.prototype.clone=function(){const t=new u({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),snapToPixel:this.getSnapToPixel(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},u.prototype.getAnchor=function(){return this.anchor_},u.prototype.getAngle=function(){return this.angle_},u.prototype.getFill=function(){return this.fill_},u.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},u.prototype.getImage=function(t){return this.canvas_},u.prototype.getImageSize=function(){return this.imageSize_},u.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},u.prototype.getImageState=function(){return o.default.LOADED},u.prototype.getOrigin=function(){return this.origin_},u.prototype.getPoints=function(){return this.points_},u.prototype.getRadius=function(){return this.radius_},u.prototype.getRadius2=function(){return this.radius2_},u.prototype.getSize=function(){return this.size_},u.prototype.getStroke=function(){return this.stroke_},u.prototype.listenImageChange=function(t,i){},u.prototype.load=function(){},u.prototype.unlistenImageChange=function(t,i){},u.prototype.render_=function(t){let n,o,h="",r="",l=0,u=null,_=0,c=0;this.stroke_&&(null===(o=this.stroke_.getColor())&&(o=a.defaultStrokeStyle),o=(0,i.asColorLike)(o),void 0===(c=this.stroke_.getWidth())&&(c=a.defaultLineWidth),u=this.stroke_.getLineDash(),_=this.stroke_.getLineDashOffset(),s.CANVAS_LINE_DASH||(u=null,_=0),void 0===(r=this.stroke_.getLineJoin())&&(r=a.defaultLineJoin),void 0===(h=this.stroke_.getLineCap())&&(h=a.defaultLineCap),void 0===(l=this.stroke_.getMiterLimit())&&(l=a.defaultMiterLimit));let d=2*(this.radius_+c)+1;const g={strokeStyle:o,strokeWidth:c,size:d,lineCap:h,lineDash:u,lineDashOffset:_,lineJoin:r,miterLimit:l};if(void 0===t){const t=(0,e.createCanvasContext2D)(d,d);this.canvas_=t.canvas,n=d=this.canvas_.width,this.draw_(g,t,0,0),this.createHitDetectionCanvas_(g)}else{d=Math.round(d);const i=!this.fill_;let e;i&&(e=this.drawHitDetectionCanvas_.bind(this,g));const s=this.getChecksum(),o=t.add(s,d,d,this.draw_.bind(this,g),e);this.canvas_=o.image,this.origin_=[o.offsetX,o.offsetY],n=o.image.width,i?(this.hitDetectionCanvas_=o.hitImage,this.hitDetectionImageSize_=[o.hitImage.width,o.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[n,n])}this.anchor_=[d/2,d/2],this.size_=[d,d],this.imageSize_=[n,n]},u.prototype.draw_=function(t,e,s,n){let o,h,r;e.setTransform(1,0,0,1,0,0),e.translate(s,n),e.beginPath();let l=this.points_;if(l===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{const i=void 0!==this.radius2_?this.radius2_:this.radius_;for(i!==this.radius_&&(l*=2),o=0;o<=l;o++)h=2*o*Math.PI/l-Math.PI/2+this.angle_,r=o%2==0?this.radius_:i,e.lineTo(t.size/2+r*Math.cos(h),t.size/2+r*Math.sin(h))}if(this.fill_){let t=this.fill_.getColor();null===t&&(t=a.defaultFillStyle),e.fillStyle=(0,i.asColorLike)(t),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},u.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.fill_)return void(this.hitDetectionCanvas_=this.canvas_);const i=(0,e.createCanvasContext2D)(t.size,t.size);this.hitDetectionCanvas_=i.canvas,this.drawHitDetectionCanvas_(t,i,0,0)},u.prototype.drawHitDetectionCanvas_=function(t,i,e,s){i.setTransform(1,0,0,1,0,0),i.translate(e,s),i.beginPath();let n=this.points_;if(n===1/0)i.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{const e=void 0!==this.radius2_?this.radius2_:this.radius_;let s,o,a;for(e!==this.radius_&&(n*=2),s=0;s<=n;s++)a=2*s*Math.PI/n-Math.PI/2+this.angle_,o=s%2==0?this.radius_:e,i.lineTo(t.size/2+o*Math.cos(a),t.size/2+o*Math.sin(a))}i.fillStyle=a.defaultFillStyle,i.fill(),this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.stroke()),i.closePath()},u.prototype.getChecksum=function(){const t=this.stroke_?this.stroke_.getChecksum():"-",i=this.fill_?this.fill_.getChecksum():"-";if(!this.checksums_||t!=this.checksums_[1]||i!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6]){const e="r"+t+i+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[e,t,i,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]},exports.default=u;
},{"../util.js":43,"../colorlike.js":257,"../dom.js":93,"../has.js":86,"../ImageState.js":91,"../render/canvas.js":217,"../style/Image.js":284}],194:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../style/RegularShape.js"),s=i(e);function i(t){return t&&t.__esModule?t:{default:t}}const a=function(t){const e=t||{};s.default.call(this,{points:1/0,fill:e.fill,radius:e.radius,snapToPixel:e.snapToPixel,stroke:e.stroke,atlasManager:e.atlasManager})};(0,t.inherits)(a,s.default),a.prototype.clone=function(){const t=new a({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),snapToPixel:this.getSnapToPixel(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},a.prototype.setRadius=function(t){this.radius_=t,this.render_(this.atlasManager_)},exports.default=a;
},{"../util.js":43,"../style/RegularShape.js":252}],117:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var o=require("../util.js"),t=require("../color.js");const e=function(o){const t=o||{};this.color_=void 0!==t.color?t.color:null,this.checksum_=void 0};e.prototype.clone=function(){const o=this.getColor();return new e({color:o&&o.slice?o.slice():o||void 0})},e.prototype.getColor=function(){return this.color_},e.prototype.setColor=function(o){this.color_=o,this.checksum_=void 0},e.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.color_ instanceof CanvasPattern||this.color_ instanceof CanvasGradient?this.checksum_=(0,o.getUid)(this.color_).toString():this.checksum_="f"+(this.color_?(0,t.asString)(this.color_):"-")),this.checksum_},exports.default=e;
},{"../util.js":43,"../color.js":209}],118:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js");const i=function(t){const i=t||{};this.color_=void 0!==i.color?i.color:null,this.lineCap_=i.lineCap,this.lineDash_=void 0!==i.lineDash?i.lineDash:null,this.lineDashOffset_=i.lineDashOffset,this.lineJoin_=i.lineJoin,this.miterLimit_=i.miterLimit,this.width_=i.width,this.checksum_=void 0};i.prototype.clone=function(){const t=this.getColor();return new i({color:t&&t.slice?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},i.prototype.getColor=function(){return this.color_},i.prototype.getLineCap=function(){return this.lineCap_},i.prototype.getLineDash=function(){return this.lineDash_},i.prototype.getLineDashOffset=function(){return this.lineDashOffset_},i.prototype.getLineJoin=function(){return this.lineJoin_},i.prototype.getMiterLimit=function(){return this.miterLimit_},i.prototype.getWidth=function(){return this.width_},i.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},i.prototype.setLineCap=function(t){this.lineCap_=t,this.checksum_=void 0},i.prototype.setLineDash=function(t){this.lineDash_=t,this.checksum_=void 0},i.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t,this.checksum_=void 0},i.prototype.setLineJoin=function(t){this.lineJoin_=t,this.checksum_=void 0},i.prototype.setMiterLimit=function(t){this.miterLimit_=t,this.checksum_=void 0},i.prototype.setWidth=function(t){this.width_=t,this.checksum_=void 0},i.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=(0,t.getUid)(this.color_).toString():this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_},exports.default=i;
},{"../util.js":43}],112:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.toFunction=c,exports.createDefaultStyle=g,exports.createEditingStyle=y;var t=require("../asserts.js"),e=require("../geom/GeometryType.js"),o=f(e),n=require("../style/Circle.js"),r=f(n),i=require("../style/Fill.js"),l=f(i),u=require("../style/Stroke.js"),s=f(u);function f(t){return t&&t.__esModule?t:{default:t}}const d=function(t){const e=t||{};this.geometry_=null,this.geometryFunction_=h,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex};function c(e){let o;if("function"==typeof e)o=e;else{let n;Array.isArray(e)?n=e:((0,t.assert)(e instanceof d,41),n=[e]),o=function(){return n}}return o}d.prototype.clone=function(){let t=this.getGeometry();return t&&t.clone&&(t=t.clone()),new d({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},d.prototype.getRenderer=function(){return this.renderer_},d.prototype.setRenderer=function(t){this.renderer_=t},d.prototype.getGeometry=function(){return this.geometry_},d.prototype.getGeometryFunction=function(){return this.geometryFunction_},d.prototype.getFill=function(){return this.fill_},d.prototype.setFill=function(t){this.fill_=t},d.prototype.getImage=function(){return this.image_},d.prototype.setImage=function(t){this.image_=t},d.prototype.getStroke=function(){return this.stroke_},d.prototype.setStroke=function(t){this.stroke_=t},d.prototype.getText=function(){return this.text_},d.prototype.setText=function(t){this.text_=t},d.prototype.getZIndex=function(){return this.zIndex_},d.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=h,this.geometry_=t},d.prototype.setZIndex=function(t){this.zIndex_=t};let a=null;function g(t,e){if(!a){const t=new l.default({color:"rgba(255,255,255,0.4)"}),e=new s.default({color:"#3399CC",width:1.25});a=[new d({image:new r.default({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}return a}function y(){const t={},e=[255,255,255,1],n=[0,153,255,1];return t[o.default.POLYGON]=[new d({fill:new l.default({color:[255,255,255,.5]})})],t[o.default.MULTI_POLYGON]=t[o.default.POLYGON],t[o.default.LINE_STRING]=[new d({stroke:new s.default({color:e,width:5})}),new d({stroke:new s.default({color:n,width:3})})],t[o.default.MULTI_LINE_STRING]=t[o.default.LINE_STRING],t[o.default.CIRCLE]=t[o.default.POLYGON].concat(t[o.default.LINE_STRING]),t[o.default.POINT]=[new d({image:new r.default({radius:6,fill:new l.default({color:n}),stroke:new s.default({color:e,width:1.5})}),zIndex:1/0})],t[o.default.MULTI_POINT]=t[o.default.POINT],t[o.default.GEOMETRY_COLLECTION]=t[o.default.POLYGON].concat(t[o.default.LINE_STRING],t[o.default.POINT]),t}function h(t){return t.getGeometry()}exports.default=d;
},{"../asserts.js":83,"../geom/GeometryType.js":140,"../style/Circle.js":194,"../style/Fill.js":117,"../style/Stroke.js":118}],18:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createStyleFunction=m;var e=require("./asserts.js"),t=require("./events.js"),n=require("./events/EventType.js"),s=l(n),o=require("./util.js"),i=require("./Object.js"),r=l(i),h=require("./geom/Geometry.js"),y=l(h),u=require("./style/Style.js"),a=l(u);function l(e){return e&&e.__esModule?e:{default:e}}const g=function(e){if(r.default.call(this),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,(0,t.listen)(this,(0,i.getChangeEventType)(this.geometryName_),this.handleGeometryChanged_,this),void 0!==e)if(e instanceof y.default||!e){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}};function m(t){if("function"==typeof t)return t;{let n;return Array.isArray(t)?n=t:((0,e.assert)(t instanceof a.default,41),n=[t]),function(){return n}}}(0,o.inherits)(g,r.default),g.prototype.clone=function(){const e=new g(this.getProperties());e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const n=this.getStyle();return n&&e.setStyle(n),e},g.prototype.getGeometry=function(){return this.get(this.geometryName_)},g.prototype.getId=function(){return this.id_},g.prototype.getGeometryName=function(){return this.geometryName_},g.prototype.getStyle=function(){return this.style_},g.prototype.getStyleFunction=function(){return this.styleFunction_},g.prototype.handleGeometryChange_=function(){this.changed()},g.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&((0,t.unlistenByKey)(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=(0,t.listen)(e,s.default.CHANGE,this.handleGeometryChange_,this)),this.changed()},g.prototype.setGeometry=function(e){this.set(this.geometryName_,e)},g.prototype.setStyle=function(e){this.style_=e,this.styleFunction_=e?m(e):void 0,this.changed()},g.prototype.setId=function(e){this.id_=e,this.changed()},g.prototype.setGeometryName=function(e){(0,t.unlisten)(this,(0,i.getChangeEventType)(this.geometryName_),this.handleGeometryChanged_,this),this.geometryName_=e,(0,t.listen)(this,(0,i.getChangeEventType)(this.geometryName_),this.handleGeometryChanged_,this),this.handleGeometryChanged_()},exports.default=g;
},{"./asserts.js":83,"./events.js":84,"./events/EventType.js":110,"./util.js":43,"./Object.js":31,"./geom/Geometry.js":111,"./style/Style.js":112}],85:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"};
},{}],130:[function(require,module,exports) {
"use strict";function e(e,n,t){let o,u;const i=t||r;let f=0,s=e.length,l=!1;for(;f<s;)(u=+i(e[o=f+(s-f>>1)],n))<0?f=o+1:(s=o,l=!u);return l?f:~f}function r(e,r){return e>r?1:e<r?-1:0}function n(e,r){return e.indexOf(r)>=0}function t(e,r,n){const t=e.length;if(e[0]<=r)return 0;if(r<=e[t-1])return t-1;{let o;if(n>0){for(o=1;o<t;++o)if(e[o]<r)return o-1}else if(n<0){for(o=1;o<t;++o)if(e[o]<=r)return o}else for(o=1;o<t;++o){if(e[o]==r)return o;if(e[o]<r)return e[o-1]-r<r-e[o]?o-1:o}return t-1}}function o(e,r,n){for(;r<n;){const t=e[r];e[r]=e[n],e[n]=t,++r,--n}}function u(e,r){const n=Array.isArray(r)?r:[r],t=n.length;for(let r=0;r<t;r++)e[e.length]=n[r]}function i(e,r){const n=e.indexOf(r),t=n>-1;return t&&e.splice(n,1),t}function f(e,r){const n=e.length>>>0;let t;for(let o=0;o<n;o++)if(r(t=e[o],o,e))return t;return null}function s(e,r){const n=e.length;if(n!==r.length)return!1;for(let t=0;t<n;t++)if(e[t]!==r[t])return!1;return!0}function l(e,r){const n=e.length,t=Array(e.length);let o;for(o=0;o<n;o++)t[o]={index:o,value:e[o]};for(t.sort(function(e,n){return r(e.value,n.value)||e.index-n.index}),o=0;o<e.length;o++)e[o]=t[o].value}function c(e,r){let n;return!e.every(function(t,o){return n=o,!r(t,o,e)})?n:-1}function x(e,n,t){const o=n||r;return e.every(function(r,n){if(0===n)return!0;const u=o(e[n-1],r);return!(u>0||t&&0===u)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.binarySearch=e,exports.numberSafeCompareFunction=r,exports.includes=n,exports.linearFindNearest=t,exports.reverseSubArray=o,exports.extend=u,exports.remove=i,exports.find=f,exports.equals=s,exports.stableSort=l,exports.findIndex=c,exports.isSorted=x;
},{}],114:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};
},{}],141:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStrideForLayout=h,exports.transformGeom2D=p;var t=require("../util.js"),e=require("../functions.js"),i=require("../extent.js"),o=require("../geom/Geometry.js"),r=d(o),n=require("../geom/GeometryLayout.js"),s=d(n),a=require("../geom/flat/transform.js"),l=require("../obj.js");function d(t){return t&&t.__esModule?t:{default:t}}const u=function(){r.default.call(this),this.layout=s.default.XY,this.stride=2,this.flatCoordinates=null};function f(t){let e;return 2==t?e=s.default.XY:3==t?e=s.default.XYZ:4==t&&(e=s.default.XYZM),e}function h(t){let e;return t==s.default.XY?e=2:t==s.default.XYZ||t==s.default.XYM?e=3:t==s.default.XYZM&&(e=4),e}function p(t,e,i){const o=t.getFlatCoordinates();if(o){const r=t.getStride();return(0,a.transform2D)(o,0,o.length,r,e,i)}return null}(0,t.inherits)(u,r.default),u.prototype.containsXY=e.FALSE,u.prototype.computeExtent=function(t){return(0,i.createOrUpdateFromFlatCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},u.prototype.getCoordinates=function(){},u.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},u.prototype.getFlatCoordinates=function(){return this.flatCoordinates},u.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},u.prototype.getLayout=function(){return this.layout},u.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&((0,l.clear)(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(e))return this.simplifiedGeometryCache[e];{const i=this.getSimplifiedGeometryInternal(t);return i.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[e]=i,i):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}},u.prototype.getSimplifiedGeometryInternal=function(t){return this},u.prototype.getStride=function(){return this.stride},u.prototype.setFlatCoordinatesInternal=function(t,e){this.stride=h(t),this.layout=t,this.flatCoordinates=e},u.prototype.setCoordinates=function(t,e){},u.prototype.setLayout=function(t,e,i){let o;if(t)o=h(t);else{for(let t=0;t<i;++t){if(0===e.length)return this.layout=s.default.XY,void(this.stride=2);e=e[0]}t=f(o=e.length)}this.layout=t,this.stride=o},u.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},u.prototype.rotate=function(t,e){const i=this.getFlatCoordinates();if(i){const o=this.getStride();(0,a.rotate)(i,0,i.length,o,t,e,i),this.changed()}},u.prototype.scale=function(t,e,o){let r=e;void 0===r&&(r=t);let n=o;n||(n=(0,i.getCenter)(this.getExtent()));const s=this.getFlatCoordinates();if(s){const e=this.getStride();(0,a.scale)(s,0,s.length,e,t,r,n,s),this.changed()}},u.prototype.translate=function(t,e){const i=this.getFlatCoordinates();if(i){const o=this.getStride();(0,a.translate)(i,0,i.length,o,t,e,i),this.changed()}},exports.default=u;
},{"../util.js":43,"../functions.js":103,"../extent.js":90,"../geom/Geometry.js":111,"../geom/GeometryLayout.js":114,"../geom/flat/transform.js":192,"../obj.js":74}],196:[function(require,module,exports) {
"use strict";function e(e,t,n,r){let o=0,l=e[n-r],s=e[n-r+1];for(;t<n;t+=r){const n=e[t],r=e[t+1];o+=s*n-l*r,l=n,s=r}return o/2}function t(t,n,r,o){let l=0;for(let s=0,i=r.length;s<i;++s){const i=r[s];l+=e(t,n,i,o),n=i}return l}function n(e,n,r,o){let l=0;for(let s=0,i=r.length;s<i;++s){const i=r[s];l+=t(e,n,i,o),n=i[i.length-1]}return l}Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRing=e,exports.linearRings=t,exports.linearRingss=n;
},{}],197:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.maxSquaredDelta=r,exports.arrayMaxSquaredDelta=n,exports.multiArrayMaxSquaredDelta=s,exports.assignClosestPoint=o,exports.assignClosestArrayPoint=a,exports.assignClosestMultiArrayPoint=l;var t=require("../../math.js");function e(e,r,n,s,o,a,l){const i=e[r],u=e[r+1],f=e[n]-i,c=e[n+1]-u;let h;if(0===f&&0===c)h=r;else{const g=((o-i)*f+(a-u)*c)/(f*f+c*c);if(g>1)h=n;else{if(g>0){for(let o=0;o<s;++o)l[o]=(0,t.lerp)(e[r+o],e[n+o],g);return void(l.length=s)}h=r}}for(let t=0;t<s;++t)l[t]=e[h+t];l.length=s}function r(e,r,n,s,o){let a=e[r],l=e[r+1];for(r+=s;r<n;r+=s){const n=e[r],s=e[r+1],i=(0,t.squaredDistance)(a,l,n,s);i>o&&(o=i),a=n,l=s}return o}function n(t,e,n,s,o){for(let a=0,l=n.length;a<l;++a){const l=n[a];o=r(t,e,l,s,o),e=l}return o}function s(t,e,r,s,o){for(let a=0,l=r.length;a<l;++a){const l=r[a];o=n(t,e,l,s,o),e=l[l.length-1]}return o}function o(r,n,s,o,a,l,i,u,f,c,h){if(n==s)return c;let g,N;if(0===a){if((N=(0,t.squaredDistance)(i,u,r[n],r[n+1]))<c){for(g=0;g<o;++g)f[g]=r[n+g];return f.length=o,N}return c}const x=h||[NaN,NaN];let d=n+o;for(;d<s;)if(e(r,d-o,d,o,i,u,x),(N=(0,t.squaredDistance)(i,u,x[0],x[1]))<c){for(c=N,g=0;g<o;++g)f[g]=x[g];f.length=o,d+=o}else d+=o*Math.max((Math.sqrt(N)-Math.sqrt(c))/a|0,1);if(l&&(e(r,s-o,n,o,i,u,x),(N=(0,t.squaredDistance)(i,u,x[0],x[1]))<c)){for(c=N,g=0;g<o;++g)f[g]=x[g];f.length=o}return c}function a(t,e,r,n,s,a,l,i,u,f,c){const h=c||[NaN,NaN];for(let c=0,g=r.length;c<g;++c){const g=r[c];f=o(t,e,g,n,s,a,l,i,u,f,h),e=g}return f}function l(t,e,r,n,s,o,l,i,u,f,c){const h=c||[NaN,NaN];for(let c=0,g=r.length;c<g;++c){const g=r[c];f=a(t,e,g,n,s,o,l,i,u,f,h),e=g[g.length-1]}return f}
},{"../../math.js":87}],199:[function(require,module,exports) {
"use strict";function t(t,e,n,o){for(let o=0,r=n.length;o<r;++o)t[e++]=n[o];return e}function e(t,e,n,o){for(let r=0,l=n.length;r<l;++r){const l=n[r];for(let n=0;n<o;++n)t[e++]=l[n]}return e}function n(t,n,o,r,l){const s=l||[];let f=0;for(let l=0,u=o.length;l<u;++l){const u=e(t,n,o[l],r);s[f++]=u,n=u}return s.length=f,s}function o(t,e,o,r,l){const s=l||[];let f=0;for(let l=0,u=o.length;l<u;++l){const u=n(t,e,o[l],r,s[f]);s[f++]=u,e=u[u.length-1]}return s.length=f,s}Object.defineProperty(exports,"__esModule",{value:!0}),exports.deflateCoordinate=t,exports.deflateCoordinates=e,exports.deflateCoordinatesArray=n,exports.deflateMultiCoordinatesArray=o;
},{}],200:[function(require,module,exports) {
"use strict";function t(t,e,n,o,r){const l=void 0!==r?r:[];let i=0;for(let r=e;r<n;r+=o)l[i++]=t.slice(r,r+o);return l.length=i,l}function e(e,n,o,r,l){const i=void 0!==l?l:[];let s=0;for(let l=0,c=o.length;l<c;++l){const c=o[l];i[s++]=t(e,n,c,r,i[s]),n=c}return i.length=s,i}function n(t,n,o,r,l){const i=void 0!==l?l:[];let s=0;for(let l=0,c=o.length;l<c;++l){const c=o[l];i[s++]=e(t,n,c,r,i[s]),n=c[c.length-1]}return i.length=s,i}Object.defineProperty(exports,"__esModule",{value:!0}),exports.inflateCoordinates=t,exports.inflateCoordinatesArray=e,exports.inflateMultiCoordinatesArray=n;
},{}],204:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.simplifyLineString=e,exports.douglasPeucker=r,exports.douglasPeuckerArray=n,exports.douglasPeuckerMultiArray=o,exports.radialDistance=u,exports.snap=s,exports.quantize=i,exports.quantizeArray=c,exports.quantizeMultiArray=l;var t=require("../../math.js");function e(t,e,n,o,s,i,c){const l=void 0!==c?c:[];return i||(n=u(t,e,n,o,s,l,0),t=l,e=0,o=2),l.length=r(t,e,n,o,s,l,0),l}function r(e,r,n,o,u,s,i){const c=(n-r)/o;if(c<3){for(;r<n;r+=o)s[i++]=e[r],s[i++]=e[r+1];return i}const l=new Array(c);l[0]=1,l[c-1]=1;const f=[r,n-o];let a=0;for(;f.length>0;){const n=f.pop(),s=f.pop();let i=0;const c=e[s],p=e[s+1],h=e[n],g=e[n+1];for(let r=s+o;r<n;r+=o){const n=e[r],o=e[r+1],u=(0,t.squaredSegmentDistance)(n,o,c,p,h,g);u>i&&(a=r,i=u)}i>u&&(l[(a-r)/o]=1,s+o<a&&f.push(s,a),a+o<n&&f.push(a,n))}for(let t=0;t<c;++t)l[t]&&(s[i++]=e[r+t*o],s[i++]=e[r+t*o+1]);return i}function n(t,e,n,o,u,s,i,c){for(let l=0,f=n.length;l<f;++l){const f=n[l];i=r(t,e,f,o,u,s,i),c.push(i),e=f}return i}function o(t,e,r,o,u,s,i,c){for(let l=0,f=r.length;l<f;++l){const f=r[l],a=[];i=n(t,e,f,o,u,s,i,a),c.push(a),e=f[f.length-1]}return i}function u(e,r,n,o,u,s,i){if(n<=r+o){for(;r<n;r+=o)s[i++]=e[r],s[i++]=e[r+1];return i}let c=e[r],l=e[r+1];s[i++]=c,s[i++]=l;let f=c,a=l;for(r+=o;r<n;r+=o)f=e[r],a=e[r+1],(0,t.squaredDistance)(c,l,f,a)>u&&(s[i++]=f,s[i++]=a,c=f,l=a);return f==c&&a==l||(s[i++]=f,s[i++]=a),i}function s(t,e){return e*Math.round(t/e)}function i(t,e,r,n,o,u,i){if(e==r)return i;let c,l,f=s(t[e],o),a=s(t[e+1],o);e+=n,u[i++]=f,u[i++]=a;do{if(c=s(t[e],o),l=s(t[e+1],o),(e+=n)==r)return u[i++]=c,u[i++]=l,i}while(c==f&&l==a);for(;e<r;){const r=s(t[e],o),p=s(t[e+1],o);if(e+=n,r==c&&p==l)continue;const h=c-f,g=l-a,d=r-f,x=p-a;h*x==g*d&&(h<0&&d<h||h==d||h>0&&d>h)&&(g<0&&x<g||g==x||g>0&&x>g)?(c=r,l=p):(u[i++]=c,u[i++]=l,f=c,a=l,c=r,l=p)}return u[i++]=c,u[i++]=l,i}function c(t,e,r,n,o,u,s,c){for(let l=0,f=r.length;l<f;++l){const f=r[l];s=i(t,e,f,n,o,u,s),c.push(s),e=f}return s}function l(t,e,r,n,o,u,s,i){for(let l=0,f=r.length;l<f;++l){const f=r[l],a=[];s=c(t,e,f,n,o,u,s,a),i.push(a),e=f[f.length-1]}return s}
},{"../../math.js":87}],195:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../extent.js"),i=require("../geom/GeometryLayout.js"),s=c(i),o=require("../geom/GeometryType.js"),n=c(o),a=require("../geom/SimpleGeometry.js"),r=c(a),l=require("../geom/flat/area.js"),u=require("../geom/flat/closest.js"),d=require("../geom/flat/deflate.js"),h=require("../geom/flat/inflate.js"),f=require("../geom/flat/simplify.js");function c(t){return t&&t.__esModule?t:{default:t}}const g=function(t,e){r.default.call(this),this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.setCoordinates(t,e)};(0,t.inherits)(g,r.default),g.prototype.clone=function(){const t=new g(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},g.prototype.closestPointXY=function(t,i,s,o){return o<(0,e.closestSquaredDistanceXY)(this.getExtent(),t,i)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,u.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,u.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,i,s,o))},g.prototype.getArea=function(){return(0,l.linearRing)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},g.prototype.getCoordinates=function(){return(0,h.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},g.prototype.getSimplifiedGeometryInternal=function(t){const e=[];e.length=(0,f.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0);const i=new g(null);return i.setFlatCoordinates(s.default.XY,e),i},g.prototype.getType=function(){return n.default.LINEAR_RING},g.prototype.intersectsExtent=function(t){},g.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,d.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(s.default.XY,null)},g.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},exports.default=g;
},{"../util.js":43,"../extent.js":90,"../geom/GeometryLayout.js":114,"../geom/GeometryType.js":140,"../geom/SimpleGeometry.js":141,"../geom/flat/area.js":196,"../geom/flat/closest.js":197,"../geom/flat/deflate.js":199,"../geom/flat/inflate.js":200,"../geom/flat/simplify.js":204}],116:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../extent.js"),o=require("../geom/GeometryLayout.js"),r=d(o),s=require("../geom/GeometryType.js"),i=d(s),n=require("../geom/SimpleGeometry.js"),a=d(n),l=require("../geom/flat/deflate.js"),u=require("../math.js");function d(t){return t&&t.__esModule?t:{default:t}}const f=function(t,e){a.default.call(this),this.setCoordinates(t,e)};(0,t.inherits)(f,a.default),f.prototype.clone=function(){const t=new f(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},f.prototype.closestPointXY=function(t,e,o,r){const s=this.flatCoordinates,i=(0,u.squaredDistance)(t,e,s[0],s[1]);if(i<r){const t=this.stride;for(let e=0;e<t;++e)o[e]=s[e];return o.length=t,i}return r},f.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},f.prototype.computeExtent=function(t){return(0,e.createOrUpdateFromCoordinate)(this.flatCoordinates,t)},f.prototype.getType=function(){return i.default.POINT},f.prototype.intersectsExtent=function(t){return(0,e.containsXY)(t,this.flatCoordinates[0],this.flatCoordinates[1])},f.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,l.deflateCoordinate)(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(r.default.XY,null)},f.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},exports.default=f;
},{"../util.js":43,"../extent.js":90,"../geom/GeometryLayout.js":114,"../geom/GeometryType.js":140,"../geom/SimpleGeometry.js":141,"../geom/flat/deflate.js":199,"../math.js":87}],198:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRingContainsExtent=t,exports.linearRingContainsXY=e,exports.linearRingsContainsXY=r,exports.linearRingssContainsXY=i;var n=require("../../extent.js");function t(t,r,i,o,u){return!(0,n.forEachCorner)(u,function(n){return!e(t,r,i,o,n[0],n[1])})}function e(n,t,e,r,i,o){let u=0,s=n[e-r],f=n[e-r+1];for(;t<e;t+=r){const e=n[t],r=n[t+1];f<=o?r>o&&(e-s)*(o-f)-(i-s)*(r-f)>0&&u++:r<=o&&(e-s)*(o-f)-(i-s)*(r-f)<0&&u--,s=e,f=r}return 0!==u}function r(n,t,r,i,o,u){if(0===r.length)return!1;if(!e(n,t,r[0],i,o,u))return!1;for(let t=1,s=r.length;t<s;++t)if(e(n,r[t-1],r[t],i,o,u))return!1;return!0}function i(n,t,e,i,o,u){if(0===e.length)return!1;for(let s=0,f=e.length;s<f;++s){const f=e[s];if(r(n,t,f,i,o,u))return!0;t=f[f.length-1]}return!1}
},{"../../extent.js":90}],201:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getInteriorPointOfArray=r,exports.getInteriorPointsOfMultiArray=n;var t=require("../../array.js"),e=require("../flat/contains.js");function r(r,n,o,s,i,a,l){let u,f,c,g,h,p,y;const N=i[a+1],b=[];for(let t=0,e=o.length;t<e;++t){const e=o[t];for(g=r[e-s],p=r[e-s+1],u=n;u<e;u+=s)h=r[u],y=r[u+1],(N<=p&&y<=N||p<=N&&N<=y)&&(c=(N-p)/(y-p)*(h-g)+g,b.push(c)),g=h,p=y}let j=NaN,x=-1/0;for(b.sort(t.numberSafeCompareFunction),g=b[0],u=1,f=b.length;u<f;++u){h=b[u];const t=Math.abs(h-g);t>x&&(c=(g+h)/2,(0,e.linearRingsContainsXY)(r,n,o,s,c,N)&&(j=c,x=t)),g=h}return isNaN(j)&&(j=i[a]),l?(l.push(j,N,x),l):[j,N,x]}function n(t,e,n,o,s){let i=[];for(let a=0,l=n.length;a<l;++a){const l=n[a];i=r(t,e,l,o,s,2*a,i),e=l[l.length-1]}return i}
},{"../../array.js":130,"../flat/contains.js":198}],207:[function(require,module,exports) {
"use strict";function e(e,r,t,o,c,n){const s=[e[r],e[r+1]],u=[];let f;for(;r+o<t;r+=o){if(u[0]=e[r+o],u[1]=e[r+o+1],f=c.call(n,s,u))return f;s[0]=u[0],s[1]=u[1]}return!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports.forEach=e;
},{}],202:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.intersectsLineString=r,exports.intersectsLineStringArray=i,exports.intersectsLinearRing=s,exports.intersectsLinearRingArray=o,exports.intersectsLinearRingMultiArray=a;var n=require("../../extent.js"),e=require("../flat/contains.js"),t=require("../flat/segments.js");function r(e,r,i,s,o){const a=(0,n.extendFlatCoordinates)((0,n.createEmpty)(),e,r,i,s);return!!(0,n.intersects)(o,a)&&(!!(0,n.containsExtent)(o,a)||(a[0]>=o[0]&&a[2]<=o[2]||(a[1]>=o[1]&&a[3]<=o[3]||(0,t.forEach)(e,r,i,s,function(e,t){return(0,n.intersectsSegment)(o,e,t)}))))}function i(n,e,t,i,s){for(let o=0,a=t.length;o<a;++o){if(r(n,e,t[o],i,s))return!0;e=t[o]}return!1}function s(n,t,i,s,o){return!!r(n,t,i,s,o)||(!!(0,e.linearRingContainsXY)(n,t,i,s,o[0],o[1])||(!!(0,e.linearRingContainsXY)(n,t,i,s,o[0],o[3])||(!!(0,e.linearRingContainsXY)(n,t,i,s,o[2],o[1])||!!(0,e.linearRingContainsXY)(n,t,i,s,o[2],o[3]))))}function o(n,t,r,i,o){if(!s(n,t,r[0],i,o))return!1;if(1===r.length)return!0;for(let t=1,s=r.length;t<s;++t)if((0,e.linearRingContainsExtent)(n,r[t-1],r[t],i,o))return!1;return!0}function a(n,e,t,r,i){for(let s=0,a=t.length;s<a;++s){const a=t[s];if(o(n,e,a,r,i))return!0;e=a[a.length-1]}return!1}
},{"../../extent.js":90,"../flat/contains.js":198,"../flat/segments.js":207}],253:[function(require,module,exports) {
"use strict";function e(e,o,t,r){for(;o<t-r;){for(let s=0;s<r;++s){const c=e[o+s];e[o+s]=e[t-r+s],e[t-r+s]=c}o+=r,t-=r}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.coordinates=e;
},{}],203:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRingIsClockwise=r,exports.linearRingIsOriented=n,exports.linearRingsAreOriented=t,exports.orientLinearRings=i,exports.orientLinearRingsArray=o;var e=require("../flat/reverse.js");function r(e,r,n,t){let i=0,o=e[n-t],s=e[n-t+1];for(;r<n;r+=t){const n=e[r],t=e[r+1];i+=(n-o)*(t+s),o=n,s=t}return i>0}function n(e,n,t,i,o){const s=void 0!==o&&o;for(let o=0,l=t.length;o<l;++o){const l=t[o],u=r(e,n,l,i);if(0===o){if(s&&u||!s&&!u)return!1}else if(s&&!u||!s&&u)return!1;n=l}return!0}function t(e,r,t,i,o){for(let s=0,l=t.length;s<l;++s)if(!n(e,r,t[s],i,o))return!1;return!0}function i(n,t,i,o,s){const l=void 0!==s&&s;for(let s=0,u=i.length;s<u;++s){const u=i[s],f=r(n,t,u,o);(0===s?l&&f||!l&&!f:l&&!f||!l&&f)&&(0,e.coordinates)(n,t,u,o),t=u}return t}function o(e,r,n,t,o){for(let s=0,l=n.length;s<l;++s)r=i(e,r,n[s],t,o);return r}
},{"../flat/reverse.js":253}],113:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.circular=P,exports.fromExtent=I,exports.fromCircle=L,exports.makeRegular=O;var t=require("../util.js"),e=require("../array.js"),i=require("../extent.js"),n=require("../geom/GeometryLayout.js"),s=j(n),o=require("../geom/GeometryType.js"),r=j(o),a=require("../geom/LinearRing.js"),l=j(a),d=require("../geom/Point.js"),h=j(d),u=require("../geom/SimpleGeometry.js"),f=j(u),g=require("../sphere.js"),c=require("../geom/flat/area.js"),p=require("../geom/flat/closest.js"),C=require("../geom/flat/contains.js"),_=require("../geom/flat/deflate.js"),y=require("../geom/flat/inflate.js"),m=require("../geom/flat/interiorpoint.js"),F=require("../geom/flat/intersectsextent.js"),R=require("../geom/flat/orient.js"),q=require("../geom/flat/simplify.js"),x=require("../math.js");function j(t){return t&&t.__esModule?t:{default:t}}const v=function(t,e){f.default.call(this),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,this.setCoordinates(t,e)};function P(t,i,n,o){const r=n||32,a=[];for(let n=0;n<r;++n)(0,e.extend)(a,(0,g.offset)(t,i,2*Math.PI*n/r,o));a.push(a[0],a[1]);const l=new v(null);return l.setFlatCoordinates(s.default.XY,a,[a.length]),l}function I(t){const e=t[0],i=t[1],n=t[2],o=t[3],r=[e,i,e,o,n,o,n,i,e,i],a=new v(null);return a.setFlatCoordinates(s.default.XY,r,[r.length]),a}function L(t,e,i){const n=e||32,s=t.getStride(),o=t.getLayout(),r=new v(null,o),a=s*(n+1),l=new Array(a);for(let t=0;t<a;t++)l[t]=0;const d=[l.length];return r.setFlatCoordinates(o,l,d),O(r,t.getCenter(),t.getRadius(),i),r}function O(t,e,i,n){const s=t.getFlatCoordinates(),o=t.getLayout(),r=t.getStride(),a=t.getEnds(),l=s.length/r-1,d=n||0;for(let t=0;t<=l;++t){const n=t*r,o=d+2*(0,x.modulo)(t,l)*Math.PI/l;s[n]=e[0]+i*Math.cos(o),s[n+1]=e[1]+i*Math.sin(o)}t.setFlatCoordinates(o,s,a)}(0,t.inherits)(v,f.default),v.prototype.appendLinearRing=function(t){this.flatCoordinates?(0,e.extend)(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},v.prototype.clone=function(){const t=new v(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),this.ends_.slice()),t},v.prototype.closestPointXY=function(t,e,n,s){return s<(0,i.closestSquaredDistanceXY)(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,p.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,p.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,s))},v.prototype.containsXY=function(t,e){return(0,C.linearRingsContainsXY)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},v.prototype.getArea=function(){return(0,c.linearRings)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},v.prototype.getCoordinates=function(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),(0,R.orientLinearRings)(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,(0,y.inflateCoordinatesArray)(e,0,this.ends_,this.stride)},v.prototype.getEnds=function(){return this.ends_},v.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=(0,i.getCenter)(this.getExtent());this.flatInteriorPoint_=(0,m.getInteriorPointOfArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},v.prototype.getInteriorPoint=function(){return new h.default(this.getFlatInteriorPoint(),s.default.XYM)},v.prototype.getLinearRingCount=function(){return this.ends_.length},v.prototype.getLinearRing=function(t){if(t<0||this.ends_.length<=t)return null;const e=new l.default(null);return e.setFlatCoordinates(this.layout,this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t])),e},v.prototype.getLinearRings=function(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[];let s=0;for(let o=0,r=i.length;o<r;++o){const r=i[o],a=new l.default(null);a.setFlatCoordinates(t,e.slice(s,r)),n.push(a),s=r}return n},v.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;(0,R.linearRingIsOriented)(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=(0,R.orientLinearRings)(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},v.prototype.getSimplifiedGeometryInternal=function(t){const e=[],i=[];e.length=(0,q.quantizeArray)(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i);const n=new v(null);return n.setFlatCoordinates(s.default.XY,e,i),n},v.prototype.getType=function(){return r.default.POLYGON},v.prototype.intersectsExtent=function(t){return(0,F.intersectsLinearRingArray)(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},v.prototype.setCoordinates=function(t,e){if(t){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=(0,_.deflateCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}else this.setFlatCoordinates(s.default.XY,null,this.ends_)},v.prototype.setFlatCoordinates=function(t,e,i){this.setFlatCoordinatesInternal(t,e),this.ends_=i,this.changed()},exports.default=v;
},{"../util.js":43,"../array.js":130,"../extent.js":90,"../geom/GeometryLayout.js":114,"../geom/GeometryType.js":140,"../geom/LinearRing.js":195,"../geom/Point.js":116,"../geom/SimpleGeometry.js":141,"../sphere.js":154,"../geom/flat/area.js":196,"../geom/flat/closest.js":197,"../geom/flat/contains.js":198,"../geom/flat/deflate.js":199,"../geom/flat/inflate.js":200,"../geom/flat/interiorpoint.js":201,"../geom/flat/intersectsextent.js":202,"../geom/flat/orient.js":203,"../geom/flat/simplify.js":204,"../math.js":87}],19:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./util.js"),e=require("./GeolocationProperty.js"),i=p(e),o=require("./Object.js"),n=p(o),s=require("./events.js"),r=require("./events/EventType.js"),a=p(r),u=require("./geom/Polygon.js"),c=require("./has.js"),h=require("./math.js"),d=require("./proj.js");function p(t){return t&&t.__esModule?t:{default:t}}const l=function(t){n.default.call(this);const e=t||{};this.position_=null,this.transform_=d.identityTransform,this.watchId_=void 0,(0,s.listen)(this,(0,o.getChangeEventType)(i.default.PROJECTION),this.handleProjectionChanged_,this),(0,s.listen)(this,(0,o.getChangeEventType)(i.default.TRACKING),this.handleTrackingChanged_,this),void 0!==e.projection&&this.setProjection(e.projection),void 0!==e.trackingOptions&&this.setTrackingOptions(e.trackingOptions),this.setTracking(void 0!==e.tracking&&e.tracking)};(0,t.inherits)(l,n.default),l.prototype.disposeInternal=function(){this.setTracking(!1),n.default.prototype.disposeInternal.call(this)},l.prototype.handleProjectionChanged_=function(){const t=this.getProjection();t&&(this.transform_=(0,d.getTransformFromProjections)((0,d.get)("EPSG:4326"),t),this.position_&&this.set(i.default.POSITION,this.transform_(this.position_)))},l.prototype.handleTrackingChanged_=function(){if(c.GEOLOCATION){const t=this.getTracking();t&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):t||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}},l.prototype.positionChange_=function(t){const e=t.coords;this.set(i.default.ACCURACY,e.accuracy),this.set(i.default.ALTITUDE,null===e.altitude?void 0:e.altitude),this.set(i.default.ALTITUDE_ACCURACY,null===e.altitudeAccuracy?void 0:e.altitudeAccuracy),this.set(i.default.HEADING,null===e.heading?void 0:(0,h.toRadians)(e.heading)),this.position_?(this.position_[0]=e.longitude,this.position_[1]=e.latitude):this.position_=[e.longitude,e.latitude];const o=this.transform_(this.position_);this.set(i.default.POSITION,o),this.set(i.default.SPEED,null===e.speed?void 0:e.speed);const n=(0,u.circular)(this.position_,e.accuracy);n.applyTransform(this.transform_),this.set(i.default.ACCURACY_GEOMETRY,n),this.changed()},l.prototype.positionError_=function(t){t.type=a.default.ERROR,this.setTracking(!1),this.dispatchEvent(t)},l.prototype.getAccuracy=function(){return this.get(i.default.ACCURACY)},l.prototype.getAccuracyGeometry=function(){return this.get(i.default.ACCURACY_GEOMETRY)||null},l.prototype.getAltitude=function(){return this.get(i.default.ALTITUDE)},l.prototype.getAltitudeAccuracy=function(){return this.get(i.default.ALTITUDE_ACCURACY)},l.prototype.getHeading=function(){return this.get(i.default.HEADING)},l.prototype.getPosition=function(){return this.get(i.default.POSITION)},l.prototype.getProjection=function(){return this.get(i.default.PROJECTION)},l.prototype.getSpeed=function(){return this.get(i.default.SPEED)},l.prototype.getTracking=function(){return this.get(i.default.TRACKING)},l.prototype.getTrackingOptions=function(){return this.get(i.default.TRACKING_OPTIONS)},l.prototype.setProjection=function(t){this.set(i.default.PROJECTION,(0,d.get)(t))},l.prototype.setTracking=function(t){this.set(i.default.TRACKING,t)},l.prototype.setTrackingOptions=function(t){this.set(i.default.TRACKING_OPTIONS,t)},exports.default=l;
},{"./util.js":43,"./GeolocationProperty.js":85,"./Object.js":31,"./events.js":84,"./events/EventType.js":110,"./geom/Polygon.js":113,"./has.js":86,"./math.js":87,"./proj.js":88}],193:[function(require,module,exports) {
"use strict";function e(e,t,r){const n=void 0!==r?e.toFixed(r):""+e;let o=n.indexOf(".");return(o=-1===o?n.length:o)>t?n:new Array(1+t-o).join("0")+n}function t(e,t){const r=(""+e).split("."),n=(""+t).split(".");for(let e=0;e<Math.max(r.length,n.length);e++){const t=parseInt(r[e]||"0",10),o=parseInt(n[e]||"0",10);if(t>o)return 1;if(o>t)return-1}return 0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.padNumber=e,exports.compareVersions=t;
},{}],89:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.add=r,exports.closestOnCircle=n,exports.closestOnSegment=o,exports.createStringXY=s,exports.degreesToStringHDMS=u,exports.format=c,exports.equals=i,exports.rotate=a,exports.scale=f,exports.squaredDistance=p,exports.distance=l,exports.squaredDistanceToSegment=x,exports.toStringHDMS=d,exports.toStringXY=h;var t=require("./math.js"),e=require("./string.js");function r(t,e){return t[0]+=e[0],t[1]+=e[1],t}function n(t,e){const r=e.getRadius(),n=e.getCenter(),o=n[0],s=n[1];let u=t[0]-o;const c=t[1]-s;0===u&&0===c&&(u=1);const i=Math.sqrt(u*u+c*c);return[o+r*u/i,s+r*c/i]}function o(t,e){const r=t[0],n=t[1],o=e[0],s=e[1],u=o[0],c=o[1],i=s[0],a=s[1],f=i-u,p=a-c,l=0===f&&0===p?0:(f*(r-u)+p*(n-c))/(f*f+p*p||0);let x,d;return l<=0?(x=u,d=c):l>=1?(x=i,d=a):(x=u+l*f,d=c+l*p),[x,d]}function s(t){return function(e){return h(e,t)}}function u(r,n,o){const s=(0,t.modulo)(n+180,360)-180,u=Math.abs(3600*s),c=o||0,i=Math.pow(10,c);let a=Math.floor(u/3600),f=Math.floor((u-3600*a)/60),p=u-3600*a-60*f;return(p=Math.ceil(p*i)/i)>=60&&(p=0,f+=1),f>=60&&(f=0,a+=1),a+"Â° "+(0,e.padNumber)(f,2)+"â€² "+(0,e.padNumber)(p,2,c)+"â€³"+(0==s?"":" "+r.charAt(s<0?1:0))}function c(t,e,r){return t?e.replace("{x}",t[0].toFixed(r)).replace("{y}",t[1].toFixed(r)):""}function i(t,e){let r=!0;for(let n=t.length-1;n>=0;--n)if(t[n]!=e[n]){r=!1;break}return r}function a(t,e){const r=Math.cos(e),n=Math.sin(e),o=t[0]*r-t[1]*n,s=t[1]*r+t[0]*n;return t[0]=o,t[1]=s,t}function f(t,e){return t[0]*=e,t[1]*=e,t}function p(t,e){const r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function l(t,e){return Math.sqrt(p(t,e))}function x(t,e){return p(t,o(t,e))}function d(t,e){return t?u("NS",t[1],e)+" "+u("EW",t[0],e):""}function h(t,e){return c(t,"{x}, {y}",e)}
},{"./math.js":87,"./string.js":193}],205:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.interpolatePoint=r,exports.lineStringCoordinateAtM=n,exports.lineStringsCoordinateAtM=l;var e=require("../../array.js"),t=require("../../math.js");function r(r,n,l,i,s,u){let o=NaN,f=NaN;const c=(l-n)/i;if(1===c)o=r[n],f=r[n+1];else if(2==c)o=(1-s)*r[n]+s*r[n+i],f=(1-s)*r[n+1]+s*r[n+i+1];else if(0!==c){let u=r[n],c=r[n+1],a=0;const p=[0];for(let e=n+i;e<l;e+=i){const t=r[e],n=r[e+1];a+=Math.sqrt((t-u)*(t-u)+(n-c)*(n-c)),p.push(a),u=t,c=n}const h=s*a,g=(0,e.binarySearch)(p,h);if(g<0){const e=(h-p[-g-2])/(p[-g-1]-p[-g-2]),l=n+(-g-2)*i;o=(0,t.lerp)(r[l],r[l+i],e),f=(0,t.lerp)(r[l+1],r[l+i+1],e)}else o=r[n+g*i],f=r[n+g*i+1]}return u?(u[0]=o,u[1]=f,u):[o,f]}function n(e,r,n,l,i,s){if(n==r)return null;let u;if(i<e[r+l-1])return s?((u=e.slice(r,r+l))[l-1]=i,u):null;if(e[n-1]<i)return s?((u=e.slice(n-l,n))[l-1]=i,u):null;if(i==e[r+l-1])return e.slice(r,r+l);let o=r/l,f=n/l;for(;o<f;){const t=o+f>>1;i<e[(t+1)*l-1]?f=t:o=t+1}const c=e[o*l-1];if(i==c)return e.slice((o-1)*l,(o-1)*l+l);const a=(i-c)/(e[(o+1)*l-1]-c);u=[];for(let r=0;r<l-1;++r)u.push((0,t.lerp)(e[(o-1)*l+r],e[o*l+r],a));return u.push(i),u}function l(e,t,r,l,i,s,u){if(u)return n(e,t,r[r.length-1],l,i,s);let o;if(i<e[l-1])return s?((o=e.slice(0,l))[l-1]=i,o):null;if(e[e.length-1]<i)return s?((o=e.slice(e.length-l))[l-1]=i,o):null;for(let s=0,u=r.length;s<u;++s){const u=r[s];if(t!=u){if(i<e[t+l-1])return null;if(i<=e[u-1])return n(e,t,u,l,i,!1);t=u}}return null}
},{"../../array.js":130,"../../math.js":87}],206:[function(require,module,exports) {
"use strict";function t(t,e,n,r){let o=t[e],s=t[e+1],i=0;for(let l=e+r;l<n;l+=r){const e=t[l],n=t[l+1];i+=Math.sqrt((e-o)*(e-o)+(n-s)*(n-s)),o=e,s=n}return i}function e(e,n,r,o){let s=t(e,n,r,o);const i=e[r-o]-e[n],l=e[r-o+1]-e[n+1];return s+=Math.sqrt(i*i+l*l)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.lineStringLength=t,exports.linearRingLength=e;
},{}],115:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../array.js"),i=require("../extent.js"),o=require("../geom/GeometryLayout.js"),s=y(o),n=require("../geom/GeometryType.js"),r=y(n),a=require("../geom/SimpleGeometry.js"),l=y(a),h=require("../geom/flat/closest.js"),d=require("../geom/flat/deflate.js"),f=require("../geom/flat/inflate.js"),u=require("../geom/flat/interpolate.js"),g=require("../geom/flat/intersectsextent.js"),p=require("../geom/flat/length.js"),C=require("../geom/flat/segments.js"),c=require("../geom/flat/simplify.js");function y(t){return t&&t.__esModule?t:{default:t}}const m=function(t,e){l.default.call(this),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.setCoordinates(t,e)};(0,t.inherits)(m,l.default),m.prototype.appendCoordinate=function(t){this.flatCoordinates?(0,e.extend)(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},m.prototype.clone=function(){const t=new m(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},m.prototype.closestPointXY=function(t,e,o,s){return s<(0,i.closestSquaredDistanceXY)(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,h.maxSquaredDelta)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,h.assignClosestPoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,o,s))},m.prototype.forEachSegment=function(t){return(0,C.forEach)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},m.prototype.getCoordinateAtM=function(t,e){if(this.layout!=s.default.XYM&&this.layout!=s.default.XYZM)return null;const i=void 0!==e&&e;return(0,u.lineStringCoordinateAtM)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},m.prototype.getCoordinates=function(){return(0,f.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},m.prototype.getCoordinateAt=function(t,e){return(0,u.interpolatePoint)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e)},m.prototype.getLength=function(){return(0,p.lineStringLength)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},m.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},m.prototype.getSimplifiedGeometryInternal=function(t){const e=[];e.length=(0,c.douglasPeucker)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0);const i=new m(null);return i.setFlatCoordinates(s.default.XY,e),i},m.prototype.getType=function(){return r.default.LINE_STRING},m.prototype.intersectsExtent=function(t){return(0,g.intersectsLineString)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},m.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,d.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(s.default.XY,null)},m.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},exports.default=m;
},{"../util.js":43,"../array.js":130,"../extent.js":90,"../geom/GeometryLayout.js":114,"../geom/GeometryType.js":140,"../geom/SimpleGeometry.js":141,"../geom/flat/closest.js":197,"../geom/flat/deflate.js":199,"../geom/flat/inflate.js":200,"../geom/flat/interpolate.js":205,"../geom/flat/intersectsextent.js":202,"../geom/flat/length.js":206,"../geom/flat/segments.js":207,"../geom/flat/simplify.js":204}],134:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.greatCircleArc=a,exports.meridian=o,exports.parallel=s;var t=require("../../math.js"),n=require("../../proj.js");function e(n,e,a){const o=[];let s=n(0),r=n(1),i=e(s),u=e(r);const c=[r,s],p=[u,i],h=[1,0],M={};let f,g,d,l,R,m,S=1e5;for(;--S>0&&h.length>0;)d=h.pop(),s=c.pop(),i=p.pop(),(m=d.toString())in M||(o.push(i[0],i[1]),M[m]=!0),l=h.pop(),r=c.pop(),u=p.pop(),g=e(f=n(R=(d+l)/2)),(0,t.squaredSegmentDistance)(g[0],g[1],i[0],i[1],u[0],u[1])<a?(o.push(u[0],u[1]),M[m=l.toString()]=!0):(h.push(l,R,R,d),p.push(u,g,g,i),c.push(r,f,f,s));return o}function a(a,o,s,r,i,u){const c=(0,n.get)("EPSG:4326"),p=Math.cos((0,t.toRadians)(o)),h=Math.sin((0,t.toRadians)(o)),M=Math.cos((0,t.toRadians)(r)),f=Math.sin((0,t.toRadians)(r)),g=Math.cos((0,t.toRadians)(s-a)),d=Math.sin((0,t.toRadians)(s-a)),l=h*f+p*M*g;return e(function(n){if(1<=l)return[s,r];const e=n*Math.acos(l),o=Math.cos(e),i=Math.sin(e),u=d*M,c=p*f-h*M*g,R=Math.atan2(u,c),m=Math.asin(h*o+p*i*Math.cos(R)),S=(0,t.toRadians)(a)+Math.atan2(Math.sin(R)*i*p,o-h*Math.sin(m));return[(0,t.toDegrees)(S),(0,t.toDegrees)(m)]},(0,n.getTransform)(c,i),u)}function o(t,a,o,s,r){const i=(0,n.get)("EPSG:4326");return e(function(n){return[t,a+(o-a)*n]},(0,n.getTransform)(i,s),r)}function s(t,a,o,s,r){const i=(0,n.get)("EPSG:4326");return e(function(n){return[a+(o-a)*n,t]},(0,n.getTransform)(i,s),r)}
},{"../../math.js":87,"../../proj.js":88}],120:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={POSTCOMPOSE:"postcompose",PRECOMPOSE:"precompose",RENDER:"render"};
},{}],208:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={POINT:"point",LINE:"line"};
},{}],119:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../style/Fill.js"),e=n(t),o=require("../style/TextPlacement.js"),i=n(o);function n(t){return t&&t.__esModule?t:{default:t}}const r="#333",s=function(t){const o=t||{};this.font_=o.font,this.rotation_=o.rotation,this.rotateWithView_=o.rotateWithView,this.scale_=o.scale,this.text_=o.text,this.textAlign_=o.textAlign,this.textBaseline_=o.textBaseline,this.fill_=void 0!==o.fill?o.fill:new e.default({color:"#333"}),this.maxAngle_=void 0!==o.maxAngle?o.maxAngle:Math.PI/4,this.placement_=void 0!==o.placement?o.placement:i.default.POINT,this.overflow_=!!o.overflow,this.stroke_=void 0!==o.stroke?o.stroke:null,this.offsetX_=void 0!==o.offsetX?o.offsetX:0,this.offsetY_=void 0!==o.offsetY?o.offsetY:0,this.backgroundFill_=o.backgroundFill?o.backgroundFill:null,this.backgroundStroke_=o.backgroundStroke?o.backgroundStroke:null,this.padding_=void 0===o.padding?null:o.padding};s.prototype.clone=function(){return new s({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:this.getScale(),text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0})},s.prototype.getOverflow=function(){return this.overflow_},s.prototype.getFont=function(){return this.font_},s.prototype.getMaxAngle=function(){return this.maxAngle_},s.prototype.getPlacement=function(){return this.placement_},s.prototype.getOffsetX=function(){return this.offsetX_},s.prototype.getOffsetY=function(){return this.offsetY_},s.prototype.getFill=function(){return this.fill_},s.prototype.getRotateWithView=function(){return this.rotateWithView_},s.prototype.getRotation=function(){return this.rotation_},s.prototype.getScale=function(){return this.scale_},s.prototype.getStroke=function(){return this.stroke_},s.prototype.getText=function(){return this.text_},s.prototype.getTextAlign=function(){return this.textAlign_},s.prototype.getTextBaseline=function(){return this.textBaseline_},s.prototype.getBackgroundFill=function(){return this.backgroundFill_},s.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},s.prototype.getPadding=function(){return this.padding_},s.prototype.setOverflow=function(t){this.overflow_=t},s.prototype.setFont=function(t){this.font_=t},s.prototype.setMaxAngle=function(t){this.maxAngle_=t},s.prototype.setOffsetX=function(t){this.offsetX_=t},s.prototype.setOffsetY=function(t){this.offsetY_=t},s.prototype.setPlacement=function(t){this.placement_=t},s.prototype.setFill=function(t){this.fill_=t},s.prototype.setRotation=function(t){this.rotation_=t},s.prototype.setScale=function(t){this.scale_=t},s.prototype.setStroke=function(t){this.stroke_=t},s.prototype.setText=function(t){this.text_=t},s.prototype.setTextAlign=function(t){this.textAlign_=t},s.prototype.setTextBaseline=function(t){this.textBaseline_=t},s.prototype.setBackgroundFill=function(t){this.backgroundFill_=t},s.prototype.setBackgroundStroke=function(t){this.backgroundStroke_=t},s.prototype.setPadding=function(t){this.padding_=t},exports.default=s;
},{"../style/Fill.js":117,"../style/TextPlacement.js":208}],20:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./coordinate.js"),e=require("./events.js"),i=require("./extent.js"),a=require("./geom/GeometryLayout.js"),s=x(a),l=require("./geom/LineString.js"),n=x(l),o=require("./geom/Point.js"),r=x(o),h=require("./geom/flat/geodesic.js"),_=require("./math.js"),m=require("./proj.js"),L=require("./render/EventType.js"),d=x(L),p=require("./style/Fill.js"),u=x(p),f=require("./style/Stroke.js"),c=x(f),b=require("./style/Text.js"),g=x(b);function x(t){return t&&t.__esModule?t:{default:t}}const y=new c.default({color:"rgba(0,0,0,0.2)"}),P=[90,45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],M=function(e){const i=e||{};this.map_=null,this.postcomposeListenerKey_=null,this.projection_=null,this.maxLat_=1/0,this.maxLon_=1/0,this.minLat_=-1/0,this.minLon_=-1/0,this.maxLatP_=1/0,this.maxLonP_=1/0,this.minLatP_=-1/0,this.minLonP_=-1/0,this.targetSize_=void 0!==i.targetSize?i.targetSize:100,this.maxLines_=void 0!==i.maxLines?i.maxLines:100,this.meridians_=[],this.parallels_=[],this.strokeStyle_=void 0!==i.strokeStyle?i.strokeStyle:y,this.fromLonLatTransform_=void 0,this.toLonLatTransform_=void 0,this.projectionCenterLonLat_=null,this.meridiansLabels_=null,this.parallelsLabels_=null,1==i.showLabels&&(this.lonLabelFormatter_=null==i.lonLabelFormatter?t.degreesToStringHDMS.bind(this,"EW"):i.lonLabelFormatter,this.latLabelFormatter_=null==i.latLabelFormatter?t.degreesToStringHDMS.bind(this,"NS"):i.latLabelFormatter,this.lonLabelPosition_=null==i.lonLabelPosition?0:i.lonLabelPosition,this.latLabelPosition_=null==i.latLabelPosition?1:i.latLabelPosition,this.lonLabelStyle_=void 0!==i.lonLabelStyle?i.lonLabelStyle:new g.default({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new u.default({color:"rgba(0,0,0,1)"}),stroke:new c.default({color:"rgba(255,255,255,1)",width:3})}),this.latLabelStyle_=void 0!==i.latLabelStyle?i.latLabelStyle:new g.default({font:"12px Calibri,sans-serif",textAlign:"end",fill:new u.default({color:"rgba(0,0,0,1)"}),stroke:new c.default({color:"rgba(255,255,255,1)",width:3})}),this.meridiansLabels_=[],this.parallelsLabels_=[]),this.setMap(void 0!==i.map?i.map:null)};M.prototype.addMeridian_=function(t,e,a,s,l,n){const o=this.getMeridian_(t,e,a,s,n);if((0,i.intersects)(o.getExtent(),l)){if(this.meridiansLabels_){const e=this.getMeridianPoint_(o,l,n);this.meridiansLabels_[n]={geom:e,text:this.lonLabelFormatter_(t)}}this.meridians_[n++]=o}return n},M.prototype.getMeridianPoint_=function(t,e,i){const a=t.getFlatCoordinates(),s=Math.max(e[1],a[1]),l=Math.min(e[3],a[a.length-1]),n=(0,_.clamp)(e[1]+Math.abs(e[1]-e[3])*this.lonLabelPosition_,s,l),o=[a[0],n],h=void 0!==this.meridiansLabels_[i]?this.meridiansLabels_[i].geom:new r.default(null);return h.setCoordinates(o),h},M.prototype.addParallel_=function(t,e,a,s,l,n){const o=this.getParallel_(t,e,a,s,n);if((0,i.intersects)(o.getExtent(),l)){if(this.parallelsLabels_){const e=this.getParallelPoint_(o,l,n);this.parallelsLabels_[n]={geom:e,text:this.latLabelFormatter_(t)}}this.parallels_[n++]=o}return n},M.prototype.getParallelPoint_=function(t,e,i){const a=t.getFlatCoordinates(),s=Math.max(e[0],a[0]),l=Math.min(e[2],a[a.length-2]),n=[(0,_.clamp)(e[0]+Math.abs(e[0]-e[2])*this.latLabelPosition_,s,l),a[1]],o=void 0!==this.parallelsLabels_[i]?this.parallelsLabels_[i].geom:new r.default(null);return o.setCoordinates(n),o},M.prototype.createGraticule_=function(t,e,i,a){const s=this.getInterval_(i);if(-1==s)return this.meridians_.length=this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),void(this.parallelsLabels_&&(this.parallelsLabels_.length=0));const l=this.toLonLatTransform_(e);let n=l[0],o=l[1];const r=this.maxLines_;let h,L,d,p,u=[Math.max(t[0],this.minLonP_),Math.max(t[1],this.minLatP_),Math.min(t[2],this.maxLonP_),Math.min(t[3],this.maxLatP_)];const f=(u=(0,m.transformExtent)(u,this.projection_,"EPSG:4326"))[3],c=u[2],b=u[1],g=u[0];for(n=Math.floor(n/s)*s,p=(0,_.clamp)(n,this.minLon_,this.maxLon_),L=this.addMeridian_(p,b,f,a,t,0),h=0;p!=this.minLon_&&h++<r;)p=Math.max(p-s,this.minLon_),L=this.addMeridian_(p,b,f,a,t,L);for(p=(0,_.clamp)(n,this.minLon_,this.maxLon_),h=0;p!=this.maxLon_&&h++<r;)p=Math.min(p+s,this.maxLon_),L=this.addMeridian_(p,b,f,a,t,L);for(this.meridians_.length=L,this.meridiansLabels_&&(this.meridiansLabels_.length=L),o=Math.floor(o/s)*s,d=(0,_.clamp)(o,this.minLat_,this.maxLat_),L=this.addParallel_(d,g,c,a,t,0),h=0;d!=this.minLat_&&h++<r;)d=Math.max(d-s,this.minLat_),L=this.addParallel_(d,g,c,a,t,L);for(d=(0,_.clamp)(o,this.minLat_,this.maxLat_),h=0;d!=this.maxLat_&&h++<r;)d=Math.min(d+s,this.maxLat_),L=this.addParallel_(d,g,c,a,t,L);this.parallels_.length=L,this.parallelsLabels_&&(this.parallelsLabels_.length=L)},M.prototype.getInterval_=function(t){const e=this.projectionCenterLonLat_[0],i=this.projectionCenterLonLat_[1];let a=-1;const s=Math.pow(this.targetSize_*t,2),l=[],n=[];for(let t=0,o=P.length;t<o;++t){const o=P[t]/2;if(l[0]=e-o,l[1]=i-o,n[0]=e+o,n[1]=i+o,this.fromLonLatTransform_(l,l),this.fromLonLatTransform_(n,n),Math.pow(n[0]-l[0],2)+Math.pow(n[1]-l[1],2)<=s)break;a=P[t]}return a},M.prototype.getMap=function(){return this.map_},M.prototype.getMeridian_=function(t,e,i,a,l){const o=(0,h.meridian)(t,e,i,this.projection_,a),r=void 0!==this.meridians_[l]?this.meridians_[l]:new n.default(null);return r.setFlatCoordinates(s.default.XY,o),r},M.prototype.getMeridians=function(){return this.meridians_},M.prototype.getParallel_=function(t,e,i,a,l){const o=(0,h.parallel)(t,e,i,this.projection_,a),r=void 0!==this.parallels_[l]?this.parallels_[l]:new n.default(null);return r.setFlatCoordinates(s.default.XY,o),r},M.prototype.getParallels=function(){return this.parallels_},M.prototype.handlePostCompose_=function(t){const e=t.vectorContext,i=t.frameState,a=i.extent,s=i.viewState,l=s.center,n=s.projection,o=s.resolution,r=i.pixelRatio,h=o*o/(4*r*r);let _,L,d,p;for((!this.projection_||!(0,m.equivalent)(this.projection_,n))&&this.updateProjectionInfo_(n),this.createGraticule_(a,l,o,h),e.setFillStrokeStyle(null,this.strokeStyle_),_=0,L=this.meridians_.length;_<L;++_)d=this.meridians_[_],e.drawGeometry(d);for(_=0,L=this.parallels_.length;_<L;++_)d=this.parallels_[_],e.drawGeometry(d);if(this.meridiansLabels_)for(_=0,L=this.meridiansLabels_.length;_<L;++_)p=this.meridiansLabels_[_],this.lonLabelStyle_.setText(p.text),e.setTextStyle(this.lonLabelStyle_),e.drawGeometry(p.geom);if(this.parallelsLabels_)for(_=0,L=this.parallelsLabels_.length;_<L;++_)p=this.parallelsLabels_[_],this.latLabelStyle_.setText(p.text),e.setTextStyle(this.latLabelStyle_),e.drawGeometry(p.geom)},M.prototype.updateProjectionInfo_=function(t){const e=(0,m.get)("EPSG:4326"),a=t.getWorldExtent(),s=(0,m.transformExtent)(a,e,t);this.maxLat_=a[3],this.maxLon_=a[2],this.minLat_=a[1],this.minLon_=a[0],this.maxLatP_=s[3],this.maxLonP_=s[2],this.minLatP_=s[1],this.minLonP_=s[0],this.fromLonLatTransform_=(0,m.getTransform)(e,t),this.toLonLatTransform_=(0,m.getTransform)(t,e),this.projectionCenterLonLat_=this.toLonLatTransform_((0,i.getCenter)(t.getExtent())),this.projection_=t},M.prototype.setMap=function(t){this.map_&&((0,e.unlistenByKey)(this.postcomposeListenerKey_),this.postcomposeListenerKey_=null,this.map_.render()),t&&(this.postcomposeListenerKey_=(0,e.listen)(t,d.default.POSTCOMPOSE,this.handlePostCompose_,this),t.render()),this.map_=t},exports.default=M;
},{"./coordinate.js":89,"./events.js":84,"./extent.js":90,"./geom/GeometryLayout.js":114,"./geom/LineString.js":115,"./geom/Point.js":116,"./geom/flat/geodesic.js":134,"./math.js":87,"./proj.js":88,"./render/EventType.js":120,"./style/Fill.js":117,"./style/Stroke.js":118,"./style/Text.js":119}],22:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./util.js"),e=require("./events/EventTarget.js"),o=r(e),n=require("./events/EventType.js"),i=r(n);function r(t){return t&&t.__esModule?t:{default:t}}const u=function(t,e,n,i){o.default.call(this),this.extent=t,this.pixelRatio_=n,this.resolution=e,this.state=i};(0,t.inherits)(u,o.default),u.prototype.changed=function(){this.dispatchEvent(i.default.CHANGE)},u.prototype.getExtent=function(){return this.extent},u.prototype.getImage=function(){},u.prototype.getPixelRatio=function(){return this.pixelRatio_},u.prototype.getResolution=function(){return this.resolution},u.prototype.getState=function(){return this.state},u.prototype.load=function(){},exports.default=u;
},{"./util.js":43,"./events/EventTarget.js":121,"./events/EventType.js":110}],21:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./util.js"),t=require("./ImageBase.js"),i=o(t),s=require("./ImageState.js"),a=o(s),n=require("./events.js"),h=require("./events/EventType.js"),r=o(h),u=require("./extent.js");function o(e){return e&&e.__esModule?e:{default:e}}const l=function(e,t,s,n,h,r){i.default.call(this,e,t,s,a.default.IDLE),this.src_=n,this.image_=new Image,null!==h&&(this.image_.crossOrigin=h),this.imageListenerKeys_=null,this.state=a.default.IDLE,this.imageLoadFunction_=r};(0,e.inherits)(l,i.default),l.prototype.getImage=function(){return this.image_},l.prototype.handleImageError_=function(){this.state=a.default.ERROR,this.unlistenImage_(),this.changed()},l.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=(0,u.getHeight)(this.extent)/this.image_.height),this.state=a.default.LOADED,this.unlistenImage_(),this.changed()},l.prototype.load=function(){this.state!=a.default.IDLE&&this.state!=a.default.ERROR||(this.state=a.default.LOADING,this.changed(),this.imageListenerKeys_=[(0,n.listenOnce)(this.image_,r.default.ERROR,this.handleImageError_,this),(0,n.listenOnce)(this.image_,r.default.LOAD,this.handleImageLoad_,this)],this.imageLoadFunction_(this,this.src_))},l.prototype.setImage=function(e){this.image_=e},l.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(n.unlistenByKey),this.imageListenerKeys_=null},exports.default=l;
},{"./util.js":43,"./ImageBase.js":22,"./ImageState.js":91,"./events.js":84,"./events/EventType.js":110,"./extent.js":90}],23:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./util.js"),e=require("./ImageBase.js"),r=i(e),a=require("./ImageState.js"),s=i(a);function i(t){return t&&t.__esModule?t:{default:t}}const o=function(t,e,a,i,o){this.loader_=void 0!==o?o:null;const u=void 0!==o?s.default.IDLE:s.default.LOADED;r.default.call(this,t,e,a,u),this.canvas_=i,this.error_=null};(0,t.inherits)(o,r.default),o.prototype.getError=function(){return this.error_},o.prototype.handleLoad_=function(t){t?(this.error_=t,this.state=s.default.ERROR):this.state=s.default.LOADED,this.changed()},o.prototype.load=function(){this.state==s.default.IDLE&&(this.state=s.default.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))},o.prototype.getImage=function(){return this.canvas_},exports.default=o;
},{"./util.js":43,"./ImageBase.js":22,"./ImageState.js":91}],92:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5};
},{}],106:[function(require,module,exports) {
"use strict";function e(e){return Math.pow(e,3)}function t(t){return 1-e(1-t)}function n(e){return 3*e*e-2*e*e*e}function r(e){return e}function u(e){return e<.5?n(2*e):1-n(2*(e-.5))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.easeIn=e,exports.easeOut=t,exports.inAndOut=n,exports.linear=r,exports.upAndDown=u;
},{}],35:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./util.js"),i=require("./TileState.js"),e=u(i),n=require("./easing.js"),r=require("./events/EventTarget.js"),s=u(r),o=require("./events/EventType.js"),a=u(o);function u(t){return t&&t.__esModule?t:{default:t}}const l=function(t,i,e){s.default.call(this);const n=e||{};this.tileCoord=t,this.state=i,this.interimTile=null,this.key="",this.transition_=void 0===n.transition?250:n.transition,this.transitionStarts_={}};(0,t.inherits)(l,s.default),l.prototype.changed=function(){this.dispatchEvent(a.default.CHANGE)},l.prototype.getKey=function(){return this.key+"/"+this.tileCoord},l.prototype.getInterimTile=function(){if(!this.interimTile)return this;let t=this.interimTile;do{if(t.getState()==e.default.LOADED)return t;t=t.interimTile}while(t);return this},l.prototype.refreshInterimChain=function(){if(!this.interimTile)return;let t=this.interimTile,i=this;do{if(t.getState()==e.default.LOADED){t.interimTile=null;break}t.getState()==e.default.LOADING?i=t:t.getState()==e.default.IDLE?i.interimTile=t.interimTile:i=t,t=i.interimTile}while(t)},l.prototype.getTileCoord=function(){return this.tileCoord},l.prototype.getState=function(){return this.state},l.prototype.setState=function(t){this.state=t,this.changed()},l.prototype.load=function(){},l.prototype.getAlpha=function(t,i){if(!this.transition_)return 1;let e=this.transitionStarts_[t];if(e){if(-1===e)return 1}else e=i,this.transitionStarts_[t]=e;const r=i-e+1e3/60;return r>=this.transition_?1:(0,n.easeIn)(r/this.transition_)},l.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},l.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},exports.default=l;
},{"./util.js":43,"./TileState.js":92,"./easing.js":106,"./events/EventTarget.js":121,"./events/EventType.js":110}],24:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./util.js"),e=require("./Tile.js"),i=u(e),s=require("./TileState.js"),n=u(s),a=require("./dom.js"),r=require("./events.js"),h=require("./events/EventType.js"),l=u(h);function u(t){return t&&t.__esModule?t:{default:t}}const o=function(t,e,s,n,a,r){i.default.call(this,t,e,r),this.crossOrigin_=n,this.src_=s,this.image_=new Image,null!==n&&(this.image_.crossOrigin=n),this.imageListenerKeys_=null,this.tileLoadFunction_=a};function g(){const t=(0,a.createCanvasContext2D)(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(0,t.inherits)(o,i.default),o.prototype.disposeInternal=function(){this.state==n.default.LOADING&&(this.unlistenImage_(),this.image_=g()),this.interimTile&&this.interimTile.dispose(),this.state=n.default.ABORT,this.changed(),i.default.prototype.disposeInternal.call(this)},o.prototype.getImage=function(){return this.image_},o.prototype.getKey=function(){return this.src_},o.prototype.handleImageError_=function(){this.state=n.default.ERROR,this.unlistenImage_(),this.image_=g(),this.changed()},o.prototype.handleImageLoad_=function(){this.image_.naturalWidth&&this.image_.naturalHeight?this.state=n.default.LOADED:this.state=n.default.EMPTY,this.unlistenImage_(),this.changed()},o.prototype.load=function(){this.state==n.default.ERROR&&(this.state=n.default.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==n.default.IDLE&&(this.state=n.default.LOADING,this.changed(),this.imageListenerKeys_=[(0,r.listenOnce)(this.image_,l.default.ERROR,this.handleImageError_,this),(0,r.listenOnce)(this.image_,l.default.LOAD,this.handleImageLoad_,this)],this.tileLoadFunction_(this,this.src_))},o.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(r.unlistenByKey),this.imageListenerKeys_=null},exports.default=o;
},{"./util.js":43,"./Tile.js":35,"./TileState.js":92,"./dom.js":93,"./events.js":84,"./events/EventType.js":110}],25:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(t,i,n){this.decay_=t,this.minVelocity_=i,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0};t.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},t.prototype.update=function(t,i){this.points_.push(t,i,Date.now())},t.prototype.end=function(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,i=this.points_.length-3;if(this.points_[i+2]<t)return!1;let n=i-3;for(;n>0&&this.points_[n+2]>t;)n-=3;const s=this.points_[i+2]-this.points_[n+2];if(s<1e3/60)return!1;const e=this.points_[i]-this.points_[n],o=this.points_[i+1]-this.points_[n+1];return this.angle_=Math.atan2(o,e),this.initialVelocity_=Math.sqrt(e*e+o*o)/s,this.initialVelocity_>this.minVelocity_},t.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},t.prototype.getAngle=function(){return this.angle_},exports.default=t;
},{}],30:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./util.js"),t=require("./events/Event.js"),u=r(t);function r(e){return e&&e.__esModule?e:{default:e}}const s=function(e,t,r){u.default.call(this,e),this.map=t,this.frameState=void 0!==r?r:null};(0,e.inherits)(s,u.default),exports.default=s;
},{"./util.js":43,"./events/Event.js":123}],27:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./util.js"),e=require("./MapEvent.js"),i=o(e);function o(t){return t&&t.__esModule?t:{default:t}}const r=function(t,e,o,r,n){i.default.call(this,t,e,n),this.originalEvent=o,this.pixel=e.getEventPixel(o),this.coordinate=e.getCoordinateFromPixel(this.pixel),this.dragging=void 0!==r&&r};(0,t.inherits)(r,i.default),r.prototype.preventDefault=function(){i.default.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},r.prototype.stopPropagation=function(){i.default.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},exports.default=r;
},{"./util.js":43,"./MapEvent.js":30}],95:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./events/EventType.js"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}exports.default={SINGLECLICK:"singleclick",CLICK:t.default.CLICK,DBLCLICK:t.default.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};
},{"./events/EventType.js":110}],29:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./util.js"),t=require("./MapBrowserEvent.js"),r=i(t);function i(e){return e&&e.__esModule?e:{default:e}}const u=function(e,t,i,u,n){r.default.call(this,e,t,i.originalEvent,u,n),this.pointerEvent=i};(0,e.inherits)(u,r.default),exports.default=u;
},{"./util.js":43,"./MapBrowserEvent.js":27}],124:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};
},{}],254:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(t,e){this.dispatcher=t,this.mapping_=e};t.prototype.getEvents=function(){return Object.keys(this.mapping_)},t.prototype.getHandlerForEvent=function(t){return this.mapping_[t]},exports.default=t;
},{}],210:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.POINTER_TYPE=exports.POINTER_ID=void 0;var t=require("../util.js"),e=require("../pointer/EventSource.js"),o=s(e);function s(t){return t&&t.__esModule?t:{default:t}}const i=function(t){const e={mousedown:this.mousedown,mousemove:this.mousemove,mouseup:this.mouseup,mouseover:this.mouseover,mouseout:this.mouseout};o.default.call(this,t,e),this.pointerMap=t.pointerMap,this.lastTouches=[]};(0,t.inherits)(i,o.default);const n=exports.POINTER_ID=1,u=exports.POINTER_TYPE="mouse",r=25;function c(t,e){const o=e.cloneEvent(t,t),s=o.preventDefault;return o.preventDefault=function(){t.preventDefault(),s()},o.pointerId=n,o.isPrimary=!0,o.pointerType=u,o}i.prototype.isEventSimulatedFromTouch_=function(t){const e=this.lastTouches,o=t.clientX,s=t.clientY;for(let t,i=0,n=e.length;i<n&&(t=e[i]);i++){const e=Math.abs(o-t[0]),i=Math.abs(s-t[1]);if(e<=25&&i<=25)return!0}return!1},i.prototype.mousedown=function(t){if(!this.isEventSimulatedFromTouch_(t)){n.toString()in this.pointerMap&&this.cancel(t);const e=c(t,this.dispatcher);this.pointerMap[n.toString()]=t,this.dispatcher.down(e,t)}},i.prototype.mousemove=function(t){if(!this.isEventSimulatedFromTouch_(t)){const e=c(t,this.dispatcher);this.dispatcher.move(e,t)}},i.prototype.mouseup=function(t){if(!this.isEventSimulatedFromTouch_(t)){const e=this.pointerMap[n.toString()];if(e&&e.button===t.button){const e=c(t,this.dispatcher);this.dispatcher.up(e,t),this.cleanupMouse()}}},i.prototype.mouseover=function(t){if(!this.isEventSimulatedFromTouch_(t)){const e=c(t,this.dispatcher);this.dispatcher.enterOver(e,t)}},i.prototype.mouseout=function(t){if(!this.isEventSimulatedFromTouch_(t)){const e=c(t,this.dispatcher);this.dispatcher.leaveOut(e,t)}},i.prototype.cancel=function(t){const e=c(t,this.dispatcher);this.dispatcher.cancel(e,t),this.cleanupMouse()},i.prototype.cleanupMouse=function(){delete this.pointerMap[n.toString()]},exports.default=i;
},{"../util.js":43,"../pointer/EventSource.js":254}],211:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../pointer/EventSource.js"),o=n(e);function n(t){return t&&t.__esModule?t:{default:t}}const r=function(t){const e={MSPointerDown:this.msPointerDown,MSPointerMove:this.msPointerMove,MSPointerUp:this.msPointerUp,MSPointerOut:this.msPointerOut,MSPointerOver:this.msPointerOver,MSPointerCancel:this.msPointerCancel,MSGotPointerCapture:this.msGotPointerCapture,MSLostPointerCapture:this.msLostPointerCapture};o.default.call(this,t,e),this.pointerMap=t.pointerMap};(0,t.inherits)(r,o.default);const i=["","unavailable","touch","pen","mouse"];r.prototype.prepareEvent_=function(t){let e=t;return"number"==typeof t.pointerType&&((e=this.dispatcher.cloneEvent(t,t)).pointerType=i[t.pointerType]),e},r.prototype.cleanup=function(t){delete this.pointerMap[t.toString()]},r.prototype.msPointerDown=function(t){this.pointerMap[t.pointerId.toString()]=t;const e=this.prepareEvent_(t);this.dispatcher.down(e,t)},r.prototype.msPointerMove=function(t){const e=this.prepareEvent_(t);this.dispatcher.move(e,t)},r.prototype.msPointerUp=function(t){const e=this.prepareEvent_(t);this.dispatcher.up(e,t),this.cleanup(t.pointerId)},r.prototype.msPointerOut=function(t){const e=this.prepareEvent_(t);this.dispatcher.leaveOut(e,t)},r.prototype.msPointerOver=function(t){const e=this.prepareEvent_(t);this.dispatcher.enterOver(e,t)},r.prototype.msPointerCancel=function(t){const e=this.prepareEvent_(t);this.dispatcher.cancel(e,t),this.cleanup(t.pointerId)},r.prototype.msLostPointerCapture=function(t){const e=this.dispatcher.makeEvent("lostpointercapture",t,t);this.dispatcher.dispatchEvent(e)},r.prototype.msGotPointerCapture=function(t){const e=this.dispatcher.makeEvent("gotpointercapture",t,t);this.dispatcher.dispatchEvent(e)},exports.default=r;
},{"../util.js":43,"../pointer/EventSource.js":254}],212:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../pointer/EventSource.js"),i=o(e);function o(t){return t&&t.__esModule?t:{default:t}}const r=function(t){const e={pointerdown:this.pointerDown,pointermove:this.pointerMove,pointerup:this.pointerUp,pointerout:this.pointerOut,pointerover:this.pointerOver,pointercancel:this.pointerCancel,gotpointercapture:this.gotPointerCapture,lostpointercapture:this.lostPointerCapture};i.default.call(this,t,e)};(0,t.inherits)(r,i.default),r.prototype.pointerDown=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.pointerMove=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.pointerUp=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.pointerOut=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.pointerOver=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.pointerCancel=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.lostPointerCapture=function(t){this.dispatcher.fireNativeEvent(t)},r.prototype.gotPointerCapture=function(t){this.dispatcher.fireNativeEvent(t)},exports.default=r;
},{"../util.js":43,"../pointer/EventSource.js":254}],213:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../events/Event.js"),i=n(e);function n(t){return t&&t.__esModule?t:{default:t}}const s=function(t,e,n){i.default.call(this,t),this.originalEvent=e;const s=n||{};this.buttons=this.getButtons_(s),this.pressure=this.getPressure_(s,this.buttons),this.bubbles="bubbles"in s&&s.bubbles,this.cancelable="cancelable"in s&&s.cancelable,this.view="view"in s?s.view:null,this.detail="detail"in s?s.detail:null,this.screenX="screenX"in s?s.screenX:0,this.screenY="screenY"in s?s.screenY:0,this.clientX="clientX"in s?s.clientX:0,this.clientY="clientY"in s?s.clientY:0,this.ctrlKey="ctrlKey"in s&&s.ctrlKey,this.altKey="altKey"in s&&s.altKey,this.shiftKey="shiftKey"in s&&s.shiftKey,this.metaKey="metaKey"in s&&s.metaKey,this.button="button"in s?s.button:0,this.relatedTarget="relatedTarget"in s?s.relatedTarget:null,this.pointerId="pointerId"in s?s.pointerId:0,this.width="width"in s?s.width:0,this.height="height"in s?s.height:0,this.tiltX="tiltX"in s?s.tiltX:0,this.tiltY="tiltY"in s?s.tiltY:0,this.pointerType="pointerType"in s?s.pointerType:"",this.hwTimestamp="hwTimestamp"in s?s.hwTimestamp:0,this.isPrimary="isPrimary"in s&&s.isPrimary,e.preventDefault&&(this.preventDefault=function(){e.preventDefault()})};(0,t.inherits)(s,i.default);let r=!1;s.prototype.getButtons_=function(t){let e;if(t.buttons||r)e=t.buttons;else switch(t.which){case 1:e=1;break;case 2:e=4;break;case 3:e=2;break;default:e=0}return e},s.prototype.getPressure_=function(t,e){let i=0;return i=t.pressure?t.pressure:e?.5:0},function(){try{const t=new MouseEvent("click",{buttons:1});r=1===t.buttons}catch(t){}}(),exports.default=s;
},{"../util.js":43,"../events/Event.js":123}],214:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../array.js"),o=require("../pointer/EventSource.js"),i=s(o),r=require("../pointer/MouseSource.js");function s(t){return t&&t.__esModule?t:{default:t}}const n=function(t,e){const o={touchstart:this.touchstart,touchmove:this.touchmove,touchend:this.touchend,touchcancel:this.touchcancel};i.default.call(this,t,o),this.pointerMap=t.pointerMap,this.mouseSource=e,this.firstTouchId_=void 0,this.clickCount_=0,this.resetId_=void 0,this.dedupTimeout_=2500};(0,t.inherits)(n,i.default);const c=200,u="touch";n.prototype.isPrimaryTouch_=function(t){return this.firstTouchId_===t.identifier},n.prototype.setPrimaryTouch_=function(t){const e=Object.keys(this.pointerMap).length;(0===e||1===e&&r.POINTER_ID.toString()in this.pointerMap)&&(this.firstTouchId_=t.identifier,this.cancelResetClickCount_())},n.prototype.removePrimaryPointer_=function(t){t.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())},n.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),200)},n.prototype.resetClickCountHandler_=function(){this.clickCount_=0,this.resetId_=void 0},n.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)},n.prototype.touchToPointer_=function(t,e){const o=this.dispatcher.cloneEvent(t,e);return o.pointerId=e.identifier+2,o.bubbles=!0,o.cancelable=!0,o.detail=this.clickCount_,o.button=0,o.buttons=1,o.width=e.webkitRadiusX||e.radiusX||0,o.height=e.webkitRadiusY||e.radiusY||0,o.pressure=e.webkitForce||e.force||.5,o.isPrimary=this.isPrimaryTouch_(e),o.pointerType="touch",o.clientX=e.clientX,o.clientY=e.clientY,o.screenX=e.screenX,o.screenY=e.screenY,o},n.prototype.processTouches_=function(t,e){const o=Array.prototype.slice.call(t.changedTouches),i=o.length;function r(){t.preventDefault()}for(let s=0;s<i;++s){const i=this.touchToPointer_(t,o[s]);i.preventDefault=r,e.call(this,t,i)}},n.prototype.findTouch_=function(t,e){const o=t.length;for(let i=0;i<o;i++){if(t[i].identifier===e)return!0}return!1},n.prototype.vacuumTouches_=function(t){const e=t.touches,o=Object.keys(this.pointerMap),i=o.length;if(i>=e.length){const s=[];for(let t=0;t<i;++t){const i=o[t],n=this.pointerMap[i];i==r.POINTER_ID||this.findTouch_(e,i-2)||s.push(n.out)}for(let e=0;e<s.length;++e)this.cancelOut_(t,s[e])}},n.prototype.touchstart=function(t){this.vacuumTouches_(t),this.setPrimaryTouch_(t.changedTouches[0]),this.dedupSynthMouse_(t),this.clickCount_++,this.processTouches_(t,this.overDown_)},n.prototype.overDown_=function(t,e){this.pointerMap[e.pointerId]={target:e.target,out:e,outTarget:e.target},this.dispatcher.over(e,t),this.dispatcher.enter(e,t),this.dispatcher.down(e,t)},n.prototype.touchmove=function(t){t.preventDefault(),this.processTouches_(t,this.moveOverOut_)},n.prototype.moveOverOut_=function(t,e){const o=e,i=this.pointerMap[o.pointerId];if(!i)return;const r=i.out,s=i.outTarget;this.dispatcher.move(o,t),r&&s!==o.target&&(r.relatedTarget=o.target,o.relatedTarget=s,r.target=s,o.target?(this.dispatcher.leaveOut(r,t),this.dispatcher.enterOver(o,t)):(o.target=s,o.relatedTarget=null,this.cancelOut_(t,o))),i.out=o,i.outTarget=o.target},n.prototype.touchend=function(t){this.dedupSynthMouse_(t),this.processTouches_(t,this.upOut_)},n.prototype.upOut_=function(t,e){this.dispatcher.up(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},n.prototype.touchcancel=function(t){this.processTouches_(t,this.cancelOut_)},n.prototype.cancelOut_=function(t,e){this.dispatcher.cancel(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},n.prototype.cleanUpPointer_=function(t){delete this.pointerMap[t.pointerId],this.removePrimaryPointer_(t)},n.prototype.dedupSynthMouse_=function(t){const o=this.mouseSource.lastTouches,i=t.changedTouches[0];if(this.isPrimaryTouch_(i)){const t=[i.clientX,i.clientY];o.push(t),setTimeout(function(){(0,e.remove)(o,t)},this.dedupTimeout_)}},exports.default=n;
},{"../util.js":43,"../array.js":130,"../pointer/EventSource.js":254,"../pointer/MouseSource.js":210}],125:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../events.js"),n=require("../events/EventTarget.js"),i=y(n),r=require("../has.js"),o=require("../pointer/EventType.js"),s=y(o),u=require("../pointer/MouseSource.js"),c=y(u),p=require("../pointer/MsSource.js"),l=y(p),a=require("../pointer/NativeSource.js"),h=y(a),f=require("../pointer/PointerEvent.js"),v=y(f),E=require("../pointer/TouchSource.js"),d=y(E);function y(t){return t&&t.__esModule?t:{default:t}}const _=function(t){i.default.call(this),this.element_=t,this.pointerMap={},this.eventMap_={},this.eventSourceList_=[],this.registerSources()};(0,t.inherits)(_,i.default);const g=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]];_.prototype.registerSources=function(){if(r.POINTER)this.registerSource("native",new h.default(this));else if(r.MSPOINTER)this.registerSource("ms",new l.default(this));else{const t=new c.default(this);this.registerSource("mouse",t),r.TOUCH&&this.registerSource("touch",new d.default(this,t))}this.register_()},_.prototype.registerSource=function(t,e){const n=e,i=n.getEvents();i&&(i.forEach(function(t){const e=n.getHandlerForEvent(t);e&&(this.eventMap_[t]=e.bind(n))}.bind(this)),this.eventSourceList_.push(n))},_.prototype.register_=function(){const t=this.eventSourceList_.length;for(let e=0;e<t;e++){const t=this.eventSourceList_[e];this.addEvents_(t.getEvents())}},_.prototype.unregister_=function(){const t=this.eventSourceList_.length;for(let e=0;e<t;e++){const t=this.eventSourceList_[e];this.removeEvents_(t.getEvents())}},_.prototype.eventHandler_=function(t){const e=t.type,n=this.eventMap_[e];n&&n(t)},_.prototype.addEvents_=function(t){t.forEach(function(t){(0,e.listen)(this.element_,t,this.eventHandler_,this)}.bind(this))},_.prototype.removeEvents_=function(t){t.forEach(function(t){(0,e.unlisten)(this.element_,t,this.eventHandler_,this)}.bind(this))},_.prototype.cloneEvent=function(t,e){const n={};for(let i=0,r=g.length;i<r;i++){const r=g[i][0];n[r]=t[r]||e[r]||g[i][1]}return n},_.prototype.down=function(t,e){this.fireEvent(s.default.POINTERDOWN,t,e)},_.prototype.move=function(t,e){this.fireEvent(s.default.POINTERMOVE,t,e)},_.prototype.up=function(t,e){this.fireEvent(s.default.POINTERUP,t,e)},_.prototype.enter=function(t,e){t.bubbles=!1,this.fireEvent(s.default.POINTERENTER,t,e)},_.prototype.leave=function(t,e){t.bubbles=!1,this.fireEvent(s.default.POINTERLEAVE,t,e)},_.prototype.over=function(t,e){t.bubbles=!0,this.fireEvent(s.default.POINTEROVER,t,e)},_.prototype.out=function(t,e){t.bubbles=!0,this.fireEvent(s.default.POINTEROUT,t,e)},_.prototype.cancel=function(t,e){this.fireEvent(s.default.POINTERCANCEL,t,e)},_.prototype.leaveOut=function(t,e){this.out(t,e),this.contains_(t.target,t.relatedTarget)||this.leave(t,e)},_.prototype.enterOver=function(t,e){this.over(t,e),this.contains_(t.target,t.relatedTarget)||this.enter(t,e)},_.prototype.contains_=function(t,e){return!(!t||!e)&&t.contains(e)},_.prototype.makeEvent=function(t,e,n){return new v.default(t,n,e)},_.prototype.fireEvent=function(t,e,n){const i=this.makeEvent(t,e,n);this.dispatchEvent(i)},_.prototype.fireNativeEvent=function(t){const e=this.makeEvent(t.type,t,t);this.dispatchEvent(e)},_.prototype.wrapMouseEvent=function(t,e){return this.makeEvent(t,c.default.prepareEvent(e,this),e)},_.prototype.disposeInternal=function(){this.unregister_(),i.default.prototype.disposeInternal.call(this)},exports.default=_;
},{"../util.js":43,"../events.js":84,"../events/EventTarget.js":121,"../has.js":86,"../pointer/EventType.js":124,"../pointer/MouseSource.js":210,"../pointer/MsSource.js":211,"../pointer/NativeSource.js":212,"../pointer/PointerEvent.js":213,"../pointer/TouchSource.js":214}],28:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./util.js"),e=require("./has.js"),i=require("./MapBrowserEventType.js"),n=c(i),s=require("./MapBrowserPointerEvent.js"),o=c(s),r=require("./events.js"),h=require("./events/EventTarget.js"),d=c(h),a=require("./pointer/EventType.js"),l=c(a),u=require("./pointer/PointerEventHandler.js"),_=c(u);function c(t){return t&&t.__esModule?t:{default:t}}const p=function(t,i){d.default.call(this),this.map_=t,this.clickTimeoutId_=0,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=i?i*e.DEVICE_PIXEL_RATIO:e.DEVICE_PIXEL_RATIO,this.down_=null;const n=this.map_.getViewport();this.activePointers_=0,this.trackedTouches_={},this.pointerEventHandler_=new _.default(n),this.documentPointerEventHandler_=null,this.pointerdownListenerKey_=(0,r.listen)(this.pointerEventHandler_,l.default.POINTERDOWN,this.handlePointerDown_,this),this.relayedListenerKey_=(0,r.listen)(this.pointerEventHandler_,l.default.POINTERMOVE,this.relayEvent_,this)};(0,t.inherits)(p,d.default),p.prototype.emulateClick_=function(t){let e=new o.default(n.default.CLICK,this.map_,t);this.dispatchEvent(e),0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=0,e=new o.default(n.default.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=0;const e=new o.default(n.default.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},p.prototype.updateActivePointers_=function(t){const e=t;e.type==n.default.POINTERUP||e.type==n.default.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==n.default.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},p.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);const e=new o.default(n.default.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(r.unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null)},p.prototype.isMouseActionButton_=function(t){return 0===t.button},p.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);const e=new o.default(n.default.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new _.default(document),this.dragListenerKeys_.push((0,r.listen)(this.documentPointerEventHandler_,n.default.POINTERMOVE,this.handlePointerMove_,this),(0,r.listen)(this.documentPointerEventHandler_,n.default.POINTERUP,this.handlePointerUp_,this),(0,r.listen)(this.pointerEventHandler_,n.default.POINTERCANCEL,this.handlePointerUp_,this)))},p.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;const e=new o.default(n.default.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}t.preventDefault()},p.prototype.relayEvent_=function(t){const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new o.default(t.type,this.map_,t,e))},p.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},p.prototype.disposeInternal=function(){this.relayedListenerKey_&&((0,r.unlistenByKey)(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&((0,r.unlistenByKey)(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(r.unlistenByKey),this.dragListenerKeys_.length=0,this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null),this.pointerEventHandler_&&(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null),d.default.prototype.disposeInternal.call(this)},exports.default=p;
},{"./util.js":43,"./has.js":86,"./MapBrowserEventType.js":95,"./MapBrowserPointerEvent.js":29,"./events.js":84,"./events/EventTarget.js":121,"./pointer/EventType.js":124,"./pointer/PointerEventHandler.js":125}],97:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"};
},{}],101:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};
},{}],132:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DROP=void 0;var t=require("../asserts.js"),e=require("../obj.js");const i=function(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}},n=exports.DROP=1/0;i.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,(0,e.clear)(this.queuedElements_)},i.prototype.dequeue=function(){const t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i},i.prototype.enqueue=function(e){(0,t.assert)(!(this.keyFunction_(e)in this.queuedElements_),31);const i=this.priorityFunction_(e);return i!=n&&(this.elements_.push(e),this.priorities_.push(i),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},i.prototype.getCount=function(){return this.elements_.length},i.prototype.getLeftChildIndex_=function(t){return 2*t+1},i.prototype.getRightChildIndex_=function(t){return 2*t+2},i.prototype.getParentIndex_=function(t){return t-1>>1},i.prototype.heapify_=function(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},i.prototype.isEmpty=function(){return 0===this.elements_.length},i.prototype.isKeyQueued=function(t){return t in this.queuedElements_},i.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},i.prototype.siftUp_=function(t){const e=this.elements_,i=this.priorities_,n=e.length,s=e[t],o=i[t],r=t;for(;t<n>>1;){const s=this.getLeftChildIndex_(t),o=this.getRightChildIndex_(t),r=o<n&&i[o]<i[s]?o:s;e[t]=e[r],i[t]=i[r],t=r}e[t]=s,i[t]=o,this.siftDown_(r,t)},i.prototype.siftDown_=function(t,e){const i=this.elements_,n=this.priorities_,s=i[e],o=n[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(n[t]>o))break;i[e]=i[t],n[e]=n[t],e=t}i[e]=s,n[e]=o},i.prototype.reprioritize=function(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let s=0;const o=e.length;let r,h,u;for(h=0;h<o;++h)(u=t(r=e[h]))==n?delete this.queuedElements_[this.keyFunction_(r)]:(i[s]=u,e[s++]=r);e.length=s,i.length=s,this.heapify_()},exports.default=i;
},{"../asserts.js":83,"../obj.js":74}],37:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./util.js"),t=require("./TileState.js"),i=o(t),s=require("./events.js"),n=require("./events/EventType.js"),l=o(n),a=require("./structs/PriorityQueue.js"),u=o(a);function o(e){return e&&e.__esModule?e:{default:e}}const r=function(e,t){u.default.call(this,function(t){return e.apply(null,t)},function(e){return e[0].getKey()}),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}};(0,e.inherits)(r,u.default),r.prototype.enqueue=function(e){const t=u.default.prototype.enqueue.call(this,e);if(t){const t=e[0];(0,s.listen)(t,l.default.CHANGE,this.handleTileChange,this)}return t},r.prototype.getTilesLoading=function(){return this.tilesLoading_},r.prototype.handleTileChange=function(e){const t=e.target,n=t.getState();if(n===i.default.LOADED||n===i.default.ERROR||n===i.default.EMPTY||n===i.default.ABORT){(0,s.unlisten)(t,l.default.CHANGE,this.handleTileChange,this);const e=t.getKey();e in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[e],--this.tilesLoading_),this.tileChangeCallback_()}},r.prototype.loadMoreTiles=function(e,t){let s,n,l,a=0,u=!1;for(;this.tilesLoading_<e&&a<t&&this.getCount()>0;)l=(n=this.dequeue()[0]).getKey(),(s=n.getState())===i.default.ABORT?u=!0:s!==i.default.IDLE||l in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[l]=!0,++this.tilesLoading_,++a,n.load());0===a&&u&&this.tileChangeCallback_()},exports.default=r;
},{"./util.js":43,"./TileState.js":92,"./events.js":84,"./events/EventType.js":110,"./structs/PriorityQueue.js":132}],142:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=exports.DEFAULT_MAX_ZOOM=42,t=exports.DEFAULT_TILE_SIZE=256;
},{}],126:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createExtent=t,exports.none=r;var e=require("./math.js");function t(t){return function(r){return r?[(0,e.clamp)(r[0],t[0],t[2]),(0,e.clamp)(r[1],t[1],t[3])]:void 0}}function r(e){return e}
},{"./math.js":87}],127:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createSnapToResolutions=r,exports.createSnapToPower=o;var t=require("./array.js"),e=require("./math.js");function r(r){return function(o,n,a){if(void 0!==o){let i=(0,t.linearFindNearest)(r,o,a);i=(0,e.clamp)(i+n,0,r.length-1);const u=Math.floor(i);if(i!=u&&u<r.length-1){const t=r[u]/r[u+1];return r[u]/Math.pow(t,i-u)}return r[u]}}}function o(t,e,r){return function(o,n,a){if(void 0!==o){const i=-a/2+.5,u=Math.floor(Math.log(e/o)/Math.log(t)+i);let s=Math.max(u+n,0);return void 0!==r&&(s=Math.min(s,r)),e/Math.pow(t,s)}}}
},{"./array.js":130,"./math.js":87}],128:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.disable=t,exports.none=e,exports.createSnapToN=r,exports.createSnapToZero=n;var o=require("./math.js");function t(o,t){return void 0!==o?0:void 0}function e(o,t){return void 0!==o?o+t:void 0}function r(o){const t=2*Math.PI/o;return function(o,e){return void 0!==o?o=Math.floor((o+e)/t+.5)*t:void 0}}function n(t){const e=t||(0,o.toRadians)(5);return function(o,t){return void 0!==o?Math.abs(o+t)<=e?0:o+t:void 0}}
},{"./math.js":87}],102:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ANIMATING:0,INTERACTING:1};
},{}],129:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};
},{}],41:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createCenterConstraint=j,exports.createResolutionConstraint=O,exports.createRotationConstraint=F,exports.isNoopAnimation=S;var t=require("./tilegrid/common.js"),o=require("./util.js"),e=require("./functions.js"),i=require("./centerconstraint.js"),n=require("./Object.js"),s=N(n),r=require("./resolutionconstraint.js"),a=require("./rotationconstraint.js"),u=require("./ViewHint.js"),c=N(u),l=require("./ViewProperty.js"),h=N(l),p=require("./array.js"),m=require("./asserts.js"),g=require("./coordinate.js"),d=require("./easing.js"),R=require("./extent.js"),f=require("./geom/GeometryType.js"),_=N(f),y=require("./geom/Polygon.js"),M=require("./geom/SimpleGeometry.js"),v=N(M),C=require("./math.js"),x=require("./obj.js"),A=require("./proj.js"),E=require("./proj/Units.js"),T=N(E);function N(t){return t&&t.__esModule?t:{default:t}}const I=0,Z=function(t){s.default.call(this);const o=(0,x.assign)({},t);this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.updateAnimations_=this.updateAnimations_.bind(this),this.projection_=(0,A.createProjection)(o.projection,"EPSG:3857"),this.applyOptions_(o)};function j(t){return void 0!==t.extent?(0,i.createExtent)(t.extent):i.none}function O(o){let e,i,n;let s=void 0!==o.minZoom?o.minZoom:I,a=void 0!==o.maxZoom?o.maxZoom:28;const u=void 0!==o.zoomFactor?o.zoomFactor:2;if(void 0!==o.resolutions){const t=o.resolutions;i=t[s],n=void 0!==t[a]?t[a]:t[t.length-1],e=(0,r.createSnapToResolutions)(t)}else{const c=(0,A.createProjection)(o.projection,"EPSG:3857"),l=c.getExtent(),h=(l?Math.max((0,R.getWidth)(l),(0,R.getHeight)(l)):360*A.METERS_PER_UNIT[T.default.DEGREES]/c.getMetersPerUnit())/t.DEFAULT_TILE_SIZE/Math.pow(2,I),p=h/Math.pow(2,28-I);void 0!==(i=o.maxResolution)?s=0:i=h/Math.pow(u,s),void 0===(n=o.minResolution)&&(n=void 0!==o.maxZoom?void 0!==o.maxResolution?i/Math.pow(u,a):h/Math.pow(u,a):p),a=s+Math.floor(Math.log(i/n)/Math.log(u)),n=i/Math.pow(u,a-s),e=(0,r.createSnapToPower)(u,i,a-s)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:s,zoomFactor:u}}function F(t){if(void 0===t.enableRotation||t.enableRotation){const o=t.constrainRotation;return void 0===o||!0===o?(0,a.createSnapToZero)():!1===o?a.none:"number"==typeof o?(0,a.createSnapToN)(o):a.none}return a.disable}function S(t){return!(t.sourceCenter&&t.targetCenter&&!(0,g.equals)(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}(0,o.inherits)(Z,s.default),Z.prototype.applyOptions_=function(t){const o={};o[h.default.CENTER]=void 0!==t.center?t.center:null;const e=O(t);this.maxResolution_=e.maxResolution,this.minResolution_=e.minResolution,this.zoomFactor_=e.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=e.minZoom;const i=j(t),n=e.constraint,s=F(t);this.constraints_={center:i,resolution:n,rotation:s},void 0!==t.resolution?o[h.default.RESOLUTION]=t.resolution:void 0!==t.zoom&&(o[h.default.RESOLUTION]=this.constrainResolution(this.maxResolution_,t.zoom-this.minZoom_),this.resolutions_&&(o[h.default.RESOLUTION]=(0,C.clamp)(Number(this.getResolution()||o[h.default.RESOLUTION]),this.minResolution_,this.maxResolution_))),o[h.default.ROTATION]=void 0!==t.rotation?t.rotation:0,this.setProperties(o),this.options_=t},Z.prototype.getUpdatedOptions_=function(t){const o=(0,x.assign)({},this.options_);return void 0!==o.resolution?o.resolution=this.getResolution():o.zoom=this.getZoom(),o.center=this.getCenter(),o.rotation=this.getRotation(),(0,x.assign)({},o,t)},Z.prototype.animate=function(t){let o,e=arguments.length;if(e>1&&"function"==typeof arguments[e-1]&&(o=arguments[e-1],--e),!this.isDef()){const t=arguments[e-1];return t.center&&this.setCenter(t.center),void 0!==t.zoom&&this.setZoom(t.zoom),void 0!==t.rotation&&this.setRotation(t.rotation),void(o&&setTimeout(function(){o(!0)},0))}let i=Date.now(),n=this.getCenter().slice(),s=this.getResolution(),r=this.getRotation();const a=[];for(let t=0;t<e;++t){const e=arguments[t],u={start:i,complete:!1,anchor:e.anchor,duration:void 0!==e.duration?e.duration:1e3,easing:e.easing||d.inAndOut};if(e.center&&(u.sourceCenter=n,u.targetCenter=e.center,n=u.targetCenter),void 0!==e.zoom?(u.sourceResolution=s,u.targetResolution=this.constrainResolution(this.maxResolution_,e.zoom-this.minZoom_,0),s=u.targetResolution):e.resolution&&(u.sourceResolution=s,u.targetResolution=e.resolution,s=u.targetResolution),void 0!==e.rotation){u.sourceRotation=r;const t=(0,C.modulo)(e.rotation-r+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=r+t,r=u.targetRotation}u.callback=o,S(u)?u.complete=!0:i+=u.duration,a.push(u)}this.animations_.push(a),this.setHint(c.default.ANIMATING,1),this.updateAnimations_()},Z.prototype.getAnimating=function(){return this.hints_[c.default.ANIMATING]>0},Z.prototype.getInteracting=function(){return this.hints_[c.default.INTERACTING]>0},Z.prototype.cancelAnimations=function(){this.setHint(c.default.ANIMATING,-this.hints_[c.default.ANIMATING]);for(let t=0,o=this.animations_.length;t<o;++t){const o=this.animations_[t];o[0].callback&&o[0].callback(!1)}this.animations_.length=0},Z.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let o=!1;for(let e=this.animations_.length-1;e>=0;--e){const i=this.animations_[e];let n=!0;for(let e=0,s=i.length;e<s;++e){const s=i[e];if(s.complete)continue;const r=t-s.start;let a=s.duration>0?r/s.duration:1;a>=1?(s.complete=!0,a=1):n=!1;const u=s.easing(a);if(s.sourceCenter){const t=s.sourceCenter[0],o=s.sourceCenter[1],e=t+u*(s.targetCenter[0]-t),i=o+u*(s.targetCenter[1]-o);this.set(h.default.CENTER,[e,i])}if(s.sourceResolution&&s.targetResolution){const t=1===u?s.targetResolution:s.sourceResolution+u*(s.targetResolution-s.sourceResolution);s.anchor&&this.set(h.default.CENTER,this.calculateCenterZoom(t,s.anchor)),this.set(h.default.RESOLUTION,t)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){const t=1===u?(0,C.modulo)(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+u*(s.targetRotation-s.sourceRotation);s.anchor&&this.set(h.default.CENTER,this.calculateCenterRotate(t,s.anchor)),this.set(h.default.ROTATION,t)}if(o=!0,!s.complete)break}if(n){this.animations_[e]=null,this.setHint(c.default.ANIMATING,-1);const t=i[0].callback;t&&setTimeout(function(){t(!0)},0)}}this.animations_=this.animations_.filter(Boolean),o&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))},Z.prototype.calculateCenterRotate=function(t,o){let e;const i=this.getCenter();return void 0!==i&&(e=[i[0]-o[0],i[1]-o[1]],(0,g.rotate)(e,t-this.getRotation()),(0,g.add)(e,o)),e},Z.prototype.calculateCenterZoom=function(t,o){let e;const i=this.getCenter(),n=this.getResolution();if(void 0!==i&&void 0!==n){e=[o[0]-t*(o[0]-i[0])/n,o[1]-t*(o[1]-i[1])/n]}return e},Z.prototype.getSizeFromViewport_=function(){const t=[100,100],e='.ol-viewport[data-view="'+(0,o.getUid)(this)+'"]',i=document.querySelector(e);if(i){const o=getComputedStyle(i);t[0]=parseInt(o.width,10),t[1]=parseInt(o.height,10)}return t},Z.prototype.constrainCenter=function(t){return this.constraints_.center(t)},Z.prototype.constrainResolution=function(t,o,e){const i=o||0,n=e||0;return this.constraints_.resolution(t,i,n)},Z.prototype.constrainRotation=function(t,o){const e=o||0;return this.constraints_.rotation(t,e)},Z.prototype.getCenter=function(){return this.get(h.default.CENTER)},Z.prototype.getConstraints=function(){return this.constraints_},Z.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},Z.prototype.calculateExtent=function(t){const o=t||this.getSizeFromViewport_(),e=this.getCenter();(0,m.assert)(e,1);const i=this.getResolution();(0,m.assert)(void 0!==i,2);const n=this.getRotation();return(0,m.assert)(void 0!==n,3),(0,R.getForViewAndSize)(e,i,n,o)},Z.prototype.getMaxResolution=function(){return this.maxResolution_},Z.prototype.getMinResolution=function(){return this.minResolution_},Z.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},Z.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},Z.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},Z.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},Z.prototype.getProjection=function(){return this.projection_},Z.prototype.getResolution=function(){return this.get(h.default.RESOLUTION)},Z.prototype.getResolutions=function(){return this.resolutions_},Z.prototype.getResolutionForExtent=function(t,o){const e=o||this.getSizeFromViewport_(),i=(0,R.getWidth)(t)/e[0],n=(0,R.getHeight)(t)/e[1];return Math.max(i,n)},Z.prototype.getResolutionForValueFunction=function(t){const o=t||2,e=this.maxResolution_,i=this.minResolution_,n=Math.log(e/i)/Math.log(o);return function(t){return e/Math.pow(o,t*n)}},Z.prototype.getRotation=function(){return this.get(h.default.ROTATION)},Z.prototype.getValueForResolutionFunction=function(t){const o=t||2,e=this.maxResolution_,i=this.minResolution_,n=Math.log(e/i)/Math.log(o);return function(t){return Math.log(e/t)/Math.log(o)/n}},Z.prototype.getState=function(){const t=this.getCenter(),o=this.getProjection(),e=this.getResolution(),i=this.getRotation();return{center:t.slice(),projection:void 0!==o?o:null,resolution:e,rotation:i,zoom:this.getZoom()}},Z.prototype.getZoom=function(){let t;const o=this.getResolution();return void 0!==o&&(t=this.getZoomForResolution(o)),t},Z.prototype.getZoomForResolution=function(t){let o,e,i=this.minZoom_||0;if(this.resolutions_){const n=(0,p.linearFindNearest)(this.resolutions_,t,1);i=n,o=this.resolutions_[n],e=n==this.resolutions_.length-1?2:o/this.resolutions_[n+1]}else o=this.maxResolution_,e=this.zoomFactor_;return i+Math.log(o/t)/Math.log(e)},Z.prototype.getResolutionForZoom=function(t){return this.constrainResolution(this.maxResolution_,t-this.minZoom_,0)},Z.prototype.fit=function(t,o){const i=o||{};let n,s=i.size;s||(s=this.getSizeFromViewport_()),t instanceof v.default?t.getType()===_.default.CIRCLE?(t=t.getExtent(),(n=(0,y.fromExtent)(t)).rotate(this.getRotation(),(0,R.getCenter)(t))):n=t:((0,m.assert)(Array.isArray(t),24),(0,m.assert)(!(0,R.isEmpty)(t),25),n=(0,y.fromExtent)(t));const r=void 0!==i.padding?i.padding:[0,0,0,0],a=void 0===i.constrainResolution||i.constrainResolution,u=void 0!==i.nearest&&i.nearest;let c;c=void 0!==i.minResolution?i.minResolution:void 0!==i.maxZoom?this.constrainResolution(this.maxResolution_,i.maxZoom-this.minZoom_,0):0;const l=n.getFlatCoordinates(),h=this.getRotation(),p=Math.cos(-h);let g=Math.sin(-h),d=1/0,f=1/0,M=-1/0,C=-1/0;const x=n.getStride();for(let t=0,o=l.length;t<o;t+=x){const o=l[t]*p-l[t+1]*g,e=l[t]*g+l[t+1]*p;d=Math.min(d,o),f=Math.min(f,e),M=Math.max(M,o),C=Math.max(C,e)}let A=this.getResolutionForExtent([d,f,M,C],[s[0]-r[1]-r[3],s[1]-r[0]-r[2]]);if(A=isNaN(A)?c:Math.max(A,c),a){let t=this.constrainResolution(A,0,0);!u&&t<A&&(t=this.constrainResolution(t,-1,0)),A=t}g=-g;let E=(d+M)/2,T=(f+C)/2;const N=[(E+=(r[1]-r[3])/2*A)*p-(T+=(r[0]-r[2])/2*A)*g,T*p+E*g],I=i.callback?i.callback:e.UNDEFINED;void 0!==i.duration?this.animate({resolution:A,center:N,duration:i.duration,easing:i.easing},I):(this.setResolution(A),this.setCenter(N),setTimeout(I.bind(void 0,!0),0))},Z.prototype.centerOn=function(t,o,e){const i=this.getRotation(),n=Math.cos(-i);let s=Math.sin(-i),r=t[0]*n-t[1]*s,a=t[1]*n+t[0]*s;const u=this.getResolution(),c=(r+=(o[0]/2-e[0])*u)*n-(a+=(e[1]-o[1]/2)*u)*(s=-s),l=a*n+r*s;this.setCenter([c,l])},Z.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()},Z.prototype.rotate=function(t,o){if(void 0!==o){const e=this.calculateCenterRotate(t,o);this.setCenter(e)}this.setRotation(t)},Z.prototype.setCenter=function(t){this.set(h.default.CENTER,t),this.getAnimating()&&this.cancelAnimations()},Z.prototype.setHint=function(t,o){return this.hints_[t]+=o,this.changed(),this.hints_[t]},Z.prototype.setResolution=function(t){this.set(h.default.RESOLUTION,t),this.getAnimating()&&this.cancelAnimations()},Z.prototype.setRotation=function(t){this.set(h.default.ROTATION,t),this.getAnimating()&&this.cancelAnimations()},Z.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},exports.default=Z;
},{"./tilegrid/common.js":142,"./util.js":43,"./functions.js":103,"./centerconstraint.js":126,"./Object.js":31,"./resolutionconstraint.js":127,"./rotationconstraint.js":128,"./ViewHint.js":102,"./ViewProperty.js":129,"./array.js":130,"./asserts.js":83,"./coordinate.js":89,"./easing.js":106,"./extent.js":90,"./geom/GeometryType.js":140,"./geom/Polygon.js":113,"./geom/SimpleGeometry.js":141,"./math.js":87,"./obj.js":74,"./proj.js":88,"./proj/Units.js":143}],150:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"};
},{}],149:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../Object.js"),i=r(e),o=require("../layer/Property.js"),s=r(o),n=require("../math.js"),u=require("../obj.js");function r(t){return t&&t.__esModule?t:{default:t}}const a=function(t){i.default.call(this);const e=(0,u.assign)({},t);e[s.default.OPACITY]=void 0!==t.opacity?t.opacity:1,e[s.default.VISIBLE]=void 0===t.visible||t.visible,e[s.default.Z_INDEX]=void 0!==t.zIndex?t.zIndex:0,e[s.default.MAX_RESOLUTION]=void 0!==t.maxResolution?t.maxResolution:1/0,e[s.default.MIN_RESOLUTION]=void 0!==t.minResolution?t.minResolution:0,this.setProperties(e),this.state_={layer:this,managed:!0},this.type};(0,t.inherits)(a,i.default),a.prototype.getType=function(){return this.type},a.prototype.getLayerState=function(){return this.state_.opacity=(0,n.clamp)(this.getOpacity(),0,1),this.state_.sourceState=this.getSourceState(),this.state_.visible=this.getVisible(),this.state_.extent=this.getExtent(),this.state_.zIndex=this.getZIndex(),this.state_.maxResolution=this.getMaxResolution(),this.state_.minResolution=Math.max(this.getMinResolution(),0),this.state_},a.prototype.getLayersArray=function(t){},a.prototype.getLayerStatesArray=function(t){},a.prototype.getExtent=function(){return this.get(s.default.EXTENT)},a.prototype.getMaxResolution=function(){return this.get(s.default.MAX_RESOLUTION)},a.prototype.getMinResolution=function(){return this.get(s.default.MIN_RESOLUTION)},a.prototype.getOpacity=function(){return this.get(s.default.OPACITY)},a.prototype.getSourceState=function(){},a.prototype.getVisible=function(){return this.get(s.default.VISIBLE)},a.prototype.getZIndex=function(){return this.get(s.default.Z_INDEX)},a.prototype.setExtent=function(t){this.set(s.default.EXTENT,t)},a.prototype.setMaxResolution=function(t){this.set(s.default.MAX_RESOLUTION,t)},a.prototype.setMinResolution=function(t){this.set(s.default.MIN_RESOLUTION,t)},a.prototype.setOpacity=function(t){this.set(s.default.OPACITY,t)},a.prototype.setVisible=function(t){this.set(s.default.VISIBLE,t)},a.prototype.setZIndex=function(t){this.set(s.default.Z_INDEX,t)},exports.default=a;
},{"../util.js":43,"../Object.js":31,"../layer/Property.js":150,"../math.js":87,"../obj.js":74}],151:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"};
},{}],131:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util.js"),t=require("../Collection.js"),s=_(t),n=require("../CollectionEventType.js"),i=_(n),r=require("../Object.js"),a=require("../ObjectEventType.js"),o=_(a),l=require("../asserts.js"),h=require("../events.js"),y=require("../events/EventType.js"),u=_(y),c=require("../extent.js"),d=require("../layer/Base.js"),f=_(d),g=require("../obj.js"),L=require("../source/State.js"),p=_(L);function _(e){return e&&e.__esModule?e:{default:e}}const E={LAYERS:"layers"},A=function(e){const t=e||{},n=(0,g.assign)({},t);delete n.layers;let i=t.layers;f.default.call(this,n),this.layersListenerKeys_=[],this.listenerKeys_={},(0,h.listen)(this,(0,r.getChangeEventType)(E.LAYERS),this.handleLayersChanged_,this),i?Array.isArray(i)?i=new s.default(i.slice(),{unique:!0}):((0,l.assert)(i instanceof s.default,43),i=i):i=new s.default(void 0,{unique:!0}),this.setLayers(i)};(0,e.inherits)(A,f.default),A.prototype.handleLayerChange_=function(){this.changed()},A.prototype.handleLayersChanged_=function(t){this.layersListenerKeys_.forEach(h.unlistenByKey),this.layersListenerKeys_.length=0;const s=this.getLayers();this.layersListenerKeys_.push((0,h.listen)(s,i.default.ADD,this.handleLayersAdd_,this),(0,h.listen)(s,i.default.REMOVE,this.handleLayersRemove_,this));for(const e in this.listenerKeys_)this.listenerKeys_[e].forEach(h.unlistenByKey);(0,g.clear)(this.listenerKeys_);const n=s.getArray();for(let t=0,s=n.length;t<s;t++){const s=n[t];this.listenerKeys_[(0,e.getUid)(s).toString()]=[(0,h.listen)(s,o.default.PROPERTYCHANGE,this.handleLayerChange_,this),(0,h.listen)(s,u.default.CHANGE,this.handleLayerChange_,this)]}this.changed()},A.prototype.handleLayersAdd_=function(t){const s=t.element,n=(0,e.getUid)(s).toString();this.listenerKeys_[n]=[(0,h.listen)(s,o.default.PROPERTYCHANGE,this.handleLayerChange_,this),(0,h.listen)(s,u.default.CHANGE,this.handleLayerChange_,this)],this.changed()},A.prototype.handleLayersRemove_=function(t){const s=t.element,n=(0,e.getUid)(s).toString();this.listenerKeys_[n].forEach(h.unlistenByKey),delete this.listenerKeys_[n],this.changed()},A.prototype.getLayers=function(){return this.get(E.LAYERS)},A.prototype.setLayers=function(e){this.set(E.LAYERS,e)},A.prototype.getLayersArray=function(e){const t=void 0!==e?e:[];return this.getLayers().forEach(function(e){e.getLayersArray(t)}),t},A.prototype.getLayerStatesArray=function(e){const t=void 0!==e?e:[],s=t.length;this.getLayers().forEach(function(e){e.getLayerStatesArray(t)});const n=this.getLayerState();for(let e=s,i=t.length;e<i;e++){const s=t[e];s.opacity*=n.opacity,s.visible=s.visible&&n.visible,s.maxResolution=Math.min(s.maxResolution,n.maxResolution),s.minResolution=Math.max(s.minResolution,n.minResolution),void 0!==n.extent&&(void 0!==s.extent?s.extent=(0,c.getIntersection)(s.extent,n.extent):s.extent=n.extent)}return t},A.prototype.getSourceState=function(){return p.default.READY},exports.default=A;
},{"../util.js":43,"../Collection.js":16,"../CollectionEventType.js":100,"../Object.js":31,"../ObjectEventType.js":96,"../asserts.js":83,"../events.js":84,"../events/EventType.js":110,"../extent.js":90,"../layer/Base.js":149,"../obj.js":74,"../source/State.js":151}],104:[function(require,module,exports) {
"use strict";function r(r,e,t){return void 0===t&&(t=[0,0]),t[0]=r[0]+2*e,t[1]=r[1]+2*e,t}function e(r){return r[0]>0&&r[1]>0}function t(r,e,t){return void 0===t&&(t=[0,0]),t[0]=r[0]*e+.5|0,t[1]=r[1]*e+.5|0,t}function o(r,e){return Array.isArray(r)?r:(void 0===e?e=[r,r]:e[0]=e[1]=r,e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.buffer=r,exports.hasArea=e,exports.scale=t,exports.toSize=o;
},{}],34:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./util.js"),t=require("./Collection.js"),i=N(t),n=require("./CollectionEventType.js"),r=N(n),s=require("./MapBrowserEvent.js"),o=N(s),a=require("./MapBrowserEventHandler.js"),l=N(a),h=require("./MapBrowserEventType.js"),d=N(h),u=require("./MapEvent.js"),p=N(u),y=require("./MapEventType.js"),c=N(y),f=require("./MapProperty.js"),v=N(f),_=require("./Object.js"),E=N(_),g=require("./ObjectEventType.js"),m=N(g),T=require("./TileQueue.js"),w=N(T),C=require("./View.js"),R=N(C),S=require("./ViewHint.js"),x=N(S),I=require("./asserts.js"),L=require("./dom.js"),A=require("./events.js"),P=require("./events/Event.js"),O=require("./events/EventType.js"),F=N(O),K=require("./extent.js"),M=require("./functions.js"),D=require("./has.js"),G=require("./layer/Group.js"),q=N(G),H=require("./size.js"),j=require("./structs/PriorityQueue.js"),B=require("./transform.js");function N(e){return e&&e.__esModule?e:{default:e}}const W=function(e){E.default.call(this);const t=b(e);this.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,this.loadTilesWhileAnimating_=void 0!==e.loadTilesWhileAnimating&&e.loadTilesWhileAnimating,this.loadTilesWhileInteracting_=void 0!==e.loadTilesWhileInteracting&&e.loadTilesWhileInteracting,this.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:D.DEVICE_PIXEL_RATIO,this.animationDelayKey_,this.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_.call(this,Date.now())}.bind(this),this.coordinateToPixelTransform_=(0,B.create)(),this.pixelToCoordinateTransform_=(0,B.create)(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("DIV"),this.viewport_.className="ol-viewport"+(D.TOUCH?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.viewport_.style.msTouchAction="none",this.viewport_.style.touchAction="none",this.overlayContainer_=document.createElement("DIV"),this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("DIV"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";const n=[F.default.CLICK,F.default.DBLCLICK,F.default.MOUSEDOWN,F.default.TOUCHSTART,F.default.MSPOINTERDOWN,d.default.POINTERDOWN,F.default.MOUSEWHEEL,F.default.WHEEL];for(let e=0,t=n.length;e<t;++e)(0,A.listen)(this.overlayContainerStopEvent_,n[e],P.stopPropagation);this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=new l.default(this,e.moveTolerance);for(const e in d.default)(0,A.listen)(this.mapBrowserEventHandler_,d.default[e],this.handleMapBrowserEvent,this);this.keyboardEventTarget_=t.keyboardEventTarget,this.keyHandlerKeys_=null,(0,A.listen)(this.viewport_,F.default.CONTEXTMENU,this.handleBrowserEvent,this),(0,A.listen)(this.viewport_,F.default.WHEEL,this.handleBrowserEvent,this),(0,A.listen)(this.viewport_,F.default.MOUSEWHEEL,this.handleBrowserEvent,this),this.controls=t.controls||new i.default,this.interactions=t.interactions||new i.default,this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=this.createRenderer(),this.handleResize_,this.focus_=null,this.postRenderFunctions_=[],this.tileQueue_=new w.default(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.skippedFeatureUids_={},(0,A.listen)(this,(0,_.getChangeEventType)(v.default.LAYERGROUP),this.handleLayerGroupChanged_,this),(0,A.listen)(this,(0,_.getChangeEventType)(v.default.VIEW),this.handleViewChanged_,this),(0,A.listen)(this,(0,_.getChangeEventType)(v.default.SIZE),this.handleSizeChanged_,this),(0,A.listen)(this,(0,_.getChangeEventType)(v.default.TARGET),this.handleTargetChanged_,this),this.setProperties(t.values),this.controls.forEach(function(e){e.setMap(this)}.bind(this)),(0,A.listen)(this.controls,r.default.ADD,function(e){e.element.setMap(this)},this),(0,A.listen)(this.controls,r.default.REMOVE,function(e){e.element.setMap(null)},this),this.interactions.forEach(function(e){e.setMap(this)}.bind(this)),(0,A.listen)(this.interactions,r.default.ADD,function(e){e.element.setMap(this)},this),(0,A.listen)(this.interactions,r.default.REMOVE,function(e){e.element.setMap(null)},this),this.overlays_.forEach(this.addOverlayInternal_.bind(this)),(0,A.listen)(this.overlays_,r.default.ADD,function(e){this.addOverlayInternal_(e.element)},this),(0,A.listen)(this.overlays_,r.default.REMOVE,function(e){const t=e.element.getId();void 0!==t&&delete this.overlayIdIndex_[t.toString()],e.element.setMap(null)},this)};function b(e){let t=null;void 0!==e.keyboardEventTarget&&(t="string"==typeof e.keyboardEventTarget?document.getElementById(e.keyboardEventTarget):e.keyboardEventTarget);const n={},r=e.layers instanceof q.default?e.layers:new q.default({layers:e.layers});let s,o,a;return n[v.default.LAYERGROUP]=r,n[v.default.TARGET]=e.target,n[v.default.VIEW]=void 0!==e.view?e.view:new R.default,void 0!==e.controls&&(Array.isArray(e.controls)?s=new i.default(e.controls.slice()):((0,I.assert)(e.controls instanceof i.default,47),s=e.controls)),void 0!==e.interactions&&(Array.isArray(e.interactions)?o=new i.default(e.interactions.slice()):((0,I.assert)(e.interactions instanceof i.default,48),o=e.interactions)),void 0!==e.overlays?Array.isArray(e.overlays)?a=new i.default(e.overlays.slice()):((0,I.assert)(e.overlays instanceof i.default,49),a=e.overlays):a=new i.default,{controls:s,interactions:o,keyboardEventTarget:t,overlays:a,values:n}}(0,e.inherits)(W,E.default),W.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},W.prototype.addControl=function(e){this.getControls().push(e)},W.prototype.addInteraction=function(e){this.getInteractions().push(e)},W.prototype.addLayer=function(e){this.getLayerGroup().getLayers().push(e)},W.prototype.addOverlay=function(e){this.getOverlays().push(e)},W.prototype.addOverlayInternal_=function(e){const t=e.getId();void 0!==t&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)},W.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),(0,A.unlisten)(this.viewport_,F.default.CONTEXTMENU,this.handleBrowserEvent,this),(0,A.unlisten)(this.viewport_,F.default.WHEEL,this.handleBrowserEvent,this),(0,A.unlisten)(this.viewport_,F.default.MOUSEWHEEL,this.handleBrowserEvent,this),void 0!==this.handleResize_&&(removeEventListener(F.default.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),this.setTarget(null),E.default.prototype.disposeInternal.call(this)},W.prototype.forEachFeatureAtPixel=function(e,t,i){if(!this.frameState_)return;const n=this.getCoordinateFromPixel(e),r=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,s=void 0!==i.layerFilter?i.layerFilter:M.TRUE;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,t,null,s,null)},W.prototype.getFeaturesAtPixel=function(e,t){let i=null;return this.forEachFeatureAtPixel(e,function(e){i||(i=[]),i.push(e)},t),i},W.prototype.forEachLayerAtPixel=function(e,t,i){if(!this.frameState_)return;const n=i||{},r=void 0!==n.hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,s=n.layerFilter||M.TRUE;return this.renderer_.forEachLayerAtPixel(e,this.frameState_,r,t,null,s,null)},W.prototype.hasFeatureAtPixel=function(e,t){if(!this.frameState_)return!1;const i=this.getCoordinateFromPixel(e),n=void 0!==(t=void 0!==t?t:{}).layerFilter?t.layerFilter:M.TRUE,r=void 0!==t.hitTolerance?t.hitTolerance*this.frameState_.pixelRatio:0;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,n,null)},W.prototype.getEventCoordinate=function(e){return this.getCoordinateFromPixel(this.getEventPixel(e))},W.prototype.getEventPixel=function(e){const t=this.viewport_.getBoundingClientRect(),i=e.changedTouches?e.changedTouches[0]:e;return[i.clientX-t.left,i.clientY-t.top]},W.prototype.getTarget=function(){return this.get(v.default.TARGET)},W.prototype.getTargetElement=function(){const e=this.getTarget();return void 0!==e?"string"==typeof e?document.getElementById(e):e:null},W.prototype.getCoordinateFromPixel=function(e){const t=this.frameState_;return t?(0,B.apply)(t.pixelToCoordinateTransform,e.slice()):null},W.prototype.getControls=function(){return this.controls},W.prototype.getOverlays=function(){return this.overlays_},W.prototype.getOverlayById=function(e){const t=this.overlayIdIndex_[e.toString()];return void 0!==t?t:null},W.prototype.getInteractions=function(){return this.interactions},W.prototype.getLayerGroup=function(){return this.get(v.default.LAYERGROUP)},W.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},W.prototype.getPixelFromCoordinate=function(e){const t=this.frameState_;return t?(0,B.apply)(t.coordinateToPixelTransform,e.slice(0,2)):null},W.prototype.getRenderer=function(){return this.renderer_},W.prototype.getSize=function(){return this.get(v.default.SIZE)},W.prototype.getView=function(){return this.get(v.default.VIEW)},W.prototype.getViewport=function(){return this.viewport_},W.prototype.getOverlayContainer=function(){return this.overlayContainer_},W.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},W.prototype.getTilePriority=function(e,t,i,n){const r=this.frameState_;if(!(r&&t in r.wantedTiles))return j.DROP;if(!r.wantedTiles[t][e.getKey()])return j.DROP;const s=i[0]-r.focus[0],o=i[1]-r.focus[1];return 65536*Math.log(n)+Math.sqrt(s*s+o*o)/n},W.prototype.handleBrowserEvent=function(e,t){const i=t||e.type,n=new o.default(i,this,e);this.handleMapBrowserEvent(n)},W.prototype.handleMapBrowserEvent=function(e){if(!this.frameState_)return;this.focus_=e.coordinate,e.frameState=this.frameState_;const t=this.getInteractions().getArray();if(!1!==this.dispatchEvent(e))for(let i=t.length-1;i>=0;i--){const n=t[i];if(n.getActive()&&!n.handleEvent(e))break}},W.prototype.handlePostRender=function(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,n=i;if(e){const t=e.viewHints;t[x.default.ANIMATING]&&(i=this.loadTilesWhileAnimating_?8:0,n=2),t[x.default.INTERACTING]&&(i=this.loadTilesWhileInteracting_?8:0,n=2)}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,n))}const i=this.postRenderFunctions_;for(let t=0,n=i.length;t<n;++t)i[t](this,e);i.length=0},W.prototype.handleSizeChanged_=function(){this.render()},W.prototype.handleTargetChanged_=function(){let e;if(this.getTarget()&&(e=this.getTargetElement()),this.keyHandlerKeys_){for(let e=0,t=this.keyHandlerKeys_.length;e<t;++e)(0,A.unlistenByKey)(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null}if(e){e.appendChild(this.viewport_);const t=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.keyHandlerKeys_=[(0,A.listen)(t,F.default.KEYDOWN,this.handleBrowserEvent,this),(0,A.listen)(t,F.default.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),addEventListener(F.default.RESIZE,this.handleResize_,!1))}else this.renderer_.removeLayerRenderers(),(0,L.removeNode)(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(F.default.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},W.prototype.handleTileChange_=function(){this.render()},W.prototype.handleViewPropertyChanged_=function(){this.render()},W.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&((0,A.unlistenByKey)(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&((0,A.unlistenByKey)(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.viewport_.setAttribute("data-view",(0,e.getUid)(t)),this.viewPropertyListenerKey_=(0,A.listen)(t,m.default.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=(0,A.listen)(t,F.default.CHANGE,this.handleViewPropertyChanged_,this)),this.render()},W.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(A.unlistenByKey),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.layerGroupPropertyListenerKeys_=[(0,A.listen)(e,m.default.PROPERTYCHANGE,this.render,this),(0,A.listen)(e,F.default.CHANGE,this.render,this)]),this.render()},W.prototype.isRendered=function(){return!!this.frameState_},W.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},W.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},W.prototype.removeControl=function(e){return this.getControls().remove(e)},W.prototype.removeInteraction=function(e){return this.getInteractions().remove(e)},W.prototype.removeLayer=function(e){return this.getLayerGroup().getLayers().remove(e)},W.prototype.removeOverlay=function(e){return this.getOverlays().remove(e)},W.prototype.renderFrame_=function(t){let i;const n=this.getSize(),r=this.getView(),s=(0,K.createEmpty)(),o=this.frameState_;let a=null;if(void 0!==n&&(0,H.hasArea)(n)&&r&&r.isDef()){const o=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=this.getLayerGroup().getLayerStatesArray(),h={};for(let t=0,i=l.length;t<i;++t)h[(0,e.getUid)(l[t].layer)]=l[t];i=r.getState();let d=this.focus_;if(!d){d=i.center;const e=i.resolution/this.pixelRatio_;d[0]=Math.round(d[0]/e)*e,d[1]=Math.round(d[1]/e)*e}a={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:s,focus:d,index:this.frameIndex_++,layerStates:h,layerStatesArray:l,pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:i,viewHints:o,wantedTiles:{}}}if(a&&(a.extent=(0,K.getForViewAndSize)(i.center,i.resolution,i.rotation,a.size,s)),this.frameState_=a,this.renderer_.renderFrame(a),a){if(a.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,a.postRenderFunctions),o){(!this.previousExtent_||!(0,K.isEmpty)(this.previousExtent_)&&!(0,K.equals)(a.extent,this.previousExtent_))&&(this.dispatchEvent(new p.default(c.default.MOVESTART,this,o)),this.previousExtent_=(0,K.createOrUpdateEmpty)(this.previousExtent_))}this.previousExtent_&&!a.viewHints[x.default.ANIMATING]&&!a.viewHints[x.default.INTERACTING]&&!(0,K.equals)(a.extent,this.previousExtent_)&&(this.dispatchEvent(new p.default(c.default.MOVEEND,this,a)),(0,K.clone)(a.extent,this.previousExtent_))}this.dispatchEvent(new p.default(c.default.POSTRENDER,this,a)),setTimeout(this.handlePostRender.bind(this),0)},W.prototype.setLayerGroup=function(e){this.set(v.default.LAYERGROUP,e)},W.prototype.setSize=function(e){this.set(v.default.SIZE,e)},W.prototype.setTarget=function(e){this.set(v.default.TARGET,e)},W.prototype.setView=function(e){this.set(v.default.VIEW,e)},W.prototype.skipFeature=function(t){const i=(0,e.getUid)(t).toString();this.skippedFeatureUids_[i]=!0,this.render()},W.prototype.updateSize=function(){const e=this.getTargetElement();if(e){const t=getComputedStyle(e);this.setSize([e.offsetWidth-parseFloat(t.borderLeftWidth)-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)-parseFloat(t.borderRightWidth),e.offsetHeight-parseFloat(t.borderTopWidth)-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom)-parseFloat(t.borderBottomWidth)])}else this.setSize(void 0)},W.prototype.unskipFeature=function(t){const i=(0,e.getUid)(t).toString();delete this.skippedFeatureUids_[i],this.render()},exports.default=W;
},{"./util.js":43,"./Collection.js":16,"./CollectionEventType.js":100,"./MapBrowserEvent.js":27,"./MapBrowserEventHandler.js":28,"./MapBrowserEventType.js":95,"./MapEvent.js":30,"./MapEventType.js":97,"./MapProperty.js":101,"./Object.js":31,"./ObjectEventType.js":96,"./TileQueue.js":37,"./View.js":41,"./ViewHint.js":102,"./asserts.js":83,"./dom.js":93,"./events.js":84,"./events/Event.js":123,"./events/EventType.js":110,"./extent.js":90,"./functions.js":103,"./has.js":86,"./layer/Group.js":131,"./size.js":104,"./structs/PriorityQueue.js":132,"./transform.js":105}],181:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util.js"),t=require("../functions.js"),s=require("../MapEventType.js"),r=u(s),n=require("../Object.js"),i=u(n),l=require("../dom.js"),o=require("../events.js");function u(e){return e&&e.__esModule?e:{default:e}}const a=function(e){i.default.call(this),this.element=e.element?e.element:null,this.target_=null,this.map_=null,this.listenerKeys=[],this.render=e.render?e.render:t.UNDEFINED,e.target&&this.setTarget(e.target)};(0,e.inherits)(a,i.default),a.prototype.disposeInternal=function(){(0,l.removeNode)(this.element),i.default.prototype.disposeInternal.call(this)},a.prototype.getMap=function(){return this.map_},a.prototype.setMap=function(e){this.map_&&(0,l.removeNode)(this.element);for(let e=0,t=this.listenerKeys.length;e<t;++e)(0,o.unlistenByKey)(this.listenerKeys[e]);if(this.listenerKeys.length=0,this.map_=e,this.map_){(this.target_?this.target_:e.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==t.UNDEFINED&&this.listenerKeys.push((0,o.listen)(e,r.default.POSTRENDER,this.render,this)),e.render()}},a.prototype.setTarget=function(e){this.target_="string"==typeof e?document.getElementById(e):e},exports.default=a;
},{"../util.js":43,"../functions.js":103,"../MapEventType.js":97,"../Object.js":31,"../dom.js":93,"../events.js":84}],75:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.visibleAtResolution=f;var e=require("../events.js"),t=require("../events/EventType.js"),s=d(t),r=require("../util.js"),n=require("../Object.js"),o=require("../layer/Base.js"),i=d(o),u=require("../layer/Property.js"),a=d(u),h=require("../obj.js"),l=require("../render/EventType.js"),c=d(l),p=require("../source/State.js"),y=d(p);function d(e){return e&&e.__esModule?e:{default:e}}const g=function(t){const s=(0,h.assign)({},t);delete s.source,i.default.call(this,s),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,t.map&&this.setMap(t.map),(0,e.listen)(this,(0,n.getChangeEventType)(a.default.SOURCE),this.handleSourcePropertyChange_,this);const r=t.source?t.source:null;this.setSource(r)};function f(e,t){return e.visible&&t>=e.minResolution&&t<e.maxResolution}(0,r.inherits)(g,i.default),g.prototype.getLayersArray=function(e){const t=e||[];return t.push(this),t},g.prototype.getLayerStatesArray=function(e){const t=e||[];return t.push(this.getLayerState()),t},g.prototype.getSource=function(){return this.get(a.default.SOURCE)||null},g.prototype.getSourceState=function(){const e=this.getSource();return e?e.getState():y.default.UNDEFINED},g.prototype.handleSourceChange_=function(){this.changed()},g.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&((0,e.unlistenByKey)(this.sourceChangeKey_),this.sourceChangeKey_=null);const t=this.getSource();t&&(this.sourceChangeKey_=(0,e.listen)(t,s.default.CHANGE,this.handleSourceChange_,this)),this.changed()},g.prototype.setMap=function(t){this.mapPrecomposeKey_&&((0,e.unlistenByKey)(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&((0,e.unlistenByKey)(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=(0,e.listen)(t,c.default.PRECOMPOSE,function(e){const t=this.getLayerState();t.managed=!1,t.zIndex=1/0,e.frameState.layerStatesArray.push(t),e.frameState.layerStates[(0,r.getUid)(this)]=t},this),this.mapRenderKey_=(0,e.listen)(this,s.default.CHANGE,t.render,t),this.changed())},g.prototype.setSource=function(e){this.set(a.default.SOURCE,e)},exports.default=g;
},{"../events.js":84,"../events/EventType.js":110,"../util.js":43,"../Object.js":31,"../layer/Base.js":149,"../layer/Property.js":150,"../obj.js":74,"../render/EventType.js":120,"../source/State.js":151}],184:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.render=h;var e=require("../util.js"),t=require("../array.js"),l=require("../control/Control.js"),s=p(l),i=require("../css.js"),o=require("../dom.js"),n=require("../events.js"),a=require("../events/EventType.js"),r=p(a),c=require("../layer/Layer.js");function p(e){return e&&e.__esModule?e:{default:e}}const d=function(e){const t=e||{};this.ulElement_=document.createElement("UL"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);const l=void 0!==t.className?t.className:"ol-attribution",o=void 0!==t.tipLabel?t.tipLabel:"Attributions",a=void 0!==t.collapseLabel?t.collapseLabel:"Â»";"string"==typeof a?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=a):this.collapseLabel_=a;const c=void 0!==t.label?t.label:"i";"string"==typeof c?(this.label_=document.createElement("span"),this.label_.textContent=c):this.label_=c;const p=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,d=document.createElement("button");d.setAttribute("type","button"),d.title=o,d.appendChild(p),(0,n.listen)(d,r.default.CLICK,this.handleClick_,this);const u=l+" "+i.CLASS_UNSELECTABLE+" "+i.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" "+i.CLASS_COLLAPSED:"")+(this.collapsible_?"":" ol-uncollapsible"),_=document.createElement("div");_.className=u,_.appendChild(this.ulElement_),_.appendChild(d),s.default.call(this,{element:_,render:t.render||h,target:t.target}),this.renderedAttributions_=[],this.renderedVisible_=!0};function h(e){this.updateElement_(e.frameState)}(0,e.inherits)(d,s.default),d.prototype.getSourceAttributions_=function(e){const t={},l=[],s=e.layerStatesArray,i=e.viewState.resolution;for(let o=0,n=s.length;o<n;++o){const n=s[o];if(!(0,c.visibleAtResolution)(n,i))continue;const a=n.layer.getSource();if(!a)continue;const r=a.getAttributions();if(!r)continue;const p=r(e);if(p)if(Array.isArray(p))for(let e=0,s=p.length;e<s;++e)p[e]in t||(l.push(p[e]),t[p[e]]=!0);else p in t||(l.push(p),t[p]=!0)}return l},d.prototype.updateElement_=function(e){if(!e)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const l=this.getSourceAttributions_(e),s=l.length>0;if(this.renderedVisible_!=s&&(this.element.style.display=s?"":"none",this.renderedVisible_=s),!(0,t.equals)(l,this.renderedAttributions_)){(0,o.removeChildren)(this.ulElement_);for(let e=0,t=l.length;e<t;++e){const t=document.createElement("LI");t.innerHTML=l[e],this.ulElement_.appendChild(t)}this.renderedAttributions_=l}},d.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},d.prototype.handleToggle_=function(){this.element.classList.toggle(i.CLASS_COLLAPSED),this.collapsed_?(0,o.replaceNode)(this.collapseLabel_,this.label_):(0,o.replaceNode)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},d.prototype.getCollapsible=function(){return this.collapsible_},d.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},d.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},d.prototype.getCollapsed=function(){return this.collapsed_},exports.default=d;
},{"../util.js":43,"../array.js":130,"../control/Control.js":181,"../css.js":99,"../dom.js":93,"../events.js":84,"../events/EventType.js":110,"../layer/Layer.js":75}],185:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.render=c;var t=require("../control/Control.js"),e=n(t),s=require("../css.js"),i=require("../easing.js"),a=require("../events.js"),o=require("../events/EventType.js"),l=n(o),r=require("../util.js");function n(t){return t&&t.__esModule?t:{default:t}}const d=function(t){const i=t||{},o=void 0!==i.className?i.className:"ol-rotate",r=void 0!==i.label?i.label:"â‡§";this.label_=null,"string"==typeof r?(this.label_=document.createElement("span"),this.label_.className="ol-compass",this.label_.textContent=r):(this.label_=r,this.label_.classList.add("ol-compass"));const n=i.tipLabel?i.tipLabel:"Reset rotation",u=document.createElement("button");u.className=o+"-reset",u.setAttribute("type","button"),u.title=n,u.appendChild(this.label_),(0,a.listen)(u,l.default.CLICK,d.prototype.handleClick_,this);const h=o+" "+s.CLASS_UNSELECTABLE+" "+s.CLASS_CONTROL,_=document.createElement("div");_.className=h,_.appendChild(u),this.callResetNorth_=i.resetNorth?i.resetNorth:void 0,e.default.call(this,{element:_,render:i.render||c,target:i.target}),this.duration_=void 0!==i.duration?i.duration:250,this.autoHide_=void 0===i.autoHide||i.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(s.CLASS_HIDDEN)};function c(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const t="rotate("+i+"rad)";if(this.autoHide_){const t=this.element.classList.contains(s.CLASS_HIDDEN);t||0!==i?t&&0!==i&&this.element.classList.remove(s.CLASS_HIDDEN):this.element.classList.add(s.CLASS_HIDDEN)}this.label_.style.msTransform=t,this.label_.style.webkitTransform=t,this.label_.style.transform=t}this.rotation_=i}(0,r.inherits)(d,e.default),d.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},d.prototype.resetNorth_=function(){const t=this.getMap().getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:i.easeOut}):t.setRotation(0))},exports.default=d;
},{"../control/Control.js":181,"../css.js":99,"../easing.js":106,"../events.js":84,"../events/EventType.js":110,"../util.js":43}],187:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util.js"),t=require("../events.js"),o=require("../events/EventType.js"),n=u(o),i=require("../control/Control.js"),a=u(i),s=require("../css.js"),l=require("../easing.js");function u(e){return e&&e.__esModule?e:{default:e}}const r=function(e){const o=e||{},i=void 0!==o.className?o.className:"ol-zoom",l=void 0!==o.delta?o.delta:1,u=void 0!==o.zoomInLabel?o.zoomInLabel:"+",d=void 0!==o.zoomOutLabel?o.zoomOutLabel:"âˆ’",c=void 0!==o.zoomInTipLabel?o.zoomInTipLabel:"Zoom in",m=void 0!==o.zoomOutTipLabel?o.zoomOutTipLabel:"Zoom out",p=document.createElement("button");p.className=i+"-in",p.setAttribute("type","button"),p.title=c,p.appendChild("string"==typeof u?document.createTextNode(u):u),(0,t.listen)(p,n.default.CLICK,r.prototype.handleClick_.bind(this,l));const b=document.createElement("button");b.className=i+"-out",b.setAttribute("type","button"),b.title=m,b.appendChild("string"==typeof d?document.createTextNode(d):d),(0,t.listen)(b,n.default.CLICK,r.prototype.handleClick_.bind(this,-l));const f=i+" "+s.CLASS_UNSELECTABLE+" "+s.CLASS_CONTROL,h=document.createElement("div");h.className=f,h.appendChild(p),h.appendChild(b),a.default.call(this,{element:h,target:o.target}),this.duration_=void 0!==o.duration?o.duration:250};(0,e.inherits)(r,a.default),r.prototype.handleClick_=function(e,t){t.preventDefault(),this.zoomByDelta_(e)},r.prototype.zoomByDelta_=function(e){const t=this.getMap().getView();if(!t)return;const o=t.getResolution();if(o){const n=t.constrainResolution(o,e);this.duration_>0?(t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:n,duration:this.duration_,easing:l.easeOut})):t.setResolution(n)}},exports.default=r;
},{"../util.js":43,"../events.js":84,"../events/EventType.js":110,"../control/Control.js":181,"../css.js":99,"../easing.js":106}],122:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaults=d;var t=require("../Collection.js"),e=a(t),o=require("./Attribution.js"),r=a(o),u=require("./Rotate.js"),i=a(u),n=require("./Zoom.js"),s=a(n);function a(t){return t&&t.__esModule?t:{default:t}}function d(t){const o=t||{},u=new e.default;return(void 0===o.zoom||o.zoom)&&u.push(new s.default(o.zoomOptions)),(void 0===o.rotate||o.rotate)&&u.push(new i.default(o.rotateOptions)),(void 0===o.attribution||o.attribution)&&u.push(new r.default(o.attributionOptions)),u}
},{"../Collection.js":16,"./Attribution.js":184,"./Rotate.js":185,"./Zoom.js":187}],246:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ACTIVE:"active"};
},{}],172:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pan=c,exports.rotate=l,exports.rotateWithoutConstraints=f,exports.zoom=p,exports.zoomByDelta=d,exports.zoomWithoutConstraints=g;var t=require("../util.js"),e=require("../Object.js"),n=a(e),o=require("../easing.js"),i=require("../interaction/Property.js"),s=a(i),r=require("../math.js");function a(t){return t&&t.__esModule?t:{default:t}}const u=function(t){n.default.call(this),this.map_=null,this.setActive(!0),this.handleEvent=t.handleEvent};function c(t,e,n){const i=t.getCenter();if(i){const s=t.constrainCenter([i[0]+e[0],i[1]+e[1]]);n?t.animate({duration:n,easing:o.linear,center:s}):t.setCenter(s)}}function l(t,e,n,o){e=t.constrainRotation(e,0),f(t,e,n,o)}function f(t,e,n,i){if(void 0!==e){const s=t.getRotation(),r=t.getCenter();void 0!==s&&r&&i>0?t.animate({rotation:e,anchor:n,duration:i,easing:o.easeOut}):t.rotate(e,n)}}function p(t,e,n,o,i){e=t.constrainResolution(e,0,i),g(t,e,n,o)}function d(t,e,n,o){const i=t.getResolution();let s=t.constrainResolution(i,e,0);if(void 0!==s){const e=t.getResolutions();s=(0,r.clamp)(s,t.getMinResolution()||e[e.length-1],t.getMaxResolution()||e[0])}if(n&&void 0!==s&&s!==i){const e=t.getCenter();let o=t.calculateCenterZoom(s,n);o=t.constrainCenter(o),n=[(s*e[0]-i*o[0])/(s-i),(s*e[1]-i*o[1])/(s-i)]}g(t,s,n,o)}function g(t,e,n,i){if(e){const s=t.getResolution(),r=t.getCenter();if(void 0!==s&&r&&e!==s&&i)t.animate({resolution:e,anchor:n,duration:i,easing:o.easeOut});else{if(n){const o=t.calculateCenterZoom(e,n);t.setCenter(o)}t.setResolution(e)}}}(0,t.inherits)(u,n.default),u.prototype.getActive=function(){return this.get(s.default.ACTIVE)},u.prototype.getMap=function(){return this.map_},u.prototype.setActive=function(t){this.set(s.default.ACTIVE,t)},u.prototype.setMap=function(t){this.map_=t},exports.default=u;
},{"../util.js":43,"../Object.js":31,"../easing.js":106,"../interaction/Property.js":246,"../math.js":87}],160:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../MapBrowserEventType.js"),i=a(e),n=require("../interaction/Interaction.js"),r=a(n);function a(t){return t&&t.__esModule?t:{default:t}}const o=function(t){const e=t||{};this.delta_=e.delta?e.delta:1,r.default.call(this,{handleEvent:u}),this.duration_=void 0!==e.duration?e.duration:250};function u(t){let e=!1;const r=t.originalEvent;if(t.type==i.default.DBLCLICK){const i=t.map,a=t.coordinate,o=r.shiftKey?-this.delta_:this.delta_,u=i.getView();(0,n.zoomByDelta)(u,o,a,this.duration_),t.preventDefault(),e=!0}return!e}(0,t.inherits)(o,r.default),exports.default=o;
},{"../util.js":43,"../MapBrowserEventType.js":95,"../interaction/Interaction.js":172}],238:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.primaryAction=exports.mouseOnly=exports.targetNotEditable=exports.shiftKeyOnly=exports.platformModifierKeyOnly=exports.noModifierKeys=exports.doubleClick=exports.singleClick=exports.pointerMove=exports.never=exports.mouseActionButton=exports.click=exports.always=exports.focus=exports.altShiftKeysOnly=exports.altKeyOnly=void 0;var e=require("../MapBrowserEventType.js"),t=s(e),r=require("../asserts.js"),n=require("../functions.js"),o=require("../has.js");function s(e){return e&&e.__esModule?e:{default:e}}const i=exports.altKeyOnly=function(e){const t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},l=exports.altShiftKeysOnly=function(e){const t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},u=exports.focus=function(e){return e.target.getTargetElement()===document.activeElement},y=exports.always=n.TRUE,p=exports.click=function(e){return e.type==t.default.CLICK},a=exports.mouseActionButton=function(e){const t=e.originalEvent;return 0==t.button&&!(o.WEBKIT&&o.MAC&&t.ctrlKey)},c=exports.never=n.FALSE,f=exports.pointerMove=function(e){return"pointermove"==e.type},K=exports.singleClick=function(e){return e.type==t.default.SINGLECLICK},x=exports.doubleClick=function(e){return e.type==t.default.DBLCLICK},E=exports.noModifierKeys=function(e){const t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},m=exports.platformModifierKeyOnly=function(e){const t=e.originalEvent;return!t.altKey&&(o.MAC?t.metaKey:t.ctrlKey)&&!t.shiftKey},v=exports.shiftKeyOnly=function(e){const t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},d=exports.targetNotEditable=function(e){const t=e.originalEvent.target.tagName;return"INPUT"!==t&&"SELECT"!==t&&"TEXTAREA"!==t},g=exports.mouseOnly=function(e){return(0,r.assert)(e.pointerEvent,56),"mouse"==e.pointerEvent.pointerType},C=exports.primaryAction=function(e){const t=e.pointerEvent;return t.isPrimary&&0===t.button};
},{"../MapBrowserEventType.js":95,"../asserts.js":83,"../functions.js":103,"../has.js":86}],174:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.centroid=f,exports.handleEvent=P;var e=require("../util.js"),t=require("../functions.js"),n=require("../MapBrowserEventType.js"),i=d(n),r=require("../MapBrowserPointerEvent.js"),s=d(r),o=require("../interaction/Interaction.js"),a=d(o),l=require("../obj.js");function d(e){return e&&e.__esModule?e:{default:e}}const h=t.UNDEFINED,u=t.FALSE,E=t.FALSE,c=t.UNDEFINED,p=function(e){const t=e||{};a.default.call(this,{handleEvent:t.handleEvent||P}),this.handleDownEvent_=t.handleDownEvent?t.handleDownEvent:E,this.handleDragEvent_=t.handleDragEvent?t.handleDragEvent:h,this.handleMoveEvent_=t.handleMoveEvent?t.handleMoveEvent:c,this.handleUpEvent_=t.handleUpEvent?t.handleUpEvent:u,this.handlingDownUpSequence=!1,this.trackedPointers_={},this.targetPointers=[]};function f(e){const t=e.length;let n=0,i=0;for(let r=0;r<t;r++)n+=e[r].clientX,i+=e[r].clientY;return[n/t,i/t]}function v(e){const t=e.type;return t===i.default.POINTERDOWN||t===i.default.POINTERDRAG||t===i.default.POINTERUP}function P(e){if(!(e instanceof s.default))return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==i.default.POINTERDRAG)this.handleDragEvent_(e);else if(e.type==i.default.POINTERUP){const t=this.handleUpEvent_(e);this.handlingDownUpSequence=t&&this.targetPointers.length>0}}else if(e.type==i.default.POINTERDOWN){const n=this.handleDownEvent_(e);this.handlingDownUpSequence=n,t=this.shouldStopEvent(n)}else e.type==i.default.POINTERMOVE&&this.handleMoveEvent_(e);return!t}(0,e.inherits)(p,a.default),p.prototype.updateTrackedPointers_=function(e){if(v(e)){const t=e.pointerEvent,n=t.pointerId.toString();e.type==i.default.POINTERUP?delete this.trackedPointers_[n]:e.type==i.default.POINTERDOWN?this.trackedPointers_[n]=t:n in this.trackedPointers_&&(this.trackedPointers_[n]=t),this.targetPointers=(0,l.getValues)(this.trackedPointers_)}},p.prototype.shouldStopEvent=function(e){return e},exports.default=p;
},{"../util.js":43,"../functions.js":103,"../MapBrowserEventType.js":95,"../MapBrowserPointerEvent.js":29,"../interaction/Interaction.js":172,"../obj.js":74}],161:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../ViewHint.js"),i=h(e),n=require("../coordinate.js"),s=require("../easing.js"),o=require("../events/condition.js"),r=require("../functions.js"),a=require("../interaction/Pointer.js"),c=h(a);function h(t){return t&&t.__esModule?t:{default:t}}const l=function(t){c.default.call(this,{handleDownEvent:g,handleDragEvent:u,handleUpEvent:d});const e=t||{};this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.condition_=e.condition?e.condition:o.noModifierKeys,this.noKinetic_=!1};function u(t){const e=this.targetPointers,i=(0,a.centroid)(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const e=this.lastCentroid[0]-i[0],s=i[1]-this.lastCentroid[1],o=t.map.getView();let r=[e,s];(0,n.scale)(r,o.getResolution()),(0,n.rotate)(r,o.getRotation()),(0,n.add)(r,o.getCenter()),r=o.constrainCenter(r),o.setCenter(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=e.length}function d(t){const e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),o=n.getCenter(),r=e.getPixelFromCoordinate(o),a=e.getCoordinateFromPixel([r[0]-t*Math.cos(i),r[1]-t*Math.sin(i)]);n.animate({center:n.constrainCenter(a),duration:500,easing:s.easeOut})}return n.setHint(i.default.INTERACTING,-1),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}function g(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,this.handlingDownUpSequence||e.setHint(i.default.INTERACTING,1),e.getAnimating()&&e.setCenter(t.frameState.viewState.center),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}(0,t.inherits)(l,c.default),l.prototype.shouldStopEvent=r.FALSE,exports.default=l;
},{"../util.js":43,"../ViewHint.js":102,"../coordinate.js":89,"../easing.js":106,"../events/condition.js":238,"../functions.js":103,"../interaction/Pointer.js":174}],176:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),n=require("../rotationconstraint.js"),e=require("../ViewHint.js"),i=l(e),o=require("../events/condition.js"),r=require("../functions.js"),s=require("../interaction/Interaction.js"),u=require("../interaction/Pointer.js"),a=l(u);function l(t){return t&&t.__esModule?t:{default:t}}const d=function(t){const n=t||{};a.default.call(this,{handleDownEvent:h,handleDragEvent:c,handleUpEvent:f}),this.condition_=n.condition?n.condition:o.altShiftKeysOnly,this.lastAngle_=void 0,this.duration_=void 0!==n.duration?n.duration:250};function c(t){if(!(0,o.mouseOnly)(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===n.disable)return;const r=e.getSize(),u=t.pixel,a=Math.atan2(r[1]/2-u[1],u[0]-r[0]/2);if(void 0!==this.lastAngle_){const t=a-this.lastAngle_,n=i.getRotation();(0,s.rotateWithoutConstraints)(i,n-t)}this.lastAngle_=a}function f(t){if(!(0,o.mouseOnly)(t))return!0;const n=t.map.getView();n.setHint(i.default.INTERACTING,-1);const e=n.getRotation();return(0,s.rotate)(n,e,void 0,this.duration_),!1}function h(t){if(!(0,o.mouseOnly)(t))return!1;if((0,o.mouseActionButton)(t)&&this.condition_(t)){return t.map.getView().setHint(i.default.INTERACTING,1),this.lastAngle_=void 0,!0}return!1}(0,t.inherits)(d,a.default),d.prototype.shouldStopEvent=r.FALSE,exports.default=d;
},{"../util.js":43,"../rotationconstraint.js":128,"../ViewHint.js":102,"../events/condition.js":238,"../functions.js":103,"../interaction/Interaction.js":172,"../interaction/Pointer.js":174}],240:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util.js"),t=require("../Disposable.js"),i=o(t),s=require("../geom/Polygon.js"),n=o(s);function o(e){return e&&e.__esModule?e:{default:e}}const r=function(e){this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null};(0,e.inherits)(r,i.default),r.prototype.disposeInternal=function(){this.setMap(null)},r.prototype.render_=function(){const e=this.startPixel_,t=this.endPixel_,i=this.element_.style;i.left=Math.min(e[0],t[0])+"px",i.top=Math.min(e[1],t[1])+"px",i.width=Math.abs(t[0]-e[0])+"px",i.height=Math.abs(t[1]-e[1])+"px"},r.prototype.setMap=function(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left=e.top=e.width=e.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},r.prototype.setPixels=function(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()},r.prototype.createOrUpdateGeometry=function(){const e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixel,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new n.default([i])},r.prototype.getGeometry=function(){return this.geometry_},exports.default=r;
},{"../util.js":43,"../Disposable.js":17,"../geom/Polygon.js":113}],168:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../events/Event.js"),e=l(t),n=require("../util.js"),i=require("../events/condition.js"),o=require("../functions.js"),s=require("../interaction/Pointer.js"),r=l(s),a=require("../render/Box.js"),d=l(a);function l(t){return t&&t.__esModule?t:{default:t}}const u={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"},h=function(t,n,i){e.default.call(this,t),this.coordinate=n,this.mapBrowserEvent=i};(0,n.inherits)(h,e.default);const c=function(t){r.default.call(this,{handleDownEvent:E,handleDragEvent:_,handleUpEvent:p});const e=t||{};this.box_=new d.default(e.className||"ol-dragbox"),this.minArea_=void 0!==e.minArea?e.minArea:64,this.startPixel_=null,this.condition_=e.condition?e.condition:i.always,this.boxEndCondition_=e.boxEndCondition?e.boxEndCondition:x};function x(t,e,n){const i=n[0]-e[0],o=n[1]-e[1];return i*i+o*o>=this.minArea_}function _(t){(0,i.mouseOnly)(t)&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new h(u.BOXDRAG,t.coordinate,t)))}function p(t){return!(0,i.mouseOnly)(t)||(this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd(t),this.dispatchEvent(new h(u.BOXEND,t.coordinate,t))),!1)}function E(t){return!!(0,i.mouseOnly)(t)&&(!(!(0,i.mouseActionButton)(t)||!this.condition_(t))&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new h(u.BOXSTART,t.coordinate,t)),!0))}(0,n.inherits)(c,r.default),c.prototype.getGeometry=function(){return this.box_.getGeometry()},c.prototype.onBoxEnd=o.UNDEFINED,exports.default=c;
},{"../events/Event.js":123,"../util.js":43,"../events/condition.js":238,"../functions.js":103,"../interaction/Pointer.js":174,"../render/Box.js":240}],165:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../easing.js"),o=require("../events/condition.js"),i=require("../extent.js"),n=require("../interaction/DragBox.js"),r=s(n);function s(t){return t&&t.__esModule?t:{default:t}}const a=function(t){const e=t||{},i=e.condition?e.condition:o.shiftKeyOnly;this.duration_=void 0!==e.duration?e.duration:200,this.out_=void 0!==e.out&&e.out,r.default.call(this,{condition:i,className:e.className||"ol-dragzoom"})};(0,t.inherits)(a,r.default),a.prototype.onBoxEnd=function(){const t=this.getMap(),o=t.getView(),n=t.getSize();let r=this.getGeometry().getExtent();if(this.out_){const e=o.calculateExtent(n),s=(0,i.createOrUpdateFromCoordinates)([t.getPixelFromCoordinate((0,i.getBottomLeft)(r)),t.getPixelFromCoordinate((0,i.getTopRight)(r))]),a=o.getResolutionForExtent(s,n);(0,i.scaleFromCenter)(e,1/a),r=e}const s=o.constrainResolution(o.getResolutionForExtent(r,n));let a=(0,i.getCenter)(r);a=o.constrainCenter(a),o.animate({resolution:s,center:a,duration:this.duration_,easing:e.easeOut})},exports.default=a;
},{"../util.js":43,"../easing.js":106,"../events/condition.js":238,"../extent.js":90,"../interaction/DragBox.js":168}],239:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={LEFT:37,UP:38,RIGHT:39,DOWN:40};
},{}],162:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../coordinate.js"),i=require("../events/EventType.js"),n=l(i),o=require("../events/KeyCode.js"),u=l(o),a=require("../events/condition.js"),d=require("../interaction/Interaction.js"),r=l(d);function l(t){return t&&t.__esModule?t:{default:t}}const s=function(t){r.default.call(this,{handleEvent:f});const e=t||{};this.defaultCondition_=function(t){return(0,a.noModifierKeys)(t)&&(0,a.targetNotEditable)(t)},this.condition_=void 0!==e.condition?e.condition:this.defaultCondition_,this.duration_=void 0!==e.duration?e.duration:100,this.pixelDelta_=void 0!==e.pixelDelta?e.pixelDelta:128};function f(t){let i=!1;if(t.type==n.default.KEYDOWN){const n=t.originalEvent.keyCode;if(this.condition_(t)&&(n==u.default.DOWN||n==u.default.LEFT||n==u.default.RIGHT||n==u.default.UP)){const o=t.map.getView(),a=o.getResolution()*this.pixelDelta_;let r=0,l=0;n==u.default.DOWN?l=-a:n==u.default.LEFT?r=-a:n==u.default.RIGHT?r=a:l=a;const s=[r,l];(0,e.rotate)(s,o.getRotation()),(0,d.pan)(o,s,this.duration_),t.preventDefault(),i=!0}}return!i}(0,t.inherits)(s,r.default),exports.default=s;
},{"../util.js":43,"../coordinate.js":89,"../events/EventType.js":110,"../events/KeyCode.js":239,"../events/condition.js":238,"../interaction/Interaction.js":172}],163:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../events/EventType.js"),i=a(e),n=require("../events/condition.js"),o=require("../interaction/Interaction.js"),r=a(o);function a(t){return t&&t.__esModule?t:{default:t}}const d=function(t){r.default.call(this,{handleEvent:s});const e=t||{};this.condition_=e.condition?e.condition:n.targetNotEditable,this.delta_=e.delta?e.delta:1,this.duration_=void 0!==e.duration?e.duration:100};function s(t){let e=!1;if(t.type==i.default.KEYDOWN||t.type==i.default.KEYPRESS){const i=t.originalEvent.charCode;if(this.condition_(t)&&(i=="+".charCodeAt(0)||i=="-".charCodeAt(0))){const n=t.map,r=i=="+".charCodeAt(0)?this.delta_:-this.delta_,a=n.getView();(0,o.zoomByDelta)(a,r,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}(0,t.inherits)(d,r.default),exports.default=d;
},{"../util.js":43,"../events/EventType.js":110,"../events/condition.js":238,"../interaction/Interaction.js":172}],164:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Mode=void 0;var t=require("../util.js"),e=require("../ViewHint.js"),i=c(e),o=require("../events/condition.js"),s=require("../easing.js"),n=require("../events/EventType.js"),a=c(n),r=require("../has.js"),h=require("../interaction/Interaction.js"),u=c(h),d=require("../math.js");function c(t){return t&&t.__esModule?t:{default:t}}const l=1,_=exports.Mode={TRACKPAD:"trackpad",WHEEL:"wheel"},m=function(t){u.default.call(this,{handleEvent:p});const e=t||{};this.delta_=0,this.duration_=void 0!==e.duration?e.duration:250,this.timeout_=void 0!==e.timeout?e.timeout:80,this.useAnchor_=void 0===e.useAnchor||e.useAnchor,this.constrainResolution_=e.constrainResolution||!1,this.condition_=e.condition?e.condition:o.always,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_=void 0,this.trackpadDeltaPerZoom_=300,this.trackpadZoomBuffer_=1.5};function p(t){if(!this.condition_(t))return!0;const e=t.type;if(e!==a.default.WHEEL&&e!==a.default.MOUSEWHEEL)return!0;t.preventDefault();const o=t.map,n=t.originalEvent;let h;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==a.default.WHEEL?(h=n.deltaY,r.FIREFOX&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(h/=r.DEVICE_PIXEL_RATIO),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(h*=40)):t.type==a.default.MOUSEWHEEL&&(h=-n.wheelDeltaY,r.SAFARI&&(h/=3)),0===h)return!1;const u=Date.now();if(void 0===this.startTime_&&(this.startTime_=u),(!this.mode_||u-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(h)<4?_.TRACKPAD:_.WHEEL),this.mode_===_.TRACKPAD){const t=o.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):t.setHint(i.default.INTERACTING,1),this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);let e=t.getResolution()*Math.pow(2,h/this.trackpadDeltaPerZoom_);const n=t.getMinResolution(),a=t.getMaxResolution();let r=0;if(e<n?(e=Math.max(e,n/this.trackpadZoomBuffer_),r=1):e>a&&(e=Math.min(e,a*this.trackpadZoomBuffer_),r=-1),this.lastAnchor_){const i=t.calculateCenterZoom(e,this.lastAnchor_);t.setCenter(t.constrainCenter(i))}return t.setResolution(e),0===r&&this.constrainResolution_&&t.animate({resolution:t.constrainResolution(e,h>0?-1:1),easing:s.easeOut,anchor:this.lastAnchor_,duration:this.duration_}),r>0?t.animate({resolution:n,easing:s.easeOut,anchor:this.lastAnchor_,duration:500}):r<0&&t.animate({resolution:a,easing:s.easeOut,anchor:this.lastAnchor_,duration:500}),this.startTime_=u,!1}this.delta_+=h;const d=Math.max(this.timeout_-(u-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,o),d),!1}(0,t.inherits)(m,u.default),m.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().setHint(i.default.INTERACTING,-1)},m.prototype.handleWheelZoom_=function(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();const i=(0,d.clamp)(this.delta_,-1,1);(0,h.zoomByDelta)(e,-i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.delta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},m.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},exports.default=m;
},{"../util.js":43,"../ViewHint.js":102,"../events/condition.js":238,"../easing.js":106,"../events/EventType.js":110,"../has.js":86,"../interaction/Interaction.js":172,"../math.js":87}],178:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),i=require("../ViewHint.js"),e=h(i),n=require("../functions.js"),o=require("../interaction/Interaction.js"),r=require("../interaction/Pointer.js"),s=h(r),a=require("../rotationconstraint.js");function h(t){return t&&t.__esModule?t:{default:t}}const l=function(t){s.default.call(this,{handleDownEvent:d,handleDragEvent:u,handleUpEvent:c});const i=t||{};this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==i.threshold?i.threshold:.3,this.duration_=void 0!==i.duration?i.duration:250};function u(t){let i=0;const e=this.targetPointers[0],n=this.targetPointers[1],s=Math.atan2(n.clientY-e.clientY,n.clientX-e.clientX);if(void 0!==this.lastAngle_){const t=s-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),i=t}this.lastAngle_=s;const h=t.map,l=h.getView();if(l.getConstraints().rotation===a.disable)return;const u=h.getViewport().getBoundingClientRect(),c=(0,r.centroid)(this.targetPointers);if(c[0]-=u.left,c[1]-=u.top,this.anchor_=h.getCoordinateFromPixel(c),this.rotating_){const t=l.getRotation();h.render(),(0,o.rotateWithoutConstraints)(l,t+i,this.anchor_)}}function c(t){if(this.targetPointers.length<2){const i=t.map.getView();if(i.setHint(e.default.INTERACTING,-1),this.rotating_){const t=i.getRotation();(0,o.rotate)(i,t,this.anchor_,this.duration_)}return!1}return!0}function d(t){if(this.targetPointers.length>=2){const i=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||i.getView().setHint(e.default.INTERACTING,1),!0}return!1}(0,t.inherits)(l,s.default),l.prototype.shouldStopEvent=n.FALSE,exports.default=l;
},{"../util.js":43,"../ViewHint.js":102,"../functions.js":103,"../interaction/Interaction.js":172,"../interaction/Pointer.js":174,"../rotationconstraint.js":128}],166:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../ViewHint.js"),i=r(e),n=require("../functions.js"),s=require("../interaction/Interaction.js"),o=require("../interaction/Pointer.js"),a=r(o);function r(t){return t&&t.__esModule?t:{default:t}}const l=function(t){a.default.call(this,{handleDownEvent:h,handleDragEvent:u,handleUpEvent:c});const e=t||{};this.constrainResolution_=e.constrainResolution||!1,this.anchor_=null,this.duration_=void 0!==e.duration?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1};function u(t){let e=1;const i=this.targetPointers[0],n=this.targetPointers[1],a=i.clientX-n.clientX,r=i.clientY-n.clientY,l=Math.sqrt(a*a+r*r);void 0!==this.lastDistance_&&(e=this.lastDistance_/l),this.lastDistance_=l;const u=t.map,c=u.getView(),h=c.getResolution(),d=c.getMaxResolution(),g=c.getMinResolution();let _=h*e;_>d?(e=d/h,_=d):_<g&&(e=g/h,_=g),1!=e&&(this.lastScaleDelta_=e);const f=u.getViewport().getBoundingClientRect(),p=(0,o.centroid)(this.targetPointers);p[0]-=f.left,p[1]-=f.top,this.anchor_=u.getCoordinateFromPixel(p),u.render(),(0,s.zoomWithoutConstraints)(c,_,this.anchor_)}function c(t){if(this.targetPointers.length<2){const e=t.map.getView();e.setHint(i.default.INTERACTING,-1);const n=e.getResolution();if(this.constrainResolution_||n<e.getMinResolution()||n>e.getMaxResolution()){const t=this.lastScaleDelta_-1;(0,s.zoom)(e,n,this.anchor_,this.duration_,t)}return!1}return!0}function h(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().setHint(i.default.INTERACTING,1),!0}return!1}(0,t.inherits)(l,a.default),l.prototype.shouldStopEvent=n.FALSE,exports.default=l;
},{"../util.js":43,"../ViewHint.js":102,"../functions.js":103,"../interaction/Interaction.js":172,"../interaction/Pointer.js":174}],167:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../functions.js"),s=require("../events.js"),r=require("../events/Event.js"),i=c(r),n=require("../events/EventType.js"),o=c(n),u=require("../interaction/Interaction.js"),a=c(u),l=require("../proj.js");function c(t){return t&&t.__esModule?t:{default:t}}const h={ADD_FEATURES:"addfeatures"},f=function(t,e,s,r){i.default.call(this,t),this.features=s,this.file=e,this.projection=r};(0,t.inherits)(f,i.default);const p=function(t){const s=t||{};a.default.call(this,{handleEvent:e.TRUE}),this.formatConstructors_=s.formatConstructors?s.formatConstructors:[],this.projection_=s.projection?(0,l.get)(s.projection):null,this.dropListenKeys_=null,this.source_=s.source||null,this.target=s.target?s.target:null};function d(t){const e=t.dataTransfer.files;for(let t=0,s=e.length;t<s;++t){const s=e.item(t),r=new FileReader;r.addEventListener(o.default.LOAD,this.handleResult_.bind(this,s)),r.readAsText(s)}}function _(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}(0,t.inherits)(p,a.default),p.prototype.handleResult_=function(t,e){const s=e.target.result,r=this.getMap();let i=this.projection_;if(!i){i=r.getView().getProjection()}const n=this.formatConstructors_;let o=[];for(let t=0,e=n.length;t<e;++t){const e=new(0,n[t]);if((o=this.tryReadFeatures_(e,s,{featureProjection:i}))&&o.length>0)break}this.source_&&(this.source_.clear(),this.source_.addFeatures(o)),this.dispatchEvent(new f(h.ADD_FEATURES,t,o,i))},p.prototype.registerListeners_=function(){const t=this.getMap();if(t){const e=this.target?this.target:t.getViewport();this.dropListenKeys_=[(0,s.listen)(e,o.default.DROP,d,this),(0,s.listen)(e,o.default.DRAGENTER,_,this),(0,s.listen)(e,o.default.DRAGOVER,_,this),(0,s.listen)(e,o.default.DROP,_,this)]}},p.prototype.setActive=function(t){a.default.prototype.setActive.call(this,t),t?this.registerListeners_():this.unregisterListeners_()},p.prototype.setMap=function(t){this.unregisterListeners_(),a.default.prototype.setMap.call(this,t),this.getActive()&&this.registerListeners_()},p.prototype.tryReadFeatures_=function(t,e,s){try{return t.readFeatures(e,s)}catch(t){return null}},p.prototype.unregisterListeners_=function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(s.unlistenByKey),this.dropListenKeys_=null)},exports.default=p;
},{"../util.js":43,"../functions.js":103,"../events.js":84,"../events/Event.js":123,"../events/EventType.js":110,"../interaction/Interaction.js":172,"../proj.js":88}],169:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),i=require("../rotationconstraint.js"),e=require("../ViewHint.js"),n=r(e),s=require("../events/condition.js"),o=require("../interaction/Interaction.js"),a=require("../interaction/Pointer.js"),l=r(a);function r(t){return t&&t.__esModule?t:{default:t}}const u=function(t){const i=t||{};l.default.call(this,{handleDownEvent:c,handleDragEvent:d,handleUpEvent:h}),this.condition_=i.condition?i.condition:s.shiftKeyOnly,this.lastAngle_=void 0,this.lastMagnitude_=void 0,this.lastScaleDelta_=0,this.duration_=void 0!==i.duration?i.duration:400};function d(t){if(!(0,s.mouseOnly)(t))return;const e=t.map,n=e.getSize(),a=t.pixel,l=a[0]-n[0]/2,r=n[1]/2-a[1],u=Math.atan2(r,l),d=Math.sqrt(l*l+r*r),h=e.getView();if(h.getConstraints().rotation!==i.disable&&void 0!==this.lastAngle_){const t=u-this.lastAngle_;(0,o.rotateWithoutConstraints)(h,h.getRotation()-t)}if(this.lastAngle_=u,void 0!==this.lastMagnitude_){const t=this.lastMagnitude_*(h.getResolution()/d);(0,o.zoomWithoutConstraints)(h,t)}void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/d),this.lastMagnitude_=d}function h(t){if(!(0,s.mouseOnly)(t))return!0;const i=t.map.getView();i.setHint(n.default.INTERACTING,-1);const e=this.lastScaleDelta_-1;return(0,o.rotate)(i,i.getRotation()),(0,o.zoom)(i,i.getResolution(),void 0,this.duration_,e),this.lastScaleDelta_=0,!1}function c(t){return!!(0,s.mouseOnly)(t)&&(!!this.condition_(t)&&(t.map.getView().setHint(n.default.INTERACTING,1),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0))}(0,t.inherits)(u,l.default),exports.default=u;
},{"../util.js":43,"../rotationconstraint.js":128,"../ViewHint.js":102,"../events/condition.js":238,"../interaction/Interaction.js":172,"../interaction/Pointer.js":174}],247:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../extent.js"),s=require("../geom/GeometryLayout.js"),o=u(s),i=require("../geom/GeometryType.js"),r=u(i),n=require("../geom/SimpleGeometry.js"),a=u(n),d=require("../geom/flat/deflate.js");function u(t){return t&&t.__esModule?t:{default:t}}const l=function(t,e,s){a.default.call(this);const o=e||0;this.setCenterAndRadius(t,o,s)};(0,t.inherits)(l,a.default),l.prototype.clone=function(){const t=new l(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},l.prototype.closestPointXY=function(t,e,s,o){const i=this.flatCoordinates,r=t-i[0],n=e-i[1],a=r*r+n*n;if(a<o){if(0===a)for(let t=0;t<this.stride;++t)s[t]=i[t];else{const t=this.getRadius()/Math.sqrt(a);s[0]=i[0]+t*r,s[1]=i[1]+t*n;for(let t=2;t<this.stride;++t)s[t]=i[t]}return s.length=this.stride,a}return o},l.prototype.containsXY=function(t,e){const s=this.flatCoordinates,o=t-s[0],i=e-s[1];return o*o+i*i<=this.getRadiusSquared_()},l.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},l.prototype.computeExtent=function(t){const s=this.flatCoordinates,o=s[this.stride]-s[0];return(0,e.createOrUpdate)(s[0]-o,s[1]-o,s[0]+o,s[1]+o,t)},l.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},l.prototype.getRadiusSquared_=function(){const t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},l.prototype.getType=function(){return r.default.CIRCLE},l.prototype.intersectsExtent=function(t){const s=this.getExtent();if((0,e.intersects)(t,s)){const s=this.getCenter();return t[0]<=s[0]&&t[2]>=s[0]||(t[1]<=s[1]&&t[3]>=s[1]||(0,e.forEachCorner)(t,this.intersectsCoordinate,this))}return!1},l.prototype.setCenter=function(t){const e=this.stride,s=this.flatCoordinates[e]-this.flatCoordinates[0],o=t.slice();o[e]=o[0]+s;for(let s=1;s<e;++s)o[e+s]=t[s];this.setFlatCoordinates(this.layout,o)},l.prototype.setCenterAndRadius=function(t,e,s){if(t){this.setLayout(s,t,0),this.flatCoordinates||(this.flatCoordinates=[]);const o=this.flatCoordinates;let i=(0,d.deflateCoordinate)(o,0,t,this.stride);o[i++]=o[0]+e;for(let t=1,e=this.stride;t<e;++t)o[i++]=o[t];o.length=i,this.changed()}else this.setFlatCoordinates(o.default.XY,null)},l.prototype.getCoordinates=function(){},l.prototype.setCoordinates=function(t,e){},l.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},l.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},l.prototype.transform,exports.default=l;
},{"../util.js":43,"../extent.js":90,"../geom/GeometryLayout.js":114,"../geom/GeometryType.js":140,"../geom/SimpleGeometry.js":141,"../geom/flat/deflate.js":199}],248:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../array.js"),s=require("../extent.js"),i=require("../geom/GeometryLayout.js"),n=C(i),o=require("../geom/GeometryType.js"),r=C(o),a=require("../geom/LineString.js"),l=C(a),d=require("../geom/SimpleGeometry.js"),h=C(d),u=require("../geom/flat/closest.js"),f=require("../geom/flat/deflate.js"),c=require("../geom/flat/inflate.js"),g=require("../geom/flat/interpolate.js"),p=require("../geom/flat/intersectsextent.js"),y=require("../geom/flat/simplify.js");function C(t){return t&&t.__esModule?t:{default:t}}const _=function(t,e){h.default.call(this),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.setCoordinates(t,e)};(0,t.inherits)(_,h.default),_.prototype.appendLineString=function(t){this.flatCoordinates?(0,e.extend)(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},_.prototype.clone=function(){const t=new _(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),this.ends_.slice()),t},_.prototype.closestPointXY=function(t,e,i,n){return n<(0,s.closestSquaredDistanceXY)(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,u.arrayMaxSquaredDelta)(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,u.assignClosestArrayPoint)(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))},_.prototype.getCoordinateAtM=function(t,e,s){if(this.layout!=n.default.XYM&&this.layout!=n.default.XYZM||0===this.flatCoordinates.length)return null;const i=void 0!==e&&e,o=void 0!==s&&s;return(0,g.lineStringsCoordinateAtM)(this.flatCoordinates,0,this.ends_,this.stride,t,i,o)},_.prototype.getCoordinates=function(){return(0,c.inflateCoordinatesArray)(this.flatCoordinates,0,this.ends_,this.stride)},_.prototype.getEnds=function(){return this.ends_},_.prototype.getLineString=function(t){if(t<0||this.ends_.length<=t)return null;const e=new l.default(null);return e.setFlatCoordinates(this.layout,this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t])),e},_.prototype.getLineStrings=function(){const t=this.flatCoordinates,e=this.ends_,s=this.layout,i=[];let n=0;for(let o=0,r=e.length;o<r;++o){const r=e[o],a=new l.default(null);a.setFlatCoordinates(s,t.slice(n,r)),i.push(a),n=r}return i},_.prototype.getFlatMidpoints=function(){const t=[],s=this.flatCoordinates;let i=0;const n=this.ends_,o=this.stride;for(let r=0,a=n.length;r<a;++r){const a=n[r],l=(0,g.interpolatePoint)(s,i,a,o,.5);(0,e.extend)(t,l),i=a}return t},_.prototype.getSimplifiedGeometryInternal=function(t){const e=[],s=[];e.length=(0,y.douglasPeuckerArray)(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,s);const i=new _(null);return i.setFlatCoordinates(n.default.XY,e,s),i},_.prototype.getType=function(){return r.default.MULTI_LINE_STRING},_.prototype.intersectsExtent=function(t){return(0,p.intersectsLineStringArray)(this.flatCoordinates,0,this.ends_,this.stride,t)},_.prototype.setCoordinates=function(t,e){if(t){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const s=(0,f.deflateCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===s.length?0:s[s.length-1],this.changed()}else this.setFlatCoordinates(n.default.XY,null,this.ends_)},_.prototype.setFlatCoordinates=function(t,e,s){this.setFlatCoordinatesInternal(t,e),this.ends_=s,this.changed()},_.prototype.setLineStrings=function(t){let s=this.getLayout();const i=[],n=[];for(let o=0,r=t.length;o<r;++o){const r=t[o];0===o&&(s=r.getLayout()),(0,e.extend)(i,r.getFlatCoordinates()),n.push(i.length)}this.setFlatCoordinates(s,i,n)},exports.default=_;
},{"../util.js":43,"../array.js":130,"../extent.js":90,"../geom/GeometryLayout.js":114,"../geom/GeometryType.js":140,"../geom/LineString.js":115,"../geom/SimpleGeometry.js":141,"../geom/flat/closest.js":197,"../geom/flat/deflate.js":199,"../geom/flat/inflate.js":200,"../geom/flat/interpolate.js":205,"../geom/flat/intersectsextent.js":202,"../geom/flat/simplify.js":204}],249:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../array.js"),o=require("../extent.js"),s=require("../geom/GeometryLayout.js"),i=p(s),n=require("../geom/GeometryType.js"),r=p(n),a=require("../geom/Point.js"),l=p(a),u=require("../geom/SimpleGeometry.js"),d=p(u),f=require("../geom/flat/deflate.js"),h=require("../geom/flat/inflate.js"),c=require("../math.js");function p(t){return t&&t.__esModule?t:{default:t}}const C=function(t,e){d.default.call(this),this.setCoordinates(t,e)};(0,t.inherits)(C,d.default),C.prototype.appendPoint=function(t){this.flatCoordinates?(0,e.extend)(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},C.prototype.clone=function(){const t=new C(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},C.prototype.closestPointXY=function(t,e,s,i){if(i<(0,o.closestSquaredDistanceXY)(this.getExtent(),t,e))return i;const n=this.flatCoordinates,r=this.stride;for(let o=0,a=n.length;o<a;o+=r){const a=(0,c.squaredDistance)(t,e,n[o],n[o+1]);if(a<i){i=a;for(let t=0;t<r;++t)s[t]=n[o+t];s.length=r}}return i},C.prototype.getCoordinates=function(){return(0,h.inflateCoordinates)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},C.prototype.getPoint=function(t){const e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;if(t<0||e<=t)return null;const o=new l.default(null);return o.setFlatCoordinates(this.layout,this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride)),o},C.prototype.getPoints=function(){const t=this.flatCoordinates,e=this.layout,o=this.stride,s=[];for(let i=0,n=t.length;i<n;i+=o){const n=new l.default(null);n.setFlatCoordinates(e,t.slice(i,i+o)),s.push(n)}return s},C.prototype.getType=function(){return r.default.MULTI_POINT},C.prototype.intersectsExtent=function(t){const e=this.flatCoordinates,s=this.stride;for(let i=0,n=e.length;i<n;i+=s){const s=e[i],n=e[i+1];if((0,o.containsXY)(t,s,n))return!0}return!1},C.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,f.deflateCoordinates)(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(i.default.XY,null)},C.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()},exports.default=C;
},{"../util.js":43,"../array.js":130,"../extent.js":90,"../geom/GeometryLayout.js":114,"../geom/GeometryType.js":140,"../geom/Point.js":116,"../geom/SimpleGeometry.js":141,"../geom/flat/deflate.js":199,"../geom/flat/inflate.js":200,"../math.js":87}],283:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.linearRingss=t;var e=require("../../extent.js");function t(t,r,n,s){const o=[];let a=(0,e.createEmpty)();for(let l=0,c=n.length;l<c;++l){const c=n[l];a=(0,e.createOrUpdateFromFlatCoordinates)(t,r,c[0],s),o.push((a[0]+a[2])/2,(a[1]+a[3])/2),r=c[c.length-1]}return o}
},{"../../extent.js":90}],250:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../array.js"),s=require("../extent.js"),i=require("../geom/GeometryLayout.js"),n=P(i),o=require("../geom/GeometryType.js"),r=P(o),l=require("../geom/MultiPoint.js"),a=P(l),h=require("../geom/Polygon.js"),d=P(h),u=require("../geom/SimpleGeometry.js"),f=P(u),g=require("../geom/flat/area.js"),c=require("../geom/flat/center.js"),p=require("../geom/flat/closest.js"),_=require("../geom/flat/contains.js"),y=require("../geom/flat/deflate.js"),C=require("../geom/flat/inflate.js"),m=require("../geom/flat/interiorpoint.js"),F=require("../geom/flat/intersectsextent.js"),q=require("../geom/flat/orient.js"),R=require("../geom/flat/simplify.js");function P(t){return t&&t.__esModule?t:{default:t}}const j=function(t,e){f.default.call(this),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,this.setCoordinates(t,e)};(0,t.inherits)(j,f.default),j.prototype.appendPolygon=function(t){let s;if(this.flatCoordinates){const i=this.flatCoordinates.length;(0,e.extend)(this.flatCoordinates,t.getFlatCoordinates());for(let e=0,n=(s=t.getEnds().slice()).length;e<n;++e)s[e]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),s=t.getEnds().slice(),this.endss_.push();this.endss_.push(s),this.changed()},j.prototype.clone=function(){const t=new j(null),e=this.endss_.length,s=new Array(e);for(let t=0;t<e;++t)s[t]=this.endss_[t].slice();return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),s),t},j.prototype.closestPointXY=function(t,e,i,n){return n<(0,s.closestSquaredDistanceXY)(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt((0,p.multiArrayMaxSquaredDelta)(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),(0,p.assignClosestMultiArrayPoint)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))},j.prototype.containsXY=function(t,e){return(0,_.linearRingssContainsXY)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},j.prototype.getArea=function(){return(0,g.linearRingss)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},j.prototype.getCoordinates=function(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),(0,q.orientLinearRingsArray)(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,(0,C.inflateMultiCoordinatesArray)(e,0,this.endss_,this.stride)},j.prototype.getEndss=function(){return this.endss_},j.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=(0,c.linearRingss)(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=(0,m.getInteriorPointsOfMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},j.prototype.getInteriorPoints=function(){const t=new a.default(null);return t.setFlatCoordinates(n.default.XYM,this.getFlatInteriorPoints().slice()),t},j.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;(0,q.linearRingsAreOriented)(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=(0,q.orientLinearRingsArray)(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},j.prototype.getSimplifiedGeometryInternal=function(t){const e=[],s=[];e.length=(0,R.quantizeMultiArray)(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,s);const i=new j(null);return i.setFlatCoordinates(n.default.XY,e,s),i},j.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;let e;if(0===t)e=0;else{const s=this.endss_[t-1];e=s[s.length-1]}const s=this.endss_[t].slice(),i=s[s.length-1];if(0!==e)for(let t=0,i=s.length;t<i;++t)s[t]-=e;const n=new d.default(null);return n.setFlatCoordinates(this.layout,this.flatCoordinates.slice(e,i),s),n},j.prototype.getPolygons=function(){const t=this.layout,e=this.flatCoordinates,s=this.endss_,i=[];let n=0;for(let o=0,r=s.length;o<r;++o){const r=s[o].slice(),l=r[r.length-1];if(0!==n)for(let t=0,e=r.length;t<e;++t)r[t]-=n;const a=new d.default(null);a.setFlatCoordinates(t,e.slice(n,l),r),i.push(a),n=l}return i},j.prototype.getType=function(){return r.default.MULTI_POLYGON},j.prototype.intersectsExtent=function(t){return(0,F.intersectsLinearRingMultiArray)(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},j.prototype.setCoordinates=function(t,e){if(t){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const s=(0,y.deflateMultiCoordinatesArray)(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===s.length)this.flatCoordinates.length=0;else{const t=s[s.length-1];this.flatCoordinates.length=0===t.length?0:t[t.length-1]}this.changed()}else this.setFlatCoordinates(n.default.XY,null,this.endss_)},j.prototype.setFlatCoordinates=function(t,e,s){this.setFlatCoordinatesInternal(t,e),this.endss_=s,this.changed()},j.prototype.setPolygons=function(t){let s=this.getLayout();const i=[],n=[];for(let o=0,r=t.length;o<r;++o){const r=t[o];0===o&&(s=r.getLayout());const l=i.length,a=r.getEnds();for(let t=0,e=a.length;t<e;++t)a[t]+=l;(0,e.extend)(i,r.getFlatCoordinates()),n.push(a)}this.setFlatCoordinates(s,i,n)},exports.default=j;
},{"../util.js":43,"../array.js":130,"../extent.js":90,"../geom/GeometryLayout.js":114,"../geom/GeometryType.js":140,"../geom/MultiPoint.js":249,"../geom/Polygon.js":113,"../geom/SimpleGeometry.js":141,"../geom/flat/area.js":196,"../geom/flat/center.js":283,"../geom/flat/closest.js":197,"../geom/flat/contains.js":198,"../geom/flat/deflate.js":199,"../geom/flat/inflate.js":200,"../geom/flat/interiorpoint.js":201,"../geom/flat/intersectsextent.js":202,"../geom/flat/orient.js":203,"../geom/flat/simplify.js":204}],73:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IMAGE:"IMAGE",TILE:"TILE",VECTOR_TILE:"VECTOR_TILE",VECTOR:"VECTOR"};
},{}],219:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IMAGE:"image",VECTOR:"vector"};
},{}],245:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderType=void 0;var e=require("../util.js"),t=require("../LayerType.js"),r=s(t),i=require("../layer/Layer.js"),n=s(i),u=require("../layer/VectorRenderType.js"),o=s(u),d=require("../obj.js"),l=require("../style/Style.js");function s(e){return e&&e.__esModule?e:{default:e}}const p=exports.RenderType={IMAGE:"image",VECTOR:"vector"},a={RENDER_ORDER:"renderOrder"},c=function(e){const t=e||{},i=(0,d.assign)({},t);delete i.style,delete i.renderBuffer,delete i.updateWhileAnimating,delete i.updateWhileInteracting,n.default.call(this,i),this.declutter_=void 0!==t.declutter&&t.declutter,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting,this.renderMode_=t.renderMode||o.default.VECTOR,this.type=r.default.VECTOR};(0,e.inherits)(c,n.default),c.prototype.getDeclutter=function(){return this.declutter_},c.prototype.setDeclutter=function(e){this.declutter_=e},c.prototype.getRenderBuffer=function(){return this.renderBuffer_},c.prototype.getRenderOrder=function(){return this.get(a.RENDER_ORDER)},c.prototype.getSource,c.prototype.getStyle=function(){return this.style_},c.prototype.getStyleFunction=function(){return this.styleFunction_},c.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},c.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},c.prototype.setRenderOrder=function(e){this.set(a.RENDER_ORDER,e)},c.prototype.setStyle=function(e){this.style_=void 0!==e?e:l.createDefaultStyle,this.styleFunction_=null===e?void 0:(0,l.toFunction)(this.style_),this.changed()},c.prototype.getRenderMode=function(){return this.renderMode_},exports.default=c;
},{"../util.js":43,"../LayerType.js":73,"../layer/Layer.js":75,"../layer/VectorRenderType.js":219,"../obj.js":74,"../style/Style.js":112}],180:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};
},{}],108:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadFeaturesXhr=n,exports.xhr=o;var e=require("./functions.js"),t=require("./format/FormatType.js"),r=s(t);function s(e){return e&&e.__esModule?e:{default:e}}function n(e,t,s,n){return function(o,a,u){const i=new XMLHttpRequest;i.open("GET","function"==typeof e?e(o,a,u):e,!0),t.getType()==r.default.ARRAY_BUFFER&&(i.responseType="arraybuffer"),i.onload=function(e){if(!i.status||i.status>=200&&i.status<300){const e=t.getType();let o;e==r.default.JSON||e==r.default.TEXT?o=i.responseText:e==r.default.XML?(o=i.responseXML)||(o=(new DOMParser).parseFromString(i.responseText,"application/xml")):e==r.default.ARRAY_BUFFER&&(o=i.response),o?s.call(this,t.readFeatures(o,{featureProjection:u}),t.readProjection(o),t.getLastExtent()):n.call(this)}else n.call(this)}.bind(this),i.onerror=function(){n.call(this)}.bind(this),i.send()}}function o(t,r){return n(t,r,function(e,t){this.addFeatures(e)},e.UNDEFINED)}
},{"./functions.js":103,"./format/FormatType.js":180}],282:[function(require,module,exports) {
"use strict";function e(e,t){return[[-1/0,-1/0,1/0,1/0]]}function t(e,t){return[e]}function n(e){return function(t,n){const o=e.getZForResolution(n),r=e.getTileRangeForExtentAndZ(t,o),u=[],i=[o,0,0];for(i[1]=r.minX;i[1]<=r.maxX;++i[1])for(i[2]=r.minY;i[2]<=r.maxY;++i[2])u.push(e.getTileCoordExtent(i));return u}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.all=e,exports.bbox=t,exports.tile=n;
},{}],281:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../functions.js"),r=require("../Object.js"),i=u(r),o=require("../proj.js"),n=require("../source/State.js"),s=u(n);function u(t){return t&&t.__esModule?t:{default:t}}const a=function(t){i.default.call(this),this.projection_=(0,o.get)(t.projection),this.attributions_=this.adaptAttributions_(t.attributions),this.state_=void 0!==t.state?t.state:s.default.READY,this.wrapX_=void 0!==t.wrapX&&t.wrapX};(0,t.inherits)(a,i.default),a.prototype.adaptAttributions_=function(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null},a.prototype.forEachFeatureAtCoordinate=e.UNDEFINED,a.prototype.getAttributions=function(){return this.attributions_},a.prototype.getProjection=function(){return this.projection_},a.prototype.getResolutions=function(){},a.prototype.getState=function(){return this.state_},a.prototype.getWrapX=function(){return this.wrapX_},a.prototype.refresh=function(){this.changed()},a.prototype.setAttributions=function(t){this.attributions_=this.adaptAttributions_(t),this.changed()},a.prototype.setState=function(t){this.state_=t,this.changed()},exports.default=a;
},{"../util.js":43,"../functions.js":103,"../Object.js":31,"../proj.js":88,"../source/State.js":151}],244:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"};
},{}],256:[function(require,module,exports) {
var define;
var global = arguments[3];
var t,o=arguments[3];!function(o,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof t&&t.amd?t(n):o.quickselect=n()}(this,function(){"use strict";function t(t,o,n){var r=t[o];t[o]=t[n],t[n]=r}function o(t,o){return t<o?-1:t>o?1:0}return function(n,r,e,f,u){!function o(n,r,e,f,u){for(;f>e;){if(f-e>600){var a=f-e+1,i=r-e+1,c=Math.log(a),h=.5*Math.exp(2*c/3),s=.5*Math.sqrt(c*h*(a-h)/a)*(i-a/2<0?-1:1),l=Math.max(e,Math.floor(r-i*h/a+s)),M=Math.min(f,Math.floor(r+(a-i)*h/a+s));o(n,r,l,M,u)}var m=n[r],p=e,d=f;for(t(n,e,r),u(n[f],m)>0&&t(n,e,f);p<d;){for(t(n,p,d),p++,d--;u(n[p],m)<0;)p++;for(;u(n[d],m)>0;)d--}0===u(n[e],m)?t(n,e,d):t(n,++d,f),d<=r&&(e=d+1),r<=d&&(f=d-1)}}(n,r,e||0,f||n.length-1,u||o)}});
},{}],228:[function(require,module,exports) {
"use strict";module.exports=i,module.exports.default=i;var t=require("quickselect");function i(t,n){if(!(this instanceof i))return new i(t,n);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),n&&this._initFormat(n),this.clear()}function n(t,i,n){if(!n)return i.indexOf(t);for(var a=0;a<i.length;a++)if(n(t,i[a]))return a;return-1}function a(t,i){h(t,0,t.children.length,i,t)}function h(t,i,n,a,h){h||(h=x(null)),h.minX=1/0,h.minY=1/0,h.maxX=-1/0,h.maxY=-1/0;for(var r,o=i;o<n;o++)r=t.children[o],e(h,t.leaf?a(r):r);return h}function e(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function r(t,i){return t.minX-i.minX}function o(t,i){return t.minY-i.minY}function s(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function l(t){return t.maxX-t.minX+(t.maxY-t.minY)}function u(t,i){return(Math.max(i.maxX,t.maxX)-Math.min(i.minX,t.minX))*(Math.max(i.maxY,t.maxY)-Math.min(i.minY,t.minY))}function m(t,i){var n=Math.max(t.minX,i.minX),a=Math.max(t.minY,i.minY),h=Math.min(t.maxX,i.maxX),e=Math.min(t.maxY,i.maxY);return Math.max(0,h-n)*Math.max(0,e-a)}function c(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function f(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function x(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(i,n,a,h,e){for(var r,o=[n,a];o.length;)(a=o.pop())-(n=o.pop())<=h||(r=n+Math.ceil((a-n)/h/2)*h,t(i,r,n,a,e),o.push(n,r,r,a))}i.prototype={all:function(){return this._all(this.data,[])},search:function(t){var i=this.data,n=[],a=this.toBBox;if(!f(t,i))return n;for(var h,e,r,o,s=[];i;){for(h=0,e=i.children.length;h<e;h++)r=i.children[h],f(t,o=i.leaf?a(r):r)&&(i.leaf?n.push(r):c(t,o)?this._all(r,n):s.push(r));i=s.pop()}return n},collides:function(t){var i=this.data,n=this.toBBox;if(!f(t,i))return!1;for(var a,h,e,r,o=[];i;){for(a=0,h=i.children.length;a<h;a++)if(e=i.children[a],f(t,r=i.leaf?n(e):e)){if(i.leaf||c(t,r))return!0;o.push(e)}i=o.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0,n=t.length;i<n;i++)this.insert(t[i]);return this}var a=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===a.height)this._splitRoot(this.data,a);else{if(this.data.height<a.height){var h=this.data;this.data=a,a=h}this._insert(a,this.data.height-a.height-1,!0)}else this.data=a;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=x([]),this},remove:function(t,i){if(!t)return this;for(var a,h,e,r,o=this.data,s=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),h=l[l.length-1],a=u.pop(),r=!0),o.leaf&&-1!==(e=n(t,o.children,i)))return o.children.splice(e,1),l.push(o),this._condense(l),this;r||o.leaf||!c(o,s)?h?(a++,o=h.children[a],r=!1):o=null:(l.push(o),u.push(a),a=0,h=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:r,compareMinY:o,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,i){for(var n=[];t;)t.leaf?i.push.apply(i,t.children):n.push.apply(n,t.children),t=n.pop();return i},_build:function(t,i,n,h){var e,r=n-i+1,o=this._maxEntries;if(r<=o)return a(e=x(t.slice(i,n+1)),this.toBBox),e;h||(h=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,h-1))),(e=x([])).leaf=!1,e.height=h;var s,l,u,m,c=Math.ceil(r/o),f=c*Math.ceil(Math.sqrt(o));for(d(t,i,n,f,this.compareMinX),s=i;s<=n;s+=f)for(d(t,s,u=Math.min(s+f-1,n),c,this.compareMinY),l=s;l<=u;l+=c)m=Math.min(l+c-1,u),e.children.push(this._build(t,l,m,h-1));return a(e,this.toBBox),e},_chooseSubtree:function(t,i,n,a){for(var h,e,r,o,l,m,c,f;a.push(i),!i.leaf&&a.length-1!==n;){for(c=f=1/0,h=0,e=i.children.length;h<e;h++)l=s(r=i.children[h]),(m=u(t,r)-l)<f?(f=m,c=l<c?l:c,o=r):m===f&&l<c&&(c=l,o=r);i=o||i.children[0]}return i},_insert:function(t,i,n){var a=this.toBBox,h=n?t:a(t),r=[],o=this._chooseSubtree(h,this.data,i,r);for(o.children.push(t),e(o,h);i>=0&&r[i].children.length>this._maxEntries;)this._split(r,i),i--;this._adjustParentBBoxes(h,r,i)},_split:function(t,i){var n=t[i],h=n.children.length,e=this._minEntries;this._chooseSplitAxis(n,e,h);var r=this._chooseSplitIndex(n,e,h),o=x(n.children.splice(r,n.children.length-r));o.height=n.height,o.leaf=n.leaf,a(n,this.toBBox),a(o,this.toBBox),i?t[i-1].children.push(o):this._splitRoot(n,o)},_splitRoot:function(t,i){this.data=x([t,i]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(t,i,n){var a,e,r,o,l,u,c,f;for(u=c=1/0,a=i;a<=n-i;a++)o=m(e=h(t,0,a,this.toBBox),r=h(t,a,n,this.toBBox)),l=s(e)+s(r),o<u?(u=o,f=a,c=l<c?l:c):o===u&&l<c&&(c=l,f=a);return f},_chooseSplitAxis:function(t,i,n){var a=t.leaf?this.compareMinX:r,h=t.leaf?this.compareMinY:o;this._allDistMargin(t,i,n,a)<this._allDistMargin(t,i,n,h)&&t.children.sort(a)},_allDistMargin:function(t,i,n,a){t.children.sort(a);var r,o,s=this.toBBox,u=h(t,0,i,s),m=h(t,n-i,n,s),c=l(u)+l(m);for(r=i;r<n-i;r++)o=t.children[r],e(u,t.leaf?s(o):o),c+=l(u);for(r=n-i-1;r>=i;r--)o=t.children[r],e(m,t.leaf?s(o):o),c+=l(m);return c},_adjustParentBBoxes:function(t,i,n){for(var a=n;a>=0;a--)e(i[a],t)},_condense:function(t){for(var i,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(i=t[n-1].children).splice(i.indexOf(t[n]),1):this.clear():a(t[n],this.toBBox)},_initFormat:function(t){var i=["return a"," - b",";"];this.compareMinX=new Function("a","b",i.join(t[0])),this.compareMinY=new Function("a","b",i.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};
},{"quickselect":256}],251:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("rbush"),n=o(e),r=require("../extent.js"),i=require("../obj.js");function o(t){return t&&t.__esModule?t:{default:t}}const s=function(t){this.rbush_=(0,n.default)(t,void 0),this.items_={}};s.prototype.insert=function(e,n){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:n};this.rbush_.insert(r),this.items_[(0,t.getUid)(n)]=r},s.prototype.load=function(e,n){const r=new Array(n.length);for(let i=0,o=n.length;i<o;i++){const o=e[i],s=n[i],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};r[i]=u,this.items_[(0,t.getUid)(s)]=u}this.rbush_.load(r)},s.prototype.remove=function(e){const n=(0,t.getUid)(e),r=this.items_[n];return delete this.items_[n],null!==this.rbush_.remove(r)},s.prototype.update=function(e,n){const i=this.items_[(0,t.getUid)(n)],o=[i.minX,i.minY,i.maxX,i.maxY];(0,r.equals)(o,e)||(this.remove(n),this.insert(e,n))},s.prototype.getAll=function(){return this.rbush_.all().map(function(t){return t.value})},s.prototype.getInExtent=function(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(t){return t.value})},s.prototype.forEach=function(t,e){return this.forEach_(this.getAll(),t,e)},s.prototype.forEachInExtent=function(t,e,n){return this.forEach_(this.getInExtent(t),e,n)},s.prototype.forEach_=function(t,e,n){let r;for(let i=0,o=t.length;i<o;i++)if(r=e.call(n,t[i]))return r;return r},s.prototype.isEmpty=function(){return(0,i.isEmpty)(this.items_)},s.prototype.clear=function(){this.rbush_.clear(),this.items_={}},s.prototype.getExtent=function(t){const e=this.rbush_.data;return(0,r.createOrUpdate)(e.minX,e.minY,e.maxX,e.maxY,t)},s.prototype.concat=function(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[0|e]=t.items_[0|e]},exports.default=s;
},{"../util.js":43,"rbush":228,"../extent.js":90,"../obj.js":74}],243:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VectorSourceEvent=void 0;var e=require("../util.js"),t=require("../Collection.js"),r=A(t),n=require("../CollectionEventType.js"),s=A(n),i=require("../ObjectEventType.js"),o=A(i),u=require("../array.js"),a=require("../asserts.js"),h=require("../events.js"),l=require("../events/Event.js"),d=A(l),f=require("../events/EventType.js"),c=A(f),_=require("../extent.js"),p=require("../featureloader.js"),E=require("../functions.js"),y=require("../loadingstrategy.js"),g=require("../obj.js"),I=require("../source/Source.js"),x=A(I),F=require("../source/State.js"),v=A(F),m=require("../source/VectorEventType.js"),R=A(m),C=require("../structs/RBush.js"),G=A(C);function A(e){return e&&e.__esModule?e:{default:e}}const j=exports.VectorSourceEvent=function(e,t){d.default.call(this,e),this.feature=t};(0,e.inherits)(j,d.default);const q=function(e){const t=e||{};x.default.call(this,{attributions:t.attributions,projection:void 0,state:v.default.READY,wrapX:void 0===t.wrapX||t.wrapX}),this.loader_=E.UNDEFINED,this.format_=t.format,this.overlaps_=null==t.overlaps||t.overlaps,this.url_=t.url,void 0!==t.loader?this.loader_=t.loader:void 0!==this.url_&&((0,a.assert)(this.format_,7),this.loader_=(0,p.xhr)(this.url_,this.format_)),this.strategy_=void 0!==t.strategy?t.strategy:y.all;const n=void 0===t.useSpatialIndex||t.useSpatialIndex;let s,i;this.featuresRtree_=n?new G.default:null,this.loadedExtentsRtree_=new G.default,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,t.features instanceof r.default?i=(s=t.features).getArray():Array.isArray(t.features)&&(i=t.features),n||void 0!==s||(s=new r.default(i)),void 0!==i&&this.addFeaturesInternal(i),void 0!==s&&this.bindFeaturesCollection_(s)};(0,e.inherits)(q,x.default),q.prototype.addFeature=function(e){this.addFeatureInternal(e),this.changed()},q.prototype.addFeatureInternal=function(t){const r=(0,e.getUid)(t).toString();if(!this.addToIndex_(r,t))return;this.setupChangeEvents_(r,t);const n=t.getGeometry();if(n){const e=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(e,t)}else this.nullGeometryFeatures_[r]=t;this.dispatchEvent(new j(R.default.ADDFEATURE,t))},q.prototype.setupChangeEvents_=function(e,t){this.featureChangeKeys_[e]=[(0,h.listen)(t,c.default.CHANGE,this.handleFeatureChange_,this),(0,h.listen)(t,o.default.PROPERTYCHANGE,this.handleFeatureChange_,this)]},q.prototype.addToIndex_=function(e,t){let r=!0;const n=t.getId();return void 0!==n?n.toString()in this.idIndex_?r=!1:this.idIndex_[n.toString()]=t:((0,a.assert)(!(e in this.undefIdIndex_),30),this.undefIdIndex_[e]=t),r},q.prototype.addFeatures=function(e){this.addFeaturesInternal(e),this.changed()},q.prototype.addFeaturesInternal=function(t){const r=[],n=[],s=[];for(let r=0,s=t.length;r<s;r++){const s=t[r],i=(0,e.getUid)(s).toString();this.addToIndex_(i,s)&&n.push(s)}for(let t=0,i=n.length;t<i;t++){const i=n[t],o=(0,e.getUid)(i).toString();this.setupChangeEvents_(o,i);const u=i.getGeometry();if(u){const e=u.getExtent();r.push(e),s.push(i)}else this.nullGeometryFeatures_[o]=i}this.featuresRtree_&&this.featuresRtree_.load(r,s);for(let e=0,t=n.length;e<t;e++)this.dispatchEvent(new j(R.default.ADDFEATURE,n[e]))},q.prototype.bindFeaturesCollection_=function(e){let t=!1;(0,h.listen)(this,R.default.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),(0,h.listen)(this,R.default.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),(0,h.listen)(e,s.default.ADD,function(e){t||(t=!0,this.addFeature(e.element),t=!1)},this),(0,h.listen)(e,s.default.REMOVE,function(e){t||(t=!0,this.removeFeature(e.element),t=!1)},this),this.featuresCollection_=e},q.prototype.clear=function(e){if(e){for(const e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(h.unlistenByKey)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(this.removeFeatureInternal,this);for(const e in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[e])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};const t=new j(R.default.CLEAR);this.dispatchEvent(t),this.changed()},q.prototype.forEachFeature=function(e){return this.featuresRtree_?this.featuresRtree_.forEach(e):this.featuresCollection_?this.featuresCollection_.forEach(e):void 0},q.prototype.forEachFeatureAtCoordinateDirect=function(e,t){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(r){return r.getGeometry().intersectsCoordinate(e)?t(r):void 0})},q.prototype.forEachFeatureInExtent=function(e,t){return this.featuresRtree_?this.featuresRtree_.forEachInExtent(e,t):this.featuresCollection_?this.featuresCollection_.forEach(t):void 0},q.prototype.forEachFeatureIntersectingExtent=function(e,t){return this.forEachFeatureInExtent(e,function(r){if(r.getGeometry().intersectsExtent(e)){const e=t(r);if(e)return e}})},q.prototype.getFeaturesCollection=function(){return this.featuresCollection_},q.prototype.getFeatures=function(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray():this.featuresRtree_&&(e=this.featuresRtree_.getAll(),(0,g.isEmpty)(this.nullGeometryFeatures_)||(0,u.extend)(e,(0,g.getValues)(this.nullGeometryFeatures_))),e},q.prototype.getFeaturesAtCoordinate=function(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(e){t.push(e)}),t},q.prototype.getFeaturesInExtent=function(e){return this.featuresRtree_.getInExtent(e)},q.prototype.getClosestFeatureToCoordinate=function(e,t){const r=e[0],n=e[1];let s=null;const i=[NaN,NaN];let o=1/0;const u=[-1/0,-1/0,1/0,1/0],a=t||E.TRUE;return this.featuresRtree_.forEachInExtent(u,function(e){if(a(e)){const t=e.getGeometry(),a=o;if((o=t.closestPointXY(r,n,i,o))<a){s=e;const t=Math.sqrt(o);u[0]=r-t,u[1]=n-t,u[2]=r+t,u[3]=n+t}}}),s},q.prototype.getExtent=function(e){return this.featuresRtree_.getExtent(e)},q.prototype.getFeatureById=function(e){const t=this.idIndex_[e.toString()];return void 0!==t?t:null},q.prototype.getFormat=function(){return this.format_},q.prototype.getOverlaps=function(){return this.overlaps_},q.prototype.getResolutions=function(){},q.prototype.getUrl=function(){return this.url_},q.prototype.handleFeatureChange_=function(t){const r=t.target,n=(0,e.getUid)(r).toString(),s=r.getGeometry();if(s){const e=s.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(e,r)):this.featuresRtree_&&this.featuresRtree_.update(e,r)}else n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(r),this.nullGeometryFeatures_[n]=r);const i=r.getId();if(void 0!==i){const e=i.toString();n in this.undefIdIndex_?(delete this.undefIdIndex_[n],this.idIndex_[e]=r):this.idIndex_[e]!==r&&(this.removeFromIdIndex_(r),this.idIndex_[e]=r)}else n in this.undefIdIndex_||(this.removeFromIdIndex_(r),this.undefIdIndex_[n]=r);this.changed(),this.dispatchEvent(new j(R.default.CHANGEFEATURE,r))},q.prototype.hasFeature=function(t){const r=t.getId();if(void 0!==r)return r in this.idIndex_;return(0,e.getUid)(t).toString()in this.undefIdIndex_},q.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&(0,g.isEmpty)(this.nullGeometryFeatures_)},q.prototype.loadFeatures=function(e,t,r){const n=this.loadedExtentsRtree_,s=this.strategy_(e,t);for(let e=0,i=s.length;e<i;++e){const i=s[e];n.forEachInExtent(i,function(e){return(0,_.containsExtent)(e.extent,i)})||(this.loader_.call(this,i,t,r),n.insert(i,{extent:i.slice()}))}},q.prototype.removeLoadedExtent=function(e){const t=this.loadedExtentsRtree_;let r;t.forEachInExtent(e,function(t){if((0,_.equals)(t.extent,e))return r=t,!0}),r&&t.remove(r)},q.prototype.removeFeature=function(t){const r=(0,e.getUid)(t).toString();r in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[r]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},q.prototype.removeFeatureInternal=function(t){const r=(0,e.getUid)(t).toString();this.featureChangeKeys_[r].forEach(h.unlistenByKey),delete this.featureChangeKeys_[r];const n=t.getId();void 0!==n?delete this.idIndex_[n.toString()]:delete this.undefIdIndex_[r],this.dispatchEvent(new j(R.default.REMOVEFEATURE,t))},q.prototype.removeFromIdIndex_=function(e){let t=!1;for(const r in this.idIndex_)if(this.idIndex_[r]===e){delete this.idIndex_[r],t=!0;break}return t},q.prototype.setLoader=function(e){this.loader_=e},exports.default=q;
},{"../util.js":43,"../Collection.js":16,"../CollectionEventType.js":100,"../ObjectEventType.js":96,"../array.js":130,"../asserts.js":83,"../events.js":84,"../events/Event.js":123,"../events/EventType.js":110,"../extent.js":90,"../featureloader.js":108,"../functions.js":103,"../loadingstrategy.js":282,"../obj.js":74,"../source/Source.js":281,"../source/State.js":151,"../source/VectorEventType.js":244,"../structs/RBush.js":251}],170:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleEvent=z,exports.createRegularPolygon=Z,exports.createBox=$;var t=require("../util.js"),e=require("../events/EventType.js"),i=b(e),s=require("../Feature.js"),o=b(s),n=require("../MapBrowserEventType.js"),h=b(n),r=require("../MapBrowserPointerEvent.js"),a=b(r),d=require("../Object.js"),u=require("../coordinate.js"),_=require("../events.js"),l=require("../events/Event.js"),c=b(l),f=require("../events/condition.js"),p=require("../extent.js"),g=require("../functions.js"),m=require("../geom/Circle.js"),y=b(m),C=require("../geom/GeometryType.js"),k=b(C),T=require("../geom/LineString.js"),P=b(T),N=require("../geom/MultiLineString.js"),L=b(N),w=require("../geom/MultiPoint.js"),O=b(w),E=require("../geom/MultiPolygon.js"),I=b(E),D=require("../pointer/MouseSource.js"),G=require("../geom/Point.js"),F=b(G),R=require("../geom/Polygon.js"),v=b(R),S=require("../interaction/Pointer.js"),q=b(S),x=require("../interaction/Property.js"),M=b(x),j=require("../layer/Vector.js"),Y=b(j),A=require("../source/Vector.js"),U=b(A),V=require("../style/Style.js");function b(t){return t&&t.__esModule?t:{default:t}}const H={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",CIRCLE:"Circle"},B={DRAWSTART:"drawstart",DRAWEND:"drawend"},W=function(t,e){c.default.call(this,t),this.feature=e};(0,t.inherits)(W,c.default);const X=function(t){q.default.call(this,{handleDownEvent:J,handleEvent:z,handleUpEvent:Q}),this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.freehand_=!1,this.source_=t.source?t.source:null,this.features_=t.features?t.features:null,this.snapTolerance_=t.snapTolerance?t.snapTolerance:12,this.type_=t.type,this.mode_=tt(this.type_),this.stopClick_=!!t.stopClick,this.minPoints_=t.minPoints?t.minPoints:this.mode_===H.POLYGON?3:2,this.maxPoints_=t.maxPoints?t.maxPoints:1/0,this.finishCondition_=t.finishCondition?t.finishCondition:g.TRUE;let e=t.geometryFunction;if(!e)if(this.type_===k.default.CIRCLE)e=function(t,e){const i=e||new y.default([NaN,NaN]),s=(0,u.squaredDistance)(t[0],t[1]);return i.setCenterAndRadius(t[0],Math.sqrt(s)),i};else{let t;const i=this.mode_;i===H.POINT?t=F.default:i===H.LINE_STRING?t=P.default:i===H.POLYGON&&(t=v.default),e=function(e,s){let o=s;return o?i===H.POLYGON?e[0].length?o.setCoordinates([e[0].concat([e[0][0]])]):o.setCoordinates([]):o.setCoordinates(e):o=new t(e),o}}this.geometryFunction_=e,this.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.overlay_=new Y.default({source:new U.default({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:K(),updateWhileInteracting:!0}),this.geometryName_=t.geometryName,this.condition_=t.condition?t.condition:f.noModifierKeys,this.freehandCondition_,t.freehand?this.freehandCondition_=f.always:this.freehandCondition_=t.freehandCondition?t.freehandCondition:f.shiftKeyOnly,(0,_.listen)(this,(0,d.getChangeEventType)(M.default.ACTIVE),this.updateState_,this)};function K(){const t=(0,V.createEditingStyle)();return function(e,i){return t[e.getGeometry().getType()]}}function z(t){t.originalEvent.type===i.default.CONTEXTMENU&&t.preventDefault(),this.freehand_=this.mode_!==H.POINT&&this.freehandCondition_(t);let e=t.type===h.default.POINTERMOVE,s=!0;if(this.lastDragTime_&&t.type===h.default.POINTERDRAG){Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)}return this.freehand_&&t.type===h.default.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t),s=!1):this.freehand_&&t.type===h.default.POINTERDOWN?s=!1:e?(s=t.type===h.default.POINTERMOVE)&&this.freehand_?s=this.handlePointerMove_(t):(t.pointerEvent.pointerType==D.POINTER_TYPE||t.type===h.default.POINTERDRAG&&!this.downTimeout_)&&this.handlePointerMove_(t):t.type===h.default.DBLCLICK&&(s=!1),S.handleEvent.call(this,t)&&s}function J(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t),!0):!!this.condition_(t)&&(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new a.default(h.default.POINTERMOVE,t.map,t.pointerEvent,t.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=t.pixel,!0)}function Q(t){let e=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);const i=this.mode_===H.CIRCLE;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||i?this.finishDrawing():this.atFinish_(t)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t):(this.startDrawing_(t),this.mode_===H.POINT&&this.finishDrawing()),e=!1):this.freehand_&&(this.finishCoordinate_=null,this.abortDrawing_()),!e&&this.stopClick_&&t.stopPropagation(),e}function Z(t,e){return function(i,s){const o=i[0],n=i[1],h=Math.sqrt((0,u.squaredDistance)(o,n)),r=s||(0,R.fromCircle)(new y.default(o),t),a=e||Math.atan((n[1]-o[1])/(n[0]-o[0]));return(0,R.makeRegular)(r,o,h,a),r}}function $(){return function(t,e){const i=(0,p.boundingExtent)(t),s=e||new v.default(null);return s.setCoordinates([[(0,p.getBottomLeft)(i),(0,p.getBottomRight)(i),(0,p.getTopRight)(i),(0,p.getTopLeft)(i),(0,p.getBottomLeft)(i)]]),s}}function tt(t){let e;return t===k.default.POINT||t===k.default.MULTI_POINT?e=H.POINT:t===k.default.LINE_STRING||t===k.default.MULTI_LINE_STRING?e=H.LINE_STRING:t===k.default.POLYGON||t===k.default.MULTI_POLYGON?e=H.POLYGON:t===k.default.CIRCLE&&(e=H.CIRCLE),e}(0,t.inherits)(X,q.default),X.prototype.setMap=function(t){q.default.prototype.setMap.call(this,t),this.updateState_()},X.prototype.handlePointerMove_=function(t){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const e=this.downPx_,i=t.pixel,s=e[0]-i[0],o=e[1]-i[1],n=s*s+o*o;if(this.shouldHandle_=this.freehand_?n>this.squaredClickTolerance_:n<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(t):this.createOrUpdateSketchPoint_(t),!0},X.prototype.atFinish_=function(t){let e=!1;if(this.sketchFeature_){let i=!1,s=[this.finishCoordinate_];if(this.mode_===H.LINE_STRING?i=this.sketchCoords_.length>this.minPoints_:this.mode_===H.POLYGON&&(i=this.sketchCoords_[0].length>this.minPoints_,s=[this.sketchCoords_[0][0],this.sketchCoords_[0][this.sketchCoords_[0].length-2]]),i){const i=t.map;for(let o=0,n=s.length;o<n;o++){const n=s[o],h=i.getPixelFromCoordinate(n),r=t.pixel,a=r[0]-h[0],d=r[1]-h[1],u=this.freehand_?1:this.snapTolerance_;if(e=Math.sqrt(a*a+d*d)<=u){this.finishCoordinate_=n;break}}}}return e},X.prototype.createOrUpdateSketchPoint_=function(t){const e=t.coordinate.slice();if(this.sketchPoint_){this.sketchPoint_.getGeometry().setCoordinates(e)}else this.sketchPoint_=new o.default(new F.default(e)),this.updateSketchFeatures_()},X.prototype.startDrawing_=function(t){const e=t.coordinate;this.finishCoordinate_=e,this.mode_===H.POINT?this.sketchCoords_=e.slice():this.mode_===H.POLYGON?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new o.default(new P.default(this.sketchLineCoords_)));const i=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new o.default,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new W(B.DRAWSTART,this.sketchFeature_))},X.prototype.modifyDrawing_=function(t){let e=t.coordinate;const i=this.sketchFeature_.getGeometry();let s,n,h;if(this.mode_===H.POINT?n=this.sketchCoords_:this.mode_===H.POLYGON?(n=(s=this.sketchCoords_[0])[s.length-1],this.atFinish_(t)&&(e=this.finishCoordinate_.slice())):n=(s=this.sketchCoords_)[s.length-1],n[0]=e[0],n[1]=e[1],this.geometryFunction_(this.sketchCoords_,i),this.sketchPoint_){this.sketchPoint_.getGeometry().setCoordinates(e)}if(i instanceof v.default&&this.mode_!==H.POLYGON){this.sketchLine_||(this.sketchLine_=new o.default(new P.default(null)));const t=i.getLinearRing(0);(h=this.sketchLine_.getGeometry()).setFlatCoordinates(t.getLayout(),t.getFlatCoordinates())}else this.sketchLineCoords_&&(h=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},X.prototype.addToDrawing_=function(t){const e=t.coordinate,i=this.sketchFeature_.getGeometry();let s,o;this.mode_===H.LINE_STRING?(this.finishCoordinate_=e.slice(),(o=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?o.pop():s=!0),o.push(e.slice()),this.geometryFunction_(o,i)):this.mode_===H.POLYGON&&((o=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?o.pop():s=!0),o.push(e.slice()),s&&(this.finishCoordinate_=o[0]),this.geometryFunction_(this.sketchCoords_,i)),this.updateSketchFeatures_(),s&&this.finishDrawing()},X.prototype.removeLastPoint=function(){if(!this.sketchFeature_)return;const t=this.sketchFeature_.getGeometry();let e,i;this.mode_===H.LINE_STRING?((e=this.sketchCoords_).splice(-2,1),this.geometryFunction_(e,t),e.length>=2&&(this.finishCoordinate_=e[e.length-2].slice())):this.mode_===H.POLYGON&&((e=this.sketchCoords_[0]).splice(-2,1),(i=this.sketchLine_.getGeometry()).setCoordinates(e),this.geometryFunction_(this.sketchCoords_,t)),0===e.length&&(this.finishCoordinate_=null),this.updateSketchFeatures_()},X.prototype.finishDrawing=function(){const t=this.abortDrawing_();if(!t)return;let e=this.sketchCoords_;const i=t.getGeometry();this.mode_===H.LINE_STRING?(e.pop(),this.geometryFunction_(e,i)):this.mode_===H.POLYGON&&(e[0].pop(),this.geometryFunction_(e,i),e=i.getCoordinates()),this.type_===k.default.MULTI_POINT?t.setGeometry(new O.default([e])):this.type_===k.default.MULTI_LINE_STRING?t.setGeometry(new L.default([e])):this.type_===k.default.MULTI_POLYGON&&t.setGeometry(new I.default([e])),this.dispatchEvent(new W(B.DRAWEND,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)},X.prototype.abortDrawing_=function(){this.finishCoordinate_=null;const t=this.sketchFeature_;return t&&(this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0)),t},X.prototype.extend=function(t){const e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();const i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new W(B.DRAWSTART,this.sketchFeature_))},X.prototype.shouldStopEvent=g.FALSE,X.prototype.updateSketchFeatures_=function(){const t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);const e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)},X.prototype.updateState_=function(){const t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing_(),this.overlay_.setMap(e?t:null)},exports.default=X;
},{"../util.js":43,"../events/EventType.js":110,"../Feature.js":18,"../MapBrowserEventType.js":95,"../MapBrowserPointerEvent.js":29,"../Object.js":31,"../coordinate.js":89,"../events.js":84,"../events/Event.js":123,"../events/condition.js":238,"../extent.js":90,"../functions.js":103,"../geom/Circle.js":247,"../geom/GeometryType.js":140,"../geom/LineString.js":115,"../geom/MultiLineString.js":248,"../geom/MultiPoint.js":249,"../geom/MultiPolygon.js":250,"../pointer/MouseSource.js":210,"../geom/Point.js":116,"../geom/Polygon.js":113,"../interaction/Pointer.js":174,"../interaction/Property.js":246,"../layer/Vector.js":245,"../source/Vector.js":243,"../style/Style.js":112}],171:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util.js"),t=require("../Feature.js"),n=q(t),r=require("../MapBrowserEventType.js"),i=q(r),o=require("../MapBrowserPointerEvent.js"),u=q(o),l=require("../coordinate.js"),a=require("../events/Event.js"),s=q(a),c=require("../extent.js"),d=require("../geom/GeometryType.js"),p=q(d),h=require("../geom/Point.js"),x=q(h),f=require("../geom/Polygon.js"),_=require("../interaction/Pointer.js"),E=q(_),y=require("../layer/Vector.js"),g=q(y),v=require("../source/Vector.js"),m=q(v),T=require("../style/Style.js");function q(e){return e&&e.__esModule?e:{default:e}}const F={EXTENTCHANGED:"extentchanged"},P=function(e){s.default.call(this,F.EXTENTCHANGED),this.extent=e};(0,e.inherits)(P,s.default);const O=function(e){const t=e||{};this.extent_=null,this.pointerHandler_=null,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.snappedToVertex_=!1,this.extentFeature_=null,this.vertexFeature_=null,e||(e={}),E.default.call(this,{handleDownEvent:j,handleDragEvent:S,handleEvent:w,handleUpEvent:M}),this.extentOverlay_=new g.default({source:new m.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.boxStyle?e.boxStyle:H(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.vertexOverlay_=new g.default({source:new m.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle?e.pointerStyle:C(),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.extent&&this.setExtent(e.extent)};function w(e){return!(e instanceof u.default)||(e.type!=i.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),_.handleEvent.call(this,e),!1)}function j(e){const t=e.pixel,n=e.map,r=this.getExtent();let i=this.snapToVertex_(t,n);const o=function(e){let t=null,n=null;return e[0]==r[0]?t=r[2]:e[0]==r[2]&&(t=r[0]),e[1]==r[1]?n=r[3]:e[1]==r[3]&&(n=r[1]),null!==t&&null!==n?[t,n]:null};if(i&&r){const e=i[0]==r[0]||i[0]==r[2]?i[0]:null,t=i[1]==r[1]||i[1]==r[3]?i[1]:null;null!==e&&null!==t?this.pointerHandler_=D(o(i)):null!==e?this.pointerHandler_=V(o([e,r[1]]),o([e,r[3]])):null!==t&&(this.pointerHandler_=V(o([r[0],t]),o([r[2],t])))}else i=n.getCoordinateFromPixel(t),this.setExtent([i[0],i[1],i[0],i[1]]),this.pointerHandler_=D(i);return!0}function S(e){if(this.pointerHandler_){const t=e.coordinate;this.setExtent(this.pointerHandler_(t)),this.createOrUpdatePointerFeature_(t)}return!0}function M(e){this.pointerHandler_=null;const t=this.getExtent();return t&&0!==(0,c.getArea)(t)||this.setExtent(null),!1}function H(){const e=(0,T.createEditingStyle)();return function(t,n){return e[p.default.POLYGON]}}function C(){const e=(0,T.createEditingStyle)();return function(t,n){return e[p.default.POINT]}}function D(e){return function(t){return(0,c.boundingExtent)([e,t])}}function V(e,t){return e[0]==t[0]?function(n){return(0,c.boundingExtent)([e,[n[0],t[1]]])}:e[1]==t[1]?function(n){return(0,c.boundingExtent)([e,[t[0],n[1]]])}:null}function G(e){return[[[e[0],e[1]],[e[0],e[3]]],[[e[0],e[3]],[e[2],e[3]]],[[e[2],e[3]],[e[2],e[1]]],[[e[2],e[1]],[e[0],e[1]]]]}(0,e.inherits)(O,E.default),O.prototype.snapToVertex_=function(e,t){const n=t.getCoordinateFromPixel(e),r=function(e,t){return(0,l.squaredDistanceToSegment)(n,e)-(0,l.squaredDistanceToSegment)(n,t)},i=this.getExtent();if(i){const o=G(i);o.sort(r);const u=o[0];let a=(0,l.closestOnSegment)(n,u);const s=t.getPixelFromCoordinate(a);if((0,l.distance)(e,s)<=this.pixelTolerance_){const e=t.getPixelFromCoordinate(u[0]),n=t.getPixelFromCoordinate(u[1]),r=(0,l.squaredDistance)(s,e),i=(0,l.squaredDistance)(s,n),o=Math.sqrt(Math.min(r,i));return this.snappedToVertex_=o<=this.pixelTolerance_,this.snappedToVertex_&&(a=r>i?u[1]:u[0]),a}}return null},O.prototype.handlePointerMove_=function(e){const t=e.pixel,n=e.map;let r=this.snapToVertex_(t,n);r||(r=n.getCoordinateFromPixel(t)),this.createOrUpdatePointerFeature_(r)},O.prototype.createOrUpdateExtentFeature_=function(e){let t=this.extentFeature_;return t?e?t.setGeometry((0,f.fromExtent)(e)):t.setGeometry(void 0):(t=e?new n.default((0,f.fromExtent)(e)):new n.default({}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t},O.prototype.createOrUpdatePointerFeature_=function(e){let t=this.vertexFeature_;if(t){t.getGeometry().setCoordinates(e)}else t=new n.default(new x.default(e)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t);return t},O.prototype.setMap=function(e){this.extentOverlay_.setMap(e),this.vertexOverlay_.setMap(e),E.default.prototype.setMap.call(this,e)},O.prototype.getExtent=function(){return this.extent_},O.prototype.setExtent=function(e){this.extent_=e||null,this.createOrUpdateExtentFeature_(e),this.dispatchEvent(new P(this.extent_))},exports.default=O;
},{"../util.js":43,"../Feature.js":18,"../MapBrowserEventType.js":95,"../MapBrowserPointerEvent.js":29,"../coordinate.js":89,"../events/Event.js":123,"../extent.js":90,"../geom/GeometryType.js":140,"../geom/Point.js":116,"../geom/Polygon.js":113,"../interaction/Pointer.js":174,"../layer/Vector.js":245,"../source/Vector.js":243,"../style/Style.js":112}],173:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModifyEvent=void 0;var e=require("../util.js"),t=require("../Collection.js"),i=O(t),n=require("../CollectionEventType.js"),r=O(n),s=require("../Feature.js"),o=O(s),a=require("../MapBrowserEventType.js"),u=O(a),h=require("../MapBrowserPointerEvent.js"),l=O(h),d=require("../array.js"),g=require("../coordinate.js"),c=require("../events.js"),_=require("../events/Event.js"),f=O(_),p=require("../events/EventType.js"),m=O(p),y=require("../events/condition.js"),x=require("../extent.js"),v=require("../geom/GeometryType.js"),E=O(v),C=require("../geom/Point.js"),S=O(C),F=require("../interaction/Pointer.js"),T=O(F),I=require("../layer/Vector.js"),P=O(I),G=require("../source/Vector.js"),M=O(G),w=require("../source/VectorEventType.js"),N=O(w),L=require("../structs/RBush.js"),R=O(L),q=require("../style/Style.js");function O(e){return e&&e.__esModule?e:{default:e}}const j={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"},A=exports.ModifyEvent=function(e,t,i){f.default.call(this,e),this.features=t,this.mapBrowserEvent=i};(0,e.inherits)(A,f.default);const B=function(e){let t;if(T.default.call(this,{handleDownEvent:b,handleDragEvent:k,handleEvent:W,handleUpEvent:Y}),this.condition_=e.condition?e.condition:y.primaryAction,this.defaultDeleteCondition_=function(e){return(0,y.altKeyOnly)(e)&&(0,y.singleClick)(e)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:y.always,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new R.default,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new P.default({source:new M.default({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:X(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null,e.source?(this.source_=e.source,t=new i.default(this.source_.getFeatures()),(0,c.listen)(this.source_,N.default.ADDFEATURE,this.handleSourceAdd_,this),(0,c.listen)(this.source_,N.default.REMOVEFEATURE,this.handleSourceRemove_,this)):t=e.features,!t)throw new Error("The modify interaction requires features or a source");this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),(0,c.listen)(this.features_,r.default.ADD,this.handleFeatureAdd_,this),(0,c.listen)(this.features_,r.default.REMOVE,this.handleFeatureRemove_,this),this.lastPointerEvent_=null};(0,e.inherits)(B,T.default);const D=0,U=1;function V(e,t){return e.index-t.index}function b(t){if(!this.condition_(t))return!1;this.handlePointerAtPixel_(t.pixel,t.map);const i=t.map.getCoordinateFromPixel(t.pixel);this.dragSegments_.length=0,this.modified_=!1;const n=this.vertexFeature_;if(n){const r=[],s=n.getGeometry().getCoordinates(),o=(0,x.boundingExtent)([s]),a=this.rBush_.getInExtent(o),u={};a.sort(V);for(let n=0,o=a.length;n<o;++n){const o=a[n],h=o.segment;let l=(0,e.getUid)(o.feature);const d=o.depth;if(d&&(l+="-"+d.join("-")),u[l]||(u[l]=new Array(2)),o.geometry.getType()===E.default.CIRCLE&&o.index===U){const e=H(i,o);(0,g.equals)(e,s)&&!u[l][0]&&(this.dragSegments_.push([o,0]),u[l][0]=o)}else if((0,g.equals)(h[0],s)&&!u[l][0])this.dragSegments_.push([o,0]),u[l][0]=o;else if((0,g.equals)(h[1],s)&&!u[l][1]){if((o.geometry.getType()===E.default.LINE_STRING||o.geometry.getType()===E.default.MULTI_LINE_STRING)&&u[l][0]&&0===u[l][0].index)continue;this.dragSegments_.push([o,1]),u[l][1]=o}else this.insertVertexCondition_(t)&&(0,e.getUid)(h)in this.vertexSegments_&&!u[l][0]&&!u[l][1]&&r.push([o,s])}r.length&&this.willModifyFeatures_(t);for(let e=r.length-1;e>=0;--e)this.insertVertex_.apply(this,r[e])}return!!this.vertexFeature_}function k(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e);const t=e.coordinate;for(let e=0,i=this.dragSegments_.length;e<i;++e){const i=this.dragSegments_[e],n=i[0],r=n.depth,s=n.geometry;let o;const a=n.segment,u=i[1];for(;t.length<s.getStride();)t.push(a[u][t.length]);switch(s.getType()){case E.default.POINT:o=t,a[0]=a[1]=t;break;case E.default.MULTI_POINT:(o=s.getCoordinates())[n.index]=t,a[0]=a[1]=t;break;case E.default.LINE_STRING:(o=s.getCoordinates())[n.index+u]=t,a[u]=t;break;case E.default.MULTI_LINE_STRING:case E.default.POLYGON:(o=s.getCoordinates())[r[0]][n.index+u]=t,a[u]=t;break;case E.default.MULTI_POLYGON:(o=s.getCoordinates())[r[1]][r[0]][n.index+u]=t,a[u]=t;break;case E.default.CIRCLE:a[0]=a[1]=t,n.index===D?(this.changingFeature_=!0,s.setCenter(t),this.changingFeature_=!1):(this.changingFeature_=!0,s.setRadius((0,g.distance)(s.getCenter(),t)),this.changingFeature_=!1)}o&&this.setGeometryCoordinates_(s,o)}this.createOrUpdateVertexFeature_(t)}function Y(e){for(let e=this.dragSegments_.length-1;e>=0;--e){const t=this.dragSegments_[e][0],i=t.geometry;if(i.getType()===E.default.CIRCLE){const e=i.getCenter(),n=t.featureSegments[0],r=t.featureSegments[1];n.segment[0]=n.segment[1]=e,r.segment[0]=r.segment[1]=e,this.rBush_.update((0,x.createOrUpdateFromCoordinate)(e),n),this.rBush_.update(i.getExtent(),r)}else this.rBush_.update((0,x.boundingExtent)(t.segment),t)}return this.modified_&&(this.dispatchEvent(new A(j.MODIFYEND,this.features_,e)),this.modified_=!1),!1}function W(e){if(!(e instanceof l.default))return!0;let t;return this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=u.default.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(t=!(e.type!=u.default.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==u.default.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),F.handleEvent.call(this,e)&&!t}function K(e,t){const i=t.geometry;if(i.getType()===E.default.CIRCLE){const n=i;if(t.index===U){const t=(0,g.squaredDistance)(n.getCenter(),e),i=Math.sqrt(t)-n.getRadius();return i*i}}return(0,g.squaredDistanceToSegment)(e,t.segment)}function H(e,t){const i=t.geometry;return i.getType()===E.default.CIRCLE&&t.index===U?i.getClosestPoint(e):(0,g.closestOnSegment)(e,t.segment)}function X(){const e=(0,q.createEditingStyle)();return function(t,i){return e[E.default.POINT]}}B.prototype.addFeature_=function(e){const t=e.getGeometry();t&&t.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[t.getType()].call(this,e,t);const i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),(0,c.listen)(e,m.default.CHANGE,this.handleFeatureChange_,this)},B.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new A(j.MODIFYSTART,this.features_,e)))},B.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),(0,c.unlisten)(e,m.default.CHANGE,this.handleFeatureChange_,this)},B.prototype.removeFeatureSegmentData_=function(e){const t=this.rBush_,i=[];t.forEach(function(t){e===t.feature&&i.push(t)});for(let e=i.length-1;e>=0;--e)t.remove(i[e])},B.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),T.default.prototype.setActive.call(this,e)},B.prototype.setMap=function(e){this.overlay_.setMap(e),T.default.prototype.setMap.call(this,e)},B.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},B.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},B.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},B.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}},B.prototype.handleFeatureRemove_=function(e){const t=e.element;this.removeFeature_(t)},B.prototype.writePointGeometry_=function(e,t){const i=t.getCoordinates(),n={feature:e,geometry:t,segment:[i,i]};this.rBush_.insert(t.getExtent(),n)},B.prototype.writeMultiPointGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n){const r=i[n],s={feature:e,geometry:t,depth:[n],index:n,segment:[r,r]};this.rBush_.insert(t.getExtent(),s)}},B.prototype.writeLineStringGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length-1;n<r;++n){const r=i.slice(n,n+2),s={feature:e,geometry:t,index:n,segment:r};this.rBush_.insert((0,x.boundingExtent)(r),s)}},B.prototype.writeMultiLineStringGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n){const r=i[n];for(let i=0,s=r.length-1;i<s;++i){const s=r.slice(i,i+2),o={feature:e,geometry:t,depth:[n],index:i,segment:s};this.rBush_.insert((0,x.boundingExtent)(s),o)}}},B.prototype.writePolygonGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n){const r=i[n];for(let i=0,s=r.length-1;i<s;++i){const s=r.slice(i,i+2),o={feature:e,geometry:t,depth:[n],index:i,segment:s};this.rBush_.insert((0,x.boundingExtent)(s),o)}}},B.prototype.writeMultiPolygonGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n){const r=i[n];for(let i=0,s=r.length;i<s;++i){const s=r[i];for(let r=0,o=s.length-1;r<o;++r){const o=s.slice(r,r+2),a={feature:e,geometry:t,depth:[i,n],index:r,segment:o};this.rBush_.insert((0,x.boundingExtent)(o),a)}}}},B.prototype.writeCircleGeometry_=function(e,t){const i=t.getCenter(),n={feature:e,geometry:t,index:D,segment:[i,i]},r={feature:e,geometry:t,index:U,segment:[i,i]},s=[n,r];n.featureSegments=r.featureSegments=s,this.rBush_.insert((0,x.createOrUpdateFromCoordinate)(i),n),this.rBush_.insert(t.getExtent(),r)},B.prototype.writeGeometryCollectionGeometry_=function(e,t){const i=t.getGeometriesArray();for(let t=0;t<i.length;++t)this.SEGMENT_WRITERS_[i[t].getType()].call(this,e,i[t])},B.prototype.createOrUpdateVertexFeature_=function(e){let t=this.vertexFeature_;if(t){t.getGeometry().setCoordinates(e)}else t=new o.default(new S.default(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t);return t},B.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map)},B.prototype.handlePointerAtPixel_=function(t,i){const n=i.getCoordinateFromPixel(t),r=function(e,t){return K(n,e)-K(n,t)},s=(0,x.buffer)((0,x.createOrUpdateFromCoordinate)(n),i.getView().getResolution()*this.pixelTolerance_),o=this.rBush_.getInExtent(s);if(o.length>0){o.sort(r);const s=o[0],a=s.segment;let u=H(n,s);const h=i.getPixelFromCoordinate(u);let l=(0,g.distance)(t,h);if(l<=this.pixelTolerance_){const t={};if(s.geometry.getType()===E.default.CIRCLE&&s.index===U)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(u);else{const n=i.getPixelFromCoordinate(a[0]),r=i.getPixelFromCoordinate(a[1]),s=(0,g.squaredDistance)(h,n),d=(0,g.squaredDistance)(h,r);l=Math.sqrt(Math.min(s,d)),this.snappedToVertex_=l<=this.pixelTolerance_,this.snappedToVertex_&&(u=s>d?a[1]:a[0]),this.createOrUpdateVertexFeature_(u);for(let i=1,n=o.length;i<n;++i){const n=o[i].segment;if(!((0,g.equals)(a[0],n[0])&&(0,g.equals)(a[1],n[1])||(0,g.equals)(a[0],n[1])&&(0,g.equals)(a[1],n[0])))break;t[(0,e.getUid)(n)]=!0}}return t[(0,e.getUid)(a)]=!0,void(this.vertexSegments_=t)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},B.prototype.insertVertex_=function(e,t){const i=e.segment,n=e.feature,r=e.geometry,s=e.depth,o=e.index;let a;for(;t.length<r.getStride();)t.push(0);switch(r.getType()){case E.default.MULTI_LINE_STRING:case E.default.POLYGON:(a=r.getCoordinates())[s[0]].splice(o+1,0,t);break;case E.default.MULTI_POLYGON:(a=r.getCoordinates())[s[1]][s[0]].splice(o+1,0,t);break;case E.default.LINE_STRING:(a=r.getCoordinates()).splice(o+1,0,t);break;default:return}this.setGeometryCoordinates_(r,a);const u=this.rBush_;u.remove(e),this.updateSegmentIndices_(r,o,s,1);const h={segment:[i[0],t],feature:n,geometry:r,depth:s,index:o};u.insert((0,x.boundingExtent)(h.segment),h),this.dragSegments_.push([h,1]);const l={segment:[t,i[1]],feature:n,geometry:r,depth:s,index:o+1};u.insert((0,x.boundingExtent)(l.segment),l),this.dragSegments_.push([l,0]),this.ignoreNextSingleClick_=!0},B.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=u.default.POINTERDRAG){const e=this.lastPointerEvent_;return this.willModifyFeatures_(e),this.removeVertex_(),this.dispatchEvent(new A(j.MODIFYEND,this.features_,e)),this.modified_=!1,!0}return!1},B.prototype.removeVertex_=function(){const t=this.dragSegments_,i={};let n,r,s,o,a,u,h,l,d,g,c,_=!1;for(a=t.length-1;a>=0;--a)g=(s=t[a])[0],c=(0,e.getUid)(g.feature),g.depth&&(c+="-"+g.depth.join("-")),c in i||(i[c]={}),0===s[1]?(i[c].right=g,i[c].index=g.index):1==s[1]&&(i[c].left=g,i[c].index=g.index+1);for(c in i){switch(d=i[c].right,h=i[c].left,(l=(u=i[c].index)-1)<0&&(l=0),n=r=(o=(g=void 0!==h?h:d).geometry).getCoordinates(),_=!1,o.getType()){case E.default.MULTI_LINE_STRING:r[g.depth[0]].length>2&&(r[g.depth[0]].splice(u,1),_=!0);break;case E.default.LINE_STRING:r.length>2&&(r.splice(u,1),_=!0);break;case E.default.MULTI_POLYGON:n=n[g.depth[1]];case E.default.POLYGON:(n=n[g.depth[0]]).length>4&&(u==n.length-1&&(u=0),n.splice(u,1),_=!0,0===u&&(n.pop(),n.push(n[0]),l=n.length-1))}if(_){this.setGeometryCoordinates_(o,r);const e=[];if(void 0!==h&&(this.rBush_.remove(h),e.push(h.segment[0])),void 0!==d&&(this.rBush_.remove(d),e.push(d.segment[1])),void 0!==h&&void 0!==d){const t={depth:g.depth,feature:g.feature,geometry:g.geometry,index:l,segment:e};this.rBush_.insert((0,x.boundingExtent)(t.segment),t)}this.updateSegmentIndices_(o,u,g.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.length=0}}return _},B.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},B.prototype.updateSegmentIndices_=function(e,t,i,n){this.rBush_.forEachInExtent(e.getExtent(),function(r){r.geometry===e&&(void 0===i||void 0===r.depth||(0,d.equals)(r.depth,i))&&r.index>t&&(r.index+=n)})},exports.default=B;
},{"../util.js":43,"../Collection.js":16,"../CollectionEventType.js":100,"../Feature.js":18,"../MapBrowserEventType.js":95,"../MapBrowserPointerEvent.js":29,"../array.js":130,"../coordinate.js":89,"../events.js":84,"../events/Event.js":123,"../events/EventType.js":110,"../events/condition.js":238,"../extent.js":90,"../geom/GeometryType.js":140,"../geom/Point.js":116,"../interaction/Pointer.js":174,"../layer/Vector.js":245,"../source/Vector.js":243,"../source/VectorEventType.js":244,"../structs/RBush.js":251,"../style/Style.js":112}],175:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util.js"),t=require("../CollectionEventType.js"),i=m(t),r=require("../array.js"),n=require("../events.js"),o=require("../events/Event.js"),s=m(o),a=require("../events/condition.js"),l=require("../functions.js"),u=require("../geom/GeometryType.js"),c=m(u),h=require("../interaction/Interaction.js"),d=m(h),f=require("../layer/Vector.js"),y=m(f),p=require("../obj.js"),_=require("../source/Vector.js"),g=m(_),v=require("../style/Style.js");function m(e){return e&&e.__esModule?e:{default:e}}const F={SELECT:"select"},E=function(e,t,i,r){s.default.call(this,e),this.selected=t,this.deselected=i,this.mapBrowserEvent=r};(0,e.inherits)(E,s.default);const C=function(e){d.default.call(this,{handleEvent:T});const t=e||{};this.condition_=t.condition?t.condition:a.singleClick,this.addCondition_=t.addCondition?t.addCondition:a.never,this.removeCondition_=t.removeCondition?t.removeCondition:a.never,this.toggleCondition_=t.toggleCondition?t.toggleCondition:a.shiftKeyOnly,this.multi_=!!t.multi&&t.multi,this.filter_=t.filter?t.filter:l.TRUE,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0;const o=new y.default({source:new g.default({useSpatialIndex:!1,features:t.features,wrapX:t.wrapX}),style:t.style?t.style:L(),updateWhileAnimating:!0,updateWhileInteracting:!0});let s;if(this.featureOverlay_=o,t.layers)if("function"==typeof t.layers)s=t.layers;else{const e=t.layers;s=function(t){return(0,r.includes)(e,t)}}else s=l.TRUE;this.layerFilter_=s,this.featureLayerAssociation_={};const u=this.featureOverlay_.getSource().getFeaturesCollection();(0,n.listen)(u,i.default.ADD,this.addFeature_,this),(0,n.listen)(u,i.default.REMOVE,this.removeFeature_,this)};function T(e){if(!this.condition_(e))return!0;const t=this.addCondition_(e),i=this.removeCondition_(e),n=this.toggleCondition_(e),o=!t&&!i&&!n,s=e.map,l=this.featureOverlay_.getSource().getFeaturesCollection(),u=[],c=[];if(o){(0,p.clear)(this.featureLayerAssociation_),s.forEachFeatureAtPixel(e.pixel,function(e,t){if(this.filter_(e,t))return c.push(e),this.addFeatureLayerAssociation_(e,t),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=l.getLength()-1;e>=0;--e){const t=l.item(e),i=c.indexOf(t);i>-1?c.splice(i,1):(l.remove(t),u.push(t))}0!==c.length&&l.extend(c)}else{s.forEachFeatureAtPixel(e.pixel,function(e,o){if(this.filter_(e,o))return!t&&!n||(0,r.includes)(l.getArray(),e)?(i||n)&&(0,r.includes)(l.getArray(),e)&&(u.push(e),this.removeFeatureLayerAssociation_(e)):(c.push(e),this.addFeatureLayerAssociation_(e,o)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=u.length-1;e>=0;--e)l.remove(u[e]);l.extend(c)}return(c.length>0||u.length>0)&&this.dispatchEvent(new E(F.SELECT,c,u,e)),(0,a.pointerMove)(e)}function L(){const e=(0,v.createEditingStyle)();return(0,r.extend)(e[c.default.POLYGON],e[c.default.LINE_STRING]),(0,r.extend)(e[c.default.GEOMETRY_COLLECTION],e[c.default.LINE_STRING]),function(t,i){return t.getGeometry()?e[t.getGeometry().getType()]:null}}(0,e.inherits)(C,d.default),C.prototype.addFeatureLayerAssociation_=function(t,i){const r=(0,e.getUid)(t);this.featureLayerAssociation_[r]=i},C.prototype.getFeatures=function(){return this.featureOverlay_.getSource().getFeaturesCollection()},C.prototype.getHitTolerance=function(){return this.hitTolerance_},C.prototype.getLayer=function(t){const i=(0,e.getUid)(t);return this.featureLayerAssociation_[i]},C.prototype.setHitTolerance=function(e){this.hitTolerance_=e},C.prototype.setMap=function(e){const t=this.getMap(),i=this.featureOverlay_.getSource().getFeaturesCollection();t&&i.forEach(t.unskipFeature.bind(t)),d.default.prototype.setMap.call(this,e),this.featureOverlay_.setMap(e),e&&i.forEach(e.skipFeature.bind(e))},C.prototype.addFeature_=function(e){const t=this.getMap();t&&t.skipFeature(e.element)},C.prototype.removeFeature_=function(e){const t=this.getMap();t&&t.unskipFeature(e.element)},C.prototype.removeFeatureLayerAssociation_=function(t){const i=(0,e.getUid)(t);delete this.featureLayerAssociation_[i]},exports.default=C;
},{"../util.js":43,"../CollectionEventType.js":100,"../array.js":130,"../events.js":84,"../events/Event.js":123,"../events/condition.js":238,"../functions.js":103,"../geom/GeometryType.js":140,"../interaction/Interaction.js":172,"../layer/Vector.js":245,"../obj.js":74,"../source/Vector.js":243,"../style/Style.js":112}],179:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handleEvent=v;var e=require("../util.js"),t=require("../Collection.js"),i=require("../CollectionEventType.js"),n=F(i),r=require("../coordinate.js"),o=require("../events.js"),s=require("../events/EventType.js"),u=F(s),a=require("../extent.js"),l=require("../functions.js"),h=require("../geom/GeometryType.js"),c=F(h),d=require("../geom/Polygon.js"),g=require("../interaction/Pointer.js"),_=F(g),f=require("../obj.js"),p=require("../source/Vector.js"),y=require("../source/VectorEventType.js"),m=F(y),E=require("../structs/RBush.js"),x=F(E);function F(e){return e&&e.__esModule?e:{default:e}}const C=function(e){_.default.call(this,{handleEvent:v,handleDownEvent:l.TRUE,handleUpEvent:T});const t=e||{};this.source_=t.source?t.source:null,this.vertex_=void 0===t.vertex||t.vertex,this.edge_=void 0===t.edge||t.edge,this.features_=t.features?t.features:null,this.featuresListenerKeys_=[],this.featureChangeListenerKeys_={},this.indexedFeaturesExtents_={},this.pendingFeatures_={},this.pixelCoordinate_=null,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.sortByDistance_=G.bind(this),this.rBush_=new x.default,this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_,Circle:this.writeCircleGeometry_}};function v(e){const t=this.snapTo(e.pixel,e.coordinate,e.map);return t.snapped&&(e.coordinate=t.vertex.slice(0,2),e.pixel=t.vertexPixel),g.handleEvent.call(this,e)}function T(e){const t=(0,f.getValues)(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1}function G(e,t){return(0,r.squaredDistanceToSegment)(this.pixelCoordinate_,e.segment)-(0,r.squaredDistanceToSegment)(this.pixelCoordinate_,t.segment)}(0,e.inherits)(C,_.default),C.prototype.addFeature=function(t,i){const n=void 0===i||i,r=(0,e.getUid)(t),s=t.getGeometry();if(s){const e=this.SEGMENT_WRITERS_[s.getType()];e&&(this.indexedFeaturesExtents_[r]=s.getExtent((0,a.createEmpty)()),e.call(this,t,s))}n&&(this.featureChangeListenerKeys_[r]=(0,o.listen)(t,u.default.CHANGE,this.handleFeatureChange_,this))},C.prototype.forEachFeatureAdd_=function(e){this.addFeature(e)},C.prototype.forEachFeatureRemove_=function(e){this.removeFeature(e)},C.prototype.getFeatures_=function(){let e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e},C.prototype.handleFeatureAdd_=function(e){let i;e instanceof p.VectorSourceEvent?i=e.feature:e instanceof t.CollectionEvent&&(i=e.element),this.addFeature(i)},C.prototype.handleFeatureRemove_=function(e){let i;e instanceof p.VectorSourceEvent?i=e.feature:e instanceof t.CollectionEvent&&(i=e.element),this.removeFeature(i)},C.prototype.handleFeatureChange_=function(t){const i=t.target;if(this.handlingDownUpSequence){const t=(0,e.getUid)(i);t in this.pendingFeatures_||(this.pendingFeatures_[t]=i)}else this.updateFeature_(i)},C.prototype.removeFeature=function(t,i){const n=void 0===i||i,r=(0,e.getUid)(t),s=this.indexedFeaturesExtents_[r];if(s){const e=this.rBush_,i=[];e.forEachInExtent(s,function(e){t===e.feature&&i.push(e)});for(let t=i.length-1;t>=0;--t)e.remove(i[t])}n&&((0,o.unlistenByKey)(this.featureChangeListenerKeys_[r]),delete this.featureChangeListenerKeys_[r])},C.prototype.setMap=function(e){const t=this.getMap(),i=this.featuresListenerKeys_,r=this.getFeatures_();t&&(i.forEach(o.unlistenByKey),i.length=0,r.forEach(this.forEachFeatureRemove_.bind(this))),_.default.prototype.setMap.call(this,e),e&&(this.features_?i.push((0,o.listen)(this.features_,n.default.ADD,this.handleFeatureAdd_,this),(0,o.listen)(this.features_,n.default.REMOVE,this.handleFeatureRemove_,this)):this.source_&&i.push((0,o.listen)(this.source_,m.default.ADDFEATURE,this.handleFeatureAdd_,this),(0,o.listen)(this.source_,m.default.REMOVEFEATURE,this.handleFeatureRemove_,this)),r.forEach(this.forEachFeatureAdd_.bind(this)))},C.prototype.shouldStopEvent=l.FALSE,C.prototype.snapTo=function(e,t,i){const n=i.getCoordinateFromPixel([e[0]-this.pixelTolerance_,e[1]+this.pixelTolerance_]),o=i.getCoordinateFromPixel([e[0]+this.pixelTolerance_,e[1]-this.pixelTolerance_]),s=(0,a.boundingExtent)([n,o]);let u=this.rBush_.getInExtent(s);this.vertex_&&!this.edge_&&(u=u.filter(function(e){return e.feature.getGeometry().getType()!==c.default.CIRCLE}));let l,h,d,g,_,f=!1,p=!1,y=null,m=null;if(u.length>0){this.pixelCoordinate_=t,u.sort(this.sortByDistance_);const n=u[0].segment,o=u[0].feature.getGeometry().getType()===c.default.CIRCLE;this.vertex_&&!this.edge_?(h=i.getPixelFromCoordinate(n[0]),d=i.getPixelFromCoordinate(n[1]),g=(0,r.squaredDistance)(e,h),_=(0,r.squaredDistance)(e,d),(f=(l=Math.sqrt(Math.min(g,_)))<=this.pixelTolerance_)&&(p=!0,y=g>_?n[1]:n[0],m=i.getPixelFromCoordinate(y))):this.edge_&&(y=o?(0,r.closestOnCircle)(t,u[0].feature.getGeometry()):(0,r.closestOnSegment)(t,n),m=i.getPixelFromCoordinate(y),(0,r.distance)(e,m)<=this.pixelTolerance_&&(p=!0,this.vertex_&&!o&&(h=i.getPixelFromCoordinate(n[0]),d=i.getPixelFromCoordinate(n[1]),g=(0,r.squaredDistance)(m,h),_=(0,r.squaredDistance)(m,d),(f=(l=Math.sqrt(Math.min(g,_)))<=this.pixelTolerance_)&&(y=g>_?n[1]:n[0],m=i.getPixelFromCoordinate(y))))),p&&(m=[Math.round(m[0]),Math.round(m[1])])}return{snapped:p,vertex:y,vertexPixel:m}},C.prototype.updateFeature_=function(e){this.removeFeature(e,!1),this.addFeature(e,!1)},C.prototype.writeCircleGeometry_=function(e,t){const i=(0,d.fromCircle)(t).getCoordinates()[0];for(let t=0,n=i.length-1;t<n;++t){const n=i.slice(t,t+2),r={feature:e,segment:n};this.rBush_.insert((0,a.boundingExtent)(n),r)}},C.prototype.writeGeometryCollectionGeometry_=function(e,t){const i=t.getGeometriesArray();for(let t=0;t<i.length;++t){const n=this.SEGMENT_WRITERS_[i[t].getType()];n&&n.call(this,e,i[t])}},C.prototype.writeLineStringGeometry_=function(e,t){const i=t.getCoordinates();for(let t=0,n=i.length-1;t<n;++t){const n=i.slice(t,t+2),r={feature:e,segment:n};this.rBush_.insert((0,a.boundingExtent)(n),r)}},C.prototype.writeMultiLineStringGeometry_=function(e,t){const i=t.getCoordinates();for(let t=0,n=i.length;t<n;++t){const n=i[t];for(let t=0,i=n.length-1;t<i;++t){const i=n.slice(t,t+2),r={feature:e,segment:i};this.rBush_.insert((0,a.boundingExtent)(i),r)}}},C.prototype.writeMultiPointGeometry_=function(e,t){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n){const r=i[n],o={feature:e,segment:[r,r]};this.rBush_.insert(t.getExtent(),o)}},C.prototype.writeMultiPolygonGeometry_=function(e,t){const i=t.getCoordinates();for(let t=0,n=i.length;t<n;++t){const n=i[t];for(let t=0,i=n.length;t<i;++t){const i=n[t];for(let t=0,n=i.length-1;t<n;++t){const n=i.slice(t,t+2),r={feature:e,segment:n};this.rBush_.insert((0,a.boundingExtent)(n),r)}}}},C.prototype.writePointGeometry_=function(e,t){const i=t.getCoordinates(),n={feature:e,segment:[i,i]};this.rBush_.insert(t.getExtent(),n)},C.prototype.writePolygonGeometry_=function(e,t){const i=t.getCoordinates();for(let t=0,n=i.length;t<n;++t){const n=i[t];for(let t=0,i=n.length-1;t<i;++t){const i=n.slice(t,t+2),r={feature:e,segment:i};this.rBush_.insert((0,a.boundingExtent)(i),r)}}},exports.default=C;
},{"../util.js":43,"../Collection.js":16,"../CollectionEventType.js":100,"../coordinate.js":89,"../events.js":84,"../events/EventType.js":110,"../extent.js":90,"../functions.js":103,"../geom/GeometryType.js":140,"../geom/Polygon.js":113,"../interaction/Pointer.js":174,"../obj.js":74,"../source/Vector.js":243,"../source/VectorEventType.js":244,"../structs/RBush.js":251}],177:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TranslateEvent=void 0;var t=require("../util.js"),e=require("../Collection.js"),i=f(e),s=require("../Object.js"),a=require("../events.js"),r=require("../events/Event.js"),n=f(r),o=require("../functions.js"),l=require("../array.js"),u=require("../interaction/Pointer.js"),h=f(u),c=require("../interaction/Property.js"),d=f(c);function f(t){return t&&t.__esModule?t:{default:t}}const _={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"},p=exports.TranslateEvent=function(t,e,i){n.default.call(this,t),this.features=e,this.coordinate=i};(0,t.inherits)(p,n.default);const T=function(t){h.default.call(this,{handleDownEvent:g,handleDragEvent:A,handleMoveEvent:y,handleUpEvent:v});const e=t||{};let i;if(this.lastCoordinate_=null,this.features_=void 0!==e.features?e.features:null,e.layers)if("function"==typeof e.layers)i=e.layers;else{const t=e.layers;i=function(e){return(0,l.includes)(t,e)}}else i=o.TRUE;this.layerFilter_=i,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.lastFeature_=null,(0,a.listen)(this,(0,s.getChangeEventType)(d.default.ACTIVE),this.handleActiveChanged_,this)};function g(t){if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.lastCoordinate_=t.coordinate,y.call(this,t);const e=this.features_||new i.default([this.lastFeature_]);return this.dispatchEvent(new p(_.TRANSLATESTART,e,t.coordinate)),!0}return!1}function v(t){if(this.lastCoordinate_){this.lastCoordinate_=null,y.call(this,t);const e=this.features_||new i.default([this.lastFeature_]);return this.dispatchEvent(new p(_.TRANSLATEEND,e,t.coordinate)),!0}return!1}function A(t){if(this.lastCoordinate_){const e=t.coordinate,s=e[0]-this.lastCoordinate_[0],a=e[1]-this.lastCoordinate_[1],r=this.features_||new i.default([this.lastFeature_]);r.forEach(function(t){const e=t.getGeometry();e.translate(s,a),t.setGeometry(e)}),this.lastCoordinate_=e,this.dispatchEvent(new p(_.TRANSLATING,r,e))}}function y(t){const e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")}(0,t.inherits)(T,h.default),T.prototype.featuresAtPixel_=function(t,e){return e.forEachFeatureAtPixel(t,function(t){if(!this.features_||(0,l.includes)(this.features_.getArray(),t))return t}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},T.prototype.getHitTolerance=function(){return this.hitTolerance_},T.prototype.setHitTolerance=function(t){this.hitTolerance_=t},T.prototype.setMap=function(t){const e=this.getMap();h.default.prototype.setMap.call(this,t),this.updateState_(e)},T.prototype.handleActiveChanged_=function(){this.updateState_(null)},T.prototype.updateState_=function(t){let e=this.getMap();const i=this.getActive();if((!e||!i)&&(e=e||t)){e.getViewport().classList.remove("ol-grab","ol-grabbing")}},exports.default=T;
},{"../util.js":43,"../Collection.js":16,"../Object.js":31,"../events.js":84,"../events/Event.js":123,"../functions.js":103,"../array.js":130,"../interaction/Pointer.js":174,"../interaction/Property.js":246}],94:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Translate=exports.Snap=exports.Select=exports.Pointer=exports.PinchZoom=exports.PinchRotate=exports.MouseWheelZoom=exports.Modify=exports.KeyboardZoom=exports.KeyboardPan=exports.Interaction=exports.Extent=exports.Draw=exports.DragZoom=exports.DragRotateAndZoom=exports.DragRotate=exports.DragPan=exports.DragBox=exports.DragAndDrop=exports.DoubleClickZoom=void 0;var e=require("./interaction/DoubleClickZoom.js");Object.defineProperty(exports,"DoubleClickZoom",{enumerable:!0,get:function(){return K(e).default}});var t=require("./interaction/DragAndDrop.js");Object.defineProperty(exports,"DragAndDrop",{enumerable:!0,get:function(){return K(t).default}});var r=require("./interaction/DragBox.js");Object.defineProperty(exports,"DragBox",{enumerable:!0,get:function(){return K(r).default}});var o=require("./interaction/DragPan.js");Object.defineProperty(exports,"DragPan",{enumerable:!0,get:function(){return K(o).default}});var n=require("./interaction/DragRotate.js");Object.defineProperty(exports,"DragRotate",{enumerable:!0,get:function(){return K(n).default}});var a=require("./interaction/DragRotateAndZoom.js");Object.defineProperty(exports,"DragRotateAndZoom",{enumerable:!0,get:function(){return K(a).default}});var i=require("./interaction/DragZoom.js");Object.defineProperty(exports,"DragZoom",{enumerable:!0,get:function(){return K(i).default}});var u=require("./interaction/Draw.js");Object.defineProperty(exports,"Draw",{enumerable:!0,get:function(){return K(u).default}});var s=require("./interaction/Extent.js");Object.defineProperty(exports,"Extent",{enumerable:!0,get:function(){return K(s).default}});var c=require("./interaction/Interaction.js");Object.defineProperty(exports,"Interaction",{enumerable:!0,get:function(){return K(c).default}});var d=require("./interaction/KeyboardPan.js");Object.defineProperty(exports,"KeyboardPan",{enumerable:!0,get:function(){return K(d).default}});var l=require("./interaction/KeyboardZoom.js");Object.defineProperty(exports,"KeyboardZoom",{enumerable:!0,get:function(){return K(l).default}});var f=require("./interaction/Modify.js");Object.defineProperty(exports,"Modify",{enumerable:!0,get:function(){return K(f).default}});var p=require("./interaction/MouseWheelZoom.js");Object.defineProperty(exports,"MouseWheelZoom",{enumerable:!0,get:function(){return K(p).default}});var m=require("./interaction/PinchRotate.js");Object.defineProperty(exports,"PinchRotate",{enumerable:!0,get:function(){return K(m).default}});var b=require("./interaction/PinchZoom.js");Object.defineProperty(exports,"PinchZoom",{enumerable:!0,get:function(){return K(b).default}});var x=require("./interaction/Pointer.js");Object.defineProperty(exports,"Pointer",{enumerable:!0,get:function(){return K(x).default}});var g=require("./interaction/Select.js");Object.defineProperty(exports,"Select",{enumerable:!0,get:function(){return K(g).default}});var j=require("./interaction/Snap.js");Object.defineProperty(exports,"Snap",{enumerable:!0,get:function(){return K(j).default}});var D=require("./interaction/Translate.js");Object.defineProperty(exports,"Translate",{enumerable:!0,get:function(){return K(D).default}}),exports.defaults=A;var P=require("./Collection.js"),y=K(P),v=require("./Kinetic.js"),h=K(v),Z=K(e),q=K(o),O=K(n),R=K(i),w=K(d),k=K(l),M=K(p),S=K(m),z=K(b);function K(e){return e&&e.__esModule?e:{default:e}}function A(e){const t=e||{},r=new y.default,o=new h.default(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&r.push(new O.default),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&r.push(new Z.default({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&r.push(new q.default({kinetic:o})),(void 0===t.pinchRotate||t.pinchRotate)&&r.push(new S.default),(void 0===t.pinchZoom||t.pinchZoom)&&r.push(new z.default({constrainResolution:t.constrainResolution,duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(r.push(new w.default),r.push(new k.default({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&r.push(new M.default({constrainResolution:t.constrainResolution,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&r.push(new R.default({duration:t.zoomDuration})),r}
},{"./Collection.js":16,"./Kinetic.js":25,"./interaction/DoubleClickZoom.js":160,"./interaction/DragPan.js":161,"./interaction/DragRotate.js":176,"./interaction/DragZoom.js":165,"./interaction/KeyboardPan.js":162,"./interaction/KeyboardZoom.js":163,"./interaction/MouseWheelZoom.js":164,"./interaction/PinchRotate.js":178,"./interaction/PinchZoom.js":166,"./interaction/DragAndDrop.js":167,"./interaction/DragBox.js":168,"./interaction/DragRotateAndZoom.js":169,"./interaction/Draw.js":170,"./interaction/Extent.js":171,"./interaction/Interaction.js":172,"./interaction/Modify.js":173,"./interaction/Pointer.js":174,"./interaction/Select.js":175,"./interaction/Snap.js":179,"./interaction/Translate.js":177}],222:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=exports.ERROR_THRESHOLD=.5,t=exports.ENABLE_RASTER_REPROJECTION=!0;
},{}],216:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../events/Event.js"),s=r(e);function r(t){return t&&t.__esModule?t:{default:t}}const i=function(t,e,r,i,u){s.default.call(this,t),this.vectorContext=e,this.frameState=r,this.context=i,this.glContext=u};(0,t.inherits)(i,s.default),exports.default=i;
},{"../util.js":43,"../events/Event.js":123}],258:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(){};t.prototype.drawCustom=function(t,o,e){},t.prototype.drawGeometry=function(t){},t.prototype.setStyle=function(t){},t.prototype.drawCircle=function(t,o){},t.prototype.drawFeature=function(t,o){},t.prototype.drawGeometryCollection=function(t,o){},t.prototype.drawLineString=function(t,o){},t.prototype.drawMultiLineString=function(t,o){},t.prototype.drawMultiPoint=function(t,o){},t.prototype.drawMultiPolygon=function(t,o){},t.prototype.drawPoint=function(t,o){},t.prototype.drawPolygon=function(t,o){},t.prototype.drawText=function(t,o){},t.prototype.setFillStrokeStyle=function(t,o){},t.prototype.setImageStyle=function(t,o){},t.prototype.setTextStyle=function(t,o){},exports.default=t;
},{}],221:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../util.js"),e=require("../../array.js"),i=require("../../colorlike.js"),s=require("../../extent.js"),o=require("../../geom/GeometryType.js"),n=S(o),a=require("../../geom/SimpleGeometry.js"),l=require("../../geom/flat/transform.js"),h=require("../../has.js"),r=require("../VectorContext.js"),_=S(r),f=require("../canvas.js"),g=require("../../transform.js");function S(t){return t&&t.__esModule?t:{default:t}}const x=function(t,e,i,s,o){_.default.call(this),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=s,this.viewRotation_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=0,this.imageSnapToPixel_=!1,this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=0,this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=(0,g.create)()};(0,t.inherits)(x,_.default),x.prototype.drawImages_=function(t,e,i,s){if(!this.image_)return;const o=(0,l.transform2D)(t,e,i,2,this.transform_,this.pixelCoordinates_),n=this.context_,a=this.tmpLocalTransform_,h=n.globalAlpha;1!=this.imageOpacity_&&(n.globalAlpha=h*this.imageOpacity_);let r=this.imageRotation_;this.imageRotateWithView_&&(r+=this.viewRotation_);for(let t=0,e=o.length;t<e;t+=2){let e=o[t]-this.imageAnchorX_,i=o[t+1]-this.imageAnchorY_;if(this.imageSnapToPixel_&&(e=Math.round(e),i=Math.round(i)),0!==r||1!=this.imageScale_){const t=e+this.imageAnchorX_,s=i+this.imageAnchorY_;(0,g.compose)(a,t,s,this.imageScale_,this.imageScale_,r,-t,-s),n.setTransform.apply(n,a)}n.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,e,i,this.imageWidth_,this.imageHeight_)}0===r&&1==this.imageScale_||n.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(n.globalAlpha=h)},x.prototype.drawText_=function(t,e,i,s){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const o=(0,l.transform2D)(t,e,i,s,this.transform_,this.pixelCoordinates_),n=this.context_;let a=this.textRotation_;for(this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=s){const t=o[e]+this.textOffsetX_,i=o[e+1]+this.textOffsetY_;if(0!==a||1!=this.textScale_){const e=(0,g.compose)(this.tmpLocalTransform_,t,i,this.textScale_,this.textScale_,a,-t,-i);n.setTransform.apply(n,e)}this.textStrokeState_&&n.strokeText(this.text_,t,i),this.textFillState_&&n.fillText(this.text_,t,i)}0===a&&1==this.textScale_||n.setTransform(1,0,0,1,0,0)},x.prototype.moveToLineTo_=function(t,e,i,s,o){const n=this.context_,a=(0,l.transform2D)(t,e,i,s,this.transform_,this.pixelCoordinates_);n.moveTo(a[0],a[1]);let h=a.length;o&&(h-=2);for(let t=2;t<h;t+=2)n.lineTo(a[t],a[t+1]);return o&&n.closePath(),i},x.prototype.drawRings_=function(t,e,i,s){for(let o=0,n=i.length;o<n;++o)e=this.moveToLineTo_(t,e,i[o],s,!0);return e},x.prototype.drawCircle=function(t){if((0,s.intersects)(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=(0,a.transformGeom2D)(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],s=e[3]-e[1],o=Math.sqrt(i*i+s*s),n=this.context_;n.beginPath(),n.arc(e[0],e[1],o,0,2*Math.PI),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},x.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},x.prototype.drawGeometry=function(t){switch(t.getType()){case n.default.POINT:this.drawPoint(t);break;case n.default.LINE_STRING:this.drawLineString(t);break;case n.default.POLYGON:this.drawPolygon(t);break;case n.default.MULTI_POINT:this.drawMultiPoint(t);break;case n.default.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case n.default.MULTI_POLYGON:this.drawMultiPolygon(t);break;case n.default.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case n.default.CIRCLE:this.drawCircle(t)}},x.prototype.drawFeature=function(t,e){const i=e.getGeometryFunction()(t);i&&(0,s.intersects)(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},x.prototype.drawGeometryCollection=function(t){const e=t.getGeometriesArray();for(let t=0,i=e.length;t<i;++t)this.drawGeometry(e[t])},x.prototype.drawPoint=function(t){const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},x.prototype.drawMultiPoint=function(t){const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},x.prototype.drawLineString=function(t){if((0,s.intersects)(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}},x.prototype.drawMultiLineString=function(t){const e=t.getExtent();if((0,s.intersects)(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();let s=0;const o=t.getEnds(),n=t.getStride();e.beginPath();for(let t=0,e=o.length;t<e;++t)s=this.moveToLineTo_(i,s,o[t],n,!1);e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoints();this.drawText_(e,0,e.length,2)}}},x.prototype.drawPolygon=function(t){if((0,s.intersects)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}},x.prototype.drawMultiPolygon=function(t){if((0,s.intersects)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let s=0;const o=t.getEndss(),n=t.getStride();e.beginPath();for(let t=0,e=o.length;t<e;++t){const e=o[t];s=this.drawRings_(i,s,e,n)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}},x.prototype.setContextFillState_=function(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},x.prototype.setContextStrokeState_=function(t){const i=this.context_,s=this.contextStrokeState_;s?(s.lineCap!=t.lineCap&&(s.lineCap=i.lineCap=t.lineCap),h.CANVAS_LINE_DASH&&((0,e.equals)(s.lineDash,t.lineDash)||i.setLineDash(s.lineDash=t.lineDash),s.lineDashOffset!=t.lineDashOffset&&(s.lineDashOffset=i.lineDashOffset=t.lineDashOffset)),s.lineJoin!=t.lineJoin&&(s.lineJoin=i.lineJoin=t.lineJoin),s.lineWidth!=t.lineWidth&&(s.lineWidth=i.lineWidth=t.lineWidth),s.miterLimit!=t.miterLimit&&(s.miterLimit=i.miterLimit=t.miterLimit),s.strokeStyle!=t.strokeStyle&&(s.strokeStyle=i.strokeStyle=t.strokeStyle)):(i.lineCap=t.lineCap,h.CANVAS_LINE_DASH&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineJoin=t.lineJoin,i.lineWidth=t.lineWidth,i.miterLimit=t.miterLimit,i.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},x.prototype.setContextTextState_=function(t){const e=this.context_,i=this.contextTextState_,s=t.textAlign?t.textAlign:f.defaultTextAlign;i?(i.font!=t.font&&(i.font=e.font=t.font),i.textAlign!=s&&(i.textAlign=e.textAlign=s),i.textBaseline!=t.textBaseline&&(i.textBaseline=e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=s,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:s,textBaseline:t.textBaseline})},x.prototype.setFillStrokeStyle=function(t,e){if(t){const e=t.getColor();this.fillState_={fillStyle:(0,i.asColorLike)(e||f.defaultFillStyle)}}else this.fillState_=null;if(e){const t=e.getColor(),s=e.getLineCap(),o=e.getLineDash(),n=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),h=e.getMiterLimit();this.strokeState_={lineCap:void 0!==s?s:f.defaultLineCap,lineDash:o||f.defaultLineDash,lineDashOffset:n||f.defaultLineDashOffset,lineJoin:void 0!==a?a:f.defaultLineJoin,lineWidth:this.pixelRatio_*(void 0!==l?l:f.defaultLineWidth),miterLimit:void 0!==h?h:f.defaultMiterLimit,strokeStyle:(0,i.asColorLike)(t||f.defaultStrokeStyle)}}else this.strokeState_=null},x.prototype.setImageStyle=function(t){if(t){const e=t.getAnchor(),i=t.getImage(1),s=t.getOrigin(),o=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=o[1],this.image_=i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageSnapToPixel_=t.getSnapToPixel(),this.imageWidth_=o[0]}else this.image_=null},x.prototype.setTextStyle=function(t){if(t){const e=t.getFill();if(e){const t=e.getColor();this.textFillState_={fillStyle:(0,i.asColorLike)(t||f.defaultFillStyle)}}else this.textFillState_=null;const s=t.getStroke();if(s){const t=s.getColor(),e=s.getLineCap(),o=s.getLineDash(),n=s.getLineDashOffset(),a=s.getLineJoin(),l=s.getWidth(),h=s.getMiterLimit();this.textStrokeState_={lineCap:void 0!==e?e:f.defaultLineCap,lineDash:o||f.defaultLineDash,lineDashOffset:n||f.defaultLineDashOffset,lineJoin:void 0!==a?a:f.defaultLineJoin,lineWidth:void 0!==l?l:f.defaultLineWidth,miterLimit:void 0!==h?h:f.defaultMiterLimit,strokeStyle:(0,i.asColorLike)(t||f.defaultStrokeStyle)}}else this.textStrokeState_=null;const o=t.getFont(),n=t.getOffsetX(),a=t.getOffsetY(),l=t.getRotateWithView(),h=t.getRotation(),r=t.getScale(),_=t.getText(),g=t.getTextAlign(),S=t.getTextBaseline();this.textState_={font:void 0!==o?o:f.defaultFont,textAlign:void 0!==g?g:f.defaultTextAlign,textBaseline:void 0!==S?S:f.defaultTextBaseline},this.text_=void 0!==_?_:"",this.textOffsetX_=void 0!==n?this.pixelRatio_*n:0,this.textOffsetY_=void 0!==a?this.pixelRatio_*a:0,this.textRotateWithView_=void 0!==l&&l,this.textRotation_=void 0!==h?h:0,this.textScale_=this.pixelRatio_*(void 0!==r?r:1)}else this.text_=""},exports.default=x;
},{"../../util.js":43,"../../array.js":130,"../../colorlike.js":257,"../../extent.js":90,"../../geom/GeometryType.js":140,"../../geom/SimpleGeometry.js":141,"../../geom/flat/transform.js":192,"../../has.js":86,"../VectorContext.js":258,"../canvas.js":217,"../../transform.js":105}],255:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shared=void 0;var e=require("../color.js");const t=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};function c(t,c,i){return c+":"+t+":"+(i?(0,e.asString)(i):"null")}t.prototype.clear=function(){this.cache_={},this.cacheSize_=0},t.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){let e=0;for(const t in this.cache_){const c=this.cache_[t];0!=(3&e++)||c.hasListener()||(delete this.cache_[t],--this.cacheSize_)}}},t.prototype.get=function(e,t,i){const s=c(e,t,i);return s in this.cache_?this.cache_[s]:null},t.prototype.set=function(e,t,i,s){const h=c(e,t,i);this.cache_[h]=s,++this.cacheSize_},t.prototype.setSize=function(e){this.maxCacheSize_=e,this.expire()},exports.default=t;const i=exports.shared=new t;
},{"../color.js":209}],218:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sortByZIndex=h;var e=require("../util.js"),r=require("../Disposable.js"),t=l(r),n=require("../events.js"),o=require("../events/EventType.js"),s=l(o),i=require("../extent.js"),a=require("../functions.js"),u=require("../layer/Layer.js"),d=require("../style/IconImageCache.js"),y=require("../transform.js");function l(e){return e&&e.__esModule?e:{default:e}}const c=function(e){t.default.call(this),this.map_=e,this.layerRenderers_={},this.layerRendererListeners_={},this.layerRendererConstructors_=[]};function p(e,r){d.shared.expire()}function h(e,r){return e.zIndex-r.zIndex}(0,e.inherits)(c,t.default),c.prototype.registerLayerRenderers=function(e){this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_,e)},c.prototype.getLayerRendererConstructors=function(){return this.layerRendererConstructors_},c.prototype.calculateMatrices2D=function(e){const r=e.viewState,t=e.coordinateToPixelTransform,n=e.pixelToCoordinateTransform;(0,y.compose)(t,e.size[0]/2,e.size[1]/2,1/r.resolution,-1/r.resolution,-r.rotation,-r.center[0],-r.center[1]),(0,y.invert)((0,y.setFromArray)(n,t))},c.prototype.removeLayerRenderers=function(){for(const e in this.layerRenderers_)this.removeLayerRendererByKey_(e).dispose()},c.prototype.forEachFeatureAtCoordinate=function(r,t,n,o,s,a,d){let y;const l=t.viewState,c=l.resolution;function p(r,n){const i=(0,e.getUid)(r).toString(),a=t.layerStates[(0,e.getUid)(n)].managed;if(!(i in t.skippedFeatureUids)||a)return o.call(s,r,a?n:null)}const h=l.projection;let f=r;if(h.canWrapX()){const e=h.getExtent(),t=(0,i.getWidth)(e),n=r[0];if(n<e[0]||n>e[2]){f=[n+t*Math.ceil((e[0]-n)/t),r[1]]}}const R=t.layerStatesArray;let _;for(_=R.length-1;_>=0;--_){const e=R[_],o=e.layer;if((0,u.visibleAtResolution)(e,c)&&a.call(d,o)){const e=this.getLayerRenderer(o);if(o.getSource()&&(y=e.forEachFeatureAtCoordinate(o.getSource().getWrapX()?f:r,t,n,p,s)),y)return y}}},c.prototype.forEachLayerAtPixel=function(e,r,t,n,o,s,i){},c.prototype.hasFeatureAtCoordinate=function(e,r,t,n,o){return void 0!==this.forEachFeatureAtCoordinate(e,r,t,a.TRUE,this,n,o)},c.prototype.getLayerRenderer=function(r){const t=(0,e.getUid)(r).toString();if(t in this.layerRenderers_)return this.layerRenderers_[t];{let e;for(let t=0,n=this.layerRendererConstructors_.length;t<n;++t){const n=this.layerRendererConstructors_[t];if(n.handles(r)){e=n.create(this,r);break}}if(!e)throw new Error("Unable to create renderer for layer: "+r.getType());return this.layerRenderers_[t]=e,this.layerRendererListeners_[t]=(0,n.listen)(e,s.default.CHANGE,this.handleLayerRendererChange_,this),e}},c.prototype.getLayerRendererByKey=function(e){return this.layerRenderers_[e]},c.prototype.getLayerRenderers=function(){return this.layerRenderers_},c.prototype.getMap=function(){return this.map_},c.prototype.handleLayerRendererChange_=function(){this.map_.render()},c.prototype.removeLayerRendererByKey_=function(e){const r=this.layerRenderers_[e];return delete this.layerRenderers_[e],(0,n.unlistenByKey)(this.layerRendererListeners_[e]),delete this.layerRendererListeners_[e],r},c.prototype.renderFrame=a.UNDEFINED,c.prototype.removeUnusedLayerRenderers_=function(e,r){for(const e in this.layerRenderers_)r&&e in r.layerStates||this.removeLayerRendererByKey_(e).dispose()},c.prototype.scheduleExpireIconCache=function(e){e.postRenderFunctions.push(p)},c.prototype.scheduleRemoveUnusedLayerRenderers=function(e){for(const r in this.layerRenderers_)if(!(r in e.layerStates))return void e.postRenderFunctions.push(this.removeUnusedLayerRenderers_.bind(this))},exports.default=c;
},{"../util.js":43,"../Disposable.js":17,"../events.js":84,"../events/EventType.js":110,"../extent.js":90,"../functions.js":103,"../layer/Layer.js":75,"../style/IconImageCache.js":255,"../transform.js":105}],135:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.layerRendererConstructors=void 0;var e=require("../../transform.js"),t=require("../../util.js"),r=require("../../array.js"),s=require("../../css.js"),i=require("../../dom.js"),a=require("../../layer/Layer.js"),n=require("../../render/Event.js"),o=_(n),c=require("../../render/EventType.js"),l=_(c),h=require("../../render/canvas.js"),d=require("../../render/canvas/Immediate.js"),u=_(d),p=require("../Map.js"),v=_(p),f=require("../../source/State.js"),y=_(f);function _(e){return e&&e.__esModule?e:{default:e}}const m=exports.layerRendererConstructors=[],x=function(t){v.default.call(this,t);const r=t.getViewport();this.context_=(0,i.createCanvasContext2D)(),this.canvas_=this.context_.canvas,this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=s.CLASS_UNSELECTABLE,r.insertBefore(this.canvas_,r.childNodes[0]||null),this.renderedVisible_=!0,this.transform_=(0,e.create)()};(0,t.inherits)(x,v.default),x.prototype.dispatchComposeEvent_=function(e,t){const r=this.getMap(),s=this.context_;if(r.hasListener(e)){const i=t.extent,a=t.pixelRatio,n=t.viewState.rotation,c=this.getTransform(t),l=new u.default(s,a,i,c,n),h=new o.default(e,l,t,s,null);r.dispatchEvent(h)}},x.prototype.getTransform=function(t){const r=t.viewState,s=this.canvas_.width/2,i=this.canvas_.height/2,a=t.pixelRatio/r.resolution,n=-a,o=-r.rotation,c=-r.center[0],l=-r.center[1];return(0,e.compose)(this.transform_,s,i,a,n,o,c,l)},x.prototype.renderFrame=function(e){if(!e)return void(this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1));const t=this.context_,s=e.pixelRatio,i=Math.round(e.size[0]*s),n=Math.round(e.size[1]*s);this.canvas_.width!=i||this.canvas_.height!=n?(this.canvas_.width=i,this.canvas_.height=n):t.clearRect(0,0,i,n);const o=e.viewState.rotation;this.calculateMatrices2D(e),this.dispatchComposeEvent_(l.default.PRECOMPOSE,e);const c=e.layerStatesArray;(0,r.stableSort)(c,p.sortByZIndex),o&&(t.save(),(0,h.rotateAtOffset)(t,o,i/2,n/2));const d=e.viewState.resolution;let u,v,f,_,m;for(u=0,v=c.length;u<v;++u)f=(m=c[u]).layer,_=this.getLayerRenderer(f),(0,a.visibleAtResolution)(m,d)&&m.sourceState==y.default.READY&&_.prepareFrame(e,m)&&_.composeFrame(e,m,t);o&&t.restore(),this.dispatchComposeEvent_(l.default.POSTCOMPOSE,e),this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.scheduleRemoveUnusedLayerRenderers(e),this.scheduleExpireIconCache(e)},x.prototype.forEachLayerAtPixel=function(t,r,s,i,n,o,c){let l;const h=r.viewState.resolution,d=r.layerStatesArray,u=d.length,p=(0,e.apply)(r.pixelToCoordinateTransform,t.slice());let v;for(v=u-1;v>=0;--v){const e=d[v],t=e.layer;if((0,a.visibleAtResolution)(e,h)&&o.call(c,t)){if(l=this.getLayerRenderer(t).forEachLayerAtCoordinate(p,r,s,i,n))return l}}},x.prototype.registerLayerRenderers=function(e){v.default.prototype.registerLayerRenderers.call(this,e);for(let t=0,s=e.length;t<s;++t){const s=e[t];(0,r.includes)(m,s)||m.push(s)}},exports.default=x;
},{"../../transform.js":105,"../../util.js":43,"../../array.js":130,"../../css.js":99,"../../dom.js":93,"../../layer/Layer.js":75,"../../render/Event.js":216,"../../render/EventType.js":120,"../../render/canvas.js":217,"../../render/canvas/Immediate.js":221,"../Map.js":218,"../../source/State.js":151}],265:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util.js"),t=require("../ImageState.js"),i=g(t),n=require("../Observable.js"),o=g(n),r=require("../TileState.js"),a=g(r),u=require("../events.js"),s=require("../events/EventType.js"),d=g(s),l=require("../functions.js"),c=require("../source/State.js"),f=g(c);function g(e){return e&&e.__esModule?e:{default:e}}const p=function(e){o.default.call(this),this.layer_=e};(0,e.inherits)(p,o.default),p.prototype.forEachFeatureAtCoordinate=l.UNDEFINED,p.prototype.hasFeatureAtCoordinate=l.FALSE,p.prototype.createLoadedTileFinder=function(e,t,i){return function(n,o){return e.forEachLoadedTile(t,n,o,function(e){i[n]||(i[n]={}),i[n][e.tileCoord.toString()]=e})}},p.prototype.getLayer=function(){return this.layer_},p.prototype.handleImageChange_=function(e){e.target.getState()===i.default.LOADED&&this.renderIfReadyAndVisible()},p.prototype.loadImage=function(e){let t=e.getState();return t!=i.default.LOADED&&t!=i.default.ERROR&&(0,u.listen)(e,d.default.CHANGE,this.handleImageChange_,this),t==i.default.IDLE&&(e.load(),t=e.getState()),t==i.default.LOADED},p.prototype.renderIfReadyAndVisible=function(){const e=this.getLayer();e.getVisible()&&e.getSourceState()==f.default.READY&&this.changed()},p.prototype.scheduleExpireCache=function(t,i){if(i.canExpireCache()){const n=function(t,i,n){const o=(0,e.getUid)(t).toString();o in n.usedTiles&&t.expireCache(n.viewState.projection,n.usedTiles[o])}.bind(null,i);t.postRenderFunctions.push(n)}},p.prototype.updateUsedTiles=function(t,i,n,o){const r=(0,e.getUid)(i).toString(),a=n.toString();r in t?a in t[r]?t[r][a].extend(o):t[r][a]=o:(t[r]={},t[r][a]=o)},p.prototype.manageTilePyramid=function(t,i,n,o,r,u,s,d,l,c){const f=(0,e.getUid)(i).toString();f in t.wantedTiles||(t.wantedTiles[f]={});const g=t.wantedTiles[f],p=t.tileQueue;let h,y,E,S,T,C;for(C=n.getMinZoom();C<=s;++C)for(y=n.getTileRangeForExtentAndZ(u,C,y),E=n.getResolution(C),S=y.minX;S<=y.maxX;++S)for(T=y.minY;T<=y.maxY;++T)s-C<=d?((h=i.getTile(C,S,T,o,r)).getState()==a.default.IDLE&&(g[h.getKey()]=!0,p.isKeyQueued(h.getKey())||p.enqueue([h,f,n.getTileCoordCenter(h.tileCoord),E])),void 0!==l&&l.call(c,h)):i.useTile(C,S,T,r)},exports.default=p;
},{"../util.js":43,"../ImageState.js":91,"../Observable.js":32,"../TileState.js":92,"../events.js":84,"../events/EventType.js":110,"../functions.js":103,"../source/State.js":151}],232:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../util.js"),t=require("../../extent.js"),o=require("../../functions.js"),r=require("../../render/Event.js"),i=d(r),n=require("../../render/EventType.js"),s=d(n),a=require("../../render/canvas.js"),p=require("../../render/canvas/Immediate.js"),f=d(p),c=require("../Layer.js"),u=d(c),l=require("../../transform.js");function d(e){return e&&e.__esModule?e:{default:e}}const h=function(e){u.default.call(this,e),this.renderedResolution,this.transform_=(0,l.create)()};(0,e.inherits)(h,u.default),h.prototype.clip=function(e,o,r){const i=o.pixelRatio,n=o.size[0]*i,s=o.size[1]*i,p=o.viewState.rotation,f=(0,t.getTopLeft)(r),c=(0,t.getTopRight)(r),u=(0,t.getBottomRight)(r),d=(0,t.getBottomLeft)(r);(0,l.apply)(o.coordinateToPixelTransform,f),(0,l.apply)(o.coordinateToPixelTransform,c),(0,l.apply)(o.coordinateToPixelTransform,u),(0,l.apply)(o.coordinateToPixelTransform,d),e.save(),(0,a.rotateAtOffset)(e,-p,n/2,s/2),e.beginPath(),e.moveTo(f[0]*i,f[1]*i),e.lineTo(c[0]*i,c[1]*i),e.lineTo(u[0]*i,u[1]*i),e.lineTo(d[0]*i,d[1]*i),e.clip(),(0,a.rotateAtOffset)(e,p,n/2,s/2)},h.prototype.dispatchComposeEvent_=function(e,t,o,r){const n=this.getLayer();if(n.hasListener(e)){const s=o.size[0]*o.pixelRatio,p=o.size[1]*o.pixelRatio,c=o.viewState.rotation;(0,a.rotateAtOffset)(t,-c,s/2,p/2);const u=void 0!==r?r:this.getTransform(o,0),l=new f.default(t,o.pixelRatio,o.extent,u,o.viewState.rotation),d=new i.default(e,l,o,t,null);n.dispatchEvent(d),(0,a.rotateAtOffset)(t,c,s/2,p/2)}},h.prototype.forEachLayerAtCoordinate=function(e,t,r,i,n){return this.forEachFeatureAtCoordinate(e,t,r,o.TRUE,this)?i.call(n,this.getLayer(),null):void 0},h.prototype.postCompose=function(e,t,o,r){this.dispatchComposeEvent_(s.default.POSTCOMPOSE,e,t,r)},h.prototype.preCompose=function(e,t,o){this.dispatchComposeEvent_(s.default.PRECOMPOSE,e,t,o)},h.prototype.dispatchRenderEvent=function(e,t,o){this.dispatchComposeEvent_(s.default.RENDER,e,t,o)},h.prototype.getTransform=function(e,t){const o=e.viewState,r=e.pixelRatio,i=r*e.size[0]/2,n=r*e.size[1]/2,s=r/o.resolution,a=-s,p=-o.rotation,f=-o.center[0]+t,c=-o.center[1];return(0,l.compose)(this.transform_,i,n,s,a,p,f,c)},h.prototype.composeFrame=function(e,t,o){},h.prototype.prepareFrame=function(e,t){},exports.default=h;
},{"../../util.js":43,"../../extent.js":90,"../../functions.js":103,"../../render/Event.js":216,"../../render/EventType.js":120,"../../render/canvas.js":217,"../../render/canvas/Immediate.js":221,"../Layer.js":265,"../../transform.js":105}],220:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../util.js"),e=require("../../coordinate.js"),o=require("../../dom.js"),a=require("../../extent.js"),r=require("../../functions.js"),i=require("../canvas/Layer.js"),n=h(i),s=require("../../transform.js");function h(t){return t&&t.__esModule?t:{default:t}}const u=function(t){n.default.call(this,t),this.coordinateToCanvasPixelTransform=(0,s.create)(),this.hitCanvasContext_=null};(0,t.inherits)(u,n.default),u.prototype.composeFrame=function(t,e,o){this.preCompose(o,t);const r=this.getImage();if(r){const i=e.extent,n=void 0!==i&&!(0,a.containsExtent)(i,t.extent)&&(0,a.intersects)(i,t.extent);n&&this.clip(o,t,i);const s=this.getImageTransform(),h=o.globalAlpha;o.globalAlpha=e.opacity;const u=s[4],c=s[5],l=r.width*s[0],d=r.height*s[3];o.drawImage(r,0,0,+r.width,+r.height,Math.round(u),Math.round(c),Math.round(l),Math.round(d)),o.globalAlpha=h,n&&o.restore()}this.postCompose(o,t,e)},u.prototype.getImage=function(){},u.prototype.getImageTransform=function(){},u.prototype.forEachFeatureAtCoordinate=function(t,e,o,a,r){const i=this.getLayer(),n=i.getSource(),s=e.viewState.resolution,h=e.viewState.rotation,u=e.skippedFeatureUids;return n.forEachFeatureAtCoordinate(t,s,h,o,u,function(t){return a.call(r,t,i)})},u.prototype.forEachLayerAtCoordinate=function(t,a,i,h,u){if(this.getImage()){if(this.getLayer().getSource().forEachFeatureAtCoordinate!==r.UNDEFINED)return n.default.prototype.forEachLayerAtCoordinate.apply(this,arguments);{const r=(0,s.apply)(this.coordinateToCanvasPixelTransform,t.slice());(0,e.scale)(r,a.viewState.resolution/this.renderedResolution),this.hitCanvasContext_||(this.hitCanvasContext_=(0,o.createCanvasContext2D)(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.getImage(),r[0],r[1],1,1,0,0,1,1);const i=this.hitCanvasContext_.getImageData(0,0,1,1).data;return i[3]>0?h.call(u,this.getLayer(),i):void 0}}},exports.default=u;
},{"../../util.js":43,"../../coordinate.js":89,"../../dom.js":93,"../../extent.js":90,"../../functions.js":103,"../canvas/Layer.js":232,"../../transform.js":105}],138:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../reproj/common.js"),t=require("../../util.js"),r=require("../../ImageCanvas.js"),i=_(r),s=require("../../LayerType.js"),n=_(s),o=require("../../ViewHint.js"),a=_(o),u=require("../../array.js"),c=require("../../extent.js"),l=require("../../layer/VectorRenderType.js"),d=_(l),p=require("../../obj.js"),f=require("./Map.js"),h=require("../canvas/IntermediateCanvas.js"),g=_(h),m=require("../../transform.js");function _(e){return e&&e.__esModule?e:{default:e}}const y=function(e){if(g.default.call(this,e),this.image_=null,this.imageTransform_=(0,m.create)(),this.skippedFeatures_=[],this.vectorRenderer_=null,e.getType()===n.default.VECTOR)for(let t=0,r=f.layerRendererConstructors.length;t<r;++t){const r=f.layerRendererConstructors[t];if(r!==y&&r.handles(e)){this.vectorRenderer_=new r(e);break}}};(0,t.inherits)(y,g.default),y.handles=function(e){return e.getType()===n.default.IMAGE||e.getType()===n.default.VECTOR&&e.getRenderMode()===d.default.IMAGE},y.create=function(e,t){return new y(t)},y.prototype.disposeInternal=function(){this.vectorRenderer_&&this.vectorRenderer_.dispose(),g.default.prototype.disposeInternal.call(this)},y.prototype.getImage=function(){return this.image_?this.image_.getImage():null},y.prototype.getImageTransform=function(){return this.imageTransform_},y.prototype.prepareFrame=function(t,r){const s=t.pixelRatio,n=t.size,o=t.viewState,l=o.center,d=o.resolution;let f;const h=this.getLayer().getSource(),g=t.viewHints,_=this.vectorRenderer_;let y=t.extent;if(_||void 0===r.extent||(y=(0,c.getIntersection)(y,r.extent)),!g[a.default.ANIMATING]&&!g[a.default.INTERACTING]&&!(0,c.isEmpty)(y)){let n=o.projection;if(!e.ENABLE_RASTER_REPROJECTION){const e=h.getProjection();e&&(n=e)}let a=this.skippedFeatures_;if(_){const e=_.context,n=(0,p.assign)({},t,{size:[(0,c.getWidth)(y)/d,(0,c.getHeight)(y)/d],viewState:(0,p.assign)({},t.viewState,{rotation:0})}),o=Object.keys(n.skippedFeatureUids).sort();f=new i.default(y,d,s,e.canvas,function(t){!_.prepareFrame(n,r)||!_.replayGroupChanged&&(0,u.equals)(a,o)||(e.canvas.width=n.size[0]*s,e.canvas.height=n.size[1]*s,_.compose(e,n,r),a=o,t())})}else f=h.getImage(y,d,s,n);f&&this.loadImage(f)&&(this.image_=f,this.skippedFeatures_=a)}if(this.image_){const e=(f=this.image_).getExtent(),t=f.getResolution(),r=f.getPixelRatio(),i=s*t/(d*r),o=(0,m.compose)(this.imageTransform_,s*n[0]/2,s*n[1]/2,i,i,0,r*(e[0]-l[0])/t,r*(l[1]-e[3])/t);(0,m.compose)(this.coordinateToCanvasPixelTransform,s*n[0]/2-o[4],s*n[1]/2-o[5],s/d,-s/d,0,-l[0],-l[1]),this.renderedResolution=t*s/r}return!!this.image_},y.prototype.forEachFeatureAtCoordinate=function(e,t,r,i,s){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(e,t,r,i,s):g.default.prototype.forEachFeatureAtCoordinate.call(this,e,t,r,i,s)},exports.default=y;
},{"../../reproj/common.js":222,"../../util.js":43,"../../ImageCanvas.js":23,"../../LayerType.js":73,"../../ViewHint.js":102,"../../array.js":130,"../../extent.js":90,"../../layer/VectorRenderType.js":219,"../../obj.js":74,"./Map.js":135,"../canvas/IntermediateCanvas.js":220,"../../transform.js":105}],38:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createOrUpdate=i;const t=function(t,i,n,m){this.minX=t,this.maxX=i,this.minY=n,this.maxY=m};function i(i,n,m,e,s){return void 0!==s?(s.minX=i,s.maxX=n,s.minY=m,s.maxY=e,s):new t(i,n,m,e)}t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,i){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},exports.default=t;
},{}],136:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../util.js"),t=require("../../LayerType.js"),i=T(t),n=require("../../TileRange.js"),r=T(n),s=require("../../TileState.js"),o=T(s),a=require("../../ViewHint.js"),l=T(a),d=require("../../dom.js"),h=require("../../extent.js"),u=require("../canvas/IntermediateCanvas.js"),g=T(u),c=require("../../transform.js");function T(e){return e&&e.__esModule?e:{default:e}}const f=function(e){g.default.call(this,e),this.context=null===this.context?null:(0,d.createCanvasContext2D)(),this.oversampling_,this.renderedExtent_=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=(0,h.createEmpty)(),this.tmpTileRange_=new r.default(0,0,0,0),this.imageTransform_=(0,c.create)(),this.zDirection=0};(0,e.inherits)(f,g.default),f.handles=function(e){return e.getType()===i.default.TILE},f.create=function(e,t){return new f(t)},f.prototype.isDrawableTile_=function(e){const t=e.getState(),i=this.getLayer().getUseInterimTilesOnError();return t==o.default.LOADED||t==o.default.EMPTY||t==o.default.ERROR&&!i},f.prototype.getTile=function(e,t,i,n,r){const s=this.getLayer();let a=s.getSource().getTile(e,t,i,n,r);return a.getState()==o.default.ERROR&&(s.getUseInterimTilesOnError()?s.getPreload()>0&&(this.newTiles_=!0):a.setState(o.default.LOADED)),this.isDrawableTile_(a)||(a=a.getInterimTile()),a},f.prototype.prepareFrame=function(t,i){const n=t.pixelRatio,r=t.size,s=t.viewState,a=s.projection,d=s.resolution,u=s.center,g=this.getLayer(),T=g.getSource(),f=T.getRevision(),m=T.getTileGridForProjection(a),p=m.getZForResolution(d,this.zDirection),x=m.getResolution(p);let R=Math.round(d/x)||1,_=t.extent;if(void 0!==i.extent&&(_=(0,h.getIntersection)(_,i.extent)),(0,h.isEmpty)(_))return!1;const E=m.getTileRangeForExtentAndZ(_,p),w=m.getTileRangeExtent(p,E),v=T.getTilePixelRatio(n),y={};y[p]={};const I=this.createLoadedTileFinder(T,a,y),j=t.viewHints,C=j[l.default.ANIMATING]||j[l.default.INTERACTING],D=this.tmpExtent,S=this.tmpTileRange_;let L,q,A;for(this.newTiles_=!1,q=E.minX;q<=E.maxX;++q)for(A=E.minY;A<=E.maxY;++A){if(Date.now()-t.time>16&&C)continue;if(L=this.getTile(p,q,A,n,a),this.isDrawableTile_(L)){const i=(0,e.getUid)(this);if(L.getState()==o.default.LOADED){y[p][L.tileCoord.toString()]=L;const e=L.inTransition(i);this.newTiles_||!e&&-1!==this.renderedTiles.indexOf(L)||(this.newTiles_=!0)}if(1===L.getAlpha(i,t.time))continue}const i=m.getTileCoordChildTileRange(L.tileCoord,S,D);let r=!1;i&&(r=I(p+1,i)),r||m.forEachTileCoordParentTileRange(L.tileCoord,I,null,S,D)}const O=x*n/v*R;if(!(this.renderedResolution&&Date.now()-t.time>16&&C)&&(this.newTiles_||!this.renderedExtent_||!(0,h.containsExtent)(this.renderedExtent_,_)||this.renderedRevision!=f||R!=this.oversampling_||!C&&O!=this.renderedResolution)){const e=this.context;if(e){const t=T.getTilePixelSize(p,n,a),i=Math.round(E.getWidth()*t[0]/R),r=Math.round(E.getHeight()*t[1]/R),s=e.canvas;s.width!=i||s.height!=r?(this.oversampling_=R,s.width=i,s.height=r):(this.renderedExtent_&&!(0,h.equals)(w,this.renderedExtent_)&&e.clearRect(0,0,i,r),R=this.oversampling_)}this.renderedTiles.length=0;const r=Object.keys(y).map(Number);let s,o,l,d,u,g,c,_,I,j,C;for(r.sort(function(e,t){return e===p?1:t===p?-1:e>t?1:e<t?-1:0}),u=0,g=r.length;u<g;++u){d=r[u],l=T.getTilePixelSize(d,n,a),o=(s=m.getResolution(d))/x,_=v*T.getGutter(a),I=y[d];for(const e in I)L=I[e],q=((c=m.getTileCoordExtent(L.getTileCoord(),D))[0]-w[0])/x*v/R,A=(w[3]-c[3])/x*v/R,j=l[0]*o/R,C=l[1]*o/R,this.drawTileImage(L,t,i,q,A,j,C,_,p===d),this.renderedTiles.push(L)}this.renderedRevision=f,this.renderedResolution=x*n/v*R,this.renderedExtent_=w}const P=this.renderedResolution/d,b=(0,c.compose)(this.imageTransform_,n*r[0]/2,n*r[1]/2,P,P,0,(this.renderedExtent_[0]-u[0])/this.renderedResolution*n,(u[1]-this.renderedExtent_[3])/this.renderedResolution*n);return(0,c.compose)(this.coordinateToCanvasPixelTransform,n*r[0]/2-b[4],n*r[1]/2-b[5],n/d,-n/d,0,-u[0],-u[1]),this.updateUsedTiles(t.usedTiles,T,p,E),this.manageTilePyramid(t,T,m,n,a,_,p,g.getPreload()),this.scheduleExpireCache(t,T),this.renderedTiles.length>0},f.prototype.drawTileImage=function(t,i,n,r,s,o,a,l,d){const h=t.getImage(this.getLayer());if(!h)return;const u=(0,e.getUid)(this),g=d?t.getAlpha(u,i.time):1;1!==g||this.getLayer().getSource().getOpaque(i.viewState.projection)||this.context.clearRect(r,s,o,a);const c=g!==this.context.globalAlpha;c&&(this.context.save(),this.context.globalAlpha=g),this.context.drawImage(h,l,l,h.width-2*l,h.height-2*l,r,s,o,a),c&&this.context.restore(),1!==g?i.animate=!0:d&&t.endTransition(u)},f.prototype.getImage=function(){const e=this.context;return e?e.canvas:null},f.prototype.getLayer,f.prototype.getImageTransform=function(){return this.imageTransform_},exports.default=f;
},{"../../util.js":43,"../../LayerType.js":73,"../../TileRange.js":38,"../../TileState.js":92,"../../ViewHint.js":102,"../../dom.js":93,"../../extent.js":90,"../canvas/IntermediateCanvas.js":220,"../../transform.js":105}],259:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(){};t.prototype.getReplay=function(t,e){},t.prototype.isEmpty=function(){},exports.default=t;
},{}],224:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};
},{}],290:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.drawTextOnPath=a;var t=require("../../math.js");function a(a,e,h,r,o,s,n,M){const l=[],p=a[e]>a[h-r],u=o.length;let c,i,P,f=a[e],I=a[e+1],w=a[e+=r],d=a[e+1],q=0,v=Math.sqrt(Math.pow(w-f,2)+Math.pow(d-I,2)),x="",b=0;for(let j=0;j<u;++j){i=p?u-j-1:j;const O=o.charAt(i),_=s(x=p?O+x:x+O)-b;b+=_;const g=n+_/2;for(;e<h-r&&q+v<g;)f=w,I=d,w=a[e+=r],d=a[e+1],q+=v,v=Math.sqrt(Math.pow(w-f,2)+Math.pow(d-I,2));const m=g-q;let y=Math.atan2(d-I,w-f);if(p&&(y+=y>0?-Math.PI:Math.PI),void 0!==P){let t=y-P;if(t+=t>Math.PI?-2*Math.PI:t<-Math.PI?2*Math.PI:0,Math.abs(t)>M)return null}const A=m/v,T=(0,t.lerp)(f,w,A),k=(0,t.lerp)(I,d,A);P==y?(p&&(c[0]=T,c[1]=k,c[2]=_/2),c[4]=x):(b=_,c=[T,k,_/2,y,x=O],p?l.unshift(c):l.push(c),P=y),n+=_}return l}
},{"../../math.js":87}],291:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},E=exports.fillInstruction=[t.FILL],e=exports.strokeInstruction=[t.STROKE],_=exports.beginPathInstruction=[t.BEGIN_PATH],s=exports.closePathInstruction=[t.CLOSE_PATH];exports.default=t;
},{}],225:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TEXT_ALIGN=exports.ORDER=void 0;var e=require("../render/ReplayType.js"),t=r(e);function r(e){return e&&e.__esModule?e:{default:e}}const d=exports.ORDER=[t.default.POLYGON,t.default.CIRCLE,t.default.LINE_STRING,t.default.IMAGE,t.default.TEXT,t.default.DEFAULT],a=exports.TEXT_ALIGN={};a.left=0,a.end=0,a.center=.5,a.right=1,a.start=1,a.top=0,a.middle=.5,a.hanging=.2,a.alphabetic=.8,a.ideographic=.8,a.bottom=1;
},{"../render/ReplayType.js":224}],260:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../util.js"),e=require("../../functions.js"),i=require("../../array.js"),n=require("../../colorlike.js"),s=require("../../extent.js"),o=require("../../extent/Relationship.js"),r=S(o),l=require("../../geom/GeometryType.js"),a=S(l),h=require("../../geom/flat/inflate.js"),u=require("../../geom/flat/length.js"),c=require("../../geom/flat/textpath.js"),d=require("../../geom/flat/transform.js"),f=require("../../has.js"),p=require("../../obj.js"),y=require("../VectorContext.js"),g=S(y),_=require("../canvas.js"),m=require("../canvas/Instruction.js"),E=S(m),x=require("../replay.js"),L=require("../../transform.js");function S(t){return t&&t.__esModule?t:{default:t}}const T=function(t,e,i,n,s,o){g.default.call(this),this.declutterTree=o,this.tolerance=t,this.maxExtent=e,this.overlaps=s,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.alignFill_,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.coordinateCache_={},this.renderedTransform_=(0,L.create)(),this.hitDetectionInstructions=[],this.pixelCoordinates_=null,this.state={},this.viewRotation_=0};(0,t.inherits)(T,g.default);const C=(0,s.createEmpty)(),I=(0,L.create)();T.prototype.replayTextBackground_=function(t,e,i,n,s,o,r){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,s),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),r&&(this.setStrokeStyle_(t,r),t.stroke())},T.prototype.replayImage_=function(t,e,i,n,o,r,l,a,h,u,c,d,f,p,y,g,m,E){const x=m||E;e-=o*=f,i-=r*=f;const S=y+u>n.width?n.width-u:y,T=a+c>n.height?n.height-c:a,O=g[3]+S*f+g[1],k=g[0]+T*f+g[2],D=e-g[3],b=i-g[0];let v,G,M,R;(x||0!==d)&&(v=[D,b],G=[D+O,b],M=[D+O,b+k],R=[D,b+k]);let N=null;if(0!==d){const t=e+o,n=i+r;N=(0,L.compose)(I,t,n,1,1,d,-t,-n),(0,s.createOrUpdateEmpty)(C),(0,s.extendCoordinate)(C,(0,L.apply)(I,v)),(0,s.extendCoordinate)(C,(0,L.apply)(I,G)),(0,s.extendCoordinate)(C,(0,L.apply)(I,M)),(0,s.extendCoordinate)(C,(0,L.apply)(I,R))}else(0,s.createOrUpdate)(D,b,D+O,b+k,C);const F=t.canvas,q=E?E[2]*f/2:0,j=C[0]-q<=F.width&&C[2]+q>=0&&C[1]-q<=F.height&&C[3]+q>=0;if(p&&(e=Math.round(e),i=Math.round(i)),l){if(!j&&1==l[4])return;(0,s.extend)(l,C);const o=j?[t,N?N.slice(0):null,h,n,u,c,S,T,e,i,f]:null;o&&x&&o.push(m,E,v,G,M,R),l.push(o)}else j&&(x&&this.replayTextBackground_(t,v,G,M,R,m,E),(0,_.drawImage)(t,N,h,n,u,c,S,T,e,i,f))},T.prototype.applyPixelRatio=function(t){const e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})},T.prototype.appendFlatCoordinates=function(t,e,i,n,o,l){let a=this.coordinates.length;const h=this.getBufferedMaxExtent();l&&(e+=n);const u=[t[e],t[e+1]],c=[NaN,NaN];let d,f,p,y=!0;for(d=e+n;d<i;d+=n)c[0]=t[d],c[1]=t[d+1],(p=(0,s.coordinateRelationship)(h,c))!==f?(y&&(this.coordinates[a++]=u[0],this.coordinates[a++]=u[1]),this.coordinates[a++]=c[0],this.coordinates[a++]=c[1],y=!1):p===r.default.INTERSECTING?(this.coordinates[a++]=c[0],this.coordinates[a++]=c[1],y=!1):y=!0,u[0]=c[0],u[1]=c[1],f=p;return(o&&y||d===e+n)&&(this.coordinates[a++]=u[0],this.coordinates[a++]=u[1]),a},T.prototype.drawCustomCoordinates_=function(t,e,i,n,s){for(let o=0,r=i.length;o<r;++o){const r=i[o],l=this.appendFlatCoordinates(t,e,r,n,!1,!1);s.push(l),e=r}return e},T.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);const n=t.getType(),s=t.getStride(),o=this.coordinates.length;let r,l,u,c,d;if(n==a.default.MULTI_POLYGON){r=(t=t).getOrientedFlatCoordinates(),c=[];const e=t.getEndss();d=0;for(let t=0,i=e.length;t<i;++t){const i=[];d=this.drawCustomCoordinates_(r,d,e[t],s,i),c.push(i)}this.instructions.push([E.default.CUSTOM,o,c,t,i,h.inflateMultiCoordinatesArray])}else n==a.default.POLYGON||n==a.default.MULTI_LINE_STRING?(u=[],r=n==a.default.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(r,0,t.getEnds(),s,u),this.instructions.push([E.default.CUSTOM,o,u,t,i,h.inflateCoordinatesArray])):n==a.default.LINE_STRING||n==a.default.MULTI_POINT?(r=t.getFlatCoordinates(),l=this.appendFlatCoordinates(r,0,r.length,s,!1,!1),this.instructions.push([E.default.CUSTOM,o,l,t,i,h.inflateCoordinates])):n==a.default.POINT&&(r=t.getFlatCoordinates(),this.coordinates.push(r[0],r[1]),l=this.coordinates.length,this.instructions.push([E.default.CUSTOM,o,l,t,i]));this.endGeometry(t,e)},T.prototype.beginGeometry=function(t,e){this.beginGeometryInstruction1_=[E.default.BEGIN_GEOMETRY,e,0],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[E.default.BEGIN_GEOMETRY,e,0],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},T.prototype.fill_=function(t){if(this.alignFill_){const e=(0,L.apply)(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.setTransform.apply(t,_.resetTransform)},T.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],f.CANVAS_LINE_DASH&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},T.prototype.renderDeclutter_=function(t,e){if(t&&t.length>5){const i=t[4];if(1==i||i==t.length-5){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};if(!this.declutterTree.collides(i)){this.declutterTree.insert(i);for(let e=5,i=t.length;e<i;++e){const i=t[e];i&&(i.length>11&&this.replayTextBackground_(i[0],i[13],i[14],i[15],i[16],i[11],i[12]),_.drawImage.apply(void 0,i))}}t.length=5,(0,s.createOrUpdateEmpty)(t)}}},T.prototype.replay_=function(e,n,o,r,l,a){let h;this.pixelCoordinates_&&(0,i.equals)(n,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=(0,d.transform2D)(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),(0,L.setFromArray)(this.renderedTransform_,n));const f=!(0,p.isEmpty)(o);let y=0;const g=r.length;let m,S,T,C,I,O,k,D,b,v=0,G=0,M=0,R=null,N=null;const F=this.coordinateCache_,q=this.viewRotation_,j={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:q},w=this.instructions!=r||this.overlaps?0:200;let P,W,Y;for(;y<g;){const i=r[y];switch(i[0]){case E.default.BEGIN_GEOMETRY:P=i[1],f&&o[(0,t.getUid)(P).toString()]||!P.getGeometry()?y=i[2]:void 0===a||(0,s.intersects)(a,P.getGeometry().getExtent())?++y:y=i[2]+1;break;case E.default.BEGIN_PATH:G>w&&(this.fill_(e),G=0),M>w&&(e.stroke(),M=0),G||M||(e.beginPath(),C=I=NaN),++y;break;case E.default.CIRCLE:const n=h[v=i[1]],r=h[v+1],d=h[v+2]-n,p=h[v+3]-r,g=Math.sqrt(d*d+p*p);e.moveTo(n+g,r),e.arc(n,r,g,0,2*Math.PI,!0),++y;break;case E.default.CLOSE_PATH:e.closePath(),++y;break;case E.default.CUSTOM:v=i[1],m=i[2];const L=i[3],A=i[4],U=6==i.length?i[5]:void 0;j.geometry=L,j.feature=P,y in F||(F[y]=[]);const B=F[y];U?U(h,v,m,2,B):(B[0]=h[v],B[1]=h[v+1],B.length=2),A(B,j),++y;break;case E.default.DRAW_IMAGE:v=i[1],m=i[2],b=i[3],S=i[4],T=i[5],D=l?null:i[6];const J=i[7],H=i[8],K=i[9],V=i[10],X=i[11];let z=i[12];const Q=i[13],Z=i[14],$=i[15];let tt,et,it;for(i.length>16?(tt=i[16],et=i[17],it=i[18]):(tt=_.defaultPadding,et=it=!1),X&&(z+=q);v<m;v+=2)this.replayImage_(e,h[v],h[v+1],b,S,T,D,J,H,K,V,z,Q,Z,$,tt,et?R:null,it?N:null);this.renderDeclutter_(D,P),++y;break;case E.default.DRAW_CHARS:const nt=i[1],st=i[2],ot=i[3];D=l?null:i[4];const rt=i[5],lt=i[6],at=i[7],ht=i[8],ut=i[9],ct=i[10],dt=i[11],ft=i[12],pt=i[13],yt=i[14],gt=(0,u.lineStringLength)(h,nt,st,2),_t=ht(ft);if(rt||_t<=gt){const t=this.textStates[pt].textAlign,i=(gt-_t)*x.TEXT_ALIGN[t],n=(0,c.drawTextOnPath)(h,nt,st,2,ft,ht,i,at);if(n){let t,i,s,o,r;if(ct)for(t=0,i=n.length;t<i;++t)s=(r=n[t])[4],o=this.getImage(s,pt,"",ct),S=r[2]+dt,T=ot*o.height+2*(.5-ot)*dt-ut,this.replayImage_(e,r[0],r[1],o,S,T,D,o.height,1,0,0,r[3],yt,!1,o.width,_.defaultPadding,null,null);if(lt)for(t=0,i=n.length;t<i;++t)s=(r=n[t])[4],o=this.getImage(s,pt,lt,""),S=r[2],T=ot*o.height-ut,this.replayImage_(e,r[0],r[1],o,S,T,D,o.height,1,0,0,r[3],yt,!1,o.width,_.defaultPadding,null,null)}}this.renderDeclutter_(D,P),++y;break;case E.default.END_GEOMETRY:if(void 0!==l){const t=l(P=i[1]);if(t)return t}++y;break;case E.default.FILL:w?G++:this.fill_(e),++y;break;case E.default.MOVE_TO_LINE_TO:for(v=i[1],m=i[2],W=h[v],k=(Y=h[v+1])+.5|0,(O=W+.5|0)===C&&k===I||(e.moveTo(W,Y),C=O,I=k),v+=2;v<m;v+=2)O=(W=h[v])+.5|0,k=(Y=h[v+1])+.5|0,v!=m-2&&O===C&&k===I||(e.lineTo(W,Y),C=O,I=k);++y;break;case E.default.SET_FILL_STYLE:R=i,this.alignFill_=i[2],G&&(this.fill_(e),G=0,M&&(e.stroke(),M=0)),e.fillStyle=i[1],++y;break;case E.default.SET_STROKE_STYLE:N=i,M&&(e.stroke(),M=0),this.setStrokeStyle_(e,i),++y;break;case E.default.STROKE:w?M++:e.stroke(),++y;break;default:++y}}G&&this.fill_(e),M&&e.stroke()},T.prototype.replay=function(t,e,i,n){this.viewRotation_=i,this.replay_(t,e,n,this.instructions,void 0,void 0)},T.prototype.replayHitDetection=function(t,e,i,n,s,o){return this.viewRotation_=i,this.replay_(t,e,n,this.hitDetectionInstructions,s,o)},T.prototype.reverseHitDetectionInstructions=function(){const t=this.hitDetectionInstructions;let e;t.reverse();const n=t.length;let s,o,r=-1;for(e=0;e<n;++e)(o=(s=t[e])[0])==E.default.END_GEOMETRY?r=e:o==E.default.BEGIN_GEOMETRY&&(s[2]=e,(0,i.reverseSubArray)(this.hitDetectionInstructions,r,e),r=-1)},T.prototype.setFillStrokeStyle=function(t,e){const i=this.state;if(t){const e=t.getColor();i.fillStyle=(0,n.asColorLike)(e||_.defaultFillStyle)}else i.fillStyle=void 0;if(e){const t=e.getColor();i.strokeStyle=(0,n.asColorLike)(t||_.defaultStrokeStyle);const s=e.getLineCap();i.lineCap=void 0!==s?s:_.defaultLineCap;const o=e.getLineDash();i.lineDash=o?o.slice():_.defaultLineDash;const r=e.getLineDashOffset();i.lineDashOffset=r||_.defaultLineDashOffset;const l=e.getLineJoin();i.lineJoin=void 0!==l?l:_.defaultLineJoin;const a=e.getWidth();i.lineWidth=void 0!==a?a:_.defaultLineWidth;const h=e.getMiterLimit();i.miterLimit=void 0!==h?h:_.defaultMiterLimit,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},T.prototype.createFill=function(t,e){const i=t.fillStyle,n=[E.default.SET_FILL_STYLE,i];return"string"!=typeof i&&n.push(!0),n},T.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},T.prototype.createStroke=function(t){return[E.default.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},T.prototype.updateFillStyle=function(t,e,i){const n=t.fillStyle;"string"==typeof n&&t.currentFillStyle==n||(void 0!==n&&this.instructions.push(e.call(this,t,i)),t.currentFillStyle=n)},T.prototype.updateStrokeStyle=function(t,e){const n=t.strokeStyle,s=t.lineCap,o=t.lineDash,r=t.lineDashOffset,l=t.lineJoin,a=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=s||o!=t.currentLineDash&&!(0,i.equals)(t.currentLineDash,o)||t.currentLineDashOffset!=r||t.currentLineJoin!=l||t.currentLineWidth!=a||t.currentMiterLimit!=h)&&(void 0!==n&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=s,t.currentLineDash=o,t.currentLineDashOffset=r,t.currentLineJoin=l,t.currentLineWidth=a,t.currentMiterLimit=h)},T.prototype.endGeometry=function(t,e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const i=[E.default.END_GEOMETRY,e];this.instructions.push(i),this.hitDetectionInstructions.push(i)},T.prototype.finish=e.UNDEFINED,T.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,s.clone)(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;(0,s.buffer)(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},exports.default=T;
},{"../../util.js":43,"../../functions.js":103,"../../array.js":130,"../../colorlike.js":257,"../../extent.js":90,"../../extent/Relationship.js":190,"../../geom/GeometryType.js":140,"../../geom/flat/inflate.js":200,"../../geom/flat/length.js":206,"../../geom/flat/textpath.js":290,"../../geom/flat/transform.js":192,"../../has.js":86,"../../obj.js":74,"../VectorContext.js":258,"../canvas.js":217,"../canvas/Instruction.js":291,"../replay.js":225,"../../transform.js":105}],261:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../util.js"),i=require("../canvas/Instruction.js"),h=o(i),e=require("../canvas/Replay.js"),s=o(e);function o(t){return t&&t.__esModule?t:{default:t}}const n=function(t,i,h,e,o,n){s.default.call(this,t,i,h,e,o,n),this.declutterGroup_=null,this.hitDetectionImage_=null,this.image_=null,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.snapToPixel_=void 0,this.width_=void 0};(0,t.inherits)(n,s.default),n.prototype.drawCoordinates_=function(t,i,h,e){return this.appendFlatCoordinates(t,i,h,e,!1,!1)},n.prototype.drawPoint=function(t,i){if(!this.image_)return;this.beginGeometry(t,i);const e=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,n=this.drawCoordinates_(e,0,e.length,s);this.instructions.push([h.default.DRAW_IMAGE,o,n,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.snapToPixel_,this.width_]),this.hitDetectionInstructions.push([h.default.DRAW_IMAGE,o,n,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]),this.endGeometry(t,i)},n.prototype.drawMultiPoint=function(t,i){if(!this.image_)return;this.beginGeometry(t,i);const e=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,n=this.drawCoordinates_(e,0,e.length,s);this.instructions.push([h.default.DRAW_IMAGE,o,n,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.snapToPixel_,this.width_]),this.hitDetectionInstructions.push([h.default.DRAW_IMAGE,o,n,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]),this.endGeometry(t,i)},n.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.snapToPixel_=void 0,this.width_=void 0},n.prototype.setImageStyle=function(t,i){const h=t.getAnchor(),e=t.getSize(),s=t.getHitDetectionImage(1),o=t.getImage(1),n=t.getOrigin();this.anchorX_=h[0],this.anchorY_=h[1],this.declutterGroup_=i,this.hitDetectionImage_=s,this.image_=o,this.height_=e[1],this.opacity_=t.getOpacity(),this.originX_=n[0],this.originY_=n[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.snapToPixel_=t.getSnapToPixel(),this.width_=e[0]},exports.default=n;
},{"../../util.js":43,"../canvas/Instruction.js":291,"../canvas/Replay.js":260}],262:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../util.js"),e=require("../canvas/Instruction.js"),i=o(e),s=require("../canvas/Replay.js"),n=o(s);function o(t){return t&&t.__esModule?t:{default:t}}const r=function(t,e,i,s,o,r){n.default.call(this,t,e,i,s,o,r)};(0,t.inherits)(r,n.default),r.prototype.drawFlatCoordinates_=function(t,e,s,n){const o=this.coordinates.length,r=this.appendFlatCoordinates(t,e,s,n,!1,!1),l=[i.default.MOVE_TO_LINE_TO,o,r];return this.instructions.push(l),this.hitDetectionInstructions.push(l),s},r.prototype.drawLineString=function(t,s){const n=this.state,o=n.strokeStyle,r=n.lineWidth;if(void 0===o||void 0===r)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,s),this.hitDetectionInstructions.push([i.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],e.beginPathInstruction);const l=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(l,0,l.length,a),this.hitDetectionInstructions.push(e.strokeInstruction),this.endGeometry(t,s)},r.prototype.drawMultiLineString=function(t,s){const n=this.state,o=n.strokeStyle,r=n.lineWidth;if(void 0===o||void 0===r)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,s),this.hitDetectionInstructions.push([i.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],e.beginPathInstruction);const l=t.getEnds(),a=t.getFlatCoordinates(),h=t.getStride();let u=0;for(let t=0,e=l.length;t<e;++t)u=this.drawFlatCoordinates_(a,u,l[t],h);this.hitDetectionInstructions.push(e.strokeInstruction),this.endGeometry(t,s)},r.prototype.finish=function(){const t=this.state;null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(e.strokeInstruction),this.reverseHitDetectionInstructions(),this.state=null},r.prototype.applyStroke=function(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(e.strokeInstruction),t.lastStroke=this.coordinates.length),t.lastStroke=0,n.default.prototype.applyStroke.call(this,t),this.instructions.push(e.beginPathInstruction)},exports.default=r;
},{"../../util.js":43,"../canvas/Instruction.js":291,"../canvas/Replay.js":260}],263:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../util.js"),i=require("../../color.js"),e=require("../../geom/flat/simplify.js"),s=require("../canvas.js"),n=require("../canvas/Instruction.js"),o=h(n),l=require("../canvas/Replay.js"),r=h(l);function h(t){return t&&t.__esModule?t:{default:t}}const u=function(t,i,e,s,n,o){r.default.call(this,t,i,e,s,n,o)};(0,t.inherits)(u,r.default),u.prototype.drawFlatCoordinatess_=function(t,i,e,s){const l=this.state,r=void 0!==l.fillStyle,h=null!=l.strokeStyle,u=e.length;this.instructions.push(n.beginPathInstruction),this.hitDetectionInstructions.push(n.beginPathInstruction);for(let l=0;l<u;++l){const r=e[l],u=this.coordinates.length,c=this.appendFlatCoordinates(t,i,r,s,!0,!h),a=[o.default.MOVE_TO_LINE_TO,u,c];this.instructions.push(a),this.hitDetectionInstructions.push(a),h&&(this.instructions.push(n.closePathInstruction),this.hitDetectionInstructions.push(n.closePathInstruction)),i=r}return r&&(this.instructions.push(n.fillInstruction),this.hitDetectionInstructions.push(n.fillInstruction)),h&&(this.instructions.push(n.strokeInstruction),this.hitDetectionInstructions.push(n.strokeInstruction)),i},u.prototype.drawCircle=function(t,e){const l=this.state,r=l.fillStyle,h=l.strokeStyle;if(void 0===r&&void 0===h)return;this.setFillStrokeStyles_(t),this.beginGeometry(t,e),void 0!==l.fillStyle&&this.hitDetectionInstructions.push([o.default.SET_FILL_STYLE,(0,i.asString)(s.defaultFillStyle)]),void 0!==l.strokeStyle&&this.hitDetectionInstructions.push([o.default.SET_STROKE_STYLE,l.strokeStyle,l.lineWidth,l.lineCap,l.lineJoin,l.miterLimit,l.lineDash,l.lineDashOffset]);const u=t.getFlatCoordinates(),c=t.getStride(),a=this.coordinates.length;this.appendFlatCoordinates(u,0,u.length,c,!1,!1);const d=[o.default.CIRCLE,a];this.instructions.push(n.beginPathInstruction,d),this.hitDetectionInstructions.push(n.beginPathInstruction,d),this.hitDetectionInstructions.push(n.fillInstruction),void 0!==l.fillStyle&&this.instructions.push(n.fillInstruction),void 0!==l.strokeStyle&&(this.instructions.push(n.strokeInstruction),this.hitDetectionInstructions.push(n.strokeInstruction)),this.endGeometry(t,e)},u.prototype.drawPolygon=function(t,e){const n=this.state,l=n.fillStyle,r=n.strokeStyle;if(void 0===l&&void 0===r)return;this.setFillStrokeStyles_(t),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([o.default.SET_FILL_STYLE,(0,i.asString)(s.defaultFillStyle)]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([o.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);const h=t.getEnds(),u=t.getOrientedFlatCoordinates(),c=t.getStride();this.drawFlatCoordinatess_(u,0,h,c),this.endGeometry(t,e)},u.prototype.drawMultiPolygon=function(t,e){const n=this.state,l=n.fillStyle,r=n.strokeStyle;if(void 0===l&&void 0===r)return;this.setFillStrokeStyles_(t),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([o.default.SET_FILL_STYLE,(0,i.asString)(s.defaultFillStyle)]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([o.default.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);const h=t.getEndss(),u=t.getOrientedFlatCoordinates(),c=t.getStride();let a=0;for(let t=0,i=h.length;t<i;++t)a=this.drawFlatCoordinatess_(u,a,h[t],c);this.endGeometry(t,e)},u.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const i=this.coordinates;for(let s=0,n=i.length;s<n;++s)i[s]=(0,e.snap)(i[s],t)}},u.prototype.setFillStrokeStyles_=function(t){const i=this.state;void 0!==i.fillStyle&&this.updateFillStyle(i,this.createFill,t),void 0!==i.strokeStyle&&this.updateStrokeStyle(i,this.applyStroke)},exports.default=u;
},{"../../util.js":43,"../../color.js":209,"../../geom/flat/simplify.js":204,"../canvas.js":217,"../canvas/Instruction.js":291,"../canvas/Replay.js":260}],293:[function(require,module,exports) {
"use strict";function t(t,e,o,r,s){let n,c,i,u,a,d,h,f,l,p,v=o,M=o,x=0,_=0,b=o;for(c=o;c<r;c+=s){const o=e[c],r=e[c+1];void 0!==a&&(l=o-a,p=r-d,u=Math.sqrt(l*l+p*p),void 0!==h&&(_+=i,(n=Math.acos((h*l+f*p)/(i*u)))>t&&(_>x&&(x=_,v=b,M=c),_=0,b=c-s)),i=u,h=l,f=p),a=o,d=r}return(_+=u)>x?[b,c]:[v,M]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.matchingChunk=t;
},{}],264:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.measureTextWidths=p;var t=require("../../util.js"),e=require("../../colorlike.js"),i=require("../../dom.js"),s=require("../../extent.js"),l=require("../../geom/flat/straightchunk.js"),n=require("../../geom/GeometryType.js"),a=_(n),o=require("../../has.js"),h=require("../canvas.js"),r=require("../canvas/Instruction.js"),f=_(r),u=require("../canvas/Replay.js"),d=_(u),c=require("../replay.js"),g=require("../../style/TextPlacement.js"),x=_(g);function _(t){return t&&t.__esModule?t:{default:t}}const S=function(t,e,i,s,l,n){d.default.call(this,t,e,i,s,l,n),this.declutterGroup_,this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.widths_={},h.labelCache.prune()};function p(t,e,i){const s=e.length;let l=0;for(let n=0;n<s;++n){const s=(0,h.measureTextWidth)(t,e[n]);l=Math.max(l,s),i.push(s)}return l}(0,t.inherits)(S,d.default),S.prototype.drawText=function(t,e){const i=this.textFillState_,n=this.textStrokeState_,o=this.textState_;if(""===this.text_||!o||!i&&!n)return;let h=this.coordinates.length;const r=t.getType();let f,u,d=null,c=2,g=2;if(o.placement===x.default.LINE){if(!(0,s.intersects)(this.getBufferedMaxExtent(),t.getExtent()))return;let i;if(d=t.getFlatCoordinates(),g=t.getStride(),r==a.default.LINE_STRING)i=[d.length];else if(r==a.default.MULTI_LINE_STRING)i=t.getEnds();else if(r==a.default.POLYGON)i=t.getEnds().slice(0,1);else if(r==a.default.MULTI_POLYGON){const e=t.getEndss();for(i=[],f=0,u=e.length;f<u;++f)i.push(e[f][0])}this.beginGeometry(t,e);const n=o.textAlign;let x,_=0;for(let t=0,e=i.length;t<e;++t){if(null==n){const e=(0,l.matchingChunk)(o.maxAngle,d,_,i[t],g);_=e[0],x=e[1]}else x=i[t];for(f=_;f<x;f+=g)this.coordinates.push(d[f],d[f+1]);c=this.coordinates.length,_=i[t],this.drawChars_(h,c,this.declutterGroup_),h=c}this.endGeometry(t,e)}else{const i=this.getImage(this.text_,this.textKey_,this.fillKey_,this.strokeKey_),s=i.width/this.pixelRatio;switch(r){case a.default.POINT:case a.default.MULTI_POINT:c=(d=t.getFlatCoordinates()).length;break;case a.default.LINE_STRING:d=t.getFlatMidpoint();break;case a.default.CIRCLE:d=t.getCenter();break;case a.default.MULTI_LINE_STRING:c=(d=t.getFlatMidpoints()).length;break;case a.default.POLYGON:if(d=t.getFlatInteriorPoint(),!o.overflow&&d[2]/this.resolution<s)return;g=3;break;case a.default.MULTI_POLYGON:const e=t.getFlatInteriorPoints();for(d=[],f=0,u=e.length;f<u;f+=3)(o.overflow||e[f+2]/this.resolution>=s)&&d.push(e[f],e[f+1]);if(0==(c=d.length))return}c=this.appendFlatCoordinates(d,0,c,g,!1,!1),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&(this.updateFillStyle(this.state,this.createFill,t),this.hitDetectionInstructions.push(this.createFill(this.state,t))),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e),this.drawTextImage_(i,h,c),this.endGeometry(t,e)}},S.prototype.getImage=function(t,e,s,l){let n;const a=l+e+t+s+this.pixelRatio;if(!h.labelCache.containsKey(a)){const r=l?this.strokeStates[l]||this.textStrokeState_:null,f=s?this.fillStates[s]||this.textFillState_:null,u=this.textStates[e]||this.textState_,d=this.pixelRatio,g=u.scale*d,x=c.TEXT_ALIGN[u.textAlign||h.defaultTextAlign],_=l&&r.lineWidth?r.lineWidth:0,S=t.split("\n"),k=S.length,y=[],m=p(u.font,S,y),L=(0,h.measureTextHeight)(u.font),T=L*k,I=m+_,A=(0,i.createCanvasContext2D)(Math.ceil(I*g),Math.ceil((T+_)*g));n=A.canvas,h.labelCache.set(a,n),1!=g&&A.scale(g,g),A.font=u.font,l&&(A.strokeStyle=r.strokeStyle,A.lineWidth=_,A.lineCap=r.lineCap,A.lineJoin=r.lineJoin,A.miterLimit=r.miterLimit,o.CANVAS_LINE_DASH&&r.lineDash.length&&(A.setLineDash(r.lineDash),A.lineDashOffset=r.lineDashOffset)),s&&(A.fillStyle=f.fillStyle),A.textBaseline="middle",A.textAlign="center";const O=.5-x,C=x*n.width/g+O*_;let F;if(l)for(F=0;F<k;++F)A.strokeText(S[F],C+O*y[F],.5*(_+L)+F*L);if(s)for(F=0;F<k;++F)A.fillText(S[F],C+O*y[F],.5*(_+L)+F*L)}return h.labelCache.get(a)},S.prototype.drawTextImage_=function(t,e,i){const s=this.textState_,l=this.textStrokeState_,n=this.pixelRatio,a=c.TEXT_ALIGN[s.textAlign||h.defaultTextAlign],o=c.TEXT_ALIGN[s.textBaseline],r=l&&l.lineWidth?l.lineWidth:0,u=a*t.width/n+2*(.5-a)*r,d=o*t.height/n+2*(.5-o)*r;this.instructions.push([f.default.DRAW_IMAGE,e,i,t,(u-this.textOffsetX_)*n,(d-this.textOffsetY_)*n,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1,!0,t.width,s.padding==h.defaultPadding?h.defaultPadding:s.padding.map(function(t){return t*n}),!!s.backgroundFill,!!s.backgroundStroke]),this.hitDetectionInstructions.push([f.default.DRAW_IMAGE,e,i,t,(u-this.textOffsetX_)*n,(d-this.textOffsetY_)*n,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1/n,!0,t.width,s.padding,!!s.backgroundFill,!!s.backgroundStroke])},S.prototype.drawChars_=function(t,e,i){const s=this.textStrokeState_,l=this.textState_,n=this.textFillState_,a=this.strokeKey_;s&&(a in this.strokeStates||(this.strokeStates[a]={strokeStyle:s.strokeStyle,lineCap:s.lineCap,lineDashOffset:s.lineDashOffset,lineWidth:s.lineWidth,lineJoin:s.lineJoin,miterLimit:s.miterLimit,lineDash:s.lineDash}));const o=this.textKey_;this.textKey_ in this.textStates||(this.textStates[this.textKey_]={font:l.font,textAlign:l.textAlign||h.defaultTextAlign,scale:l.scale});const r=this.fillKey_;n&&(r in this.fillStates||(this.fillStates[r]={fillStyle:n.fillStyle}));const u=this.pixelRatio,d=c.TEXT_ALIGN[l.textBaseline],g=this.textOffsetY_*u,x=this.text_,_=l.font,S=l.scale,p=s?s.lineWidth*S/2:0;let k=this.widths_[_];k||(this.widths_[_]=k={}),this.instructions.push([f.default.DRAW_CHARS,t,e,d,i,l.overflow,r,l.maxAngle,function(t){let e=k[t];return e||(e=k[t]=(0,h.measureTextWidth)(_,t)),e*S*u},g,a,p*u,x,o,1]),this.hitDetectionInstructions.push([f.default.DRAW_CHARS,t,e,d,i,l.overflow,r,l.maxAngle,function(t){let e=k[t];return e||(e=k[t]=(0,h.measureTextWidth)(_,t)),e*S},g,a,p,x,o,1/u])},S.prototype.setTextStyle=function(i,s){let l,n,a;if(i){this.declutterGroup_=s;const o=i.getFill();o?((n=this.textFillState_)||(n=this.textFillState_={}),n.fillStyle=(0,e.asColorLike)(o.getColor()||h.defaultFillStyle)):n=this.textFillState_=null;const r=i.getStroke();if(r){(a=this.textStrokeState_)||(a=this.textStrokeState_={});const t=r.getLineDash(),i=r.getLineDashOffset(),s=r.getWidth(),l=r.getMiterLimit();a.lineCap=r.getLineCap()||h.defaultLineCap,a.lineDash=t?t.slice():h.defaultLineDash,a.lineDashOffset=void 0===i?h.defaultLineDashOffset:i,a.lineJoin=r.getLineJoin()||h.defaultLineJoin,a.lineWidth=void 0===s?h.defaultLineWidth:s,a.miterLimit=void 0===l?h.defaultMiterLimit:l,a.strokeStyle=(0,e.asColorLike)(r.getColor()||h.defaultStrokeStyle)}else a=this.textStrokeState_=null;l=this.textState_;const f=i.getFont()||h.defaultFont;(0,h.checkFont)(f);const u=i.getScale();l.overflow=i.getOverflow(),l.font=f,l.maxAngle=i.getMaxAngle(),l.placement=i.getPlacement(),l.textAlign=i.getTextAlign(),l.textBaseline=i.getTextBaseline()||h.defaultTextBaseline,l.backgroundFill=i.getBackgroundFill(),l.backgroundStroke=i.getBackgroundStroke(),l.padding=i.getPadding()||h.defaultPadding,l.scale=void 0===u?1:u;const d=i.getOffsetX(),c=i.getOffsetY(),g=i.getRotateWithView(),x=i.getRotation();this.text_=i.getText()||"",this.textOffsetX_=void 0===d?0:d,this.textOffsetY_=void 0===c?0:c,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===x?0:x,this.strokeKey_=a?("string"==typeof a.strokeStyle?a.strokeStyle:(0,t.getUid)(a.strokeStyle))+a.lineCap+a.lineDashOffset+"|"+a.lineWidth+a.lineJoin+a.miterLimit+"["+a.lineDash.join()+"]":"",this.textKey_=l.font+l.scale+(l.textAlign||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+(0,t.getUid)(n.fillStyle):""}else this.text_=""},exports.default=S;
},{"../../util.js":43,"../../colorlike.js":257,"../../dom.js":93,"../../extent.js":90,"../../geom/flat/straightchunk.js":293,"../../geom/GeometryType.js":140,"../../has.js":86,"../canvas.js":217,"../canvas/Instruction.js":291,"../canvas/Replay.js":260,"../replay.js":225,"../../style/TextPlacement.js":208}],227:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCircleArray=q,exports.replayDeclutter=C;var e=require("../../util.js"),t=require("../../array.js"),r=require("../../dom.js"),n=require("../../extent.js"),o=require("../../geom/flat/transform.js"),i=require("../../obj.js"),s=require("../ReplayGroup.js"),a=R(s),l=require("../ReplayType.js"),u=R(l),c=require("../canvas/Replay.js"),f=R(c),p=require("../canvas/ImageReplay.js"),h=R(p),y=require("../canvas/LineStringReplay.js"),d=R(y),_=require("../canvas/PolygonReplay.js"),x=R(_),m=require("../canvas/TextReplay.js"),g=R(m),v=require("../replay.js"),j=require("../../transform.js");function R(e){return e&&e.__esModule?e:{default:e}}const T={Circle:x.default,Default:f.default,Image:h.default,LineString:d.default,Polygon:x.default,Text:g.default},I=function(e,t,n,o,i,s,l){a.default.call(this),this.declutterTree_=s,this.declutterGroup_=null,this.tolerance_=e,this.maxExtent_=t,this.overlaps_=i,this.pixelRatio_=o,this.resolution_=n,this.renderBuffer_=l,this.replaysByZIndex_={},this.hitDetectionContext_=(0,r.createCanvasContext2D)(1,1),this.hitDetectionTransform_=(0,j.create)()};(0,e.inherits)(I,a.default);const E={0:[[!0]]};function B(e,t,r){let n;const o=Math.floor(e.length/2);if(t>=o)for(n=o;n<t;n++)e[n][r]=!0;else if(t<o)for(n=t+1;n<o;n++)e[n][r]=!0}function q(e){if(void 0!==E[e])return E[e];const t=2*e+1,r=new Array(t);for(let e=0;e<t;e++)r[e]=new Array(t);let n=e,o=0,i=0;for(;n>=o;)B(r,e+n,e+o),B(r,e+o,e+n),B(r,e-o,e+n),B(r,e-n,e+o),B(r,e-n,e-o),B(r,e-o,e-n),B(r,e+o,e-n),B(r,e+n,e-o),2*((i+=1+2*++o)-n)+1>0&&(i+=1-2*(n-=1));return E[e]=r,r}function C(e,r,n){const o=Object.keys(e).map(Number).sort(t.numberSafeCompareFunction),i={};for(let t=0,s=o.length;t<s;++t){const s=e[o[t].toString()];for(let e=0,t=s.length;e<t;){const t=s[e++],o=s[e++];t.replay(r,o,n,i)}}}I.prototype.addDeclutter=function(e){let t=null;return this.declutterTree_&&(e?(t=this.declutterGroup_)[4]++:(t=this.declutterGroup_=(0,n.createEmpty)()).push(1)),t},I.prototype.clip=function(e,t){const r=this.getClipCoords(t);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()},I.prototype.hasReplays=function(e){for(const t in this.replaysByZIndex_){const r=this.replaysByZIndex_[t];for(let t=0,n=e.length;t<n;++t)if(e[t]in r)return!0}return!1},I.prototype.finish=function(){for(const e in this.replaysByZIndex_){const t=this.replaysByZIndex_[e];for(const e in t)t[e].finish()}},I.prototype.forEachFeatureAtCoordinate=function(e,r,o,i,s,a,l){const c=2*(i=Math.round(i))+1,f=(0,j.compose)(this.hitDetectionTransform_,i+.5,i+.5,1/r,-1/r,-o,-e[0],-e[1]),p=this.hitDetectionContext_;let h;p.canvas.width!==c||p.canvas.height!==c?(p.canvas.width=c,p.canvas.height=c):p.clearRect(0,0,c,c),void 0!==this.renderBuffer_&&(h=(0,n.createEmpty)(),(0,n.extendCoordinate)(h,e),(0,n.buffer)(h,r*(this.renderBuffer_+i),h));const y=q(i);let d,_;function x(e){const t=p.getImageData(0,0,c,c).data;for(let r=0;r<c;r++)for(let n=0;n<c;n++)if(y[r][n]&&t[4*(n*c+r)+3]>0){let t;return(!d||_!=u.default.IMAGE&&_!=u.default.TEXT||-1!==d.indexOf(e))&&(t=a(e)),t||void p.clearRect(0,0,c,c)}}this.declutterTree_&&(d=this.declutterTree_.all().map(function(e){return e.value}));const m=Object.keys(this.replaysByZIndex_).map(Number);let g,R,T,I,E;for(m.sort(t.numberSafeCompareFunction),g=m.length-1;g>=0;--g){const e=m[g].toString();for(T=this.replaysByZIndex_[e],R=v.ORDER.length-1;R>=0;--R)if(void 0!==(I=T[_=v.ORDER[R]]))if(!l||_!=u.default.IMAGE&&_!=u.default.TEXT){if(E=I.replayHitDetection(p,f,o,s,x,h))return E}else{const t=l[e];t?t.push(I,f.slice(0)):l[e]=[I,f.slice(0)]}}},I.prototype.getClipCoords=function(e){const t=this.maxExtent_,r=t[0],n=t[1],i=t[2],s=t[3],a=[r,n,r,s,i,s,i,n];return(0,o.transform2D)(a,0,8,2,e,a),a},I.prototype.getReplay=function(e,t){const r=void 0!==e?e.toString():"0";let n=this.replaysByZIndex_[r];void 0===n&&(n={},this.replaysByZIndex_[r]=n);let o=n[t];if(void 0===o){o=new(0,T[t])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_,this.overlaps_,this.declutterTree_),n[t]=o}return o},I.prototype.getReplays=function(){return this.replaysByZIndex_},I.prototype.isEmpty=function(){return(0,i.isEmpty)(this.replaysByZIndex_)},I.prototype.replay=function(e,r,n,o,i,s){const a=Object.keys(this.replaysByZIndex_).map(Number);a.sort(t.numberSafeCompareFunction),e.save(),this.clip(e,r);const l=i||v.ORDER;let c,f,p,h,y,d;for(c=0,f=a.length;c<f;++c){const t=a[c].toString();for(y=this.replaysByZIndex_[t],p=0,h=l.length;p<h;++p){const i=l[p];if(void 0!==(d=y[i]))if(!s||i!=u.default.IMAGE&&i!=u.default.TEXT)d.replay(e,r,n,o);else{const e=s[t];e?e.push(d,r.slice(0)):s[t]=[d,r.slice(0)]}}}e.restore()},exports.default=I;
},{"../../util.js":43,"../../array.js":130,"../../dom.js":93,"../../extent.js":90,"../../geom/flat/transform.js":192,"../../obj.js":74,"../ReplayGroup.js":259,"../ReplayType.js":224,"../canvas/Replay.js":260,"../canvas/ImageReplay.js":261,"../canvas/LineStringReplay.js":262,"../canvas/PolygonReplay.js":263,"../canvas/TextReplay.js":264,"../replay.js":225,"../../transform.js":105}],226:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultOrder=u,exports.getSquaredTolerance=s,exports.getTolerance=c,exports.renderFeature=T;var e=require("../util.js"),t=require("../ImageState.js"),n=g(t),l=require("../geom/GeometryType.js"),r=g(l),o=require("../render/ReplayType.js"),a=g(o);function g(e){return e&&e.__esModule?e:{default:e}}const d=.5,i={Point:m,LineString:I,Polygon:D,MultiPoint:E,MultiLineString:p,MultiPolygon:R,GeometryCollection:S,Circle:f};function u(t,n){return(0,e.getUid)(t)-(0,e.getUid)(n)}function s(e,t){const n=c(e,t);return n*n}function c(e,t){return d*e/t}function f(e,t,n,l){const r=n.getFill(),o=n.getStroke();if(r||o){const g=e.getReplay(n.getZIndex(),a.default.CIRCLE);g.setFillStrokeStyle(r,o),g.drawCircle(t,l)}const g=n.getText();if(g){const r=e.getReplay(n.getZIndex(),a.default.TEXT);r.setTextStyle(g,e.addDeclutter(!1)),r.drawText(t,l)}}function T(e,t,l,r,o,a){let g=!1;const d=l.getImage();if(d){let e=d.getImageState();e==n.default.LOADED||e==n.default.ERROR?d.unlistenImageChange(o,a):(e==n.default.IDLE&&d.load(),e=d.getImageState(),d.listenImageChange(o,a),g=!0)}return y(e,t,l,r),g}function y(e,t,n,l){const r=n.getGeometryFunction()(t);if(!r)return;const o=r.getSimplifiedGeometry(l);if(n.getRenderer())x(e,o,n,t);else{(0,i[o.getType()])(e,o,n,t)}}function x(e,t,n,l){if(t.getType()==r.default.GEOMETRY_COLLECTION){const r=t.getGeometries();for(let t=0,o=r.length;t<o;++t)x(e,r[t],n,l);return}e.getReplay(n.getZIndex(),a.default.DEFAULT).drawCustom(t,l,n.getRenderer())}function S(e,t,n,l){const r=t.getGeometriesArray();let o,a;for(o=0,a=r.length;o<a;++o){(0,i[r[o].getType()])(e,r[o],n,l)}}function I(e,t,n,l){const r=n.getStroke();if(r){const o=e.getReplay(n.getZIndex(),a.default.LINE_STRING);o.setFillStrokeStyle(null,r),o.drawLineString(t,l)}const o=n.getText();if(o){const r=e.getReplay(n.getZIndex(),a.default.TEXT);r.setTextStyle(o,e.addDeclutter(!1)),r.drawText(t,l)}}function p(e,t,n,l){const r=n.getStroke();if(r){const o=e.getReplay(n.getZIndex(),a.default.LINE_STRING);o.setFillStrokeStyle(null,r),o.drawMultiLineString(t,l)}const o=n.getText();if(o){const r=e.getReplay(n.getZIndex(),a.default.TEXT);r.setTextStyle(o,e.addDeclutter(!1)),r.drawText(t,l)}}function R(e,t,n,l){const r=n.getFill(),o=n.getStroke();if(o||r){const g=e.getReplay(n.getZIndex(),a.default.POLYGON);g.setFillStrokeStyle(r,o),g.drawMultiPolygon(t,l)}const g=n.getText();if(g){const r=e.getReplay(n.getZIndex(),a.default.TEXT);r.setTextStyle(g,e.addDeclutter(!1)),r.drawText(t,l)}}function m(e,t,l,r){const o=l.getImage();if(o){if(o.getImageState()!=n.default.LOADED)return;const g=e.getReplay(l.getZIndex(),a.default.IMAGE);g.setImageStyle(o,e.addDeclutter(!1)),g.drawPoint(t,r)}const g=l.getText();if(g){const n=e.getReplay(l.getZIndex(),a.default.TEXT);n.setTextStyle(g,e.addDeclutter(!!o)),n.drawText(t,r)}}function E(e,t,l,r){const o=l.getImage();if(o){if(o.getImageState()!=n.default.LOADED)return;const g=e.getReplay(l.getZIndex(),a.default.IMAGE);g.setImageStyle(o,e.addDeclutter(!1)),g.drawMultiPoint(t,r)}const g=l.getText();if(g){const n=e.getReplay(l.getZIndex(),a.default.TEXT);n.setTextStyle(g,e.addDeclutter(!!o)),n.drawText(t,r)}}function D(e,t,n,l){const r=n.getFill(),o=n.getStroke();if(r||o){const g=e.getReplay(n.getZIndex(),a.default.POLYGON);g.setFillStrokeStyle(r,o),g.drawPolygon(t,l)}const g=n.getText();if(g){const r=e.getReplay(n.getZIndex(),a.default.TEXT);r.setTextStyle(g,e.addDeclutter(!1)),r.drawText(t,l)}}
},{"../util.js":43,"../ImageState.js":91,"../geom/GeometryType.js":140,"../render/ReplayType.js":224}],139:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../util.js"),t=require("../../LayerType.js"),r=E(t),n=require("../../ViewHint.js"),i=E(n),s=require("../../dom.js"),a=require("../../events.js"),o=require("../../events/EventType.js"),l=E(o),h=require("rbush"),d=E(h),u=require("../../extent.js"),c=require("../../render/EventType.js"),p=E(c),f=require("../../render/canvas.js"),g=require("../../render/canvas/ReplayGroup.js"),y=E(g),_=require("../canvas/Layer.js"),v=E(_),x=require("../vector.js");function E(e){return e&&e.__esModule?e:{default:e}}const R=function(e){v.default.call(this,e),this.declutterTree_=e.getDeclutter()?(0,d.default)(9,void 0):null,this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=(0,u.createEmpty)(),this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.context=(0,s.createCanvasContext2D)(),(0,a.listen)(f.labelCache,l.default.CLEAR,this.handleFontsChanged_,this)};(0,e.inherits)(R,v.default),R.handles=function(e){return e.getType()===r.default.VECTOR},R.create=function(e,t){return new R(t)},R.prototype.disposeInternal=function(){(0,a.unlisten)(f.labelCache,l.default.CLEAR,this.handleFontsChanged_,this),v.default.prototype.disposeInternal.call(this)},R.prototype.compose=function(e,t,r){const n=t.extent,i=t.pixelRatio,s=r.managed?t.skippedFeatureUids:{},a=t.viewState,o=a.projection,l=a.rotation,h=o.getExtent(),d=this.getLayer().getSource();let c=this.getTransform(t,0);const g=r.extent,y=void 0!==g;y&&this.clip(e,t,g);const _=this.replayGroup_;if(_&&!_.isEmpty()){this.declutterTree_&&this.declutterTree_.clear();const a=this.getLayer();let g,y=0,v=0;const x=1!==r.opacity,E=a.hasListener(p.default.RENDER);if(x||E){let t=e.canvas.width,r=e.canvas.height;if(l){const e=Math.round(Math.sqrt(t*t+r*r));y=(e-t)/2,v=(e-r)/2,t=r=e}this.context.canvas.width=t,this.context.canvas.height=r,g=this.context}else g=e;const R=g.globalAlpha;x||(g.globalAlpha=r.opacity),g!=e&&g.translate(y,v);const m=t.size[0]*i,C=t.size[1]*i;if((0,f.rotateAtOffset)(g,-l,m/2,C/2),_.replay(g,c,l,s),d.getWrapX()&&o.canWrapX()&&!(0,u.containsExtent)(h,n)){let e=n[0];const r=(0,u.getWidth)(h);let i,a=0;for(;e<h[0];)i=r*--a,c=this.getTransform(t,i),_.replay(g,c,l,s),e+=r;for(a=0,e=n[2];e>h[2];)i=r*++a,c=this.getTransform(t,i),_.replay(g,c,l,s),e-=r}if((0,f.rotateAtOffset)(g,l,m/2,C/2),g!=e){if(E&&this.dispatchRenderEvent(g,t,c),x){const t=e.globalAlpha;e.globalAlpha=r.opacity,e.drawImage(g.canvas,-y,-v),e.globalAlpha=t}else e.drawImage(g.canvas,-y,-v);g.translate(-y,-v)}x||(g.globalAlpha=R)}y&&e.restore()},R.prototype.composeFrame=function(e,t,r){const n=this.getTransform(e,0);this.preCompose(r,e,n),this.compose(r,e,t),this.postCompose(r,e,t,n)},R.prototype.forEachFeatureAtCoordinate=function(t,r,n,i,s){if(this.replayGroup_){const a=r.viewState.resolution,o=r.viewState.rotation,l=this.getLayer(),h={};return this.replayGroup_.forEachFeatureAtCoordinate(t,a,o,n,{},function(t){const r=(0,e.getUid)(t).toString();if(!(r in h))return h[r]=!0,i.call(s,t,l)},null)}},R.prototype.handleFontsChanged_=function(e){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},R.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},R.prototype.prepareFrame=function(e,t){const r=this.getLayer(),n=r.getSource(),s=e.viewHints[i.default.ANIMATING],a=e.viewHints[i.default.INTERACTING],o=r.getUpdateWhileAnimating(),l=r.getUpdateWhileInteracting();if(!this.dirty_&&!o&&s||!l&&a)return!0;const h=e.extent,d=e.viewState,c=d.projection,p=d.resolution,f=e.pixelRatio,g=r.getRevision(),_=r.getRenderBuffer();let v=r.getRenderOrder();void 0===v&&(v=x.defaultOrder);const E=(0,u.buffer)(h,_*p),R=d.projection.getExtent();if(n.getWrapX()&&d.projection.canWrapX()&&!(0,u.containsExtent)(R,e.extent)){const e=(0,u.getWidth)(R),t=Math.max((0,u.getWidth)(E)/2,e);E[0]=R[0]-t,E[2]=R[2]+t}if(!this.dirty_&&this.renderedResolution_==p&&this.renderedRevision_==g&&this.renderedRenderOrder_==v&&(0,u.containsExtent)(this.renderedExtent_,E))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;const m=new y.default((0,x.getTolerance)(p,f),E,p,f,n.getOverlaps(),this.declutterTree_,r.getRenderBuffer());n.loadFeatures(E,p,c);const C=function(e){let t;const n=e.getStyleFunction()||r.getStyleFunction();if(n&&(t=n(e,p)),t){const r=this.renderFeature(e,p,f,t,m);this.dirty_=this.dirty_||r}}.bind(this);if(v){const e=[];n.forEachFeatureInExtent(E,function(t){e.push(t)},this),e.sort(v);for(let t=0,r=e.length;t<r;++t)C(e[t])}else n.forEachFeatureInExtent(E,C,this);return m.finish(),this.renderedResolution_=p,this.renderedRevision_=g,this.renderedRenderOrder_=v,this.renderedExtent_=E,this.replayGroup_=m,this.replayGroupChanged=!0,!0},R.prototype.renderFeature=function(e,t,r,n,i){if(!n)return!1;let s=!1;if(Array.isArray(n))for(let a=0,o=n.length;a<o;++a)s=(0,x.renderFeature)(i,e,n[a],(0,x.getSquaredTolerance)(t,r),this.handleStyleImageChange_,this)||s;else s=(0,x.renderFeature)(i,e,n,(0,x.getSquaredTolerance)(t,r),this.handleStyleImageChange_,this);return s},exports.default=R;
},{"../../util.js":43,"../../LayerType.js":73,"../../ViewHint.js":102,"../../dom.js":93,"../../events.js":84,"../../events/EventType.js":110,"rbush":228,"../../extent.js":90,"../../render/EventType.js":120,"../../render/canvas.js":217,"../../render/canvas/ReplayGroup.js":227,"../canvas/Layer.js":232,"../vector.js":226}],223:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"};
},{}],137:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../util.js"),t=require("../../LayerType.js"),r=j(t),n=require("../../TileState.js"),o=j(n),i=require("../../dom.js"),l=require("../../events.js"),s=require("../../events/EventType.js"),a=j(s),d=require("rbush"),u=j(d),c=require("../../extent.js"),g=require("../../layer/VectorTileRenderType.js"),f=j(g),p=require("../../proj.js"),h=require("../../proj/Units.js"),y=j(h),T=require("../../render/ReplayType.js"),R=j(T),E=require("../../render/canvas.js"),C=require("../../render/canvas/ReplayGroup.js"),v=j(C),S=require("../../render/replay.js"),_=require("../canvas/TileLayer.js"),m=j(_),L=require("../vector.js"),x=require("../../transform.js");function j(e){return e&&e.__esModule?e:{default:e}}const O={image:[R.default.POLYGON,R.default.CIRCLE,R.default.LINE_STRING,R.default.IMAGE,R.default.TEXT],hybrid:[R.default.POLYGON,R.default.LINE_STRING]},q={image:[R.default.DEFAULT],hybrid:[R.default.IMAGE,R.default.TEXT,R.default.DEFAULT],vector:S.ORDER},A=function(e){this.context=null,m.default.call(this,e),this.declutterTree_=e.getDeclutter()?(0,u.default)(9,void 0):null,this.dirty_=!1,this.renderedLayerRevision_,this.tmpTransform_=(0,x.create)(),this.zDirection=e.getRenderMode()==f.default.VECTOR?1:0,(0,l.listen)(E.labelCache,a.default.CLEAR,this.handleFontsChanged_,this)};(0,e.inherits)(A,m.default),A.handles=function(e){return e.getType()===r.default.VECTOR_TILE},A.create=function(e,t){return new A(t)},A.prototype.disposeInternal=function(){(0,l.unlisten)(E.labelCache,a.default.CLEAR,this.handleFontsChanged_,this),m.default.prototype.disposeInternal.call(this)},A.prototype.getTile=function(e,t,r,n,i){const l=m.default.prototype.getTile.call(this,e,t,r,n,i);return l.getState()===o.default.LOADED&&(this.createReplayGroup_(l,n,i),this.context&&this.renderTileImage_(l,n,i)),l},A.prototype.prepareFrame=function(e,t){const r=this.getLayer(),n=r.getRevision();if(this.renderedLayerRevision_!=n){this.renderedTiles.length=0;const e=r.getRenderMode();this.context||e==f.default.VECTOR||(this.context=(0,i.createCanvasContext2D)()),this.context&&e==f.default.VECTOR&&(this.context=null)}return this.renderedLayerRevision_=n,m.default.prototype.prepareFrame.apply(this,arguments)},A.prototype.createReplayGroup_=function(e,t,r){const n=this.getLayer(),i=n.getRevision(),l=n.getRenderOrder()||null,s=e.getReplayState(n);if(!s.dirty&&s.renderedRevision==i&&s.renderedRenderOrder==l)return;const a=n.getSource(),d=a.getTileGrid(),u=a.getTileGridForProjection(r).getResolution(e.tileCoord[0]),g=e.extent,f={};for(let i=0,h=e.tileKeys.length;i<h;++i){const h=e.getTile(e.tileKeys[i]);if(h.getState()!=o.default.LOADED)continue;const T=h.tileCoord,R=d.getTileCoordExtent(T),E=(0,c.getIntersection)(g,R),C=(0,c.equals)(R,E)?null:(0,c.buffer)(E,n.getRenderBuffer()*u,this.tmpExtent),S=h.getProjection();let _=!1;(0,p.equivalent)(r,S)||(_=!0,h.setProjection(r)),s.dirty=!1;const m=new v.default(0,E,u,t,a.getOverlaps(),this.declutterTree_,n.getRenderBuffer()),x=(0,L.getSquaredTolerance)(u,t),j=function(e){let t;const r=e.getStyleFunction()||n.getStyleFunction();if(r&&(t=r(e,u)),t){const r=this.renderFeature(e,x,t,m);this.dirty_=this.dirty_||r,s.dirty=s.dirty||r}},O=h.getFeatures();l&&l!==s.renderedRenderOrder&&O.sort(l);for(let e=0,t=O.length;e<t;++e){const t=O[e];_&&(S.getUnits()==y.default.TILE_PIXELS&&(S.setWorldExtent(R),S.setExtent(h.getExtent())),t.getGeometry().transform(S,r)),C&&!(0,c.intersects)(C,t.getGeometry().getExtent())||j.call(this,t)}m.finish();for(const e in m.getReplays())f[e]=!0;h.setReplayGroup(n,e.tileCoord.toString(),m)}s.renderedRevision=i,s.renderedRenderOrder=l},A.prototype.forEachFeatureAtCoordinate=function(t,r,n,i,l){const s=r.viewState.resolution,a=r.viewState.rotation;n=null==n?0:n;const d=this.getLayer(),u={},g=this.renderedTiles;let f,p,h,y,T;for(h=0,y=g.length;h<y;++h){const r=g[h];if(f=(0,c.buffer)(r.extent,n*s,f),(0,c.containsCoordinate)(f,t))for(let c=0,g=r.tileKeys.length;c<g;++c){const g=r.getTile(r.tileKeys[c]);g.getState()==o.default.LOADED&&(T=g.getReplayGroup(d,r.tileCoord.toString()),p=p||T.forEachFeatureAtCoordinate(t,s,a,n,{},function(t){const r=(0,e.getUid)(t).toString();if(!(r in u))return u[r]=!0,i.call(l,t,d)},null))}}return p},A.prototype.getReplayTransform_=function(e,t){const r=this.getLayer().getSource().getTileGrid(),n=e.tileCoord,o=r.getResolution(n[0]),i=t.viewState,l=t.pixelRatio,s=i.resolution/l,a=r.getTileCoordExtent(n,this.tmpExtent),d=i.center,u=(0,c.getTopLeft)(a),g=t.size,f=Math.round(l*g[0]/2),p=Math.round(l*g[1]/2);return(0,x.compose)(this.tmpTransform_,f,p,o/s,o/s,i.rotation,(u[0]-d[0])/o,(d[1]-u[1])/o)},A.prototype.handleFontsChanged_=function(e){const t=this.getLayer();t.getVisible()&&void 0!==this.renderedLayerRevision_&&t.changed()},A.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},A.prototype.postCompose=function(e,t,r){const n=this.getLayer(),i=n.getRenderMode();if(i!=f.default.IMAGE){const l=n.getDeclutter()?{}:null,s=n.getSource(),a=q[i],d=t.pixelRatio,u=t.viewState.rotation,c=t.size;let g,f;u&&(g=Math.round(d*c[0]/2),f=Math.round(d*c[1]/2),(0,E.rotateAtOffset)(e,-u,g,f)),l&&this.declutterTree_.clear();const p=this.renderedTiles,h=s.getTileGridForProjection(t.viewState.projection),y=[],T=[];for(let i=p.length-1;i>=0;--i){const s=p[i];if(s.getState()==o.default.ABORT)continue;const d=s.tileCoord,c=h.getTileCoordExtent(d,this.tmpExtent)[0]-s.extent[0];let g=void 0;for(let i=0,f=s.tileKeys.length;i<f;++i){const f=s.getTile(s.tileKeys[i]);if(f.getState()!=o.default.LOADED)continue;const p=f.getReplayGroup(n,d.toString());if(!p||!p.hasReplays(a))continue;g||(g=this.getTransform(t,c));const h=f.tileCoord[0],R=p.getClipCoords(g);e.save(),e.globalAlpha=r.opacity;for(let t=0,r=y.length;t<r;++t){const r=y[t];h<T[t]&&(e.beginPath(),e.moveTo(R[0],R[1]),e.lineTo(R[2],R[3]),e.lineTo(R[4],R[5]),e.lineTo(R[6],R[7]),e.moveTo(r[6],r[7]),e.lineTo(r[4],r[5]),e.lineTo(r[2],r[3]),e.lineTo(r[0],r[1]),e.clip())}p.replay(e,g,u,{},a,l),e.restore(),y.push(R),T.push(h)}}l&&(0,C.replayDeclutter)(l,e,u),u&&(0,E.rotateAtOffset)(e,u,g,f)}m.default.prototype.postCompose.apply(this,arguments)},A.prototype.renderFeature=function(e,t,r,n){if(!r)return!1;let o=!1;if(Array.isArray(r))for(let i=0,l=r.length;i<l;++i)o=(0,L.renderFeature)(n,e,r[i],t,this.handleStyleImageChange_,this)||o;else o=(0,L.renderFeature)(n,e,r,t,this.handleStyleImageChange_,this);return o},A.prototype.renderTileImage_=function(e,t,r){const n=this.getLayer(),i=e.getReplayState(n),l=n.getRevision(),s=O[n.getRenderMode()];if(s&&i.renderedTileRevision!==l){i.renderedTileRevision=l;const a=e.wrappedTileCoord,d=a[0],u=n.getSource(),c=u.getTileGridForProjection(r),g=c.getResolution(d),f=e.getContext(n),p=u.getTilePixelSize(d,t,r);f.canvas.width=p[0],f.canvas.height=p[1];const h=c.getTileCoordExtent(a,this.tmpExtent);for(let r=0,i=e.tileKeys.length;r<i;++r){const i=e.getTile(e.tileKeys[r]);if(i.getState()!=o.default.LOADED)continue;const l=t/g,a=(0,x.reset)(this.tmpTransform_);(0,x.scale)(a,l,-l),(0,x.translate)(a,-h[0],-h[3]),i.getReplayGroup(n,e.tileCoord.toString()).replay(f,a,0,{},s)}}},exports.default=A;
},{"../../util.js":43,"../../LayerType.js":73,"../../TileState.js":92,"../../dom.js":93,"../../events.js":84,"../../events/EventType.js":110,"rbush":228,"../../extent.js":90,"../../layer/VectorTileRenderType.js":223,"../../proj.js":88,"../../proj/Units.js":143,"../../render/ReplayType.js":224,"../../render/canvas.js":217,"../../render/canvas/ReplayGroup.js":227,"../../render/replay.js":225,"../canvas/TileLayer.js":136,"../vector.js":226,"../../transform.js":105}],26:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./util.js"),r=require("./PluggableMap.js"),t=v(r),a=require("./control/util.js"),s=require("./interaction.js"),n=require("./obj.js"),u=require("./renderer/canvas/ImageLayer.js"),i=v(u),l=require("./renderer/canvas/Map.js"),o=v(l),c=require("./renderer/canvas/TileLayer.js"),d=v(c),f=require("./renderer/canvas/VectorLayer.js"),j=v(f),q=require("./renderer/canvas/VectorTileLayer.js"),p=v(q);function v(e){return e&&e.__esModule?e:{default:e}}const y=function(e){(e=(0,n.assign)({},e)).controls||(e.controls=(0,a.defaults)()),e.interactions||(e.interactions=(0,s.defaults)()),t.default.call(this,e)};(0,e.inherits)(y,t.default),y.prototype.createRenderer=function(){const e=new o.default(this);return e.registerLayerRenderers([i.default,d.default,j.default,p.default]),e},exports.default=y;
},{"./util.js":43,"./PluggableMap.js":34,"./control/util.js":122,"./interaction.js":94,"./obj.js":74,"./renderer/canvas/ImageLayer.js":138,"./renderer/canvas/Map.js":135,"./renderer/canvas/TileLayer.js":136,"./renderer/canvas/VectorLayer.js":139,"./renderer/canvas/VectorTileLayer.js":137}],98:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"};
},{}],33:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./util.js"),e=require("./MapEventType.js"),i=p(e),n=require("./Object.js"),s=p(n),o=require("./OverlayPositioning.js"),r=p(o),h=require("./css.js"),a=require("./dom.js"),d=require("./events.js"),l=require("./extent.js");function p(t){return t&&t.__esModule?t:{default:t}}const u={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},g=function(t){s.default.call(this),this.options=t,this.id=t.id,this.insertFirst=void 0===t.insertFirst||t.insertFirst,this.stopEvent=void 0===t.stopEvent||t.stopEvent,this.element=document.createElement("DIV"),this.element.className=void 0!==t.className?t.className:"ol-overlay-container "+h.CLASS_SELECTABLE,this.element.style.position="absolute",this.autoPan=void 0!==t.autoPan&&t.autoPan,this.autoPanAnimation=t.autoPanAnimation||{},this.autoPanMargin=void 0!==t.autoPanMargin?t.autoPanMargin:20,this.rendered={bottom_:"",left_:"",right_:"",top_:"",visible:!0},this.mapPostrenderListenerKey=null,(0,d.listen)(this,(0,n.getChangeEventType)(u.ELEMENT),this.handleElementChanged,this),(0,d.listen)(this,(0,n.getChangeEventType)(u.MAP),this.handleMapChanged,this),(0,d.listen)(this,(0,n.getChangeEventType)(u.OFFSET),this.handleOffsetChanged,this),(0,d.listen)(this,(0,n.getChangeEventType)(u.POSITION),this.handlePositionChanged,this),(0,d.listen)(this,(0,n.getChangeEventType)(u.POSITIONING),this.handlePositioningChanged,this),void 0!==t.element&&this.setElement(t.element),this.setOffset(void 0!==t.offset?t.offset:[0,0]),this.setPositioning(void 0!==t.positioning?t.positioning:r.default.TOP_LEFT),void 0!==t.position&&this.setPosition(t.position)};(0,t.inherits)(g,s.default),g.prototype.getElement=function(){return this.get(u.ELEMENT)},g.prototype.getId=function(){return this.id},g.prototype.getMap=function(){return this.get(u.MAP)},g.prototype.getOffset=function(){return this.get(u.OFFSET)},g.prototype.getPosition=function(){return this.get(u.POSITION)},g.prototype.getPositioning=function(){return this.get(u.POSITIONING)},g.prototype.handleElementChanged=function(){(0,a.removeChildren)(this.element);const t=this.getElement();t&&this.element.appendChild(t)},g.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&((0,a.removeNode)(this.element),(0,d.unlistenByKey)(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=(0,d.listen)(t,i.default.POSTRENDER,this.render,this),this.updatePixelPosition();const e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element)}},g.prototype.render=function(){this.updatePixelPosition()},g.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},g.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.get(u.POSITION)&&this.autoPan&&this.panIntoView()},g.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},g.prototype.setElement=function(t){this.set(u.ELEMENT,t)},g.prototype.setMap=function(t){this.set(u.MAP,t)},g.prototype.setOffset=function(t){this.set(u.OFFSET,t)},g.prototype.setPosition=function(t){this.set(u.POSITION,t)},g.prototype.panIntoView=function(){const t=this.getMap();if(!t||!t.getTargetElement())return;const e=this.getRect(t.getTargetElement(),t.getSize()),i=this.getElement(),n=this.getRect(i,[(0,a.outerWidth)(i),(0,a.outerHeight)(i)]),s=this.autoPanMargin;if(!(0,l.containsExtent)(e,n)){const i=n[0]-e[0],o=e[2]-n[2],r=n[1]-e[1],h=e[3]-n[3],a=[0,0];if(i<0?a[0]=i-s:o<0&&(a[0]=Math.abs(o)+s),r<0?a[1]=r-s:h<0&&(a[1]=Math.abs(h)+s),0!==a[0]||0!==a[1]){const e=t.getView().getCenter(),i=t.getPixelFromCoordinate(e),n=[i[0]+a[0],i[1]+a[1]];t.getView().animate({center:t.getCoordinateFromPixel(n),duration:this.autoPanAnimation.duration,easing:this.autoPanAnimation.easing})}}},g.prototype.getRect=function(t,e){const i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,s=i.top+window.pageYOffset;return[n,s,n+e[0],s+e[1]]},g.prototype.setPositioning=function(t){this.set(u.POSITIONING,t)},g.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},g.prototype.updatePixelPosition=function(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e)return void this.setVisible(!1);const i=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(i,n)},g.prototype.updateRenderedPosition=function(t,e){const i=this.element.style,n=this.getOffset(),s=this.getPositioning();this.setVisible(!0);let o=n[0],h=n[1];if(s==r.default.BOTTOM_RIGHT||s==r.default.CENTER_RIGHT||s==r.default.TOP_RIGHT){""!==this.rendered.left_&&(this.rendered.left_=i.left="");const n=Math.round(e[0]-t[0]-o)+"px";this.rendered.right_!=n&&(this.rendered.right_=i.right=n)}else{""!==this.rendered.right_&&(this.rendered.right_=i.right=""),s!=r.default.BOTTOM_CENTER&&s!=r.default.CENTER_CENTER&&s!=r.default.TOP_CENTER||(o-=this.element.offsetWidth/2);const e=Math.round(t[0]+o)+"px";this.rendered.left_!=e&&(this.rendered.left_=i.left=e)}if(s==r.default.BOTTOM_LEFT||s==r.default.BOTTOM_CENTER||s==r.default.BOTTOM_RIGHT){""!==this.rendered.top_&&(this.rendered.top_=i.top="");const n=Math.round(e[1]-t[1]-h)+"px";this.rendered.bottom_!=n&&(this.rendered.bottom_=i.bottom=n)}else{""!==this.rendered.bottom_&&(this.rendered.bottom_=i.bottom=""),s!=r.default.CENTER_LEFT&&s!=r.default.CENTER_CENTER&&s!=r.default.CENTER_RIGHT||(h-=this.element.offsetHeight/2);const e=Math.round(t[1]+h)+"px";this.rendered.top_!=e&&(this.rendered.top_=i.top=e)}},g.prototype.getOptions=function(){return this.options},exports.default=g;
},{"./util.js":43,"./MapEventType.js":97,"./Object.js":31,"./OverlayPositioning.js":98,"./css.js":99,"./dom.js":93,"./events.js":84,"./extent.js":90}],107:[function(require,module,exports) {
"use strict";function t(t,e,n,r){return void 0!==r?(r[0]=t,r[1]=e,r[2]=n,r):[t,e,n]}function e(t,e,n){return t+"/"+e+"/"+n}function n(t){return e(t[0],t[1],t[2])}function r(t){return t.split("/").map(Number)}function o(t){return(t[1]<<t[0])+t[2]}function u(t){const e=t[0],n=new Array(e);let r,o,u=1<<e-1;for(r=0;r<e;++r)o=48,t[1]&u&&(o+=1),t[2]&u&&(o+=2),n[r]=String.fromCharCode(o),u>>=1;return n.join("")}function i(t,e){const n=t[0],r=t[1],o=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const u=e.getExtent();let i;return!(i=u?e.getTileRangeForExtentAndZ(u,n):e.getFullTileRange(n))||i.containsXY(r,o)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createOrUpdate=t,exports.getKeyZXY=e,exports.getKey=n,exports.fromKey=r,exports.hash=o,exports.quadKey=u,exports.withinExtentAndZ=i;
},{}],36:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./util.js"),t=require("./structs/LRUCache.js"),i=r(t),o=require("./tilecoord.js");function r(e){return e&&e.__esModule?e:{default:e}}const s=function(e){i.default.call(this,e)};(0,e.inherits)(s,i.default),s.prototype.expireCache=function(e){for(;this.canExpireCache();){const t=this.peekLast(),i=t.tileCoord[0].toString();if(i in e&&e[i].contains(t.tileCoord))break;this.pop().dispose()}},s.prototype.pruneExceptNewestZ=function(){if(0===this.getCount())return;const e=this.peekFirstKey(),t=(0,o.fromKey)(e)[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove((0,o.getKey)(e.tileCoord)),e.dispose())},this)},exports.default=s;
},{"./util.js":43,"./structs/LRUCache.js":133,"./tilecoord.js":107}],39:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultLoadFunction=y;var e=require("./util.js"),t=require("./Tile.js"),i=c(t),s=require("./TileState.js"),n=c(s),o=require("./dom.js"),l=require("./events.js"),r=require("./extent.js"),a=require("./events/EventType.js"),h=c(a),u=require("./featureloader.js"),d=require("./functions.js");function c(e){return e&&e.__esModule?e:{default:e}}const f=function(e,t,s,o,a,u,c,y,g,p,_,L,E,T,K){if(i.default.call(this,e,t,{transition:0}),this.context_={},this.loader_,this.replayState_={},this.sourceTiles_=p,this.tileKeys=[],this.extent=null,this.sourceRevision_=s,this.wrappedTileCoord=u,this.loadListenerKeys_=[],this.sourceTileListenerKeys_=[],u){const i=this.extent=g.getTileCoordExtent(u),D=g.getResolution(K),R=y.getZForResolution(D),O=K!=e[0];let x=0;if(y.forEachTileCoord(i,R,function(e){let t=(0,r.getIntersection)(i,y.getTileCoordExtent(e));const s=y.getExtent();if(s&&(t=(0,r.getIntersection)(t,s,t)),(0,r.getWidth)(t)/D>=.5&&(0,r.getHeight)(t)/D>=.5){++x;const t=e.toString();let i=p[t];if(!i&&!O){const s=c(e,_,L);i=p[t]=new E(e,null==s?n.default.EMPTY:n.default.IDLE,null==s?"":s,o,a),this.sourceTileListenerKeys_.push((0,l.listen)(i,h.default.CHANGE,T))}!i||O&&i.getState()!=n.default.LOADED||(i.consumers++,this.tileKeys.push(t))}}.bind(this)),O&&x==this.tileKeys.length&&this.finishLoading_(),K<=e[0]&&this.state!=n.default.LOADED)for(;K>g.getMinZoom();){const i=new f(e,t,s,o,a,u,c,y,g,p,_,L,E,d.UNDEFINED,--K);if(i.state==n.default.LOADED){this.interimTile=i;break}}}};function y(e,t){const i=(0,u.loadFeaturesXhr)(t,e.getFormat(),e.onLoad.bind(e),e.onError.bind(e));e.setLoader(i)}(0,e.inherits)(f,i.default),f.prototype.disposeInternal=function(){this.state=n.default.ABORT,this.changed(),this.interimTile&&this.interimTile.dispose();for(let e=0,t=this.tileKeys.length;e<t;++e){const t=this.tileKeys[e],i=this.getTile(t);i.consumers--,0==i.consumers&&(delete this.sourceTiles_[t],i.dispose())}this.tileKeys.length=0,this.sourceTiles_=null,this.loadListenerKeys_.forEach(l.unlistenByKey),this.loadListenerKeys_.length=0,this.sourceTileListenerKeys_.forEach(l.unlistenByKey),this.sourceTileListenerKeys_.length=0,i.default.prototype.disposeInternal.call(this)},f.prototype.getContext=function(t){const i=(0,e.getUid)(t).toString();return i in this.context_||(this.context_[i]=(0,o.createCanvasContext2D)()),this.context_[i]},f.prototype.getImage=function(e){return-1==this.getReplayState(e).renderedTileRevision?null:this.getContext(e).canvas},f.prototype.getReplayState=function(t){const i=(0,e.getUid)(t).toString();return i in this.replayState_||(this.replayState_[i]={dirty:!1,renderedRenderOrder:null,renderedRevision:-1,renderedTileRevision:-1}),this.replayState_[i]},f.prototype.getKey=function(){return this.tileKeys.join("/")+"-"+this.sourceRevision_},f.prototype.getTile=function(e){return this.sourceTiles_[e]},f.prototype.load=function(){let t=0;const i={};this.state==n.default.IDLE&&this.setState(n.default.LOADING),this.state==n.default.LOADING&&this.tileKeys.forEach(function(s){const o=this.getTile(s);if(o.state==n.default.IDLE&&(o.setLoader(this.loader_),o.load()),o.state==n.default.LOADING){const s=(0,l.listen)(o,h.default.CHANGE,function(s){const l=o.getState();if(l==n.default.LOADED||l==n.default.ERROR){const s=(0,e.getUid)(o);l==n.default.ERROR?i[s]=!0:(--t,delete i[s]),t-Object.keys(i).length==0&&this.finishLoading_()}}.bind(this));this.loadListenerKeys_.push(s),++t}}.bind(this)),t-Object.keys(i).length==0&&setTimeout(this.finishLoading_.bind(this),0)},f.prototype.finishLoading_=function(){let e=this.tileKeys.length,t=0;for(let i=e-1;i>=0;--i){const s=this.getTile(this.tileKeys[i]).getState();s!=n.default.LOADED&&--e,s==n.default.EMPTY&&++t}e==this.tileKeys.length?(this.loadListenerKeys_.forEach(l.unlistenByKey),this.loadListenerKeys_.length=0,this.setState(n.default.LOADED)):this.setState(t==this.tileKeys.length?n.default.EMPTY:n.default.ERROR)},exports.default=f;
},{"./util.js":43,"./Tile.js":35,"./TileState.js":92,"./dom.js":93,"./events.js":84,"./extent.js":90,"./events/EventType.js":110,"./featureloader.js":108,"./functions.js":103}],40:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./util.js"),e=require("./Tile.js"),o=i(e),r=require("./TileState.js"),s=i(r);function i(t){return t&&t.__esModule?t:{default:t}}const n=function(t,e,r,s,i,n){o.default.call(this,t,e,n),this.consumers=0,this.extent_=null,this.format_=s,this.features_=null,this.loader_,this.projection_=null,this.replayGroups_={},this.tileLoadFunction_=i,this.url_=r};(0,t.inherits)(n,o.default);const u=[0,0,4096,4096];n.prototype.disposeInternal=function(){this.features_=null,this.replayGroups_={},this.state=s.default.ABORT,this.changed(),o.default.prototype.disposeInternal.call(this)},n.prototype.getExtent=function(){return this.extent_||u},n.prototype.getFormat=function(){return this.format_},n.prototype.getFeatures=function(){return this.features_},n.prototype.getKey=function(){return this.url_},n.prototype.getProjection=function(){return this.projection_},n.prototype.getReplayGroup=function(e,o){return this.replayGroups_[(0,t.getUid)(e)+","+o]},n.prototype.load=function(){this.state==s.default.IDLE&&(this.setState(s.default.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_(null,NaN,null))},n.prototype.onLoad=function(t,e,o){this.setProjection(e),this.setFeatures(t),this.setExtent(o)},n.prototype.onError=function(){this.setState(s.default.ERROR)},n.prototype.setExtent=function(t){this.extent_=t},n.prototype.setFeatures=function(t){this.features_=t,this.setState(s.default.LOADED)},n.prototype.setProjection=function(t){this.projection_=t},n.prototype.setReplayGroup=function(e,o,r){this.replayGroups_[(0,t.getUid)(e)+","+o]=r},n.prototype.setLoader=function(t){this.loader_=t},exports.default=n;
},{"./util.js":43,"./Tile.js":35,"./TileState.js":92}],182:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util.js"),t=require("../control/Control.js"),l=o(t),s=require("../css.js"),n=require("../dom.js"),u=require("../events.js"),c=require("../events/EventType.js"),r=o(c);function o(e){return e&&e.__esModule?e:{default:e}}const i=function(){let e;return function(){if(!e){const t=document.body;t.webkitRequestFullscreen?e="webkitfullscreenchange":t.mozRequestFullScreen?e="mozfullscreenchange":t.msRequestFullscreen?e="MSFullscreenChange":t.requestFullscreen&&(e="fullscreenchange")}return e}}(),a=function(e){const t=e||{};this.cssClassName_=void 0!==t.className?t.className:"ol-full-screen";const n=void 0!==t.label?t.label:"â¤¢";this.labelNode_="string"==typeof n?document.createTextNode(n):n;const c=void 0!==t.labelActive?t.labelActive:"Ã—";this.labelActiveNode_="string"==typeof c?document.createTextNode(c):c;const o=t.tipLabel?t.tipLabel:"Toggle full-screen",i=document.createElement("button");i.className=this.cssClassName_+"-"+m(),i.setAttribute("type","button"),i.title=o,i.appendChild(this.labelNode_),(0,u.listen)(i,r.default.CLICK,this.handleClick_,this);const a=this.cssClassName_+" "+s.CLASS_UNSELECTABLE+" "+s.CLASS_CONTROL+" "+(d()?"":s.CLASS_UNSUPPORTED),h=document.createElement("div");h.className=a,h.appendChild(i),l.default.call(this,{element:h,target:t.target}),this.keys_=void 0!==t.keys&&t.keys,this.source_=t.source};function d(){const e=document.body;return!!(e.webkitRequestFullscreen||e.mozRequestFullScreen&&document.mozFullScreenEnabled||e.msRequestFullscreen&&document.msFullscreenEnabled||e.requestFullscreen&&document.fullscreenEnabled)}function m(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)}function h(e){e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}function F(e){e.mozRequestFullScreenWithKeys?e.mozRequestFullScreenWithKeys():e.webkitRequestFullscreen?e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):h(e)}function f(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}(0,e.inherits)(a,l.default),a.prototype.handleClick_=function(e){e.preventDefault(),this.handleFullScreen_()},a.prototype.handleFullScreen_=function(){if(!d())return;const e=this.getMap();if(e)if(m())f();else{let t;t=this.source_?"string"==typeof this.source_?document.getElementById(this.source_):this.source_:e.getTargetElement(),this.keys_?F(t):h(t)}},a.prototype.handleFullScreenChange_=function(){const e=this.element.firstElementChild,t=this.getMap();m()?(e.className=this.cssClassName_+"-true",(0,n.replaceNode)(this.labelActiveNode_,this.labelNode_)):(e.className=this.cssClassName_+"-false",(0,n.replaceNode)(this.labelNode_,this.labelActiveNode_)),t&&t.updateSize()},a.prototype.setMap=function(e){l.default.prototype.setMap.call(this,e),e&&this.listenerKeys.push((0,u.listen)(document,i(),this.handleFullScreenChange_,this))},exports.default=a;
},{"../util.js":43,"../control/Control.js":181,"../css.js":99,"../dom.js":93,"../events.js":84,"../events/EventType.js":110}],183:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.render=j;var e=require("../util.js"),t=require("../Collection.js"),i=O(t),o=require("../Map.js"),s=O(o),l=require("../MapEventType.js"),n=O(l),a=require("../MapProperty.js"),r=O(a),p=require("../Object.js"),c=require("../ObjectEventType.js"),h=O(c),d=require("../Overlay.js"),u=O(d),_=require("../OverlayPositioning.js"),g=O(_),v=require("../ViewProperty.js"),m=O(v),b=require("../control/Control.js"),f=O(b),y=require("../coordinate.js"),w=require("../css.js"),E=require("../dom.js"),C=require("../events.js"),L=require("../events/EventType.js"),x=O(L),M=require("../extent.js");function O(e){return e&&e.__esModule?e:{default:e}}const V=.75,T=.1,R=function(e){const t=e||{};this.collapsed_=void 0===t.collapsed||t.collapsed,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);const o=void 0!==t.className?t.className:"ol-overviewmap",l=void 0!==t.tipLabel?t.tipLabel:"Overview map",n=void 0!==t.collapseLabel?t.collapseLabel:"Â«";"string"==typeof n?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=n):this.collapseLabel_=n;const a=void 0!==t.label?t.label:"Â»";"string"==typeof a?(this.label_=document.createElement("span"),this.label_.textContent=a):this.label_=a;const r=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,p=document.createElement("button");p.setAttribute("type","button"),p.title=l,p.appendChild(r),(0,C.listen)(p,x.default.CLICK,this.handleClick_,this),this.ovmapDiv_=document.createElement("DIV"),this.ovmapDiv_.className="ol-overviewmap-map",this.ovmap_=new s.default({controls:new i.default,interactions:new i.default,view:t.view});const c=this.ovmap_;t.layers&&t.layers.forEach(function(e){c.addLayer(e)}.bind(this));const h=document.createElement("DIV");h.className="ol-overviewmap-box",h.style.boxSizing="border-box",this.boxOverlay_=new u.default({position:[0,0],positioning:g.default.BOTTOM_LEFT,element:h}),this.ovmap_.addOverlay(this.boxOverlay_);const d=o+" "+w.CLASS_UNSELECTABLE+" "+w.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" "+w.CLASS_COLLAPSED:"")+(this.collapsible_?"":" ol-uncollapsible"),_=document.createElement("div");_.className=d,_.appendChild(this.ovmapDiv_),_.appendChild(p),f.default.call(this,{element:_,render:t.render||j,target:t.target});const v=this,m=this.boxOverlay_,b=this.boxOverlay_.getElement(),y=function(e){const t=c.getEventCoordinate({clientX:(i=e).clientX-b.offsetWidth/2,clientY:i.clientY+b.offsetHeight/2});var i;m.setPosition(t)},E=function(e){const t=c.getEventCoordinate(e);v.getMap().getView().setCenter(t),window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",E)};b.addEventListener("mousedown",function(){window.addEventListener("mousemove",y),window.addEventListener("mouseup",E)})};function j(e){this.validateExtent_(),this.updateBox_()}(0,e.inherits)(R,f.default),R.prototype.setMap=function(e){const t=this.getMap();if(e!==t){if(t){const e=t.getView();e&&this.unbindView_(e),this.ovmap_.setTarget(null)}if(f.default.prototype.setMap.call(this,e),e){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push((0,C.listen)(e,h.default.PROPERTYCHANGE,this.handleMapPropertyChange_,this)),0===this.ovmap_.getLayers().getLength()&&this.ovmap_.setLayerGroup(e.getLayerGroup());const t=e.getView();t&&(this.bindView_(t),t.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_()))}}},R.prototype.handleMapPropertyChange_=function(e){if(e.key===r.default.VIEW){const t=e.oldValue;t&&this.unbindView_(t);const i=this.getMap().getView();this.bindView_(i)}},R.prototype.bindView_=function(e){(0,C.listen)(e,(0,p.getChangeEventType)(m.default.ROTATION),this.handleRotationChanged_,this)},R.prototype.unbindView_=function(e){(0,C.unlisten)(e,(0,p.getChangeEventType)(m.default.ROTATION),this.handleRotationChanged_,this)},R.prototype.handleRotationChanged_=function(){this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())},R.prototype.validateExtent_=function(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const i=e.getSize(),o=e.getView().calculateExtent(i),s=t.getSize(),l=t.getView().calculateExtent(s),n=t.getPixelFromCoordinate((0,M.getTopLeft)(o)),a=t.getPixelFromCoordinate((0,M.getBottomRight)(o)),r=Math.abs(n[0]-a[0]),p=Math.abs(n[1]-a[1]),c=s[0],h=s[1];r<.1*c||p<.1*h||r>.75*c||p>.75*h?this.resetExtent_():(0,M.containsExtent)(l,o)||this.recenter_()},R.prototype.resetExtent_=function(){const e=this.getMap(),t=this.ovmap_,i=e.getSize(),o=e.getView().calculateExtent(i),s=t.getView(),l=Math.log(7.5)/Math.LN2,n=1/(.1*Math.pow(2,l/2));(0,M.scaleFromCenter)(o,n),s.fit(o)},R.prototype.recenter_=function(){const e=this.getMap(),t=this.ovmap_,i=e.getView();t.getView().setCenter(i.getCenter())},R.prototype.updateBox_=function(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const i=e.getSize(),o=e.getView(),s=t.getView(),l=o.getRotation(),n=this.boxOverlay_,a=this.boxOverlay_.getElement(),r=o.calculateExtent(i),p=s.getResolution(),c=(0,M.getBottomLeft)(r),h=(0,M.getTopRight)(r),d=this.calculateCoordinateRotate_(l,c);n.setPosition(d),a&&(a.style.width=Math.abs((c[0]-h[0])/p)+"px",a.style.height=Math.abs((h[1]-c[1])/p)+"px")},R.prototype.calculateCoordinateRotate_=function(e,t){let i;const o=this.getMap().getView().getCenter();return o&&(i=[t[0]-o[0],t[1]-o[1]],(0,y.rotate)(i,e),(0,y.add)(i,o)),i},R.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},R.prototype.handleToggle_=function(){this.element.classList.toggle(w.CLASS_COLLAPSED),this.collapsed_?(0,E.replaceNode)(this.collapseLabel_,this.label_):(0,E.replaceNode)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;const e=this.ovmap_;this.collapsed_||e.isRendered()||(e.updateSize(),this.resetExtent_(),(0,C.listenOnce)(e,n.default.POSTRENDER,function(e){this.updateBox_()},this))},R.prototype.getCollapsible=function(){return this.collapsible_},R.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},R.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},R.prototype.getCollapsed=function(){return this.collapsed_},R.prototype.getOverviewMap=function(){return this.ovmap_},exports.default=R;
},{"../util.js":43,"../Collection.js":16,"../Map.js":26,"../MapEventType.js":97,"../MapProperty.js":101,"../Object.js":31,"../ObjectEventType.js":96,"../Overlay.js":33,"../OverlayPositioning.js":98,"../ViewProperty.js":129,"../control/Control.js":181,"../coordinate.js":89,"../css.js":99,"../dom.js":93,"../events.js":84,"../events/EventType.js":110,"../extent.js":90}],186:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Units=void 0,exports.render=c;var e=require("../util.js"),t=require("../Object.js"),i=require("../asserts.js"),n=require("../control/Control.js"),s=a(n),r=require("../css.js"),l=require("../events.js"),d=require("../proj.js"),h=require("../proj/Units.js"),o=a(h);function a(e){return e&&e.__esModule?e:{default:e}}const u="units",E=exports.Units={DEGREES:"degrees",IMPERIAL:"imperial",NAUTICAL:"nautical",METRIC:"metric",US:"us"},_=[1,2,5],m=function(e){const i=e||{},n=void 0!==i.className?i.className:"ol-scale-line";this.innerElement_=document.createElement("DIV"),this.innerElement_.className=n+"-inner",this.element_=document.createElement("DIV"),this.element_.className=n+" "+r.CLASS_UNSELECTABLE,this.element_.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=void 0!==i.minWidth?i.minWidth:64,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",s.default.call(this,{element:this.element_,render:i.render||c,target:i.target}),(0,l.listen)(this,(0,t.getChangeEventType)("units"),this.handleUnitsChanged_,this),this.setUnits(i.units||E.METRIC)};function c(e){const t=e.frameState;this.viewState_=t?t.viewState:null,this.updateElement_()}(0,e.inherits)(m,s.default),m.prototype.getUnits=function(){return this.get("units")},m.prototype.handleUnitsChanged_=function(){this.updateElement_()},m.prototype.setUnits=function(e){this.set("units",e)},m.prototype.updateElement_=function(){const e=this.viewState_;if(!e)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));const t=e.center,n=e.projection,s=this.getUnits(),r=s==E.DEGREES?o.default.DEGREES:o.default.METERS;let l=(0,d.getPointResolution)(n,e.resolution,t,r);n.getUnits()!=o.default.DEGREES&&n.getMetersPerUnit()&&r==o.default.METERS&&(l*=n.getMetersPerUnit());let h=this.minWidth_*l,a="";if(s==E.DEGREES){const e=d.METERS_PER_UNIT[o.default.DEGREES];n.getUnits()==o.default.DEGREES?h*=e:l/=e,h<e/60?(a="â€³",l*=3600):h<e?(a="â€²",l*=60):a="Â°"}else s==E.IMPERIAL?h<.9144?(a="in",l/=.0254):h<1609.344?(a="ft",l/=.3048):(a="mi",l/=1609.344):s==E.NAUTICAL?(l/=1852,a="nm"):s==E.METRIC?h<.001?(a="Î¼m",l*=1e6):h<1?(a="mm",l*=1e3):h<1e3?a="m":(a="km",l/=1e3):s==E.US?h<.9144?(a="in",l*=39.37):h<1609.344?(a="ft",l/=.30480061):(a="mi",l/=1609.3472):(0,i.assert)(!1,33);let u,m,c=3*Math.floor(Math.log(this.minWidth_*l)/Math.log(10));for(;;){if(u=_[(c%3+3)%3]*Math.pow(10,Math.floor(c/3)),m=Math.round(u/l),isNaN(m))return this.element_.style.display="none",void(this.renderedVisible_=!1);if(m>=this.minWidth_)break;++c}const p=u+" "+a;this.renderedHTML_!=p&&(this.innerElement_.innerHTML=p,this.renderedHTML_=p),this.renderedWidth_!=m&&(this.innerElement_.style.width=m+"px",this.renderedWidth_=m),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0)},exports.default=m;
},{"../util.js":43,"../Object.js":31,"../asserts.js":83,"../control/Control.js":181,"../css.js":99,"../events.js":84,"../proj.js":88,"../proj/Units.js":143}],188:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.render=v;var t=require("../util.js"),e=require("../ViewHint.js"),i=f(e),s=require("../control/Control.js"),n=f(s),o=require("../css.js"),r=require("../easing.js"),a=require("../events.js"),l=require("../events/Event.js"),h=require("../events/EventType.js"),u=f(h),d=require("../math.js"),g=require("../pointer/EventType.js"),_=f(g),p=require("../pointer/PointerEventHandler.js"),c=f(p);function f(t){return t&&t.__esModule?t:{default:t}}const m={VERTICAL:0,HORIZONTAL:1},R=function(t){const e=t||{};this.currentResolution_=void 0,this.direction_=m.VERTICAL,this.dragging_,this.heightLimit_=0,this.widthLimit_=0,this.previousX_,this.previousY_,this.thumbSize_=null,this.sliderInitialized_=!1,this.duration_=void 0!==e.duration?e.duration:200;const i=void 0!==e.className?e.className:"ol-zoomslider",s=document.createElement("button");s.setAttribute("type","button"),s.className=i+"-thumb "+o.CLASS_UNSELECTABLE;const r=document.createElement("div");r.className=i+" "+o.CLASS_UNSELECTABLE+" "+o.CLASS_CONTROL,r.appendChild(s),this.dragger_=new c.default(r),(0,a.listen)(this.dragger_,_.default.POINTERDOWN,this.handleDraggerStart_,this),(0,a.listen)(this.dragger_,_.default.POINTERMOVE,this.handleDraggerDrag_,this),(0,a.listen)(this.dragger_,_.default.POINTERUP,this.handleDraggerEnd_,this),(0,a.listen)(r,u.default.CLICK,this.handleContainerClick_,this),(0,a.listen)(s,u.default.CLICK,l.stopPropagation),n.default.call(this,{element:r,render:e.render||v})};function v(t){if(!t.frameState)return;this.sliderInitialized_||this.initSlider_();const e=t.frameState.viewState.resolution;e!==this.currentResolution_&&(this.currentResolution_=e,this.setThumbPosition_(e))}(0,t.inherits)(R,n.default),R.prototype.disposeInternal=function(){this.dragger_.dispose(),n.default.prototype.disposeInternal.call(this)},R.prototype.setMap=function(t){n.default.prototype.setMap.call(this,t),t&&t.render()},R.prototype.initSlider_=function(){const t=this.element,e=t.offsetWidth,i=t.offsetHeight,s=t.firstElementChild,n=getComputedStyle(s),o=s.offsetWidth+parseFloat(n.marginRight)+parseFloat(n.marginLeft),r=s.offsetHeight+parseFloat(n.marginTop)+parseFloat(n.marginBottom);this.thumbSize_=[o,r],e>i?(this.direction_=m.HORIZONTAL,this.widthLimit_=e-o):(this.direction_=m.VERTICAL,this.heightLimit_=i-r),this.sliderInitialized_=!0},R.prototype.handleContainerClick_=function(t){const e=this.getMap().getView(),i=this.getRelativePosition_(t.offsetX-this.thumbSize_[0]/2,t.offsetY-this.thumbSize_[1]/2),s=this.getResolutionForPosition_(i);e.animate({resolution:e.constrainResolution(s),duration:this.duration_,easing:r.easeOut})},R.prototype.handleDraggerStart_=function(t){this.dragging_||t.originalEvent.target!==this.element.firstElementChild||(this.getMap().getView().setHint(i.default.INTERACTING,1),this.previousX_=t.clientX,this.previousY_=t.clientY,this.dragging_=!0)},R.prototype.handleDraggerDrag_=function(t){if(this.dragging_){const e=this.element.firstElementChild,i=t.clientX-this.previousX_+parseInt(e.style.left,10),s=t.clientY-this.previousY_+parseInt(e.style.top,10),n=this.getRelativePosition_(i,s);this.currentResolution_=this.getResolutionForPosition_(n),this.getMap().getView().setResolution(this.currentResolution_),this.setThumbPosition_(this.currentResolution_),this.previousX_=t.clientX,this.previousY_=t.clientY}},R.prototype.handleDraggerEnd_=function(t){if(this.dragging_){const t=this.getMap().getView();t.setHint(i.default.INTERACTING,-1),t.animate({resolution:t.constrainResolution(this.currentResolution_),duration:this.duration_,easing:r.easeOut}),this.dragging_=!1,this.previousX_=void 0,this.previousY_=void 0}},R.prototype.setThumbPosition_=function(t){const e=this.getPositionForResolution_(t),i=this.element.firstElementChild;this.direction_==m.HORIZONTAL?i.style.left=this.widthLimit_*e+"px":i.style.top=this.heightLimit_*e+"px"},R.prototype.getRelativePosition_=function(t,e){let i;return i=this.direction_===m.HORIZONTAL?t/this.widthLimit_:e/this.heightLimit_,(0,d.clamp)(i,0,1)},R.prototype.getResolutionForPosition_=function(t){return this.getMap().getView().getResolutionForValueFunction()(1-t)},R.prototype.getPositionForResolution_=function(t){return 1-this.getMap().getView().getValueForResolutionFunction()(t)},exports.default=R;
},{"../util.js":43,"../ViewHint.js":102,"../control/Control.js":181,"../css.js":99,"../easing.js":106,"../events.js":84,"../events/Event.js":123,"../events/EventType.js":110,"../math.js":87,"../pointer/EventType.js":124,"../pointer/PointerEventHandler.js":125}],189:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util.js"),t=require("../events.js"),n=require("../events/EventType.js"),o=r(n),i=require("../control/Control.js"),l=r(i),s=require("../css.js");function r(e){return e&&e.__esModule?e:{default:e}}const a=function(e){const n=e||{};this.extent=n.extent?n.extent:null;const i=void 0!==n.className?n.className:"ol-zoom-extent",r=void 0!==n.label?n.label:"E",a=void 0!==n.tipLabel?n.tipLabel:"Fit to extent",u=document.createElement("button");u.setAttribute("type","button"),u.title=a,u.appendChild("string"==typeof r?document.createTextNode(r):r),(0,t.listen)(u,o.default.CLICK,this.handleClick_,this);const c=i+" "+s.CLASS_UNSELECTABLE+" "+s.CLASS_CONTROL,d=document.createElement("div");d.className=c,d.appendChild(u),l.default.call(this,{element:d,target:n.target})};(0,e.inherits)(a,l.default),a.prototype.handleClick_=function(e){e.preventDefault(),this.handleZoomToExtent()},a.prototype.handleZoomToExtent=function(){const e=this.getMap().getView(),t=this.extent?this.extent:e.getProjection().getExtent();e.fit(t)},exports.default=a;
},{"../util.js":43,"../events.js":84,"../events/EventType.js":110,"../control/Control.js":181,"../css.js":99}],109:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./control/Attribution.js");Object.defineProperty(exports,"Attribution",{enumerable:!0,get:function(){return f(e).default}});var r=require("./control/Control.js");Object.defineProperty(exports,"Control",{enumerable:!0,get:function(){return f(r).default}});var t=require("./control/FullScreen.js");Object.defineProperty(exports,"FullScreen",{enumerable:!0,get:function(){return f(t).default}});var o=require("./control/OverviewMap.js");Object.defineProperty(exports,"OverviewMap",{enumerable:!0,get:function(){return f(o).default}});var n=require("./control/Rotate.js");Object.defineProperty(exports,"Rotate",{enumerable:!0,get:function(){return f(n).default}});var u=require("./control/ScaleLine.js");Object.defineProperty(exports,"ScaleLine",{enumerable:!0,get:function(){return f(u).default}});var l=require("./control/Zoom.js");Object.defineProperty(exports,"Zoom",{enumerable:!0,get:function(){return f(l).default}});var i=require("./control/ZoomSlider.js");Object.defineProperty(exports,"ZoomSlider",{enumerable:!0,get:function(){return f(i).default}});var a=require("./control/ZoomToExtent.js");Object.defineProperty(exports,"ZoomToExtent",{enumerable:!0,get:function(){return f(a).default}});var c=require("./control/util.js");function f(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"defaults",{enumerable:!0,get:function(){return c.defaults}});
},{"./control/Attribution.js":184,"./control/Control.js":181,"./control/FullScreen.js":182,"./control/OverviewMap.js":183,"./control/Rotate.js":185,"./control/ScaleLine.js":186,"./control/Zoom.js":187,"./control/ZoomSlider.js":188,"./control/ZoomToExtent.js":189,"./control/util.js":122}],285:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../functions.js");const t=function(e){this.source_=e};t.prototype.getType=function(){},t.prototype.getSource=function(){return this.source_},t.prototype.isAnimated=e.FALSE,exports.default=t;
},{"../functions.js":103}],266:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util.js"),t=require("../webgl.js"),r=require("../webgl/Shader.js"),u=i(r);function i(e){return e&&e.__esModule?e:{default:e}}const l=function(e){u.default.call(this,e)};(0,e.inherits)(l,u.default),l.prototype.getType=function(){return t.FRAGMENT_SHADER},exports.default=l;
},{"../util.js":43,"../webgl.js":153,"../webgl/Shader.js":285}],267:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util.js"),t=require("../webgl.js"),r=require("../webgl/Shader.js"),u=i(r);function i(e){return e&&e.__esModule?e:{default:e}}const l=function(e){u.default.call(this,e)};(0,e.inherits)(l,u.default),l.prototype.getType=function(){return t.VERTEX_SHADER},exports.default=l;
},{"../util.js":43,"../webgl.js":153,"../webgl/Shader.js":285}],288:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.vertex=exports.fragment=void 0;var i=require("../../../webgl.js"),e=require("../../../webgl/Fragment.js"),t=a(e),o=require("../../../webgl/Vertex.js"),n=a(o);function a(i){return i&&i.__esModule?i:{default:i}}const r=exports.fragment=new t.default(i.DEBUG?"precision mediump float;\nvarying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_fillColor;\nuniform vec4 u_strokeColor;\nuniform vec2 u_size;\n\nvoid main(void) {\n  vec2 windowCenter = vec2((v_center.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_center.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  vec2 windowOffset = vec2((v_offset.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_offset.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  float radius = length(windowCenter - windowOffset);\n  float dist = length(windowCenter - gl_FragCoord.xy);\n  if (dist > radius + v_halfWidth) {\n    if (u_strokeColor.a == 0.0) {\n      gl_FragColor = u_fillColor;\n    } else {\n      gl_FragColor = u_strokeColor;\n    }\n    gl_FragColor.a = gl_FragColor.a - (dist - (radius + v_halfWidth));\n  } else if (u_fillColor.a == 0.0) {\n    // Hooray, no fill, just stroke. We can use real antialiasing.\n    gl_FragColor = u_strokeColor;\n    if (dist < radius - v_halfWidth) {\n      gl_FragColor.a = gl_FragColor.a - (radius - v_halfWidth - dist);\n    }\n  } else {\n    gl_FragColor = u_fillColor;\n    float strokeDist = radius - v_halfWidth;\n    float antialias = 2.0 * v_pixelRatio;\n    if (dist > strokeDist) {\n      gl_FragColor = u_strokeColor;\n    } else if (dist >= strokeDist - antialias) {\n      float step = smoothstep(strokeDist - antialias, strokeDist, dist);\n      gl_FragColor = mix(u_fillColor, u_strokeColor, step);\n    }\n  }\n  gl_FragColor.a = gl_FragColor.a * u_opacity;\n  if (gl_FragColor.a <= 0.0) {\n    discard;\n  }\n}\n":"precision mediump float;varying vec2 a;varying vec2 b;varying float c;varying float d;uniform float m;uniform vec4 n;uniform vec4 o;uniform vec2 p;void main(void){vec2 windowCenter=vec2((a.x+1.0)/2.0*p.x*d,(a.y+1.0)/2.0*p.y*d);vec2 windowOffset=vec2((b.x+1.0)/2.0*p.x*d,(b.y+1.0)/2.0*p.y*d);float radius=length(windowCenter-windowOffset);float dist=length(windowCenter-gl_FragCoord.xy);if(dist>radius+c){if(o.a==0.0){gl_FragColor=n;}else{gl_FragColor=o;}gl_FragColor.a=gl_FragColor.a-(dist-(radius+c));}else if(n.a==0.0){gl_FragColor=o;if(dist<radius-c){gl_FragColor.a=gl_FragColor.a-(radius-c-dist);}} else{gl_FragColor=n;float strokeDist=radius-c;float antialias=2.0*d;if(dist>strokeDist){gl_FragColor=o;}else if(dist>=strokeDist-antialias){float step=smoothstep(strokeDist-antialias,strokeDist,dist);gl_FragColor=mix(n,o,step);}} gl_FragColor.a=gl_FragColor.a*m;if(gl_FragColor.a<=0.0){discard;}}"),l=exports.vertex=new n.default(i.DEBUG?"varying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\nattribute vec2 a_position;\nattribute float a_instruction;\nattribute float a_radius;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  v_center = vec4(u_projectionMatrix * vec4(a_position, 0.0, 1.0)).xy;\n  v_pixelRatio = u_pixelRatio;\n  float lineWidth = u_lineWidth * u_pixelRatio;\n  v_halfWidth = lineWidth / 2.0;\n  if (lineWidth == 0.0) {\n    lineWidth = 2.0 * u_pixelRatio;\n  }\n  vec2 offset;\n  // Radius with anitaliasing (roughly).\n  float radius = a_radius + 3.0 * u_pixelRatio;\n  // Until we get gl_VertexID in WebGL, we store an instruction.\n  if (a_instruction == 0.0) {\n    // Offsetting the edges of the triangle by lineWidth / 2 is necessary, however\n    // we should also leave some space for the antialiasing, thus we offset by lineWidth.\n    offset = vec2(-1.0, 1.0);\n  } else if (a_instruction == 1.0) {\n    offset = vec2(-1.0, -1.0);\n  } else if (a_instruction == 2.0) {\n    offset = vec2(1.0, -1.0);\n  } else {\n    offset = vec2(1.0, 1.0);\n  }\n\n  gl_Position = u_projectionMatrix * vec4(a_position + offset * radius, 0.0, 1.0) +\n      offsetMatrix * vec4(offset * lineWidth, 0.0, 0.0);\n  v_offset = vec4(u_projectionMatrix * vec4(a_position.x + a_radius, a_position.y,\n      0.0, 1.0)).xy;\n\n  if (distance(v_center, v_offset) > 20000.0) {\n    gl_Position = vec4(v_center, 0.0, 1.0);\n  }\n}\n\n\n":"varying vec2 a;varying vec2 b;varying float c;varying float d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;void main(void){mat4 offsetMatrix=i*j;a=vec4(h*vec4(e,0.0,1.0)).xy;d=l;float lineWidth=k*l;c=lineWidth/2.0;if(lineWidth==0.0){lineWidth=2.0*l;}vec2 offset;float radius=g+3.0*l;if(f==0.0){offset=vec2(-1.0,1.0);}else if(f==1.0){offset=vec2(-1.0,-1.0);}else if(f==2.0){offset=vec2(1.0,-1.0);}else{offset=vec2(1.0,1.0);}gl_Position=h*vec4(e+offset*radius,0.0,1.0)+offsetMatrix*vec4(offset*lineWidth,0.0,0.0);b=vec4(h*vec4(e.x+g,e.y,0.0,1.0)).xy;if(distance(a,b)>20000.0){gl_Position=vec4(a,0.0,1.0);}}");
},{"../../../webgl.js":153,"../../../webgl/Fragment.js":266,"../../../webgl/Vertex.js":267}],289:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../../../webgl.js");const i=function(i,o){this.u_projectionMatrix=i.getUniformLocation(o,t.DEBUG?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=i.getUniformLocation(o,t.DEBUG?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=i.getUniformLocation(o,t.DEBUG?"u_offsetRotateMatrix":"j"),this.u_lineWidth=i.getUniformLocation(o,t.DEBUG?"u_lineWidth":"k"),this.u_pixelRatio=i.getUniformLocation(o,t.DEBUG?"u_pixelRatio":"l"),this.u_opacity=i.getUniformLocation(o,t.DEBUG?"u_opacity":"m"),this.u_fillColor=i.getUniformLocation(o,t.DEBUG?"u_fillColor":"n"),this.u_strokeColor=i.getUniformLocation(o,t.DEBUG?"u_strokeColor":"o"),this.u_size=i.getUniformLocation(o,t.DEBUG?"u_size":"p"),this.a_position=i.getAttribLocation(o,t.DEBUG?"a_position":"e"),this.a_instruction=i.getAttribLocation(o,t.DEBUG?"a_instruction":"f"),this.a_radius=i.getAttribLocation(o,t.DEBUG?"a_radius":"g")};exports.default=i;
},{"../../../../webgl.js":153}],269:[function(require,module,exports) {
"use strict";function e(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function r(e,r){return e[0]=r[0],e[1]=r[1],e[4]=r[2],e[5]=r[3],e[12]=r[4],e[13]=r[5],e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=e,exports.fromTransform=r;
},{}],287:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../util.js"),e=require("../../extent.js"),r=require("../VectorContext.js"),i=o(r),n=require("../../transform.js"),a=require("../../vec/mat4.js"),s=require("../../webgl.js");function o(t){return t&&t.__esModule?t:{default:t}}const c=function(t,r){i.default.call(this),this.tolerance=t,this.maxExtent=r,this.origin=(0,e.getCenter)(r),this.projectionMatrix_=(0,n.create)(),this.offsetRotateMatrix_=(0,n.create)(),this.offsetScaleMatrix_=(0,n.create)(),this.tmpMat4_=(0,a.create)(),this.indices=[],this.indicesBuffer=null,this.startIndices=[],this.startIndicesFeature=[],this.vertices=[],this.verticesBuffer=null,this.lineStringReplay=void 0};(0,t.inherits)(c,i.default),c.prototype.getDeleteResourcesFunction=function(t){},c.prototype.finish=function(t){},c.prototype.setUpProgram=function(t,e,r,i){},c.prototype.shutDownProgram=function(t,e){},c.prototype.drawReplay=function(t,e,r,i){},c.prototype.drawHitDetectionReplayOneByOne=function(t,e,r,i,n){},c.prototype.drawHitDetectionReplay=function(t,e,r,i,n,a){return n?this.drawHitDetectionReplayOneByOne(t,e,r,i,a):this.drawHitDetectionReplayAll(t,e,r,i)},c.prototype.drawHitDetectionReplayAll=function(t,e,r,i){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawReplay(t,e,r,!0);const n=i(null);return n||void 0},c.prototype.replay=function(t,e,r,i,o,c,l,f,u,p,E){const _=t.getGL();let h,S,T,R,d,m,y,I;this.lineStringReplay&&(h=_.isEnabled(_.STENCIL_TEST),S=_.getParameter(_.STENCIL_FUNC),T=_.getParameter(_.STENCIL_VALUE_MASK),R=_.getParameter(_.STENCIL_REF),d=_.getParameter(_.STENCIL_WRITEMASK),m=_.getParameter(_.STENCIL_FAIL),y=_.getParameter(_.STENCIL_PASS_DEPTH_PASS),I=_.getParameter(_.STENCIL_PASS_DEPTH_FAIL),_.enable(_.STENCIL_TEST),_.clear(_.STENCIL_BUFFER_BIT),_.stencilMask(255),_.stencilFunc(_.ALWAYS,1,255),_.stencilOp(_.KEEP,_.KEEP,_.REPLACE),this.lineStringReplay.replay(t,e,r,i,o,c,l,f,u,p,E),_.stencilMask(0),_.stencilFunc(_.NOTEQUAL,1,255)),t.bindBuffer(s.ARRAY_BUFFER,this.verticesBuffer),t.bindBuffer(s.ELEMENT_ARRAY_BUFFER,this.indicesBuffer);const M=this.setUpProgram(_,t,o,c),g=(0,n.reset)(this.projectionMatrix_);(0,n.scale)(g,2/(r*o[0]),2/(r*o[1])),(0,n.rotate)(g,-i),(0,n.translate)(g,-(e[0]-this.origin[0]),-(e[1]-this.origin[1]));const L=(0,n.reset)(this.offsetScaleMatrix_);(0,n.scale)(L,2/o[0],2/o[1]);const F=(0,n.reset)(this.offsetRotateMatrix_);let N;return 0!==i&&(0,n.rotate)(F,-i),_.uniformMatrix4fv(M.u_projectionMatrix,!1,(0,a.fromTransform)(this.tmpMat4_,g)),_.uniformMatrix4fv(M.u_offsetScaleMatrix,!1,(0,a.fromTransform)(this.tmpMat4_,L)),_.uniformMatrix4fv(M.u_offsetRotateMatrix,!1,(0,a.fromTransform)(this.tmpMat4_,F)),_.uniform1f(M.u_opacity,l),void 0===u?this.drawReplay(_,t,f,!1):N=this.drawHitDetectionReplay(_,t,f,u,p,E),this.shutDownProgram(_,M),this.lineStringReplay&&(h||_.disable(_.STENCIL_TEST),_.clear(_.STENCIL_BUFFER_BIT),_.stencilFunc(S,R,T),_.stencilMask(d),_.stencilOp(m,I,y)),N},c.prototype.drawElements=function(t,e,r,i){const n=e.hasOESElementIndexUint?s.UNSIGNED_INT:s.UNSIGNED_SHORT,a=i-r,o=r*(e.hasOESElementIndexUint?4:2);t.drawElements(s.TRIANGLES,a,n,o)},exports.default=c;
},{"../../util.js":43,"../../extent.js":90,"../VectorContext.js":258,"../../transform.js":105,"../../vec/mat4.js":269,"../../webgl.js":153}],286:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=exports.DEFAULT_FONT="10px sans-serif",E=exports.DEFAULT_FILLSTYLE=[0,0,0,1],r=exports.DEFAULT_LINECAP="round",L=exports.DEFAULT_LINEDASH=[],o=exports.DEFAULT_LINEDASHOFFSET=0,s=exports.DEFAULT_LINEJOIN="round",t=exports.DEFAULT_MITERLIMIT=10,T=exports.DEFAULT_STROKESTYLE=[0,0,0,1],p=exports.DEFAULT_TEXTALIGN=.5,A=exports.DEFAULT_TEXTBASELINE=.5,I=exports.DEFAULT_LINEWIDTH=1,x=exports.EPSILON=Number.EPSILON||2.220446049250313e-16,F=exports.triangleIsCounterClockwise=function(e,E,r,L,o,s){const t=(r-e)*(s-E)-(o-e)*(L-E);return t<=x&&t>=-x?void 0:t>0};
},{}],233:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../webgl.js");const t={STATIC_DRAW:e.STATIC_DRAW,STREAM_DRAW:e.STREAM_DRAW,DYNAMIC_DRAW:e.DYNAMIC_DRAW},r=function(e,r){this.arr_=void 0!==e?e:[],this.usage_=void 0!==r?r:t.STATIC_DRAW};r.prototype.getArray=function(){return this.arr_},r.prototype.getUsage=function(){return this.usage_},exports.default=r;
},{"../webgl.js":153}],276:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../util.js"),e=require("../../array.js"),s=require("../../color.js"),i=require("../../extent.js"),r=require("../../obj.js"),n=require("../../geom/flat/transform.js"),l=require("../webgl/circlereplay/defaultshader.js"),a=require("../webgl/circlereplay/defaultshader/Locations.js"),o=y(a),h=require("../webgl/Replay.js"),c=y(h),d=require("../webgl.js"),u=require("../../webgl.js"),_=require("../../webgl/Buffer.js"),f=y(_);function y(t){return t&&t.__esModule?t:{default:t}}const g=function(t,e){c.default.call(this,t,e),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.radius_=0,this.state_={fillColor:null,strokeColor:null,lineDash:null,lineDashOffset:void 0,lineWidth:void 0,changed:!1}};(0,t.inherits)(g,c.default),g.prototype.drawCoordinates_=function(t,e,s,i){let r,n,l=this.vertices.length,a=this.indices.length,o=l/4;for(r=e,n=s;r<n;r+=i)this.vertices[l++]=t[r],this.vertices[l++]=t[r+1],this.vertices[l++]=0,this.vertices[l++]=this.radius_,this.vertices[l++]=t[r],this.vertices[l++]=t[r+1],this.vertices[l++]=1,this.vertices[l++]=this.radius_,this.vertices[l++]=t[r],this.vertices[l++]=t[r+1],this.vertices[l++]=2,this.vertices[l++]=this.radius_,this.vertices[l++]=t[r],this.vertices[l++]=t[r+1],this.vertices[l++]=3,this.vertices[l++]=this.radius_,this.indices[a++]=o,this.indices[a++]=o+1,this.indices[a++]=o+2,this.indices[a++]=o+2,this.indices[a++]=o+3,this.indices[a++]=o,o+=4},g.prototype.drawCircle=function(t,e){const s=t.getRadius(),i=t.getStride();if(s){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.radius_=s;let r=t.getFlatCoordinates();r=(0,n.translate)(r,0,2,i,-this.origin[0],-this.origin[1]),this.drawCoordinates_(r,0,2,i)}else if(this.state_.changed&&(this.styles_.pop(),this.styles_.length)){const t=this.styles_[this.styles_.length-1];this.state_.fillColor=t[0],this.state_.strokeColor=t[1],this.state_.lineWidth=t[2],this.state_.changed=!1}},g.prototype.finish=function(t){this.verticesBuffer=new f.default(this.vertices),this.indicesBuffer=new f.default(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},g.prototype.getDeleteResourcesFunction=function(t){const e=this.verticesBuffer,s=this.indicesBuffer;return function(){t.deleteBuffer(e),t.deleteBuffer(s)}},g.prototype.setUpProgram=function(t,e,s,i){const r=e.getProgram(l.fragment,l.vertex);let n;return this.defaultLocations_?n=this.defaultLocations_:(n=new o.default(t,r),this.defaultLocations_=n),e.useProgram(r),t.enableVertexAttribArray(n.a_position),t.vertexAttribPointer(n.a_position,2,u.FLOAT,!1,16,0),t.enableVertexAttribArray(n.a_instruction),t.vertexAttribPointer(n.a_instruction,1,u.FLOAT,!1,16,8),t.enableVertexAttribArray(n.a_radius),t.vertexAttribPointer(n.a_radius,1,u.FLOAT,!1,16,12),t.uniform2fv(n.u_size,s),t.uniform1f(n.u_pixelRatio,i),n},g.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_instruction),t.disableVertexAttribArray(e.a_radius)},g.prototype.drawReplay=function(t,e,s,i){if((0,r.isEmpty)(s)){let s,i,r,n;for(r=this.startIndices[this.startIndices.length-1],s=this.styleIndices_.length-1;s>=0;--s)i=this.styleIndices_[s],n=this.styles_[s],this.setFillStyle_(t,n[0]),this.setStrokeStyle_(t,n[1],n[2]),this.drawElements(t,e,i,r),r=i}else this.drawReplaySkipping_(t,e,s)},g.prototype.drawHitDetectionReplayOneByOne=function(e,s,r,n,l){let a,o,h,c,d,u,_,f;for(f=this.startIndices.length-2,h=this.startIndices[f+1],a=this.styleIndices_.length-1;a>=0;--a)for(c=this.styles_[a],this.setFillStyle_(e,c[0]),this.setStrokeStyle_(e,c[1],c[2]),d=this.styleIndices_[a];f>=0&&this.startIndices[f]>=d;){if(o=this.startIndices[f],u=this.startIndicesFeature[f],void 0===r[_=(0,t.getUid)(u).toString()]&&u.getGeometry()&&(void 0===l||(0,i.intersects)(l,u.getGeometry().getExtent()))){e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),this.drawElements(e,s,o,h);const t=n(u);if(t)return t}f--,h=o}},g.prototype.drawReplaySkipping_=function(e,s,i){let r,n,l,a,o,h,c,d,u;for(d=this.startIndices.length-2,l=n=this.startIndices[d+1],r=this.styleIndices_.length-1;r>=0;--r){for(a=this.styles_[r],this.setFillStyle_(e,a[0]),this.setStrokeStyle_(e,a[1],a[2]),o=this.styleIndices_[r];d>=0&&this.startIndices[d]>=o;)u=this.startIndices[d],h=this.startIndicesFeature[d],i[c=(0,t.getUid)(h).toString()]&&(n!==l&&this.drawElements(e,s,n,l),l=u),d--,n=u;n!==l&&this.drawElements(e,s,n,l),n=l=o}},g.prototype.setFillStyle_=function(t,e){t.uniform4fv(this.defaultLocations_.u_fillColor,e)},g.prototype.setStrokeStyle_=function(t,e,s){t.uniform4fv(this.defaultLocations_.u_strokeColor,e),t.uniform1f(this.defaultLocations_.u_lineWidth,s)},g.prototype.setFillStrokeStyle=function(t,i){let r,n;if(i){const t=i.getLineDash();this.state_.lineDash=t||d.DEFAULT_LINEDASH;const e=i.getLineDashOffset();this.state_.lineDashOffset=e||d.DEFAULT_LINEDASHOFFSET,r=(r=i.getColor())instanceof CanvasGradient||r instanceof CanvasPattern?d.DEFAULT_STROKESTYLE:(0,s.asArray)(r).map(function(t,e){return 3!=e?t/255:t})||d.DEFAULT_STROKESTYLE,n=void 0!==(n=i.getWidth())?n:d.DEFAULT_LINEWIDTH}else r=[0,0,0,0],n=0;let l=t?t.getColor():[0,0,0,0];l=l instanceof CanvasGradient||l instanceof CanvasPattern?d.DEFAULT_FILLSTYLE:(0,s.asArray)(l).map(function(t,e){return 3!=e?t/255:t})||d.DEFAULT_FILLSTYLE,this.state_.strokeColor&&(0,e.equals)(this.state_.strokeColor,r)&&this.state_.fillColor&&(0,e.equals)(this.state_.fillColor,l)&&this.state_.lineWidth===n||(this.state_.changed=!0,this.state_.fillColor=l,this.state_.strokeColor=r,this.state_.lineWidth=n,this.styles_.push([l,r,n]))},exports.default=g;
},{"../../util.js":43,"../../array.js":130,"../../color.js":209,"../../extent.js":90,"../../obj.js":74,"../../geom/flat/transform.js":192,"../webgl/circlereplay/defaultshader.js":288,"../webgl/circlereplay/defaultshader/Locations.js":289,"../webgl/Replay.js":287,"../webgl.js":286,"../../webgl.js":153,"../../webgl/Buffer.js":233}],301:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.vertex=exports.fragment=void 0;var t=require("../../../webgl.js"),e=require("../../../webgl/Fragment.js"),a=i(e),o=require("../../../webgl/Vertex.js"),r=i(o);function i(t){return t&&t.__esModule?t:{default:t}}const n=exports.fragment=new a.default(t.DEBUG?"precision mediump float;\nvarying vec2 v_texCoord;\nvarying float v_opacity;\n\nuniform float u_opacity;\nuniform sampler2D u_image;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  float alpha = texColor.a * v_opacity * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying vec2 a;varying float b;uniform float k;uniform sampler2D l;void main(void){vec4 texColor=texture2D(l,a);gl_FragColor.rgb=texColor.rgb;float alpha=texColor.a*b*k;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),f=exports.vertex=new r.default(t.DEBUG?"varying vec2 v_texCoord;\nvarying float v_opacity;\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_offsets;\nattribute float a_opacity;\nattribute float a_rotateWithView;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix;\n  if (a_rotateWithView == 1.0) {\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  }\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  v_texCoord = a_texCoord;\n  v_opacity = a_opacity;\n}\n\n\n":"varying vec2 a;varying float b;attribute vec2 c;attribute vec2 d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;void main(void){mat4 offsetMatrix=i;if(g==1.0){offsetMatrix=i*j;}vec4 offsets=offsetMatrix*vec4(e,0.0,0.0);gl_Position=h*vec4(c,0.0,1.0)+offsets;a=d;b=f;}");
},{"../../../webgl.js":153,"../../../webgl/Fragment.js":266,"../../../webgl/Vertex.js":267}],302:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../../../webgl.js");const i=function(i,o){this.u_projectionMatrix=i.getUniformLocation(o,t.DEBUG?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=i.getUniformLocation(o,t.DEBUG?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=i.getUniformLocation(o,t.DEBUG?"u_offsetRotateMatrix":"j"),this.u_opacity=i.getUniformLocation(o,t.DEBUG?"u_opacity":"k"),this.u_image=i.getUniformLocation(o,t.DEBUG?"u_image":"l"),this.a_position=i.getAttribLocation(o,t.DEBUG?"a_position":"c"),this.a_texCoord=i.getAttribLocation(o,t.DEBUG?"a_texCoord":"d"),this.a_offsets=i.getAttribLocation(o,t.DEBUG?"a_offsets":"e"),this.a_opacity=i.getAttribLocation(o,t.DEBUG?"a_opacity":"f"),this.a_rotateWithView=i.getAttribLocation(o,t.DEBUG?"a_rotateWithView":"g")};exports.default=i;
},{"../../../../webgl.js":153}],231:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};
},{}],230:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createEmptyTexture=_,exports.createTexture=E;var e=require("../util.js"),t=require("../webgl.js"),r=require("../Disposable.js"),i=o(r),n=require("../array.js"),s=require("../events.js"),a=require("../obj.js"),u=require("../webgl/ContextEventType.js"),h=o(u);function o(e){return e&&e.__esModule?e:{default:e}}const f=function(e,r){this.canvas_=e,this.gl_=r,this.bufferCache_={},this.shaderCache_={},this.programCache_={},this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null,this.hasOESElementIndexUint=(0,n.includes)(t.EXTENSIONS,"OES_element_index_uint"),this.hasOESElementIndexUint&&r.getExtension("OES_element_index_uint"),(0,s.listen)(this.canvas_,h.default.LOST,this.handleWebGLContextLost,this),(0,s.listen)(this.canvas_,h.default.RESTORED,this.handleWebGLContextRestored,this)};function c(e,r,i){const n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),void 0!==r&&e.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,r),void 0!==i&&e.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,i),n}function _(e,t,r,i,n){const s=c(e,i,n);return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,r,0,e.RGBA,e.UNSIGNED_BYTE,null),s}function E(e,t,r,i){const n=c(e,r,i);return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),n}(0,e.inherits)(f,i.default),f.prototype.bindBuffer=function(r,i){const n=this.getGL(),s=i.getArray(),a=String((0,e.getUid)(i));if(a in this.bufferCache_){const e=this.bufferCache_[a];n.bindBuffer(r,e.buffer)}else{const e=n.createBuffer();let u;n.bindBuffer(r,e),r==t.ARRAY_BUFFER?u=new Float32Array(s):r==t.ELEMENT_ARRAY_BUFFER&&(u=this.hasOESElementIndexUint?new Uint32Array(s):new Uint16Array(s)),n.bufferData(r,u,i.getUsage()),this.bufferCache_[a]={buf:i,buffer:e}}},f.prototype.deleteBuffer=function(t){const r=this.getGL(),i=String((0,e.getUid)(t)),n=this.bufferCache_[i];r.isContextLost()||r.deleteBuffer(n.buffer),delete this.bufferCache_[i]},f.prototype.disposeInternal=function(){(0,s.unlistenAll)(this.canvas_);const e=this.getGL();if(!e.isContextLost()){for(const t in this.bufferCache_)e.deleteBuffer(this.bufferCache_[t].buffer);for(const t in this.programCache_)e.deleteProgram(this.programCache_[t]);for(const t in this.shaderCache_)e.deleteShader(this.shaderCache_[t]);e.deleteFramebuffer(this.hitDetectionFramebuffer_),e.deleteRenderbuffer(this.hitDetectionRenderbuffer_),e.deleteTexture(this.hitDetectionTexture_)}},f.prototype.getCanvas=function(){return this.canvas_},f.prototype.getGL=function(){return this.gl_},f.prototype.getHitDetectionFramebuffer=function(){return this.hitDetectionFramebuffer_||this.initHitDetectionFramebuffer_(),this.hitDetectionFramebuffer_},f.prototype.getShader=function(t){const r=String((0,e.getUid)(t));if(r in this.shaderCache_)return this.shaderCache_[r];{const e=this.getGL(),i=e.createShader(t.getType());return e.shaderSource(i,t.getSource()),e.compileShader(i),this.shaderCache_[r]=i,i}},f.prototype.getProgram=function(t,r){const i=(0,e.getUid)(t)+"/"+(0,e.getUid)(r);if(i in this.programCache_)return this.programCache_[i];{const e=this.getGL(),n=e.createProgram();return e.attachShader(n,this.getShader(t)),e.attachShader(n,this.getShader(r)),e.linkProgram(n),this.programCache_[i]=n,n}},f.prototype.handleWebGLContextLost=function(){(0,a.clear)(this.bufferCache_),(0,a.clear)(this.shaderCache_),(0,a.clear)(this.programCache_),this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null},f.prototype.handleWebGLContextRestored=function(){},f.prototype.initHitDetectionFramebuffer_=function(){const e=this.gl_,t=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,t);const r=_(e,1,1),i=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,i),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,1,1),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,i),e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),this.hitDetectionFramebuffer_=t,this.hitDetectionTexture_=r,this.hitDetectionRenderbuffer_=i},f.prototype.useProgram=function(e){if(e==this.currentProgram_)return!1;return this.getGL().useProgram(e),this.currentProgram_=e,!0},exports.default=f;
},{"../util.js":43,"../webgl.js":153,"../Disposable.js":17,"../array.js":130,"../events.js":84,"../obj.js":74,"../webgl/ContextEventType.js":231}],292:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../util.js"),e=require("../../extent.js"),i=require("../../obj.js"),s=require("../webgl/texturereplay/defaultshader.js"),r=require("../webgl/texturereplay/defaultshader/Locations.js"),o=d(r),h=require("../webgl/Replay.js"),n=d(h),a=require("../../webgl.js"),c=require("../../webgl/Context.js");function d(t){return t&&t.__esModule?t:{default:t}}const l=function(t,e){n.default.call(this,t,e),this.anchorX=void 0,this.anchorY=void 0,this.groupIndices=[],this.hitDetectionGroupIndices=[],this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.defaultLocations=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.width=void 0};(0,t.inherits)(l,n.default),l.prototype.getDeleteResourcesFunction=function(t){const e=this.verticesBuffer,i=this.indicesBuffer,s=this.getTextures(!0),r=t.getGL();return function(){if(!r.isContextLost()){let t,e;for(t=0,e=s.length;t<e;++t)r.deleteTexture(s[t])}t.deleteBuffer(e),t.deleteBuffer(i)}},l.prototype.drawCoordinates=function(t,e,i,s){const r=this.anchorX,o=this.anchorY,h=this.height,n=this.imageHeight,a=this.imageWidth,c=this.opacity,d=this.originX,l=this.originY,u=this.rotateWithView?1:0,v=-this.rotation,g=this.scale,f=this.width,p=Math.cos(v),x=Math.sin(v);let y,b,A,_,T,w,E=this.indices.length,I=this.vertices.length;for(y=e;y<i;y+=s)T=t[y]-this.origin[0],w=t[y+1]-this.origin[1],b=I/8,A=-g*r,_=-g*(h-o),this.vertices[I++]=T,this.vertices[I++]=w,this.vertices[I++]=A*p-_*x,this.vertices[I++]=A*x+_*p,this.vertices[I++]=d/a,this.vertices[I++]=(l+h)/n,this.vertices[I++]=c,this.vertices[I++]=u,A=g*(f-r),_=-g*(h-o),this.vertices[I++]=T,this.vertices[I++]=w,this.vertices[I++]=A*p-_*x,this.vertices[I++]=A*x+_*p,this.vertices[I++]=(d+f)/a,this.vertices[I++]=(l+h)/n,this.vertices[I++]=c,this.vertices[I++]=u,A=g*(f-r),_=g*o,this.vertices[I++]=T,this.vertices[I++]=w,this.vertices[I++]=A*p-_*x,this.vertices[I++]=A*x+_*p,this.vertices[I++]=(d+f)/a,this.vertices[I++]=l/n,this.vertices[I++]=c,this.vertices[I++]=u,A=-g*r,_=g*o,this.vertices[I++]=T,this.vertices[I++]=w,this.vertices[I++]=A*p-_*x,this.vertices[I++]=A*x+_*p,this.vertices[I++]=d/a,this.vertices[I++]=l/n,this.vertices[I++]=c,this.vertices[I++]=u,this.indices[E++]=b,this.indices[E++]=b+1,this.indices[E++]=b+2,this.indices[E++]=b,this.indices[E++]=b+2,this.indices[E++]=b+3;return I},l.prototype.createTextures=function(e,i,s,r){let o,h,n,d;const l=i.length;for(d=0;d<l;++d)h=i[d],(n=(0,t.getUid)(h).toString())in s?o=s[n]:(o=(0,c.createTexture)(r,h,a.CLAMP_TO_EDGE,a.CLAMP_TO_EDGE),s[n]=o),e[d]=o},l.prototype.setUpProgram=function(t,e,i,r){const h=e.getProgram(s.fragment,s.vertex);let n;return this.defaultLocations?n=this.defaultLocations:(n=new o.default(t,h),this.defaultLocations=n),e.useProgram(h),t.enableVertexAttribArray(n.a_position),t.vertexAttribPointer(n.a_position,2,a.FLOAT,!1,32,0),t.enableVertexAttribArray(n.a_offsets),t.vertexAttribPointer(n.a_offsets,2,a.FLOAT,!1,32,8),t.enableVertexAttribArray(n.a_texCoord),t.vertexAttribPointer(n.a_texCoord,2,a.FLOAT,!1,32,16),t.enableVertexAttribArray(n.a_opacity),t.vertexAttribPointer(n.a_opacity,1,a.FLOAT,!1,32,24),t.enableVertexAttribArray(n.a_rotateWithView),t.vertexAttribPointer(n.a_rotateWithView,1,a.FLOAT,!1,32,28),n},l.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_offsets),t.disableVertexAttribArray(e.a_texCoord),t.disableVertexAttribArray(e.a_opacity),t.disableVertexAttribArray(e.a_rotateWithView)},l.prototype.drawReplay=function(t,e,s,r){const o=r?this.getHitDetectionTextures():this.getTextures(),h=r?this.hitDetectionGroupIndices:this.groupIndices;if((0,i.isEmpty)(s)){let i,s,r;for(i=0,s=o.length,r=0;i<s;++i){t.bindTexture(a.TEXTURE_2D,o[i]);const s=h[i];this.drawElements(t,e,r,s),r=s}}else this.drawReplaySkipping(t,e,s,o,h)},l.prototype.drawReplaySkipping=function(e,i,s,r,o){let h,n,c=0;for(h=0,n=r.length;h<n;++h){e.bindTexture(a.TEXTURE_2D,r[h]);const n=h>0?o[h-1]:0,d=o[h];let l=n,u=n;for(;c<this.startIndices.length&&this.startIndices[c]<=d;){const r=this.startIndicesFeature[c];void 0!==s[(0,t.getUid)(r).toString()]?(l!==u&&this.drawElements(e,i,l,u),u=l=c===this.startIndices.length-1?d:this.startIndices[c+1]):u=c===this.startIndices.length-1?d:this.startIndices[c+1],c++}l!==u&&this.drawElements(e,i,l,u)}},l.prototype.drawHitDetectionReplayOneByOne=function(i,s,r,o,h){let n,c,d,l,u,v,g=this.startIndices.length-1;const f=this.getHitDetectionTextures();for(n=f.length-1;n>=0;--n)for(i.bindTexture(a.TEXTURE_2D,f[n]),c=n>0?this.hitDetectionGroupIndices[n-1]:0,l=this.hitDetectionGroupIndices[n];g>=0&&this.startIndices[g]>=c;){if(d=this.startIndices[g],u=this.startIndicesFeature[g],void 0===r[v=(0,t.getUid)(u).toString()]&&u.getGeometry()&&(void 0===h||(0,e.intersects)(h,u.getGeometry().getExtent()))){i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),this.drawElements(i,s,d,l);const t=o(u);if(t)return t}l=d,g--}},l.prototype.finish=function(t){this.anchorX=void 0,this.anchorY=void 0,this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.indices=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.vertices=null,this.width=void 0},l.prototype.getTextures=function(t){},l.prototype.getHitDetectionTextures=function(){},exports.default=l;
},{"../../util.js":43,"../../extent.js":90,"../../obj.js":74,"../webgl/texturereplay/defaultshader.js":301,"../webgl/texturereplay/defaultshader/Locations.js":302,"../webgl/Replay.js":287,"../../webgl.js":153,"../../webgl/Context.js":230}],277:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../util.js"),e=require("../webgl/TextureReplay.js"),i=n(e),s=require("../../webgl/Buffer.js"),h=n(s);function n(t){return t&&t.__esModule?t:{default:t}}const o=function(t,e){i.default.call(this,t,e),this.images_=[],this.hitDetectionImages_=[],this.textures_=[],this.hitDetectionTextures_=[]};(0,t.inherits)(o,i.default),o.prototype.drawMultiPoint=function(t,e){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);const i=t.getFlatCoordinates(),s=t.getStride();this.drawCoordinates(i,0,i.length,s)},o.prototype.drawPoint=function(t,e){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);const i=t.getFlatCoordinates(),s=t.getStride();this.drawCoordinates(i,0,i.length,s)},o.prototype.finish=function(t){const e=t.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices.push(this.indices.length),this.verticesBuffer=new h.default(this.vertices);const s=this.indices;this.indicesBuffer=new h.default(s);const n={};this.createTextures(this.textures_,this.images_,n,e),this.createTextures(this.hitDetectionTextures_,this.hitDetectionImages_,n,e),this.images_=null,this.hitDetectionImages_=null,i.default.prototype.finish.call(this,t)},o.prototype.setImageStyle=function(e){const i=e.getAnchor(),s=e.getImage(1),h=e.getImageSize(),n=e.getHitDetectionImage(1),o=e.getOpacity(),r=e.getOrigin(),c=e.getRotateWithView(),g=e.getRotation(),a=e.getSize(),u=e.getScale();let d;0===this.images_.length?this.images_.push(s):(d=this.images_[this.images_.length-1],(0,t.getUid)(d)!=(0,t.getUid)(s)&&(this.groupIndices.push(this.indices.length),this.images_.push(s))),0===this.hitDetectionImages_.length?this.hitDetectionImages_.push(n):(d=this.hitDetectionImages_[this.hitDetectionImages_.length-1],(0,t.getUid)(d)!=(0,t.getUid)(n)&&(this.hitDetectionGroupIndices.push(this.indices.length),this.hitDetectionImages_.push(n))),this.anchorX=i[0],this.anchorY=i[1],this.height=a[1],this.imageHeight=h[1],this.imageWidth=h[0],this.opacity=o,this.originX=r[0],this.originY=r[1],this.rotation=g,this.rotateWithView=c,this.scale=u,this.width=a[0]},o.prototype.getTextures=function(t){return t?this.textures_.concat(this.hitDetectionTextures_):this.textures_},o.prototype.getHitDetectionTextures=function(){return this.hitDetectionTextures_},exports.default=o;
},{"../../util.js":43,"../webgl/TextureReplay.js":292,"../../webgl/Buffer.js":233}],297:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.lineStringIsClosed=r;var e=require("../flat/area.js");function r(r,t,n,s){const i=n-s;return r[t]===r[i]&&r[t+1]===r[i+1]&&(n-t)/s>3&&!!(0,e.linearRing)(r,t,n,s)}
},{"../flat/area.js":196}],298:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.vertex=exports.fragment=void 0;var e=require("../../../webgl.js"),o=require("../../../webgl/Fragment.js"),t=i(o),n=require("../../../webgl/Vertex.js"),r=i(n);function i(e){return e&&e.__esModule?e:{default:e}}const a=exports.fragment=new t.default(e.DEBUG?"precision mediump float;\nvarying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_color;\nuniform vec2 u_size;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  if (v_round > 0.0) {\n    vec2 windowCoords = vec2((v_roundVertex.x + 1.0) / 2.0 * u_size.x * u_pixelRatio,\n        (v_roundVertex.y + 1.0) / 2.0 * u_size.y * u_pixelRatio);\n    if (length(windowCoords - gl_FragCoord.xy) > v_halfWidth * u_pixelRatio) {\n      discard;\n    }\n  }\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying float a;varying vec2 aVertex;varying float c;uniform float m;uniform vec4 n;uniform vec2 o;uniform float p;void main(void){if(a>0.0){vec2 windowCoords=vec2((aVertex.x+1.0)/2.0*o.x*p,(aVertex.y+1.0)/2.0*o.y*p);if(length(windowCoords-gl_FragCoord.xy)>c*p){discard;}} gl_FragColor=n;float alpha=n.a*m;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),l=exports.vertex=new r.default(e.DEBUG?"varying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\nattribute vec2 a_lastPos;\nattribute vec2 a_position;\nattribute vec2 a_nextPos;\nattribute float a_direction;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_miterLimit;\n\nbool nearlyEquals(in float value, in float ref) {\n  float epsilon = 0.000000000001;\n  return value >= ref - epsilon && value <= ref + epsilon;\n}\n\nvoid alongNormal(out vec2 offset, in vec2 nextP, in float turnDir, in float direction) {\n  vec2 dirVect = nextP - a_position;\n  vec2 normal = normalize(vec2(-turnDir * dirVect.y, turnDir * dirVect.x));\n  offset = u_lineWidth / 2.0 * normal * direction;\n}\n\nvoid miterUp(out vec2 offset, out float round, in bool isRound, in float direction) {\n  float halfWidth = u_lineWidth / 2.0;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_nextPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n  offset = normal * direction * miterLength;\n  round = 0.0;\n  if (isRound) {\n    round = 1.0;\n  } else if (miterLength > u_miterLimit + u_lineWidth) {\n    offset = halfWidth * tmpNormal * direction;\n  }\n}\n\nbool miterDown(out vec2 offset, in vec4 projPos, in mat4 offsetMatrix, in float direction) {\n  bool degenerate = false;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_lastPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  vec2 longOffset, shortOffset, longVertex;\n  vec4 shortProjVertex;\n  float halfWidth = u_lineWidth / 2.0;\n  if (length(a_nextPos - a_position) > length(a_lastPos - a_position)) {\n    longOffset = tmpNormal * direction * halfWidth;\n    shortOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_nextPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_lastPos, 0.0, 1.0);\n  } else {\n    shortOffset = tmpNormal * direction * halfWidth;\n    longOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_lastPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_nextPos, 0.0, 1.0);\n  }\n  //Intersection algorithm based on theory by Paul Bourke (http://paulbourke.net/geometry/pointlineplane/).\n  vec4 p1 = u_projectionMatrix * vec4(longVertex, 0.0, 1.0) + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p2 = projPos + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p3 = shortProjVertex + offsetMatrix * vec4(-shortOffset, 0.0, 0.0);\n  vec4 p4 = shortProjVertex + offsetMatrix * vec4(shortOffset, 0.0, 0.0);\n  float denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\n  float firstU = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\n  float secondU = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denom;\n  float epsilon = 0.000000000001;\n  if (firstU > epsilon && firstU < 1.0 - epsilon && secondU > epsilon && secondU < 1.0 - epsilon) {\n    shortProjVertex.x = p1.x + firstU * (p2.x - p1.x);\n    shortProjVertex.y = p1.y + firstU * (p2.y - p1.y);\n    offset = shortProjVertex.xy;\n    degenerate = true;\n  } else {\n    float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n    offset = normal * direction * miterLength;\n  }\n  return degenerate;\n}\n\nvoid squareCap(out vec2 offset, out float round, in bool isRound, in vec2 nextP,\n    in float turnDir, in float direction) {\n  round = 0.0;\n  vec2 dirVect = a_position - nextP;\n  vec2 firstNormal = normalize(dirVect);\n  vec2 secondNormal = vec2(turnDir * firstNormal.y * direction, -turnDir * firstNormal.x * direction);\n  vec2 hypotenuse = normalize(firstNormal - secondNormal);\n  vec2 normal = vec2(turnDir * hypotenuse.y * direction, -turnDir * hypotenuse.x * direction);\n  float length = sqrt(v_halfWidth * v_halfWidth * 2.0);\n  offset = normal * length;\n  if (isRound) {\n    round = 1.0;\n  }\n}\n\nvoid main(void) {\n  bool degenerate = false;\n  float direction = float(sign(a_direction));\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  vec2 offset;\n  vec4 projPos = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n  bool round = nearlyEquals(mod(a_direction, 2.0), 0.0);\n\n  v_round = 0.0;\n  v_halfWidth = u_lineWidth / 2.0;\n  v_roundVertex = projPos.xy;\n\n  if (nearlyEquals(mod(a_direction, 3.0), 0.0) || nearlyEquals(mod(a_direction, 17.0), 0.0)) {\n    alongNormal(offset, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 5.0), 0.0) || nearlyEquals(mod(a_direction, 13.0), 0.0)) {\n    alongNormal(offset, a_lastPos, -1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 23.0), 0.0)) {\n    miterUp(offset, v_round, round, direction);\n  } else if (nearlyEquals(mod(a_direction, 19.0), 0.0)) {\n    degenerate = miterDown(offset, projPos, offsetMatrix, direction);\n  } else if (nearlyEquals(mod(a_direction, 7.0), 0.0)) {\n    squareCap(offset, v_round, round, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 11.0), 0.0)) {\n    squareCap(offset, v_round, round, a_lastPos, -1.0, direction);\n  }\n  if (!degenerate) {\n    vec4 offsets = offsetMatrix * vec4(offset, 0.0, 0.0);\n    gl_Position = projPos + offsets;\n  } else {\n    gl_Position = vec4(offset, 0.0, 1.0);\n  }\n}\n\n\n":"varying float a;varying vec2 aVertex;varying float c;attribute vec2 d;attribute vec2 e;attribute vec2 f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;bool nearlyEquals(in float value,in float ref){float epsilon=0.000000000001;return value>=ref-epsilon&&value<=ref+epsilon;}void alongNormal(out vec2 offset,in vec2 nextP,in float turnDir,in float direction){vec2 dirVect=nextP-e;vec2 normal=normalize(vec2(-turnDir*dirVect.y,turnDir*dirVect.x));offset=k/2.0*normal*direction;}void miterUp(out vec2 offset,out float round,in bool isRound,in float direction){float halfWidth=k/2.0;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=f-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;round=0.0;if(isRound){round=1.0;}else if(miterLength>l+k){offset=halfWidth*tmpNormal*direction;}} bool miterDown(out vec2 offset,in vec4 projPos,in mat4 offsetMatrix,in float direction){bool degenerate=false;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=d-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));vec2 longOffset,shortOffset,longVertex;vec4 shortProjVertex;float halfWidth=k/2.0;if(length(f-e)>length(d-e)){longOffset=tmpNormal*direction*halfWidth;shortOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=f;shortProjVertex=h*vec4(d,0.0,1.0);}else{shortOffset=tmpNormal*direction*halfWidth;longOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=d;shortProjVertex=h*vec4(f,0.0,1.0);}vec4 p1=h*vec4(longVertex,0.0,1.0)+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p2=projPos+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p3=shortProjVertex+offsetMatrix*vec4(-shortOffset,0.0,0.0);vec4 p4=shortProjVertex+offsetMatrix*vec4(shortOffset,0.0,0.0);float denom=(p4.y-p3.y)*(p2.x-p1.x)-(p4.x-p3.x)*(p2.y-p1.y);float firstU=((p4.x-p3.x)*(p1.y-p3.y)-(p4.y-p3.y)*(p1.x-p3.x))/denom;float secondU=((p2.x-p1.x)*(p1.y-p3.y)-(p2.y-p1.y)*(p1.x-p3.x))/denom;float epsilon=0.000000000001;if(firstU>epsilon&&firstU<1.0-epsilon&&secondU>epsilon&&secondU<1.0-epsilon){shortProjVertex.x=p1.x+firstU*(p2.x-p1.x);shortProjVertex.y=p1.y+firstU*(p2.y-p1.y);offset=shortProjVertex.xy;degenerate=true;}else{float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;}return degenerate;}void squareCap(out vec2 offset,out float round,in bool isRound,in vec2 nextP,in float turnDir,in float direction){round=0.0;vec2 dirVect=e-nextP;vec2 firstNormal=normalize(dirVect);vec2 secondNormal=vec2(turnDir*firstNormal.y*direction,-turnDir*firstNormal.x*direction);vec2 hypotenuse=normalize(firstNormal-secondNormal);vec2 normal=vec2(turnDir*hypotenuse.y*direction,-turnDir*hypotenuse.x*direction);float length=sqrt(c*c*2.0);offset=normal*length;if(isRound){round=1.0;}} void main(void){bool degenerate=false;float direction=float(sign(g));mat4 offsetMatrix=i*j;vec2 offset;vec4 projPos=h*vec4(e,0.0,1.0);bool round=nearlyEquals(mod(g,2.0),0.0);a=0.0;c=k/2.0;aVertex=projPos.xy;if(nearlyEquals(mod(g,3.0),0.0)||nearlyEquals(mod(g,17.0),0.0)){alongNormal(offset,f,1.0,direction);}else if(nearlyEquals(mod(g,5.0),0.0)||nearlyEquals(mod(g,13.0),0.0)){alongNormal(offset,d,-1.0,direction);}else if(nearlyEquals(mod(g,23.0),0.0)){miterUp(offset,a,round,direction);}else if(nearlyEquals(mod(g,19.0),0.0)){degenerate=miterDown(offset,projPos,offsetMatrix,direction);}else if(nearlyEquals(mod(g,7.0),0.0)){squareCap(offset,a,round,f,1.0,direction);}else if(nearlyEquals(mod(g,11.0),0.0)){squareCap(offset,a,round,d,-1.0,direction);}if(!degenerate){vec4 offsets=offsetMatrix*vec4(offset,0.0,0.0);gl_Position=projPos+offsets;}else{gl_Position=vec4(offset,0.0,1.0);}}");
},{"../../../webgl.js":153,"../../../webgl/Fragment.js":266,"../../../webgl/Vertex.js":267}],299:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../../../webgl.js");const i=function(i,o){this.u_projectionMatrix=i.getUniformLocation(o,t.DEBUG?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=i.getUniformLocation(o,t.DEBUG?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=i.getUniformLocation(o,t.DEBUG?"u_offsetRotateMatrix":"j"),this.u_lineWidth=i.getUniformLocation(o,t.DEBUG?"u_lineWidth":"k"),this.u_miterLimit=i.getUniformLocation(o,t.DEBUG?"u_miterLimit":"l"),this.u_opacity=i.getUniformLocation(o,t.DEBUG?"u_opacity":"m"),this.u_color=i.getUniformLocation(o,t.DEBUG?"u_color":"n"),this.u_size=i.getUniformLocation(o,t.DEBUG?"u_size":"o"),this.u_pixelRatio=i.getUniformLocation(o,t.DEBUG?"u_pixelRatio":"p"),this.a_lastPos=i.getAttribLocation(o,t.DEBUG?"a_lastPos":"d"),this.a_position=i.getAttribLocation(o,t.DEBUG?"a_position":"e"),this.a_nextPos=i.getAttribLocation(o,t.DEBUG?"a_nextPos":"f"),this.a_direction=i.getAttribLocation(o,t.DEBUG?"a_direction":"g")};exports.default=i;
},{"../../../../webgl.js":153}],278:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../util.js"),e=require("../../array.js"),i=require("../../color.js"),s=require("../../extent.js"),n=require("../../geom/flat/orient.js"),r=require("../../geom/flat/transform.js"),h=require("../../geom/flat/topology.js"),a=require("../../obj.js"),o=require("../webgl.js"),d=require("../webgl/Replay.js"),l=p(d),c=require("../webgl/linestringreplay/defaultshader.js"),_=require("../webgl/linestringreplay/defaultshader/Locations.js"),u=p(_),f=require("../../webgl.js"),g=require("../../webgl/Buffer.js"),E=p(g);function p(t){return t&&t.__esModule?t:{default:t}}const I={ROUND:2,BEGIN_LINE:3,END_LINE:5,BEGIN_LINE_CAP:7,END_LINE_CAP:11,BEVEL_FIRST:13,BEVEL_SECOND:17,MITER_BOTTOM:19,MITER_TOP:23},y=function(t,e){l.default.call(this,t,e),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0,changed:!1}};(0,t.inherits)(y,l.default),y.prototype.drawCoordinates_=function(t,i,s,r){let a,d,l=this.vertices.length,c=this.indices.length;const _="bevel"===this.state_.lineJoin?0:"miter"===this.state_.lineJoin?1:2,u="butt"===this.state_.lineCap?0:"square"===this.state_.lineCap?1:2,f=(0,h.lineStringIsClosed)(t,i,s,r);let g,E,p,y,L,T,A=c,F=1;for(a=i,d=s;a<d;a+=r){if(p=l/7,y=L,L=T||[t[a],t[a+1]],a===i){if(T=[t[a+r],t[a+r+1]],s-i==2*r&&(0,e.equals)(L,T))break;if(!f){u&&(l=this.addVertices_([0,0],L,T,F*I.BEGIN_LINE_CAP*u,l),l=this.addVertices_([0,0],L,T,-F*I.BEGIN_LINE_CAP*u,l),this.indices[c++]=p+2,this.indices[c++]=p,this.indices[c++]=p+1,this.indices[c++]=p+1,this.indices[c++]=p+3,this.indices[c++]=p+2),l=this.addVertices_([0,0],L,T,F*I.BEGIN_LINE*(u||1),l),A=(l=this.addVertices_([0,0],L,T,-F*I.BEGIN_LINE*(u||1),l))/7-1;continue}y=[t[s-2*r],t[s-2*r+1]],g=T}else{if(a===s-r){if(f){T=g;break}y=y||[0,0],l=this.addVertices_(y,L,[0,0],F*I.END_LINE*(u||1),l),l=this.addVertices_(y,L,[0,0],-F*I.END_LINE*(u||1),l),this.indices[c++]=p,this.indices[c++]=A-1,this.indices[c++]=A,this.indices[c++]=A,this.indices[c++]=p+1,this.indices[c++]=p,u&&(l=this.addVertices_(y,L,[0,0],F*I.END_LINE_CAP*u,l),l=this.addVertices_(y,L,[0,0],-F*I.END_LINE_CAP*u,l),this.indices[c++]=p+2,this.indices[c++]=p,this.indices[c++]=p+1,this.indices[c++]=p+1,this.indices[c++]=p+3,this.indices[c++]=p+2);break}T=[t[a+r],t[a+r+1]]}E=(0,o.triangleIsCounterClockwise)(y[0],y[1],L[0],L[1],T[0],T[1])?-1:1,l=this.addVertices_(y,L,T,E*I.BEVEL_FIRST*(_||1),l),l=this.addVertices_(y,L,T,E*I.BEVEL_SECOND*(_||1),l),l=this.addVertices_(y,L,T,-E*I.MITER_BOTTOM*(_||1),l),a>i&&(this.indices[c++]=p,this.indices[c++]=A-1,this.indices[c++]=A,this.indices[c++]=p+2,this.indices[c++]=p,this.indices[c++]=F*E>0?A:A-1),this.indices[c++]=p,this.indices[c++]=p+2,this.indices[c++]=p+1,A=p+2,F=E,_&&(l=this.addVertices_(y,L,T,E*I.MITER_TOP*_,l),this.indices[c++]=p+1,this.indices[c++]=p+3,this.indices[c++]=p)}f&&(p=p||l/7,E=(0,n.linearRingIsClockwise)([y[0],y[1],L[0],L[1],T[0],T[1]],0,6,2)?1:-1,l=this.addVertices_(y,L,T,E*I.BEVEL_FIRST*(_||1),l),l=this.addVertices_(y,L,T,-E*I.MITER_BOTTOM*(_||1),l),this.indices[c++]=p,this.indices[c++]=A-1,this.indices[c++]=A,this.indices[c++]=p+1,this.indices[c++]=p,this.indices[c++]=F*E>0?A:A-1)},y.prototype.addVertices_=function(t,e,i,s,n){return this.vertices[n++]=t[0],this.vertices[n++]=t[1],this.vertices[n++]=e[0],this.vertices[n++]=e[1],this.vertices[n++]=i[0],this.vertices[n++]=i[1],this.vertices[n++]=s,n},y.prototype.isValid_=function(t,i,s,n){const r=s-i;if(r<2*n)return!1;if(r===2*n){const s=[t[i],t[i+1]],r=[t[i+n],t[i+n+1]];return!(0,e.equals)(s,r)}return!0},y.prototype.drawLineString=function(t,e){let i=t.getFlatCoordinates();const s=t.getStride();this.isValid_(i,0,i.length,s)&&(i=(0,r.translate)(i,0,i.length,s,-this.origin[0],-this.origin[1]),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.drawCoordinates_(i,0,i.length,s))},y.prototype.drawMultiLineString=function(t,e){const i=this.indices.length,s=t.getEnds();s.unshift(0);const n=t.getFlatCoordinates(),h=t.getStride();let a,o;if(s.length>1)for(a=1,o=s.length;a<o;++a)if(this.isValid_(n,s[a-1],s[a],h)){const t=(0,r.translate)(n,s[a-1],s[a],h,-this.origin[0],-this.origin[1]);this.drawCoordinates_(t,0,t.length,h)}this.indices.length>i&&(this.startIndices.push(i),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(i),this.state_.changed=!1))},y.prototype.drawPolygonCoordinates=function(t,e,i){if((0,h.lineStringIsClosed)(t,0,t.length,i)||(t.push(t[0]),t.push(t[1])),this.drawCoordinates_(t,0,t.length,i),e.length){let t,s;for(t=0,s=e.length;t<s;++t)(0,h.lineStringIsClosed)(e[t],0,e[t].length,i)||(e[t].push(e[t][0]),e[t].push(e[t][1])),this.drawCoordinates_(e[t],0,e[t].length,i)}},y.prototype.setPolygonStyle=function(t,e){const i=void 0===e?this.indices.length:e;this.startIndices.push(i),this.startIndicesFeature.push(t),this.state_.changed&&(this.styleIndices_.push(i),this.state_.changed=!1)},y.prototype.getCurrentIndex=function(){return this.indices.length},y.prototype.finish=function(t){this.verticesBuffer=new E.default(this.vertices),this.indicesBuffer=new E.default(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},y.prototype.getDeleteResourcesFunction=function(t){const e=this.verticesBuffer,i=this.indicesBuffer;return function(){t.deleteBuffer(e),t.deleteBuffer(i)}},y.prototype.setUpProgram=function(t,e,i,s){const n=e.getProgram(c.fragment,c.vertex);let r;return this.defaultLocations_?r=this.defaultLocations_:(r=new u.default(t,n),this.defaultLocations_=r),e.useProgram(n),t.enableVertexAttribArray(r.a_lastPos),t.vertexAttribPointer(r.a_lastPos,2,f.FLOAT,!1,28,0),t.enableVertexAttribArray(r.a_position),t.vertexAttribPointer(r.a_position,2,f.FLOAT,!1,28,8),t.enableVertexAttribArray(r.a_nextPos),t.vertexAttribPointer(r.a_nextPos,2,f.FLOAT,!1,28,16),t.enableVertexAttribArray(r.a_direction),t.vertexAttribPointer(r.a_direction,1,f.FLOAT,!1,28,24),t.uniform2fv(r.u_size,i),t.uniform1f(r.u_pixelRatio,s),r},y.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_lastPos),t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_nextPos),t.disableVertexAttribArray(e.a_direction)},y.prototype.drawReplay=function(t,e,i,s){const n=t.getParameter(t.DEPTH_FUNC),r=t.getParameter(t.DEPTH_WRITEMASK);if(s||(t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.NOTEQUAL)),(0,a.isEmpty)(i)){let i,s,n,r;for(n=this.startIndices[this.startIndices.length-1],i=this.styleIndices_.length-1;i>=0;--i)s=this.styleIndices_[i],r=this.styles_[i],this.setStrokeStyle_(t,r[0],r[1],r[2]),this.drawElements(t,e,s,n),t.clear(t.DEPTH_BUFFER_BIT),n=s}else this.drawReplaySkipping_(t,e,i);s||(t.disable(t.DEPTH_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.depthMask(r),t.depthFunc(n))},y.prototype.drawReplaySkipping_=function(e,i,s){let n,r,h,a,o,d,l,c,_;for(c=this.startIndices.length-2,h=r=this.startIndices[c+1],n=this.styleIndices_.length-1;n>=0;--n){for(a=this.styles_[n],this.setStrokeStyle_(e,a[0],a[1],a[2]),o=this.styleIndices_[n];c>=0&&this.startIndices[c]>=o;)_=this.startIndices[c],d=this.startIndicesFeature[c],s[l=(0,t.getUid)(d).toString()]&&(r!==h&&(this.drawElements(e,i,r,h),e.clear(e.DEPTH_BUFFER_BIT)),h=_),c--,r=_;r!==h&&(this.drawElements(e,i,r,h),e.clear(e.DEPTH_BUFFER_BIT)),r=h=o}},y.prototype.drawHitDetectionReplayOneByOne=function(e,i,n,r,h){let a,o,d,l,c,_,u,f;for(f=this.startIndices.length-2,d=this.startIndices[f+1],a=this.styleIndices_.length-1;a>=0;--a)for(l=this.styles_[a],this.setStrokeStyle_(e,l[0],l[1],l[2]),c=this.styleIndices_[a];f>=0&&this.startIndices[f]>=c;){if(o=this.startIndices[f],_=this.startIndicesFeature[f],void 0===n[u=(0,t.getUid)(_).toString()]&&_.getGeometry()&&(void 0===h||(0,s.intersects)(h,_.getGeometry().getExtent()))){e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),this.drawElements(e,i,o,d);const t=r(_);if(t)return t}f--,d=o}},y.prototype.setStrokeStyle_=function(t,e,i,s){t.uniform4fv(this.defaultLocations_.u_color,e),t.uniform1f(this.defaultLocations_.u_lineWidth,i),t.uniform1f(this.defaultLocations_.u_miterLimit,s)},y.prototype.setFillStrokeStyle=function(t,s){const n=s.getLineCap();this.state_.lineCap=void 0!==n?n:o.DEFAULT_LINECAP;const r=s.getLineDash();this.state_.lineDash=r||o.DEFAULT_LINEDASH;const h=s.getLineDashOffset();this.state_.lineDashOffset=h||o.DEFAULT_LINEDASHOFFSET;const a=s.getLineJoin();this.state_.lineJoin=void 0!==a?a:o.DEFAULT_LINEJOIN;let d=s.getColor();d=d instanceof CanvasGradient||d instanceof CanvasPattern?o.DEFAULT_STROKESTYLE:(0,i.asArray)(d).map(function(t,e){return 3!=e?t/255:t})||o.DEFAULT_STROKESTYLE;let l=s.getWidth();l=void 0!==l?l:o.DEFAULT_LINEWIDTH;let c=s.getMiterLimit();c=void 0!==c?c:o.DEFAULT_MITERLIMIT,this.state_.strokeColor&&(0,e.equals)(this.state_.strokeColor,d)&&this.state_.lineWidth===l&&this.state_.miterLimit===c||(this.state_.changed=!0,this.state_.strokeColor=d,this.state_.lineWidth=l,this.state_.miterLimit=c,this.styles_.push([d,l,c]))},exports.default=y;
},{"../../util.js":43,"../../array.js":130,"../../color.js":209,"../../extent.js":90,"../../geom/flat/orient.js":203,"../../geom/flat/transform.js":192,"../../geom/flat/topology.js":297,"../../obj.js":74,"../webgl.js":286,"../webgl/Replay.js":287,"../webgl/linestringreplay/defaultshader.js":298,"../webgl/linestringreplay/defaultshader/Locations.js":299,"../../webgl.js":153,"../../webgl/Buffer.js":233}],295:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.vertex=exports.fragment=void 0;var o=require("../../../webgl.js"),a=require("../../../webgl/Fragment.js"),e=r(a),n=require("../../../webgl/Vertex.js"),i=r(n);function r(o){return o&&o.__esModule?o:{default:o}}const t=exports.fragment=new e.default(o.DEBUG?"precision mediump float;\n\n\n\nuniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main(void) {\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;uniform vec4 e;uniform float f;void main(void){gl_FragColor=e;float alpha=e.a*f;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),l=exports.vertex=new i.default(o.DEBUG?"\n\nattribute vec2 a_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n}\n\n\n":"attribute vec2 a;uniform mat4 b;uniform mat4 c;uniform mat4 d;void main(void){gl_Position=b*vec4(a,0.0,1.0);}");
},{"../../../webgl.js":153,"../../../webgl/Fragment.js":266,"../../../webgl/Vertex.js":267}],296:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../../../webgl.js");const o=function(o,i){this.u_projectionMatrix=o.getUniformLocation(i,t.DEBUG?"u_projectionMatrix":"b"),this.u_offsetScaleMatrix=o.getUniformLocation(i,t.DEBUG?"u_offsetScaleMatrix":"c"),this.u_offsetRotateMatrix=o.getUniformLocation(i,t.DEBUG?"u_offsetRotateMatrix":"d"),this.u_color=o.getUniformLocation(i,t.DEBUG?"u_color":"e"),this.u_opacity=o.getUniformLocation(i,t.DEBUG?"u_opacity":"f"),this.a_position=o.getAttribLocation(i,t.DEBUG?"a_position":"a")};exports.default=o;
},{"../../../../webgl.js":153}],294:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=function(t){this.first_,this.last_,this.head_,this.circular_=void 0===t||t,this.length_=0};t.prototype.insertItem=function(t){const e={prev:void 0,next:void 0,data:t},h=this.head_;if(h){const t=h.next;e.prev=h,e.next=t,h.next=e,t&&(t.prev=e),h===this.last_&&(this.last_=e)}else this.first_=e,this.last_=e,this.circular_&&(e.next=e,e.prev=e);this.head_=e,this.length_++},t.prototype.removeItem=function(){const t=this.head_;if(t){const e=t.next,h=t.prev;e&&(e.prev=h),h&&(h.next=e),this.head_=e||h,this.first_===this.last_?(this.head_=void 0,this.first_=void 0,this.last_=void 0):this.first_===t?this.first_=this.head_:this.last_===t&&(this.last_=h?this.head_.prev:this.head_),this.length_--}},t.prototype.firstItem=function(){if(this.head_=this.first_,this.head_)return this.head_.data},t.prototype.lastItem=function(){if(this.head_=this.last_,this.head_)return this.head_.data},t.prototype.nextItem=function(){if(this.head_&&this.head_.next)return this.head_=this.head_.next,this.head_.data},t.prototype.getNextItem=function(){if(this.head_&&this.head_.next)return this.head_.next.data},t.prototype.prevItem=function(){if(this.head_&&this.head_.prev)return this.head_=this.head_.prev,this.head_.data},t.prototype.getPrevItem=function(){if(this.head_&&this.head_.prev)return this.head_.prev.data},t.prototype.getCurrItem=function(){if(this.head_)return this.head_.data},t.prototype.setFirstItem=function(){this.circular_&&this.head_&&(this.first_=this.head_,this.last_=this.head_.prev)},t.prototype.concat=function(t){if(t.head_){if(this.head_){const e=this.head_.next;this.head_.next=t.first_,t.first_.prev=this.head_,e.prev=t.last_,t.last_.next=e,this.length_+=t.length_}else this.head_=t.head_,this.first_=t.first_,this.last_=t.last_,this.length_=t.length_;t.head_=void 0,t.first_=void 0,t.last_=void 0,t.length_=0}},t.prototype.getLength=function(){return this.length_},exports.default=t;
},{}],279:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../util.js"),e=require("../../array.js"),i=require("../../color.js"),s=require("../../extent.js"),n=require("../../obj.js"),r=require("../../geom/flat/contains.js"),o=require("../../geom/flat/orient.js"),l=require("../../geom/flat/transform.js"),a=require("../webgl/polygonreplay/defaultshader.js"),h=require("../webgl/polygonreplay/defaultshader/Locations.js"),p=C(h),c=require("../webgl/LineStringReplay.js"),y=C(c),x=require("../webgl/Replay.js"),u=C(x),g=require("../webgl.js"),f=require("../../style/Stroke.js"),d=C(f),m=require("../../structs/LinkedList.js"),_=C(m),I=require("../../structs/RBush.js"),M=C(I),P=require("../../webgl.js"),w=require("../../webgl/Buffer.js"),v=C(w);function C(t){return t&&t.__esModule?t:{default:t}}const S=function(t,e){u.default.call(this,t,e),this.lineStringReplay=new y.default(t,e),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={fillColor:null,changed:!1}};(0,t.inherits)(S,u.default),S.prototype.drawCoordinates_=function(t,e,i){const s=new _.default,n=new M.default;this.processFlatCoordinates_(t,i,s,n,!0);const r=this.getMaxCoords_(s);if(e.length){let t,o;const l=[];for(t=0,o=e.length;t<o;++t){const s={list:new _.default,maxCoords:void 0,rtree:new M.default};l.push(s),this.processFlatCoordinates_(e[t],i,s.list,s.rtree,!1),this.classifyPoints_(s.list,s.rtree,!0),s.maxCoords=this.getMaxCoords_(s.list)}for(l.sort(function(t,e){return e.maxCoords[0]===t.maxCoords[0]?t.maxCoords[1]-e.maxCoords[1]:e.maxCoords[0]-t.maxCoords[0]}),t=0;t<l.length;++t){const e=l[t].list,i=e.firstItem();let o,a=i;do{if(this.getIntersections_(a,n).length){o=!0;break}a=e.nextItem()}while(i!==a);o||this.bridgeHole_(e,l[t].maxCoords[0],s,r[0],n)&&(n.concat(l[t].rtree),this.classifyPoints_(s,n,!1))}}else this.classifyPoints_(s,n,!1);this.triangulate_(s,n)},S.prototype.processFlatCoordinates_=function(t,e,i,s,n){const r=(0,o.linearRingIsClockwise)(t,0,t.length,e);let l,a,h,p,c,y=this.vertices.length/2;const x=[],u=[];if(n===r){for(p=h=this.createPoint_(t[0],t[1],y++),l=e,a=t.length;l<a;l+=e)c=this.createPoint_(t[l],t[l+1],y++),u.push(this.insertItem_(p,c,i)),x.push([Math.min(p.x,c.x),Math.min(p.y,c.y),Math.max(p.x,c.x),Math.max(p.y,c.y)]),p=c;u.push(this.insertItem_(c,h,i)),x.push([Math.min(p.x,c.x),Math.min(p.y,c.y),Math.max(p.x,c.x),Math.max(p.y,c.y)])}else{const s=t.length-e;for(p=h=this.createPoint_(t[s],t[s+1],y++),l=s-e,a=0;l>=a;l-=e)c=this.createPoint_(t[l],t[l+1],y++),u.push(this.insertItem_(p,c,i)),x.push([Math.min(p.x,c.x),Math.min(p.y,c.y),Math.max(p.x,c.x),Math.max(p.y,c.y)]),p=c;u.push(this.insertItem_(c,h,i)),x.push([Math.min(p.x,c.x),Math.min(p.y,c.y),Math.max(p.x,c.x),Math.max(p.y,c.y)])}s.load(x,u)},S.prototype.getMaxCoords_=function(t){const e=t.firstItem();let i=e,s=[i.p0.x,i.p0.y];do{(i=t.nextItem()).p0.x>s[0]&&(s=[i.p0.x,i.p0.y])}while(i!==e);return s},S.prototype.classifyPoints_=function(t,e,i){let s=t.firstItem(),n=s,r=t.nextItem(),o=!1;do{const l=i?(0,g.triangleIsCounterClockwise)(r.p1.x,r.p1.y,n.p1.x,n.p1.y,n.p0.x,n.p0.y):(0,g.triangleIsCounterClockwise)(n.p0.x,n.p0.y,n.p1.x,n.p1.y,r.p1.x,r.p1.y);void 0===l?(this.removeItem_(n,r,t,e),o=!0,r===s&&(s=t.getNextItem()),r=n,t.prevItem()):n.p1.reflex!==l&&(n.p1.reflex=l,o=!0),n=r,r=t.nextItem()}while(n!==s);return o},S.prototype.bridgeHole_=function(t,e,i,s,n){let r=t.firstItem();for(;r.p1.x!==e;)r=t.nextItem();const o=r.p1,l={x:s,y:o.y,i:-1};let a,h,p,c,y=1/0;const x=this.getIntersections_({p0:o,p1:l},n,!0);for(a=0,h=x.length;a<h;++a){const t=x[a],e=this.calculateIntersection_(o,l,t.p0,t.p1,!0),i=Math.abs(o.x-e[0]);i<y&&void 0!==(0,g.triangleIsCounterClockwise)(o.x,o.y,t.p0.x,t.p0.y,t.p1.x,t.p1.y)&&(y=i,c={x:e[0],y:e[1],i:-1},r=t)}if(y===1/0)return!1;if(p=r.p1,y>0){const t=this.getPointsInTriangle_(o,c,r.p1,n);if(t.length){let e=1/0;for(a=0,h=t.length;a<h;++a){const i=t[a],s=Math.atan2(o.y-i.y,l.x-i.x);(s<e||s===e&&i.x<p.x)&&(e=s,p=i)}}}for(r=i.firstItem();r.p1.x!==p.x||r.p1.y!==p.y;)r=i.nextItem();const u={x:o.x,y:o.y,i:o.i,reflex:void 0},f={x:r.p1.x,y:r.p1.y,i:r.p1.i,reflex:void 0};return t.getNextItem().p0=u,this.insertItem_(o,r.p1,t,n),this.insertItem_(f,u,t,n),r.p1=f,t.setFirstItem(),i.concat(t),!0},S.prototype.triangulate_=function(t,e){let i=!1,s=this.isSimple_(t,e);for(;t.getLength()>3;)if(s){if(!this.clipEars_(t,e,s,i)&&!this.classifyPoints_(t,e,i)&&!this.resolveSelfIntersections_(t,e,!0))break}else if(!this.clipEars_(t,e,s,i)&&!this.classifyPoints_(t,e,i)&&!this.resolveSelfIntersections_(t,e)){if(!(s=this.isSimple_(t,e))){this.splitPolygon_(t,e);break}i=!this.isClockwise_(t),this.classifyPoints_(t,e,i)}if(3===t.getLength()){let e=this.indices.length;this.indices[e++]=t.getPrevItem().p0.i,this.indices[e++]=t.getCurrItem().p0.i,this.indices[e++]=t.getNextItem().p0.i}},S.prototype.clipEars_=function(t,e,i,s){let n,r,l,a=this.indices.length,h=t.firstItem(),p=t.getPrevItem(),c=h,y=t.nextItem(),x=t.getNextItem(),u=!1;do{if(n=c.p0,r=c.p1,l=y.p1,!1===r.reflex){let g;g=i?0===this.getPointsInTriangle_(n,r,l,e,!0).length:s?this.diagonalIsInside_(x.p1,l,r,n,p.p0):this.diagonalIsInside_(p.p0,n,r,l,x.p1),(i||0===this.getIntersections_({p0:n,p1:l},e).length)&&g&&(i||!1===n.reflex||!1===l.reflex||(0,o.linearRingIsClockwise)([p.p0.x,p.p0.y,n.x,n.y,r.x,r.y,l.x,l.y,x.p1.x,x.p1.y],0,10,2)===!s)&&(this.indices[a++]=n.i,this.indices[a++]=r.i,this.indices[a++]=l.i,this.removeItem_(c,y,t,e),y===h&&(h=x),u=!0)}p=t.getPrevItem(),c=t.getCurrItem(),y=t.nextItem(),x=t.getNextItem()}while(c!==h&&t.getLength()>3);return u},S.prototype.resolveSelfIntersections_=function(t,e,i){const s=t.firstItem();t.nextItem();let n=s,r=t.nextItem(),o=!1;do{const l=this.calculateIntersection_(n.p0,n.p1,r.p0,r.p1,i);if(l){let a=!1;const h=this.vertices.length;let p=this.indices.length;const c=h/2,y=t.prevItem();let x;if(t.removeItem(),e.remove(y),a=y===s,i?(l[0]===n.p0.x&&l[1]===n.p0.y?(t.prevItem(),x=n.p0,r.p0=x,e.remove(n),a=a||n===s):(x=r.p1,n.p1=x,e.remove(r),a=a||r===s),t.removeItem()):(x=this.createPoint_(l[0],l[1],c),n.p1=x,r.p0=x,e.update([Math.min(n.p0.x,n.p1.x),Math.min(n.p0.y,n.p1.y),Math.max(n.p0.x,n.p1.x),Math.max(n.p0.y,n.p1.y)],n),e.update([Math.min(r.p0.x,r.p1.x),Math.min(r.p0.y,r.p1.y),Math.max(r.p0.x,r.p1.x),Math.max(r.p0.y,r.p1.y)],r)),this.indices[p++]=y.p0.i,this.indices[p++]=y.p1.i,this.indices[p++]=x.i,o=!0,a)break}n=t.getPrevItem(),r=t.nextItem()}while(n!==s);return o},S.prototype.isSimple_=function(t,e){const i=t.firstItem();let s=i;do{if(this.getIntersections_(s,e).length)return!1;s=t.nextItem()}while(s!==i);return!0},S.prototype.isClockwise_=function(t){const e=2*t.getLength(),i=new Array(e),s=t.firstItem();let n=s,r=0;do{i[r++]=n.p0.x,i[r++]=n.p0.y,n=t.nextItem()}while(n!==s);return(0,o.linearRingIsClockwise)(i,0,e,2)},S.prototype.splitPolygon_=function(t,e){const i=t.firstItem();let s=i;do{const i=this.getIntersections_(s,e);if(i.length){const n=i[0],r=this.vertices.length/2,o=this.calculateIntersection_(s.p0,s.p1,n.p0,n.p1),l=this.createPoint_(o[0],o[1],r),a=new _.default,h=new M.default;this.insertItem_(l,s.p1,a,h),s.p1=l,e.update([Math.min(s.p0.x,l.x),Math.min(s.p0.y,l.y),Math.max(s.p0.x,l.x),Math.max(s.p0.y,l.y)],s);let p=t.nextItem();for(;p!==n;)this.insertItem_(p.p0,p.p1,a,h),e.remove(p),t.removeItem(),p=t.getCurrItem();this.insertItem_(n.p0,l,a,h),n.p0=l,e.update([Math.min(n.p1.x,l.x),Math.min(n.p1.y,l.y),Math.max(n.p1.x,l.x),Math.max(n.p1.y,l.y)],n),this.classifyPoints_(t,e,!1),this.triangulate_(t,e),this.classifyPoints_(a,h,!1),this.triangulate_(a,h);break}s=t.nextItem()}while(s!==i)},S.prototype.createPoint_=function(t,e,i){let s=this.vertices.length;return this.vertices[s++]=t,this.vertices[s++]=e,{x:t,y:e,i:i,reflex:void 0}},S.prototype.insertItem_=function(t,e,i,s){const n={p0:t,p1:e};return i.insertItem(n),s&&s.insert([Math.min(t.x,e.x),Math.min(t.y,e.y),Math.max(t.x,e.x),Math.max(t.y,e.y)],n),n},S.prototype.removeItem_=function(t,e,i,s){i.getCurrItem()===e&&(i.removeItem(),t.p1=e.p1,s.remove(e),s.update([Math.min(t.p0.x,t.p1.x),Math.min(t.p0.y,t.p1.y),Math.max(t.p0.x,t.p1.x),Math.max(t.p0.y,t.p1.y)],t))},S.prototype.getPointsInTriangle_=function(t,e,i,s,n){const o=[],l=s.getInExtent([Math.min(t.x,e.x,i.x),Math.min(t.y,e.y,i.y),Math.max(t.x,e.x,i.x),Math.max(t.y,e.y,i.y)]);for(let s=0,a=l.length;s<a;++s)for(const a in l[s]){const h=l[s][a];"object"!=typeof h||n&&!h.reflex||h.x===t.x&&h.y===t.y||h.x===e.x&&h.y===e.y||h.x===i.x&&h.y===i.y||-1!==o.indexOf(h)||!(0,r.linearRingContainsXY)([t.x,t.y,e.x,e.y,i.x,i.y],0,6,2,h.x,h.y)||o.push(h)}return o},S.prototype.getIntersections_=function(t,e,i){const s=t.p0,n=t.p1,r=e.getInExtent([Math.min(s.x,n.x),Math.min(s.y,n.y),Math.max(s.x,n.x),Math.max(s.y,n.y)]),o=[];for(let e=0,l=r.length;e<l;++e){const l=r[e];t!==l&&(i||l.p0!==n||l.p1!==s)&&this.calculateIntersection_(s,n,l.p0,l.p1,i)&&o.push(l)}return o},S.prototype.calculateIntersection_=function(t,e,i,s,n){const r=(s.y-i.y)*(e.x-t.x)-(s.x-i.x)*(e.y-t.y);if(0!==r){const o=((s.x-i.x)*(t.y-i.y)-(s.y-i.y)*(t.x-i.x))/r,l=((e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x))/r;if(!n&&o>g.EPSILON&&o<1-g.EPSILON&&l>g.EPSILON&&l<1-g.EPSILON||n&&o>=0&&o<=1&&l>=0&&l<=1)return[t.x+o*(e.x-t.x),t.y+o*(e.y-t.y)]}},S.prototype.diagonalIsInside_=function(t,e,i,s,n){if(void 0===e.reflex||void 0===s.reflex)return!1;const r=(i.x-s.x)*(e.y-s.y)>(i.y-s.y)*(e.x-s.x),o=(n.x-s.x)*(e.y-s.y)<(n.y-s.y)*(e.x-s.x),l=(t.x-e.x)*(s.y-e.y)>(t.y-e.y)*(s.x-e.x),a=(i.x-e.x)*(s.y-e.y)<(i.y-e.y)*(s.x-e.x),h=s.reflex?o||r:o&&r,p=e.reflex?a||l:a&&l;return h&&p},S.prototype.drawMultiPolygon=function(t,e){const i=t.getEndss(),s=t.getStride(),n=this.indices.length,r=this.lineStringReplay.getCurrentIndex(),o=t.getFlatCoordinates();let a,h,p,c,y=0;for(a=0,h=i.length;a<h;++a){const t=i[a];if(t.length>0){const e=(0,l.translate)(o,y,t[0],s,-this.origin[0],-this.origin[1]);if(e.length){const i=[];let n;for(p=1,c=t.length;p<c;++p)t[p]!==t[p-1]&&(n=(0,l.translate)(o,t[p-1],t[p],s,-this.origin[0],-this.origin[1]),i.push(n));this.lineStringReplay.drawPolygonCoordinates(e,i,s),this.drawCoordinates_(e,i,s)}}y=t[t.length-1]}this.indices.length>n&&(this.startIndices.push(n),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(n),this.state_.changed=!1)),this.lineStringReplay.getCurrentIndex()>r&&this.lineStringReplay.setPolygonStyle(e,r)},S.prototype.drawPolygon=function(t,e){const i=t.getEnds(),s=t.getStride();if(i.length>0){const n=t.getFlatCoordinates().map(Number),r=(0,l.translate)(n,0,i[0],s,-this.origin[0],-this.origin[1]);if(r.length){const t=[];let o,a,h;for(o=1,a=i.length;o<a;++o)i[o]!==i[o-1]&&(h=(0,l.translate)(n,i[o-1],i[o],s,-this.origin[0],-this.origin[1]),t.push(h));this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.lineStringReplay.setPolygonStyle(e),this.lineStringReplay.drawPolygonCoordinates(r,t,s),this.drawCoordinates_(r,t,s)}}},S.prototype.finish=function(t){this.verticesBuffer=new v.default(this.vertices),this.indicesBuffer=new v.default(this.indices),this.startIndices.push(this.indices.length),this.lineStringReplay.finish(t),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},S.prototype.getDeleteResourcesFunction=function(t){const e=this.verticesBuffer,i=this.indicesBuffer,s=this.lineStringReplay.getDeleteResourcesFunction(t);return function(){t.deleteBuffer(e),t.deleteBuffer(i),s()}},S.prototype.setUpProgram=function(t,e,i,s){const n=e.getProgram(a.fragment,a.vertex);let r;return this.defaultLocations_?r=this.defaultLocations_:(r=new p.default(t,n),this.defaultLocations_=r),e.useProgram(n),t.enableVertexAttribArray(r.a_position),t.vertexAttribPointer(r.a_position,2,P.FLOAT,!1,8,0),r},S.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position)},S.prototype.drawReplay=function(t,e,i,s){const r=t.getParameter(t.DEPTH_FUNC),o=t.getParameter(t.DEPTH_WRITEMASK);if(s||(t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.NOTEQUAL)),(0,n.isEmpty)(i)){let i,s,n,r;for(n=this.startIndices[this.startIndices.length-1],i=this.styleIndices_.length-1;i>=0;--i)s=this.styleIndices_[i],r=this.styles_[i],this.setFillStyle_(t,r),this.drawElements(t,e,s,n),n=s}else this.drawReplaySkipping_(t,e,i);s||(t.disable(t.DEPTH_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.depthMask(o),t.depthFunc(r))},S.prototype.drawHitDetectionReplayOneByOne=function(e,i,n,r,o){let l,a,h,p,c,y,x,u;for(u=this.startIndices.length-2,h=this.startIndices[u+1],l=this.styleIndices_.length-1;l>=0;--l)for(p=this.styles_[l],this.setFillStyle_(e,p),c=this.styleIndices_[l];u>=0&&this.startIndices[u]>=c;){if(a=this.startIndices[u],y=this.startIndicesFeature[u],void 0===n[x=(0,t.getUid)(y).toString()]&&y.getGeometry()&&(void 0===o||(0,s.intersects)(o,y.getGeometry().getExtent()))){e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),this.drawElements(e,i,a,h);const t=r(y);if(t)return t}u--,h=a}},S.prototype.drawReplaySkipping_=function(e,i,s){let n,r,o,l,a,h,p,c,y;for(c=this.startIndices.length-2,o=r=this.startIndices[c+1],n=this.styleIndices_.length-1;n>=0;--n){for(l=this.styles_[n],this.setFillStyle_(e,l),a=this.styleIndices_[n];c>=0&&this.startIndices[c]>=a;)y=this.startIndices[c],h=this.startIndicesFeature[c],s[p=(0,t.getUid)(h).toString()]&&(r!==o&&(this.drawElements(e,i,r,o),e.clear(e.DEPTH_BUFFER_BIT)),o=y),c--,r=y;r!==o&&(this.drawElements(e,i,r,o),e.clear(e.DEPTH_BUFFER_BIT)),r=o=a}},S.prototype.setFillStyle_=function(t,e){t.uniform4fv(this.defaultLocations_.u_color,e)},S.prototype.setFillStrokeStyle=function(t,s){let n=t?t.getColor():[0,0,0,0];if(n=n instanceof CanvasGradient||n instanceof CanvasPattern?g.DEFAULT_FILLSTYLE:(0,i.asArray)(n).map(function(t,e){return 3!=e?t/255:t})||g.DEFAULT_FILLSTYLE,this.state_.fillColor&&(0,e.equals)(n,this.state_.fillColor)||(this.state_.fillColor=n,this.state_.changed=!0,this.styles_.push(n)),s)this.lineStringReplay.setFillStrokeStyle(null,s);else{const t=new d.default({color:[0,0,0,0],lineWidth:0});this.lineStringReplay.setFillStrokeStyle(null,t)}},exports.default=S;
},{"../../util.js":43,"../../array.js":130,"../../color.js":209,"../../extent.js":90,"../../obj.js":74,"../../geom/flat/contains.js":198,"../../geom/flat/orient.js":203,"../../geom/flat/transform.js":192,"../webgl/polygonreplay/defaultshader.js":295,"../webgl/polygonreplay/defaultshader/Locations.js":296,"../webgl/LineStringReplay.js":278,"../webgl/Replay.js":287,"../webgl.js":286,"../../style/Stroke.js":118,"../../structs/LinkedList.js":294,"../../structs/RBush.js":251,"../../webgl.js":153,"../../webgl/Buffer.js":233}],303:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../dom.js");const e=function(e,s){this.space_=s,this.emptyBlocks_=[{x:0,y:0,width:e,height:e}],this.entries_={},this.context_=(0,t.createCanvasContext2D)(e,e),this.canvas_=this.context_.canvas};e.prototype.get=function(t){return this.entries_[t]||null},e.prototype.add=function(t,e,s,i,h){for(let c=0,o=this.emptyBlocks_.length;c<o;++c){const o=this.emptyBlocks_[c];if(o.width>=e+this.space_&&o.height>=s+this.space_){const p={offsetX:o.x+this.space_,offsetY:o.y+this.space_,image:this.canvas_};return this.entries_[t]=p,i.call(h,this.context_,o.x+this.space_,o.y+this.space_),this.split_(c,o,e+this.space_,s+this.space_),p}}return null},e.prototype.split_=function(t,e,s,i){let h,c;e.width-s>e.height-i?(h={x:e.x+s,y:e.y,width:e.width-s,height:e.height},c={x:e.x,y:e.y+i,width:s,height:e.height-i},this.updateBlocks_(t,h,c)):(h={x:e.x+s,y:e.y,width:e.width-s,height:i},c={x:e.x,y:e.y+i,width:e.width,height:e.height-i},this.updateBlocks_(t,h,c))},e.prototype.updateBlocks_=function(t,e,s){const i=[t,1];e.width>0&&e.height>0&&i.push(e),s.width>0&&s.height>0&&i.push(s),this.emptyBlocks_.splice.apply(this.emptyBlocks_,i)},exports.default=e;
},{"../dom.js":93}],300:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../webgl.js"),e=require("../functions.js"),i=require("../style/Atlas.js"),s=n(i);function n(t){return t&&t.__esModule?t:{default:t}}const r=256,o=-1,u=function(e){const i=e||{};this.currentSize_=void 0!==i.initialSize?i.initialSize:256,this.maxSize_=void 0!==i.maxSize?i.maxSize:void 0!==t.MAX_TEXTURE_SIZE?t.MAX_TEXTURE_SIZE:2048,this.space_=void 0!==i.space?i.space:1,this.atlases_=[new s.default(this.currentSize_,this.space_)],this.currentHitSize_=this.currentSize_,this.hitAtlases_=[new s.default(this.currentHitSize_,this.space_)]};u.prototype.getInfo=function(t){const e=this.getInfo_(this.atlases_,t);if(!e)return null;const i=this.getInfo_(this.hitAtlases_,t);return this.mergeInfos_(e,i)},u.prototype.getInfo_=function(t,e){for(let i=0,s=t.length;i<s;++i){const s=t[i].get(e);if(s)return s}return null},u.prototype.mergeInfos_=function(t,e){return{offsetX:t.offsetX,offsetY:t.offsetY,image:t.image,hitImage:e.image}},u.prototype.add=function(t,i,s,n,r,o){if(i+this.space_>this.maxSize_||s+this.space_>this.maxSize_)return null;const u=this.add_(!1,t,i,s,n,o);if(!u)return null;const a=void 0!==r?r:e.UNDEFINED,_=this.add_(!0,t,i,s,a,o);return this.mergeInfos_(u,_)},u.prototype.add_=function(t,e,i,n,r,o){const u=t?this.hitAtlases_:this.atlases_;let a,_,h,f;for(h=0,f=u.length;h<f;++h){if(_=(a=u[h]).add(e,i,n,r,o))return _;if(!_&&h===f-1){let e;t?(e=Math.min(2*this.currentHitSize_,this.maxSize_),this.currentHitSize_=e):(e=Math.min(2*this.currentSize_,this.maxSize_),this.currentSize_=e),a=new s.default(e,this.space_),u.push(a),++f}}return null},exports.default=u;
},{"../webgl.js":153,"../functions.js":103,"../style/Atlas.js":303}],280:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../util.js"),e=require("../../colorlike.js"),i=require("../../dom.js"),s=require("../../geom/GeometryType.js"),o=g(s),l=require("../../has.js"),n=require("../replay.js"),h=require("../webgl.js"),a=require("../webgl/TextureReplay.js"),r=g(a),f=require("../../style/AtlasManager.js"),u=g(f),d=require("../../webgl/Buffer.js"),c=g(d);function g(t){return t&&t.__esModule?t:{default:t}}const _=function(t,e){r.default.call(this,t,e),this.images_=[],this.textures_=[],this.measureCanvas_=(0,i.createCanvasContext2D)(0,0).canvas,this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.atlases_={},this.currAtlas_=void 0,this.scale=1,this.opacity=1};(0,t.inherits)(_,r.default),_.prototype.drawText=function(e,i){if(this.text_){let s=null;const l=0;let n=2,h=2;switch(e.getType()){case o.default.POINT:case o.default.MULTI_POINT:n=(s=e.getFlatCoordinates()).length,h=e.getStride();break;case o.default.CIRCLE:s=e.getCenter();break;case o.default.LINE_STRING:s=e.getFlatMidpoint();break;case o.default.MULTI_LINE_STRING:n=(s=e.getFlatMidpoints()).length;break;case o.default.POLYGON:s=e.getFlatInteriorPoint();break;case o.default.MULTI_POLYGON:n=(s=e.getFlatInteriorPoints()).length}this.startIndices.push(this.indices.length),this.startIndicesFeature.push(i);const a=this.currAtlas_,r=this.text_.split("\n"),f=this.getTextSize_(r);let u,d,c,g,_,T,p,L;const x=Math.round(f[0]*this.textAlign_-this.offsetX_),A=Math.round(f[1]*this.textBaseline_-this.offsetY_),C=this.state_.lineWidth/2*this.state_.scale;for(u=0,d=r.length;u<d;++u)for(_=0,T=a.height*u,p=r[u].split(""),c=0,g=p.length;c<g;++c){if(L=a.atlas.getInfo(p[c])){const e=L.image;if(this.anchorX=x-_,this.anchorY=A-T,this.originX=0===c?L.offsetX-C:L.offsetX,this.originY=L.offsetY,this.height=a.height,this.width=0===c||c===p.length-1?a.width[p[c]]+C:a.width[p[c]],this.imageHeight=e.height,this.imageWidth=e.width,0===this.images_.length)this.images_.push(e);else{const i=this.images_[this.images_.length-1];(0,t.getUid)(i)!=(0,t.getUid)(e)&&(this.groupIndices.push(this.indices.length),this.images_.push(e))}this.drawText_(s,l,n,h)}_+=this.width}}},_.prototype.getTextSize_=function(t){const e=this,i=this.currAtlas_,s=t.length*i.height;return[t.map(function(t){let s=0;for(let o=0,l=t.length;o<l;++o){const l=t[o];i.width[l]||e.addCharToAtlas_(l),s+=i.width[l]?i.width[l]:0}return s}).reduce(function(t,e){return Math.max(t,e)}),s]},_.prototype.drawText_=function(t,e,i,s){for(let o=e,l=i;o<l;o+=s)this.drawCoordinates(t,e,i,s)},_.prototype.addCharToAtlas_=function(t){if(1===t.length){const e=this.currAtlas_,i=this.state_,s=this.measureCanvas_.getContext("2d");s.font=i.font;const o=Math.ceil(s.measureText(t).width*i.scale);e.atlas.add(t,o,e.height,function(e,s,o){e.font=i.font,e.fillStyle=i.fillColor,e.strokeStyle=i.strokeColor,e.lineWidth=i.lineWidth,e.lineCap=i.lineCap,e.lineJoin=i.lineJoin,e.miterLimit=i.miterLimit,e.textAlign="left",e.textBaseline="top",l.CANVAS_LINE_DASH&&i.lineDash&&(e.setLineDash(i.lineDash),e.lineDashOffset=i.lineDashOffset),1!==i.scale&&e.setTransform(i.scale,0,0,i.scale,0,0),i.strokeColor&&e.strokeText(t,s,o),i.fillColor&&e.fillText(t,s,o)})&&(e.width[t]=o)}},_.prototype.finish=function(t){const e=t.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices=this.groupIndices,this.verticesBuffer=new c.default(this.vertices),this.indicesBuffer=new c.default(this.indices);this.createTextures(this.textures_,this.images_,{},e),this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.images_=null,this.atlases_={},this.currAtlas_=void 0,r.default.prototype.finish.call(this,t)},_.prototype.setTextStyle=function(t){const i=this.state_,s=t.getFill(),o=t.getStroke();if(t&&t.getText()&&(s||o)){if(s){const t=s.getColor();i.fillColor=(0,e.asColorLike)(t||h.DEFAULT_FILLSTYLE)}else i.fillColor=null;if(o){const t=o.getColor();i.strokeColor=(0,e.asColorLike)(t||h.DEFAULT_STROKESTYLE),i.lineWidth=o.getWidth()||h.DEFAULT_LINEWIDTH,i.lineCap=o.getLineCap()||h.DEFAULT_LINECAP,i.lineDashOffset=o.getLineDashOffset()||h.DEFAULT_LINEDASHOFFSET,i.lineJoin=o.getLineJoin()||h.DEFAULT_LINEJOIN,i.miterLimit=o.getMiterLimit()||h.DEFAULT_MITERLIMIT;const s=o.getLineDash();i.lineDash=s?s.slice():h.DEFAULT_LINEDASH}else i.strokeColor=null,i.lineWidth=0;i.font=t.getFont()||h.DEFAULT_FONT,i.scale=t.getScale()||1,this.text_=t.getText();const l=n.TEXT_ALIGN[t.getTextAlign()],a=n.TEXT_ALIGN[t.getTextBaseline()];this.textAlign_=void 0===l?h.DEFAULT_TEXTALIGN:l,this.textBaseline_=void 0===a?h.DEFAULT_TEXTBASELINE:a,this.offsetX_=t.getOffsetX()||0,this.offsetY_=t.getOffsetY()||0,this.rotateWithView=!!t.getRotateWithView(),this.rotation=t.getRotation()||0,this.currAtlas_=this.getAtlas_(i)}else this.text_=""},_.prototype.getAtlas_=function(t){let e=[];for(const i in t)(t[i]||0===t[i])&&(Array.isArray(t[i])?e=e.concat(t[i]):e.push(t[i]));const i=this.calculateHash_(e);if(!this.atlases_[i]){const e=this.measureCanvas_.getContext("2d");e.font=t.font;const s=Math.ceil((1.5*e.measureText("M").width+t.lineWidth/2)*t.scale);this.atlases_[i]={atlas:new u.default({space:t.lineWidth+1}),width:{},height:s}}return this.atlases_[i]},_.prototype.calculateHash_=function(t){let e="";for(let i=0,s=t.length;i<s;++i)e+=t[i];return e},_.prototype.getTextures=function(t){return this.textures_},_.prototype.getHitDetectionTextures=function(){return this.textures_},exports.default=_;
},{"../../util.js":43,"../../colorlike.js":257,"../../dom.js":93,"../../geom/GeometryType.js":140,"../../has.js":86,"../replay.js":225,"../webgl.js":286,"../webgl/TextureReplay.js":292,"../../style/AtlasManager.js":300,"../../webgl/Buffer.js":233}],237:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../util.js"),t=require("../../array.js"),r=require("../../extent.js"),n=require("../../obj.js"),i=require("../replay.js"),o=require("../ReplayGroup.js"),s=g(o),l=require("../webgl/CircleReplay.js"),u=g(l),a=require("../webgl/ImageReplay.js"),f=g(a),y=require("../webgl/LineStringReplay.js"),p=g(y),c=require("../webgl/PolygonReplay.js"),d=g(c),h=require("../webgl/TextReplay.js"),_=g(h);function g(e){return e&&e.__esModule?e:{default:e}}const x=[1,1],R={Circle:u.default,Image:f.default,LineString:p.default,Polygon:d.default,Text:_.default},B=function(e,t,r){s.default.call(this),this.maxExtent_=t,this.tolerance_=e,this.renderBuffer_=r,this.replaysByZIndex_={}};(0,e.inherits)(B,s.default),B.prototype.addDeclutter=function(e,t){},B.prototype.getDeleteResourcesFunction=function(e){const t=[];let r;for(r in this.replaysByZIndex_){const n=this.replaysByZIndex_[r];for(const r in n)t.push(n[r].getDeleteResourcesFunction(e))}return function(){const e=t.length;let r;for(let n=0;n<e;n++)r=t[n].apply(this,arguments);return r}},B.prototype.finish=function(e){let t;for(t in this.replaysByZIndex_){const r=this.replaysByZIndex_[t];for(const t in r)r[t].finish(e)}},B.prototype.getReplay=function(e,t){const r=void 0!==e?e.toString():"0";let n=this.replaysByZIndex_[r];void 0===n&&(n={},this.replaysByZIndex_[r]=n);let i=n[t];if(void 0===i){i=new(0,R[t])(this.tolerance_,this.maxExtent_),n[t]=i}return i},B.prototype.isEmpty=function(){return(0,n.isEmpty)(this.replaysByZIndex_)},B.prototype.replay=function(e,r,n,o,s,l,u,a){const f=Object.keys(this.replaysByZIndex_).map(Number);let y,p,c,d,h,_;for(f.sort(t.numberSafeCompareFunction),y=0,p=f.length;y<p;++y)for(h=this.replaysByZIndex_[f[y].toString()],c=0,d=i.ORDER.length;c<d;++c)void 0!==(_=h[i.ORDER[c]])&&_.replay(e,r,n,o,s,l,u,a,void 0,!1)},B.prototype.replayHitDetection_=function(e,t,r,n,o,s,l,u,a,f,y){const p=Object.keys(this.replaysByZIndex_).map(Number);let c,d,h,_,g,x;for(p.sort(function(e,t){return t-e}),c=0,d=p.length;c<d;++c)for(_=this.replaysByZIndex_[p[c].toString()],h=i.ORDER.length-1;h>=0;--h)if(void 0!==(g=_[i.ORDER[h]])&&(x=g.replay(e,t,r,n,o,s,l,u,a,f,y)))return x},B.prototype.forEachFeatureAtCoordinate=function(e,t,n,i,o,s,l,u,a,f){const y=t.getGL();let p;return y.bindFramebuffer(y.FRAMEBUFFER,t.getHitDetectionFramebuffer()),void 0!==this.renderBuffer_&&(p=(0,r.buffer)((0,r.createOrUpdateFromCoordinate)(e),i*this.renderBuffer_)),this.replayHitDetection_(t,e,i,o,x,l,u,a,function(e){const t=new Uint8Array(4);if(y.readPixels(0,0,1,1,y.RGBA,y.UNSIGNED_BYTE,t),t[3]>0){const t=f(e);if(t)return t}},!0,p)},B.prototype.hasFeatureAtCoordinate=function(e,t,r,n,i,o,s,l,u){const a=t.getGL();return a.bindFramebuffer(a.FRAMEBUFFER,t.getHitDetectionFramebuffer()),void 0!==this.replayHitDetection_(t,e,n,i,x,s,l,u,function(e){const t=new Uint8Array(4);return a.readPixels(0,0,1,1,a.RGBA,a.UNSIGNED_BYTE,t),t[3]>0},!1)},exports.default=B;
},{"../../util.js":43,"../../array.js":130,"../../extent.js":90,"../../obj.js":74,"../replay.js":225,"../ReplayGroup.js":259,"../webgl/CircleReplay.js":276,"../webgl/ImageReplay.js":277,"../webgl/LineStringReplay.js":278,"../webgl/PolygonReplay.js":279,"../webgl/TextReplay.js":280}],229:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../util.js"),e=require("../../extent.js"),i=require("../../geom/GeometryType.js"),s=_(i),l=require("../ReplayType.js"),o=_(l),n=require("../VectorContext.js"),r=_(n),h=require("../webgl/ReplayGroup.js"),a=_(h);function _(t){return t&&t.__esModule?t:{default:t}}const u=function(t,e,i,s,l,o,n){r.default.call(this),this.context_=t,this.center_=e,this.extent_=o,this.pixelRatio_=n,this.size_=l,this.rotation_=s,this.resolution_=i,this.imageStyle_=null,this.fillStyle_=null,this.strokeStyle_=null,this.textStyle_=null};(0,t.inherits)(u,r.default),u.prototype.drawText_=function(t,e){const i=this.context_,s=t.getReplay(0,o.default.TEXT);s.setTextStyle(this.textStyle_),s.drawText(e,null),s.finish(i);s.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),s.getDeleteResourcesFunction(i)()},u.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},u.prototype.drawGeometry=function(t){switch(t.getType()){case s.default.POINT:this.drawPoint(t,null);break;case s.default.LINE_STRING:this.drawLineString(t,null);break;case s.default.POLYGON:this.drawPolygon(t,null);break;case s.default.MULTI_POINT:this.drawMultiPoint(t,null);break;case s.default.MULTI_LINE_STRING:this.drawMultiLineString(t,null);break;case s.default.MULTI_POLYGON:this.drawMultiPolygon(t,null);break;case s.default.GEOMETRY_COLLECTION:this.drawGeometryCollection(t,null);break;case s.default.CIRCLE:this.drawCircle(t,null)}},u.prototype.drawFeature=function(t,i){const s=i.getGeometryFunction()(t);s&&(0,e.intersects)(this.extent_,s.getExtent())&&(this.setStyle(i),this.drawGeometry(s))},u.prototype.drawGeometryCollection=function(t,e){const i=t.getGeometriesArray();let s,l;for(s=0,l=i.length;s<l;++s)this.drawGeometry(i[s])},u.prototype.drawPoint=function(t,e){const i=this.context_,s=new a.default(1,this.extent_),l=s.getReplay(0,o.default.IMAGE);l.setImageStyle(this.imageStyle_),l.drawPoint(t,e),l.finish(i);l.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),l.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(s,t)},u.prototype.drawMultiPoint=function(t,e){const i=this.context_,s=new a.default(1,this.extent_),l=s.getReplay(0,o.default.IMAGE);l.setImageStyle(this.imageStyle_),l.drawMultiPoint(t,e),l.finish(i);l.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),l.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(s,t)},u.prototype.drawLineString=function(t,e){const i=this.context_,s=new a.default(1,this.extent_),l=s.getReplay(0,o.default.LINE_STRING);l.setFillStrokeStyle(null,this.strokeStyle_),l.drawLineString(t,e),l.finish(i);l.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),l.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(s,t)},u.prototype.drawMultiLineString=function(t,e){const i=this.context_,s=new a.default(1,this.extent_),l=s.getReplay(0,o.default.LINE_STRING);l.setFillStrokeStyle(null,this.strokeStyle_),l.drawMultiLineString(t,e),l.finish(i);l.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),l.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(s,t)},u.prototype.drawPolygon=function(t,e){const i=this.context_,s=new a.default(1,this.extent_),l=s.getReplay(0,o.default.POLYGON);l.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),l.drawPolygon(t,e),l.finish(i);l.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),l.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(s,t)},u.prototype.drawMultiPolygon=function(t,e){const i=this.context_,s=new a.default(1,this.extent_),l=s.getReplay(0,o.default.POLYGON);l.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),l.drawMultiPolygon(t,e),l.finish(i);l.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),l.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(s,t)},u.prototype.drawCircle=function(t,e){const i=this.context_,s=new a.default(1,this.extent_),l=s.getReplay(0,o.default.CIRCLE);l.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),l.drawCircle(t,e),l.finish(i);l.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),l.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(s,t)},u.prototype.setImageStyle=function(t){this.imageStyle_=t},u.prototype.setFillStrokeStyle=function(t,e){this.fillStyle_=t,this.strokeStyle_=e},u.prototype.setTextStyle=function(t){this.textStyle_=t},exports.default=u;
},{"../../util.js":43,"../../extent.js":90,"../../geom/GeometryType.js":140,"../ReplayType.js":224,"../VectorContext.js":258,"../webgl/ReplayGroup.js":237}],268:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.vertex=exports.fragment=void 0;var e=require("../../webgl.js"),o=require("../../webgl/Fragment.js"),r=i(o),t=require("../../webgl/Vertex.js"),n=i(t);function i(e){return e&&e.__esModule?e:{default:e}}const a=exports.fragment=new r.default(e.DEBUG?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform float u_opacity;\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_texture, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  gl_FragColor.a = texColor.a * u_opacity;\n}\n":"precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}"),u=exports.vertex=new n.default(e.DEBUG?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform mat4 u_texCoordMatrix;\nuniform mat4 u_projectionMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}");
},{"../../webgl.js":153,"../../webgl/Fragment.js":266,"../../webgl/Vertex.js":267}],270:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../../webgl.js");const o=function(o,i){this.u_texCoordMatrix=o.getUniformLocation(i,t.DEBUG?"u_texCoordMatrix":"d"),this.u_projectionMatrix=o.getUniformLocation(i,t.DEBUG?"u_projectionMatrix":"e"),this.u_opacity=o.getUniformLocation(i,t.DEBUG?"u_opacity":"f"),this.u_texture=o.getUniformLocation(i,t.DEBUG?"u_texture":"g"),this.a_position=o.getAttribLocation(i,t.DEBUG?"a_position":"b"),this.a_texCoord=o.getAttribLocation(i,t.DEBUG?"a_texCoord":"c")};exports.default=o;
},{"../../../webgl.js":153}],234:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../util.js"),t=require("../../render/Event.js"),r=_(t),i=require("../../render/EventType.js"),o=_(i),n=require("../../render/webgl/Immediate.js"),a=_(n),s=require("../Layer.js"),u=_(s),f=require("../webgl/defaultmapshader.js"),d=require("../webgl/defaultmapshader/Locations.js"),l=_(d),m=require("../../transform.js"),p=require("../../vec/mat4.js"),c=require("../../webgl.js"),h=require("../../webgl/Buffer.js"),x=_(h),b=require("../../webgl/Context.js");function _(e){return e&&e.__esModule?e:{default:e}}const E=function(e,t){u.default.call(this,t),this.mapRenderer=e,this.arrayBuffer_=new x.default([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]),this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0,this.texCoordMatrix=(0,m.create)(),this.projectionMatrix=(0,m.create)(),this.tmpMat4_=(0,p.create)(),this.defaultLocations_=null};(0,e.inherits)(E,u.default),E.prototype.bindFramebuffer=function(e,t){const r=this.mapRenderer.getGL();if(void 0===this.framebufferDimension||this.framebufferDimension!=t){const i=function(e,t,r){e.isContextLost()||(e.deleteFramebuffer(t),e.deleteTexture(r))}.bind(null,r,this.framebuffer,this.texture);e.postRenderFunctions.push(i);const o=(0,b.createEmptyTexture)(r,t,t),n=r.createFramebuffer();r.bindFramebuffer(c.FRAMEBUFFER,n),r.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,o,0),this.texture=o,this.framebuffer=n,this.framebufferDimension=t}else r.bindFramebuffer(c.FRAMEBUFFER,this.framebuffer)},E.prototype.composeFrame=function(e,t,r){this.dispatchComposeEvent_(o.default.PRECOMPOSE,r,e),r.bindBuffer(c.ARRAY_BUFFER,this.arrayBuffer_);const i=r.getGL(),n=r.getProgram(f.fragment,f.vertex);let a;this.defaultLocations_?a=this.defaultLocations_:(a=new l.default(i,n),this.defaultLocations_=a),r.useProgram(n)&&(i.enableVertexAttribArray(a.a_position),i.vertexAttribPointer(a.a_position,2,c.FLOAT,!1,16,0),i.enableVertexAttribArray(a.a_texCoord),i.vertexAttribPointer(a.a_texCoord,2,c.FLOAT,!1,16,8),i.uniform1i(a.u_texture,0)),i.uniformMatrix4fv(a.u_texCoordMatrix,!1,(0,p.fromTransform)(this.tmpMat4_,this.getTexCoordMatrix())),i.uniformMatrix4fv(a.u_projectionMatrix,!1,(0,p.fromTransform)(this.tmpMat4_,this.getProjectionMatrix())),i.uniform1f(a.u_opacity,t.opacity),i.bindTexture(c.TEXTURE_2D,this.getTexture()),i.drawArrays(c.TRIANGLE_STRIP,0,4),this.dispatchComposeEvent_(o.default.POSTCOMPOSE,r,e)},E.prototype.dispatchComposeEvent_=function(e,t,i){const o=this.getLayer();if(o.hasListener(e)){const n=i.viewState,s=n.resolution,u=i.pixelRatio,f=i.extent,d=n.center,l=n.rotation,m=i.size,p=new a.default(t,d,s,l,m,f,u),c=new r.default(e,p,i,null,t);o.dispatchEvent(c)}},E.prototype.getTexCoordMatrix=function(){return this.texCoordMatrix},E.prototype.getTexture=function(){return this.texture},E.prototype.getProjectionMatrix=function(){return this.projectionMatrix},E.prototype.handleWebGLContextLost=function(){this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0},E.prototype.prepareFrame=function(e,t,r){},E.prototype.forEachLayerAtPixel=function(e,t,r,i){},exports.default=E;
},{"../../util.js":43,"../../render/Event.js":216,"../../render/EventType.js":120,"../../render/webgl/Immediate.js":229,"../Layer.js":265,"../webgl/defaultmapshader.js":268,"../webgl/defaultmapshader/Locations.js":270,"../../transform.js":105,"../../vec/mat4.js":269,"../../webgl.js":153,"../../webgl/Buffer.js":233,"../../webgl/Context.js":230}],144:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../reproj/common.js"),e=require("../../util.js"),r=require("../../functions.js"),i=require("../../LayerType.js"),a=p(i),n=require("../../ViewHint.js"),o=p(n),s=require("../../dom.js"),u=require("../../extent.js"),c=require("../webgl/Layer.js"),h=p(c),l=require("../../transform.js"),g=require("../../webgl.js"),f=require("../../webgl/Context.js");function p(t){return t&&t.__esModule?t:{default:t}}const x=function(t,e){h.default.call(this,t,e),this.image_=null,this.hitCanvasContext_=null,this.hitTransformationMatrix_=null};(0,e.inherits)(x,h.default),x.handles=function(t){return t.getType()===a.default.IMAGE},x.create=function(t,e){return new x(t,e)},x.prototype.createTexture_=function(t){const e=t.getImage(),r=this.mapRenderer.getGL();return(0,f.createTexture)(r,e,g.CLAMP_TO_EDGE,g.CLAMP_TO_EDGE)},x.prototype.forEachFeatureAtCoordinate=function(t,e,r,i,a){const n=this.getLayer(),o=n.getSource(),s=e.viewState.resolution,u=e.viewState.rotation,c=e.skippedFeatureUids;return o.forEachFeatureAtCoordinate(t,s,u,r,c,function(t){return i.call(a,t,n)})},x.prototype.prepareFrame=function(e,r,i){const a=this.mapRenderer.getGL(),n=e.pixelRatio,s=e.viewState,c=s.center,h=s.resolution,g=s.rotation;let f=this.image_,p=this.texture;const x=this.getLayer().getSource(),d=e.viewHints;let m=e.extent;if(void 0!==r.extent&&(m=(0,u.getIntersection)(m,r.extent)),!d[o.default.ANIMATING]&&!d[o.default.INTERACTING]&&!(0,u.isEmpty)(m)){let r=s.projection;if(!t.ENABLE_RASTER_REPROJECTION){const t=x.getProjection();t&&(r=t)}const i=x.getImage(m,h,n,r);if(i){if(this.loadImage(i)&&(f=i,p=this.createTexture_(i),this.texture)){const t=function(t,e){t.isContextLost()||t.deleteTexture(e)}.bind(null,a,this.texture);e.postRenderFunctions.push(t)}}}if(f){const t=this.mapRenderer.getContext().getCanvas();this.updateProjectionMatrix_(t.width,t.height,n,c,h,g,f.getExtent()),this.hitTransformationMatrix_=null;const e=this.texCoordMatrix;(0,l.reset)(e),(0,l.scale)(e,1,-1),(0,l.translate)(e,0,-1),this.image_=f,this.texture=p}return!!f},x.prototype.updateProjectionMatrix_=function(t,e,r,i,a,n,o){const s=t*a,u=e*a,c=this.projectionMatrix;(0,l.reset)(c),(0,l.scale)(c,2*r/s,2*r/u),(0,l.rotate)(c,-n),(0,l.translate)(c,o[0]-i[0],o[1]-i[1]),(0,l.scale)(c,(o[2]-o[0])/2,(o[3]-o[1])/2),(0,l.translate)(c,1,1)},x.prototype.hasFeatureAtCoordinate=function(t,e){return void 0!==this.forEachFeatureAtCoordinate(t,e,0,r.TRUE,this)},x.prototype.forEachLayerAtPixel=function(t,e,i,a){if(this.image_&&this.image_.getImage()){if(this.getLayer().getSource().forEachFeatureAtCoordinate!==r.UNDEFINED){const n=(0,l.apply)(e.pixelToCoordinateTransform,t.slice());return this.forEachFeatureAtCoordinate(n,e,0,r.TRUE,this)?i.call(a,this.getLayer(),null):void 0}{const r=[this.image_.getImage().width,this.image_.getImage().height];this.hitTransformationMatrix_||(this.hitTransformationMatrix_=this.getHitTransformationMatrix_(e.size,r));const n=(0,l.apply)(this.hitTransformationMatrix_,t.slice());if(n[0]<0||n[0]>r[0]||n[1]<0||n[1]>r[1])return;this.hitCanvasContext_||(this.hitCanvasContext_=(0,s.createCanvasContext2D)(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.image_.getImage(),n[0],n[1],1,1,0,0,1,1);const o=this.hitCanvasContext_.getImageData(0,0,1,1).data;return o[3]>0?i.call(a,this.getLayer(),o):void 0}}},x.prototype.getHitTransformationMatrix_=function(t,e){const r=(0,l.create)();(0,l.translate)(r,-1,-1),(0,l.scale)(r,2/t[0],2/t[1]),(0,l.translate)(r,0,t[1]),(0,l.scale)(r,1,-1);const i=(0,l.invert)(this.projectionMatrix.slice()),a=(0,l.create)();return(0,l.translate)(a,0,e[1]),(0,l.scale)(a,1,-1),(0,l.scale)(a,e[0]/2,e[1]/2),(0,l.translate)(a,1,1),(0,l.multiply)(a,i),(0,l.multiply)(a,r),a},exports.default=x;
},{"../../reproj/common.js":222,"../../util.js":43,"../../functions.js":103,"../../LayerType.js":73,"../../ViewHint.js":102,"../../dom.js":93,"../../extent.js":90,"../webgl/Layer.js":234,"../../transform.js":105,"../../webgl.js":153,"../../webgl/Context.js":230}],146:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../util.js"),t=require("../../array.js"),i=require("../../css.js"),r=require("../../dom.js"),s=require("../../events.js"),n=require("../../layer/Layer.js"),a=require("../../render/Event.js"),o=m(a),u=require("../../render/EventType.js"),h=m(u),l=require("../../render/webgl/Immediate.js"),c=m(l),_=require("../Map.js"),d=m(_),T=require("../../source/State.js"),p=m(T),x=require("../../structs/LRUCache.js"),E=m(x),C=require("../../structs/PriorityQueue.js"),f=m(C),y=require("../../webgl.js"),R=require("../../webgl/Context.js"),g=m(R),L=require("../../webgl/ContextEventType.js"),v=m(L);function m(e){return e&&e.__esModule?e:{default:e}}const A=1024,S=function(e){d.default.call(this,e);const t=e.getViewport();this.canvas_=document.createElement("CANVAS"),this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=i.CLASS_UNSELECTABLE,t.insertBefore(this.canvas_,t.childNodes[0]||null),this.clipTileCanvasWidth_=0,this.clipTileCanvasHeight_=0,this.clipTileContext_=(0,r.createCanvasContext2D)(),this.renderedVisible_=!0,this.gl_=(0,y.getContext)(this.canvas_,{antialias:!0,depth:!0,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!1,stencil:!0}),this.context_=new g.default(this.canvas_,this.gl_),(0,s.listen)(this.canvas_,v.default.LOST,this.handleWebGLContextLost,this),(0,s.listen)(this.canvas_,v.default.RESTORED,this.handleWebGLContextRestored,this),this.textureCache_=new E.default,this.focus_=null,this.tileTextureQueue_=new f.default(function(e){const t=e[1],i=e[2],r=t[0]-this.focus_[0],s=t[1]-this.focus_[1];return 65536*Math.log(i)+Math.sqrt(r*r+s*s)/i}.bind(this),function(e){return e[0].getKey()}),this.loadNextTileTexture_=function(e,t){if(!this.tileTextureQueue_.isEmpty()){this.tileTextureQueue_.reprioritize();const e=this.tileTextureQueue_.dequeue(),t=e[0],i=e[3],r=e[4];this.bindTileTexture(t,i,r,y.LINEAR,y.LINEAR)}return!1}.bind(this),this.textureCacheFrameMarkerCount_=0,this.initializeGL_()};(0,e.inherits)(S,d.default),S.prototype.bindTileTexture=function(e,t,i,r,s){const n=this.getGL(),a=e.getKey();if(this.textureCache_.containsKey(a)){const e=this.textureCache_.get(a);n.bindTexture(y.TEXTURE_2D,e.texture),e.magFilter!=r&&(n.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,r),e.magFilter=r),e.minFilter!=s&&(n.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,s),e.minFilter=s)}else{const o=n.createTexture();if(n.bindTexture(y.TEXTURE_2D,o),i>0){const r=this.clipTileContext_.canvas,s=this.clipTileContext_;this.clipTileCanvasWidth_!==t[0]||this.clipTileCanvasHeight_!==t[1]?(r.width=t[0],r.height=t[1],this.clipTileCanvasWidth_=t[0],this.clipTileCanvasHeight_=t[1]):s.clearRect(0,0,t[0],t[1]),s.drawImage(e.getImage(),i,i,t[0],t[1],0,0,t[0],t[1]),n.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,r)}else n.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,e.getImage());n.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,r),n.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,s),n.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),n.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),this.textureCache_.set(a,{texture:o,magFilter:r,minFilter:s})}},S.prototype.dispatchComposeEvent_=function(e,t){const i=this.getMap();if(i.hasListener(e)){const r=this.context_,s=t.extent,n=t.size,a=t.viewState,u=t.pixelRatio,h=a.resolution,l=a.center,_=a.rotation,d=new c.default(r,l,h,_,n,s,u),T=new o.default(e,d,t,null,r);i.dispatchEvent(T)}},S.prototype.disposeInternal=function(){const e=this.getGL();e.isContextLost()||this.textureCache_.forEach(function(t){t&&e.deleteTexture(t.texture)}),this.context_.dispose(),d.default.prototype.disposeInternal.call(this)},S.prototype.expireCache_=function(e,t){const i=this.getGL();let r;for(;this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>1024;){if(r=this.textureCache_.peekLast())i.deleteTexture(r.texture);else{if(+this.textureCache_.peekLastKey()==t.index)break;--this.textureCacheFrameMarkerCount_}this.textureCache_.pop()}},S.prototype.getContext=function(){return this.context_},S.prototype.getGL=function(){return this.gl_},S.prototype.getTileTextureQueue=function(){return this.tileTextureQueue_},S.prototype.handleWebGLContextLost=function(e){e.preventDefault(),this.textureCache_.clear(),this.textureCacheFrameMarkerCount_=0;const t=this.getLayerRenderers();for(const e in t){t[e].handleWebGLContextLost()}},S.prototype.handleWebGLContextRestored=function(){this.initializeGL_(),this.getMap().render()},S.prototype.initializeGL_=function(){const e=this.gl_;e.activeTexture(y.TEXTURE0),e.blendFuncSeparate(y.SRC_ALPHA,y.ONE_MINUS_SRC_ALPHA,y.ONE,y.ONE_MINUS_SRC_ALPHA),e.disable(y.CULL_FACE),e.disable(y.DEPTH_TEST),e.disable(y.SCISSOR_TEST),e.disable(y.STENCIL_TEST)},S.prototype.isTileTextureLoaded=function(e){return this.textureCache_.containsKey(e.getKey())},S.prototype.renderFrame=function(e){const i=this.getContext(),r=this.getGL();if(r.isContextLost())return!1;if(!e)return this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1),!1;this.focus_=e.focus,this.textureCache_.set((-e.index).toString(),null),++this.textureCacheFrameMarkerCount_,this.dispatchComposeEvent_(h.default.PRECOMPOSE,e);const s=[],a=e.layerStatesArray;(0,t.stableSort)(a,_.sortByZIndex);const o=e.viewState.resolution;let u,l,c,d;for(u=0,l=a.length;u<l;++u)d=a[u],(0,n.visibleAtResolution)(d,o)&&d.sourceState==p.default.READY&&(c=this.getLayerRenderer(d.layer)).prepareFrame(e,d,i)&&s.push(d);const T=e.size[0]*e.pixelRatio,x=e.size[1]*e.pixelRatio;for(this.canvas_.width==T&&this.canvas_.height==x||(this.canvas_.width=T,this.canvas_.height=x),r.bindFramebuffer(y.FRAMEBUFFER,null),r.clearColor(0,0,0,0),r.clear(y.COLOR_BUFFER_BIT),r.enable(y.BLEND),r.viewport(0,0,this.canvas_.width,this.canvas_.height),u=0,l=s.length;u<l;++u)d=s[u],(c=this.getLayerRenderer(d.layer)).composeFrame(e,d,i);this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.calculateMatrices2D(e),this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>1024&&e.postRenderFunctions.push(this.expireCache_.bind(this)),this.tileTextureQueue_.isEmpty()||(e.postRenderFunctions.push(this.loadNextTileTexture_),e.animate=!0),this.dispatchComposeEvent_(h.default.POSTCOMPOSE,e),this.scheduleRemoveUnusedLayerRenderers(e),this.scheduleExpireIconCache(e)},S.prototype.forEachFeatureAtCoordinate=function(e,t,i,r,s,a,o){let u;if(this.getGL().isContextLost())return!1;const h=t.viewState,l=t.layerStatesArray;let c;for(c=l.length-1;c>=0;--c){const _=l[c],d=_.layer;if((0,n.visibleAtResolution)(_,h.resolution)&&a.call(o,d)){if(u=this.getLayerRenderer(d).forEachFeatureAtCoordinate(e,t,i,r,s))return u}}},S.prototype.hasFeatureAtCoordinate=function(e,t,i,r,s){let a=!1;if(this.getGL().isContextLost())return!1;const o=t.viewState,u=t.layerStatesArray;let h;for(h=u.length-1;h>=0;--h){const i=u[h],l=i.layer;if((0,n.visibleAtResolution)(i,o.resolution)&&r.call(s,l)){if(a=this.getLayerRenderer(l).hasFeatureAtCoordinate(e,t))return!0}}return a},S.prototype.forEachLayerAtPixel=function(e,t,i,r,s,a,o){if(this.getGL().isContextLost())return!1;const u=t.viewState;let h;const l=t.layerStatesArray;let c;for(c=l.length-1;c>=0;--c){const i=l[c],o=i.layer;if((0,n.visibleAtResolution)(i,u.resolution)&&a.call(s,o)){if(h=this.getLayerRenderer(o).forEachLayerAtPixel(e,t,r,s))return h}}},exports.default=S;
},{"../../util.js":43,"../../array.js":130,"../../css.js":99,"../../dom.js":93,"../../events.js":84,"../../layer/Layer.js":75,"../../render/Event.js":216,"../../render/EventType.js":120,"../../render/webgl/Immediate.js":229,"../Map.js":218,"../../source/State.js":151,"../../structs/LRUCache.js":133,"../../structs/PriorityQueue.js":132,"../../webgl.js":153,"../../webgl/Context.js":230,"../../webgl/ContextEventType.js":231}],235:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.vertex=exports.fragment=void 0;var e=require("../../webgl.js"),t=require("../../webgl/Fragment.js"),r=i(t),o=require("../../webgl/Vertex.js"),n=i(o);function i(e){return e&&e.__esModule?e:{default:e}}const a=exports.fragment=new r.default(e.DEBUG?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n":"precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}"),v=exports.vertex=new n.default(e.DEBUG?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec4 u_tileOffset;\n\nvoid main(void) {\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\n  v_texCoord = a_texCoord;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}");
},{"../../webgl.js":153,"../../webgl/Fragment.js":266,"../../webgl/Vertex.js":267}],236:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../../webgl.js");const e=function(e,o){this.u_tileOffset=e.getUniformLocation(o,t.DEBUG?"u_tileOffset":"d"),this.u_texture=e.getUniformLocation(o,t.DEBUG?"u_texture":"e"),this.a_position=e.getAttribLocation(o,t.DEBUG?"a_position":"b"),this.a_texCoord=e.getAttribLocation(o,t.DEBUG?"a_texCoord":"c")};exports.default=e;
},{"../../../webgl.js":153}],145:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../util.js"),t=require("../../LayerType.js"),r=R(t),i=require("../../TileRange.js"),n=R(i),o=require("../../TileState.js"),s=R(o),a=require("../../array.js"),l=require("../../extent.js"),d=require("../../math.js"),u=require("../webgl/Layer.js"),f=R(u),h=require("../webgl/tilelayershader.js"),c=require("../webgl/tilelayershader/Locations.js"),g=R(c),T=require("../../size.js"),_=require("../../transform.js"),m=require("../../webgl.js"),x=require("../../webgl/Buffer.js"),p=R(x);function R(e){return e&&e.__esModule?e:{default:e}}const b=function(e,t){f.default.call(this,e,t),this.fragmentShader_=h.fragment,this.vertexShader_=h.vertex,this.locations_=null,this.renderArrayBuffer_=new p.default([0,0,0,1,1,0,1,1,0,1,0,0,1,1,1,0]),this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,this.tmpSize_=[0,0]};(0,e.inherits)(b,f.default),b.handles=function(e){return e.getType()===r.default.TILE},b.create=function(e,t){return new b(e,t)},b.prototype.disposeInternal=function(){this.mapRenderer.getContext().deleteBuffer(this.renderArrayBuffer_),f.default.prototype.disposeInternal.call(this)},b.prototype.createLoadedTileFinder=function(e,t,r){const i=this.mapRenderer;return function(n,o){return e.forEachLoadedTile(t,n,o,function(e){const t=i.isTileTextureLoaded(e);return t&&(r[n]||(r[n]={}),r[n][e.tileCoord.toString()]=e),t})}},b.prototype.handleWebGLContextLost=function(){f.default.prototype.handleWebGLContextLost.call(this),this.locations_=null},b.prototype.prepareFrame=function(e,t,r){const i=this.mapRenderer,o=r.getGL(),u=e.viewState,f=u.projection,h=this.getLayer(),c=h.getSource(),x=c.getTileGridForProjection(f),p=x.getZForResolution(u.resolution),R=x.getResolution(p),b=c.getTilePixelSize(p,e.pixelRatio,f),y=b[0]/(0,T.toSize)(x.getTileSize(p),this.tmpSize_)[0],E=R/y,L=c.getTilePixelRatio(y)*c.getGutter(f),C=u.center,A=e.extent,F=x.getTileRangeForExtentAndZ(A,p);let S;if(this.renderedTileRange_&&this.renderedTileRange_.equals(F)&&this.renderedRevision_==c.getRevision())S=this.renderedFramebufferExtent_;else{const u=F.getSize(),T=Math.max(u[0]*b[0],u[1]*b[1]),_=(0,d.roundUpToPowerOfTwo)(T),R=E*_,C=x.getOrigin(p),A=C[0]+F.minX*b[0]*E,j=C[1]+F.minY*b[1]*E;S=[A,j,A+R,j+R],this.bindFramebuffer(e,_),o.viewport(0,0,_,_),o.clearColor(0,0,0,0),o.clear(m.COLOR_BUFFER_BIT),o.disable(m.BLEND);const v=r.getProgram(this.fragmentShader_,this.vertexShader_);r.useProgram(v),this.locations_||(this.locations_=new g.default(o,v)),r.bindBuffer(m.ARRAY_BUFFER,this.renderArrayBuffer_),o.enableVertexAttribArray(this.locations_.a_position),o.vertexAttribPointer(this.locations_.a_position,2,m.FLOAT,!1,16,0),o.enableVertexAttribArray(this.locations_.a_texCoord),o.vertexAttribPointer(this.locations_.a_texCoord,2,m.FLOAT,!1,16,8),o.uniform1i(this.locations_.u_texture,0);const P={};P[p]={};const q=this.createLoadedTileFinder(c,f,P),w=h.getUseInterimTilesOnError();let O=!0;const B=(0,l.createEmpty)(),z=new n.default(0,0,0,0);let I,D,M,G,U,N,Y,X;for(N=F.minX;N<=F.maxX;++N)for(Y=F.minY;Y<=F.maxY;++Y)if(G=c.getTile(p,N,Y,y,f),void 0===t.extent||(X=x.getTileCoordExtent(G.tileCoord,B),(0,l.intersects)(X,t.extent))){if((D=(U=G.getState())==s.default.LOADED||U==s.default.EMPTY||U==s.default.ERROR&&!w)||(G=G.getInterimTile()),(U=G.getState())==s.default.LOADED){if(i.isTileTextureLoaded(G)){P[p][G.tileCoord.toString()]=G;continue}}else if(U==s.default.EMPTY||U==s.default.ERROR&&!w)continue;O=!1,(M=x.forEachTileCoordParentTileRange(G.tileCoord,q,null,z,B))||(I=x.getTileCoordChildTileRange(G.tileCoord,z,B))&&q(p+1,I)}const K=Object.keys(P).map(Number);K.sort(a.numberSafeCompareFunction);const Q=new Float32Array(4);for(let e=0,t=K.length;e<t;++e){const t=P[K[e]];for(const e in t)G=t[e],X=x.getTileCoordExtent(G.tileCoord,B),Q[0]=2*(X[2]-X[0])/R,Q[1]=2*(X[3]-X[1])/R,Q[2]=2*(X[0]-S[0])/R-1,Q[3]=2*(X[1]-S[1])/R-1,o.uniform4fv(this.locations_.u_tileOffset,Q),i.bindTileTexture(G,b,L*y,m.LINEAR,m.LINEAR),o.drawArrays(m.TRIANGLE_STRIP,0,4)}O?(this.renderedTileRange_=F,this.renderedFramebufferExtent_=S,this.renderedRevision_=c.getRevision()):(this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,e.animate=!0)}this.updateUsedTiles(e.usedTiles,c,p,F);const j=i.getTileTextureQueue();this.manageTilePyramid(e,c,x,y,f,A,p,h.getPreload(),function(e){e.getState()!=s.default.LOADED||i.isTileTextureLoaded(e)||j.isKeyQueued(e.getKey())||j.enqueue([e,x.getTileCoordCenter(e.tileCoord),x.getResolution(e.tileCoord[0]),b,L*y])},this),this.scheduleExpireCache(e,c);const v=this.texCoordMatrix;return(0,_.reset)(v),(0,_.translate)(v,(Math.round(C[0]/R)*R-S[0])/(S[2]-S[0]),(Math.round(C[1]/R)*R-S[1])/(S[3]-S[1])),0!==u.rotation&&(0,_.rotate)(v,u.rotation),(0,_.scale)(v,e.size[0]*u.resolution/(S[2]-S[0]),e.size[1]*u.resolution/(S[3]-S[1])),(0,_.translate)(v,-.5,-.5),!0},b.prototype.forEachLayerAtPixel=function(e,t,r,i){if(!this.framebuffer)return;const n=[e[0]/t.size[0],(t.size[1]-e[1])/t.size[1]],o=(0,_.apply)(this.texCoordMatrix,n.slice()),s=[o[0]*this.framebufferDimension,o[1]*this.framebufferDimension],a=this.mapRenderer.getContext().getGL();a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer);const l=new Uint8Array(4);return a.readPixels(s[0],s[1],1,1,a.RGBA,a.UNSIGNED_BYTE,l),l[3]>0?r.call(i,this.getLayer(),l):void 0},exports.default=b;
},{"../../util.js":43,"../../LayerType.js":73,"../../TileRange.js":38,"../../TileState.js":92,"../../array.js":130,"../../extent.js":90,"../../math.js":87,"../webgl/Layer.js":234,"../webgl/tilelayershader.js":235,"../webgl/tilelayershader/Locations.js":236,"../../size.js":104,"../../transform.js":105,"../../webgl.js":153,"../../webgl/Buffer.js":233}],147:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../util.js"),t=require("../../LayerType.js"),r=h(t),i=require("../../ViewHint.js"),n=h(i),o=require("../../extent.js"),s=require("../../render/webgl/ReplayGroup.js"),a=h(s),u=require("../vector.js"),l=require("../webgl/Layer.js"),d=h(l),p=require("../../transform.js");function h(e){return e&&e.__esModule?e:{default:e}}const c=function(e,t){d.default.call(this,e,t),this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=(0,o.createEmpty)(),this.renderedRenderOrder_=null,this.replayGroup_=null,this.layerState_=null};(0,e.inherits)(c,d.default),c.handles=function(e){return e.getType()===r.default.VECTOR},c.create=function(e,t){return new c(e,t)},c.prototype.composeFrame=function(e,t,r){this.layerState_=t;const i=e.viewState,n=this.replayGroup_,o=e.size,s=e.pixelRatio,a=this.mapRenderer.getGL();n&&!n.isEmpty()&&(a.enable(a.SCISSOR_TEST),a.scissor(0,0,o[0]*s,o[1]*s),n.replay(r,i.center,i.resolution,i.rotation,o,s,t.opacity,t.managed?e.skippedFeatureUids:{}),a.disable(a.SCISSOR_TEST))},c.prototype.disposeInternal=function(){const e=this.replayGroup_;if(e){const t=this.mapRenderer.getContext();e.getDeleteResourcesFunction(t)(),this.replayGroup_=null}d.default.prototype.disposeInternal.call(this)},c.prototype.forEachFeatureAtCoordinate=function(t,r,i,n,o){if(this.replayGroup_&&this.layerState_){const i=this.mapRenderer.getContext(),s=r.viewState,a=this.getLayer(),u=this.layerState_,l={};return this.replayGroup_.forEachFeatureAtCoordinate(t,i,s.center,s.resolution,s.rotation,r.size,r.pixelRatio,u.opacity,{},function(t){const r=(0,e.getUid)(t).toString();if(!(r in l))return l[r]=!0,n.call(o,t,a)})}},c.prototype.hasFeatureAtCoordinate=function(e,t){if(this.replayGroup_&&this.layerState_){const r=this.mapRenderer.getContext(),i=t.viewState,n=this.layerState_;return this.replayGroup_.hasFeatureAtCoordinate(e,r,i.center,i.resolution,i.rotation,t.size,t.pixelRatio,n.opacity,t.skippedFeatureUids)}return!1},c.prototype.forEachLayerAtPixel=function(e,t,r,i){const n=(0,p.apply)(t.pixelToCoordinateTransform,e.slice());return this.hasFeatureAtCoordinate(n,t)?r.call(i,this.getLayer(),null):void 0},c.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},c.prototype.prepareFrame=function(e,t,r){const i=this.getLayer(),s=i.getSource(),l=e.viewHints[n.default.ANIMATING],d=e.viewHints[n.default.INTERACTING],p=i.getUpdateWhileAnimating(),h=i.getUpdateWhileInteracting();if(!this.dirty_&&!p&&l||!h&&d)return!0;const c=e.extent,y=e.viewState,f=y.projection,_=y.resolution,g=e.pixelRatio,R=i.getRevision(),S=i.getRenderBuffer();let F=i.getRenderOrder();void 0===F&&(F=u.defaultOrder);const x=(0,o.buffer)(c,S*_);if(!this.dirty_&&this.renderedResolution_==_&&this.renderedRevision_==R&&this.renderedRenderOrder_==F&&(0,o.containsExtent)(this.renderedExtent_,x))return!0;this.replayGroup_&&e.postRenderFunctions.push(this.replayGroup_.getDeleteResourcesFunction(r)),this.dirty_=!1;const E=new a.default((0,u.getTolerance)(_,g),x,i.getRenderBuffer());s.loadFeatures(x,_,f);const m=function(e){let t;const r=e.getStyleFunction()||i.getStyleFunction();if(r&&(t=r(e,_)),t){const r=this.renderFeature(e,_,g,t,E);this.dirty_=this.dirty_||r}};if(F){const e=[];s.forEachFeatureInExtent(x,function(t){e.push(t)},this),e.sort(F),e.forEach(m.bind(this))}else s.forEachFeatureInExtent(x,m,this);return E.finish(r),this.renderedResolution_=_,this.renderedRevision_=R,this.renderedRenderOrder_=F,this.renderedExtent_=x,this.replayGroup_=E,!0},c.prototype.renderFeature=function(e,t,r,i,n){if(!i)return!1;let o=!1;if(Array.isArray(i))for(let s=i.length-1,a=0;s>=a;--s)o=(0,u.renderFeature)(n,e,i[s],(0,u.getSquaredTolerance)(t,r),this.handleStyleImageChange_,this)||o;else o=(0,u.renderFeature)(n,e,i,(0,u.getSquaredTolerance)(t,r),this.handleStyleImageChange_,this)||o;return o},exports.default=c;
},{"../../util.js":43,"../../LayerType.js":73,"../../ViewHint.js":102,"../../extent.js":90,"../../render/webgl/ReplayGroup.js":237,"../vector.js":226,"../webgl/Layer.js":234,"../../transform.js":105}],42:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./util.js"),r=require("./PluggableMap.js"),t=g(r),s=require("./control.js"),u=require("./interaction.js"),n=require("./obj.js"),i=require("./renderer/webgl/ImageLayer.js"),a=g(i),l=require("./renderer/webgl/Map.js"),o=g(l),d=require("./renderer/webgl/TileLayer.js"),c=g(d),f=require("./renderer/webgl/VectorLayer.js"),j=g(f);function g(e){return e&&e.__esModule?e:{default:e}}const q=function(e){(e=(0,n.assign)({},e)).controls||(e.controls=(0,s.defaults)()),e.interactions||(e.interactions=(0,u.defaults)()),t.default.call(this,e)};(0,e.inherits)(q,t.default),q.prototype.createRenderer=function(){const e=new o.default(this);return e.registerLayerRenderers([a.default,c.default,j.default]),e},exports.default=q;
},{"./util.js":43,"./PluggableMap.js":34,"./control.js":109,"./interaction.js":94,"./obj.js":74,"./renderer/webgl/ImageLayer.js":144,"./renderer/webgl/Map.js":146,"./renderer/webgl/TileLayer.js":145,"./renderer/webgl/VectorLayer.js":147}],7:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./AssertionError.js");Object.defineProperty(exports,"AssertionError",{enumerable:!0,get:function(){return B(e).default}});var r=require("./Collection.js");Object.defineProperty(exports,"Collection",{enumerable:!0,get:function(){return B(r).default}});var t=require("./Disposable.js");Object.defineProperty(exports,"Disposable",{enumerable:!0,get:function(){return B(t).default}});var n=require("./Feature.js");Object.defineProperty(exports,"Feature",{enumerable:!0,get:function(){return B(n).default}});var u=require("./Geolocation.js");Object.defineProperty(exports,"Geolocation",{enumerable:!0,get:function(){return B(u).default}});var a=require("./Graticule.js");Object.defineProperty(exports,"Graticule",{enumerable:!0,get:function(){return B(a).default}});var i=require("./Image.js");Object.defineProperty(exports,"Image",{enumerable:!0,get:function(){return B(i).default}});var o=require("./ImageBase.js");Object.defineProperty(exports,"ImageBase",{enumerable:!0,get:function(){return B(o).default}});var l=require("./ImageCanvas.js");Object.defineProperty(exports,"ImageCanvas",{enumerable:!0,get:function(){return B(l).default}});var f=require("./ImageTile.js");Object.defineProperty(exports,"ImageTile",{enumerable:!0,get:function(){return B(f).default}});var s=require("./Kinetic.js");Object.defineProperty(exports,"Kinetic",{enumerable:!0,get:function(){return B(s).default}});var c=require("./Map.js");Object.defineProperty(exports,"Map",{enumerable:!0,get:function(){return B(c).default}});var p=require("./MapBrowserEvent.js");Object.defineProperty(exports,"MapBrowserEvent",{enumerable:!0,get:function(){return B(p).default}});var b=require("./MapBrowserEventHandler.js");Object.defineProperty(exports,"MapBrowserEventHandler",{enumerable:!0,get:function(){return B(b).default}});var d=require("./MapBrowserPointerEvent.js");Object.defineProperty(exports,"MapBrowserPointerEvent",{enumerable:!0,get:function(){return B(d).default}});var j=require("./MapEvent.js");Object.defineProperty(exports,"MapEvent",{enumerable:!0,get:function(){return B(j).default}});var g=require("./Object.js");Object.defineProperty(exports,"Object",{enumerable:!0,get:function(){return B(g).default}});var v=require("./Observable.js");Object.defineProperty(exports,"Observable",{enumerable:!0,get:function(){return B(v).default}});var m=require("./Overlay.js");Object.defineProperty(exports,"Overlay",{enumerable:!0,get:function(){return B(m).default}});var O=require("./PluggableMap.js");Object.defineProperty(exports,"PluggableMap",{enumerable:!0,get:function(){return B(O).default}});var P=require("./Tile.js");Object.defineProperty(exports,"Tile",{enumerable:!0,get:function(){return B(P).default}});var y=require("./TileCache.js");Object.defineProperty(exports,"TileCache",{enumerable:!0,get:function(){return B(y).default}});var x=require("./TileQueue.js");Object.defineProperty(exports,"TileQueue",{enumerable:!0,get:function(){return B(x).default}});var q=require("./TileRange.js");Object.defineProperty(exports,"TileRange",{enumerable:!0,get:function(){return B(q).default}});var M=require("./VectorImageTile.js");Object.defineProperty(exports,"VectorImageTile",{enumerable:!0,get:function(){return B(M).default}});var T=require("./VectorTile.js");Object.defineProperty(exports,"VectorTile",{enumerable:!0,get:function(){return B(T).default}});var E=require("./View.js");Object.defineProperty(exports,"View",{enumerable:!0,get:function(){return B(E).default}});var I=require("./WebGLMap.js");Object.defineProperty(exports,"WebGLMap",{enumerable:!0,get:function(){return B(I).default}});var w=require("./util.js");function B(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"getUid",{enumerable:!0,get:function(){return w.getUid}}),Object.defineProperty(exports,"inherits",{enumerable:!0,get:function(){return w.inherits}}),Object.defineProperty(exports,"VERSION",{enumerable:!0,get:function(){return w.VERSION}});
},{"./AssertionError.js":15,"./Collection.js":16,"./Disposable.js":17,"./Feature.js":18,"./Geolocation.js":19,"./Graticule.js":20,"./Image.js":21,"./ImageBase.js":22,"./ImageCanvas.js":23,"./ImageTile.js":24,"./Kinetic.js":25,"./Map.js":26,"./MapBrowserEvent.js":27,"./MapBrowserEventHandler.js":28,"./MapBrowserPointerEvent.js":29,"./MapEvent.js":30,"./Object.js":31,"./Observable.js":32,"./Overlay.js":33,"./PluggableMap.js":34,"./Tile.js":35,"./TileCache.js":36,"./TileQueue.js":37,"./TileRange.js":38,"./VectorImageTile.js":39,"./VectorTile.js":40,"./View.js":41,"./WebGLMap.js":42,"./util.js":43}],76:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};
},{}],8:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util.js"),t=require("../LayerType.js"),r=u(t),s=require("../layer/Layer.js"),i=u(s),o=require("../layer/TileProperty.js"),l=u(o),n=require("../obj.js");function u(e){return e&&e.__esModule?e:{default:e}}const a=function(e){const t=e||{},s=(0,n.assign)({},t);delete s.preload,delete s.useInterimTilesOnError,i.default.call(this,s),this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError),this.type=r.default.TILE};(0,e.inherits)(a,i.default),a.prototype.getPreload=function(){return this.get(l.default.PRELOAD)},a.prototype.getSource,a.prototype.setPreload=function(e){this.set(l.default.PRELOAD,e)},a.prototype.getUseInterimTilesOnError=function(){return this.get(l.default.USE_INTERIM_TILES_ON_ERROR)},a.prototype.setUseInterimTilesOnError=function(e){this.set(l.default.USE_INTERIM_TILES_ON_ERROR,e)},exports.default=a;
},{"../util.js":43,"../LayerType.js":73,"../layer/Layer.js":75,"../layer/TileProperty.js":76,"../obj.js":74}],271:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.calculateSourceResolution=r,exports.render=a;var t=require("./dom.js"),e=require("./extent.js"),n=require("./math.js"),o=require("./proj.js");function r(t,n,r,s){const a=(0,o.transform)(r,n,t);let i=(0,o.getPointResolution)(n,s,r);const c=n.getMetersPerUnit();void 0!==c&&(i*=c);const u=t.getMetersPerUnit();void 0!==u&&(i/=u);const g=t.getExtent();if(!g||(0,e.containsCoordinate)(g,a)){const e=(0,o.getPointResolution)(t,i,a)/i;isFinite(e)&&e>0&&(i/=e)}return i}function s(t,e,n,o){const r=n-t,s=o-e,a=Math.sqrt(r*r+s*s);return[Math.round(n+r/a),Math.round(o+s/a)]}function a(o,r,a,i,c,u,g,l,h,d,f){const v=(0,t.createCanvasContext2D)(Math.round(a*o),Math.round(a*r));if(0===h.length)return v.canvas;v.scale(a,a);const m=(0,e.createEmpty)();h.forEach(function(t,n,o){(0,e.extend)(m,t.extent)});const x=(0,e.getWidth)(m),M=(0,e.getHeight)(m),T=(0,t.createCanvasContext2D)(Math.round(a*x/i),Math.round(a*M/i)),p=a/i;h.forEach(function(t,n,o){const r=t.extent[0]-m[0],s=-(t.extent[3]-m[3]),a=(0,e.getWidth)(t.extent),i=(0,e.getHeight)(t.extent);T.drawImage(t.image,d,d,t.image.width-2*d,t.image.height-2*d,r*p,s*p,a*p,i*p)});const P=(0,e.getTopLeft)(g);return l.getTriangles().forEach(function(t,e,o){const r=t.source,c=t.target;let g=r[0][0],l=r[0][1],h=r[1][0],d=r[1][1],f=r[2][0],x=r[2][1];const M=(c[0][0]-P[0])/u,p=-(c[0][1]-P[1])/u,j=(c[1][0]-P[0])/u,E=-(c[1][1]-P[1])/u,q=(c[2][0]-P[0])/u,C=-(c[2][1]-P[1])/u,b=g,y=l;g=0,l=0;const k=[[h-=b,d-=y,0,0,j-M],[f-=b,x-=y,0,0,q-M],[0,0,h,d,E-p],[0,0,f,x,C-p]],w=(0,n.solveLinearSystem)(k);if(!w)return;v.save(),v.beginPath();const R=(M+j+q)/3,S=(p+E+C)/3,W=s(R,S,M,p),D=s(R,S,j,E),H=s(R,S,q,C);v.moveTo(D[0],D[1]),v.lineTo(W[0],W[1]),v.lineTo(H[0],H[1]),v.clip(),v.transform(w[0],w[2],w[1],w[3],M,p),v.translate(m[0]-b,m[3]-y),v.scale(i/a,-i/a),v.drawImage(T.canvas,0,0),v.restore()}),f&&(v.save(),v.strokeStyle="black",v.lineWidth=1,l.getTriangles().forEach(function(t,e,n){const o=t.target,r=(o[0][0]-P[0])/u,s=-(o[0][1]-P[1])/u,a=(o[1][0]-P[0])/u,i=-(o[1][1]-P[1])/u,c=(o[2][0]-P[0])/u,g=-(o[2][1]-P[1])/u;v.beginPath(),v.moveTo(a,i),v.lineTo(r,s),v.lineTo(c,g),v.closePath(),v.stroke()}),v.restore()),v.canvas}
},{"./dom.js":93,"./extent.js":90,"./math.js":87,"./proj.js":88}],272:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../extent.js"),r=require("../math.js"),e=require("../proj.js");const s=10,i=.25,o=function(r,s,i,o,n){this.sourceProj_=r,this.targetProj_=s;let h={};const a=(0,e.getTransform)(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const r=t[0]+"/"+t[1];return h[r]||(h[r]=a(t)),h[r]},this.maxSourceExtent_=o,this.errorThresholdSquared_=n*n,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!o&&!!this.sourceProj_.getExtent()&&(0,t.getWidth)(o)==(0,t.getWidth)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,t.getWidth)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,t.getWidth)(this.targetProj_.getExtent()):null;const u=(0,t.getTopLeft)(i),c=(0,t.getTopRight)(i),d=(0,t.getBottomRight)(i),_=(0,t.getBottomLeft)(i),l=this.transformInv_(u),f=this.transformInv_(c),g=this.transformInv_(d),W=this.transformInv_(_);if(this.addQuad_(u,c,d,_,l,f,g,W,10),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach(function(r,e,s){t=Math.min(t,r.source[0][0],r.source[1][0],r.source[2][0])}),this.triangles_.forEach(function(r){if(Math.max(r.source[0][0],r.source[1][0],r.source[2][0])-t>this.sourceWorldWidth_/2){const e=[[r.source[0][0],r.source[0][1]],[r.source[1][0],r.source[1][1]],[r.source[2][0],r.source[2][1]]];e[0][0]-t>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-t>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-t>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);const s=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-s<this.sourceWorldWidth_/2&&(r.source=e)}}.bind(this))}h={}};o.prototype.addTriangle_=function(t,r,e,s,i,o){this.triangles_.push({source:[s,i,o],target:[t,r,e]})},o.prototype.addQuad_=function(e,s,i,o,n,h,a,u,c){const d=(0,t.boundingExtent)([n,h,a,u]),_=this.sourceWorldWidth_?(0,t.getWidth)(d)/this.sourceWorldWidth_:null,l=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&_>.5&&_<1;let g=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const r=(0,t.boundingExtent)([e,s,i,o]);g|=(0,t.getWidth)(r)/this.targetWorldWidth_>.25}!f&&this.sourceProj_.isGlobal()&&_&&(g|=_>.25)}if(g||!this.maxSourceExtent_||(0,t.intersects)(d,this.maxSourceExtent_)){if(!(g||isFinite(n[0])&&isFinite(n[1])&&isFinite(h[0])&&isFinite(h[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(u[0])&&isFinite(u[1]))){if(!(c>0))return;g=!0}if(c>0){if(!g){const t=[(e[0]+i[0])/2,(e[1]+i[1])/2],s=this.transformInv_(t);let o;if(f){o=((0,r.modulo)(n[0],l)+(0,r.modulo)(a[0],l))/2-(0,r.modulo)(s[0],l)}else o=(n[0]+a[0])/2-s[0];const h=(n[1]+a[1])/2-s[1];g=o*o+h*h>this.errorThresholdSquared_}if(g){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const t=[(s[0]+i[0])/2,(s[1]+i[1])/2],r=this.transformInv_(t),d=[(o[0]+e[0])/2,(o[1]+e[1])/2],_=this.transformInv_(d);this.addQuad_(e,s,t,d,n,h,r,_,c-1),this.addQuad_(d,t,i,o,_,r,a,u,c-1)}else{const t=[(e[0]+s[0])/2,(e[1]+s[1])/2],r=this.transformInv_(t),d=[(i[0]+o[0])/2,(i[1]+o[1])/2],_=this.transformInv_(d);this.addQuad_(e,t,d,o,n,r,_,u,c-1),this.addQuad_(t,s,i,d,r,h,a,_,c-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(e,i,o,n,a,u),this.addTriangle_(e,s,i,n,h,a)}},o.prototype.calculateSourceExtent=function(){const r=(0,t.createEmpty)();return this.triangles_.forEach(function(e,s,i){const o=e.source;(0,t.extendCoordinate)(r,o[0]),(0,t.extendCoordinate)(r,o[1]),(0,t.extendCoordinate)(r,o[2])}),r},o.prototype.getTriangles=function(){return this.triangles_},exports.default=o;
},{"../extent.js":90,"../math.js":87,"../proj.js":88}],241:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./common.js"),e=require("../util.js"),i=require("../Tile.js"),s=f(i),r=require("../TileState.js"),o=f(r),n=require("../events.js"),u=require("../events/EventType.js"),l=f(u),a=require("../extent.js"),h=require("../math.js"),c=require("../reproj.js"),d=require("../reproj/Triangulation.js"),_=f(d);function f(t){return t&&t.__esModule?t:{default:t}}const g=function(e,i,r,n,u,l,d,f,g,p,T){s.default.call(this,u,o.default.IDLE),this.renderEdges_=void 0!==T&&T,this.pixelRatio_=d,this.gutter_=f,this.canvas_=null,this.sourceTileGrid_=i,this.targetTileGrid_=n,this.wrappedTileCoord_=l||u,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const E=n.getTileCoordExtent(this.wrappedTileCoord_),y=this.targetTileGrid_.getExtent();let R=this.sourceTileGrid_.getExtent();const x=y?(0,a.getIntersection)(E,y):E;if(0===(0,a.getArea)(x))return void(this.state=o.default.EMPTY);const j=e.getExtent();j&&(R=R?(0,a.getIntersection)(R,j):j);const L=n.getResolution(this.wrappedTileCoord_[0]),m=(0,a.getCenter)(x),D=(0,c.calculateSourceResolution)(e,r,m,L);if(!isFinite(D)||D<=0)return void(this.state=o.default.EMPTY);const G=void 0!==p?p:t.ERROR_THRESHOLD;if(this.triangulation_=new _.default(e,r,x,R,D*G),0===this.triangulation_.getTriangles().length)return void(this.state=o.default.EMPTY);this.sourceZ_=i.getZForResolution(D);let I=this.triangulation_.calculateSourceExtent();if(R&&(e.canWrapX()?(I[1]=(0,h.clamp)(I[1],R[1],R[3]),I[3]=(0,h.clamp)(I[3],R[1],R[3])):I=(0,a.getIntersection)(I,R)),(0,a.getArea)(I)){const t=i.getTileRangeForExtentAndZ(I,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let i=t.minY;i<=t.maxY;i++){const t=g(this.sourceZ_,e,i,d);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=o.default.EMPTY)}else this.state=o.default.EMPTY};(0,e.inherits)(g,s.default),g.prototype.disposeInternal=function(){this.state==o.default.LOADING&&this.unlistenSources_(),s.default.prototype.disposeInternal.call(this)},g.prototype.getImage=function(){return this.canvas_},g.prototype.reproject_=function(){const t=[];if(this.sourceTiles_.forEach(function(e,i,s){e&&e.getState()==o.default.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=o.default.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),s="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],n=this.targetTileGrid_.getResolution(e),u=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=(0,c.render)(s,r,this.pixelRatio_,u,this.sourceTileGrid_.getExtent(),n,l,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=o.default.LOADED}this.changed()},g.prototype.load=function(){if(this.state==o.default.IDLE){this.state=o.default.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,i,s){const r=e.getState();if(r==o.default.IDLE||r==o.default.LOADING){t++;const i=(0,n.listen)(e,l.default.CHANGE,function(s){const r=e.getState();r!=o.default.LOADED&&r!=o.default.ERROR&&r!=o.default.EMPTY||((0,n.unlistenByKey)(i),0===--t&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(i)}}.bind(this)),this.sourceTiles_.forEach(function(t,e,i){t.getState()==o.default.IDLE&&t.load()}),0===t&&setTimeout(this.reproject_.bind(this),0)}},g.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(n.unlistenByKey),this.sourcesListenerKeys_=null},exports.default=g;
},{"./common.js":222,"../util.js":43,"../Tile.js":35,"../TileState.js":92,"../events.js":84,"../events/EventType.js":110,"../extent.js":90,"../math.js":87,"../reproj.js":271,"../reproj/Triangulation.js":272}],273:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createFromTemplate=n,exports.createFromTemplates=o,exports.createFromTileUrlFunctions=c,exports.nullTileUrlFunction=u,exports.expandUrl=s;var e=require("./asserts.js"),t=require("./math.js"),r=require("./tilecoord.js");function n(t,r){const n=/\{z\}/g,o=/\{x\}/g,c=/\{y\}/g,u=/\{-y\}/g;return function(s,i,l){return s?t.replace(n,s[0].toString()).replace(o,s[1].toString()).replace(c,function(){return(-s[2]-1).toString()}).replace(u,function(){const t=s[0],n=r.getFullTileRange(t);return(0,e.assert)(n,55),(n.getHeight()+s[2]).toString()}):void 0}}function o(e,t){const r=e.length,o=new Array(r);for(let c=0;c<r;++c)o[c]=n(e[c],t);return c(o)}function c(e){return 1===e.length?e[0]:function(n,o,c){if(n){const u=(0,r.hash)(n),s=(0,t.modulo)(u,e.length);return e[s](n,o,c)}}}function u(e,t,r){}function s(e){const t=[];let r=/\{([a-z])-([a-z])\}/.exec(e);if(r){const n=r[1].charCodeAt(0),o=r[2].charCodeAt(0);let c;for(c=n;c<=o;++c)t.push(e.replace(r[0],String.fromCharCode(c)));return t}if(r=r=/\{(\d+)-(\d+)\}/.exec(e)){const n=parseInt(r[2],10);for(let o=parseInt(r[1],10);o<=n;o++)t.push(e.replace(r[0],o.toString()));return t}return t.push(e),t}
},{"./asserts.js":83,"./math.js":87,"./tilecoord.js":107}],215:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./common.js"),e=require("../asserts.js"),i=require("../TileRange.js"),o=u(i),n=require("../array.js"),r=require("../extent.js"),s=require("../math.js"),l=require("../size.js"),h=require("../tilecoord.js");function u(t){return t&&t.__esModule?t:{default:t}}const g=function(i){let s;if(this.minZoom=void 0!==i.minZoom?i.minZoom:0,this.resolutions_=i.resolutions,(0,e.assert)((0,n.isSorted)(this.resolutions_,function(t,e){return e-t},!0),17),!i.origins)for(let t=0,e=this.resolutions_.length-1;t<e;++t)if(s){if(this.resolutions_[t]/this.resolutions_[t+1]!==s){s=void 0;break}}else s=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=s,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==i.origin?i.origin:null,this.origins_=null,void 0!==i.origins&&(this.origins_=i.origins,(0,e.assert)(this.origins_.length==this.resolutions_.length,20));const l=i.extent;void 0===l||this.origin_||this.origins_||(this.origin_=(0,r.getTopLeft)(l)),(0,e.assert)(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==i.tileSizes&&(this.tileSizes_=i.tileSizes,(0,e.assert)(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==i.tileSize?i.tileSize:this.tileSizes_?null:t.DEFAULT_TILE_SIZE,(0,e.assert)(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==l?l:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==i.sizes?this.fullTileRanges_=i.sizes.map(function(t,e){return new o.default(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))},this):l&&this.calculateTileRanges_(l)},a=[0,0,0];g.prototype.forEachTileCoord=function(t,e,i){const o=this.getTileRangeForExtentAndZ(t,e);for(let t=o.minX,n=o.maxX;t<=n;++t)for(let n=o.minY,r=o.maxY;n<=r;++n)i([e,t,n])},g.prototype.forEachTileCoordParentTileRange=function(t,e,o,n,r){let s,l,h,u=null,g=t[0]-1;for(2===this.zoomFactor_?(l=t[1],h=t[2]):u=this.getTileCoordExtent(t,r);g>=this.minZoom;){if(2===this.zoomFactor_?(l=Math.floor(l/2),h=Math.floor(h/2),s=(0,i.createOrUpdate)(l,l,h,h,n)):s=this.getTileRangeForExtentAndZ(u,g,n),e.call(o,g,s))return!0;--g}return!1},g.prototype.getExtent=function(){return this.extent_},g.prototype.getMaxZoom=function(){return this.maxZoom},g.prototype.getMinZoom=function(){return this.minZoom},g.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},g.prototype.getResolution=function(t){return this.resolutions_[t]},g.prototype.getResolutions=function(){return this.resolutions_},g.prototype.getTileCoordChildTileRange=function(t,e,o){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const o=2*t[1],n=2*t[2];return(0,i.createOrUpdate)(o,o+1,n,n+1,e)}const n=this.getTileCoordExtent(t,o);return this.getTileRangeForExtentAndZ(n,t[0]+1,e)}return null},g.prototype.getTileRangeExtent=function(t,e,i){const o=this.getOrigin(t),n=this.getResolution(t),s=(0,l.toSize)(this.getTileSize(t),this.tmpSize_),h=o[0]+e.minX*s[0]*n,u=o[0]+(e.maxX+1)*s[0]*n,g=o[1]+e.minY*s[1]*n,a=o[1]+(e.maxY+1)*s[1]*n;return(0,r.createOrUpdate)(h,g,u,a,i)},g.prototype.getTileRangeForExtentAndZ=function(t,e,o){const n=a;this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n);const r=n[1],s=n[2];return this.getTileCoordForXYAndZ_(t[2],t[3],e,!0,n),(0,i.createOrUpdate)(r,n[1],s,n[2],o)},g.prototype.getTileCoordCenter=function(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),o=(0,l.toSize)(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*o[0]*i,e[1]+(t[2]+.5)*o[1]*i]},g.prototype.getTileCoordExtent=function(t,e){const i=this.getOrigin(t[0]),o=this.getResolution(t[0]),n=(0,l.toSize)(this.getTileSize(t[0]),this.tmpSize_),s=i[0]+t[1]*n[0]*o,h=i[1]+t[2]*n[1]*o,u=s+n[0]*o,g=h+n[1]*o;return(0,r.createOrUpdate)(s,h,u,g,e)},g.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)},g.prototype.getTileCoordForXYAndResolution_=function(t,e,i,o,n){const r=this.getZForResolution(i),s=i/this.getResolution(r),u=this.getOrigin(r),g=(0,l.toSize)(this.getTileSize(r),this.tmpSize_),a=o?.5:0,_=o?0:.5,c=Math.floor((t-u[0])/i+a),p=Math.floor((e-u[1])/i+_);let f=s*c/g[0],d=s*p/g[1];return o?(f=Math.ceil(f)-1,d=Math.ceil(d)-1):(f=Math.floor(f),d=Math.floor(d)),(0,h.createOrUpdate)(r,f,d,n)},g.prototype.getTileCoordForXYAndZ_=function(t,e,i,o,n){const r=this.getOrigin(i),s=this.getResolution(i),u=(0,l.toSize)(this.getTileSize(i),this.tmpSize_),g=o?.5:0,a=o?0:.5,_=Math.floor((t-r[0])/s+g),c=Math.floor((e-r[1])/s+a);let p=_/u[0],f=c/u[1];return o?(p=Math.ceil(p)-1,f=Math.ceil(f)-1):(p=Math.floor(p),f=Math.floor(f)),(0,h.createOrUpdate)(i,p,f,n)},g.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)},g.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},g.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},g.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},g.prototype.getZForResolution=function(t,e){const i=(0,n.linearFindNearest)(this.resolutions_,t,e||0);return(0,s.clamp)(i,this.minZoom,this.maxZoom)},g.prototype.calculateTileRanges_=function(t){const e=this.resolutions_.length,i=new Array(e);for(let o=this.minZoom;o<e;++o)i[o]=this.getTileRangeForExtentAndZ(t,o);this.fullTileRanges_=i},exports.default=g;
},{"./common.js":142,"../asserts.js":83,"../TileRange.js":38,"../array.js":130,"../extent.js":90,"../math.js":87,"../size.js":104,"../tilecoord.js":107}],148:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getForProjection=x,exports.wrapX=f,exports.createForExtent=g,exports.createXYZ=j,exports.createForProjection=p,exports.extentFromProjection=T;var e=require("./tilegrid/common.js"),t=require("./size.js"),r=require("./extent.js"),o=require("./extent/Corner.js"),n=a(o),i=require("./obj.js"),u=require("./proj.js"),s=require("./proj/Units.js"),d=a(s),c=require("./tilegrid/TileGrid.js"),l=a(c);function a(e){return e&&e.__esModule?e:{default:e}}function x(e){let t=e.getDefaultTileGrid();return t||(t=p(e),e.setDefaultTileGrid(t)),t}function f(e,t,o){const n=t[0],i=e.getTileCoordCenter(t),u=T(o);if((0,r.containsCoordinate)(u,i))return t;{const t=(0,r.getWidth)(u),o=Math.ceil((u[0]-i[0])/t);return i[0]+=t*o,e.getTileCoordForCoordAndZ(i,n)}}function g(e,t,o,i){const u=void 0!==i?i:n.default.TOP_LEFT,s=E(e,t,o);return new l.default({extent:e,origin:(0,r.getCorner)(e,u),resolutions:s,tileSize:o})}function j(e){const t={};return(0,i.assign)(t,void 0!==e?e:{}),void 0===t.extent&&(t.extent=(0,u.get)("EPSG:3857").getExtent()),t.resolutions=E(t.extent,t.maxZoom,t.tileSize),delete t.maxZoom,new l.default(t)}function E(o,n,i){const u=void 0!==n?n:e.DEFAULT_MAX_ZOOM,s=(0,r.getHeight)(o),d=(0,r.getWidth)(o),c=(0,t.toSize)(void 0!==i?i:e.DEFAULT_TILE_SIZE),l=Math.max(d/c[0],s/c[1]),a=u+1,x=new Array(a);for(let e=0;e<a;++e)x[e]=l/Math.pow(2,e);return x}function p(e,t,r,o){return g(T(e),t,r,o)}function T(e){let t=(e=(0,u.get)(e)).getExtent();if(!t){const o=180*u.METERS_PER_UNIT[d.default.DEGREES]/e.getMetersPerUnit();t=(0,r.createOrUpdate)(-o,-o,o,o)}return t}
},{"./tilegrid/common.js":142,"./size.js":104,"./extent.js":90,"./extent/Corner.js":191,"./obj.js":74,"./proj.js":88,"./proj/Units.js":143,"./tilegrid/TileGrid.js":215}],274:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TileSourceEvent=void 0;var t=require("../util.js"),e=require("../functions.js"),i=require("../TileCache.js"),o=f(i),r=require("../TileState.js"),n=f(r),s=require("../events/Event.js"),l=f(s),u=require("../proj.js"),c=require("../size.js"),a=require("../source/Source.js"),p=f(a),h=require("../tilecoord.js"),d=require("../tilegrid.js");function f(t){return t&&t.__esModule?t:{default:t}}const g=function(t){p.default.call(this,{attributions:t.attributions,extent:t.extent,projection:t.projection,state:t.state,wrapX:t.wrapX}),this.opaque_=void 0!==t.opaque&&t.opaque,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null,this.tileCache=new o.default(t.cacheSize),this.tmpSize=[0,0],this.key_="",this.tileOptions={transition:t.transition}};(0,t.inherits)(g,p.default),g.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},g.prototype.expireCache=function(t,e){const i=this.getTileCacheForProjection(t);i&&i.expireCache(e)},g.prototype.forEachLoadedTile=function(t,e,i,o){const r=this.getTileCacheForProjection(t);if(!r)return!1;let s,l,u,c=!0;for(let t=i.minX;t<=i.maxX;++t)for(let a=i.minY;a<=i.maxY;++a)l=(0,h.getKeyZXY)(e,t,a),u=!1,r.containsKey(l)&&(u=(s=r.get(l)).getState()===n.default.LOADED)&&(u=!1!==o(s)),u||(c=!1);return c},g.prototype.getGutter=function(t){return 0},g.prototype.getKey=function(){return this.key_},g.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},g.prototype.getOpaque=function(t){return this.opaque_},g.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},g.prototype.getTile=function(t,e,i,o,r){},g.prototype.getTileGrid=function(){return this.tileGrid},g.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:(0,d.getForProjection)(t)},g.prototype.getTileCacheForProjection=function(t){const e=this.getProjection();return e&&!(0,u.equivalent)(e,t)?null:this.tileCache},g.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},g.prototype.getTilePixelSize=function(t,e,i){const o=this.getTileGridForProjection(i),r=this.getTilePixelRatio(e),n=(0,c.toSize)(o.getTileSize(t),this.tmpSize);return 1==r?n:(0,c.scale)(n,r,this.tmpSize)},g.prototype.getTileCoordForTileUrlFunction=function(t,e){const i=void 0!==e?e:this.getProjection(),o=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=(0,d.wrapX)(o,t,i)),(0,h.withinExtentAndZ)(t,o)?t:null},g.prototype.refresh=function(){this.tileCache.clear(),this.changed()},g.prototype.useTile=e.UNDEFINED;const y=exports.TileSourceEvent=function(t,e){l.default.call(this,t),this.tile=e};(0,t.inherits)(y,l.default),exports.default=g;
},{"../util.js":43,"../functions.js":103,"../TileCache.js":36,"../TileState.js":92,"../events/Event.js":123,"../proj.js":88,"../size.js":104,"../source/Source.js":281,"../tilecoord.js":107,"../tilegrid.js":148}],275:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};
},{}],242:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util.js"),e=require("../TileState.js"),i=c(e),n=require("../tileurlfunction.js"),l=require("../source/Tile.js"),o=c(l),s=require("../source/TileEventType.js"),r=c(s),u=require("../tilecoord.js");function c(t){return t&&t.__esModule?t:{default:t}}const a=function(t){o.default.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,extent:t.extent,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition}),this.tileLoadFunction=t.tileLoadFunction,this.tileUrlFunction=this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):n.nullTileUrlFunction,this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),t.tileUrlFunction&&this.setTileUrlFunction(t.tileUrlFunction),this.tileLoadingKeys_={}};(0,t.inherits)(a,o.default),a.prototype.fixedTileUrlFunction,a.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},a.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},a.prototype.getUrls=function(){return this.urls},a.prototype.handleTileChange=function(e){const n=e.target,o=(0,t.getUid)(n),s=n.getState();let u;s==i.default.LOADING?(this.tileLoadingKeys_[o]=!0,u=r.default.TILELOADSTART):o in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[o],u=s==i.default.ERROR?r.default.TILELOADERROR:s==i.default.LOADED||s==i.default.ABORT?r.default.TILELOADEND:void 0),null!=u&&this.dispatchEvent(new l.TileSourceEvent(u,n))},a.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},a.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},a.prototype.setUrl=function(t){const e=this.urls=(0,n.expandUrl)(t);this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):(0,n.createFromTemplates)(e,this.tileGrid),t)},a.prototype.setUrls=function(t){this.urls=t;const e=t.join("\n");this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):(0,n.createFromTemplates)(t,this.tileGrid),e)},a.prototype.useTile=function(t,e,i){const n=(0,u.getKeyZXY)(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)},exports.default=a;
},{"../util.js":43,"../TileState.js":92,"../tileurlfunction.js":273,"../source/Tile.js":274,"../source/TileEventType.js":275,"../tilecoord.js":107}],152:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../reproj/common.js"),t=require("../util.js"),i=require("../ImageTile.js"),r=f(i),o=require("../TileCache.js"),n=f(o),s=require("../TileState.js"),c=f(s),l=require("../events.js"),h=require("../events/EventType.js"),a=f(h),u=require("../proj.js"),p=require("../reproj/Tile.js"),d=f(p),E=require("../source/UrlTile.js"),g=f(E),j=require("../tilecoord.js"),T=require("../tilegrid.js");function f(e){return e&&e.__esModule?e:{default:e}}const C=function(e){g.default.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,extent:e.extent,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:P,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition}),this.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,this.tileClass=void 0!==e.tileClass?e.tileClass:r.default,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1};function P(e,t){e.getImage().src=t}(0,t.inherits)(C,g.default),C.prototype.canExpireCache=function(){if(!e.ENABLE_RASTER_REPROJECTION)return g.default.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(const e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1},C.prototype.expireCache=function(t,i){if(!e.ENABLE_RASTER_REPROJECTION)return void g.default.prototype.expireCache.call(this,t,i);const r=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==r?i:{});for(const e in this.tileCacheForProjection){const t=this.tileCacheForProjection[e];t.expireCache(t==r?i:{})}},C.prototype.getGutter=function(t){return e.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&t&&!(0,u.equivalent)(this.getProjection(),t)?0:this.getGutterInternal()},C.prototype.getGutterInternal=function(){return 0},C.prototype.getOpaque=function(t){return!(e.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&t&&!(0,u.equivalent)(this.getProjection(),t))&&g.default.prototype.getOpaque.call(this,t)},C.prototype.getTileGridForProjection=function(i){if(!e.ENABLE_RASTER_REPROJECTION)return g.default.prototype.getTileGridForProjection.call(this,i);const r=this.getProjection();if(!this.tileGrid||r&&!(0,u.equivalent)(r,i)){const e=(0,t.getUid)(i).toString();return e in this.tileGridForProjection||(this.tileGridForProjection[e]=(0,T.getForProjection)(i)),this.tileGridForProjection[e]}return this.tileGrid},C.prototype.getTileCacheForProjection=function(i){if(!e.ENABLE_RASTER_REPROJECTION)return g.default.prototype.getTileCacheForProjection.call(this,i);const r=this.getProjection();if(!r||(0,u.equivalent)(r,i))return this.tileCache;{const e=(0,t.getUid)(i).toString();return e in this.tileCacheForProjection||(this.tileCacheForProjection[e]=new n.default(this.tileCache.highWaterMark)),this.tileCacheForProjection[e]}},C.prototype.createTile_=function(e,t,i,r,o,n){const s=[e,t,i],h=this.getTileCoordForTileUrlFunction(s,o),u=h?this.tileUrlFunction(h,r,o):void 0,p=new this.tileClass(s,void 0!==u?c.default.IDLE:c.default.EMPTY,void 0!==u?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return p.key=n,(0,l.listen)(p,a.default.CHANGE,this.handleTileChange,this),p},C.prototype.getTile=function(t,i,r,o,n){const s=this.getProjection();if(e.ENABLE_RASTER_REPROJECTION&&s&&n&&!(0,u.equivalent)(s,n)){const e=this.getTileCacheForProjection(n),c=[t,i,r];let l;const h=(0,j.getKey)(c);e.containsKey(h)&&(l=e.get(h));const a=this.getKey();if(l&&l.key==a)return l;{const t=this.getTileGridForProjection(s),i=this.getTileGridForProjection(n),r=this.getTileCoordForTileUrlFunction(c,n),u=new d.default(s,t,n,i,c,r,this.getTilePixelRatio(o),this.getGutterInternal(),function(e,t,i,r){return this.getTileInternal(e,t,i,r,s)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return u.key=a,l?(u.interimTile=l,u.refreshInterimChain(),e.replace(h,u)):e.set(h,u),u}}return this.getTileInternal(t,i,r,o,s||n)},C.prototype.getTileInternal=function(e,t,i,r,o){let n=null;const s=(0,j.getKeyZXY)(e,t,i),l=this.getKey();if(this.tileCache.containsKey(s)){if((n=this.tileCache.get(s)).key!=l){const h=n;n=this.createTile_(e,t,i,r,o,l),h.getState()==c.default.IDLE?n.interimTile=h.interimTile:n.interimTile=h,n.refreshInterimChain(),this.tileCache.replace(s,n)}}else n=this.createTile_(e,t,i,r,o,l),this.tileCache.set(s,n);return n},C.prototype.setRenderReprojectionEdges=function(t){if(e.ENABLE_RASTER_REPROJECTION&&this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},C.prototype.setTileGridForProjection=function(i,r){if(e.ENABLE_RASTER_REPROJECTION){const e=(0,u.get)(i);if(e){const i=(0,t.getUid)(e).toString();i in this.tileGridForProjection||(this.tileGridForProjection[i]=r)}}},exports.default=C;
},{"../reproj/common.js":222,"../util.js":43,"../ImageTile.js":24,"../TileCache.js":36,"../TileState.js":92,"../events.js":84,"../events/EventType.js":110,"../proj.js":88,"../reproj/Tile.js":241,"../source/UrlTile.js":242,"../tilecoord.js":107,"../tilegrid.js":148}],77:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util.js"),i=require("../source/TileImage.js"),t=o(i),r=require("../tilegrid.js");function o(e){return e&&e.__esModule?e:{default:e}}const n=function(e){const i=e||{},o=void 0!==i.projection?i.projection:"EPSG:3857",n=void 0!==i.tileGrid?i.tileGrid:(0,r.createXYZ)({extent:(0,r.extentFromProjection)(o),maxZoom:i.maxZoom,minZoom:i.minZoom,tileSize:i.tileSize});t.default.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,opaque:i.opaque,projection:o,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:i.tileLoadFunction,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:i.tileUrlFunction,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition})};(0,e.inherits)(n,t.default),exports.default=n;
},{"../util.js":43,"../source/TileImage.js":152,"../tilegrid.js":148}],9:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ATTRIBUTION=void 0;var o=require("../util.js"),e=require("../source/XYZ.js"),r=t(e);function t(o){return o&&o.__esModule?o:{default:o}}const i=exports.ATTRIBUTION='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.',s=function(o){const e=o||{};let t;t=void 0!==e.attributions?e.attributions:[i];const s=void 0!==e.crossOrigin?e.crossOrigin:"anonymous",a=void 0!==e.url?e.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";r.default.call(this,{attributions:t,cacheSize:e.cacheSize,crossOrigin:s,opaque:void 0===e.opaque||e.opaque,maxZoom:void 0!==e.maxZoom?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,url:a,wrapX:e.wrapX})};(0,o.inherits)(s,r.default),exports.default=s;
},{"../util.js":43,"../source/XYZ.js":77}],4:[function(require,module,exports) {
"use strict";require("ol/ol.css");var e=require("ol"),r=require("ol/layer/Tile"),u=a(r),l=require("ol/source/OSM"),o=a(l);function a(e){return e&&e.__esModule?e:{default:e}}var t=new e.Map({target:"map",layers:[new u.default({source:new o.default})],view:new e.View({center:[0,0],zoom:0})});
},{"ol/ol.css":6,"ol":7,"ol/layer/Tile":8,"ol/source/OSM":9}]},{},[4], null)
//# sourceMappingURL=MakingMaps.33ad8e59.map