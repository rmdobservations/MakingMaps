{"version":3,"sources":["node_modules/ol/util.js","node_modules/ol/AssertionError.js","node_modules/ol/CollectionEventType.js","node_modules/ol/ObjectEventType.js","node_modules/ol/obj.js","node_modules/ol/events.js","node_modules/ol/functions.js","node_modules/ol/Disposable.js","node_modules/ol/events/Event.js","node_modules/ol/events/EventTarget.js","node_modules/ol/events/EventType.js","node_modules/ol/Observable.js","node_modules/ol/Object.js","node_modules/ol/Collection.js","node_modules/ol/asserts.js","node_modules/ol/extent/Corner.js","node_modules/ol/extent/Relationship.js","node_modules/ol/extent.js","node_modules/ol/geom/flat/transform.js","node_modules/ol/math.js","node_modules/ol/geom/GeometryType.js","node_modules/ol/sphere.js","node_modules/ol/proj/Units.js","node_modules/ol/proj/Projection.js","node_modules/ol/proj/epsg3857.js","node_modules/ol/proj/epsg4326.js","node_modules/ol/proj/projections.js","node_modules/ol/proj/transforms.js","node_modules/ol/proj.js","node_modules/ol/transform.js","node_modules/ol/geom/Geometry.js","node_modules/ol/color.js","node_modules/ol/colorlike.js","node_modules/ol/dom.js","node_modules/ol/webgl.js","node_modules/ol/has.js","node_modules/ol/ImageState.js","node_modules/ol/css.js","node_modules/ol/structs/LRUCache.js","node_modules/ol/render/canvas.js","node_modules/ol/style/Image.js","node_modules/ol/style/RegularShape.js","node_modules/ol/style/Circle.js","node_modules/ol/style/Fill.js","node_modules/ol/style/Stroke.js","node_modules/ol/style/Style.js","node_modules/ol/Feature.js","node_modules/ol/GeolocationProperty.js","node_modules/ol/array.js","node_modules/ol/geom/GeometryLayout.js","node_modules/ol/geom/SimpleGeometry.js","node_modules/ol/geom/flat/area.js","node_modules/ol/geom/flat/closest.js","node_modules/ol/geom/flat/deflate.js","node_modules/ol/geom/flat/inflate.js","node_modules/ol/geom/flat/simplify.js","node_modules/ol/geom/LinearRing.js","node_modules/ol/geom/Point.js","node_modules/ol/geom/flat/contains.js","node_modules/ol/geom/flat/interiorpoint.js","node_modules/ol/geom/flat/segments.js","node_modules/ol/geom/flat/intersectsextent.js","node_modules/ol/geom/flat/reverse.js","node_modules/ol/geom/flat/orient.js","node_modules/ol/geom/Polygon.js","node_modules/ol/Geolocation.js","node_modules/ol/string.js","node_modules/ol/coordinate.js","node_modules/ol/geom/flat/interpolate.js","node_modules/ol/geom/flat/length.js","node_modules/ol/geom/LineString.js","node_modules/ol/geom/flat/geodesic.js","node_modules/ol/render/EventType.js","node_modules/ol/style/TextPlacement.js","node_modules/ol/style/Text.js","node_modules/ol/Graticule.js","node_modules/ol/ImageBase.js","node_modules/ol/Image.js","node_modules/ol/ImageCanvas.js","node_modules/ol/TileState.js","node_modules/ol/easing.js","node_modules/ol/Tile.js","node_modules/ol/ImageTile.js","node_modules/ol/Kinetic.js","node_modules/ol/MapEvent.js","node_modules/ol/MapBrowserEvent.js","node_modules/ol/MapBrowserEventType.js","node_modules/ol/MapBrowserPointerEvent.js","node_modules/ol/pointer/EventType.js","node_modules/ol/pointer/EventSource.js","node_modules/ol/pointer/MouseSource.js","node_modules/ol/pointer/MsSource.js","node_modules/ol/pointer/NativeSource.js","node_modules/ol/pointer/PointerEvent.js","node_modules/ol/pointer/TouchSource.js","node_modules/ol/pointer/PointerEventHandler.js","node_modules/ol/MapBrowserEventHandler.js","node_modules/ol/MapEventType.js","node_modules/ol/MapProperty.js","node_modules/ol/structs/PriorityQueue.js","node_modules/ol/TileQueue.js","node_modules/ol/tilegrid/common.js","node_modules/ol/centerconstraint.js","node_modules/ol/resolutionconstraint.js","node_modules/ol/rotationconstraint.js","node_modules/ol/ViewHint.js","node_modules/ol/ViewProperty.js","node_modules/ol/View.js","node_modules/ol/layer/Property.js","node_modules/ol/layer/Base.js","node_modules/ol/source/State.js","node_modules/ol/layer/Group.js","node_modules/ol/size.js","node_modules/ol/PluggableMap.js","node_modules/ol/control/Control.js","node_modules/ol/layer/Layer.js","node_modules/ol/control/Attribution.js","node_modules/ol/control/Rotate.js","node_modules/ol/control/Zoom.js","node_modules/ol/control/util.js","node_modules/ol/interaction/Property.js","node_modules/ol/interaction/Interaction.js","node_modules/ol/interaction/DoubleClickZoom.js","node_modules/ol/events/condition.js","node_modules/ol/interaction/Pointer.js","node_modules/ol/interaction/DragPan.js","node_modules/ol/interaction/DragRotate.js","node_modules/ol/render/Box.js","node_modules/ol/interaction/DragBox.js","node_modules/ol/interaction/DragZoom.js","node_modules/ol/events/KeyCode.js","node_modules/ol/interaction/KeyboardPan.js","node_modules/ol/interaction/KeyboardZoom.js","node_modules/ol/interaction/MouseWheelZoom.js","node_modules/ol/interaction/PinchRotate.js","node_modules/ol/interaction/PinchZoom.js","node_modules/ol/interaction/DragAndDrop.js","node_modules/ol/interaction/DragRotateAndZoom.js","node_modules/ol/geom/Circle.js","node_modules/ol/geom/MultiLineString.js","node_modules/ol/geom/MultiPoint.js","node_modules/ol/geom/flat/center.js","node_modules/ol/geom/MultiPolygon.js","node_modules/ol/LayerType.js","node_modules/ol/layer/VectorRenderType.js","node_modules/ol/layer/Vector.js","node_modules/ol/format/FormatType.js","node_modules/ol/featureloader.js","node_modules/ol/loadingstrategy.js","node_modules/ol/source/Source.js","node_modules/ol/source/VectorEventType.js","node_modules/quickselect/quickselect.js","node_modules/rbush/index.js","node_modules/ol/structs/RBush.js","node_modules/ol/source/Vector.js","node_modules/ol/interaction/Draw.js","node_modules/ol/interaction/Extent.js","node_modules/ol/interaction/Modify.js","node_modules/ol/interaction/Select.js","node_modules/ol/interaction/Snap.js","node_modules/ol/interaction/Translate.js","node_modules/ol/interaction.js","node_modules/ol/reproj/common.js","node_modules/ol/render/Event.js","node_modules/ol/render/VectorContext.js","node_modules/ol/render/canvas/Immediate.js","node_modules/ol/style/IconImageCache.js","node_modules/ol/renderer/Map.js","node_modules/ol/renderer/canvas/Map.js","node_modules/ol/renderer/Layer.js","node_modules/ol/renderer/canvas/Layer.js","node_modules/ol/renderer/canvas/IntermediateCanvas.js","node_modules/ol/renderer/canvas/ImageLayer.js","node_modules/ol/TileRange.js","node_modules/ol/renderer/canvas/TileLayer.js","node_modules/ol/render/ReplayGroup.js","node_modules/ol/render/ReplayType.js","node_modules/ol/geom/flat/textpath.js","node_modules/ol/render/canvas/Instruction.js","node_modules/ol/render/replay.js","node_modules/ol/render/canvas/Replay.js","node_modules/ol/render/canvas/ImageReplay.js","node_modules/ol/render/canvas/LineStringReplay.js","node_modules/ol/render/canvas/PolygonReplay.js","node_modules/ol/geom/flat/straightchunk.js","node_modules/ol/render/canvas/TextReplay.js","node_modules/ol/render/canvas/ReplayGroup.js","node_modules/ol/renderer/vector.js","node_modules/ol/renderer/canvas/VectorLayer.js","node_modules/ol/layer/VectorTileRenderType.js","node_modules/ol/renderer/canvas/VectorTileLayer.js","node_modules/ol/Map.js","node_modules/ol/OverlayPositioning.js","node_modules/ol/Overlay.js","node_modules/ol/tilecoord.js","node_modules/ol/TileCache.js","node_modules/ol/VectorImageTile.js","node_modules/ol/VectorTile.js","node_modules/ol/control/FullScreen.js","node_modules/ol/control/OverviewMap.js","node_modules/ol/control/ScaleLine.js","node_modules/ol/control/ZoomSlider.js","node_modules/ol/control/ZoomToExtent.js","node_modules/ol/control.js","node_modules/ol/webgl/Shader.js","node_modules/ol/webgl/Fragment.js","node_modules/ol/webgl/Vertex.js","node_modules/ol/render/webgl/circlereplay/defaultshader.js","node_modules/ol/render/webgl/circlereplay/defaultshader/Locations.js","node_modules/ol/vec/mat4.js","node_modules/ol/render/webgl/Replay.js","node_modules/ol/render/webgl.js","node_modules/ol/webgl/Buffer.js","node_modules/ol/render/webgl/CircleReplay.js","node_modules/ol/render/webgl/texturereplay/defaultshader.js","node_modules/ol/render/webgl/texturereplay/defaultshader/Locations.js","node_modules/ol/webgl/ContextEventType.js","node_modules/ol/webgl/Context.js","node_modules/ol/render/webgl/TextureReplay.js","node_modules/ol/render/webgl/ImageReplay.js","node_modules/ol/geom/flat/topology.js","node_modules/ol/render/webgl/linestringreplay/defaultshader.js","node_modules/ol/render/webgl/linestringreplay/defaultshader/Locations.js","node_modules/ol/render/webgl/LineStringReplay.js","node_modules/ol/render/webgl/polygonreplay/defaultshader.js","node_modules/ol/render/webgl/polygonreplay/defaultshader/Locations.js","node_modules/ol/structs/LinkedList.js","node_modules/ol/render/webgl/PolygonReplay.js","node_modules/ol/style/Atlas.js","node_modules/ol/style/AtlasManager.js","node_modules/ol/render/webgl/TextReplay.js","node_modules/ol/render/webgl/ReplayGroup.js","node_modules/ol/render/webgl/Immediate.js","node_modules/ol/renderer/webgl/defaultmapshader.js","node_modules/ol/renderer/webgl/defaultmapshader/Locations.js","node_modules/ol/renderer/webgl/Layer.js","node_modules/ol/renderer/webgl/ImageLayer.js","node_modules/ol/renderer/webgl/Map.js","node_modules/ol/renderer/webgl/tilelayershader.js","node_modules/ol/renderer/webgl/tilelayershader/Locations.js","node_modules/ol/renderer/webgl/TileLayer.js","node_modules/ol/renderer/webgl/VectorLayer.js","node_modules/ol/WebGLMap.js","node_modules/ol/index.js","node_modules/ol/layer/TileProperty.js","node_modules/ol/layer/Tile.js","node_modules/ol/reproj.js","node_modules/ol/reproj/Triangulation.js","node_modules/ol/reproj/Tile.js","node_modules/ol/tileurlfunction.js","node_modules/ol/tilegrid/TileGrid.js","node_modules/ol/tilegrid.js","node_modules/ol/source/Tile.js","node_modules/ol/source/TileEventType.js","node_modules/ol/source/UrlTile.js","node_modules/ol/source/TileImage.js","node_modules/ol/source/XYZ.js","node_modules/ol/source/OSM.js","index.js","node_modules/parcel-bundler/lib/builtins/bundle-url.js","node_modules/parcel-bundler/lib/builtins/css-loader.js"],"names":["inherits","getUid","childCtor","parentCtor","prototype","Object","create","constructor","uidCounter_","obj","ol_uid","VERSION","AssertionError","code","path","split","message","name","Error","ADD","REMOVE","PROPERTYCHANGE","clear","getValues","isEmpty","assign","target","var_sources","undefined","TypeError","output","i","ii","arguments","length","source","key","hasOwnProperty","object","property","values","push","bindListener","findListener","getListeners","listen","listenOnce","unlisten","unlistenByKey","unlistenAll","listenerObj","boundListener","evt","listener","bindTo","callOnce","call","listeners","opt_this","opt_setDeleteIndex","deleteIndex","type","listenerMap","ol_lm","getListenerMap","removeListeners","removeEventListener","keys","opt_once","addEventListener","indexOf","splice","TRUE","FALSE","UNDEFINED","Disposable","disposed_","dispose","disposeInternal","stopPropagation","preventDefault","Event","propagationStopped","EventTarget","pendingRemovals_","dispatching_","listeners_","dispatchEvent","event","propagate","pendingRemovals","hasListener","opt_type","index","CHANGE","CLEAR","CONTEXTMENU","CLICK","DBLCLICK","DRAGENTER","DRAGOVER","DROP","ERROR","KEYDOWN","KEYPRESS","LOAD","MOUSEDOWN","MOUSEMOVE","MOUSEOUT","MOUSEUP","MOUSEWHEEL","MSPOINTERDOWN","RESIZE","TOUCHSTART","TOUCHMOVE","TOUCHEND","WHEEL","unByKey","Observable","revision_","Array","isArray","changed","EventType","getRevision","on","len","once","un","getChangeEventType","ObjectEvent","oldValue","BaseObject","opt_values","values_","setProperties","changeEventTypeCache","get","value","getKeys","getProperties","notify","eventType","ObjectEventType","set","opt_silent","unset","Property","LENGTH","CollectionEvent","opt_element","element","Collection","opt_array","opt_options","options","unique_","unique","array_","assertUnique_","updateLength_","getLength","pop","extend","arr","forEach","f","array","getArray","item","insertAt","elem","CollectionEventType","removeAt","n","remove","prev","setAt","j","opt_except","assert","assertion","errorCode","BOTTOM_LEFT","BOTTOM_RIGHT","TOP_LEFT","TOP_RIGHT","UNKNOWN","INTERSECTING","ABOVE","RIGHT","BELOW","LEFT","boundingExtent","buffer","clone","closestSquaredDistanceXY","containsCoordinate","containsExtent","containsXY","coordinateRelationship","createEmpty","createOrUpdate","createOrUpdateEmpty","createOrUpdateFromCoordinate","createOrUpdateFromCoordinates","createOrUpdateFromFlatCoordinates","createOrUpdateFromRings","equals","extendCoordinate","extendCoordinates","extendFlatCoordinates","extendRings","extendXY","forEachCorner","getArea","getBottomLeft","getBottomRight","getCenter","getCorner","getEnlargedArea","getForViewAndSize","getHeight","getIntersectionArea","getIntersection","getMargin","getSize","getTopLeft","getTopRight","getWidth","intersects","returnOrUpdate","scaleFromCenter","intersectsSegment","applyTransform","coordinates","extent","_boundingExtentXYs","xs","ys","opt_extent","minX","Math","min","apply","minY","maxX","max","maxY","slice","x","y","dx","dy","coordinate","extent1","extent2","relationship","Relationship","Infinity","flatCoordinates","offset","end","stride","rings","callback","val","area","corner","Corner","center","resolution","rotation","size","cosRotation","cos","sinRotation","sin","xCos","xSin","yCos","ySin","x0","x1","x2","x3","y0","y1","y2","y3","intersection","deltaX","deltaY","start","startRel","endRel","startX","startY","endX","endY","slope","transformFn","transform2D","rotate","scale","translate","transform","opt_dest","dest","angle","anchor","anchorX","anchorY","k","sx","sy","clamp","roundUpToPowerOfTwo","squaredSegmentDistance","squaredDistance","solveLinearSystem","toDegrees","toRadians","modulo","lerp","cosh","exp","pow","ceil","log","LN2","t","mat","maxRow","maxEl","abs","r","absValue","tmp","coef","l","m","angleInRadians","PI","angleInDegrees","a","b","POINT","LINE_STRING","LINEAR_RING","POLYGON","MULTI_POINT","MULTI_LINE_STRING","MULTI_POLYGON","GEOMETRY_COLLECTION","CIRCLE","getDistance","DEFAULT_RADIUS","c1","c2","opt_radius","radius","lat1","lat2","deltaLatBy2","deltaLonBy2","atan2","sqrt","getLengthInternal","geometry","projection","getType","GeometryType","coords","jj","getCoordinates","geometries","getGeometries","getAreaInternal","distance","bearing","lon1","dByR","lat","asin","lon","Units","DEGREES","FEET","METERS","PIXELS","TILE_PIXELS","USFEET","METERS_PER_UNIT","Projection","code_","units_","units","extent_","worldExtent_","worldExtent","axisOrientation_","axisOrientation","global_","global","canWrapX_","getPointResolutionFunc_","getPointResolution","defaultTileGrid_","metersPerUnit_","metersPerUnit","canWrapX","getCode","getExtent","getUnits","getMetersPerUnit","getWorldExtent","getAxisOrientation","isGlobal","setGlobal","getDefaultTileGrid","setDefaultTileGrid","tileGrid","setExtent","setWorldExtent","setGetPointResolution","func","getPointResolutionFunc","fromEPSG4326","toEPSG4326","RADIUS","HALF_SIZE","EXTENT","WORLD_EXTENT","EPSG3857Projection","point","PROJECTIONS","input","opt_output","opt_dimension","dimension","halfSize","tan","atan","EPSG4326Projection","opt_axisOrientation","add","cache","transforms","destination","sourceCode","destinationCode","cloneTransform","identityTransform","addProjection","addProjections","addEquivalentProjections","addEquivalentTransforms","clearAllProjections","createProjection","createTransformFromCoordinateTransform","addCoordinateTransforms","fromLonLat","toLonLat","equivalent","getTransformFromProjections","getTransform","transformExtent","transformWithProjections","addCommon","projections","projectionLike","opt_units","pointResolution","getter","vertices","width","height","projections1","projections2","forwardTransform","inverseTransform","projection1","projection2","defaultCode","coordTransform","forward","inverse","sourceProj","destProj","opt_projection","lonLat","equalUnits","transformFunc","sourceProjection","destinationProjection","EPSG3857_PROJECTIONS","EPSG4326_PROJECTIONS","reset","multiply","setFromArray","compose","invert","determinant","tmp_","transform1","transform2","a1","b1","d1","e1","f1","a2","b2","d2","e2","f2","c","d","e","dx1","dy1","dx2","dy2","det","Geometry","extentRevision_","simplifiedGeometryCache","simplifiedGeometryMaxMinSquaredTolerance","simplifiedGeometryRevision","tmpTransform","closestPointXY","closestPoint","minSquaredDistance","getClosestPoint","opt_closestPoint","NaN","intersectsCoordinate","computeExtent","opt_sy","opt_anchor","simplify","tolerance","getSimplifiedGeometry","squaredTolerance","intersectsExtent","inCoordinates","outCoordinates","pixelExtent","projectedExtent","asString","asArray","normalize","toString","HEX_COLOR_RE_","NAMED_COLOR_RE_","color","fromNamed","el","document","createElement","style","body","appendChild","rgb","getComputedStyle","removeChild","fromString","MAX_CACHE_SIZE","cacheSize","s","fromStringInternal_","g","exec","hasAlpha","parseInt","substr","map","Number","asColorLike","isColorLike","CanvasPattern","CanvasGradient","createCanvasContext2D","outerWidth","outerHeight","replaceNode","removeNode","removeChildren","opt_width","opt_height","canvas","getContext","offsetWidth","marginLeft","marginRight","offsetHeight","marginTop","marginBottom","newNode","oldNode","parent","parentNode","replaceChild","node","lastChild","ONE","SRC_ALPHA","COLOR_ATTACHMENT0","COLOR_BUFFER_BIT","TRIANGLES","TRIANGLE_STRIP","ONE_MINUS_SRC_ALPHA","ARRAY_BUFFER","ELEMENT_ARRAY_BUFFER","STREAM_DRAW","STATIC_DRAW","DYNAMIC_DRAW","CULL_FACE","BLEND","STENCIL_TEST","DEPTH_TEST","SCISSOR_TEST","UNSIGNED_BYTE","UNSIGNED_SHORT","UNSIGNED_INT","FLOAT","RGBA","FRAGMENT_SHADER","VERTEX_SHADER","LINK_STATUS","LINEAR","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","TEXTURE_WRAP_T","TEXTURE_2D","TEXTURE0","CLAMP_TO_EDGE","COMPILE_STATUS","FRAMEBUFFER","CONTEXT_IDS","opt_attributes","context","DEBUG","MAX_TEXTURE_SIZE","EXTENSIONS","HAS","window","gl","failIfMajorPerformanceCaveat","getParameter","getSupportedExtensions","ua","navigator","userAgent","toLowerCase","FIREFOX","SAFARI","WEBKIT","MAC","DEVICE_PIXEL_RATIO","devicePixelRatio","CANVAS_LINE_DASH","has","setLineDash","GEOLOCATION","TOUCH","POINTER","MSPOINTER","msPointerEnabled","IDLE","LOADING","LOADED","CLASS_HIDDEN","CLASS_SELECTABLE","CLASS_UNSELECTABLE","CLASS_UNSUPPORTED","CLASS_CONTROL","CLASS_COLLAPSED","getFontFamilies","font","family","fontFamily","LRUCache","opt_highWaterMark","highWaterMark","count_","entries_","oldest_","newest_","canExpireCache","getCount","containsKey","entry","value_","key_","newer","older","peekLast","peekLastKey","peekFirstKey","replace","setSize","prune","measureTextWidth","rotateAtOffset","drawImage","defaultFont","defaultFillStyle","defaultLineCap","defaultLineDash","defaultLineDashOffset","defaultLineJoin","defaultMiterLimit","defaultStrokeStyle","defaultTextAlign","defaultTextBaseline","defaultPadding","defaultLineWidth","labelCache","checkedFonts","measureContext","textHeights","checkFont","retries","checked","referenceFonts","text","interval","referenceWidth","isAvailable","getMeasureContext","available","referenceFont","measureText","check","done","clearInterval","fontSpec","fontFamilies","setInterval","measureTextHeight","span","heights","textContent","margin","padding","position","left","offsetX","offsetY","resetTransform","opacity","image","originX","originY","w","h","alpha","globalAlpha","setTransform","ImageStyle","opacity_","rotateWithView_","rotateWithView","rotation_","scale_","snapToPixel_","snapToPixel","getOpacity","getRotateWithView","getRotation","getScale","getSnapToPixel","getAnchor","getImage","pixelRatio","getHitDetectionImage","getImageState","getImageSize","getHitDetectionImageSize","getOrigin","setOpacity","setRotateWithView","setRotation","setScale","setSnapToPixel","listenImageChange","thisArg","load","unlistenImageChange","RegularShape","checksums_","canvas_","hitDetectionCanvas_","fill_","fill","origin_","points_","points","radius_","radius1","radius2_","radius2","angle_","stroke_","stroke","anchor_","size_","imageSize_","hitDetectionImageSize_","atlasManager_","atlasManager","render_","getFill","getPoints","getRadius","getRadius2","getAngle","getStroke","ImageState","imageSize","lineCap","lineJoin","miterLimit","lineDash","lineDashOffset","strokeStyle","strokeWidth","getColor","getLineDash","getLineDashOffset","getLineJoin","getLineCap","getMiterLimit","renderOptions","draw_","createHitDetectionCanvas_","round","hasCustomHitDetectionImage","renderHitDetectionCallback","drawHitDetectionCanvas_","bind","id","getChecksum","info","hitImage","angle0","radiusC","beginPath","arc","lineTo","fillStyle","lineWidth","closePath","strokeChecksum","fillChecksum","recalculate","checksum","CircleStyle","setRadius","Fill","color_","checksum_","setColor","Stroke","lineCap_","lineDash_","lineDashOffset_","lineJoin_","miterLimit_","width_","setLineCap","setLineDashOffset","setLineJoin","setMiterLimit","setWidth","toFunction","createDefaultStyle","createEditingStyle","Style","geometry_","geometryFunction_","defaultGeometryFunction","setGeometry","image_","renderer_","renderer","text_","zIndex_","zIndex","getGeometry","getText","getZIndex","getRenderer","setRenderer","getGeometryFunction","setFill","setImage","setStroke","setText","feature","setZIndex","styleFunction","styles","defaultStyles","white","blue","concat","createStyleFunction","Feature","opt_geometryOrProperties","id_","geometryName_","style_","styleFunction_","geometryChangeKey_","handleGeometryChanged_","properties","setGeometryName","getGeometryName","getStyle","setStyle","getId","getStyleFunction","handleGeometryChange_","setId","ACCURACY","ACCURACY_GEOMETRY","ALTITUDE","ALTITUDE_ACCURACY","HEADING","POSITION","PROJECTION","SPEED","TRACKING","TRACKING_OPTIONS","binarySearch","numberSafeCompareFunction","includes","linearFindNearest","reverseSubArray","find","stableSort","findIndex","isSorted","haystack","needle","opt_comparator","mid","cmp","comparator","low","high","found","direction","begin","data","extension","arr1","arr2","len1","compareFnc","sort","every","idx","opt_func","opt_strict","compare","currentVal","res","XY","XYZ","XYM","XYZM","getStrideForLayout","transformGeom2D","SimpleGeometry","layout","GeometryLayout","getLayoutForStride","getFirstCoordinate","getFlatCoordinates","getLastCoordinate","getLayout","simplifiedGeometry","getSimplifiedGeometryInternal","simplifiedFlatCoordinates","getStride","setFlatCoordinatesInternal","setCoordinates","opt_layout","setLayout","nesting","simpleGeometry","linearRing","linearRings","linearRingss","twiceArea","ends","endss","maxSquaredDelta","arrayMaxSquaredDelta","multiArrayMaxSquaredDelta","assignClosestPoint","assignClosestArrayPoint","assignClosestMultiArrayPoint","assignClosest","offset1","offset2","squaredDelta","maxDelta","isRing","opt_tmpPoint","tmpPoint","deflateCoordinate","deflateCoordinates","deflateCoordinatesArray","deflateMultiCoordinatesArray","coordinatess","opt_ends","coordinatesss","opt_endss","inflateCoordinates","inflateCoordinatesArray","inflateMultiCoordinatesArray","opt_coordinates","opt_coordinatess","opt_coordinatesss","simplifyLineString","douglasPeucker","douglasPeuckerArray","douglasPeuckerMultiArray","radialDistance","snap","quantize","quantizeArray","quantizeMultiArray","highQuality","opt_simplifiedFlatCoordinates","simplifiedOffset","markers","stack","last","first","maxSquaredDistance","simplifiedEnds","simplifiedEndss","LinearRing","maxDelta_","maxDeltaRevision_","setFlatCoordinates","simplifiedLinearRing","Point","linearRingContainsExtent","linearRingContainsXY","linearRingsContainsXY","linearRingssContainsXY","outside","wn","getInteriorPointOfArray","getInteriorPointsOfMultiArray","flatCenters","flatCentersOffset","intersections","rr","pointX","maxSegmentLength","segmentLength","isNaN","interiorPoints","point1","point2","ret","intersectsLineString","intersectsLineStringArray","intersectsLinearRing","intersectsLinearRingArray","intersectsLinearRingMultiArray","coordinatesExtent","linearRingIsClockwise","linearRingIsOriented","linearRingsAreOriented","orientLinearRings","orientLinearRingsArray","edge","opt_right","right","isClockwise","reverse","circular","fromExtent","fromCircle","makeRegular","Polygon","ends_","flatInteriorPointRevision_","flatInteriorPoint_","orientedRevision_","orientedFlatCoordinates_","appendLinearRing","polygon","getOrientedFlatCoordinates","getEnds","getFlatInteriorPoint","flatCenter","getInteriorPoint","getLinearRingCount","getLinearRing","getLinearRings","simplifiedPolygon","opt_n","opt_sphereRadius","circle","opt_sides","opt_angle","sides","arrayLength","startAngle","Geolocation","position_","transform_","watchId_","GeolocationProperty","handleProjectionChanged_","handleTrackingChanged_","setProjection","trackingOptions","setTrackingOptions","setTracking","tracking","getProjection","getTracking","geolocation","watchPosition","positionChange_","positionError_","getTrackingOptions","clearWatch","accuracy","altitude","altitudeAccuracy","heading","longitude","latitude","projectedPosition","speed","error","getAccuracy","getAccuracyGeometry","getAltitude","getAltitudeAccuracy","getHeading","getPosition","getSpeed","padNumber","compareVersions","number","opt_precision","numberString","toFixed","decimal","join","v1","v2","s1","s2","n1","n2","closestOnCircle","closestOnSegment","createStringXY","degreesToStringHDMS","format","squaredDistanceToSegment","toStringHDMS","toStringXY","delta","segment","along","opt_fractionDigits","hemispheres","degrees","normalizedDegrees","dflPrecision","precision","deg","floor","sec","charAt","template","coordinate1","coordinate2","cosAngle","sinAngle","coord1","coord2","interpolatePoint","lineStringCoordinateAtM","lineStringsCoordinateAtM","fraction","pointY","cumulativeLengths","o","extrapolate","lo","hi","m0","m1","interpolate","lineStringLength","linearRingLength","perimeter","LineString","flatMidpoint_","flatMidpointRevision_","appendCoordinate","lineString","forEachSegment","getCoordinateAtM","opt_extrapolate","getCoordinateAt","getFlatMidpoint","simplifiedLineString","greatCircleArc","meridian","parallel","line","geoA","geoB","geoStack","fractionStack","fractions","maxIterations","geoM","fracA","fracB","fracM","lon2","geoProjection","cosLat1","sinLat1","cosLat2","sinLat2","cosDeltaLon","sinDeltaLon","frac","D","acos","cosD","sinD","theta","epsg4326Projection","POSTCOMPOSE","PRECOMPOSE","RENDER","LINE","DEFAULT_FILL_COLOR","Text","font_","textAlign_","textAlign","textBaseline_","textBaseline","maxAngle_","maxAngle","placement_","placement","TextPlacement","overflow_","overflow","offsetX_","offsetY_","backgroundFill_","backgroundFill","backgroundStroke_","backgroundStroke","padding_","getFont","getPlacement","getMaxAngle","getOverflow","getTextAlign","getTextBaseline","getOffsetX","getOffsetY","getBackgroundFill","getBackgroundStroke","getPadding","setOverflow","setFont","setMaxAngle","setOffsetX","setOffsetY","setPlacement","setTextAlign","setTextBaseline","setBackgroundFill","setBackgroundStroke","setPadding","DEFAULT_STROKE_STYLE","INTERVALS","Graticule","map_","postcomposeListenerKey_","projection_","maxLat_","maxLon_","minLat_","minLon_","maxLatP_","maxLonP_","minLatP_","minLonP_","targetSize_","targetSize","maxLines_","maxLines","meridians_","parallels_","strokeStyle_","fromLonLatTransform_","toLonLatTransform_","projectionCenterLonLat_","meridiansLabels_","parallelsLabels_","showLabels","lonLabelFormatter_","lonLabelFormatter","latLabelFormatter_","latLabelFormatter","lonLabelPosition_","lonLabelPosition","latLabelPosition_","latLabelPosition","lonLabelStyle_","lonLabelStyle","latLabelStyle_","latLabelStyle","setMap","addMeridian_","minLat","maxLat","getMeridian_","textPoint","getMeridianPoint_","geom","clampedBottom","clampedTop","addParallel_","minLon","maxLon","getParallel_","getParallelPoint_","clampedLeft","clampedRight","createGraticule_","getInterval_","centerLonLat","centerLon","centerLat","cnt","validExtent","p1","p2","dist","getMap","getMeridians","getParallels","handlePostCompose_","vectorContext","frameState","viewState","updateProjectionInfo","updateProjectionInfo_","setFillStrokeStyle","drawGeometry","labelData","setTextStyle","worldExtentP","render","RenderEventType","ImageBase","state","pixelRatio_","getPixelRatio","getResolution","getState","ImageWrapper","src","crossOrigin","imageLoadFunction","src_","Image","imageListenerKeys_","imageLoadFunction_","handleImageError_","unlistenImage_","handleImageLoad_","ImageCanvas","opt_loader","loader_","error_","getError","handleLoad_","err","EMPTY","ABORT","easeIn","easeOut","inAndOut","linear","upAndDown","Tile","tileCoord","interimTile","transition_","transition","transitionStarts_","getKey","getInterimTile","tile","TileState","refreshInterimChain","getTileCoord","setState","getAlpha","time","inTransition","endTransition","ImageTile","tileLoadFunction","crossOrigin_","tileLoadFunction_","getBlankImage","naturalWidth","naturalHeight","ctx","fillRect","Kinetic","decay","minVelocity","delay","decay_","minVelocity_","delay_","initialVelocity_","update","Date","now","lastIndex","firstIndex","duration","MapEvent","opt_frameState","MapBrowserEvent","browserEvent","opt_dragging","originalEvent","pixel","getEventPixel","getCoordinateFromPixel","dragging","SINGLECLICK","POINTERDRAG","POINTERMOVE","POINTERDOWN","POINTERUP","POINTEROVER","POINTEROUT","POINTERENTER","POINTERLEAVE","POINTERCANCEL","MapBrowserPointerEvent","pointerEvent","EventSource","dispatcher","mapping","mapping_","getEvents","getHandlerForEvent","MouseSource","mousedown","mousemove","mouseup","mouseover","mouseout","pointerMap","lastTouches","POINTER_ID","POINTER_TYPE","DEDUP_DIST","isEventSimulatedFromTouch_","inEvent","lts","clientX","clientY","prepareEvent","cloneEvent","pd","pointerId","isPrimary","pointerType","cancel","down","move","p","button","up","cleanupMouse","enterOver","leaveOut","MsSource","msPointerDown","msPointerMove","msPointerUp","msPointerOut","msPointerOver","msPointerCancel","msGotPointerCapture","msLostPointerCapture","POINTER_TYPES","prepareEvent_","cleanup","makeEvent","NativeSource","pointerDown","pointerMove","pointerUp","pointerOut","pointerOver","pointerCancel","gotPointerCapture","lostPointerCapture","fireNativeEvent","PointerEvent","opt_eventDict","eventDict","buttons","getButtons_","pressure","getPressure_","bubbles","cancelable","view","detail","screenX","screenY","ctrlKey","altKey","shiftKey","metaKey","relatedTarget","tiltX","tiltY","hwTimestamp","HAS_BUTTONS","which","ev","MouseEvent","TouchSource","mouseSource","touchstart","touchmove","touchend","touchcancel","firstTouchId_","clickCount_","resetId_","dedupTimeout_","CLICK_COUNT_TIMEOUT","isPrimaryTouch_","inTouch","identifier","setPrimaryTouch_","count","cancelResetClickCount_","removePrimaryPointer_","inPointer","resetClickCount_","setTimeout","resetClickCountHandler_","clearTimeout","touchToPointer_","webkitRadiusX","radiusX","webkitRadiusY","radiusY","webkitForce","force","processTouches_","inFunction","touches","changedTouches","pointer","findTouch_","touchList","searchId","touch","vacuumTouches_","out","cancelOut_","dedupSynthMouse_","overDown_","outTarget","over","enter","moveOverOut_","outEvent","upOut_","leave","cleanUpPointer_","lt","PointerEventHandler","element_","eventMap_","eventSourceList_","registerSources","CLONE_PROPS","registerSource","register_","newEvents","handler","eventSource","addEvents_","unregister_","removeEvents_","eventHandler_","events","eventName","eventCopy","fireEvent","PointerEventType","contains_","container","contained","contains","inType","wrapMouseEvent","MapBrowserEventHandler","moveTolerance","clickTimeoutId_","dragging_","dragListenerKeys_","moveTolerance_","down_","getViewport","activePointers_","trackedTouches_","pointerEventHandler_","documentPointerEventHandler_","pointerdownListenerKey_","handlePointerDown_","relayedListenerKey_","relayEvent_","emulateClick_","newEvent","MapBrowserEventType","updateActivePointers_","handlePointerUp_","isMouseActionButton_","handlePointerMove_","isMoving_","POSTRENDER","MOVESTART","MOVEEND","LAYERGROUP","SIZE","TARGET","VIEW","PriorityQueue","priorityFunction","keyFunction","priorityFunction_","keyFunction_","elements_","priorities_","queuedElements_","dequeue","elements","priorities","siftUp_","elementKey","enqueue","priority","siftDown_","getLeftChildIndex_","getRightChildIndex_","getParentIndex_","heapify_","isKeyQueued","isQueued","startIndex","lIndex","rIndex","smallerChildIndex","parentIndex","reprioritize","TileQueue","tilePriorityFunction","tileChangeCallback","tileChangeCallback_","tilesLoading_","tilesLoadingKeys_","added","handleTileChange","getTilesLoading","tileKey","loadMoreTiles","maxTotalLoading","maxNewLoads","newLoads","abortedTiles","DEFAULT_MAX_ZOOM","DEFAULT_TILE_SIZE","createExtent","none","createSnapToResolutions","createSnapToPower","resolutions","z","power","maxResolution","opt_maxLevel","oldLevel","newLevel","disable","createSnapToN","createSnapToZero","opt_tolerance","ANIMATING","INTERACTING","CENTER","RESOLUTION","ROTATION","createCenterConstraint","createResolutionConstraint","createRotationConstraint","isNoopAnimation","DEFAULT_MIN_ZOOM","View","hints_","animations_","updateAnimationKey_","updateAnimations_","applyOptions_","ViewProperty","resolutionConstraintInfo","maxResolution_","minResolution_","minResolution","zoomFactor_","zoomFactor","resolutions_","minZoom_","minZoom","centerConstraint","resolutionConstraint","constraint","rotationConstraint","constraints_","zoom","constrainResolution","options_","getUpdatedOptions_","newOptions","getZoom","animate","var_args","animationCount","isDef","setCenter","setZoom","series","animation","complete","easing","sourceCenter","targetCenter","sourceResolution","targetResolution","sourceRotation","targetRotation","setHint","ViewHint","getAnimating","getInteracting","cancelAnimations","cancelAnimationFrame","more","seriesComplete","elapsed","progress","calculateCenterZoom","calculateCenterRotate","filter","Boolean","requestAnimationFrame","currentCenter","currentResolution","getSizeFromViewport_","selector","querySelector","metrics","constrainCenter","opt_delta","opt_direction","constrainRotation","getConstraints","getHints","opt_hints","calculateExtent","opt_size","getMaxResolution","getMinResolution","getMaxZoom","getZoomForResolution","setMaxZoom","maxZoom","getMinZoom","setMinZoom","getResolutions","getResolutionForExtent","xResolution","yResolution","getResolutionForValueFunction","opt_power","getValueForResolutionFunction","nearest","getResolutionForZoom","fit","geometryOrExtent","minRotX","minRotY","maxRotX","maxRotY","rotX","rotY","constrainedResolution","centerRotX","centerRotY","centerX","centerY","setResolution","centerOn","hint","centerNone","defaultMaxZoom","defaultZoomFactor","defaultMaxResolution","defaultMinResolution","enableRotation","rotationNone","OPACITY","VISIBLE","Z_INDEX","MAX_RESOLUTION","MIN_RESOLUTION","SOURCE","BaseLayer","LayerProperty","visible","state_","layer","managed","getLayerState","sourceState","getSourceState","getVisible","getLayersArray","getLayerStatesArray","opt_states","setMaxResolution","setMinResolution","setVisible","zindex","READY","LAYERS","LayerGroup","baseOptions","layers","layersListenerKeys_","listenerKeys_","handleLayersChanged_","setLayers","handleLayerChange_","getLayers","handleLayersAdd_","handleLayersRemove_","layersArray","collectionEvent","states","pos","ownLayerState","layerState","SourceState","hasArea","toSize","num","ratio","PluggableMap","optionsInternal","createOptionsInternal","maxTilesLoading_","maxTilesLoading","loadTilesWhileAnimating_","loadTilesWhileAnimating","loadTilesWhileInteracting_","loadTilesWhileInteracting","animationDelayKey_","animationDelay_","renderFrame_","coordinateToPixelTransform_","pixelToCoordinateTransform_","frameIndex_","frameState_","previousExtent_","viewPropertyListenerKey_","viewChangeListenerKey_","layerGroupPropertyListenerKeys_","viewport_","className","msTouchAction","touchAction","overlayContainer_","overlayContainerStopEvent_","overlayEvents","mapBrowserEventHandler_","handleMapBrowserEvent","keyboardEventTarget_","keyboardEventTarget","keyHandlerKeys_","handleBrowserEvent","controls","interactions","overlays_","overlays","overlayIdIndex_","createRenderer","handleResize_","focus_","postRenderFunctions_","tileQueue_","getTilePriority","handleTileChange_","skippedFeatureUids_","MapProperty","handleLayerGroupChanged_","handleViewChanged_","handleSizeChanged_","handleTargetChanged_","control","interaction","addOverlayInternal_","overlay","addControl","getControls","addInteraction","getInteractions","addLayer","getLayerGroup","addOverlay","getOverlays","setTarget","forEachFeatureAtPixel","hitTolerance","layerFilter","forEachFeatureAtCoordinate","getFeaturesAtPixel","features","forEachLayerAtPixel","hasFeatureAtPixel","hasFeatureAtCoordinate","getEventCoordinate","viewportPosition","getBoundingClientRect","eventPosition","top","getTarget","getTargetElement","getElementById","pixelToCoordinateTransform","getOverlayById","getPixelFromCoordinate","coordinateToPixelTransform","getView","getOverlayContainer","getOverlayContainerStopEvent","tileSourceKey","tileCenter","tileResolution","wantedTiles","focus","mapBrowserEvent","interactionsArray","getActive","cont","handleEvent","handlePostRender","tileQueue","hints","viewHints","postRenderFunctions","targetElement","removeLayerRenderers","updateSize","handleViewPropertyChanged_","setAttribute","layerGroup","isRendered","renderSync","removeControl","removeInteraction","removeLayer","removeOverlay","previousFrameState","layerStatesArray","layerStates","pixelResolution","skippedFeatureUids","usedTiles","renderFrame","moveStart","MapEventType","idle","setLayerGroup","setView","skipFeature","featureUid","computedStyle","parseFloat","unskipFeature","Control","target_","listenerKeys","visibleAtResolution","Layer","mapPrecomposeKey_","mapRenderKey_","sourceChangeKey_","handleSourcePropertyChange_","setSource","getSource","handleSourceChange_","Attribution","ulElement_","collapsed_","collapsed","collapsible_","collapsible","tipLabel","collapseLabel","collapseLabel_","label","label_","activeLabel","title","handleClick_","cssClasses","renderedAttributions_","renderedVisible_","getSourceAttributions_","lookup","visibleAttributions","attributionGetter","getAttributions","attributions","mapEvent","updateElement_","display","innerHTML","handleToggle_","classList","toggle","getCollapsible","setCollapsible","setCollapsed","getCollapsed","Rotate","callResetNorth_","resetNorth","duration_","autoHide_","autoHide","resetNorth_","msTransform","webkitTransform","Zoom","zoomInLabel","zoomOutLabel","zoomInTipLabel","zoomOutTipLabel","inElement","createTextNode","outElement","zoomByDelta_","newResolution","defaults","zoomControl","zoomOptions","rotateControl","rotateOptions","attributionControl","attribution","attributionOptions","ACTIVE","pan","rotateWithoutConstraints","zoomByDelta","zoomWithoutConstraints","Interaction","setActive","InteractionProperty","active","opt_duration","currentRotation","DoubleClickZoom","delta_","stopEvent","altKeyOnly","altShiftKeysOnly","activeElement","always","click","mouseActionButton","never","singleClick","doubleClick","noModifierKeys","platformModifierKeyOnly","shiftKeyOnly","targetNotEditable","tagName","mouseOnly","primaryAction","centroid","handleDragEvent","handleUpEvent","handleDownEvent","handleMoveEvent","PointerInteraction","handleDownEvent_","handleDragEvent_","handleMoveEvent_","handleUpEvent_","handlingDownUpSequence","trackedPointers_","targetPointers","pointerEvents","isPointerDraggingEvent","updateTrackedPointers_","handledUp","handled","shouldStopEvent","DragPan","kinetic_","kinetic","lastCentroid","lastPointersCount_","condition_","condition","noKinetic_","centerpx","DragRotate","lastAngle_","RenderBox","startPixel_","endPixel_","startPixel","endPixel","px","setPixels","createOrUpdateGeometry","pixels","DragBoxEventType","BOXSTART","BOXDRAG","BOXEND","DragBoxEvent","DragBox","box_","minArea_","minArea","boxEndCondition_","boxEndCondition","defaultBoxEndCondition","onBoxEnd","DragZoom","out_","mapExtent","boxPixelExtent","factor","UP","DOWN","KeyboardPan","defaultCondition_","pixelDelta_","pixelDelta","keyEvent","keyCode","KeyCode","mapUnitsDelta","KeyboardZoom","charCode","charCodeAt","MAX_DELTA","Mode","TRACKPAD","MouseWheelZoom","timeout_","timeout","useAnchor_","useAnchor","constrainResolution_","lastAnchor_","startTime_","timeoutId_","mode_","trackpadEventGap_","trackpadTimeoutId_","trackpadDeltaPerZoom_","trackpadZoomBuffer_","wheelEvent","deltaMode","WheelEvent","DOM_DELTA_PIXEL","DOM_DELTA_LINE","wheelDeltaY","decrementInteractingHint_","rebound","timeLeft","handleWheelZoom_","setMouseAnchor","PinchRotate","rotating_","rotationDelta_","threshold_","threshold","rotationDelta","touch0","touch1","PinchZoom","lastDistance_","lastScaleDelta_","scaleDelta","DragAndDropEventType","ADD_FEATURES","DragAndDropEvent","file","opt_features","DragAndDrop","formatConstructors_","formatConstructors","dropListenKeys_","source_","handleDrop","files","dataTransfer","reader","FileReader","handleResult_","readAsText","handleStop","dropEffect","result","formatConstructor","tryReadFeatures_","featureProjection","addFeatures","registerListeners_","dropArea","unregisterListeners_","readFeatures","DragRotateAndZoom","lastMagnitude_","magnitude","angleDelta","Circle","setCenterAndRadius","getRadiusSquared_","circleExtent","MultiLineString","appendLineString","multiLineString","opt_interpolate","getLineString","getLineStrings","lineStrings","getFlatMidpoints","midpoints","midpoint","simplifiedMultiLineString","setLineStrings","MultiPoint","appendPoint","multiPoint","getPoint","MultiPolygon","endss_","flatInteriorPointsRevision_","flatInteriorPoints_","appendPolygon","multiPolygon","newEndss","getEndss","getFlatInteriorPoints","getInteriorPoints","simplifiedMultiPolygon","getPolygon","prevEnds","getPolygons","polygons","lastEnds","setPolygons","IMAGE","TILE","VECTOR_TILE","VECTOR","RenderType","RENDER_ORDER","VectorLayer","renderBuffer","updateWhileAnimating","updateWhileInteracting","declutter_","declutter","renderBuffer_","updateWhileAnimating_","updateWhileInteracting_","renderMode_","renderMode","VectorRenderType","LayerType","getDeclutter","setDeclutter","getRenderBuffer","getRenderOrder","getUpdateWhileAnimating","getUpdateWhileInteracting","setRenderOrder","renderOrder","getRenderMode","JSON","TEXT","XML","loadFeaturesXhr","xhr","url","success","failure","XMLHttpRequest","open","FormatType","responseType","onload","status","responseText","responseXML","DOMParser","parseFromString","response","readProjection","getLastExtent","onerror","send","dataProjection","all","bbox","getZForResolution","tileRange","getTileRangeForExtentAndZ","extents","getTileCoordExtent","Source","attributions_","adaptAttributions_","wrapX_","wrapX","attributionLike","getWrapX","refresh","setAttributions","ADDFEATURE","CHANGEFEATURE","REMOVEFEATURE","RBush","opt_maxEntries","rbush_","items_","insert","items","uid","getAll","getInExtent","search","forEach_","forEachInExtent","rbush","VectorSourceEvent","opt_feature","VectorSource","format_","overlaps_","overlaps","url_","loader","strategy_","strategy","allStrategy","useSpatialIndex","featuresRtree_","loadedExtentsRtree_","nullGeometryFeatures_","idIndex_","undefIdIndex_","featureChangeKeys_","featuresCollection_","collection","addFeaturesInternal","bindFeaturesCollection_","addFeature","addFeatureInternal","featureKey","addToIndex_","setupChangeEvents_","VectorEventType","handleFeatureChange_","valid","newFeatures","geometryFeatures","modifyingCollection","removeFeature","opt_fast","featureId","removeFeatureInternal","clearEvent","forEachFeature","forEachFeatureAtCoordinateDirect","forEachFeatureInExtent","forEachFeatureIntersectingExtent","getFeaturesCollection","getFeatures","getFeaturesAtCoordinate","getFeaturesInExtent","getClosestFeatureToCoordinate","opt_filter","closestFeature","previousMinSquaredDistance","minDistance","getFeatureById","getFormat","getOverlaps","getUrl","sid","removeFromIdIndex_","hasFeature","loadFeatures","loadedExtentsRtree","extentsToLoad","extentToLoad","alreadyLoaded","removeLoadedExtent","removed","setLoader","createRegularPolygon","createBox","DrawEventType","DRAWSTART","DRAWEND","DrawEvent","Draw","shouldHandle_","downPx_","downTimeout_","lastDragTime_","freehand_","features_","snapTolerance_","snapTolerance","type_","getMode","stopClick_","stopClick","minPoints_","minPoints","maxPoints_","maxPoints","finishCondition_","finishCondition","geometryFunction","opt_geometry","squaredLength","Constructor","mode","dragVertexDelay_","dragVertexDelay","finishCoordinate_","sketchFeature_","sketchPoint_","sketchCoords_","sketchLine_","sketchLineCoords_","squaredClickTolerance_","clickTolerance","overlay_","getDefaultStyleFunction","geometryName","freehandCondition_","freehand","freehandCondition","updateState_","pass","addToDrawing_","handlePointerEvent","startDrawing_","circleMode","finishDrawing","atFinish_","abortDrawing_","downPx","clickPx","modifyDrawing_","createOrUpdateSketchPoint_","at","potentiallyDone","potentiallyFinishCoordinates","finishCoordinate","finishPixel","updateSketchFeatures_","sketchPointGeom","sketchLineGeom","ring","removeLastPoint","sketchFeature","sketchFeatures","overlaySource","ExtentEventType","EXTENTCHANGED","ExtentInteractionEvent","ExtentInteraction","pointerHandler_","pixelTolerance_","pixelTolerance","snappedToVertex_","extentFeature_","vertexFeature_","extentOverlay_","boxStyle","getDefaultExtentStyleFunction","vertexOverlay_","pointerStyle","getDefaultPointerStyleFunction","vertex","snapToVertex_","getOpposingPoint","x_","y_","getPointHandler","getEdgeHandler","pixelCoordinate","createOrUpdatePointerFeature_","fixedPoint","fixedP1","fixedP2","getSegments","sortByDistance","segments","closestSegment","vertexPixel","pixel1","pixel2","squaredDist1","squaredDist2","createOrUpdateExtentFeature_","extentFeature","vertexFeature","ModifyEventType","MODIFYSTART","MODIFYEND","ModifyEvent","mapBrowserPointerEvent","Modify","defaultDeleteCondition_","deleteCondition_","deleteCondition","insertVertexCondition_","insertVertexCondition","vertexSegments_","lastPixel_","ignoreNextSingleClick_","modified_","rBush_","changingFeature_","dragSegments_","SEGMENT_WRITERS_","writePointGeometry_","writeLineStringGeometry_","writePolygonGeometry_","writeMultiPointGeometry_","writeMultiLineStringGeometry_","writeMultiPolygonGeometry_","writeCircleGeometry_","writeGeometryCollectionGeometry_","handleSourceAdd_","handleSourceRemove_","addFeature_","handleFeatureAdd_","handleFeatureRemove_","lastPointerEvent_","CIRCLE_CENTER_INDEX","CIRCLE_CIRCUMFERENCE_INDEX","handlePointerAtPixel_","willModifyFeatures_","removeFeature_","removeFeatureSegmentData_","rBush","nodesToRemove","segmentData","depth","lines","kk","centerSegmentData","circumferenceSegmentData","featureSegments","getGeometriesArray","createOrUpdateVertexFeature_","compareIndexes","insertVertices","vertexExtent","segmentDataMatches","componentSegments","segmentDataMatch","closestVertex","closestOnSegmentData","insertVertex_","dragSegment","setGeometryCoordinates_","removePoint","pointDistanceToSegmentDataSquared","box","nodes","vertexSegments","pointCoordinates","circleGeometry","distanceToCenterSquared","distanceToCircumference","rTree","updateSegmentIndices_","newSegmentData","newSegmentData2","removeVertex_","dragSegments","segmentsByFeature","deleted","component","newIndex","SelectEventType","SELECT","SelectEvent","selected","deselected","Select","addCondition_","addCondition","removeCondition_","removeCondition","toggleCondition_","toggleCondition","multi_","multi","filter_","hitTolerance_","featureOverlay","featureOverlay_","layerFilter_","featureLayerAssociation_","addFeatureLayerAssociation_","getHitTolerance","getLayer","removeFeatureLayerAssociation_","setHitTolerance","currentMap","selectedFeatures","Snap","vertex_","edge_","featuresListenerKeys_","featureChangeListenerKeys_","indexedFeaturesExtents_","pendingFeatures_","pixelCoordinate_","sortByDistance_","opt_listen","register","feature_uid","segmentWriter","forEachFeatureAdd_","forEachFeatureRemove_","getFeatures_","updateFeature_","opt_unlisten","unregister","snapTo","lowerLeft","upperRight","snappedToVertex","snapped","isCircle","featuresToUpdate","deltaA","deltaB","TranslateEventType","TRANSLATESTART","TRANSLATING","TRANSLATEEND","TranslateEvent","Translate","lastCoordinate_","lastFeature_","handleActiveChanged_","featuresAtPixel_","newCoordinate","oldMap","default","altShiftDragRotate","doubleClickZoom","zoomDelta","zoomDuration","dragPan","pinchRotate","pinchZoom","keyboard","mouseWheelZoom","shiftDragZoom","ERROR_THRESHOLD","ENABLE_RASTER_REPROJECTION","RenderEvent","opt_vectorContext","opt_context","opt_glContext","glContext","VectorContext","drawCustom","drawCircle","drawFeature","drawGeometryCollection","geometryCollectionGeometry","drawLineString","lineStringGeometry","drawMultiLineString","multiLineStringGeometry","drawMultiPoint","multiPointGeometry","drawMultiPolygon","multiPolygonGeometry","drawPoint","pointGeometry","drawPolygon","polygonGeometry","drawText","setImageStyle","imageStyle","opt_declutterGroup","textStyle","CanvasImmediateRenderer","viewRotation","context_","viewRotation_","contextFillState_","contextStrokeState_","contextTextState_","fillState_","strokeState_","imageAnchorX_","imageAnchorY_","imageHeight_","imageOpacity_","imageOriginX_","imageOriginY_","imageRotateWithView_","imageRotation_","imageScale_","imageSnapToPixel_","imageWidth_","textOffsetX_","textOffsetY_","textRotateWithView_","textRotation_","textScale_","textFillState_","textStrokeState_","textState_","pixelCoordinates_","tmpLocalTransform_","drawImages_","pixelCoordinates","localTransform","drawText_","setContextFillState_","setContextStrokeState_","setContextTextState_","strokeText","fillText","moveToLineTo_","close","moveTo","drawRings_","flatMidpoint","geometryExtent","flatMidpoints","flatInteriorPoint","flatInteriorPoints","fillState","contextFillState","strokeState","contextStrokeState","textState","contextTextState","fillStyleColor","strokeStyleColor","strokeStyleLineCap","strokeStyleLineDash","strokeStyleLineDashOffset","strokeStyleLineJoin","strokeStyleWidth","strokeStyleMiterLimit","imageAnchor","imageImage","imageOrigin","textFillStyle","textFillStyleColor","textStrokeStyle","textStrokeStyleColor","textStrokeStyleLineCap","textStrokeStyleLineDash","textStrokeStyleLineDashOffset","textStrokeStyleLineJoin","textStrokeStyleWidth","textStrokeStyleMiterLimit","textFont","textOffsetX","textOffsetY","textRotateWithView","textRotation","textScale","textText","textTextAlign","textTextBaseline","IconImageCache","cache_","cacheSize_","maxCacheSize_","colorString","expire","iconImage","maxCacheSize","shared","sortByZIndex","MapRenderer","layerRenderers_","layerRendererListeners_","layerRendererConstructors_","registerLayerRenderers","constructors","getLayerRendererConstructors","calculateMatrices2D","removeLayerRendererByKey_","expireIconCache","iconImageCache","thisArg2","viewResolution","translatedCoordinate","projectionExtent","worldWidth","worldsAway","numLayers","layerRenderer","getLayerRenderer","layerKey","candidate","handleLayerRendererChange_","getLayerRendererByKey","getLayerRenderers","removeUnusedLayerRenderers_","scheduleExpireIconCache","scheduleRemoveUnusedLayerRenderers","state1","state2","layerRendererConstructors","CanvasMapRenderer","insertBefore","childNodes","dispatchComposeEvent_","composeEvent","clearRect","save","prepareFrame","composeFrame","restore","forEachLayerAtCoordinate","ctor","LayerRenderer","layer_","createLoadedTileFinder","tiles","forEachLoadedTile","handleImageChange_","renderIfReadyAndVisible","loadImage","imageState","scheduleExpireCache","tileSource","postRenderFunction","expireCache","updateUsedTiles","zKey","manageTilePyramid","currentZ","preload","opt_tileCallback","getTile","getTileCoordCenter","useTile","CanvasLayerRenderer","renderedResolution","clip","topLeft","topRight","bottomRight","bottomLeft","opt_transform","postCompose","preCompose","dispatchRenderEvent","IntermediateCanvasRenderer","coordinateToCanvasPixelTransform","hitCanvasContext_","clipped","imageTransform","getImageTransform","dw","dh","imageData","getImageData","CanvasImageLayerRenderer","imageLayer","imageTransform_","skippedFeatures_","vectorRenderer_","mapRenderer","viewCenter","imageSource","vectorRenderer","renderedExtent","skippedFeatures","imageFrameState","newSkippedFeatures","replayGroupChanged","imageExtent","imageResolution","imagePixelRatio","TileRange","containsTileRange","CanvasTileLayerRenderer","tileLayer","oversampling_","renderedExtent_","renderedRevision","renderedTiles","newTiles_","tmpExtent","tmpTileRange_","zDirection","isDrawableTile_","tileState","useInterimTilesOnError","getUseInterimTilesOnError","getPreload","sourceRevision","getTileGridForProjection","oversampling","getTileRangeExtent","tilePixelRatio","getTilePixelRatio","tilesToDrawByZ","findLoadedTiles","animatingOrInteracting","tmpTileRange","childTileRange","getTileCoordChildTileRange","covered","forEachTileCoordParentTileRange","tilePixelSize","getTilePixelSize","zs","currentScale","currentTilePixelSize","tileExtent","tileGutter","tilesToDraw","getGutter","tileCoordKey","drawTileImage","gutter","getOpaque","alphaChanged","ReplayGroup","getReplay","replayType","DEFAULT","drawTextOnPath","measure","startM","numChars","segmentM","chunk","chunkLength","previousAngle","char","charLength","charM","segmentPos","unshift","Instruction","BEGIN_GEOMETRY","BEGIN_PATH","CLOSE_PATH","CUSTOM","DRAW_CHARS","DRAW_IMAGE","END_GEOMETRY","FILL","MOVE_TO_LINE_TO","SET_FILL_STYLE","SET_STROKE_STYLE","STROKE","fillInstruction","strokeInstruction","beginPathInstruction","closePathInstruction","ORDER","ReplayType","TEXT_ALIGN","CanvasReplay","maxExtent","declutterTree","maxLineWidth","alignFill_","beginGeometryInstruction1_","beginGeometryInstruction2_","bufferedMaxExtent_","instructions","coordinateCache_","renderedTransform_","hitDetectionInstructions","replayTextBackground_","p3","p4","setStrokeStyle_","replayImage_","declutterGroup","fillStroke","boxW","boxH","boxX","boxY","strokePadding","declutterArgs","applyPixelRatio","dashArray","dash","appendFlatCoordinates","closed","skipFirst","myEnd","getBufferedMaxExtent","lastCoord","nextCoord","skipped","lastRel","nextRel","drawCustomCoordinates_","replayEnds","replayEnd","beginGeometry","replayBegin","replayEndss","myEnds","CanvasInstruction","endGeometry","origin","repeatSize","instruction","renderDeclutter_","groupCount","collides","declutterData","replay_","skippedFeaturesHash","featureCallback","opt_hitExtent","skipFeatures","dd","prevX","prevY","roundX","roundY","pendingFill","pendingStroke","lastFillInstruction","lastStrokeInstruction","coordinateCache","batchSize","fn","baseline","fillKey","strokeKey","textKey","pathLength","textLength","textStates","parts","cc","chars","part","replay","replayHitDetection","opt_featureCallback","reverseHitDetectionInstructions","createFill","applyStroke","createStroke","updateFillStyle","currentFillStyle","updateStrokeStyle","currentStrokeStyle","currentLineCap","currentLineDash","currentLineDashOffset","currentLineJoin","currentLineWidth","currentMiterLimit","endGeometryInstruction","finish","CanvasImageReplay","declutterGroup_","hitDetectionImage_","anchorX_","anchorY_","height_","originX_","originY_","drawCoordinates_","myBegin","hitDetectionImage","CanvasLineStringReplay","drawFlatCoordinates_","moveToLineToInstruction","lastStroke","CanvasPolygonReplay","drawFlatCoordinatess_","numEnds","setFillStrokeStyles_","circleInstruction","matchingChunk","chunkStart","chunkEnd","chunkM","m12","m23","x12","y12","x23","y23","measureTextWidths","CanvasTextReplay","labels_","fillStates","strokeStates","textKey_","fillKey_","strokeKey_","widths_","widths","numLines","currentWidth","geometryType","flatOffset","flatEnd","oo","range","drawChars_","drawTextImage_","align","lineHeight","renderWidth","leftRight","getCircleArray","replayDeclutter","BATCH_CONSTRUCTORS","CanvasReplayGroup","opt_renderBuffer","declutterTree_","tolerance_","maxExtent_","resolution_","replaysByZIndex_","hitDetectionContext_","hitDetectionTransform_","circleArrayCache","fillCircleArrayRowToMiddle","arraySize","declutterReplays","zz","replayData","addDeclutter","group","flatClipCoords","getClipCoords","hasReplays","replays","candidates","replayKey","contextSize","hitExtent","mask","declutteredFeatures","zIndexKey","getReplays","opt_replayTypes","opt_declutterReplays","replayTypes","defaultOrder","getSquaredTolerance","getTolerance","renderFeature","SIMPLIFY_TOLERANCE","GEOMETRY_RENDERERS","renderPointGeometry","renderLineStringGeometry","renderPolygonGeometry","renderMultiPointGeometry","renderMultiLineStringGeometry","renderMultiPolygonGeometry","renderGeometryCollectionGeometry","renderCircleGeometry","feature1","feature2","replayGroup","circleReplay","textReplay","loading","renderFeatureInternal","renderGeometry","geometryRenderer","lineStringReplay","polygonReplay","imageReplay","CanvasVectorLayerRenderer","vectorLayer","dirty_","renderedRevision_","renderedResolution_","renderedRenderOrder_","replayGroup_","handleFontsChanged_","vectorSource","clipExtent","drawOffsetX","drawOffsetY","replayContext","transparentLayer","hasRenderListeners","drawWidth","drawHeight","drawSize","world","mainContextAlpha","handleStyleImageChange_","animating","interacting","frameStateExtent","vectorLayerRevision","vectorLayerRenderBuffer","vectorLayerRenderOrder","defaultRenderOrder","dirty","HYBRID","IMAGE_REPLAYS","VECTOR_REPLAYS","CanvasVectorTileLayerRenderer","renderedLayerRevision_","tmpTransform_","VectorTileRenderType","createReplayGroup_","renderTileImage_","layerRevision","revision","replayState","getReplayState","renderedRenderOrder","sourceTileGrid","getTileGrid","zIndexKeys","tt","tileKeys","sourceTile","sourceTileCoord","sourceTileExtent","sharedExtent","bufferedExtent","tileProjection","reproject","setReplayGroup","getReplayGroup","getReplayTransform_","renderResolution","clips","worldOffset","currentClip","renderedTileRevision","wrappedTileCoord","pixelScale","Map","BOTTOM_CENTER","CENTER_LEFT","CENTER_CENTER","CENTER_RIGHT","TOP_CENTER","ELEMENT","MAP","OFFSET","POSITIONING","Overlay","insertFirst","autoPan","autoPanAnimation","autoPanMargin","rendered","bottom_","left_","right_","top_","mapPostrenderListenerKey","handleElementChanged","handleMapChanged","handleOffsetChanged","handlePositionChanged","handlePositioningChanged","setElement","setOffset","setPositioning","positioning","OverlayPositioning","setPosition","getElement","getOffset","getPositioning","updatePixelPosition","panIntoView","mapRect","getRect","overlayRect","offsetLeft","offsetRight","offsetTop","offsetBottom","centerPx","newCenterPx","pageXOffset","pageYOffset","mapSize","updateRenderedPosition","bottom","getOptions","getKeyZXY","fromKey","hash","quadKey","withinExtentAndZ","opt_tileCoord","digits","String","fromCharCode","getFullTileRange","TileCache","pruneExceptNewestZ","defaultLoadFunction","VectorImageTile","urlTileCoord","tileUrlFunction","sourceTiles","tileClass","replayState_","sourceTiles_","sourceRevision_","loadListenerKeys_","sourceTileListenerKeys_","sourceZ","useLoadedOnly","loadCount","forEachTileCoord","sourceExtent","sourceTileKey","tileUrl","consumers","finishLoading_","leftToLoad","errorSourceTiles","loaded","empty","onLoad","onError","VectorTile","replayGroups_","DEFAULT_EXTENT","setFeatures","getChangeType","changeType","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen","requestFullscreen","FullScreen","cssClassName_","labelNode_","labelActive","labelActiveNode_","isFullScreen","isFullScreenSupported","keys_","handleFullScreen_","exitFullScreen","requestFullScreenWithKeys","requestFullScreen","handleFullScreenChange_","firstElementChild","mozFullScreenEnabled","msFullscreenEnabled","fullscreenEnabled","webkitIsFullScreen","mozFullScreen","msFullscreenElement","fullscreenElement","mozRequestFullScreenWithKeys","Element","ALLOW_KEYBOARD_INPUT","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","MAX_RATIO","MIN_RATIO","OverviewMap","ovmapDiv_","ovmap_","ovmap","boxSizing","boxOverlay_","scope","overlayBox","computeDesiredMousePosition","mousePosition","endMoving","oldView","unbindView_","handleMapPropertyChange_","bindView_","resetExtent_","newView","handleRotationChanged_","validateExtent_","updateBox_","ovmapSize","ovview","ovextent","topLeftPixel","bottomRightPixel","boxWidth","boxHeight","ovmapWidth","ovmapHeight","recenter_","steps","ovresolution","rotateBottomLeft","calculateCoordinateRotate_","coordinateRotate","getOverviewMap","UNITS_PROP","IMPERIAL","NAUTICAL","METRIC","US","LEADING_DIGITS","ScaleLine","innerElement_","viewState_","minWidth_","minWidth","renderedWidth_","renderedHTML_","handleUnitsChanged_","setUnits","pointResolutionUnits","ProjUnits","nominalCount","suffix","metersPerDegree","html","Direction","VERTICAL","HORIZONTAL","ZoomSlider","currentResolution_","direction_","heightLimit_","widthLimit_","previousX_","previousY_","thumbSize_","sliderInitialized_","thumbElement","containerElement","dragger_","handleDraggerStart_","handleDraggerDrag_","handleDraggerEnd_","handleContainerClick_","initSlider_","containerSize","thumb","thumbWidth","thumbHeight","setThumbPosition_","relativePosition","getRelativePosition_","getResolutionForPosition_","getPositionForResolution_","amount","ZoomToExtent","handleZoomToExtent","WebGLShader","isAnimated","WebGLFragment","WebGLVertex","fragment","DEBUG_WEBGL","Locations","program","u_projectionMatrix","getUniformLocation","u_offsetScaleMatrix","u_offsetRotateMatrix","u_lineWidth","u_pixelRatio","u_opacity","u_fillColor","u_strokeColor","u_size","a_position","getAttribLocation","a_instruction","a_radius","fromTransform","mat4","WebGLReplay","projectionMatrix_","offsetRotateMatrix_","offsetScaleMatrix_","tmpMat4_","indices","indicesBuffer","startIndices","startIndicesFeature","verticesBuffer","getDeleteResourcesFunction","setUpProgram","shutDownProgram","locations","drawReplay","hitDetection","drawHitDetectionReplayOneByOne","drawHitDetectionReplay","oneByOne","drawHitDetectionReplayAll","DEPTH_BUFFER_BIT","getGL","tmpStencil","tmpStencilFunc","tmpStencilMaskVal","tmpStencilRef","tmpStencilMask","tmpStencilOpFail","tmpStencilOpPass","tmpStencilOpZFail","isEnabled","STENCIL_FUNC","STENCIL_VALUE_MASK","STENCIL_REF","STENCIL_WRITEMASK","STENCIL_FAIL","STENCIL_PASS_DEPTH_PASS","STENCIL_PASS_DEPTH_FAIL","enable","STENCIL_BUFFER_BIT","stencilMask","stencilFunc","ALWAYS","stencilOp","KEEP","REPLACE","NOTEQUAL","bindBuffer","projectionMatrix","offsetScaleMatrix","offsetRotateMatrix","uniformMatrix4fv","uniform1f","drawElements","elementType","hasOESElementIndexUint","elementSize","numItems","offsetInBytes","DEFAULT_FONT","DEFAULT_FILLSTYLE","DEFAULT_LINECAP","DEFAULT_LINEDASH","DEFAULT_LINEDASHOFFSET","DEFAULT_LINEJOIN","DEFAULT_MITERLIMIT","DEFAULT_STROKESTYLE","DEFAULT_TEXTALIGN","DEFAULT_TEXTBASELINE","DEFAULT_LINEWIDTH","EPSILON","triangleIsCounterClockwise","BufferUsage","WebGLBuffer","opt_arr","opt_usage","arr_","usage_","getUsage","WebGLCircleReplay","defaultLocations_","styles_","styleIndices_","fillColor","strokeColor","numVertices","numIndices","lastState","deleteBuffer","getProgram","useProgram","enableVertexAttribArray","vertexAttribPointer","uniform2fv","disableVertexAttribArray","drawReplaySkipping_","nextStyle","setFillStyle_","groupStart","featureIndex","featureStart","uniform4fv","u_image","a_texCoord","a_offsets","a_opacity","a_rotateWithView","LOST","RESTORED","createEmptyTexture","createTexture","WebGLContext","gl_","bufferCache_","shaderCache_","programCache_","currentProgram_","hitDetectionFramebuffer_","hitDetectionTexture_","hitDetectionRenderbuffer_","WEBGL_EXTENSIONS","getExtension","ContextEventType","handleWebGLContextLost","handleWebGLContextRestored","buf","bufferKey","bufferCacheEntry","createBuffer","arrayBuffer","Float32Array","Uint32Array","Uint16Array","bufferData","isContextLost","deleteProgram","deleteShader","deleteFramebuffer","deleteRenderbuffer","deleteTexture","getCanvas","getHitDetectionFramebuffer","initHitDetectionFramebuffer_","getShader","shaderObject","shaderKey","shader","createShader","shaderSource","compileShader","fragmentShaderObject","vertexShaderObject","programKey","createProgram","attachShader","linkProgram","framebuffer","createFramebuffer","bindFramebuffer","texture","renderbuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_COMPONENT16","framebufferTexture2D","framebufferRenderbuffer","DEPTH_ATTACHMENT","bindTexture","createTextureInternal","opt_wrapS","opt_wrapT","texParameteri","texImage2D","WebGLTextureReplay","groupIndices","hitDetectionGroupIndices","imageHeight","imageWidth","defaultLocations","textures","getTextures","drawCoordinates","createTextures","images","texturePerImage","getHitDetectionTextures","drawReplaySkipping","groupEnd","hitDetectionTextures","opt_all","WebGLImageReplay","images_","hitDetectionImages_","textures_","hitDetectionTextures_","currentImage","lineStringIsClosed","u_miterLimit","u_color","a_lastPos","a_nextPos","a_direction","ROUND","BEGIN_LINE","END_LINE","BEGIN_LINE_CAP","END_LINE_CAP","BEVEL_FIRST","BEVEL_SECOND","MITER_BOTTOM","MITER_TOP","WebGLLineStringReplay","startCoords","sign","lastSign","p0","addVertices_","product","isValid_","firstP","lastP","indexCount","drawPolygonCoordinates","holeFlatCoordinates","setPolygonStyle","opt_index","getCurrentIndex","tmpDepthFunc","DEPTH_FUNC","tmpDepthMask","DEPTH_WRITEMASK","depthMask","depthFunc","LinkedList","opt_circular","first_","last_","head_","circular_","length_","insertItem","next","head","removeItem","firstItem","lastItem","nextItem","getNextItem","prevItem","getPrevItem","getCurrItem","setFirstItem","list","WebGLPolygonReplay","outerRing","rtree","processFlatCoordinates_","maxCoords","getMaxCoords_","holeLists","holeList","classifyPoints_","currList","currItem","getIntersections_","bridgeHole_","triangulate_","clockwise","createPoint_","insertItem_","seg","ccw","s0","pointsReclassified","reflex","removeItem_","hole","holeMaxX","listMaxX","minDist","bestPoint","p5","intersectingSegments","currSeg","calculateIntersection_","pointsInTriangle","getPointsInTriangle_","currPoint","currTheta","p0Bridge","p1Bridge","simple","isSimple_","clipEars_","resolveSelfIntersections_","splitPolygon_","isClockwise_","s3","processedEars","variableCriterion","diagonalIsInside_","opt_touch","resolvedIntersections","breakCond","newPolygon","newRtree","opt_rtree","opt_reflex","segmentsInExtent","denom","ub","p1IsLeftOf","p1IsRightOf","p3IsLeftOf","p3IsRightOf","p1InCone","p3InCone","currIndex","currLineIndex","holes","holeFlatCoords","lineDeleter","nullStrokeStyle","Atlas","space","space_","emptyBlocks_","renderCallback","block","split_","deltaWidth","deltaHeight","newBlock1","newBlock2","updateBlocks_","args","INITIAL_ATLAS_SIZE","MAX_ATLAS_SIZE","AtlasManager","currentSize_","initialSize","maxSize_","maxSize","WEBGL_MAX_TEXTURE_SIZE","atlases_","currentHitSize_","hitAtlases_","getInfo","getInfo_","hitInfo","mergeInfos_","atlases","atlas","opt_renderHitCallback","add_","renderHitCallback","isHitAtlas","WebGLTextReplay","measureCanvas_","currAtlas_","glyphAtlas","textSize","getTextSize_","currX","currY","charArr","charInfo","self","textHeight","textWidth","str","sum","curr","addCharToAtlas_","reduce","mCtx","getAtlas_","params","calculateHash_","HIT_DETECTION_SIZE","WebGLReplayGroup","functions","replayHitDetection_","Uint8Array","readPixels","WebGLImmediateRenderer","center_","imageStyle_","fillStyle_","textStyle_","u_texCoordMatrix","u_texture","WebGLLayerRenderer","arrayBuffer_","framebufferDimension","texCoordMatrix","uniform1i","getTexCoordMatrix","getProjectionMatrix","getTexture","drawArrays","WebGLImageLayerRenderer","hitTransformationMatrix_","createTexture_","imageElement","updateProjectionMatrix_","canvasWidth","canvasHeight","canvasExtentWidth","canvasExtentHeight","getHitTransformationMatrix_","pixelOnFrameBuffer","mapCoordTransform","projectionMatrixInv","WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK","WebGLMapRenderer","clipTileCanvasWidth_","clipTileCanvasHeight_","clipTileContext_","antialias","preserveDrawingBuffer","stencil","textureCache_","tileTextureQueue_","loadNextTileTexture_","tileSize","bindTileTexture","textureCacheFrameMarkerCount_","initializeGL_","magFilter","minFilter","textureCacheEntry","clipTileCanvas","clipTileContext","expireCache_","getTileTextureQueue","renderers","activeTexture","blendFuncSeparate","isTileTextureLoaded","layerStatesToDraw","clearColor","viewport","u_tileOffset","WebGLTileLayerRenderer","fragmentShader_","vertexShader_","locations_","renderArrayBuffer_","renderedTileRange_","renderedFramebufferExtent_","tmpSize_","getTileSize","tilePixelResolution","framebufferExtent","tileRangeSize","maxDimension","framebufferExtentDimension","allTilesLoaded","drawable","fullyLoaded","tileTextureQueue","pixelOnMapScaled","pixelOnFrameBufferScaled","WebGLVectorLayerRenderer","layerState_","scissor","WebGLMap","PRELOAD","USE_INTERIM_TILES_ON_ERROR","TileLayer","setPreload","setUseInterimTilesOnError","TileProperty","calculateSourceResolution","targetProj","targetMetersPerUnit","sourceMetersPerUnit","compensationFactor","isFinite","enlargeClipPoint","centroidX","centroidY","dX","dY","targetExtent","triangulation","sources","opt_renderEdges","sourceDataExtent","canvasWidthInUnits","canvasHeightInUnits","stitchContext","stitchScale","xPos","yPos","srcWidth","srcHeight","targetTopLeft","getTriangles","triangle","u0","v0","u1","u2","sourceNumericalShiftX","sourceNumericalShiftY","augmentedMatrix","affineCoefs","MAX_SUBDIVISION","MAX_TRIANGLE_WIDTH","Triangulation","maxSourceExtent","errorThreshold","sourceProj_","targetProj_","transformInvCache","transformInv","transformInv_","maxSourceExtent_","errorThresholdSquared_","triangles_","wrapsXInSource_","canWrapXInSource_","sourceWorldWidth_","targetWorldWidth_","destinationTopLeft","destinationTopRight","destinationBottomRight","destinationBottomLeft","sourceTopLeft","sourceTopRight","sourceBottomRight","sourceBottomLeft","addQuad_","leftBound","newTriangle","addTriangle_","aSrc","bSrc","cSrc","dSrc","maxSubdivision","sourceQuadExtent","sourceCoverageX","sourceWorldWidth","wrapsX","needsSubdivision","targetQuadExtent","targetCoverageX","centerSrc","centerSrcEstimX","centerSrcErrorSquared","bc","bcSrc","da","daSrc","ab","abSrc","cd","cdSrc","calculateSourceExtent","ReprojTile","targetTileGrid","getTileFunction","opt_errorThreshold","renderEdges_","gutter_","sourceTileGrid_","targetTileGrid_","wrappedTileCoord_","sourcesListenerKeys_","sourceZ_","maxTargetExtent","limitedTargetExtent","sourceProjExtent","errorThresholdInPixels","triangulation_","sourceRange","srcX","srcY","unlistenSources_","reproject_","sourceListenKey","createFromTemplate","createFromTemplates","createFromTileUrlFunctions","nullTileUrlFunction","expandUrl","zRegEx","xRegEx","yRegEx","dashYRegEx","templates","tileUrlFunctions","urls","match","startCharCode","stopCharCode","stop","TileGrid","origins","origins_","tileSizes_","tileSizes","tileSize_","fullTileRanges_","sizes","calculateTileRanges_","tmpTileCoord","opt_tileRange","tileCoordExtent","getTileCoordForXYAndZ_","getTileCoordForCoordAndResolution","getTileCoordForXYAndResolution_","reverseIntersectionPolicy","adjustX","adjustY","xFromOrigin","yFromOrigin","tileCoordX","tileCoordY","getTileCoordForCoordAndZ","getTileCoordResolution","fullTileRanges","getForProjection","createForExtent","createXYZ","createForProjection","extentFromProjection","opt_maxZoom","opt_tileSize","opt_corner","resolutionsFromExtent","half","TileSource","opaque_","opaque","tilePixelRatio_","tileCache","tmpSize","tileOptions","getTileCacheForProjection","setKey","thisProj","getTileCoordForTileUrlFunction","TileSourceEvent","TILELOADSTART","TILELOADEND","TILELOADERROR","UrlTile","fixedTileUrlFunction","setUrls","setUrl","setTileUrlFunction","tileLoadingKeys_","getTileLoadFunction","getTileUrlFunction","getUrls","TileEventType","setTileLoadFunction","opt_key","TileImage","defaultTileLoadFunction","tileCacheForProjection","tileGridForProjection","reprojectionErrorThreshold_","reprojectionErrorThreshold","renderReprojectionEdges_","usedTileCache","getGutterInternal","projKey","createTile_","getTileInternal","newTile","setRenderReprojectionEdges","setTileGridForProjection","tilegrid","proj","imageTile","ATTRIBUTION","OSM","bundleURL","getBundleURLCached","getBundleURL","matches","getBaseURL","exports","bundle","require","updateLink","link","newLink","cloneNode","href","nextSibling","cssTimeout","reloadCSS","links","querySelectorAll","module"],"mappings":"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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC/iBA;;AACA;;;;AACA;;AACA;;;;AAEA;;;;;;;;;AASA;;;;;;;;;AAjBA;;;AA0BA,MAAMC,QAAQ,UAASC,cAAT,EAAyB;;AAErC;;;AAGA,OAAKC,MAAL,GAAc,qBAAMD,cAAN,EAAsBvzE,SAAtB,CAAd;;AAEA;;;;;;AAMA,OAAKyzE,MAAL,GAAc,EAAd;AAED,CAfD;;AAkBA;;;;;AAKAH,MAAM90E,SAAN,CAAgBk1E,MAAhB,GAAyB,UAAS1mE,MAAT,EAAiBlG,KAAjB,EAAwB;AAC/C;AACA,QAAM+B,OAAO;AACXwE,UAAML,OAAO,CAAP,CADK;AAEXS,UAAMT,OAAO,CAAP,CAFK;AAGXU,UAAMV,OAAO,CAAP,CAHK;AAIXY,UAAMZ,OAAO,CAAP,CAJK;AAKXlG,WAAOA;AALI,GAAb;;AAQA,OAAK0sE,MAAL,CAAYE,MAAZ,CAAmB7qE,IAAnB;AACA,OAAK4qE,MAAL,CAAY,kBAAO3sE,KAAP,CAAZ,IAA6B+B,IAA7B;AACD,CAZD;;AAeA;;;;;AAKAyqE,MAAM90E,SAAN,CAAgBkxB,IAAhB,GAAuB,UAAS8iD,OAAT,EAAkB5xE,MAAlB,EAA0B;AAC/C,QAA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","file":"MakingMaps.6c5d59e9.map","sourceRoot":"..","sourcesContent":["/**\n * @module ol/util\n */\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * Usage:\n *\n *     function ParentClass(a, b) { }\n *     ParentClass.prototype.foo = function(a) { }\n *\n *     function ChildClass(a, b, c) {\n *       // Call parent constructor\n *       ParentClass.call(this, a, b);\n *     }\n *     inherits(ChildClass, ParentClass);\n *\n *     var child = new ChildClass('a', 'b', 'see');\n *     child.foo(); // This works.\n *\n * @param {!Function} childCtor Child constructor.\n * @param {!Function} parentCtor Parent constructor.\n * @function module:ol.inherits\n * @api\n */\nexport function inherits(childCtor, parentCtor) {\n  childCtor.prototype = Object.create(parentCtor.prototype);\n  childCtor.prototype.constructor = childCtor;\n}\n\n/**\n * Counter for getUid.\n * @type {number}\n * @private\n */\nlet uidCounter_ = 0;\n\n/**\n * Gets a unique ID for an object. This mutates the object so that further calls\n * with the same object as a parameter returns the same value. Unique IDs are generated\n * as a strictly increasing sequence. Adapted from goog.getUid.\n *\n * @param {Object} obj The object to get the unique ID for.\n * @return {number} The unique ID for the object.\n */\nexport function getUid(obj) {\n  return obj.ol_uid || (obj.ol_uid = ++uidCounter_);\n}\n\n/**\n * OpenLayers version.\n * @type {string}\n */\nexport const VERSION = '5.0.3';\n","/**\n * @module ol/AssertionError\n */\nimport {VERSION, inherits} from './util.js';\n\n/**\n * Error object thrown when an assertion failed. This is an ECMA-262 Error,\n * extended with a `code` property.\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error}\n * @constructor\n * @extends {Error}\n * @param {number} code Error code.\n */\nconst AssertionError = function(code) {\n\n  const path = VERSION.split('-')[0];\n\n  /**\n   * @type {string}\n   */\n  this.message = 'Assertion failed. See https://openlayers.org/en/' + path +\n      '/doc/errors/#' + code + ' for details.';\n\n  /**\n   * Error code. The meaning of the code can be found on\n   * {@link https://openlayers.org/en/latest/doc/errors/} (replace `latest` with\n   * the version found in the OpenLayers script's header comment if a version\n   * other than the latest is used).\n   * @type {number}\n   * @api\n   */\n  this.code = code;\n\n  this.name = 'AssertionError';\n\n};\n\ninherits(AssertionError, Error);\n\nexport default AssertionError;\n","/**\n * @module ol/CollectionEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when an item is added to the collection.\n   * @event module:ol/Collection~CollectionEvent#add\n   * @api\n   */\n  ADD: 'add',\n  /**\n   * Triggered when an item is removed from the collection.\n   * @event module:ol/Collection~CollectionEvent#remove\n   * @api\n   */\n  REMOVE: 'remove'\n};\n","/**\n * @module ol/ObjectEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when a property is changed.\n   * @event module:ol/Object~ObjectEvent#propertychange\n   * @api\n   */\n  PROPERTYCHANGE: 'propertychange'\n};\n","/**\n * @module ol/obj\n */\n\n\n/**\n * Polyfill for Object.assign().  Assigns enumerable and own properties from\n * one or more source objects to a target object.\n *\n * @see https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\n * @param {!Object} target The target object.\n * @param {...Object} var_sources The source object(s).\n * @return {!Object} The modified target object.\n */\nexport const assign = (typeof Object.assign === 'function') ? Object.assign : function(target, var_sources) {\n  if (target === undefined || target === null) {\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  const output = Object(target);\n  for (let i = 1, ii = arguments.length; i < ii; ++i) {\n    const source = arguments[i];\n    if (source !== undefined && source !== null) {\n      for (const key in source) {\n        if (source.hasOwnProperty(key)) {\n          output[key] = source[key];\n        }\n      }\n    }\n  }\n  return output;\n};\n\n\n/**\n * Removes all properties from an object.\n * @param {Object} object The object to clear.\n */\nexport function clear(object) {\n  for (const property in object) {\n    delete object[property];\n  }\n}\n\n\n/**\n * Get an array of property values from an object.\n * @param {Object<K,V>} object The object from which to get the values.\n * @return {!Array<V>} The property values.\n * @template K,V\n */\nexport function getValues(object) {\n  const values = [];\n  for (const property in object) {\n    values.push(object[property]);\n  }\n  return values;\n}\n\n\n/**\n * Determine if an object has any properties.\n * @param {Object} object The object to check.\n * @return {boolean} The object is empty.\n */\nexport function isEmpty(object) {\n  let property;\n  for (property in object) {\n    return false;\n  }\n  return !property;\n}\n","/**\n * @module ol/events\n */\nimport {clear} from './obj.js';\n\n\n/**\n * Key to use with {@link module:ol/Observable~Observable#unByKey}.\n * @typedef {Object} EventsKey\n * @property {Object} [bindTo]\n * @property {module:ol/events~ListenerFunction} [boundListener]\n * @property {boolean} callOnce\n * @property {number} [deleteIndex]\n * @property {module:ol/events~ListenerFunction} listener\n * @property {EventTarget|module:ol/events/EventTarget} target\n * @property {string} type\n * @api\n */\n\n\n/**\n * Listener function. This function is called with an event object as argument.\n * When the function returns `false`, event propagation will stop.\n *\n * @typedef {function(module:ol/events/Event)|function(module:ol/events/Event): boolean} ListenerFunction\n * @api\n */\n\n\n/**\n * @param {module:ol/events~EventsKey} listenerObj Listener object.\n * @return {module:ol/events~ListenerFunction} Bound listener.\n */\nexport function bindListener(listenerObj) {\n  const boundListener = function(evt) {\n    const listener = listenerObj.listener;\n    const bindTo = listenerObj.bindTo || listenerObj.target;\n    if (listenerObj.callOnce) {\n      unlistenByKey(listenerObj);\n    }\n    return listener.call(bindTo, evt);\n  };\n  listenerObj.boundListener = boundListener;\n  return boundListener;\n}\n\n\n/**\n * Finds the matching {@link module:ol/events~EventsKey} in the given listener\n * array.\n *\n * @param {!Array<!module:ol/events~EventsKey>} listeners Array of listeners.\n * @param {!Function} listener The listener function.\n * @param {Object=} opt_this The `this` value inside the listener.\n * @param {boolean=} opt_setDeleteIndex Set the deleteIndex on the matching\n *     listener, for {@link module:ol/events~unlistenByKey}.\n * @return {module:ol/events~EventsKey|undefined} The matching listener object.\n */\nexport function findListener(listeners, listener, opt_this, opt_setDeleteIndex) {\n  let listenerObj;\n  for (let i = 0, ii = listeners.length; i < ii; ++i) {\n    listenerObj = listeners[i];\n    if (listenerObj.listener === listener &&\n        listenerObj.bindTo === opt_this) {\n      if (opt_setDeleteIndex) {\n        listenerObj.deleteIndex = i;\n      }\n      return listenerObj;\n    }\n  }\n  return undefined;\n}\n\n\n/**\n * @param {module:ol/events/EventTarget~EventTargetLike} target Target.\n * @param {string} type Type.\n * @return {Array.<module:ol/events~EventsKey>|undefined} Listeners.\n */\nexport function getListeners(target, type) {\n  const listenerMap = target.ol_lm;\n  return listenerMap ? listenerMap[type] : undefined;\n}\n\n\n/**\n * Get the lookup of listeners.  If one does not exist on the target, it is\n * created.\n * @param {module:ol/events/EventTarget~EventTargetLike} target Target.\n * @return {!Object.<string, Array.<module:ol/events~EventsKey>>} Map of\n *     listeners by event type.\n */\nfunction getListenerMap(target) {\n  let listenerMap = target.ol_lm;\n  if (!listenerMap) {\n    listenerMap = target.ol_lm = {};\n  }\n  return listenerMap;\n}\n\n\n/**\n * Clean up all listener objects of the given type.  All properties on the\n * listener objects will be removed, and if no listeners remain in the listener\n * map, it will be removed from the target.\n * @param {module:ol/events/EventTarget~EventTargetLike} target Target.\n * @param {string} type Type.\n */\nfunction removeListeners(target, type) {\n  const listeners = getListeners(target, type);\n  if (listeners) {\n    for (let i = 0, ii = listeners.length; i < ii; ++i) {\n      target.removeEventListener(type, listeners[i].boundListener);\n      clear(listeners[i]);\n    }\n    listeners.length = 0;\n    const listenerMap = target.ol_lm;\n    if (listenerMap) {\n      delete listenerMap[type];\n      if (Object.keys(listenerMap).length === 0) {\n        delete target.ol_lm;\n      }\n    }\n  }\n}\n\n\n/**\n * Registers an event listener on an event target. Inspired by\n * {@link https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html}\n *\n * This function efficiently binds a `listener` to a `this` object, and returns\n * a key for use with {@link module:ol/events~unlistenByKey}.\n *\n * @param {module:ol/events/EventTarget~EventTargetLike} target Event target.\n * @param {string} type Event type.\n * @param {module:ol/events~ListenerFunction} listener Listener.\n * @param {Object=} opt_this Object referenced by the `this` keyword in the\n *     listener. Default is the `target`.\n * @param {boolean=} opt_once If true, add the listener as one-off listener.\n * @return {module:ol/events~EventsKey} Unique key for the listener.\n */\nexport function listen(target, type, listener, opt_this, opt_once) {\n  const listenerMap = getListenerMap(target);\n  let listeners = listenerMap[type];\n  if (!listeners) {\n    listeners = listenerMap[type] = [];\n  }\n  let listenerObj = findListener(listeners, listener, opt_this, false);\n  if (listenerObj) {\n    if (!opt_once) {\n      // Turn one-off listener into a permanent one.\n      listenerObj.callOnce = false;\n    }\n  } else {\n    listenerObj = /** @type {module:ol/events~EventsKey} */ ({\n      bindTo: opt_this,\n      callOnce: !!opt_once,\n      listener: listener,\n      target: target,\n      type: type\n    });\n    target.addEventListener(type, bindListener(listenerObj));\n    listeners.push(listenerObj);\n  }\n\n  return listenerObj;\n}\n\n\n/**\n * Registers a one-off event listener on an event target. Inspired by\n * {@link https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html}\n *\n * This function efficiently binds a `listener` as self-unregistering listener\n * to a `this` object, and returns a key for use with\n * {@link module:ol/events~unlistenByKey} in case the listener needs to be\n * unregistered before it is called.\n *\n * When {@link module:ol/events~listen} is called with the same arguments after this\n * function, the self-unregistering listener will be turned into a permanent\n * listener.\n *\n * @param {module:ol/events/EventTarget~EventTargetLike} target Event target.\n * @param {string} type Event type.\n * @param {module:ol/events~ListenerFunction} listener Listener.\n * @param {Object=} opt_this Object referenced by the `this` keyword in the\n *     listener. Default is the `target`.\n * @return {module:ol/events~EventsKey} Key for unlistenByKey.\n */\nexport function listenOnce(target, type, listener, opt_this) {\n  return listen(target, type, listener, opt_this, true);\n}\n\n\n/**\n * Unregisters an event listener on an event target. Inspired by\n * {@link https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html}\n *\n * To return a listener, this function needs to be called with the exact same\n * arguments that were used for a previous {@link module:ol/events~listen} call.\n *\n * @param {module:ol/events/EventTarget~EventTargetLike} target Event target.\n * @param {string} type Event type.\n * @param {module:ol/events~ListenerFunction} listener Listener.\n * @param {Object=} opt_this Object referenced by the `this` keyword in the\n *     listener. Default is the `target`.\n */\nexport function unlisten(target, type, listener, opt_this) {\n  const listeners = getListeners(target, type);\n  if (listeners) {\n    const listenerObj = findListener(listeners, listener, opt_this, true);\n    if (listenerObj) {\n      unlistenByKey(listenerObj);\n    }\n  }\n}\n\n\n/**\n * Unregisters event listeners on an event target. Inspired by\n * {@link https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html}\n *\n * The argument passed to this function is the key returned from\n * {@link module:ol/events~listen} or {@link module:ol/events~listenOnce}.\n *\n * @param {module:ol/events~EventsKey} key The key.\n */\nexport function unlistenByKey(key) {\n  if (key && key.target) {\n    key.target.removeEventListener(key.type, key.boundListener);\n    const listeners = getListeners(key.target, key.type);\n    if (listeners) {\n      const i = 'deleteIndex' in key ? key.deleteIndex : listeners.indexOf(key);\n      if (i !== -1) {\n        listeners.splice(i, 1);\n      }\n      if (listeners.length === 0) {\n        removeListeners(key.target, key.type);\n      }\n    }\n    clear(key);\n  }\n}\n\n\n/**\n * Unregisters all event listeners on an event target. Inspired by\n * {@link https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html}\n *\n * @param {module:ol/events/EventTarget~EventTargetLike} target Target.\n */\nexport function unlistenAll(target) {\n  const listenerMap = getListenerMap(target);\n  for (const type in listenerMap) {\n    removeListeners(target, type);\n  }\n}\n","/**\n * @module ol/functions\n */\n\n/**\n * Always returns true.\n * @returns {boolean} true.\n */\nexport function TRUE() {\n  return true;\n}\n\n/**\n * Always returns false.\n * @returns {boolean} false.\n */\nexport function FALSE() {\n  return false;\n}\n\n/**\n * A reusable function, used e.g. as a default for callbacks.\n *\n * @return {undefined} Nothing.\n */\nexport function UNDEFINED() {}\n","/**\n * @module ol/Disposable\n */\nimport {UNDEFINED} from './functions.js';\n\n/**\n * Objects that need to clean up after themselves.\n * @constructor\n */\nconst Disposable = function() {};\n\n/**\n * The object has already been disposed.\n * @type {boolean}\n * @private\n */\nDisposable.prototype.disposed_ = false;\n\n/**\n * Clean up.\n */\nDisposable.prototype.dispose = function() {\n  if (!this.disposed_) {\n    this.disposed_ = true;\n    this.disposeInternal();\n  }\n};\n\n/**\n * Extension point for disposable objects.\n * @protected\n */\nDisposable.prototype.disposeInternal = UNDEFINED;\nexport default Disposable;\n","/**\n * @module ol/events/Event\n */\n/**\n * @classdesc\n * Stripped down implementation of the W3C DOM Level 2 Event interface.\n * @see {@link https://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-interface}\n *\n * This implementation only provides `type` and `target` properties, and\n * `stopPropagation` and `preventDefault` methods. It is meant as base class\n * for higher level events defined in the library, and works with\n * {@link module:ol/events/EventTarget~EventTarget}.\n *\n * @constructor\n * @param {string} type Type.\n */\nconst Event = function(type) {\n\n  /**\n   * @type {boolean}\n   */\n  this.propagationStopped;\n\n  /**\n   * The event type.\n   * @type {string}\n   * @api\n   */\n  this.type = type;\n\n  /**\n   * The event target.\n   * @type {Object}\n   * @api\n   */\n  this.target = null;\n\n};\n\n\n/**\n * Stop event propagation.\n * @function\n * @api\n */\nEvent.prototype.preventDefault =\n\n  /**\n   * Stop event propagation.\n   * @function\n   * @api\n   */\n  Event.prototype.stopPropagation = function() {\n    this.propagationStopped = true;\n  };\n\n\n/**\n * @param {Event|module:ol/events/Event} evt Event\n */\nexport function stopPropagation(evt) {\n  evt.stopPropagation();\n}\n\n\n/**\n * @param {Event|module:ol/events/Event} evt Event\n */\nexport function preventDefault(evt) {\n  evt.preventDefault();\n}\n\nexport default Event;\n","/**\n * @module ol/events/EventTarget\n */\nimport {inherits} from '../util.js';\nimport Disposable from '../Disposable.js';\nimport {unlistenAll} from '../events.js';\nimport {UNDEFINED} from '../functions.js';\nimport Event from '../events/Event.js';\n\n\n/**\n * @typedef {EventTarget|module:ol/events/EventTarget} EventTargetLike\n */\n\n\n/**\n * @classdesc\n * A simplified implementation of the W3C DOM Level 2 EventTarget interface.\n * @see {@link https://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/events.html#Events-EventTarget}\n *\n * There are two important simplifications compared to the specification:\n *\n * 1. The handling of `useCapture` in `addEventListener` and\n *    `removeEventListener`. There is no real capture model.\n * 2. The handling of `stopPropagation` and `preventDefault` on `dispatchEvent`.\n *    There is no event target hierarchy. When a listener calls\n *    `stopPropagation` or `preventDefault` on an event object, it means that no\n *    more listeners after this one will be called. Same as when the listener\n *    returns false.\n *\n * @constructor\n * @extends {module:ol/Disposable}\n */\nconst EventTarget = function() {\n\n  Disposable.call(this);\n\n  /**\n   * @private\n   * @type {!Object.<string, number>}\n   */\n  this.pendingRemovals_ = {};\n\n  /**\n   * @private\n   * @type {!Object.<string, number>}\n   */\n  this.dispatching_ = {};\n\n  /**\n   * @private\n   * @type {!Object.<string, Array.<module:ol/events~ListenerFunction>>}\n   */\n  this.listeners_ = {};\n\n};\n\ninherits(EventTarget, Disposable);\n\n\n/**\n * @param {string} type Type.\n * @param {module:ol/events~ListenerFunction} listener Listener.\n */\nEventTarget.prototype.addEventListener = function(type, listener) {\n  let listeners = this.listeners_[type];\n  if (!listeners) {\n    listeners = this.listeners_[type] = [];\n  }\n  if (listeners.indexOf(listener) === -1) {\n    listeners.push(listener);\n  }\n};\n\n\n/**\n * @param {{type: string,\n *     target: (EventTarget|module:ol/events/EventTarget|undefined)}|module:ol/events/Event|\n *     string} event Event or event type.\n * @return {boolean|undefined} `false` if anyone called preventDefault on the\n *     event object or if any of the listeners returned false.\n */\nEventTarget.prototype.dispatchEvent = function(event) {\n  const evt = typeof event === 'string' ? new Event(event) : event;\n  const type = evt.type;\n  evt.target = this;\n  const listeners = this.listeners_[type];\n  let propagate;\n  if (listeners) {\n    if (!(type in this.dispatching_)) {\n      this.dispatching_[type] = 0;\n      this.pendingRemovals_[type] = 0;\n    }\n    ++this.dispatching_[type];\n    for (let i = 0, ii = listeners.length; i < ii; ++i) {\n      if (listeners[i].call(this, evt) === false || evt.propagationStopped) {\n        propagate = false;\n        break;\n      }\n    }\n    --this.dispatching_[type];\n    if (this.dispatching_[type] === 0) {\n      let pendingRemovals = this.pendingRemovals_[type];\n      delete this.pendingRemovals_[type];\n      while (pendingRemovals--) {\n        this.removeEventListener(type, UNDEFINED);\n      }\n      delete this.dispatching_[type];\n    }\n    return propagate;\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nEventTarget.prototype.disposeInternal = function() {\n  unlistenAll(this);\n};\n\n\n/**\n * Get the listeners for a specified event type. Listeners are returned in the\n * order that they will be called in.\n *\n * @param {string} type Type.\n * @return {Array.<module:ol/events~ListenerFunction>} Listeners.\n */\nEventTarget.prototype.getListeners = function(type) {\n  return this.listeners_[type];\n};\n\n\n/**\n * @param {string=} opt_type Type. If not provided,\n *     `true` will be returned if this EventTarget has any listeners.\n * @return {boolean} Has listeners.\n */\nEventTarget.prototype.hasListener = function(opt_type) {\n  return opt_type ?\n    opt_type in this.listeners_ :\n    Object.keys(this.listeners_).length > 0;\n};\n\n\n/**\n * @param {string} type Type.\n * @param {module:ol/events~ListenerFunction} listener Listener.\n */\nEventTarget.prototype.removeEventListener = function(type, listener) {\n  const listeners = this.listeners_[type];\n  if (listeners) {\n    const index = listeners.indexOf(listener);\n    if (type in this.pendingRemovals_) {\n      // make listener a no-op, and remove later in #dispatchEvent()\n      listeners[index] = UNDEFINED;\n      ++this.pendingRemovals_[type];\n    } else {\n      listeners.splice(index, 1);\n      if (listeners.length === 0) {\n        delete this.listeners_[type];\n      }\n    }\n  }\n};\nexport default EventTarget;\n","/**\n * @module ol/events/EventType\n */\n\n/**\n * @enum {string}\n * @const\n */\nexport default {\n  /**\n   * Generic change event. Triggered when the revision counter is increased.\n   * @event module:ol/events/Event~Event#change\n   * @api\n   */\n  CHANGE: 'change',\n\n  CLEAR: 'clear',\n  CONTEXTMENU: 'contextmenu',\n  CLICK: 'click',\n  DBLCLICK: 'dblclick',\n  DRAGENTER: 'dragenter',\n  DRAGOVER: 'dragover',\n  DROP: 'drop',\n  ERROR: 'error',\n  KEYDOWN: 'keydown',\n  KEYPRESS: 'keypress',\n  LOAD: 'load',\n  MOUSEDOWN: 'mousedown',\n  MOUSEMOVE: 'mousemove',\n  MOUSEOUT: 'mouseout',\n  MOUSEUP: 'mouseup',\n  MOUSEWHEEL: 'mousewheel',\n  MSPOINTERDOWN: 'MSPointerDown',\n  RESIZE: 'resize',\n  TOUCHSTART: 'touchstart',\n  TOUCHMOVE: 'touchmove',\n  TOUCHEND: 'touchend',\n  WHEEL: 'wheel'\n};\n","/**\n * @module ol/Observable\n */\nimport {inherits} from './util.js';\nimport {listen, unlistenByKey, unlisten, listenOnce} from './events.js';\nimport EventTarget from './events/EventTarget.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * An event target providing convenient methods for listener registration\n * and unregistration. A generic `change` event is always available through\n * {@link module:ol/Observable~Observable#changed}.\n *\n * @constructor\n * @extends {module:ol/events/EventTarget}\n * @fires module:ol/events/Event~Event\n * @struct\n * @api\n */\nconst Observable = function() {\n\n  EventTarget.call(this);\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.revision_ = 0;\n\n};\n\ninherits(Observable, EventTarget);\n\n\n/**\n * Removes an event listener using the key returned by `on()` or `once()`.\n * @param {module:ol/events~EventsKey|Array.<module:ol/events~EventsKey>} key The key returned by `on()`\n *     or `once()` (or an array of keys).\n * @api\n */\nexport function unByKey(key) {\n  if (Array.isArray(key)) {\n    for (let i = 0, ii = key.length; i < ii; ++i) {\n      unlistenByKey(key[i]);\n    }\n  } else {\n    unlistenByKey(/** @type {module:ol/events~EventsKey} */ (key));\n  }\n}\n\n\n/**\n * Increases the revision counter and dispatches a 'change' event.\n * @api\n */\nObservable.prototype.changed = function() {\n  ++this.revision_;\n  this.dispatchEvent(EventType.CHANGE);\n};\n\n\n/**\n * Dispatches an event and calls all listeners listening for events\n * of this type. The event parameter can either be a string or an\n * Object with a `type` property.\n *\n * @param {{type: string,\n *     target: (EventTarget|module:ol/events/EventTarget|undefined)}|\n *     module:ol/events/Event|string} event Event object.\n * @function\n * @api\n */\nObservable.prototype.dispatchEvent;\n\n\n/**\n * Get the version number for this object.  Each time the object is modified,\n * its version number will be incremented.\n * @return {number} Revision.\n * @api\n */\nObservable.prototype.getRevision = function() {\n  return this.revision_;\n};\n\n\n/**\n * Listen for a certain type of event.\n * @param {string|Array.<string>} type The event type or array of event types.\n * @param {function(?): ?} listener The listener function.\n * @return {module:ol/events~EventsKey|Array.<module:ol/events~EventsKey>} Unique key for the listener. If\n *     called with an array of event types as the first argument, the return\n *     will be an array of keys.\n * @api\n */\nObservable.prototype.on = function(type, listener) {\n  if (Array.isArray(type)) {\n    const len = type.length;\n    const keys = new Array(len);\n    for (let i = 0; i < len; ++i) {\n      keys[i] = listen(this, type[i], listener);\n    }\n    return keys;\n  } else {\n    return listen(this, /** @type {string} */ (type), listener);\n  }\n};\n\n\n/**\n * Listen once for a certain type of event.\n * @param {string|Array.<string>} type The event type or array of event types.\n * @param {function(?): ?} listener The listener function.\n * @return {module:ol/events~EventsKey|Array.<module:ol/events~EventsKey>} Unique key for the listener. If\n *     called with an array of event types as the first argument, the return\n *     will be an array of keys.\n * @api\n */\nObservable.prototype.once = function(type, listener) {\n  if (Array.isArray(type)) {\n    const len = type.length;\n    const keys = new Array(len);\n    for (let i = 0; i < len; ++i) {\n      keys[i] = listenOnce(this, type[i], listener);\n    }\n    return keys;\n  } else {\n    return listenOnce(this, /** @type {string} */ (type), listener);\n  }\n};\n\n\n/**\n * Unlisten for a certain type of event.\n * @param {string|Array.<string>} type The event type or array of event types.\n * @param {function(?): ?} listener The listener function.\n * @api\n */\nObservable.prototype.un = function(type, listener) {\n  if (Array.isArray(type)) {\n    for (let i = 0, ii = type.length; i < ii; ++i) {\n      unlisten(this, type[i], listener);\n    }\n    return;\n  } else {\n    unlisten(this, /** @type {string} */ (type), listener);\n  }\n};\nexport default Observable;\n","/**\n * @module ol/Object\n */\nimport {getUid, inherits} from './util.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport Observable from './Observable.js';\nimport Event from './events/Event.js';\nimport {assign} from './obj.js';\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Object~BaseObject} instances are instances of\n * this type.\n *\n * @param {string} type The event type.\n * @param {string} key The property name.\n * @param {*} oldValue The old value for `key`.\n * @extends {module:ol/events/Event}\n * @constructor\n */\nconst ObjectEvent = function(type, key, oldValue) {\n  Event.call(this, type);\n\n  /**\n   * The name of the property whose value is changing.\n   * @type {string}\n   * @api\n   */\n  this.key = key;\n\n  /**\n   * The old value. To get the new value use `e.target.get(e.key)` where\n   * `e` is the event object.\n   * @type {*}\n   * @api\n   */\n  this.oldValue = oldValue;\n\n};\ninherits(ObjectEvent, Event);\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Most non-trivial classes inherit from this.\n *\n * This extends {@link module:ol/Observable} with observable\n * properties, where each property is observable as well as the object as a\n * whole.\n *\n * Classes that inherit from this have pre-defined properties, to which you can\n * add your owns. The pre-defined properties are listed in this documentation as\n * 'Observable Properties', and have their own accessors; for example,\n * {@link module:ol/Map~Map} has a `target` property, accessed with\n * `getTarget()` and changed with `setTarget()`. Not all properties are however\n * settable. There are also general-purpose accessors `get()` and `set()`. For\n * example, `get('target')` is equivalent to `getTarget()`.\n *\n * The `set` accessors trigger a change event, and you can monitor this by\n * registering a listener. For example, {@link module:ol/View~View} has a\n * `center` property, so `view.on('change:center', function(evt) {...});` would\n * call the function whenever the value of the center property changes. Within\n * the function, `evt.target` would be the view, so `evt.target.getCenter()`\n * would return the new center.\n *\n * You can add your own observable properties with\n * `object.set('prop', 'value')`, and retrieve that with `object.get('prop')`.\n * You can listen for changes on that property value with\n * `object.on('change:prop', listener)`. You can get a list of all\n * properties with {@link module:ol/Object~BaseObject#getProperties}.\n *\n * Note that the observable properties are separate from standard JS properties.\n * You can, for example, give your map object a title with\n * `map.title='New title'` and with `map.set('title', 'Another title')`. The\n * first will be a `hasOwnProperty`; the second will appear in\n * `getProperties()`. Only the second is observable.\n *\n * Properties can be deleted by using the unset method. E.g.\n * object.unset('foo').\n *\n * @constructor\n * @extends {module:ol/Observable}\n * @param {Object.<string, *>=} opt_values An object with key-value pairs.\n * @fires module:ol/Object~ObjectEvent\n * @api\n */\nconst BaseObject = function(opt_values) {\n  Observable.call(this);\n\n  // Call {@link module:ol~getUid} to ensure that the order of objects' ids is\n  // the same as the order in which they were created.  This also helps to\n  // ensure that object properties are always added in the same order, which\n  // helps many JavaScript engines generate faster code.\n  getUid(this);\n\n  /**\n   * @private\n   * @type {!Object.<string, *>}\n   */\n  this.values_ = {};\n\n  if (opt_values !== undefined) {\n    this.setProperties(opt_values);\n  }\n};\n\ninherits(BaseObject, Observable);\n\n\n/**\n * @type {Object.<string, string>}\n */\nconst changeEventTypeCache = {};\n\n\n/**\n * @param {string} key Key name.\n * @return {string} Change name.\n */\nexport function getChangeEventType(key) {\n  return changeEventTypeCache.hasOwnProperty(key) ?\n    changeEventTypeCache[key] :\n    (changeEventTypeCache[key] = 'change:' + key);\n}\n\n\n/**\n * Gets a value.\n * @param {string} key Key name.\n * @return {*} Value.\n * @api\n */\nBaseObject.prototype.get = function(key) {\n  let value;\n  if (this.values_.hasOwnProperty(key)) {\n    value = this.values_[key];\n  }\n  return value;\n};\n\n\n/**\n * Get a list of object property names.\n * @return {Array.<string>} List of property names.\n * @api\n */\nBaseObject.prototype.getKeys = function() {\n  return Object.keys(this.values_);\n};\n\n\n/**\n * Get an object of all property names and values.\n * @return {Object.<string, *>} Object.\n * @api\n */\nBaseObject.prototype.getProperties = function() {\n  return assign({}, this.values_);\n};\n\n\n/**\n * @param {string} key Key name.\n * @param {*} oldValue Old value.\n */\nBaseObject.prototype.notify = function(key, oldValue) {\n  let eventType;\n  eventType = getChangeEventType(key);\n  this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n  eventType = ObjectEventType.PROPERTYCHANGE;\n  this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n};\n\n\n/**\n * Sets a value.\n * @param {string} key Key name.\n * @param {*} value Value.\n * @param {boolean=} opt_silent Update without triggering an event.\n * @api\n */\nBaseObject.prototype.set = function(key, value, opt_silent) {\n  if (opt_silent) {\n    this.values_[key] = value;\n  } else {\n    const oldValue = this.values_[key];\n    this.values_[key] = value;\n    if (oldValue !== value) {\n      this.notify(key, oldValue);\n    }\n  }\n};\n\n\n/**\n * Sets a collection of key-value pairs.  Note that this changes any existing\n * properties and adds new ones (it does not remove any existing properties).\n * @param {Object.<string, *>} values Values.\n * @param {boolean=} opt_silent Update without triggering an event.\n * @api\n */\nBaseObject.prototype.setProperties = function(values, opt_silent) {\n  for (const key in values) {\n    this.set(key, values[key], opt_silent);\n  }\n};\n\n\n/**\n * Unsets a property.\n * @param {string} key Key name.\n * @param {boolean=} opt_silent Unset without triggering an event.\n * @api\n */\nBaseObject.prototype.unset = function(key, opt_silent) {\n  if (key in this.values_) {\n    const oldValue = this.values_[key];\n    delete this.values_[key];\n    if (!opt_silent) {\n      this.notify(key, oldValue);\n    }\n  }\n};\n\n\nexport default BaseObject;\n","/**\n * @module ol/Collection\n */\nimport {inherits} from './util.js';\nimport AssertionError from './AssertionError.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport BaseObject from './Object.js';\nimport Event from './events/Event.js';\n\n\n/**\n * @enum {string}\n * @private\n */\nconst Property = {\n  LENGTH: 'length'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Collection~Collection} instances are instances of this\n * type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {module:ol/CollectionEventType} type Type.\n * @param {*=} opt_element Element.\n */\nexport const CollectionEvent = function(type, opt_element) {\n\n  Event.call(this, type);\n\n  /**\n   * The element that is added to or removed from the collection.\n   * @type {*}\n   * @api\n   */\n  this.element = opt_element;\n\n};\n\ninherits(CollectionEvent, Event);\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [unique=false] Disallow the same item from being added to\n * the collection twice.\n */\n\n/**\n * @classdesc\n * An expanded version of standard JS Array, adding convenience methods for\n * manipulation. Add and remove changes to the Collection trigger a Collection\n * event. Note that this does not cover changes to the objects _within_ the\n * Collection; they trigger events on the appropriate object, not on the\n * Collection as a whole.\n *\n * @constructor\n * @extends {module:ol/Object}\n * @fires module:ol/Collection~CollectionEvent\n * @param {Array.<T>=} opt_array Array.\n * @param {module:ol/Collection~Options=} opt_options Collection options.\n * @template T\n * @api\n */\nconst Collection = function(opt_array, opt_options) {\n\n  BaseObject.call(this);\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.unique_ = !!options.unique;\n\n  /**\n   * @private\n   * @type {!Array.<T>}\n   */\n  this.array_ = opt_array ? opt_array : [];\n\n  if (this.unique_) {\n    for (let i = 0, ii = this.array_.length; i < ii; ++i) {\n      this.assertUnique_(this.array_[i], i);\n    }\n  }\n\n  this.updateLength_();\n\n};\n\ninherits(Collection, BaseObject);\n\n\n/**\n * Remove all elements from the collection.\n * @api\n */\nCollection.prototype.clear = function() {\n  while (this.getLength() > 0) {\n    this.pop();\n  }\n};\n\n\n/**\n * Add elements to the collection.  This pushes each item in the provided array\n * to the end of the collection.\n * @param {!Array.<T>} arr Array.\n * @return {module:ol/Collection.<T>} This collection.\n * @api\n */\nCollection.prototype.extend = function(arr) {\n  for (let i = 0, ii = arr.length; i < ii; ++i) {\n    this.push(arr[i]);\n  }\n  return this;\n};\n\n\n/**\n * Iterate over each element, calling the provided callback.\n * @param {function(T, number, Array.<T>): *} f The function to call\n *     for every element. This function takes 3 arguments (the element, the\n *     index and the array). The return value is ignored.\n * @api\n */\nCollection.prototype.forEach = function(f) {\n  const array = this.array_;\n  for (let i = 0, ii = array.length; i < ii; ++i) {\n    f(array[i], i, array);\n  }\n};\n\n\n/**\n * Get a reference to the underlying Array object. Warning: if the array\n * is mutated, no events will be dispatched by the collection, and the\n * collection's \"length\" property won't be in sync with the actual length\n * of the array.\n * @return {!Array.<T>} Array.\n * @api\n */\nCollection.prototype.getArray = function() {\n  return this.array_;\n};\n\n\n/**\n * Get the element at the provided index.\n * @param {number} index Index.\n * @return {T} Element.\n * @api\n */\nCollection.prototype.item = function(index) {\n  return this.array_[index];\n};\n\n\n/**\n * Get the length of this collection.\n * @return {number} The length of the array.\n * @observable\n * @api\n */\nCollection.prototype.getLength = function() {\n  return /** @type {number} */ (this.get(Property.LENGTH));\n};\n\n\n/**\n * Insert an element at the provided index.\n * @param {number} index Index.\n * @param {T} elem Element.\n * @api\n */\nCollection.prototype.insertAt = function(index, elem) {\n  if (this.unique_) {\n    this.assertUnique_(elem);\n  }\n  this.array_.splice(index, 0, elem);\n  this.updateLength_();\n  this.dispatchEvent(\n    new CollectionEvent(CollectionEventType.ADD, elem));\n};\n\n\n/**\n * Remove the last element of the collection and return it.\n * Return `undefined` if the collection is empty.\n * @return {T|undefined} Element.\n * @api\n */\nCollection.prototype.pop = function() {\n  return this.removeAt(this.getLength() - 1);\n};\n\n\n/**\n * Insert the provided element at the end of the collection.\n * @param {T} elem Element.\n * @return {number} New length of the collection.\n * @api\n */\nCollection.prototype.push = function(elem) {\n  if (this.unique_) {\n    this.assertUnique_(elem);\n  }\n  const n = this.getLength();\n  this.insertAt(n, elem);\n  return this.getLength();\n};\n\n\n/**\n * Remove the first occurrence of an element from the collection.\n * @param {T} elem Element.\n * @return {T|undefined} The removed element or undefined if none found.\n * @api\n */\nCollection.prototype.remove = function(elem) {\n  const arr = this.array_;\n  for (let i = 0, ii = arr.length; i < ii; ++i) {\n    if (arr[i] === elem) {\n      return this.removeAt(i);\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * Remove the element at the provided index and return it.\n * Return `undefined` if the collection does not contain this index.\n * @param {number} index Index.\n * @return {T|undefined} Value.\n * @api\n */\nCollection.prototype.removeAt = function(index) {\n  const prev = this.array_[index];\n  this.array_.splice(index, 1);\n  this.updateLength_();\n  this.dispatchEvent(new CollectionEvent(CollectionEventType.REMOVE, prev));\n  return prev;\n};\n\n\n/**\n * Set the element at the provided index.\n * @param {number} index Index.\n * @param {T} elem Element.\n * @api\n */\nCollection.prototype.setAt = function(index, elem) {\n  const n = this.getLength();\n  if (index < n) {\n    if (this.unique_) {\n      this.assertUnique_(elem, index);\n    }\n    const prev = this.array_[index];\n    this.array_[index] = elem;\n    this.dispatchEvent(\n      new CollectionEvent(CollectionEventType.REMOVE, prev));\n    this.dispatchEvent(\n      new CollectionEvent(CollectionEventType.ADD, elem));\n  } else {\n    for (let j = n; j < index; ++j) {\n      this.insertAt(j, undefined);\n    }\n    this.insertAt(index, elem);\n  }\n};\n\n\n/**\n * @private\n */\nCollection.prototype.updateLength_ = function() {\n  this.set(Property.LENGTH, this.array_.length);\n};\n\n\n/**\n * @private\n * @param {T} elem Element.\n * @param {number=} opt_except Optional index to ignore.\n */\nCollection.prototype.assertUnique_ = function(elem, opt_except) {\n  for (let i = 0, ii = this.array_.length; i < ii; ++i) {\n    if (this.array_[i] === elem && i !== opt_except) {\n      throw new AssertionError(58);\n    }\n  }\n};\n\nexport default Collection;\n","/**\n * @module ol/asserts\n */\nimport AssertionError from './AssertionError.js';\n\n/**\n * @param {*} assertion Assertion we expected to be truthy.\n * @param {number} errorCode Error code.\n */\nexport function assert(assertion, errorCode) {\n  if (!assertion) {\n    throw new AssertionError(errorCode);\n  }\n}\n","/**\n * @module ol/extent/Corner\n */\n\n/**\n * Extent corner.\n * @enum {string}\n */\nexport default {\n  BOTTOM_LEFT: 'bottom-left',\n  BOTTOM_RIGHT: 'bottom-right',\n  TOP_LEFT: 'top-left',\n  TOP_RIGHT: 'top-right'\n};\n","/**\n * @module ol/extent/Relationship\n */\n\n/**\n * Relationship to an extent.\n * @enum {number}\n */\nexport default {\n  UNKNOWN: 0,\n  INTERSECTING: 1,\n  ABOVE: 2,\n  RIGHT: 4,\n  BELOW: 8,\n  LEFT: 16\n};\n","/**\n * @module ol/extent\n */\nimport {assert} from './asserts.js';\nimport Corner from './extent/Corner.js';\nimport Relationship from './extent/Relationship.js';\n\n\n/**\n * An array of numbers representing an extent: `[minx, miny, maxx, maxy]`.\n * @typedef {Array.<number>} Extent\n * @api\n */\n\n/**\n * Build an extent that includes all given coordinates.\n *\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @return {module:ol/extent~Extent} Bounding extent.\n * @api\n */\nexport function boundingExtent(coordinates) {\n  const extent = createEmpty();\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    extendCoordinate(extent, coordinates[i]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {Array.<number>} xs Xs.\n * @param {Array.<number>} ys Ys.\n * @param {module:ol/extent~Extent=} opt_extent Destination extent.\n * @private\n * @return {module:ol/extent~Extent} Extent.\n */\nfunction _boundingExtentXYs(xs, ys, opt_extent) {\n  const minX = Math.min.apply(null, xs);\n  const minY = Math.min.apply(null, ys);\n  const maxX = Math.max.apply(null, xs);\n  const maxY = Math.max.apply(null, ys);\n  return createOrUpdate(minX, minY, maxX, maxY, opt_extent);\n}\n\n\n/**\n * Return extent increased by the provided value.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} value The amount by which the extent should be buffered.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nexport function buffer(extent, value, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = extent[0] - value;\n    opt_extent[1] = extent[1] - value;\n    opt_extent[2] = extent[2] + value;\n    opt_extent[3] = extent[3] + value;\n    return opt_extent;\n  } else {\n    return [\n      extent[0] - value,\n      extent[1] - value,\n      extent[2] + value,\n      extent[3] + value\n    ];\n  }\n}\n\n\n/**\n * Creates a clone of an extent.\n *\n * @param {module:ol/extent~Extent} extent Extent to clone.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} The clone.\n */\nexport function clone(extent, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = extent[0];\n    opt_extent[1] = extent[1];\n    opt_extent[2] = extent[2];\n    opt_extent[3] = extent[3];\n    return opt_extent;\n  } else {\n    return extent.slice();\n  }\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {number} Closest squared distance.\n */\nexport function closestSquaredDistanceXY(extent, x, y) {\n  let dx, dy;\n  if (x < extent[0]) {\n    dx = extent[0] - x;\n  } else if (extent[2] < x) {\n    dx = x - extent[2];\n  } else {\n    dx = 0;\n  }\n  if (y < extent[1]) {\n    dy = extent[1] - y;\n  } else if (extent[3] < y) {\n    dy = y - extent[3];\n  } else {\n    dy = 0;\n  }\n  return dx * dx + dy * dy;\n}\n\n\n/**\n * Check if the passed coordinate is contained or on the edge of the extent.\n *\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @return {boolean} The coordinate is contained in the extent.\n * @api\n */\nexport function containsCoordinate(extent, coordinate) {\n  return containsXY(extent, coordinate[0], coordinate[1]);\n}\n\n\n/**\n * Check if one extent contains another.\n *\n * An extent is deemed contained if it lies completely within the other extent,\n * including if they share one or more edges.\n *\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent 2.\n * @return {boolean} The second extent is contained by or on the edge of the\n *     first.\n * @api\n */\nexport function containsExtent(extent1, extent2) {\n  return extent1[0] <= extent2[0] && extent2[2] <= extent1[2] &&\n      extent1[1] <= extent2[1] && extent2[3] <= extent1[3];\n}\n\n\n/**\n * Check if the passed coordinate is contained or on the edge of the extent.\n *\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} x X coordinate.\n * @param {number} y Y coordinate.\n * @return {boolean} The x, y values are contained in the extent.\n * @api\n */\nexport function containsXY(extent, x, y) {\n  return extent[0] <= x && x <= extent[2] && extent[1] <= y && y <= extent[3];\n}\n\n\n/**\n * Get the relationship between a coordinate and extent.\n * @param {module:ol/extent~Extent} extent The extent.\n * @param {module:ol/coordinate~Coordinate} coordinate The coordinate.\n * @return {module:ol/extent/Relationship} The relationship (bitwise compare with\n *     module:ol/extent/Relationship~Relationship).\n */\nexport function coordinateRelationship(extent, coordinate) {\n  const minX = extent[0];\n  const minY = extent[1];\n  const maxX = extent[2];\n  const maxY = extent[3];\n  const x = coordinate[0];\n  const y = coordinate[1];\n  let relationship = Relationship.UNKNOWN;\n  if (x < minX) {\n    relationship = relationship | Relationship.LEFT;\n  } else if (x > maxX) {\n    relationship = relationship | Relationship.RIGHT;\n  }\n  if (y < minY) {\n    relationship = relationship | Relationship.BELOW;\n  } else if (y > maxY) {\n    relationship = relationship | Relationship.ABOVE;\n  }\n  if (relationship === Relationship.UNKNOWN) {\n    relationship = Relationship.INTERSECTING;\n  }\n  return relationship;\n}\n\n\n/**\n * Create an empty extent.\n * @return {module:ol/extent~Extent} Empty extent.\n * @api\n */\nexport function createEmpty() {\n  return [Infinity, Infinity, -Infinity, -Infinity];\n}\n\n\n/**\n * Create a new extent or update the provided extent.\n * @param {number} minX Minimum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxX Maximum X.\n * @param {number} maxY Maximum Y.\n * @param {module:ol/extent~Extent=} opt_extent Destination extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdate(minX, minY, maxX, maxY, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = minX;\n    opt_extent[1] = minY;\n    opt_extent[2] = maxX;\n    opt_extent[3] = maxY;\n    return opt_extent;\n  } else {\n    return [minX, minY, maxX, maxY];\n  }\n}\n\n\n/**\n * Create a new empty extent or make the provided one empty.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdateEmpty(opt_extent) {\n  return createOrUpdate(\n    Infinity, Infinity, -Infinity, -Infinity, opt_extent);\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdateFromCoordinate(coordinate, opt_extent) {\n  const x = coordinate[0];\n  const y = coordinate[1];\n  return createOrUpdate(x, y, x, y, opt_extent);\n}\n\n\n/**\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdateFromCoordinates(coordinates, opt_extent) {\n  const extent = createOrUpdateEmpty(opt_extent);\n  return extendCoordinates(extent, coordinates);\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdateFromFlatCoordinates(flatCoordinates, offset, end, stride, opt_extent) {\n  const extent = createOrUpdateEmpty(opt_extent);\n  return extendFlatCoordinates(extent, flatCoordinates, offset, end, stride);\n}\n\n/**\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} rings Rings.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function createOrUpdateFromRings(rings, opt_extent) {\n  const extent = createOrUpdateEmpty(opt_extent);\n  return extendRings(extent, rings);\n}\n\n\n/**\n * Determine if two extents are equivalent.\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent 2.\n * @return {boolean} The two extents are equivalent.\n * @api\n */\nexport function equals(extent1, extent2) {\n  return extent1[0] == extent2[0] && extent1[2] == extent2[2] &&\n      extent1[1] == extent2[1] && extent1[3] == extent2[3];\n}\n\n\n/**\n * Modify an extent to include another extent.\n * @param {module:ol/extent~Extent} extent1 The extent to be modified.\n * @param {module:ol/extent~Extent} extent2 The extent that will be included in the first.\n * @return {module:ol/extent~Extent} A reference to the first (extended) extent.\n * @api\n */\nexport function extend(extent1, extent2) {\n  if (extent2[0] < extent1[0]) {\n    extent1[0] = extent2[0];\n  }\n  if (extent2[2] > extent1[2]) {\n    extent1[2] = extent2[2];\n  }\n  if (extent2[1] < extent1[1]) {\n    extent1[1] = extent2[1];\n  }\n  if (extent2[3] > extent1[3]) {\n    extent1[3] = extent2[3];\n  }\n  return extent1;\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n */\nexport function extendCoordinate(extent, coordinate) {\n  if (coordinate[0] < extent[0]) {\n    extent[0] = coordinate[0];\n  }\n  if (coordinate[0] > extent[2]) {\n    extent[2] = coordinate[0];\n  }\n  if (coordinate[1] < extent[1]) {\n    extent[1] = coordinate[1];\n  }\n  if (coordinate[1] > extent[3]) {\n    extent[3] = coordinate[1];\n  }\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function extendCoordinates(extent, coordinates) {\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    extendCoordinate(extent, coordinates[i]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function extendFlatCoordinates(extent, flatCoordinates, offset, end, stride) {\n  for (; offset < end; offset += stride) {\n    extendXY(extent, flatCoordinates[offset], flatCoordinates[offset + 1]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} rings Rings.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function extendRings(extent, rings) {\n  for (let i = 0, ii = rings.length; i < ii; ++i) {\n    extendCoordinates(extent, rings[i]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} x X.\n * @param {number} y Y.\n */\nexport function extendXY(extent, x, y) {\n  extent[0] = Math.min(extent[0], x);\n  extent[1] = Math.min(extent[1], y);\n  extent[2] = Math.max(extent[2], x);\n  extent[3] = Math.max(extent[3], y);\n}\n\n\n/**\n * This function calls `callback` for each corner of the extent. If the\n * callback returns a truthy value the function returns that value\n * immediately. Otherwise the function returns `false`.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {function(this:T, module:ol/coordinate~Coordinate): S} callback Callback.\n * @param {T=} opt_this Value to use as `this` when executing `callback`.\n * @return {S|boolean} Value.\n * @template S, T\n */\nexport function forEachCorner(extent, callback, opt_this) {\n  let val;\n  val = callback.call(opt_this, getBottomLeft(extent));\n  if (val) {\n    return val;\n  }\n  val = callback.call(opt_this, getBottomRight(extent));\n  if (val) {\n    return val;\n  }\n  val = callback.call(opt_this, getTopRight(extent));\n  if (val) {\n    return val;\n  }\n  val = callback.call(opt_this, getTopLeft(extent));\n  if (val) {\n    return val;\n  }\n  return false;\n}\n\n\n/**\n * Get the size of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {number} Area.\n * @api\n */\nexport function getArea(extent) {\n  let area = 0;\n  if (!isEmpty(extent)) {\n    area = getWidth(extent) * getHeight(extent);\n  }\n  return area;\n}\n\n\n/**\n * Get the bottom left coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/coordinate~Coordinate} Bottom left coordinate.\n * @api\n */\nexport function getBottomLeft(extent) {\n  return [extent[0], extent[1]];\n}\n\n\n/**\n * Get the bottom right coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/coordinate~Coordinate} Bottom right coordinate.\n * @api\n */\nexport function getBottomRight(extent) {\n  return [extent[2], extent[1]];\n}\n\n\n/**\n * Get the center coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/coordinate~Coordinate} Center.\n * @api\n */\nexport function getCenter(extent) {\n  return [(extent[0] + extent[2]) / 2, (extent[1] + extent[3]) / 2];\n}\n\n\n/**\n * Get a corner coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/extent/Corner} corner Corner.\n * @return {module:ol/coordinate~Coordinate} Corner coordinate.\n */\nexport function getCorner(extent, corner) {\n  let coordinate;\n  if (corner === Corner.BOTTOM_LEFT) {\n    coordinate = getBottomLeft(extent);\n  } else if (corner === Corner.BOTTOM_RIGHT) {\n    coordinate = getBottomRight(extent);\n  } else if (corner === Corner.TOP_LEFT) {\n    coordinate = getTopLeft(extent);\n  } else if (corner === Corner.TOP_RIGHT) {\n    coordinate = getTopRight(extent);\n  } else {\n    assert(false, 13); // Invalid corner\n  }\n  return (\n    /** @type {!module:ol/coordinate~Coordinate} */ (coordinate)\n  );\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent 2.\n * @return {number} Enlarged area.\n */\nexport function getEnlargedArea(extent1, extent2) {\n  const minX = Math.min(extent1[0], extent2[0]);\n  const minY = Math.min(extent1[1], extent2[1]);\n  const maxX = Math.max(extent1[2], extent2[2]);\n  const maxY = Math.max(extent1[3], extent2[3]);\n  return (maxX - minX) * (maxY - minY);\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {module:ol/size~Size} size Size.\n * @param {module:ol/extent~Extent=} opt_extent Destination extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function getForViewAndSize(center, resolution, rotation, size, opt_extent) {\n  const dx = resolution * size[0] / 2;\n  const dy = resolution * size[1] / 2;\n  const cosRotation = Math.cos(rotation);\n  const sinRotation = Math.sin(rotation);\n  const xCos = dx * cosRotation;\n  const xSin = dx * sinRotation;\n  const yCos = dy * cosRotation;\n  const ySin = dy * sinRotation;\n  const x = center[0];\n  const y = center[1];\n  const x0 = x - xCos + ySin;\n  const x1 = x - xCos - ySin;\n  const x2 = x + xCos - ySin;\n  const x3 = x + xCos + ySin;\n  const y0 = y - xSin - yCos;\n  const y1 = y - xSin + yCos;\n  const y2 = y + xSin + yCos;\n  const y3 = y + xSin - yCos;\n  return createOrUpdate(\n    Math.min(x0, x1, x2, x3), Math.min(y0, y1, y2, y3),\n    Math.max(x0, x1, x2, x3), Math.max(y0, y1, y2, y3),\n    opt_extent);\n}\n\n\n/**\n * Get the height of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {number} Height.\n * @api\n */\nexport function getHeight(extent) {\n  return extent[3] - extent[1];\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent 2.\n * @return {number} Intersection area.\n */\nexport function getIntersectionArea(extent1, extent2) {\n  const intersection = getIntersection(extent1, extent2);\n  return getArea(intersection);\n}\n\n\n/**\n * Get the intersection of two extents.\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent 2.\n * @param {module:ol/extent~Extent=} opt_extent Optional extent to populate with intersection.\n * @return {module:ol/extent~Extent} Intersecting extent.\n * @api\n */\nexport function getIntersection(extent1, extent2, opt_extent) {\n  const intersection = opt_extent ? opt_extent : createEmpty();\n  if (intersects(extent1, extent2)) {\n    if (extent1[0] > extent2[0]) {\n      intersection[0] = extent1[0];\n    } else {\n      intersection[0] = extent2[0];\n    }\n    if (extent1[1] > extent2[1]) {\n      intersection[1] = extent1[1];\n    } else {\n      intersection[1] = extent2[1];\n    }\n    if (extent1[2] < extent2[2]) {\n      intersection[2] = extent1[2];\n    } else {\n      intersection[2] = extent2[2];\n    }\n    if (extent1[3] < extent2[3]) {\n      intersection[3] = extent1[3];\n    } else {\n      intersection[3] = extent2[3];\n    }\n  } else {\n    createOrUpdateEmpty(intersection);\n  }\n  return intersection;\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {number} Margin.\n */\nexport function getMargin(extent) {\n  return getWidth(extent) + getHeight(extent);\n}\n\n\n/**\n * Get the size (width, height) of an extent.\n * @param {module:ol/extent~Extent} extent The extent.\n * @return {module:ol/size~Size} The extent size.\n * @api\n */\nexport function getSize(extent) {\n  return [extent[2] - extent[0], extent[3] - extent[1]];\n}\n\n\n/**\n * Get the top left coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/coordinate~Coordinate} Top left coordinate.\n * @api\n */\nexport function getTopLeft(extent) {\n  return [extent[0], extent[3]];\n}\n\n\n/**\n * Get the top right coordinate of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/coordinate~Coordinate} Top right coordinate.\n * @api\n */\nexport function getTopRight(extent) {\n  return [extent[2], extent[3]];\n}\n\n\n/**\n * Get the width of an extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {number} Width.\n * @api\n */\nexport function getWidth(extent) {\n  return extent[2] - extent[0];\n}\n\n\n/**\n * Determine if one extent intersects another.\n * @param {module:ol/extent~Extent} extent1 Extent 1.\n * @param {module:ol/extent~Extent} extent2 Extent.\n * @return {boolean} The two extents intersect.\n * @api\n */\nexport function intersects(extent1, extent2) {\n  return extent1[0] <= extent2[2] &&\n      extent1[2] >= extent2[0] &&\n      extent1[1] <= extent2[3] &&\n      extent1[3] >= extent2[1];\n}\n\n\n/**\n * Determine if an extent is empty.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} Is empty.\n * @api\n */\nexport function isEmpty(extent) {\n  return extent[2] < extent[0] || extent[3] < extent[1];\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function returnOrUpdate(extent, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = extent[0];\n    opt_extent[1] = extent[1];\n    opt_extent[2] = extent[2];\n    opt_extent[3] = extent[3];\n    return opt_extent;\n  } else {\n    return extent;\n  }\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} value Value.\n */\nexport function scaleFromCenter(extent, value) {\n  const deltaX = ((extent[2] - extent[0]) / 2) * (value - 1);\n  const deltaY = ((extent[3] - extent[1]) / 2) * (value - 1);\n  extent[0] -= deltaX;\n  extent[2] += deltaX;\n  extent[1] -= deltaY;\n  extent[3] += deltaY;\n}\n\n\n/**\n * Determine if the segment between two coordinates intersects (crosses,\n * touches, or is contained by) the provided extent.\n * @param {module:ol/extent~Extent} extent The extent.\n * @param {module:ol/coordinate~Coordinate} start Segment start coordinate.\n * @param {module:ol/coordinate~Coordinate} end Segment end coordinate.\n * @return {boolean} The segment intersects the extent.\n */\nexport function intersectsSegment(extent, start, end) {\n  let intersects = false;\n  const startRel = coordinateRelationship(extent, start);\n  const endRel = coordinateRelationship(extent, end);\n  if (startRel === Relationship.INTERSECTING ||\n      endRel === Relationship.INTERSECTING) {\n    intersects = true;\n  } else {\n    const minX = extent[0];\n    const minY = extent[1];\n    const maxX = extent[2];\n    const maxY = extent[3];\n    const startX = start[0];\n    const startY = start[1];\n    const endX = end[0];\n    const endY = end[1];\n    const slope = (endY - startY) / (endX - startX);\n    let x, y;\n    if (!!(endRel & Relationship.ABOVE) &&\n        !(startRel & Relationship.ABOVE)) {\n      // potentially intersects top\n      x = endX - ((endY - maxY) / slope);\n      intersects = x >= minX && x <= maxX;\n    }\n    if (!intersects && !!(endRel & Relationship.RIGHT) &&\n        !(startRel & Relationship.RIGHT)) {\n      // potentially intersects right\n      y = endY - ((endX - maxX) * slope);\n      intersects = y >= minY && y <= maxY;\n    }\n    if (!intersects && !!(endRel & Relationship.BELOW) &&\n        !(startRel & Relationship.BELOW)) {\n      // potentially intersects bottom\n      x = endX - ((endY - minY) / slope);\n      intersects = x >= minX && x <= maxX;\n    }\n    if (!intersects && !!(endRel & Relationship.LEFT) &&\n        !(startRel & Relationship.LEFT)) {\n      // potentially intersects left\n      y = endY - ((endX - minX) * slope);\n      intersects = y >= minY && y <= maxY;\n    }\n\n  }\n  return intersects;\n}\n\n\n/**\n * Apply a transform function to the extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/proj~TransformFunction} transformFn Transform function.\n * Called with `[minX, minY, maxX, maxY]` extent coordinates.\n * @param {module:ol/extent~Extent=} opt_extent Destination extent.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nexport function applyTransform(extent, transformFn, opt_extent) {\n  const coordinates = [\n    extent[0], extent[1],\n    extent[0], extent[3],\n    extent[2], extent[1],\n    extent[2], extent[3]\n  ];\n  transformFn(coordinates, coordinates, 2);\n  const xs = [coordinates[0], coordinates[2], coordinates[4], coordinates[6]];\n  const ys = [coordinates[1], coordinates[3], coordinates[5], coordinates[7]];\n  return _boundingExtentXYs(xs, ys, opt_extent);\n}\n","/**\n * @module ol/geom/flat/transform\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Transformed coordinates.\n */\nexport function transform2D(flatCoordinates, offset, end, stride, transform, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    const x = flatCoordinates[j];\n    const y = flatCoordinates[j + 1];\n    dest[i++] = transform[0] * x + transform[2] * y + transform[4];\n    dest[i++] = transform[1] * x + transform[3] * y + transform[5];\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} angle Angle.\n * @param {Array.<number>} anchor Rotation anchor point.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Transformed coordinates.\n */\nexport function rotate(flatCoordinates, offset, end, stride, angle, anchor, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  const cos = Math.cos(angle);\n  const sin = Math.sin(angle);\n  const anchorX = anchor[0];\n  const anchorY = anchor[1];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    const deltaX = flatCoordinates[j] - anchorX;\n    const deltaY = flatCoordinates[j + 1] - anchorY;\n    dest[i++] = anchorX + deltaX * cos - deltaY * sin;\n    dest[i++] = anchorY + deltaX * sin + deltaY * cos;\n    for (let k = j + 2; k < j + stride; ++k) {\n      dest[i++] = flatCoordinates[k];\n    }\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n\n\n/**\n * Scale the coordinates.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} sx Scale factor in the x-direction.\n * @param {number} sy Scale factor in the y-direction.\n * @param {Array.<number>} anchor Scale anchor point.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Transformed coordinates.\n */\nexport function scale(flatCoordinates, offset, end, stride, sx, sy, anchor, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  const anchorX = anchor[0];\n  const anchorY = anchor[1];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    const deltaX = flatCoordinates[j] - anchorX;\n    const deltaY = flatCoordinates[j + 1] - anchorY;\n    dest[i++] = anchorX + sx * deltaX;\n    dest[i++] = anchorY + sy * deltaY;\n    for (let k = j + 2; k < j + stride; ++k) {\n      dest[i++] = flatCoordinates[k];\n    }\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} deltaX Delta X.\n * @param {number} deltaY Delta Y.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Transformed coordinates.\n */\nexport function translate(flatCoordinates, offset, end, stride, deltaX, deltaY, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    dest[i++] = flatCoordinates[j] + deltaX;\n    dest[i++] = flatCoordinates[j + 1] + deltaY;\n    for (let k = j + 2; k < j + stride; ++k) {\n      dest[i++] = flatCoordinates[k];\n    }\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n","/**\n * @module ol/math\n */\nimport {assert} from './asserts.js';\n\n/**\n * Takes a number and clamps it to within the provided bounds.\n * @param {number} value The input number.\n * @param {number} min The minimum value to return.\n * @param {number} max The maximum value to return.\n * @return {number} The input number if it is within bounds, or the nearest\n *     number within the bounds.\n */\nexport function clamp(value, min, max) {\n  return Math.min(Math.max(value, min), max);\n}\n\n\n/**\n * Return the hyperbolic cosine of a given number. The method will use the\n * native `Math.cosh` function if it is available, otherwise the hyperbolic\n * cosine will be calculated via the reference implementation of the Mozilla\n * developer network.\n *\n * @param {number} x X.\n * @return {number} Hyperbolic cosine of x.\n */\nexport const cosh  = (function() {\n  // Wrapped in a iife, to save the overhead of checking for the native\n  // implementation on every invocation.\n  let cosh;\n  if ('cosh' in Math) {\n    // The environment supports the native Math.cosh function, use it…\n    cosh = Math.cosh;\n  } else {\n    // … else, use the reference implementation of MDN:\n    cosh = function(x) {\n      const y = Math.exp(x);\n      return (y + 1 / y) / 2;\n    };\n  }\n  return cosh;\n}());\n\n\n/**\n * @param {number} x X.\n * @return {number} The smallest power of two greater than or equal to x.\n */\nexport function roundUpToPowerOfTwo(x) {\n  assert(0 < x, 29); // `x` must be greater than `0`\n  return Math.pow(2, Math.ceil(Math.log(x) / Math.LN2));\n}\n\n\n/**\n * Returns the square of the closest distance between the point (x, y) and the\n * line segment (x1, y1) to (x2, y2).\n * @param {number} x X.\n * @param {number} y Y.\n * @param {number} x1 X1.\n * @param {number} y1 Y1.\n * @param {number} x2 X2.\n * @param {number} y2 Y2.\n * @return {number} Squared distance.\n */\nexport function squaredSegmentDistance(x, y, x1, y1, x2, y2) {\n  const dx = x2 - x1;\n  const dy = y2 - y1;\n  if (dx !== 0 || dy !== 0) {\n    const t = ((x - x1) * dx + (y - y1) * dy) / (dx * dx + dy * dy);\n    if (t > 1) {\n      x1 = x2;\n      y1 = y2;\n    } else if (t > 0) {\n      x1 += dx * t;\n      y1 += dy * t;\n    }\n  }\n  return squaredDistance(x, y, x1, y1);\n}\n\n\n/**\n * Returns the square of the distance between the points (x1, y1) and (x2, y2).\n * @param {number} x1 X1.\n * @param {number} y1 Y1.\n * @param {number} x2 X2.\n * @param {number} y2 Y2.\n * @return {number} Squared distance.\n */\nexport function squaredDistance(x1, y1, x2, y2) {\n  const dx = x2 - x1;\n  const dy = y2 - y1;\n  return dx * dx + dy * dy;\n}\n\n\n/**\n * Solves system of linear equations using Gaussian elimination method.\n *\n * @param {Array.<Array.<number>>} mat Augmented matrix (n x n + 1 column)\n *                                     in row-major order.\n * @return {Array.<number>} The resulting vector.\n */\nexport function solveLinearSystem(mat) {\n  const n = mat.length;\n\n  for (let i = 0; i < n; i++) {\n    // Find max in the i-th column (ignoring i - 1 first rows)\n    let maxRow = i;\n    let maxEl = Math.abs(mat[i][i]);\n    for (let r = i + 1; r < n; r++) {\n      const absValue = Math.abs(mat[r][i]);\n      if (absValue > maxEl) {\n        maxEl = absValue;\n        maxRow = r;\n      }\n    }\n\n    if (maxEl === 0) {\n      return null; // matrix is singular\n    }\n\n    // Swap max row with i-th (current) row\n    const tmp = mat[maxRow];\n    mat[maxRow] = mat[i];\n    mat[i] = tmp;\n\n    // Subtract the i-th row to make all the remaining rows 0 in the i-th column\n    for (let j = i + 1; j < n; j++) {\n      const coef = -mat[j][i] / mat[i][i];\n      for (let k = i; k < n + 1; k++) {\n        if (i == k) {\n          mat[j][k] = 0;\n        } else {\n          mat[j][k] += coef * mat[i][k];\n        }\n      }\n    }\n  }\n\n  // Solve Ax=b for upper triangular matrix A (mat)\n  const x = new Array(n);\n  for (let l = n - 1; l >= 0; l--) {\n    x[l] = mat[l][n] / mat[l][l];\n    for (let m = l - 1; m >= 0; m--) {\n      mat[m][n] -= mat[m][l] * x[l];\n    }\n  }\n  return x;\n}\n\n\n/**\n * Converts radians to to degrees.\n *\n * @param {number} angleInRadians Angle in radians.\n * @return {number} Angle in degrees.\n */\nexport function toDegrees(angleInRadians) {\n  return angleInRadians * 180 / Math.PI;\n}\n\n\n/**\n * Converts degrees to radians.\n *\n * @param {number} angleInDegrees Angle in degrees.\n * @return {number} Angle in radians.\n */\nexport function toRadians(angleInDegrees) {\n  return angleInDegrees * Math.PI / 180;\n}\n\n/**\n * Returns the modulo of a / b, depending on the sign of b.\n *\n * @param {number} a Dividend.\n * @param {number} b Divisor.\n * @return {number} Modulo.\n */\nexport function modulo(a, b) {\n  const r = a % b;\n  return r * b < 0 ? r + b : r;\n}\n\n/**\n * Calculates the linearly interpolated value of x between a and b.\n *\n * @param {number} a Number\n * @param {number} b Number\n * @param {number} x Value to be interpolated.\n * @return {number} Interpolated value.\n */\nexport function lerp(a, b, x) {\n  return a + x * (b - a);\n}\n","/**\n * @module ol/geom/GeometryType\n */\n\n/**\n * The geometry type. One of `'Point'`, `'LineString'`, `'LinearRing'`,\n * `'Polygon'`, `'MultiPoint'`, `'MultiLineString'`, `'MultiPolygon'`,\n * `'GeometryCollection'`, `'Circle'`.\n * @enum {string}\n */\nexport default {\n  POINT: 'Point',\n  LINE_STRING: 'LineString',\n  LINEAR_RING: 'LinearRing',\n  POLYGON: 'Polygon',\n  MULTI_POINT: 'MultiPoint',\n  MULTI_LINE_STRING: 'MultiLineString',\n  MULTI_POLYGON: 'MultiPolygon',\n  GEOMETRY_COLLECTION: 'GeometryCollection',\n  CIRCLE: 'Circle'\n};\n","/**\n * @license\n * Latitude/longitude spherical geodesy formulae taken from\n * http://www.movable-type.co.uk/scripts/latlong.html\n * Licensed under CC-BY-3.0.\n */\n\n/**\n * @module ol/sphere\n */\nimport {toRadians, toDegrees} from './math.js';\nimport GeometryType from './geom/GeometryType.js';\n\n\n/**\n * Object literal with options for the {@link getLength} or {@link getArea}\n * functions.\n * @typedef {Object} SphereMetricOptions\n * @property {module:ol/proj~ProjectionLike} [projection='EPSG:3857']\n * Projection of the  geometry.  By default, the geometry is assumed to be in\n * Web Mercator.\n * @property {number} [radius=6371008.8] Sphere radius.  By default, the radius of the\n * earth is used (Clarke 1866 Authalic Sphere).\n */\n\n\n/**\n * The mean Earth radius (1/3 * (2a + b)) for the WGS84 ellipsoid.\n * https://en.wikipedia.org/wiki/Earth_radius#Mean_radius\n * @type {number}\n */\nexport const DEFAULT_RADIUS = 6371008.8;\n\n\n/**\n * Get the great circle distance (in meters) between two geographic coordinates.\n * @param {Array} c1 Starting coordinate.\n * @param {Array} c2 Ending coordinate.\n * @param {number=} opt_radius The sphere radius to use.  Defaults to the Earth's\n *     mean radius using the WGS84 ellipsoid.\n * @return {number} The great circle distance between the points (in meters).\n * @api\n */\nexport function getDistance(c1, c2, opt_radius) {\n  const radius = opt_radius || DEFAULT_RADIUS;\n  const lat1 = toRadians(c1[1]);\n  const lat2 = toRadians(c2[1]);\n  const deltaLatBy2 = (lat2 - lat1) / 2;\n  const deltaLonBy2 = toRadians(c2[0] - c1[0]) / 2;\n  const a = Math.sin(deltaLatBy2) * Math.sin(deltaLatBy2) +\n      Math.sin(deltaLonBy2) * Math.sin(deltaLonBy2) *\n      Math.cos(lat1) * Math.cos(lat2);\n  return 2 * radius * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n}\n\n\n/**\n * Get the cumulative great circle length of linestring coordinates (geographic).\n * @param {Array} coordinates Linestring coordinates.\n * @param {number} radius The sphere radius to use.\n * @return {number} The length (in meters).\n */\nfunction getLengthInternal(coordinates, radius) {\n  let length = 0;\n  for (let i = 0, ii = coordinates.length; i < ii - 1; ++i) {\n    length += getDistance(coordinates[i], coordinates[i + 1], radius);\n  }\n  return length;\n}\n\n\n/**\n * Get the spherical length of a geometry.  This length is the sum of the\n * great circle distances between coordinates.  For polygons, the length is\n * the sum of all rings.  For points, the length is zero.  For multi-part\n * geometries, the length is the sum of the length of each part.\n * @param {module:ol/geom/Geometry} geometry A geometry.\n * @param {module:ol/sphere~SphereMetricOptions=} opt_options Options for the\n * length calculation.  By default, geometries are assumed to be in 'EPSG:3857'.\n * You can change this by providing a `projection` option.\n * @return {number} The spherical length (in meters).\n * @api\n */\nexport function getLength(geometry, opt_options) {\n  const options = opt_options || {};\n  const radius = options.radius || DEFAULT_RADIUS;\n  const projection = options.projection || 'EPSG:3857';\n  const type = geometry.getType();\n  if (type !== GeometryType.GEOMETRY_COLLECTION) {\n    geometry = geometry.clone().transform(projection, 'EPSG:4326');\n  }\n  let length = 0;\n  let coordinates, coords, i, ii, j, jj;\n  switch (type) {\n    case GeometryType.POINT:\n    case GeometryType.MULTI_POINT: {\n      break;\n    }\n    case GeometryType.LINE_STRING:\n    case GeometryType.LINEAR_RING: {\n      coordinates = /** @type {module:ol/geom/SimpleGeometry} */ (geometry).getCoordinates();\n      length = getLengthInternal(coordinates, radius);\n      break;\n    }\n    case GeometryType.MULTI_LINE_STRING:\n    case GeometryType.POLYGON: {\n      coordinates = /** @type {module:ol/geom/SimpleGeometry} */ (geometry).getCoordinates();\n      for (i = 0, ii = coordinates.length; i < ii; ++i) {\n        length += getLengthInternal(coordinates[i], radius);\n      }\n      break;\n    }\n    case GeometryType.MULTI_POLYGON: {\n      coordinates = /** @type {module:ol/geom/SimpleGeometry} */ (geometry).getCoordinates();\n      for (i = 0, ii = coordinates.length; i < ii; ++i) {\n        coords = coordinates[i];\n        for (j = 0, jj = coords.length; j < jj; ++j) {\n          length += getLengthInternal(coords[j], radius);\n        }\n      }\n      break;\n    }\n    case GeometryType.GEOMETRY_COLLECTION: {\n      const geometries = /** @type {module:ol/geom/GeometryCollection} */ (geometry).getGeometries();\n      for (i = 0, ii = geometries.length; i < ii; ++i) {\n        length += getLength(geometries[i], opt_options);\n      }\n      break;\n    }\n    default: {\n      throw new Error('Unsupported geometry type: ' + type);\n    }\n  }\n  return length;\n}\n\n\n/**\n * Returns the spherical area for a list of coordinates.\n *\n * [Reference](https://trs-new.jpl.nasa.gov/handle/2014/40409)\n * Robert. G. Chamberlain and William H. Duquette, \"Some Algorithms for\n * Polygons on a Sphere\", JPL Publication 07-03, Jet Propulsion\n * Laboratory, Pasadena, CA, June 2007\n *\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates List of coordinates of a linear\n * ring. If the ring is oriented clockwise, the area will be positive,\n * otherwise it will be negative.\n * @param {number} radius The sphere radius.\n * @return {number} Area (in square meters).\n */\nfunction getAreaInternal(coordinates, radius) {\n  let area = 0;\n  const len = coordinates.length;\n  let x1 = coordinates[len - 1][0];\n  let y1 = coordinates[len - 1][1];\n  for (let i = 0; i < len; i++) {\n    const x2 = coordinates[i][0];\n    const y2 = coordinates[i][1];\n    area += toRadians(x2 - x1) *\n        (2 + Math.sin(toRadians(y1)) +\n        Math.sin(toRadians(y2)));\n    x1 = x2;\n    y1 = y2;\n  }\n  return area * radius * radius / 2.0;\n}\n\n\n/**\n * Get the spherical area of a geometry.  This is the area (in meters) assuming\n * that polygon edges are segments of great circles on a sphere.\n * @param {module:ol/geom/Geometry} geometry A geometry.\n * @param {module:ol/sphere~SphereMetricOptions=} opt_options Options for the area\n *     calculation.  By default, geometries are assumed to be in 'EPSG:3857'.\n *     You can change this by providing a `projection` option.\n * @return {number} The spherical area (in square meters).\n * @api\n */\nexport function getArea(geometry, opt_options) {\n  const options = opt_options || {};\n  const radius = options.radius || DEFAULT_RADIUS;\n  const projection = options.projection || 'EPSG:3857';\n  const type = geometry.getType();\n  if (type !== GeometryType.GEOMETRY_COLLECTION) {\n    geometry = geometry.clone().transform(projection, 'EPSG:4326');\n  }\n  let area = 0;\n  let coordinates, coords, i, ii, j, jj;\n  switch (type) {\n    case GeometryType.POINT:\n    case GeometryType.MULTI_POINT:\n    case GeometryType.LINE_STRING:\n    case GeometryType.MULTI_LINE_STRING:\n    case GeometryType.LINEAR_RING: {\n      break;\n    }\n    case GeometryType.POLYGON: {\n      coordinates = /** @type {module:ol/geom/Polygon} */ (geometry).getCoordinates();\n      area = Math.abs(getAreaInternal(coordinates[0], radius));\n      for (i = 1, ii = coordinates.length; i < ii; ++i) {\n        area -= Math.abs(getAreaInternal(coordinates[i], radius));\n      }\n      break;\n    }\n    case GeometryType.MULTI_POLYGON: {\n      coordinates = /** @type {module:ol/geom/SimpleGeometry} */ (geometry).getCoordinates();\n      for (i = 0, ii = coordinates.length; i < ii; ++i) {\n        coords = coordinates[i];\n        area += Math.abs(getAreaInternal(coords[0], radius));\n        for (j = 1, jj = coords.length; j < jj; ++j) {\n          area -= Math.abs(getAreaInternal(coords[j], radius));\n        }\n      }\n      break;\n    }\n    case GeometryType.GEOMETRY_COLLECTION: {\n      const geometries = /** @type {module:ol/geom/GeometryCollection} */ (geometry).getGeometries();\n      for (i = 0, ii = geometries.length; i < ii; ++i) {\n        area += getArea(geometries[i], opt_options);\n      }\n      break;\n    }\n    default: {\n      throw new Error('Unsupported geometry type: ' + type);\n    }\n  }\n  return area;\n}\n\n\n/**\n * Returns the coordinate at the given distance and bearing from `c1`.\n *\n * @param {module:ol/coordinate~Coordinate} c1 The origin point (`[lon, lat]` in degrees).\n * @param {number} distance The great-circle distance between the origin\n *     point and the target point.\n * @param {number} bearing The bearing (in radians).\n * @param {number=} opt_radius The sphere radius to use.  Defaults to the Earth's\n *     mean radius using the WGS84 ellipsoid.\n * @return {module:ol/coordinate~Coordinate} The target point.\n */\nexport function offset(c1, distance, bearing, opt_radius) {\n  const radius = opt_radius || DEFAULT_RADIUS;\n  const lat1 = toRadians(c1[1]);\n  const lon1 = toRadians(c1[0]);\n  const dByR = distance / radius;\n  const lat = Math.asin(\n    Math.sin(lat1) * Math.cos(dByR) +\n      Math.cos(lat1) * Math.sin(dByR) * Math.cos(bearing));\n  const lon = lon1 + Math.atan2(\n    Math.sin(bearing) * Math.sin(dByR) * Math.cos(lat1),\n    Math.cos(dByR) - Math.sin(lat1) * Math.sin(lat));\n  return [toDegrees(lon), toDegrees(lat)];\n}\n","/**\n * @module ol/proj/Units\n */\n\n/**\n * Projection units: `'degrees'`, `'ft'`, `'m'`, `'pixels'`, `'tile-pixels'` or\n * `'us-ft'`.\n * @enum {string}\n */\nconst Units = {\n  DEGREES: 'degrees',\n  FEET: 'ft',\n  METERS: 'm',\n  PIXELS: 'pixels',\n  TILE_PIXELS: 'tile-pixels',\n  USFEET: 'us-ft'\n};\n\n\n/**\n * Meters per unit lookup table.\n * @const\n * @type {Object.<module:ol/proj/Units, number>}\n * @api\n */\nexport const METERS_PER_UNIT = {};\n// use the radius of the Normal sphere\nMETERS_PER_UNIT[Units.DEGREES] = 2 * Math.PI * 6370997 / 360;\nMETERS_PER_UNIT[Units.FEET] = 0.3048;\nMETERS_PER_UNIT[Units.METERS] = 1;\nMETERS_PER_UNIT[Units.USFEET] = 1200 / 3937;\n\nexport default Units;\n","/**\n * @module ol/proj/Projection\n */\nimport {METERS_PER_UNIT} from '../proj/Units.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} code The SRS identifier code, e.g. `EPSG:4326`.\n * @property {module:ol/proj/Units|string} [units] Units. Required unless a\n * proj4 projection is defined for `code`.\n * @property {module:ol/extent~Extent} [extent] The validity extent for the SRS.\n * @property {string} [axisOrientation='enu'] The axis orientation as specified in Proj4.\n * @property {boolean} [global=false] Whether the projection is valid for the whole globe.\n * @property {number} [metersPerUnit] The meters per unit for the SRS.\n * If not provided, the `units` are used to get the meters per unit from the {@link module:ol/proj/Units~METERS_PER_UNIT}\n * lookup table.\n * @property {module:ol/extent~Extent} [worldExtent] The world extent for the SRS.\n * @property {function(number, module:ol/coordinate~Coordinate):number} [getPointResolution]\n * Function to determine resolution at a point. The function is called with a\n * `{number}` view resolution and an `{module:ol/coordinate~Coordinate}` as arguments, and returns\n * the `{number}` resolution at the passed coordinate. If this is `undefined`,\n * the default {@link module:ol/proj#getPointResolution} function will be used.\n */\n\n\n/**\n * @classdesc\n * Projection definition class. One of these is created for each projection\n * supported in the application and stored in the {@link module:ol/proj} namespace.\n * You can use these in applications, but this is not required, as API params\n * and options use {@link module:ol/proj~ProjectionLike} which means the simple string\n * code will suffice.\n *\n * You can use {@link module:ol/proj~get} to retrieve the object for a particular\n * projection.\n *\n * The library includes definitions for `EPSG:4326` and `EPSG:3857`, together\n * with the following aliases:\n * * `EPSG:4326`: CRS:84, urn:ogc:def:crs:EPSG:6.6:4326,\n *     urn:ogc:def:crs:OGC:1.3:CRS84, urn:ogc:def:crs:OGC:2:84,\n *     http://www.opengis.net/gml/srs/epsg.xml#4326,\n *     urn:x-ogc:def:crs:EPSG:4326\n * * `EPSG:3857`: EPSG:102100, EPSG:102113, EPSG:900913,\n *     urn:ogc:def:crs:EPSG:6.18:3:3857,\n *     http://www.opengis.net/gml/srs/epsg.xml#3857\n *\n * If you use proj4js, aliases can be added using `proj4.defs()`; see\n * [documentation](https://github.com/proj4js/proj4js). To set an alternative\n * namespace for proj4, use {@link module:ol/proj~setProj4}.\n *\n * @constructor\n * @param {module:ol/proj/Projection~Options} options Projection options.\n * @struct\n * @api\n */\nconst Projection = function(options) {\n  /**\n   * @private\n   * @type {string}\n   */\n  this.code_ = options.code;\n\n  /**\n   * Units of projected coordinates. When set to `TILE_PIXELS`, a\n   * `this.extent_` and `this.worldExtent_` must be configured properly for each\n   * tile.\n   * @private\n   * @type {module:ol/proj/Units}\n   */\n  this.units_ = /** @type {module:ol/proj/Units} */ (options.units);\n\n  /**\n   * Validity extent of the projection in projected coordinates. For projections\n   * with `TILE_PIXELS` units, this is the extent of the tile in\n   * tile pixel space.\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent_ = options.extent !== undefined ? options.extent : null;\n\n  /**\n   * Extent of the world in EPSG:4326. For projections with\n   * `TILE_PIXELS` units, this is the extent of the tile in\n   * projected coordinate space.\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.worldExtent_ = options.worldExtent !== undefined ?\n    options.worldExtent : null;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.axisOrientation_ = options.axisOrientation !== undefined ?\n    options.axisOrientation : 'enu';\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.global_ = options.global !== undefined ? options.global : false;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.canWrapX_ = !!(this.global_ && this.extent_);\n\n  /**\n   * @private\n   * @type {function(number, module:ol/coordinate~Coordinate):number|undefined}\n   */\n  this.getPointResolutionFunc_ = options.getPointResolution;\n\n  /**\n   * @private\n   * @type {module:ol/tilegrid/TileGrid}\n   */\n  this.defaultTileGrid_ = null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.metersPerUnit_ = options.metersPerUnit;\n};\n\n\n/**\n * @return {boolean} The projection is suitable for wrapping the x-axis\n */\nProjection.prototype.canWrapX = function() {\n  return this.canWrapX_;\n};\n\n\n/**\n * Get the code for this projection, e.g. 'EPSG:4326'.\n * @return {string} Code.\n * @api\n */\nProjection.prototype.getCode = function() {\n  return this.code_;\n};\n\n\n/**\n * Get the validity extent for this projection.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nProjection.prototype.getExtent = function() {\n  return this.extent_;\n};\n\n\n/**\n * Get the units of this projection.\n * @return {module:ol/proj/Units} Units.\n * @api\n */\nProjection.prototype.getUnits = function() {\n  return this.units_;\n};\n\n\n/**\n * Get the amount of meters per unit of this projection.  If the projection is\n * not configured with `metersPerUnit` or a units identifier, the return is\n * `undefined`.\n * @return {number|undefined} Meters.\n * @api\n */\nProjection.prototype.getMetersPerUnit = function() {\n  return this.metersPerUnit_ || METERS_PER_UNIT[this.units_];\n};\n\n\n/**\n * Get the world extent for this projection.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nProjection.prototype.getWorldExtent = function() {\n  return this.worldExtent_;\n};\n\n\n/**\n * Get the axis orientation of this projection.\n * Example values are:\n * enu - the default easting, northing, elevation.\n * neu - northing, easting, up - useful for \"lat/long\" geographic coordinates,\n *     or south orientated transverse mercator.\n * wnu - westing, northing, up - some planetary coordinate systems have\n *     \"west positive\" coordinate systems\n * @return {string} Axis orientation.\n * @api\n */\nProjection.prototype.getAxisOrientation = function() {\n  return this.axisOrientation_;\n};\n\n\n/**\n * Is this projection a global projection which spans the whole world?\n * @return {boolean} Whether the projection is global.\n * @api\n */\nProjection.prototype.isGlobal = function() {\n  return this.global_;\n};\n\n\n/**\n* Set if the projection is a global projection which spans the whole world\n* @param {boolean} global Whether the projection is global.\n* @api\n*/\nProjection.prototype.setGlobal = function(global) {\n  this.global_ = global;\n  this.canWrapX_ = !!(global && this.extent_);\n};\n\n\n/**\n * @return {module:ol/tilegrid/TileGrid} The default tile grid.\n */\nProjection.prototype.getDefaultTileGrid = function() {\n  return this.defaultTileGrid_;\n};\n\n\n/**\n * @param {module:ol/tilegrid/TileGrid} tileGrid The default tile grid.\n */\nProjection.prototype.setDefaultTileGrid = function(tileGrid) {\n  this.defaultTileGrid_ = tileGrid;\n};\n\n\n/**\n * Set the validity extent for this projection.\n * @param {module:ol/extent~Extent} extent Extent.\n * @api\n */\nProjection.prototype.setExtent = function(extent) {\n  this.extent_ = extent;\n  this.canWrapX_ = !!(this.global_ && extent);\n};\n\n\n/**\n * Set the world extent for this projection.\n * @param {module:ol/extent~Extent} worldExtent World extent\n *     [minlon, minlat, maxlon, maxlat].\n * @api\n */\nProjection.prototype.setWorldExtent = function(worldExtent) {\n  this.worldExtent_ = worldExtent;\n};\n\n\n/**\n * Set the getPointResolution function (see {@link module:ol/proj~getPointResolution}\n * for this projection.\n * @param {function(number, module:ol/coordinate~Coordinate):number} func Function\n * @api\n */\nProjection.prototype.setGetPointResolution = function(func) {\n  this.getPointResolutionFunc_ = func;\n};\n\n\n/**\n * Get the custom point resolution function for this projection (if set).\n * @return {function(number, module:ol/coordinate~Coordinate):number|undefined} The custom point\n * resolution function (if set).\n */\nProjection.prototype.getPointResolutionFunc = function() {\n  return this.getPointResolutionFunc_;\n};\nexport default Projection;\n","/**\n * @module ol/proj/epsg3857\n */\nimport {inherits} from '../util.js';\nimport {cosh} from '../math.js';\nimport Projection from '../proj/Projection.js';\nimport Units from '../proj/Units.js';\n\n\n/**\n * Radius of WGS84 sphere\n *\n * @const\n * @type {number}\n */\nexport const RADIUS = 6378137;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const HALF_SIZE = Math.PI * RADIUS;\n\n\n/**\n * @const\n * @type {module:ol/extent~Extent}\n */\nexport const EXTENT = [\n  -HALF_SIZE, -HALF_SIZE,\n  HALF_SIZE, HALF_SIZE\n];\n\n\n/**\n * @const\n * @type {module:ol/extent~Extent}\n */\nexport const WORLD_EXTENT = [-180, -85, 180, 85];\n\n\n/**\n * @classdesc\n * Projection object for web/spherical Mercator (EPSG:3857).\n *\n * @constructor\n * @extends {module:ol/proj/Projection}\n * @param {string} code Code.\n */\nfunction EPSG3857Projection(code) {\n  Projection.call(this, {\n    code: code,\n    units: Units.METERS,\n    extent: EXTENT,\n    global: true,\n    worldExtent: WORLD_EXTENT,\n    getPointResolution: function(resolution, point) {\n      return resolution / cosh(point[1] / RADIUS);\n    }\n  });\n}\ninherits(EPSG3857Projection, Projection);\n\n\n/**\n * Projections equal to EPSG:3857.\n *\n * @const\n * @type {Array.<module:ol/proj/Projection>}\n */\nexport const PROJECTIONS = [\n  new EPSG3857Projection('EPSG:3857'),\n  new EPSG3857Projection('EPSG:102100'),\n  new EPSG3857Projection('EPSG:102113'),\n  new EPSG3857Projection('EPSG:900913'),\n  new EPSG3857Projection('urn:ogc:def:crs:EPSG:6.18:3:3857'),\n  new EPSG3857Projection('urn:ogc:def:crs:EPSG::3857'),\n  new EPSG3857Projection('http://www.opengis.net/gml/srs/epsg.xml#3857')\n];\n\n\n/**\n * Transformation from EPSG:4326 to EPSG:3857.\n *\n * @param {Array.<number>} input Input array of coordinate values.\n * @param {Array.<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension (default is `2`).\n * @return {Array.<number>} Output array of coordinate values.\n */\nexport function fromEPSG4326(input, opt_output, opt_dimension) {\n  const length = input.length;\n  const dimension = opt_dimension > 1 ? opt_dimension : 2;\n  let output = opt_output;\n  if (output === undefined) {\n    if (dimension > 2) {\n      // preserve values beyond second dimension\n      output = input.slice();\n    } else {\n      output = new Array(length);\n    }\n  }\n  const halfSize = HALF_SIZE;\n  for (let i = 0; i < length; i += dimension) {\n    output[i] = halfSize * input[i] / 180;\n    let y = RADIUS *\n        Math.log(Math.tan(Math.PI * (input[i + 1] + 90) / 360));\n    if (y > halfSize) {\n      y = halfSize;\n    } else if (y < -halfSize) {\n      y = -halfSize;\n    }\n    output[i + 1] = y;\n  }\n  return output;\n}\n\n\n/**\n * Transformation from EPSG:3857 to EPSG:4326.\n *\n * @param {Array.<number>} input Input array of coordinate values.\n * @param {Array.<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension (default is `2`).\n * @return {Array.<number>} Output array of coordinate values.\n */\nexport function toEPSG4326(input, opt_output, opt_dimension) {\n  const length = input.length;\n  const dimension = opt_dimension > 1 ? opt_dimension : 2;\n  let output = opt_output;\n  if (output === undefined) {\n    if (dimension > 2) {\n      // preserve values beyond second dimension\n      output = input.slice();\n    } else {\n      output = new Array(length);\n    }\n  }\n  for (let i = 0; i < length; i += dimension) {\n    output[i] = 180 * input[i] / HALF_SIZE;\n    output[i + 1] = 360 * Math.atan(\n      Math.exp(input[i + 1] / RADIUS)) / Math.PI - 90;\n  }\n  return output;\n}\n","/**\n * @module ol/proj/epsg4326\n */\nimport {inherits} from '../util.js';\nimport Projection from '../proj/Projection.js';\nimport Units from '../proj/Units.js';\n\n\n/**\n * Semi-major radius of the WGS84 ellipsoid.\n *\n * @const\n * @type {number}\n */\nexport const RADIUS = 6378137;\n\n\n/**\n * Extent of the EPSG:4326 projection which is the whole world.\n *\n * @const\n * @type {module:ol/extent~Extent}\n */\nexport const EXTENT = [-180, -90, 180, 90];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const METERS_PER_UNIT = Math.PI * RADIUS / 180;\n\n\n/**\n * @classdesc\n * Projection object for WGS84 geographic coordinates (EPSG:4326).\n *\n * Note that OpenLayers does not strictly comply with the EPSG definition.\n * The EPSG registry defines 4326 as a CRS for Latitude,Longitude (y,x).\n * OpenLayers treats EPSG:4326 as a pseudo-projection, with x,y coordinates.\n *\n * @constructor\n * @extends {module:ol/proj/Projection}\n * @param {string} code Code.\n * @param {string=} opt_axisOrientation Axis orientation.\n */\nfunction EPSG4326Projection(code, opt_axisOrientation) {\n  Projection.call(this, {\n    code: code,\n    units: Units.DEGREES,\n    extent: EXTENT,\n    axisOrientation: opt_axisOrientation,\n    global: true,\n    metersPerUnit: METERS_PER_UNIT,\n    worldExtent: EXTENT\n  });\n}\ninherits(EPSG4326Projection, Projection);\n\n\n/**\n * Projections equal to EPSG:4326.\n *\n * @const\n * @type {Array.<module:ol/proj/Projection>}\n */\nexport const PROJECTIONS = [\n  new EPSG4326Projection('CRS:84'),\n  new EPSG4326Projection('EPSG:4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:EPSG::4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:EPSG:6.6:4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:OGC:1.3:CRS84'),\n  new EPSG4326Projection('urn:ogc:def:crs:OGC:2:84'),\n  new EPSG4326Projection('http://www.opengis.net/gml/srs/epsg.xml#4326', 'neu'),\n  new EPSG4326Projection('urn:x-ogc:def:crs:EPSG:4326', 'neu')\n];\n","/**\n * @module ol/proj/projections\n */\n\n\n/**\n * @type {Object.<string, module:ol/proj/Projection>}\n */\nlet cache = {};\n\n\n/**\n * Clear the projections cache.\n */\nexport function clear() {\n  cache = {};\n}\n\n\n/**\n * Get a cached projection by code.\n * @param {string} code The code for the projection.\n * @return {module:ol/proj/Projection} The projection (if cached).\n */\nexport function get(code) {\n  return cache[code] || null;\n}\n\n\n/**\n * Add a projection to the cache.\n * @param {string} code The projection code.\n * @param {module:ol/proj/Projection} projection The projection to cache.\n */\nexport function add(code, projection) {\n  cache[code] = projection;\n}\n","/**\n * @module ol/proj/transforms\n */\nimport {isEmpty} from '../obj.js';\n\n\n/**\n * @private\n * @type {!Object.<string, Object.<string, module:ol/proj~TransformFunction>>}\n */\nlet transforms = {};\n\n\n/**\n * Clear the transform cache.\n */\nexport function clear() {\n  transforms = {};\n}\n\n\n/**\n * Registers a conversion function to convert coordinates from the source\n * projection to the destination projection.\n *\n * @param {module:ol/proj/Projection} source Source.\n * @param {module:ol/proj/Projection} destination Destination.\n * @param {module:ol/proj~TransformFunction} transformFn Transform.\n */\nexport function add(source, destination, transformFn) {\n  const sourceCode = source.getCode();\n  const destinationCode = destination.getCode();\n  if (!(sourceCode in transforms)) {\n    transforms[sourceCode] = {};\n  }\n  transforms[sourceCode][destinationCode] = transformFn;\n}\n\n\n/**\n * Unregisters the conversion function to convert coordinates from the source\n * projection to the destination projection.  This method is used to clean up\n * cached transforms during testing.\n *\n * @param {module:ol/proj/Projection} source Source projection.\n * @param {module:ol/proj/Projection} destination Destination projection.\n * @return {module:ol/proj~TransformFunction} transformFn The unregistered transform.\n */\nexport function remove(source, destination) {\n  const sourceCode = source.getCode();\n  const destinationCode = destination.getCode();\n  const transform = transforms[sourceCode][destinationCode];\n  delete transforms[sourceCode][destinationCode];\n  if (isEmpty(transforms[sourceCode])) {\n    delete transforms[sourceCode];\n  }\n  return transform;\n}\n\n\n/**\n * Get a transform given a source code and a destination code.\n * @param {string} sourceCode The code for the source projection.\n * @param {string} destinationCode The code for the destination projection.\n * @return {module:ol/proj~TransformFunction|undefined} The transform function (if found).\n */\nexport function get(sourceCode, destinationCode) {\n  let transform;\n  if (sourceCode in transforms && destinationCode in transforms[sourceCode]) {\n    transform = transforms[sourceCode][destinationCode];\n  }\n  return transform;\n}\n","/**\n * @module ol/proj\n */\n\n/**\n * The ol/proj module stores:\n * * a list of {@link module:ol/proj/Projection}\n * objects, one for each projection supported by the application\n * * a list of transform functions needed to convert coordinates in one projection\n * into another.\n *\n * The static functions are the methods used to maintain these.\n * Each transform function can handle not only simple coordinate pairs, but also\n * large arrays of coordinates such as vector geometries.\n *\n * When loaded, the library adds projection objects for EPSG:4326 (WGS84\n * geographic coordinates) and EPSG:3857 (Web or Spherical Mercator, as used\n * for example by Bing Maps or OpenStreetMap), together with the relevant\n * transform functions.\n *\n * Additional transforms may be added by using the {@link http://proj4js.org/}\n * library (version 2.2 or later). You can use the full build supplied by\n * Proj4js, or create a custom build to support those projections you need; see\n * the Proj4js website for how to do this. You also need the Proj4js definitions\n * for the required projections. These definitions can be obtained from\n * {@link https://epsg.io/}, and are a JS function, so can be loaded in a script\n * tag (as in the examples) or pasted into your application.\n *\n * After all required projection definitions are added to proj4's registry (by\n * using `proj4.defs()`), simply call `register(proj4)` from the `ol/proj/proj4`\n * package. Existing transforms are not changed by this function. See\n * examples/wms-image-custom-proj for an example of this.\n *\n * Additional projection definitions can be registered with `proj4.defs()` any\n * time. Just make sure to call `register(proj4)` again; for example, with user-supplied data where you don't\n * know in advance what projections are needed, you can initially load minimal\n * support and then load whichever are requested.\n *\n * Note that Proj4js does not support projection extents. If you want to add\n * one for creating default tile grids, you can add it after the Projection\n * object has been created with `setExtent`, for example,\n * `get('EPSG:1234').setExtent(extent)`.\n *\n * In addition to Proj4js support, any transform functions can be added with\n * {@link module:ol/proj~addCoordinateTransforms}. To use this, you must first create\n * a {@link module:ol/proj/Projection} object for the new projection and add it with\n * {@link module:ol/proj~addProjection}. You can then add the forward and inverse\n * functions with {@link module:ol/proj~addCoordinateTransforms}. See\n * examples/wms-custom-proj for an example of this.\n *\n * Note that if no transforms are needed and you only need to define the\n * projection, just add a {@link module:ol/proj/Projection} with\n * {@link module:ol/proj~addProjection}. See examples/wms-no-proj for an example of\n * this.\n */\nimport {getDistance} from './sphere.js';\nimport {applyTransform} from './extent.js';\nimport {modulo} from './math.js';\nimport {toEPSG4326, fromEPSG4326, PROJECTIONS as EPSG3857_PROJECTIONS} from './proj/epsg3857.js';\nimport {PROJECTIONS as EPSG4326_PROJECTIONS} from './proj/epsg4326.js';\nimport Projection from './proj/Projection.js';\nimport Units, {METERS_PER_UNIT} from './proj/Units.js';\nimport * as projections from './proj/projections.js';\nimport {add as addTransformFunc, clear as clearTransformFuncs, get as getTransformFunc} from './proj/transforms.js';\n\n\n/**\n * A projection as {@link module:ol/proj/Projection}, SRS identifier\n * string or undefined.\n * @typedef {module:ol/proj/Projection|string|undefined} ProjectionLike\n * @api\n */\n\n\n/**\n * A transform function accepts an array of input coordinate values, an optional\n * output array, and an optional dimension (default should be 2).  The function\n * transforms the input coordinate values, populates the output array, and\n * returns the output array.\n *\n * @typedef {function(Array.<number>, Array.<number>=, number=): Array.<number>} TransformFunction\n * @api\n */\n\n\nexport {METERS_PER_UNIT};\n\n\n/**\n * @param {Array.<number>} input Input coordinate array.\n * @param {Array.<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension.\n * @return {Array.<number>} Output coordinate array (new array, same coordinate\n *     values).\n */\nexport function cloneTransform(input, opt_output, opt_dimension) {\n  let output;\n  if (opt_output !== undefined) {\n    for (let i = 0, ii = input.length; i < ii; ++i) {\n      opt_output[i] = input[i];\n    }\n    output = opt_output;\n  } else {\n    output = input.slice();\n  }\n  return output;\n}\n\n\n/**\n * @param {Array.<number>} input Input coordinate array.\n * @param {Array.<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension.\n * @return {Array.<number>} Input coordinate array (same array as input).\n */\nexport function identityTransform(input, opt_output, opt_dimension) {\n  if (opt_output !== undefined && input !== opt_output) {\n    for (let i = 0, ii = input.length; i < ii; ++i) {\n      opt_output[i] = input[i];\n    }\n    input = opt_output;\n  }\n  return input;\n}\n\n\n/**\n * Add a Projection object to the list of supported projections that can be\n * looked up by their code.\n *\n * @param {module:ol/proj/Projection} projection Projection instance.\n * @api\n */\nexport function addProjection(projection) {\n  projections.add(projection.getCode(), projection);\n  addTransformFunc(projection, projection, cloneTransform);\n}\n\n\n/**\n * @param {Array.<module:ol/proj/Projection>} projections Projections.\n */\nexport function addProjections(projections) {\n  projections.forEach(addProjection);\n}\n\n\n/**\n * Fetches a Projection object for the code specified.\n *\n * @param {module:ol/proj~ProjectionLike} projectionLike Either a code string which is\n *     a combination of authority and identifier such as \"EPSG:4326\", or an\n *     existing projection object, or undefined.\n * @return {module:ol/proj/Projection} Projection object, or null if not in list.\n * @api\n */\nexport function get(projectionLike) {\n  let projection = null;\n  if (projectionLike instanceof Projection) {\n    projection = projectionLike;\n  } else if (typeof projectionLike === 'string') {\n    const code = projectionLike;\n    projection = projections.get(code);\n  }\n  return projection;\n}\n\n\n/**\n * Get the resolution of the point in degrees or distance units.\n * For projections with degrees as the unit this will simply return the\n * provided resolution. For other projections the point resolution is\n * by default estimated by transforming the 'point' pixel to EPSG:4326,\n * measuring its width and height on the normal sphere,\n * and taking the average of the width and height.\n * A custom function can be provided for a specific projection, either\n * by setting the `getPointResolution` option in the\n * {@link module:ol/proj/Projection~Projection} constructor or by using\n * {@link module:ol/proj/Projection~Projection#setGetPointResolution} to change an existing\n * projection object.\n * @param {module:ol/proj~ProjectionLike} projection The projection.\n * @param {number} resolution Nominal resolution in projection units.\n * @param {module:ol/coordinate~Coordinate} point Point to find adjusted resolution at.\n * @param {module:ol/proj/Units=} opt_units Units to get the point resolution in.\n * Default is the projection's units.\n * @return {number} Point resolution.\n * @api\n */\nexport function getPointResolution(projection, resolution, point, opt_units) {\n  projection = get(projection);\n  let pointResolution;\n  const getter = projection.getPointResolutionFunc();\n  if (getter) {\n    pointResolution = getter(resolution, point);\n  } else {\n    const units = projection.getUnits();\n    if (units == Units.DEGREES && !opt_units || opt_units == Units.DEGREES) {\n      pointResolution = resolution;\n    } else {\n      // Estimate point resolution by transforming the center pixel to EPSG:4326,\n      // measuring its width and height on the normal sphere, and taking the\n      // average of the width and height.\n      const toEPSG4326 = getTransformFromProjections(projection, get('EPSG:4326'));\n      let vertices = [\n        point[0] - resolution / 2, point[1],\n        point[0] + resolution / 2, point[1],\n        point[0], point[1] - resolution / 2,\n        point[0], point[1] + resolution / 2\n      ];\n      vertices = toEPSG4326(vertices, vertices, 2);\n      const width = getDistance(vertices.slice(0, 2), vertices.slice(2, 4));\n      const height = getDistance(vertices.slice(4, 6), vertices.slice(6, 8));\n      pointResolution = (width + height) / 2;\n      const metersPerUnit = opt_units ?\n        METERS_PER_UNIT[opt_units] :\n        projection.getMetersPerUnit();\n      if (metersPerUnit !== undefined) {\n        pointResolution /= metersPerUnit;\n      }\n    }\n  }\n  return pointResolution;\n}\n\n\n/**\n * Registers transformation functions that don't alter coordinates. Those allow\n * to transform between projections with equal meaning.\n *\n * @param {Array.<module:ol/proj/Projection>} projections Projections.\n * @api\n */\nexport function addEquivalentProjections(projections) {\n  addProjections(projections);\n  projections.forEach(function(source) {\n    projections.forEach(function(destination) {\n      if (source !== destination) {\n        addTransformFunc(source, destination, cloneTransform);\n      }\n    });\n  });\n}\n\n\n/**\n * Registers transformation functions to convert coordinates in any projection\n * in projection1 to any projection in projection2.\n *\n * @param {Array.<module:ol/proj/Projection>} projections1 Projections with equal\n *     meaning.\n * @param {Array.<module:ol/proj/Projection>} projections2 Projections with equal\n *     meaning.\n * @param {module:ol/proj~TransformFunction} forwardTransform Transformation from any\n *   projection in projection1 to any projection in projection2.\n * @param {module:ol/proj~TransformFunction} inverseTransform Transform from any projection\n *   in projection2 to any projection in projection1..\n */\nexport function addEquivalentTransforms(projections1, projections2, forwardTransform, inverseTransform) {\n  projections1.forEach(function(projection1) {\n    projections2.forEach(function(projection2) {\n      addTransformFunc(projection1, projection2, forwardTransform);\n      addTransformFunc(projection2, projection1, inverseTransform);\n    });\n  });\n}\n\n\n/**\n * Clear all cached projections and transforms.\n */\nexport function clearAllProjections() {\n  projections.clear();\n  clearTransformFuncs();\n}\n\n\n/**\n * @param {module:ol/proj/Projection|string|undefined} projection Projection.\n * @param {string} defaultCode Default code.\n * @return {module:ol/proj/Projection} Projection.\n */\nexport function createProjection(projection, defaultCode) {\n  if (!projection) {\n    return get(defaultCode);\n  } else if (typeof projection === 'string') {\n    return get(projection);\n  } else {\n    return (\n      /** @type {module:ol/proj/Projection} */ (projection)\n    );\n  }\n}\n\n\n/**\n * Creates a {@link module:ol/proj~TransformFunction} from a simple 2D coordinate transform\n * function.\n * @param {function(module:ol/coordinate~Coordinate): module:ol/coordinate~Coordinate} coordTransform Coordinate\n *     transform.\n * @return {module:ol/proj~TransformFunction} Transform function.\n */\nexport function createTransformFromCoordinateTransform(coordTransform) {\n  return (\n    /**\n     * @param {Array.<number>} input Input.\n     * @param {Array.<number>=} opt_output Output.\n     * @param {number=} opt_dimension Dimension.\n     * @return {Array.<number>} Output.\n     */\n    function(input, opt_output, opt_dimension) {\n      const length = input.length;\n      const dimension = opt_dimension !== undefined ? opt_dimension : 2;\n      const output = opt_output !== undefined ? opt_output : new Array(length);\n      for (let i = 0; i < length; i += dimension) {\n        const point = coordTransform([input[i], input[i + 1]]);\n        output[i] = point[0];\n        output[i + 1] = point[1];\n        for (let j = dimension - 1; j >= 2; --j) {\n          output[i + j] = input[i + j];\n        }\n      }\n      return output;\n    });\n}\n\n\n/**\n * Registers coordinate transform functions to convert coordinates between the\n * source projection and the destination projection.\n * The forward and inverse functions convert coordinate pairs; this function\n * converts these into the functions used internally which also handle\n * extents and coordinate arrays.\n *\n * @param {module:ol/proj~ProjectionLike} source Source projection.\n * @param {module:ol/proj~ProjectionLike} destination Destination projection.\n * @param {function(module:ol/coordinate~Coordinate): module:ol/coordinate~Coordinate} forward The forward transform\n *     function (that is, from the source projection to the destination\n *     projection) that takes a {@link module:ol/coordinate~Coordinate} as argument and returns\n *     the transformed {@link module:ol/coordinate~Coordinate}.\n * @param {function(module:ol/coordinate~Coordinate): module:ol/coordinate~Coordinate} inverse The inverse transform\n *     function (that is, from the destination projection to the source\n *     projection) that takes a {@link module:ol/coordinate~Coordinate} as argument and returns\n *     the transformed {@link module:ol/coordinate~Coordinate}.\n * @api\n */\nexport function addCoordinateTransforms(source, destination, forward, inverse) {\n  const sourceProj = get(source);\n  const destProj = get(destination);\n  addTransformFunc(sourceProj, destProj, createTransformFromCoordinateTransform(forward));\n  addTransformFunc(destProj, sourceProj, createTransformFromCoordinateTransform(inverse));\n}\n\n\n/**\n * Transforms a coordinate from longitude/latitude to a different projection.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate as longitude and latitude, i.e.\n *     an array with longitude as 1st and latitude as 2nd element.\n * @param {module:ol/proj~ProjectionLike=} opt_projection Target projection. The\n *     default is Web Mercator, i.e. 'EPSG:3857'.\n * @return {module:ol/coordinate~Coordinate} Coordinate projected to the target projection.\n * @api\n */\nexport function fromLonLat(coordinate, opt_projection) {\n  return transform(coordinate, 'EPSG:4326',\n    opt_projection !== undefined ? opt_projection : 'EPSG:3857');\n}\n\n\n/**\n * Transforms a coordinate to longitude/latitude.\n * @param {module:ol/coordinate~Coordinate} coordinate Projected coordinate.\n * @param {module:ol/proj~ProjectionLike=} opt_projection Projection of the coordinate.\n *     The default is Web Mercator, i.e. 'EPSG:3857'.\n * @return {module:ol/coordinate~Coordinate} Coordinate as longitude and latitude, i.e. an array\n *     with longitude as 1st and latitude as 2nd element.\n * @api\n */\nexport function toLonLat(coordinate, opt_projection) {\n  const lonLat = transform(coordinate,\n    opt_projection !== undefined ? opt_projection : 'EPSG:3857', 'EPSG:4326');\n  const lon = lonLat[0];\n  if (lon < -180 || lon > 180) {\n    lonLat[0] = modulo(lon + 180, 360) - 180;\n  }\n  return lonLat;\n}\n\n\n/**\n * Checks if two projections are the same, that is every coordinate in one\n * projection does represent the same geographic point as the same coordinate in\n * the other projection.\n *\n * @param {module:ol/proj/Projection} projection1 Projection 1.\n * @param {module:ol/proj/Projection} projection2 Projection 2.\n * @return {boolean} Equivalent.\n * @api\n */\nexport function equivalent(projection1, projection2) {\n  if (projection1 === projection2) {\n    return true;\n  }\n  const equalUnits = projection1.getUnits() === projection2.getUnits();\n  if (projection1.getCode() === projection2.getCode()) {\n    return equalUnits;\n  } else {\n    const transformFunc = getTransformFromProjections(projection1, projection2);\n    return transformFunc === cloneTransform && equalUnits;\n  }\n}\n\n\n/**\n * Searches in the list of transform functions for the function for converting\n * coordinates from the source projection to the destination projection.\n *\n * @param {module:ol/proj/Projection} sourceProjection Source Projection object.\n * @param {module:ol/proj/Projection} destinationProjection Destination Projection\n *     object.\n * @return {module:ol/proj~TransformFunction} Transform function.\n */\nexport function getTransformFromProjections(sourceProjection, destinationProjection) {\n  const sourceCode = sourceProjection.getCode();\n  const destinationCode = destinationProjection.getCode();\n  let transformFunc = getTransformFunc(sourceCode, destinationCode);\n  if (!transformFunc) {\n    transformFunc = identityTransform;\n  }\n  return transformFunc;\n}\n\n\n/**\n * Given the projection-like objects, searches for a transformation\n * function to convert a coordinates array from the source projection to the\n * destination projection.\n *\n * @param {module:ol/proj~ProjectionLike} source Source.\n * @param {module:ol/proj~ProjectionLike} destination Destination.\n * @return {module:ol/proj~TransformFunction} Transform function.\n * @api\n */\nexport function getTransform(source, destination) {\n  const sourceProjection = get(source);\n  const destinationProjection = get(destination);\n  return getTransformFromProjections(sourceProjection, destinationProjection);\n}\n\n\n/**\n * Transforms a coordinate from source projection to destination projection.\n * This returns a new coordinate (and does not modify the original).\n *\n * See {@link module:ol/proj~transformExtent} for extent transformation.\n * See the transform method of {@link module:ol/geom/Geometry~Geometry} and its\n * subclasses for geometry transforms.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/proj~ProjectionLike} source Source projection-like.\n * @param {module:ol/proj~ProjectionLike} destination Destination projection-like.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n * @api\n */\nexport function transform(coordinate, source, destination) {\n  const transformFunc = getTransform(source, destination);\n  return transformFunc(coordinate, undefined, coordinate.length);\n}\n\n\n/**\n * Transforms an extent from source projection to destination projection.  This\n * returns a new extent (and does not modify the original).\n *\n * @param {module:ol/extent~Extent} extent The extent to transform.\n * @param {module:ol/proj~ProjectionLike} source Source projection-like.\n * @param {module:ol/proj~ProjectionLike} destination Destination projection-like.\n * @return {module:ol/extent~Extent} The transformed extent.\n * @api\n */\nexport function transformExtent(extent, source, destination) {\n  const transformFunc = getTransform(source, destination);\n  return applyTransform(extent, transformFunc);\n}\n\n\n/**\n * Transforms the given point to the destination projection.\n *\n * @param {module:ol/coordinate~Coordinate} point Point.\n * @param {module:ol/proj/Projection} sourceProjection Source projection.\n * @param {module:ol/proj/Projection} destinationProjection Destination projection.\n * @return {module:ol/coordinate~Coordinate} Point.\n */\nexport function transformWithProjections(point, sourceProjection, destinationProjection) {\n  const transformFunc = getTransformFromProjections(sourceProjection, destinationProjection);\n  return transformFunc(point);\n}\n\n/**\n * Add transforms to and from EPSG:4326 and EPSG:3857.  This function is called\n * by when this module is executed and should only need to be called again after\n * `clearAllProjections()` is called (e.g. in tests).\n */\nexport function addCommon() {\n  // Add transformations that don't alter coordinates to convert within set of\n  // projections with equal meaning.\n  addEquivalentProjections(EPSG3857_PROJECTIONS);\n  addEquivalentProjections(EPSG4326_PROJECTIONS);\n  // Add transformations to convert EPSG:4326 like coordinates to EPSG:3857 like\n  // coordinates and back.\n  addEquivalentTransforms(EPSG4326_PROJECTIONS, EPSG3857_PROJECTIONS, fromEPSG4326, toEPSG4326);\n}\n\naddCommon();\n","/**\n * @module ol/transform\n */\nimport {assert} from './asserts.js';\n\n\n/**\n * An array representing an affine 2d transformation for use with\n * {@link module:ol/transform} functions. The array has 6 elements.\n * @typedef {!Array.<number>} Transform\n */\n\n\n/**\n * Collection of affine 2d transformation functions. The functions work on an\n * array of 6 elements. The element order is compatible with the [SVGMatrix\n * interface](https://developer.mozilla.org/en-US/docs/Web/API/SVGMatrix) and is\n * a subset (elements a to f) of a 3×3 matrix:\n * ```\n * [ a c e ]\n * [ b d f ]\n * [ 0 0 1 ]\n * ```\n */\n\n\n/**\n * @private\n * @type {module:ol/transform~Transform}\n */\nconst tmp_ = new Array(6);\n\n\n/**\n * Create an identity transform.\n * @return {!module:ol/transform~Transform} Identity transform.\n */\nexport function create() {\n  return [1, 0, 0, 1, 0, 0];\n}\n\n\n/**\n * Resets the given transform to an identity transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @return {!module:ol/transform~Transform} Transform.\n */\nexport function reset(transform) {\n  return set(transform, 1, 0, 0, 1, 0, 0);\n}\n\n\n/**\n * Multiply the underlying matrices of two transforms and return the result in\n * the first transform.\n * @param {!module:ol/transform~Transform} transform1 Transform parameters of matrix 1.\n * @param {!module:ol/transform~Transform} transform2 Transform parameters of matrix 2.\n * @return {!module:ol/transform~Transform} transform1 multiplied with transform2.\n */\nexport function multiply(transform1, transform2) {\n  const a1 = transform1[0];\n  const b1 = transform1[1];\n  const c1 = transform1[2];\n  const d1 = transform1[3];\n  const e1 = transform1[4];\n  const f1 = transform1[5];\n  const a2 = transform2[0];\n  const b2 = transform2[1];\n  const c2 = transform2[2];\n  const d2 = transform2[3];\n  const e2 = transform2[4];\n  const f2 = transform2[5];\n\n  transform1[0] = a1 * a2 + c1 * b2;\n  transform1[1] = b1 * a2 + d1 * b2;\n  transform1[2] = a1 * c2 + c1 * d2;\n  transform1[3] = b1 * c2 + d1 * d2;\n  transform1[4] = a1 * e2 + c1 * f2 + e1;\n  transform1[5] = b1 * e2 + d1 * f2 + f1;\n\n  return transform1;\n}\n\n/**\n * Set the transform components a-f on a given transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @param {number} a The a component of the transform.\n * @param {number} b The b component of the transform.\n * @param {number} c The c component of the transform.\n * @param {number} d The d component of the transform.\n * @param {number} e The e component of the transform.\n * @param {number} f The f component of the transform.\n * @return {!module:ol/transform~Transform} Matrix with transform applied.\n */\nexport function set(transform, a, b, c, d, e, f) {\n  transform[0] = a;\n  transform[1] = b;\n  transform[2] = c;\n  transform[3] = d;\n  transform[4] = e;\n  transform[5] = f;\n  return transform;\n}\n\n\n/**\n * Set transform on one matrix from another matrix.\n * @param {!module:ol/transform~Transform} transform1 Matrix to set transform to.\n * @param {!module:ol/transform~Transform} transform2 Matrix to set transform from.\n * @return {!module:ol/transform~Transform} transform1 with transform from transform2 applied.\n */\nexport function setFromArray(transform1, transform2) {\n  transform1[0] = transform2[0];\n  transform1[1] = transform2[1];\n  transform1[2] = transform2[2];\n  transform1[3] = transform2[3];\n  transform1[4] = transform2[4];\n  transform1[5] = transform2[5];\n  return transform1;\n}\n\n\n/**\n * Transforms the given coordinate with the given transform returning the\n * resulting, transformed coordinate. The coordinate will be modified in-place.\n *\n * @param {module:ol/transform~Transform} transform The transformation.\n * @param {module:ol/coordinate~Coordinate|module:ol~Pixel} coordinate The coordinate to transform.\n * @return {module:ol/coordinate~Coordinate|module:ol~Pixel} return coordinate so that operations can be\n *     chained together.\n */\nexport function apply(transform, coordinate) {\n  const x = coordinate[0];\n  const y = coordinate[1];\n  coordinate[0] = transform[0] * x + transform[2] * y + transform[4];\n  coordinate[1] = transform[1] * x + transform[3] * y + transform[5];\n  return coordinate;\n}\n\n\n/**\n * Applies rotation to the given transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @param {number} angle Angle in radians.\n * @return {!module:ol/transform~Transform} The rotated transform.\n */\nexport function rotate(transform, angle) {\n  const cos = Math.cos(angle);\n  const sin = Math.sin(angle);\n  return multiply(transform, set(tmp_, cos, sin, -sin, cos, 0, 0));\n}\n\n\n/**\n * Applies scale to a given transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @param {number} x Scale factor x.\n * @param {number} y Scale factor y.\n * @return {!module:ol/transform~Transform} The scaled transform.\n */\nexport function scale(transform, x, y) {\n  return multiply(transform, set(tmp_, x, 0, 0, y, 0, 0));\n}\n\n\n/**\n * Applies translation to the given transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @param {number} dx Translation x.\n * @param {number} dy Translation y.\n * @return {!module:ol/transform~Transform} The translated transform.\n */\nexport function translate(transform, dx, dy) {\n  return multiply(transform, set(tmp_, 1, 0, 0, 1, dx, dy));\n}\n\n\n/**\n * Creates a composite transform given an initial translation, scale, rotation, and\n * final translation (in that order only, not commutative).\n * @param {!module:ol/transform~Transform} transform The transform (will be modified in place).\n * @param {number} dx1 Initial translation x.\n * @param {number} dy1 Initial translation y.\n * @param {number} sx Scale factor x.\n * @param {number} sy Scale factor y.\n * @param {number} angle Rotation (in counter-clockwise radians).\n * @param {number} dx2 Final translation x.\n * @param {number} dy2 Final translation y.\n * @return {!module:ol/transform~Transform} The composite transform.\n */\nexport function compose(transform, dx1, dy1, sx, sy, angle, dx2, dy2) {\n  const sin = Math.sin(angle);\n  const cos = Math.cos(angle);\n  transform[0] = sx * cos;\n  transform[1] = sy * sin;\n  transform[2] = -sx * sin;\n  transform[3] = sy * cos;\n  transform[4] = dx2 * sx * cos - dy2 * sx * sin + dx1;\n  transform[5] = dx2 * sy * sin + dy2 * sy * cos + dy1;\n  return transform;\n}\n\n\n/**\n * Invert the given transform.\n * @param {!module:ol/transform~Transform} transform Transform.\n * @return {!module:ol/transform~Transform} Inverse of the transform.\n */\nexport function invert(transform) {\n  const det = determinant(transform);\n  assert(det !== 0, 32); // Transformation matrix cannot be inverted\n\n  const a = transform[0];\n  const b = transform[1];\n  const c = transform[2];\n  const d = transform[3];\n  const e = transform[4];\n  const f = transform[5];\n\n  transform[0] = d / det;\n  transform[1] = -b / det;\n  transform[2] = -c / det;\n  transform[3] = a / det;\n  transform[4] = (c * f - d * e) / det;\n  transform[5] = -(a * f - b * e) / det;\n\n  return transform;\n}\n\n\n/**\n * Returns the determinant of the given matrix.\n * @param {!module:ol/transform~Transform} mat Matrix.\n * @return {number} Determinant.\n */\nexport function determinant(mat) {\n  return mat[0] * mat[3] - mat[1] * mat[2];\n}\n","/**\n * @module ol/geom/Geometry\n */\nimport {inherits} from '../util.js';\nimport BaseObject from '../Object.js';\nimport {createEmpty, getHeight, returnOrUpdate} from '../extent.js';\nimport {FALSE} from '../functions.js';\nimport {transform2D} from '../geom/flat/transform.js';\nimport {get as getProjection, getTransform} from '../proj.js';\nimport Units from '../proj/Units.js';\nimport {create as createTransform, compose as composeTransform} from '../transform.js';\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for vector geometries.\n *\n * To get notified of changes to the geometry, register a listener for the\n * generic `change` event on your geometry instance.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/Object}\n * @api\n */\nconst Geometry = function() {\n\n  BaseObject.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent_ = createEmpty();\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.extentRevision_ = -1;\n\n  /**\n   * @protected\n   * @type {Object.<string, module:ol/geom/Geometry>}\n   */\n  this.simplifiedGeometryCache = {};\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.simplifiedGeometryMaxMinSquaredTolerance = 0;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.simplifiedGeometryRevision = 0;\n\n};\n\ninherits(Geometry, BaseObject);\n\n\n/**\n * @type {module:ol/transform~Transform}\n */\nconst tmpTransform = createTransform();\n\n\n/**\n * Make a complete copy of the geometry.\n * @abstract\n * @return {!module:ol/geom/Geometry} Clone.\n */\nGeometry.prototype.clone = function() {};\n\n\n/**\n * @abstract\n * @param {number} x X.\n * @param {number} y Y.\n * @param {module:ol/coordinate~Coordinate} closestPoint Closest point.\n * @param {number} minSquaredDistance Minimum squared distance.\n * @return {number} Minimum squared distance.\n */\nGeometry.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {};\n\n\n/**\n * Return the closest point of the geometry to the passed point as\n * {@link module:ol/coordinate~Coordinate coordinate}.\n * @param {module:ol/coordinate~Coordinate} point Point.\n * @param {module:ol/coordinate~Coordinate=} opt_closestPoint Closest point.\n * @return {module:ol/coordinate~Coordinate} Closest point.\n * @api\n */\nGeometry.prototype.getClosestPoint = function(point, opt_closestPoint) {\n  const closestPoint = opt_closestPoint ? opt_closestPoint : [NaN, NaN];\n  this.closestPointXY(point[0], point[1], closestPoint, Infinity);\n  return closestPoint;\n};\n\n\n/**\n * Returns true if this geometry includes the specified coordinate. If the\n * coordinate is on the boundary of the geometry, returns false.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @return {boolean} Contains coordinate.\n * @api\n */\nGeometry.prototype.intersectsCoordinate = function(coordinate) {\n  return this.containsXY(coordinate[0], coordinate[1]);\n};\n\n\n/**\n * @abstract\n * @param {module:ol/extent~Extent} extent Extent.\n * @protected\n * @return {module:ol/extent~Extent} extent Extent.\n */\nGeometry.prototype.computeExtent = function(extent) {};\n\n\n/**\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nGeometry.prototype.containsXY = FALSE;\n\n\n/**\n * Get the extent of the geometry.\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} extent Extent.\n * @api\n */\nGeometry.prototype.getExtent = function(opt_extent) {\n  if (this.extentRevision_ != this.getRevision()) {\n    this.extent_ = this.computeExtent(this.extent_);\n    this.extentRevision_ = this.getRevision();\n  }\n  return returnOrUpdate(this.extent_, opt_extent);\n};\n\n\n/**\n * Rotate the geometry around a given coordinate. This modifies the geometry\n * coordinates in place.\n * @abstract\n * @param {number} angle Rotation angle in radians.\n * @param {module:ol/coordinate~Coordinate} anchor The rotation center.\n * @api\n */\nGeometry.prototype.rotate = function(angle, anchor) {};\n\n\n/**\n * Scale the geometry (with an optional origin).  This modifies the geometry\n * coordinates in place.\n * @abstract\n * @param {number} sx The scaling factor in the x-direction.\n * @param {number=} opt_sy The scaling factor in the y-direction (defaults to\n *     sx).\n * @param {module:ol/coordinate~Coordinate=} opt_anchor The scale origin (defaults to the center\n *     of the geometry extent).\n * @api\n */\nGeometry.prototype.scale = function(sx, opt_sy, opt_anchor) {};\n\n\n/**\n * Create a simplified version of this geometry.  For linestrings, this uses\n * the the {@link\n * https://en.wikipedia.org/wiki/Ramer-Douglas-Peucker_algorithm\n * Douglas Peucker} algorithm.  For polygons, a quantization-based\n * simplification is used to preserve topology.\n * @function\n * @param {number} tolerance The tolerance distance for simplification.\n * @return {module:ol/geom/Geometry} A new, simplified version of the original\n *     geometry.\n * @api\n */\nGeometry.prototype.simplify = function(tolerance) {\n  return this.getSimplifiedGeometry(tolerance * tolerance);\n};\n\n\n/**\n * Create a simplified version of this geometry using the Douglas Peucker\n * algorithm.\n * @see https://en.wikipedia.org/wiki/Ramer-Douglas-Peucker_algorithm\n * @abstract\n * @param {number} squaredTolerance Squared tolerance.\n * @return {module:ol/geom/Geometry} Simplified geometry.\n */\nGeometry.prototype.getSimplifiedGeometry = function(squaredTolerance) {};\n\n\n/**\n * Get the type of this geometry.\n * @abstract\n * @return {module:ol/geom/GeometryType} Geometry type.\n */\nGeometry.prototype.getType = function() {};\n\n\n/**\n * Apply a transform function to each coordinate of the geometry.\n * The geometry is modified in place.\n * If you do not want the geometry modified in place, first `clone()` it and\n * then use this function on the clone.\n * @abstract\n * @param {module:ol/proj~TransformFunction} transformFn Transform.\n */\nGeometry.prototype.applyTransform = function(transformFn) {};\n\n\n/**\n * Test if the geometry and the passed extent intersect.\n * @abstract\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} `true` if the geometry and the extent intersect.\n */\nGeometry.prototype.intersectsExtent = function(extent) {};\n\n\n/**\n * Translate the geometry.  This modifies the geometry coordinates in place.  If\n * instead you want a new geometry, first `clone()` this geometry.\n * @abstract\n * @param {number} deltaX Delta X.\n * @param {number} deltaY Delta Y.\n */\nGeometry.prototype.translate = function(deltaX, deltaY) {};\n\n\n/**\n * Transform each coordinate of the geometry from one coordinate reference\n * system to another. The geometry is modified in place.\n * For example, a line will be transformed to a line and a circle to a circle.\n * If you do not want the geometry modified in place, first `clone()` it and\n * then use this function on the clone.\n *\n * @param {module:ol/proj~ProjectionLike} source The current projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @param {module:ol/proj~ProjectionLike} destination The desired projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @return {module:ol/geom/Geometry} This geometry.  Note that original geometry is\n *     modified in place.\n * @api\n */\nGeometry.prototype.transform = function(source, destination) {\n  source = getProjection(source);\n  const transformFn = source.getUnits() == Units.TILE_PIXELS ?\n    function(inCoordinates, outCoordinates, stride) {\n      const pixelExtent = source.getExtent();\n      const projectedExtent = source.getWorldExtent();\n      const scale = getHeight(projectedExtent) / getHeight(pixelExtent);\n      composeTransform(tmpTransform,\n        projectedExtent[0], projectedExtent[3],\n        scale, -scale, 0,\n        0, 0);\n      transform2D(inCoordinates, 0, inCoordinates.length, stride,\n        tmpTransform, outCoordinates);\n      return getTransform(source, destination)(inCoordinates, outCoordinates, stride);\n    } :\n    getTransform(source, destination);\n  this.applyTransform(transformFn);\n  return this;\n};\nexport default Geometry;\n","/**\n * @module ol/color\n */\nimport {assert} from './asserts.js';\nimport {clamp} from './math.js';\n\n\n/**\n * A color represented as a short array [red, green, blue, alpha].\n * red, green, and blue should be integers in the range 0..255 inclusive.\n * alpha should be a float in the range 0..1 inclusive. If no alpha value is\n * given then `1` will be used.\n * @typedef {Array.<number>} Color\n * @api\n */\n\n\n/**\n * This RegExp matches # followed by 3, 4, 6, or 8 hex digits.\n * @const\n * @type {RegExp}\n * @private\n */\nconst HEX_COLOR_RE_ = /^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i;\n\n\n/**\n * Regular expression for matching potential named color style strings.\n * @const\n * @type {RegExp}\n * @private\n */\nconst NAMED_COLOR_RE_ = /^([a-z]*)$/i;\n\n\n/**\n * Return the color as an rgba string.\n * @param {module:ol/color~Color|string} color Color.\n * @return {string} Rgba string.\n * @api\n */\nexport function asString(color) {\n  if (typeof color === 'string') {\n    return color;\n  } else {\n    return toString(color);\n  }\n}\n\n/**\n * Return named color as an rgba string.\n * @param {string} color Named color.\n * @return {string} Rgb string.\n */\nfunction fromNamed(color) {\n  const el = document.createElement('div');\n  el.style.color = color;\n  if (el.style.color !== '') {\n    document.body.appendChild(el);\n    const rgb = getComputedStyle(el).color;\n    document.body.removeChild(el);\n    return rgb;\n  } else {\n    return '';\n  }\n}\n\n\n/**\n * @param {string} s String.\n * @return {module:ol/color~Color} Color.\n */\nexport const fromString = (\n  function() {\n\n    // We maintain a small cache of parsed strings.  To provide cheap LRU-like\n    // semantics, whenever the cache grows too large we simply delete an\n    // arbitrary 25% of the entries.\n\n    /**\n     * @const\n     * @type {number}\n     */\n    const MAX_CACHE_SIZE = 1024;\n\n    /**\n     * @type {Object.<string, module:ol/color~Color>}\n     */\n    const cache = {};\n\n    /**\n     * @type {number}\n     */\n    let cacheSize = 0;\n\n    return (\n      /**\n       * @param {string} s String.\n       * @return {module:ol/color~Color} Color.\n       */\n      function(s) {\n        let color;\n        if (cache.hasOwnProperty(s)) {\n          color = cache[s];\n        } else {\n          if (cacheSize >= MAX_CACHE_SIZE) {\n            let i = 0;\n            for (const key in cache) {\n              if ((i++ & 3) === 0) {\n                delete cache[key];\n                --cacheSize;\n              }\n            }\n          }\n          color = fromStringInternal_(s);\n          cache[s] = color;\n          ++cacheSize;\n        }\n        return color;\n      }\n    );\n\n  })();\n\n/**\n * Return the color as an array. This function maintains a cache of calculated\n * arrays which means the result should not be modified.\n * @param {module:ol/color~Color|string} color Color.\n * @return {module:ol/color~Color} Color.\n * @api\n */\nexport function asArray(color) {\n  if (Array.isArray(color)) {\n    return color;\n  } else {\n    return fromString(/** @type {string} */ (color));\n  }\n}\n\n/**\n * @param {string} s String.\n * @private\n * @return {module:ol/color~Color} Color.\n */\nfunction fromStringInternal_(s) {\n  let r, g, b, a, color;\n\n  if (NAMED_COLOR_RE_.exec(s)) {\n    s = fromNamed(s);\n  }\n\n  if (HEX_COLOR_RE_.exec(s)) { // hex\n    const n = s.length - 1; // number of hex digits\n    let d; // number of digits per channel\n    if (n <= 4) {\n      d = 1;\n    } else {\n      d = 2;\n    }\n    const hasAlpha = n === 4 || n === 8;\n    r = parseInt(s.substr(1 + 0 * d, d), 16);\n    g = parseInt(s.substr(1 + 1 * d, d), 16);\n    b = parseInt(s.substr(1 + 2 * d, d), 16);\n    if (hasAlpha) {\n      a = parseInt(s.substr(1 + 3 * d, d), 16);\n    } else {\n      a = 255;\n    }\n    if (d == 1) {\n      r = (r << 4) + r;\n      g = (g << 4) + g;\n      b = (b << 4) + b;\n      if (hasAlpha) {\n        a = (a << 4) + a;\n      }\n    }\n    color = [r, g, b, a / 255];\n  } else if (s.indexOf('rgba(') == 0) { // rgba()\n    color = s.slice(5, -1).split(',').map(Number);\n    normalize(color);\n  } else if (s.indexOf('rgb(') == 0) { // rgb()\n    color = s.slice(4, -1).split(',').map(Number);\n    color.push(1);\n    normalize(color);\n  } else {\n    assert(false, 14); // Invalid color\n  }\n  return (\n    /** @type {module:ol/color~Color} */ (color)\n  );\n}\n\n\n/**\n * TODO this function is only used in the test, we probably shouldn't export it\n * @param {module:ol/color~Color} color Color.\n * @return {module:ol/color~Color} Clamped color.\n */\nexport function normalize(color) {\n  color[0] = clamp((color[0] + 0.5) | 0, 0, 255);\n  color[1] = clamp((color[1] + 0.5) | 0, 0, 255);\n  color[2] = clamp((color[2] + 0.5) | 0, 0, 255);\n  color[3] = clamp(color[3], 0, 1);\n  return color;\n}\n\n\n/**\n * @param {module:ol/color~Color} color Color.\n * @return {string} String.\n */\nexport function toString(color) {\n  let r = color[0];\n  if (r != (r | 0)) {\n    r = (r + 0.5) | 0;\n  }\n  let g = color[1];\n  if (g != (g | 0)) {\n    g = (g + 0.5) | 0;\n  }\n  let b = color[2];\n  if (b != (b | 0)) {\n    b = (b + 0.5) | 0;\n  }\n  const a = color[3] === undefined ? 1 : color[3];\n  return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\n}\n","/**\n * @module ol/colorlike\n */\nimport {toString} from './color.js';\n\n\n/**\n * A type accepted by CanvasRenderingContext2D.fillStyle\n * or CanvasRenderingContext2D.strokeStyle.\n * Represents a color, pattern, or gradient. The origin for patterns and\n * gradients as fill style is an increment of 512 css pixels from map coordinate\n * `[0, 0]`. For seamless repeat patterns, width and height of the pattern image\n * must be a factor of two (2, 4, 8, ..., 512).\n *\n * @typedef {string|CanvasPattern|CanvasGradient} ColorLike\n * @api\n */\n\n\n/**\n * @param {module:ol/color~Color|module:ol/colorlike~ColorLike} color Color.\n * @return {module:ol/colorlike~ColorLike} The color as an {@link ol/colorlike~ColorLike}.\n * @api\n */\nexport function asColorLike(color) {\n  if (isColorLike(color)) {\n    return /** @type {string|CanvasPattern|CanvasGradient} */ (color);\n  } else {\n    return toString(/** @type {module:ol/color~Color} */ (color));\n  }\n}\n\n\n/**\n * @param {?} color The value that is potentially an {@link ol/colorlike~ColorLike}.\n * @return {boolean} The color is an {@link ol/colorlike~ColorLike}.\n */\nexport function isColorLike(color) {\n  return (\n    typeof color === 'string' ||\n    color instanceof CanvasPattern ||\n    color instanceof CanvasGradient\n  );\n}\n","/**\n * @module ol/dom\n */\n\n\n/**\n * Create an html canvas element and returns its 2d context.\n * @param {number=} opt_width Canvas width.\n * @param {number=} opt_height Canvas height.\n * @return {CanvasRenderingContext2D} The context.\n */\nexport function createCanvasContext2D(opt_width, opt_height) {\n  const canvas = /** @type {HTMLCanvasElement} */ (document.createElement('CANVAS'));\n  if (opt_width) {\n    canvas.width = opt_width;\n  }\n  if (opt_height) {\n    canvas.height = opt_height;\n  }\n  return /** @type {CanvasRenderingContext2D} */ (canvas.getContext('2d'));\n}\n\n\n/**\n * Get the current computed width for the given element including margin,\n * padding and border.\n * Equivalent to jQuery's `$(el).outerWidth(true)`.\n * @param {!Element} element Element.\n * @return {number} The width.\n */\nexport function outerWidth(element) {\n  let width = element.offsetWidth;\n  const style = getComputedStyle(element);\n  width += parseInt(style.marginLeft, 10) + parseInt(style.marginRight, 10);\n\n  return width;\n}\n\n\n/**\n * Get the current computed height for the given element including margin,\n * padding and border.\n * Equivalent to jQuery's `$(el).outerHeight(true)`.\n * @param {!Element} element Element.\n * @return {number} The height.\n */\nexport function outerHeight(element) {\n  let height = element.offsetHeight;\n  const style = getComputedStyle(element);\n  height += parseInt(style.marginTop, 10) + parseInt(style.marginBottom, 10);\n\n  return height;\n}\n\n/**\n * @param {Node} newNode Node to replace old node\n * @param {Node} oldNode The node to be replaced\n */\nexport function replaceNode(newNode, oldNode) {\n  const parent = oldNode.parentNode;\n  if (parent) {\n    parent.replaceChild(newNode, oldNode);\n  }\n}\n\n/**\n * @param {Node} node The node to remove.\n * @returns {Node} The node that was removed or null.\n */\nexport function removeNode(node) {\n  return node && node.parentNode ? node.parentNode.removeChild(node) : null;\n}\n\n/**\n * @param {Node} node The node to remove the children from.\n */\nexport function removeChildren(node) {\n  while (node.lastChild) {\n    node.removeChild(node.lastChild);\n  }\n}\n","/**\n * @module ol/webgl\n */\n\n\n/**\n * Constants taken from goog.webgl\n */\n\n\n/**\n * @const\n * @type {number}\n */\nexport const ONE = 1;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const SRC_ALPHA = 0x0302;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const COLOR_ATTACHMENT0 = 0x8CE0;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const COLOR_BUFFER_BIT = 0x00004000;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TRIANGLES = 0x0004;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TRIANGLE_STRIP = 0x0005;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const ONE_MINUS_SRC_ALPHA = 0x0303;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const ARRAY_BUFFER = 0x8892;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const ELEMENT_ARRAY_BUFFER = 0x8893;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const STREAM_DRAW = 0x88E0;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const STATIC_DRAW = 0x88E4;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DYNAMIC_DRAW = 0x88E8;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const CULL_FACE = 0x0B44;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const BLEND = 0x0BE2;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const STENCIL_TEST = 0x0B90;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DEPTH_TEST = 0x0B71;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const SCISSOR_TEST = 0x0C11;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const UNSIGNED_BYTE = 0x1401;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const UNSIGNED_SHORT = 0x1403;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const UNSIGNED_INT = 0x1405;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const FLOAT = 0x1406;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const RGBA = 0x1908;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const FRAGMENT_SHADER = 0x8B30;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const VERTEX_SHADER = 0x8B31;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const LINK_STATUS = 0x8B82;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const LINEAR = 0x2601;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE_MAG_FILTER = 0x2800;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE_MIN_FILTER = 0x2801;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE_WRAP_S = 0x2802;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE_WRAP_T = 0x2803;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE_2D = 0x0DE1;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const TEXTURE0 = 0x84C0;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const CLAMP_TO_EDGE = 0x812F;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const COMPILE_STATUS = 0x8B81;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const FRAMEBUFFER = 0x8D40;\n\n\n/** end of goog.webgl constants\n */\n\n\n/**\n * @const\n * @type {Array.<string>}\n */\nconst CONTEXT_IDS = [\n  'experimental-webgl',\n  'webgl',\n  'webkit-3d',\n  'moz-webgl'\n];\n\n\n/**\n * @param {HTMLCanvasElement} canvas Canvas.\n * @param {Object=} opt_attributes Attributes.\n * @return {WebGLRenderingContext} WebGL rendering context.\n */\nexport function getContext(canvas, opt_attributes) {\n  const ii = CONTEXT_IDS.length;\n  for (let i = 0; i < ii; ++i) {\n    try {\n      const context = canvas.getContext(CONTEXT_IDS[i], opt_attributes);\n      if (context) {\n        return /** @type {!WebGLRenderingContext} */ (context);\n      }\n    } catch (e) {\n      // pass\n    }\n  }\n  return null;\n}\n\n\n/**\n * Include debuggable shader sources.  Default is `true`. This should be set to\n * `false` for production builds.\n * @type {boolean}\n */\nexport const DEBUG = true;\n\n\n/**\n * The maximum supported WebGL texture size in pixels. If WebGL is not\n * supported, the value is set to `undefined`.\n * @type {number|undefined}\n */\nlet MAX_TEXTURE_SIZE; // value is set below\n\n\n/**\n * List of supported WebGL extensions.\n * @type {Array.<string>}\n */\nlet EXTENSIONS; // value is set below\n\n\n/**\n * True if both OpenLayers and browser support WebGL.\n * @const ol/has.WEBGL\n * @type {boolean}\n * @api\n */\nlet HAS = false;\n\n//TODO Remove side effects\nif (typeof window !== 'undefined' && 'WebGLRenderingContext' in window) {\n  try {\n    const canvas = /** @type {HTMLCanvasElement} */ (document.createElement('CANVAS'));\n    const gl = getContext(canvas, {failIfMajorPerformanceCaveat: true});\n    if (gl) {\n      HAS = true;\n      MAX_TEXTURE_SIZE = /** @type {number} */ (gl.getParameter(gl.MAX_TEXTURE_SIZE));\n      EXTENSIONS = gl.getSupportedExtensions();\n    }\n  } catch (e) {\n    // pass\n  }\n}\n\nexport {HAS, MAX_TEXTURE_SIZE, EXTENSIONS};\n","/**\n * @module ol/has\n */\n\nconst ua = typeof navigator !== 'undefined' ?\n  navigator.userAgent.toLowerCase() : '';\n\n/**\n * User agent string says we are dealing with Firefox as browser.\n * @type {boolean}\n */\nexport const FIREFOX = ua.indexOf('firefox') !== -1;\n\n/**\n * User agent string says we are dealing with Safari as browser.\n * @type {boolean}\n */\nexport const SAFARI = ua.indexOf('safari') !== -1 && ua.indexOf('chrom') == -1;\n\n/**\n * User agent string says we are dealing with a WebKit engine.\n * @type {boolean}\n */\nexport const WEBKIT = ua.indexOf('webkit') !== -1 && ua.indexOf('edge') == -1;\n\n/**\n * User agent string says we are dealing with a Mac as platform.\n * @type {boolean}\n */\nexport const MAC = ua.indexOf('macintosh') !== -1;\n\n\n/**\n * The ratio between physical pixels and device-independent pixels\n * (dips) on the device (`window.devicePixelRatio`).\n * @const\n * @type {number}\n * @api\n */\nexport const DEVICE_PIXEL_RATIO = window.devicePixelRatio || 1;\n\n\n/**\n * True if the browser's Canvas implementation implements {get,set}LineDash.\n * @type {boolean}\n */\nexport const CANVAS_LINE_DASH = function() {\n  let has = false;\n  try {\n    has = !!document.createElement('CANVAS').getContext('2d').setLineDash;\n  } catch (e) {\n    // pass\n  }\n  return has;\n}();\n\n\n/**\n * Is HTML5 geolocation supported in the current browser?\n * @const\n * @type {boolean}\n * @api\n */\nexport const GEOLOCATION = 'geolocation' in navigator;\n\n\n/**\n * True if browser supports touch events.\n * @const\n * @type {boolean}\n * @api\n */\nexport const TOUCH = 'ontouchstart' in window;\n\n\n/**\n * True if browser supports pointer events.\n * @const\n * @type {boolean}\n */\nexport const POINTER = 'PointerEvent' in window;\n\n\n/**\n * True if browser supports ms pointer events (IE 10).\n * @const\n * @type {boolean}\n */\nexport const MSPOINTER = !!(navigator.msPointerEnabled);\n\n\nexport {HAS as WEBGL} from './webgl.js';\n","/**\n * @module ol/ImageState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  ERROR: 3\n};\n","/**\n * @module ol/css\n */\n\n\n/**\n * The CSS class for hidden feature.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_HIDDEN = 'ol-hidden';\n\n\n/**\n * The CSS class that we'll give the DOM elements to have them selectable.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_SELECTABLE = 'ol-selectable';\n\n\n/**\n * The CSS class that we'll give the DOM elements to have them unselectable.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_UNSELECTABLE = 'ol-unselectable';\n\n\n/**\n * The CSS class for unsupported feature.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_UNSUPPORTED = 'ol-unsupported';\n\n\n/**\n * The CSS class for controls.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_CONTROL = 'ol-control';\n\n\n/**\n * The CSS class that we'll give the DOM elements that are collapsed, i.e.\n * to those elements which usually can be expanded.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_COLLAPSED = 'ol-collapsed';\n\n\n/**\n * Get the list of font families from a font spec.  Note that this doesn't work\n * for font families that have commas in them.\n * @param {string} The CSS font property.\n * @return {Object.<string>} The font families (or null if the input spec is invalid).\n */\nexport const getFontFamilies = (function() {\n  let style;\n  const cache = {};\n  return function(font) {\n    if (!style) {\n      style = document.createElement('div').style;\n    }\n    if (!(font in cache)) {\n      style.font = font;\n      const family = style.fontFamily;\n      style.font = '';\n      if (!family) {\n        return null;\n      }\n      cache[font] = family.split(/,\\s?/);\n    }\n    return cache[font];\n  };\n})();\n","/**\n * @module ol/structs/LRUCache\n */\nimport {inherits} from '../util.js';\nimport {assert} from '../asserts.js';\nimport EventTarget from '../events/EventTarget.js';\nimport EventType from '../events/EventType.js';\n\n\n/**\n * @typedef {Object} Entry\n * @property {string} key_\n * @property {Object} newer\n * @property {Object} older\n * @property {*} value_\n */\n\n\n/**\n * Implements a Least-Recently-Used cache where the keys do not conflict with\n * Object's properties (e.g. 'hasOwnProperty' is not allowed as a key). Expiring\n * items from the cache is the responsibility of the user.\n * @constructor\n * @extends {module:ol/events/EventTarget}\n * @fires module:ol/events/Event~Event\n * @struct\n * @template T\n * @param {number=} opt_highWaterMark High water mark.\n */\nconst LRUCache = function(opt_highWaterMark) {\n\n  EventTarget.call(this);\n\n  /**\n   * @type {number}\n   */\n  this.highWaterMark = opt_highWaterMark !== undefined ? opt_highWaterMark : 2048;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.count_ = 0;\n\n  /**\n   * @private\n   * @type {!Object.<string, module:ol/structs/LRUCache~Entry>}\n   */\n  this.entries_ = {};\n\n  /**\n   * @private\n   * @type {?module:ol/structs/LRUCache~Entry}\n   */\n  this.oldest_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/structs/LRUCache~Entry}\n   */\n  this.newest_ = null;\n\n};\n\ninherits(LRUCache, EventTarget);\n\n\n/**\n * @return {boolean} Can expire cache.\n */\nLRUCache.prototype.canExpireCache = function() {\n  return this.getCount() > this.highWaterMark;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nLRUCache.prototype.clear = function() {\n  this.count_ = 0;\n  this.entries_ = {};\n  this.oldest_ = null;\n  this.newest_ = null;\n  this.dispatchEvent(EventType.CLEAR);\n};\n\n\n/**\n * @param {string} key Key.\n * @return {boolean} Contains key.\n */\nLRUCache.prototype.containsKey = function(key) {\n  return this.entries_.hasOwnProperty(key);\n};\n\n\n/**\n * @param {function(this: S, T, string, module:ol/structs/LRUCache): ?} f The function\n *     to call for every entry from the oldest to the newer. This function takes\n *     3 arguments (the entry value, the entry key and the LRUCache object).\n *     The return value is ignored.\n * @param {S=} opt_this The object to use as `this` in `f`.\n * @template S\n */\nLRUCache.prototype.forEach = function(f, opt_this) {\n  let entry = this.oldest_;\n  while (entry) {\n    f.call(opt_this, entry.value_, entry.key_, this);\n    entry = entry.newer;\n  }\n};\n\n\n/**\n * @param {string} key Key.\n * @return {T} Value.\n */\nLRUCache.prototype.get = function(key) {\n  const entry = this.entries_[key];\n  assert(entry !== undefined,\n    15); // Tried to get a value for a key that does not exist in the cache\n  if (entry === this.newest_) {\n    return entry.value_;\n  } else if (entry === this.oldest_) {\n    this.oldest_ = /** @type {module:ol/structs/LRUCache~Entry} */ (this.oldest_.newer);\n    this.oldest_.older = null;\n  } else {\n    entry.newer.older = entry.older;\n    entry.older.newer = entry.newer;\n  }\n  entry.newer = null;\n  entry.older = this.newest_;\n  this.newest_.newer = entry;\n  this.newest_ = entry;\n  return entry.value_;\n};\n\n\n/**\n * Remove an entry from the cache.\n * @param {string} key The entry key.\n * @return {T} The removed entry.\n */\nLRUCache.prototype.remove = function(key) {\n  const entry = this.entries_[key];\n  assert(entry !== undefined, 15); // Tried to get a value for a key that does not exist in the cache\n  if (entry === this.newest_) {\n    this.newest_ = /** @type {module:ol/structs/LRUCache~Entry} */ (entry.older);\n    if (this.newest_) {\n      this.newest_.newer = null;\n    }\n  } else if (entry === this.oldest_) {\n    this.oldest_ = /** @type {module:ol/structs/LRUCache~Entry} */ (entry.newer);\n    if (this.oldest_) {\n      this.oldest_.older = null;\n    }\n  } else {\n    entry.newer.older = entry.older;\n    entry.older.newer = entry.newer;\n  }\n  delete this.entries_[key];\n  --this.count_;\n  return entry.value_;\n};\n\n\n/**\n * @return {number} Count.\n */\nLRUCache.prototype.getCount = function() {\n  return this.count_;\n};\n\n\n/**\n * @return {Array.<string>} Keys.\n */\nLRUCache.prototype.getKeys = function() {\n  const keys = new Array(this.count_);\n  let i = 0;\n  let entry;\n  for (entry = this.newest_; entry; entry = entry.older) {\n    keys[i++] = entry.key_;\n  }\n  return keys;\n};\n\n\n/**\n * @return {Array.<T>} Values.\n */\nLRUCache.prototype.getValues = function() {\n  const values = new Array(this.count_);\n  let i = 0;\n  let entry;\n  for (entry = this.newest_; entry; entry = entry.older) {\n    values[i++] = entry.value_;\n  }\n  return values;\n};\n\n\n/**\n * @return {T} Last value.\n */\nLRUCache.prototype.peekLast = function() {\n  return this.oldest_.value_;\n};\n\n\n/**\n * @return {string} Last key.\n */\nLRUCache.prototype.peekLastKey = function() {\n  return this.oldest_.key_;\n};\n\n\n/**\n * Get the key of the newest item in the cache.  Throws if the cache is empty.\n * @return {string} The newest key.\n */\nLRUCache.prototype.peekFirstKey = function() {\n  return this.newest_.key_;\n};\n\n\n/**\n * @return {T} value Value.\n */\nLRUCache.prototype.pop = function() {\n  const entry = this.oldest_;\n  delete this.entries_[entry.key_];\n  if (entry.newer) {\n    entry.newer.older = null;\n  }\n  this.oldest_ = /** @type {module:ol/structs/LRUCache~Entry} */ (entry.newer);\n  if (!this.oldest_) {\n    this.newest_ = null;\n  }\n  --this.count_;\n  return entry.value_;\n};\n\n\n/**\n * @param {string} key Key.\n * @param {T} value Value.\n */\nLRUCache.prototype.replace = function(key, value) {\n  this.get(key);  // update `newest_`\n  this.entries_[key].value_ = value;\n};\n\n\n/**\n * @param {string} key Key.\n * @param {T} value Value.\n */\nLRUCache.prototype.set = function(key, value) {\n  assert(!(key in this.entries_),\n    16); // Tried to set a value for a key that is used already\n  const entry = /** @type {module:ol/structs/LRUCache~Entry} */ ({\n    key_: key,\n    newer: null,\n    older: this.newest_,\n    value_: value\n  });\n  if (!this.newest_) {\n    this.oldest_ = entry;\n  } else {\n    this.newest_.newer = entry;\n  }\n  this.newest_ = entry;\n  this.entries_[key] = entry;\n  ++this.count_;\n};\n\n\n/**\n * Set a maximum number of entries for the cache.\n * @param {number} size Cache size.\n * @api\n */\nLRUCache.prototype.setSize = function(size) {\n  this.highWaterMark = size;\n};\n\n\n/**\n * Prune the cache.\n */\nLRUCache.prototype.prune = function() {\n  while (this.canExpireCache()) {\n    this.pop();\n  }\n};\nexport default LRUCache;\n","/**\n * @module ol/render/canvas\n */\nimport {getFontFamilies} from '../css.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {clear} from '../obj.js';\nimport LRUCache from '../structs/LRUCache.js';\nimport {create as createTransform} from '../transform.js';\n\n\n/**\n * @typedef {Object} FillState\n * @property {module:ol/colorlike~ColorLike} fillStyle\n */\n\n\n/**\n * @typedef {Object} FillStrokeState\n * @property {module:ol/colorlike~ColorLike} [currentFillStyle]\n * @property {module:ol/colorlike~ColorLike} [currentStrokeStyle]\n * @property {string} [currentLineCap]\n * @property {Array.<number>} currentLineDash\n * @property {number} [currentLineDashOffset]\n * @property {string} [currentLineJoin]\n * @property {number} [currentLineWidth]\n * @property {number} [currentMiterLimit]\n * @property {number} [lastStroke]\n * @property {module:ol/colorlike~ColorLike} [fillStyle]\n * @property {module:ol/colorlike~ColorLike} [strokeStyle]\n * @property {string} [lineCap]\n * @property {Array.<number>} lineDash\n * @property {number} [lineDashOffset]\n * @property {string} [lineJoin]\n * @property {number} [lineWidth]\n * @property {number} [miterLimit]\n */\n\n\n/**\n * @typedef {Object} StrokeState\n * @property {string} lineCap\n * @property {Array.<number>} lineDash\n * @property {number} lineDashOffset\n * @property {string} lineJoin\n * @property {number} lineWidth\n * @property {number} miterLimit\n * @property {module:ol/colorlike~ColorLike} strokeStyle\n */\n\n\n/**\n * @typedef {Object} TextState\n * @property {string} font\n * @property {string} [textAlign]\n * @property {string} textBaseline\n */\n\n\n/**\n * Container for decluttered replay instructions that need to be rendered or\n * omitted together, i.e. when styles render both an image and text, or for the\n * characters that form text along lines. The basic elements of this array are\n * `[minX, minY, maxX, maxY, count]`, where the first four entries are the\n * rendered extent of the group in pixel space. `count` is the number of styles\n * in the group, i.e. 2 when an image and a text are grouped, or 1 otherwise.\n * In addition to these four elements, declutter instruction arrays (i.e. the\n * arguments to {@link module:ol/render/canvas~drawImage} are appended to the array.\n * @typedef {Array.<*>} DeclutterGroup\n */\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultFont = '10px sans-serif';\n\n\n/**\n * @const\n * @type {module:ol/color~Color}\n */\nexport const defaultFillStyle = [0, 0, 0, 1];\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultLineCap = 'round';\n\n\n/**\n * @const\n * @type {Array.<number>}\n */\nexport const defaultLineDash = [];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const defaultLineDashOffset = 0;\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultLineJoin = 'round';\n\n\n/**\n * @const\n * @type {number}\n */\nexport const defaultMiterLimit = 10;\n\n\n/**\n * @const\n * @type {module:ol/color~Color}\n */\nexport const defaultStrokeStyle = [0, 0, 0, 1];\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultTextAlign = 'center';\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultTextBaseline = 'middle';\n\n\n/**\n * @const\n * @type {Array.<number>}\n */\nexport const defaultPadding = [0, 0, 0, 0];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const defaultLineWidth = 1;\n\n\n/**\n * The label cache for text rendering. To change the default cache size of 2048\n * entries, use {@link module:ol/structs/LRUCache#setSize}.\n * @type {module:ol/structs/LRUCache.<HTMLCanvasElement>}\n * @api\n */\nexport const labelCache = new LRUCache();\n\n\n/**\n * @type {!Object.<string, number>}\n */\nexport const checkedFonts = {};\n\n\n/**\n * @type {CanvasRenderingContext2D}\n */\nlet measureContext = null;\n\n\n/**\n * @type {!Object.<string, number>}\n */\nexport const textHeights = {};\n\n\n/**\n * Clears the label cache when a font becomes available.\n * @param {string} fontSpec CSS font spec.\n */\nexport const checkFont = (function() {\n  const retries = 60;\n  const checked = checkedFonts;\n  const size = '32px ';\n  const referenceFonts = ['monospace', 'serif'];\n  const len = referenceFonts.length;\n  const text = 'wmytzilWMYTZIL@#/&?$%10\\uF013';\n  let interval, referenceWidth;\n\n  function isAvailable(font) {\n    const context = getMeasureContext();\n    let available = true;\n    for (let i = 0; i < len; ++i) {\n      const referenceFont = referenceFonts[i];\n      context.font = size + referenceFont;\n      referenceWidth = context.measureText(text).width;\n      if (font != referenceFont) {\n        context.font = size + font + ',' + referenceFont;\n        const width = context.measureText(text).width;\n        // If width and referenceWidth are the same, then the fallback was used\n        // instead of the font we wanted, so the font is not available.\n        available = available && width != referenceWidth;\n      }\n    }\n    return available;\n  }\n\n  function check() {\n    let done = true;\n    for (const font in checked) {\n      if (checked[font] < retries) {\n        if (isAvailable(font)) {\n          checked[font] = retries;\n          clear(textHeights);\n          // Make sure that loaded fonts are picked up by Safari\n          measureContext = null;\n          labelCache.clear();\n        } else {\n          ++checked[font];\n          done = false;\n        }\n      }\n    }\n    if (done) {\n      clearInterval(interval);\n      interval = undefined;\n    }\n  }\n\n  return function(fontSpec) {\n    const fontFamilies = getFontFamilies(fontSpec);\n    if (!fontFamilies) {\n      return;\n    }\n    for (let i = 0, ii = fontFamilies.length; i < ii; ++i) {\n      const fontFamily = fontFamilies[i];\n      if (!(fontFamily in checked)) {\n        checked[fontFamily] = retries;\n        if (!isAvailable(fontFamily)) {\n          checked[fontFamily] = 0;\n          if (interval === undefined) {\n            interval = setInterval(check, 32);\n          }\n        }\n      }\n    }\n  };\n})();\n\n\n/**\n * @return {CanvasRenderingContext2D} Measure context.\n */\nfunction getMeasureContext() {\n  if (!measureContext) {\n    measureContext = createCanvasContext2D(1, 1);\n  }\n  return measureContext;\n}\n\n\n/**\n * @param {string} font Font to use for measuring.\n * @return {module:ol/size~Size} Measurement.\n */\nexport const measureTextHeight = (function() {\n  let span;\n  const heights = textHeights;\n  return function(font) {\n    let height = heights[font];\n    if (height == undefined) {\n      if (!span) {\n        span = document.createElement('span');\n        span.textContent = 'M';\n        span.style.margin = span.style.padding = '0 !important';\n        span.style.position = 'absolute !important';\n        span.style.left = '-99999px !important';\n      }\n      span.style.font = font;\n      document.body.appendChild(span);\n      height = heights[font] = span.offsetHeight;\n      document.body.removeChild(span);\n    }\n    return height;\n  };\n})();\n\n\n/**\n * @param {string} font Font.\n * @param {string} text Text.\n * @return {number} Width.\n */\nexport function measureTextWidth(font, text) {\n  const measureContext = getMeasureContext();\n  if (font != measureContext.font) {\n    measureContext.font = font;\n  }\n  return measureContext.measureText(text).width;\n}\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} rotation Rotation.\n * @param {number} offsetX X offset.\n * @param {number} offsetY Y offset.\n */\nexport function rotateAtOffset(context, rotation, offsetX, offsetY) {\n  if (rotation !== 0) {\n    context.translate(offsetX, offsetY);\n    context.rotate(rotation);\n    context.translate(-offsetX, -offsetY);\n  }\n}\n\n\nexport const resetTransform = createTransform();\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform|null} transform Transform.\n * @param {number} opacity Opacity.\n * @param {HTMLImageElement|HTMLCanvasElement|HTMLVideoElement} image Image.\n * @param {number} originX Origin X.\n * @param {number} originY Origin Y.\n * @param {number} w Width.\n * @param {number} h Height.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {number} scale Scale.\n */\nexport function drawImage(context,\n  transform, opacity, image, originX, originY, w, h, x, y, scale) {\n  let alpha;\n  if (opacity != 1) {\n    alpha = context.globalAlpha;\n    context.globalAlpha = alpha * opacity;\n  }\n  if (transform) {\n    context.setTransform.apply(context, transform);\n  }\n\n  context.drawImage(image, originX, originY, w, h, x, y, w * scale, h * scale);\n\n  if (alpha) {\n    context.globalAlpha = alpha;\n  }\n  if (transform) {\n    context.setTransform.apply(context, resetTransform);\n  }\n}\n","/**\n * @module ol/style/Image\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {number} opacity\n * @property {boolean} rotateWithView\n * @property {number} rotation\n * @property {number} scale\n * @property {boolean} snapToPixel\n */\n\n\n/**\n * @classdesc\n * A base class used for creating subclasses and not instantiated in\n * apps. Base class for {@link module:ol/style/Icon~Icon}, {@link module:ol/style/Circle~CircleStyle} and\n * {@link module:ol/style/RegularShape~RegularShape}.\n *\n * @constructor\n * @abstract\n * @param {module:ol/style/Image~Options} options Options.\n * @api\n */\nconst ImageStyle = function(options) {\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.opacity_ = options.opacity;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.rotateWithView_ = options.rotateWithView;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.rotation_ = options.rotation;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.scale_ = options.scale;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.snapToPixel_ = options.snapToPixel;\n\n};\n\n\n/**\n * Get the symbolizer opacity.\n * @return {number} Opacity.\n * @api\n */\nImageStyle.prototype.getOpacity = function() {\n  return this.opacity_;\n};\n\n\n/**\n * Determine whether the symbolizer rotates with the map.\n * @return {boolean} Rotate with map.\n * @api\n */\nImageStyle.prototype.getRotateWithView = function() {\n  return this.rotateWithView_;\n};\n\n\n/**\n * Get the symoblizer rotation.\n * @return {number} Rotation.\n * @api\n */\nImageStyle.prototype.getRotation = function() {\n  return this.rotation_;\n};\n\n\n/**\n * Get the symbolizer scale.\n * @return {number} Scale.\n * @api\n */\nImageStyle.prototype.getScale = function() {\n  return this.scale_;\n};\n\n\n/**\n * Determine whether the symbolizer should be snapped to a pixel.\n * @return {boolean} The symbolizer should snap to a pixel.\n * @api\n */\nImageStyle.prototype.getSnapToPixel = function() {\n  return this.snapToPixel_;\n};\n\n\n/**\n * Get the anchor point in pixels. The anchor determines the center point for the\n * symbolizer.\n * @abstract\n * @return {Array.<number>} Anchor.\n */\nImageStyle.prototype.getAnchor = function() {};\n\n\n/**\n * Get the image element for the symbolizer.\n * @abstract\n * @param {number} pixelRatio Pixel ratio.\n * @return {HTMLCanvasElement|HTMLVideoElement|Image} Image element.\n */\nImageStyle.prototype.getImage = function(pixelRatio) {};\n\n\n/**\n * @abstract\n * @param {number} pixelRatio Pixel ratio.\n * @return {HTMLCanvasElement|HTMLVideoElement|Image} Image element.\n */\nImageStyle.prototype.getHitDetectionImage = function(pixelRatio) {};\n\n\n/**\n * @abstract\n * @return {module:ol/ImageState} Image state.\n */\nImageStyle.prototype.getImageState = function() {};\n\n\n/**\n * @abstract\n * @return {module:ol/size~Size} Image size.\n */\nImageStyle.prototype.getImageSize = function() {};\n\n\n/**\n * @abstract\n * @return {module:ol/size~Size} Size of the hit-detection image.\n */\nImageStyle.prototype.getHitDetectionImageSize = function() {};\n\n\n/**\n * Get the origin of the symbolizer.\n * @abstract\n * @return {Array.<number>} Origin.\n */\nImageStyle.prototype.getOrigin = function() {};\n\n\n/**\n * Get the size of the symbolizer (in pixels).\n * @abstract\n * @return {module:ol/size~Size} Size.\n */\nImageStyle.prototype.getSize = function() {};\n\n\n/**\n * Set the opacity.\n *\n * @param {number} opacity Opacity.\n * @api\n */\nImageStyle.prototype.setOpacity = function(opacity) {\n  this.opacity_ = opacity;\n};\n\n\n/**\n * Set whether to rotate the style with the view.\n *\n * @param {boolean} rotateWithView Rotate with map.\n * @api\n */\nImageStyle.prototype.setRotateWithView = function(rotateWithView) {\n  this.rotateWithView_ = rotateWithView;\n};\n\n\n/**\n * Set the rotation.\n *\n * @param {number} rotation Rotation.\n * @api\n */\nImageStyle.prototype.setRotation = function(rotation) {\n  this.rotation_ = rotation;\n};\n\n\n/**\n * Set the scale.\n *\n * @param {number} scale Scale.\n * @api\n */\nImageStyle.prototype.setScale = function(scale) {\n  this.scale_ = scale;\n};\n\n\n/**\n * Set whether to snap the image to the closest pixel.\n *\n * @param {boolean} snapToPixel Snap to pixel?\n * @api\n */\nImageStyle.prototype.setSnapToPixel = function(snapToPixel) {\n  this.snapToPixel_ = snapToPixel;\n};\n\n\n/**\n * @abstract\n * @param {function(this: T, module:ol/events/Event)} listener Listener function.\n * @param {T} thisArg Value to use as `this` when executing `listener`.\n * @return {module:ol/events~EventsKey|undefined} Listener key.\n * @template T\n */\nImageStyle.prototype.listenImageChange = function(listener, thisArg) {};\n\n\n/**\n * Load not yet loaded URI.\n * @abstract\n */\nImageStyle.prototype.load = function() {};\n\n\n/**\n * @abstract\n * @param {function(this: T, module:ol/events/Event)} listener Listener function.\n * @param {T} thisArg Value to use as `this` when executing `listener`.\n * @template T\n */\nImageStyle.prototype.unlistenImageChange = function(listener, thisArg) {};\nexport default ImageStyle;\n","/**\n * @module ol/style/RegularShape\n */\nimport {inherits} from '../util.js';\nimport {asColorLike} from '../colorlike.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {CANVAS_LINE_DASH} from '../has.js';\nimport ImageState from '../ImageState.js';\nimport {defaultStrokeStyle, defaultFillStyle, defaultLineCap, defaultLineWidth, defaultLineJoin, defaultMiterLimit} from '../render/canvas.js';\nimport ImageStyle from '../style/Image.js';\n\n\n/**\n * Specify radius for regular polygons, or radius1 and radius2 for stars.\n * @typedef {Object} Options\n * @property {module:ol/style/Fill} [fill] Fill style.\n * @property {number} points Number of points for stars and regular polygons. In case of a polygon, the number of points\n * is the number of sides.\n * @property {number} [radius] Radius of a regular polygon.\n * @property {number} [radius1] Outer radius of a star.\n * @property {number} [radius2] Inner radius of a star.\n * @property {number} [angle=0] Shape's angle in radians. A value of 0 will have one of the shape's point facing up.\n * @property {boolean} [snapToPixel=true] If `true` integral numbers of pixels are used as the X and Y pixel coordinate\n * when drawing the shape in the output canvas. If `false` fractional numbers may be used. Using `true` allows for\n * \"sharp\" rendering (no blur), while using `false` allows for \"accurate\" rendering. Note that accuracy is important if\n * the shape's position is animated. Without it, the shape may jitter noticeably.\n * @property {module:ol/style/Stroke} [stroke] Stroke style.\n * @property {number} [rotation=0] Rotation in radians (positive rotation clockwise).\n * @property {boolean} [rotateWithView=false] Whether to rotate the shape with the view.\n * @property {module:ol/style/AtlasManager} [atlasManager] The atlas manager to use for this symbol. When\n * using WebGL it is recommended to use an atlas manager to avoid texture switching. If an atlas manager is given, the\n * symbol is added to an atlas. By default no atlas manager is used.\n */\n\n\n/**\n * @typedef {Object} RenderOptions\n * @property {module:ol/colorlike~ColorLike} [strokeStyle]\n * @property {number} strokeWidth\n * @property {number} size\n * @property {string} lineCap\n * @property {Array.<number>} lineDash\n * @property {number} lineDashOffset\n * @property {string} lineJoin\n * @property {number} miterLimit\n */\n\n\n/**\n * @classdesc\n * Set regular shape style for vector features. The resulting shape will be\n * a regular polygon when `radius` is provided, or a star when `radius1` and\n * `radius2` are provided.\n *\n * @constructor\n * @param {module:ol/style/RegularShape~Options} options Options.\n * @extends {module:ol/style/Image}\n * @api\n */\nconst RegularShape = function(options) {\n  /**\n   * @private\n   * @type {Array.<string>}\n   */\n  this.checksums_ = null;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = null;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.hitDetectionCanvas_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Fill}\n   */\n  this.fill_ = options.fill !== undefined ? options.fill : null;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.origin_ = [0, 0];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.points_ = options.points;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.radius_ = /** @type {number} */ (options.radius !== undefined ?\n    options.radius : options.radius1);\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.radius2_ = options.radius2;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.angle_ = options.angle !== undefined ? options.angle : 0;\n\n  /**\n   * @private\n   * @type {module:ol/style/Stroke}\n   */\n  this.stroke_ = options.stroke !== undefined ? options.stroke : null;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.anchor_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.size_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.imageSize_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.hitDetectionImageSize_ = null;\n\n  /**\n   * @protected\n   * @type {module:ol/style/AtlasManager|undefined}\n   */\n  this.atlasManager_ = options.atlasManager;\n\n  this.render_(this.atlasManager_);\n\n  /**\n   * @type {boolean}\n   */\n  const snapToPixel = options.snapToPixel !== undefined ?\n    options.snapToPixel : true;\n\n  /**\n   * @type {boolean}\n   */\n  const rotateWithView = options.rotateWithView !== undefined ?\n    options.rotateWithView : false;\n\n  ImageStyle.call(this, {\n    opacity: 1,\n    rotateWithView: rotateWithView,\n    rotation: options.rotation !== undefined ? options.rotation : 0,\n    scale: 1,\n    snapToPixel: snapToPixel\n  });\n};\n\ninherits(RegularShape, ImageStyle);\n\n\n/**\n * Clones the style. If an atlasmanager was provided to the original style it will be used in the cloned style, too.\n * @return {module:ol/style/RegularShape} The cloned style.\n * @api\n */\nRegularShape.prototype.clone = function() {\n  const style = new RegularShape({\n    fill: this.getFill() ? this.getFill().clone() : undefined,\n    points: this.getPoints(),\n    radius: this.getRadius(),\n    radius2: this.getRadius2(),\n    angle: this.getAngle(),\n    snapToPixel: this.getSnapToPixel(),\n    stroke: this.getStroke() ?  this.getStroke().clone() : undefined,\n    rotation: this.getRotation(),\n    rotateWithView: this.getRotateWithView(),\n    atlasManager: this.atlasManager_\n  });\n  style.setOpacity(this.getOpacity());\n  style.setScale(this.getScale());\n  return style;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nRegularShape.prototype.getAnchor = function() {\n  return this.anchor_;\n};\n\n\n/**\n * Get the angle used in generating the shape.\n * @return {number} Shape's rotation in radians.\n * @api\n */\nRegularShape.prototype.getAngle = function() {\n  return this.angle_;\n};\n\n\n/**\n * Get the fill style for the shape.\n * @return {module:ol/style/Fill} Fill style.\n * @api\n */\nRegularShape.prototype.getFill = function() {\n  return this.fill_;\n};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.getHitDetectionImage = function(pixelRatio) {\n  return this.hitDetectionCanvas_;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nRegularShape.prototype.getImage = function(pixelRatio) {\n  return this.canvas_;\n};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.getImageSize = function() {\n  return this.imageSize_;\n};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.getHitDetectionImageSize = function() {\n  return this.hitDetectionImageSize_;\n};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.getImageState = function() {\n  return ImageState.LOADED;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nRegularShape.prototype.getOrigin = function() {\n  return this.origin_;\n};\n\n\n/**\n * Get the number of points for generating the shape.\n * @return {number} Number of points for stars and regular polygons.\n * @api\n */\nRegularShape.prototype.getPoints = function() {\n  return this.points_;\n};\n\n\n/**\n * Get the (primary) radius for the shape.\n * @return {number} Radius.\n * @api\n */\nRegularShape.prototype.getRadius = function() {\n  return this.radius_;\n};\n\n\n/**\n * Get the secondary radius for the shape.\n * @return {number|undefined} Radius2.\n * @api\n */\nRegularShape.prototype.getRadius2 = function() {\n  return this.radius2_;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nRegularShape.prototype.getSize = function() {\n  return this.size_;\n};\n\n\n/**\n * Get the stroke style for the shape.\n * @return {module:ol/style/Stroke} Stroke style.\n * @api\n */\nRegularShape.prototype.getStroke = function() {\n  return this.stroke_;\n};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.listenImageChange = function(listener, thisArg) {};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.load = function() {};\n\n\n/**\n * @inheritDoc\n */\nRegularShape.prototype.unlistenImageChange = function(listener, thisArg) {};\n\n\n/**\n * @protected\n * @param {module:ol/style/AtlasManager|undefined} atlasManager An atlas manager.\n */\nRegularShape.prototype.render_ = function(atlasManager) {\n  let imageSize;\n  let lineCap = '';\n  let lineJoin = '';\n  let miterLimit = 0;\n  let lineDash = null;\n  let lineDashOffset = 0;\n  let strokeStyle;\n  let strokeWidth = 0;\n\n  if (this.stroke_) {\n    strokeStyle = this.stroke_.getColor();\n    if (strokeStyle === null) {\n      strokeStyle = defaultStrokeStyle;\n    }\n    strokeStyle = asColorLike(strokeStyle);\n    strokeWidth = this.stroke_.getWidth();\n    if (strokeWidth === undefined) {\n      strokeWidth = defaultLineWidth;\n    }\n    lineDash = this.stroke_.getLineDash();\n    lineDashOffset = this.stroke_.getLineDashOffset();\n    if (!CANVAS_LINE_DASH) {\n      lineDash = null;\n      lineDashOffset = 0;\n    }\n    lineJoin = this.stroke_.getLineJoin();\n    if (lineJoin === undefined) {\n      lineJoin = defaultLineJoin;\n    }\n    lineCap = this.stroke_.getLineCap();\n    if (lineCap === undefined) {\n      lineCap = defaultLineCap;\n    }\n    miterLimit = this.stroke_.getMiterLimit();\n    if (miterLimit === undefined) {\n      miterLimit = defaultMiterLimit;\n    }\n  }\n\n  let size = 2 * (this.radius_ + strokeWidth) + 1;\n\n  /** @type {module:ol/style/RegularShape~RenderOptions} */\n  const renderOptions = {\n    strokeStyle: strokeStyle,\n    strokeWidth: strokeWidth,\n    size: size,\n    lineCap: lineCap,\n    lineDash: lineDash,\n    lineDashOffset: lineDashOffset,\n    lineJoin: lineJoin,\n    miterLimit: miterLimit\n  };\n\n  if (atlasManager === undefined) {\n    // no atlas manager is used, create a new canvas\n    const context = createCanvasContext2D(size, size);\n    this.canvas_ = context.canvas;\n\n    // canvas.width and height are rounded to the closest integer\n    size = this.canvas_.width;\n    imageSize = size;\n\n    this.draw_(renderOptions, context, 0, 0);\n\n    this.createHitDetectionCanvas_(renderOptions);\n  } else {\n    // an atlas manager is used, add the symbol to an atlas\n    size = Math.round(size);\n\n    const hasCustomHitDetectionImage = !this.fill_;\n    let renderHitDetectionCallback;\n    if (hasCustomHitDetectionImage) {\n      // render the hit-detection image into a separate atlas image\n      renderHitDetectionCallback =\n          this.drawHitDetectionCanvas_.bind(this, renderOptions);\n    }\n\n    const id = this.getChecksum();\n    const info = atlasManager.add(\n      id, size, size, this.draw_.bind(this, renderOptions),\n      renderHitDetectionCallback);\n\n    this.canvas_ = info.image;\n    this.origin_ = [info.offsetX, info.offsetY];\n    imageSize = info.image.width;\n\n    if (hasCustomHitDetectionImage) {\n      this.hitDetectionCanvas_ = info.hitImage;\n      this.hitDetectionImageSize_ =\n          [info.hitImage.width, info.hitImage.height];\n    } else {\n      this.hitDetectionCanvas_ = this.canvas_;\n      this.hitDetectionImageSize_ = [imageSize, imageSize];\n    }\n  }\n\n  this.anchor_ = [size / 2, size / 2];\n  this.size_ = [size, size];\n  this.imageSize_ = [imageSize, imageSize];\n};\n\n\n/**\n * @private\n * @param {module:ol/style/RegularShape~RenderOptions} renderOptions Render options.\n * @param {CanvasRenderingContext2D} context The rendering context.\n * @param {number} x The origin for the symbol (x).\n * @param {number} y The origin for the symbol (y).\n */\nRegularShape.prototype.draw_ = function(renderOptions, context, x, y) {\n  let i, angle0, radiusC;\n  // reset transform\n  context.setTransform(1, 0, 0, 1, 0, 0);\n\n  // then move to (x, y)\n  context.translate(x, y);\n\n  context.beginPath();\n\n  let points = this.points_;\n  if (points === Infinity) {\n    context.arc(\n      renderOptions.size / 2, renderOptions.size / 2,\n      this.radius_, 0, 2 * Math.PI, true);\n  } else {\n    const radius2 = (this.radius2_ !== undefined) ? this.radius2_\n      : this.radius_;\n    if (radius2 !== this.radius_) {\n      points = 2 * points;\n    }\n    for (i = 0; i <= points; i++) {\n      angle0 = i * 2 * Math.PI / points - Math.PI / 2 + this.angle_;\n      radiusC = i % 2 === 0 ? this.radius_ : radius2;\n      context.lineTo(renderOptions.size / 2 + radiusC * Math.cos(angle0),\n        renderOptions.size / 2 + radiusC * Math.sin(angle0));\n    }\n  }\n\n\n  if (this.fill_) {\n    let color = this.fill_.getColor();\n    if (color === null) {\n      color = defaultFillStyle;\n    }\n    context.fillStyle = asColorLike(color);\n    context.fill();\n  }\n  if (this.stroke_) {\n    context.strokeStyle = renderOptions.strokeStyle;\n    context.lineWidth = renderOptions.strokeWidth;\n    if (renderOptions.lineDash) {\n      context.setLineDash(renderOptions.lineDash);\n      context.lineDashOffset = renderOptions.lineDashOffset;\n    }\n    context.lineCap = renderOptions.lineCap;\n    context.lineJoin = renderOptions.lineJoin;\n    context.miterLimit = renderOptions.miterLimit;\n    context.stroke();\n  }\n  context.closePath();\n};\n\n\n/**\n * @private\n * @param {module:ol/style/RegularShape~RenderOptions} renderOptions Render options.\n */\nRegularShape.prototype.createHitDetectionCanvas_ = function(renderOptions) {\n  this.hitDetectionImageSize_ = [renderOptions.size, renderOptions.size];\n  if (this.fill_) {\n    this.hitDetectionCanvas_ = this.canvas_;\n    return;\n  }\n\n  // if no fill style is set, create an extra hit-detection image with a\n  // default fill style\n  const context = createCanvasContext2D(renderOptions.size, renderOptions.size);\n  this.hitDetectionCanvas_ = context.canvas;\n\n  this.drawHitDetectionCanvas_(renderOptions, context, 0, 0);\n};\n\n\n/**\n * @private\n * @param {module:ol/style/RegularShape~RenderOptions} renderOptions Render options.\n * @param {CanvasRenderingContext2D} context The context.\n * @param {number} x The origin for the symbol (x).\n * @param {number} y The origin for the symbol (y).\n */\nRegularShape.prototype.drawHitDetectionCanvas_ = function(renderOptions, context, x, y) {\n  // reset transform\n  context.setTransform(1, 0, 0, 1, 0, 0);\n\n  // then move to (x, y)\n  context.translate(x, y);\n\n  context.beginPath();\n\n  let points = this.points_;\n  if (points === Infinity) {\n    context.arc(\n      renderOptions.size / 2, renderOptions.size / 2,\n      this.radius_, 0, 2 * Math.PI, true);\n  } else {\n    const radius2 = (this.radius2_ !== undefined) ? this.radius2_\n      : this.radius_;\n    if (radius2 !== this.radius_) {\n      points = 2 * points;\n    }\n    let i, radiusC, angle0;\n    for (i = 0; i <= points; i++) {\n      angle0 = i * 2 * Math.PI / points - Math.PI / 2 + this.angle_;\n      radiusC = i % 2 === 0 ? this.radius_ : radius2;\n      context.lineTo(renderOptions.size / 2 + radiusC * Math.cos(angle0),\n        renderOptions.size / 2 + radiusC * Math.sin(angle0));\n    }\n  }\n\n  context.fillStyle = defaultFillStyle;\n  context.fill();\n  if (this.stroke_) {\n    context.strokeStyle = renderOptions.strokeStyle;\n    context.lineWidth = renderOptions.strokeWidth;\n    if (renderOptions.lineDash) {\n      context.setLineDash(renderOptions.lineDash);\n      context.lineDashOffset = renderOptions.lineDashOffset;\n    }\n    context.stroke();\n  }\n  context.closePath();\n};\n\n\n/**\n * @return {string} The checksum.\n */\nRegularShape.prototype.getChecksum = function() {\n  const strokeChecksum = this.stroke_ ?\n    this.stroke_.getChecksum() : '-';\n  const fillChecksum = this.fill_ ?\n    this.fill_.getChecksum() : '-';\n\n  const recalculate = !this.checksums_ ||\n      (strokeChecksum != this.checksums_[1] ||\n      fillChecksum != this.checksums_[2] ||\n      this.radius_ != this.checksums_[3] ||\n      this.radius2_ != this.checksums_[4] ||\n      this.angle_ != this.checksums_[5] ||\n      this.points_ != this.checksums_[6]);\n\n  if (recalculate) {\n    const checksum = 'r' + strokeChecksum + fillChecksum +\n        (this.radius_ !== undefined ? this.radius_.toString() : '-') +\n        (this.radius2_ !== undefined ? this.radius2_.toString() : '-') +\n        (this.angle_ !== undefined ? this.angle_.toString() : '-') +\n        (this.points_ !== undefined ? this.points_.toString() : '-');\n    this.checksums_ = [checksum, strokeChecksum, fillChecksum,\n      this.radius_, this.radius2_, this.angle_, this.points_];\n  }\n\n  return this.checksums_[0];\n};\nexport default RegularShape;\n","/**\n * @module ol/style/Circle\n */\nimport {inherits} from '../util.js';\nimport RegularShape from '../style/RegularShape.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/style/Fill} [fill] Fill style.\n * @property {number} radius Circle radius.\n * @property {boolean} [snapToPixel=true] If `true` integral numbers of pixels are used as the X and Y pixel coordinate\n * when drawing the circle in the output canvas. If `false` fractional numbers may be used. Using `true` allows for\n * \"sharp\" rendering (no blur), while using `false` allows for \"accurate\" rendering. Note that accuracy is important if\n * the circle's position is animated. Without it, the circle may jitter noticeably.\n * @property {module:ol/style/Stroke} [stroke] Stroke style.\n * @property {module:ol/style/AtlasManager} [atlasManager] The atlas manager to use for this circle.\n * When using WebGL it is recommended to use an atlas manager to avoid texture switching. If an atlas manager is given,\n * the circle is added to an atlas. By default no atlas manager is used.\n */\n\n\n/**\n * @classdesc\n * Set circle style for vector features.\n *\n * @constructor\n * @param {module:ol/style/Circle~Options=} opt_options Options.\n * @extends {module:ol/style/RegularShape}\n * @api\n */\nconst CircleStyle = function(opt_options) {\n\n  const options = opt_options || {};\n\n  RegularShape.call(this, {\n    points: Infinity,\n    fill: options.fill,\n    radius: options.radius,\n    snapToPixel: options.snapToPixel,\n    stroke: options.stroke,\n    atlasManager: options.atlasManager\n  });\n\n};\n\ninherits(CircleStyle, RegularShape);\n\n\n/**\n * Clones the style.  If an atlasmanager was provided to the original style it will be used in the cloned style, too.\n * @return {module:ol/style/Circle} The cloned style.\n * @override\n * @api\n */\nCircleStyle.prototype.clone = function() {\n  const style = new CircleStyle({\n    fill: this.getFill() ? this.getFill().clone() : undefined,\n    stroke: this.getStroke() ? this.getStroke().clone() : undefined,\n    radius: this.getRadius(),\n    snapToPixel: this.getSnapToPixel(),\n    atlasManager: this.atlasManager_\n  });\n  style.setOpacity(this.getOpacity());\n  style.setScale(this.getScale());\n  return style;\n};\n\n\n/**\n * Set the circle radius.\n *\n * @param {number} radius Circle radius.\n * @api\n */\nCircleStyle.prototype.setRadius = function(radius) {\n  this.radius_ = radius;\n  this.render_(this.atlasManager_);\n};\nexport default CircleStyle;\n","/**\n * @module ol/style/Fill\n */\nimport {getUid} from '../util.js';\nimport {asString} from '../color.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/color~Color|module:ol/colorlike~ColorLike} [color] A color, gradient or pattern.\n * See {@link module:ol/color~Color} and {@link module:ol/colorlike~ColorLike} for possible formats.\n * Default null; if null, the Canvas/renderer default black will be used.\n */\n\n\n/**\n * @classdesc\n * Set fill style for vector features.\n *\n * @constructor\n * @param {module:ol/style/Fill~Options=} opt_options Options.\n * @api\n */\nconst Fill = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {module:ol/color~Color|module:ol/colorlike~ColorLike}\n   */\n  this.color_ = options.color !== undefined ? options.color : null;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Clones the style. The color is not cloned if it is an {@link module:ol/colorlike~ColorLike}.\n * @return {module:ol/style/Fill} The cloned style.\n * @api\n */\nFill.prototype.clone = function() {\n  const color = this.getColor();\n  return new Fill({\n    color: (color && color.slice) ? color.slice() : color || undefined\n  });\n};\n\n\n/**\n * Get the fill color.\n * @return {module:ol/color~Color|module:ol/colorlike~ColorLike} Color.\n * @api\n */\nFill.prototype.getColor = function() {\n  return this.color_;\n};\n\n\n/**\n * Set the color.\n *\n * @param {module:ol/color~Color|module:ol/colorlike~ColorLike} color Color.\n * @api\n */\nFill.prototype.setColor = function(color) {\n  this.color_ = color;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * @return {string} The checksum.\n */\nFill.prototype.getChecksum = function() {\n  if (this.checksum_ === undefined) {\n    if (\n      this.color_ instanceof CanvasPattern ||\n        this.color_ instanceof CanvasGradient\n    ) {\n      this.checksum_ = getUid(this.color_).toString();\n    } else {\n      this.checksum_ = 'f' + (this.color_ ? asString(this.color_) : '-');\n    }\n  }\n\n  return this.checksum_;\n};\nexport default Fill;\n","/**\n * @module ol/style/Stroke\n */\nimport {getUid} from '../util.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/color~Color|module:ol/colorlike~ColorLike} [color] A color, gradient or pattern.\n * See {@link module:ol/color~Color} and {@link module:ol/colorlike~ColorLike} for possible formats.\n * Default null; if null, the Canvas/renderer default black will be used.\n * @property {string} [lineCap='round'] Line cap style: `butt`, `round`, or `square`.\n * @property {string} [lineJoin='round'] Line join style: `bevel`, `round`, or `miter`.\n * @property {Array.<number>} [lineDash] Line dash pattern. Default is `undefined` (no dash).\n * Please note that Internet Explorer 10 and lower do not support the `setLineDash` method on\n * the `CanvasRenderingContext2D` and therefore this option will have no visual effect in these browsers.\n * @property {number} [lineDashOffset=0] Line dash offset.\n * @property {number} [miterLimit=10] Miter limit.\n * @property {number} [width] Width.\n */\n\n\n/**\n * @classdesc\n * Set stroke style for vector features.\n * Note that the defaults given are the Canvas defaults, which will be used if\n * option is not defined. The `get` functions return whatever was entered in\n * the options; they will not return the default.\n *\n * @constructor\n * @param {module:ol/style/Stroke~Options=} opt_options Options.\n * @api\n */\nconst Stroke = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {module:ol/color~Color|module:ol/colorlike~ColorLike}\n   */\n  this.color_ = options.color !== undefined ? options.color : null;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.lineCap_ = options.lineCap;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.lineDash_ = options.lineDash !== undefined ? options.lineDash : null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lineDashOffset_ = options.lineDashOffset;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.lineJoin_ = options.lineJoin;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.miterLimit_ = options.miterLimit;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.width_ = options.width;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Clones the style.\n * @return {module:ol/style/Stroke} The cloned style.\n * @api\n */\nStroke.prototype.clone = function() {\n  const color = this.getColor();\n  return new Stroke({\n    color: (color && color.slice) ? color.slice() : color || undefined,\n    lineCap: this.getLineCap(),\n    lineDash: this.getLineDash() ? this.getLineDash().slice() : undefined,\n    lineDashOffset: this.getLineDashOffset(),\n    lineJoin: this.getLineJoin(),\n    miterLimit: this.getMiterLimit(),\n    width: this.getWidth()\n  });\n};\n\n\n/**\n * Get the stroke color.\n * @return {module:ol/color~Color|module:ol/colorlike~ColorLike} Color.\n * @api\n */\nStroke.prototype.getColor = function() {\n  return this.color_;\n};\n\n\n/**\n * Get the line cap type for the stroke.\n * @return {string|undefined} Line cap.\n * @api\n */\nStroke.prototype.getLineCap = function() {\n  return this.lineCap_;\n};\n\n\n/**\n * Get the line dash style for the stroke.\n * @return {Array.<number>} Line dash.\n * @api\n */\nStroke.prototype.getLineDash = function() {\n  return this.lineDash_;\n};\n\n\n/**\n * Get the line dash offset for the stroke.\n * @return {number|undefined} Line dash offset.\n * @api\n */\nStroke.prototype.getLineDashOffset = function() {\n  return this.lineDashOffset_;\n};\n\n\n/**\n * Get the line join type for the stroke.\n * @return {string|undefined} Line join.\n * @api\n */\nStroke.prototype.getLineJoin = function() {\n  return this.lineJoin_;\n};\n\n\n/**\n * Get the miter limit for the stroke.\n * @return {number|undefined} Miter limit.\n * @api\n */\nStroke.prototype.getMiterLimit = function() {\n  return this.miterLimit_;\n};\n\n\n/**\n * Get the stroke width.\n * @return {number|undefined} Width.\n * @api\n */\nStroke.prototype.getWidth = function() {\n  return this.width_;\n};\n\n\n/**\n * Set the color.\n *\n * @param {module:ol/color~Color|module:ol/colorlike~ColorLike} color Color.\n * @api\n */\nStroke.prototype.setColor = function(color) {\n  this.color_ = color;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the line cap.\n *\n * @param {string|undefined} lineCap Line cap.\n * @api\n */\nStroke.prototype.setLineCap = function(lineCap) {\n  this.lineCap_ = lineCap;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the line dash.\n *\n * Please note that Internet Explorer 10 and lower [do not support][mdn] the\n * `setLineDash` method on the `CanvasRenderingContext2D` and therefore this\n * property will have no visual effect in these browsers.\n *\n * [mdn]: https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash#Browser_compatibility\n *\n * @param {Array.<number>} lineDash Line dash.\n * @api\n */\nStroke.prototype.setLineDash = function(lineDash) {\n  this.lineDash_ = lineDash;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the line dash offset.\n *\n * @param {number|undefined} lineDashOffset Line dash offset.\n * @api\n */\nStroke.prototype.setLineDashOffset = function(lineDashOffset) {\n  this.lineDashOffset_ = lineDashOffset;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the line join.\n *\n * @param {string|undefined} lineJoin Line join.\n * @api\n */\nStroke.prototype.setLineJoin = function(lineJoin) {\n  this.lineJoin_ = lineJoin;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the miter limit.\n *\n * @param {number|undefined} miterLimit Miter limit.\n * @api\n */\nStroke.prototype.setMiterLimit = function(miterLimit) {\n  this.miterLimit_ = miterLimit;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * Set the width.\n *\n * @param {number|undefined} width Width.\n * @api\n */\nStroke.prototype.setWidth = function(width) {\n  this.width_ = width;\n  this.checksum_ = undefined;\n};\n\n\n/**\n * @return {string} The checksum.\n */\nStroke.prototype.getChecksum = function() {\n  if (this.checksum_ === undefined) {\n    this.checksum_ = 's';\n    if (this.color_) {\n      if (typeof this.color_ === 'string') {\n        this.checksum_ += this.color_;\n      } else {\n        this.checksum_ += getUid(this.color_).toString();\n      }\n    } else {\n      this.checksum_ += '-';\n    }\n    this.checksum_ += ',' +\n        (this.lineCap_ !== undefined ?\n          this.lineCap_.toString() : '-') + ',' +\n        (this.lineDash_ ?\n          this.lineDash_.toString() : '-') + ',' +\n        (this.lineDashOffset_ !== undefined ?\n          this.lineDashOffset_ : '-') + ',' +\n        (this.lineJoin_ !== undefined ?\n          this.lineJoin_ : '-') + ',' +\n        (this.miterLimit_ !== undefined ?\n          this.miterLimit_.toString() : '-') + ',' +\n        (this.width_ !== undefined ?\n          this.width_.toString() : '-');\n  }\n\n  return this.checksum_;\n};\nexport default Stroke;\n","/**\n * @module ol/style/Style\n */\n\n/**\n * Feature styles.\n *\n * If no style is defined, the following default style is used:\n * ```js\n *  import {Fill, Stroke, Circle, Style} from 'ol/style';\n *\n *  var fill = new Fill({\n *    color: 'rgba(255,255,255,0.4)'\n *  });\n *  var stroke = new Stroke({\n *    color: '#3399CC',\n *    width: 1.25\n *  });\n *  var styles = [\n *    new Style({\n *      image: new Circle({\n *        fill: fill,\n *        stroke: stroke,\n *        radius: 5\n *      }),\n *      fill: fill,\n *      stroke: stroke\n *    })\n *  ];\n * ```\n *\n * A separate editing style has the following defaults:\n * ```js\n *  import {Fill, Stroke, Circle, Style} from 'ol/style';\n *  import GeometryType from 'ol/geom/GeometryType';\n *\n *  var white = [255, 255, 255, 1];\n *  var blue = [0, 153, 255, 1];\n *  var width = 3;\n *  styles[GeometryType.POLYGON] = [\n *    new Style({\n *      fill: new Fill({\n *        color: [255, 255, 255, 0.5]\n *      })\n *    })\n *  ];\n *  styles[GeometryType.MULTI_POLYGON] =\n *      styles[GeometryType.POLYGON];\n *  styles[GeometryType.LINE_STRING] = [\n *    new Style({\n *      stroke: new Stroke({\n *        color: white,\n *        width: width + 2\n *      })\n *    }),\n *    new Style({\n *      stroke: new Stroke({\n *        color: blue,\n *        width: width\n *      })\n *    })\n *  ];\n *  styles[GeometryType.MULTI_LINE_STRING] =\n *      styles[GeometryType.LINE_STRING];\n *  styles[GeometryType.POINT] = [\n *    new Style({\n *      image: new Circle({\n *        radius: width * 2,\n *        fill: new Fill({\n *          color: blue\n *        }),\n *        stroke: new Stroke({\n *          color: white,\n *          width: width / 2\n *        })\n *      }),\n *      zIndex: Infinity\n *    })\n *  ];\n *  styles[GeometryType.MULTI_POINT] =\n *      styles[GeometryType.POINT];\n *  styles[GeometryType.GEOMETRY_COLLECTION] =\n *      styles[GeometryType.POLYGON].concat(\n *          styles[GeometryType.LINE_STRING],\n *          styles[GeometryType.POINT]\n *      );\n * ```\n */\nimport {assert} from '../asserts.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport CircleStyle from '../style/Circle.js';\nimport Fill from '../style/Fill.js';\nimport Stroke from '../style/Stroke.js';\n\n\n/**\n * A function that takes an {@link module:ol/Feature} and a `{number}`\n * representing the view's resolution. The function should return a\n * {@link module:ol/style/Style} or an array of them. This way e.g. a\n * vector layer can be styled.\n *\n * @typedef {function((module:ol/Feature|module:ol/render/Feature), number):\n *     (module:ol/style/Style|Array.<module:ol/style/Style>)} StyleFunction\n */\n\n\n/**\n * A function that takes an {@link module:ol/Feature} as argument and returns an\n * {@link module:ol/geom/Geometry} that will be rendered and styled for the feature.\n *\n * @typedef {function((module:ol/Feature|module:ol/render/Feature)):\n *     (module:ol/geom/Geometry|module:ol/render/Feature|undefined)} GeometryFunction\n */\n\n\n/**\n * Custom renderer function. Takes two arguments:\n *\n * 1. The pixel coordinates of the geometry in GeoJSON notation.\n * 2. The {@link module:ol/render~State} of the layer renderer.\n *\n * @typedef {function((module:ol/coordinate~Coordinate|Array<module:ol/coordinate~Coordinate>|Array.<Array.<module:ol/coordinate~Coordinate>>),module:ol/render~State)}\n * RenderFunction\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {string|module:ol/geom/Geometry|module:ol/style/Style~GeometryFunction} [geometry] Feature property or geometry\n * or function returning a geometry to render for this style.\n * @property {module:ol/style/Fill} [fill] Fill style.\n * @property {module:ol/style/Image} [image] Image style.\n * @property {module:ol/style/Style~RenderFunction} [renderer] Custom renderer. When configured, `fill`, `stroke` and `image` will be\n * ignored, and the provided function will be called with each render frame for each geometry.\n * @property {module:ol/style/Stroke} [stroke] Stroke style.\n * @property {module:ol/style/Text} [text] Text style.\n * @property {number} [zIndex] Z index.\n */\n\n\n/**\n * @classdesc\n * Container for vector feature rendering styles. Any changes made to the style\n * or its children through `set*()` methods will not take effect until the\n * feature or layer that uses the style is re-rendered.\n *\n * @constructor\n * @struct\n * @param {module:ol/style/Style~Options=} opt_options Style options.\n * @api\n */\nconst Style = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {string|module:ol/geom/Geometry|module:ol/style/Style~GeometryFunction}\n   */\n  this.geometry_ = null;\n\n  /**\n   * @private\n   * @type {!module:ol/style/Style~GeometryFunction}\n   */\n  this.geometryFunction_ = defaultGeometryFunction;\n\n  if (options.geometry !== undefined) {\n    this.setGeometry(options.geometry);\n  }\n\n  /**\n   * @private\n   * @type {module:ol/style/Fill}\n   */\n  this.fill_ = options.fill !== undefined ? options.fill : null;\n\n  /**\n     * @private\n     * @type {module:ol/style/Image}\n     */\n  this.image_ = options.image !== undefined ? options.image : null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Style~RenderFunction|null}\n   */\n  this.renderer_ = options.renderer !== undefined ? options.renderer : null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Stroke}\n   */\n  this.stroke_ = options.stroke !== undefined ? options.stroke : null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Text}\n   */\n  this.text_ = options.text !== undefined ? options.text : null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.zIndex_ = options.zIndex;\n\n};\n\n\n/**\n * Clones the style.\n * @return {module:ol/style/Style} The cloned style.\n * @api\n */\nStyle.prototype.clone = function() {\n  let geometry = this.getGeometry();\n  if (geometry && geometry.clone) {\n    geometry = geometry.clone();\n  }\n  return new Style({\n    geometry: geometry,\n    fill: this.getFill() ? this.getFill().clone() : undefined,\n    image: this.getImage() ? this.getImage().clone() : undefined,\n    stroke: this.getStroke() ? this.getStroke().clone() : undefined,\n    text: this.getText() ? this.getText().clone() : undefined,\n    zIndex: this.getZIndex()\n  });\n};\n\n\n/**\n * Get the custom renderer function that was configured with\n * {@link #setRenderer} or the `renderer` constructor option.\n * @return {module:ol/style/Style~RenderFunction|null} Custom renderer function.\n * @api\n */\nStyle.prototype.getRenderer = function() {\n  return this.renderer_;\n};\n\n\n/**\n * Sets a custom renderer function for this style. When set, `fill`, `stroke`\n * and `image` options of the style will be ignored.\n * @param {module:ol/style/Style~RenderFunction|null} renderer Custom renderer function.\n * @api\n */\nStyle.prototype.setRenderer = function(renderer) {\n  this.renderer_ = renderer;\n};\n\n\n/**\n * Get the geometry to be rendered.\n * @return {string|module:ol/geom/Geometry|module:ol/style/Style~GeometryFunction}\n * Feature property or geometry or function that returns the geometry that will\n * be rendered with this style.\n * @api\n */\nStyle.prototype.getGeometry = function() {\n  return this.geometry_;\n};\n\n\n/**\n * Get the function used to generate a geometry for rendering.\n * @return {!module:ol/style/Style~GeometryFunction} Function that is called with a feature\n * and returns the geometry to render instead of the feature's geometry.\n * @api\n */\nStyle.prototype.getGeometryFunction = function() {\n  return this.geometryFunction_;\n};\n\n\n/**\n * Get the fill style.\n * @return {module:ol/style/Fill} Fill style.\n * @api\n */\nStyle.prototype.getFill = function() {\n  return this.fill_;\n};\n\n\n/**\n * Set the fill style.\n * @param {module:ol/style/Fill} fill Fill style.\n * @api\n */\nStyle.prototype.setFill = function(fill) {\n  this.fill_ = fill;\n};\n\n\n/**\n * Get the image style.\n * @return {module:ol/style/Image} Image style.\n * @api\n */\nStyle.prototype.getImage = function() {\n  return this.image_;\n};\n\n\n/**\n * Set the image style.\n * @param {module:ol/style/Image} image Image style.\n * @api\n */\nStyle.prototype.setImage = function(image) {\n  this.image_ = image;\n};\n\n\n/**\n * Get the stroke style.\n * @return {module:ol/style/Stroke} Stroke style.\n * @api\n */\nStyle.prototype.getStroke = function() {\n  return this.stroke_;\n};\n\n\n/**\n * Set the stroke style.\n * @param {module:ol/style/Stroke} stroke Stroke style.\n * @api\n */\nStyle.prototype.setStroke = function(stroke) {\n  this.stroke_ = stroke;\n};\n\n\n/**\n * Get the text style.\n * @return {module:ol/style/Text} Text style.\n * @api\n */\nStyle.prototype.getText = function() {\n  return this.text_;\n};\n\n\n/**\n * Set the text style.\n * @param {module:ol/style/Text} text Text style.\n * @api\n */\nStyle.prototype.setText = function(text) {\n  this.text_ = text;\n};\n\n\n/**\n * Get the z-index for the style.\n * @return {number|undefined} ZIndex.\n * @api\n */\nStyle.prototype.getZIndex = function() {\n  return this.zIndex_;\n};\n\n\n/**\n * Set a geometry that is rendered instead of the feature's geometry.\n *\n * @param {string|module:ol/geom/Geometry|module:ol/style/Style~GeometryFunction} geometry\n *     Feature property or geometry or function returning a geometry to render\n *     for this style.\n * @api\n */\nStyle.prototype.setGeometry = function(geometry) {\n  if (typeof geometry === 'function') {\n    this.geometryFunction_ = geometry;\n  } else if (typeof geometry === 'string') {\n    this.geometryFunction_ = function(feature) {\n      return (\n        /** @type {module:ol/geom/Geometry} */ (feature.get(geometry))\n      );\n    };\n  } else if (!geometry) {\n    this.geometryFunction_ = defaultGeometryFunction;\n  } else if (geometry !== undefined) {\n    this.geometryFunction_ = function() {\n      return (\n        /** @type {module:ol/geom/Geometry} */ (geometry)\n      );\n    };\n  }\n  this.geometry_ = geometry;\n};\n\n\n/**\n * Set the z-index.\n *\n * @param {number|undefined} zIndex ZIndex.\n * @api\n */\nStyle.prototype.setZIndex = function(zIndex) {\n  this.zIndex_ = zIndex;\n};\n\n\n/**\n * Convert the provided object into a style function.  Functions passed through\n * unchanged.  Arrays of module:ol/style/Style or single style objects wrapped in a\n * new style function.\n * @param {module:ol/style/Style~StyleFunction|Array.<module:ol/style/Style>|module:ol/style/Style} obj\n *     A style function, a single style, or an array of styles.\n * @return {module:ol/style/Style~StyleFunction} A style function.\n */\nexport function toFunction(obj) {\n  let styleFunction;\n\n  if (typeof obj === 'function') {\n    styleFunction = obj;\n  } else {\n    /**\n     * @type {Array.<module:ol/style/Style>}\n     */\n    let styles;\n    if (Array.isArray(obj)) {\n      styles = obj;\n    } else {\n      assert(obj instanceof Style,\n        41); // Expected an `module:ol/style/Style~Style` or an array of `module:ol/style/Style~Style`\n      styles = [obj];\n    }\n    styleFunction = function() {\n      return styles;\n    };\n  }\n  return styleFunction;\n}\n\n\n/**\n * @type {Array.<module:ol/style/Style>}\n */\nlet defaultStyles = null;\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {number} resolution Resolution.\n * @return {Array.<module:ol/style/Style>} Style.\n */\nexport function createDefaultStyle(feature, resolution) {\n  // We don't use an immediately-invoked function\n  // and a closure so we don't get an error at script evaluation time in\n  // browsers that do not support Canvas. (module:ol/style/Circle~CircleStyle does\n  // canvas.getContext('2d') at construction time, which will cause an.error\n  // in such browsers.)\n  if (!defaultStyles) {\n    const fill = new Fill({\n      color: 'rgba(255,255,255,0.4)'\n    });\n    const stroke = new Stroke({\n      color: '#3399CC',\n      width: 1.25\n    });\n    defaultStyles = [\n      new Style({\n        image: new CircleStyle({\n          fill: fill,\n          stroke: stroke,\n          radius: 5\n        }),\n        fill: fill,\n        stroke: stroke\n      })\n    ];\n  }\n  return defaultStyles;\n}\n\n\n/**\n * Default styles for editing features.\n * @return {Object.<module:ol/geom/GeometryType, Array.<module:ol/style/Style>>} Styles\n */\nexport function createEditingStyle() {\n  /** @type {Object.<module:ol/geom/GeometryType, Array.<module:ol/style/Style>>} */\n  const styles = {};\n  const white = [255, 255, 255, 1];\n  const blue = [0, 153, 255, 1];\n  const width = 3;\n  styles[GeometryType.POLYGON] = [\n    new Style({\n      fill: new Fill({\n        color: [255, 255, 255, 0.5]\n      })\n    })\n  ];\n  styles[GeometryType.MULTI_POLYGON] =\n      styles[GeometryType.POLYGON];\n\n  styles[GeometryType.LINE_STRING] = [\n    new Style({\n      stroke: new Stroke({\n        color: white,\n        width: width + 2\n      })\n    }),\n    new Style({\n      stroke: new Stroke({\n        color: blue,\n        width: width\n      })\n    })\n  ];\n  styles[GeometryType.MULTI_LINE_STRING] =\n      styles[GeometryType.LINE_STRING];\n\n  styles[GeometryType.CIRCLE] =\n      styles[GeometryType.POLYGON].concat(\n        styles[GeometryType.LINE_STRING]\n      );\n\n\n  styles[GeometryType.POINT] = [\n    new Style({\n      image: new CircleStyle({\n        radius: width * 2,\n        fill: new Fill({\n          color: blue\n        }),\n        stroke: new Stroke({\n          color: white,\n          width: width / 2\n        })\n      }),\n      zIndex: Infinity\n    })\n  ];\n  styles[GeometryType.MULTI_POINT] =\n      styles[GeometryType.POINT];\n\n  styles[GeometryType.GEOMETRY_COLLECTION] =\n      styles[GeometryType.POLYGON].concat(\n        styles[GeometryType.LINE_STRING],\n        styles[GeometryType.POINT]\n      );\n\n  return styles;\n}\n\n\n/**\n * Function that is called with a feature and returns its default geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature to get the geometry for.\n * @return {module:ol/geom/Geometry|module:ol/render/Feature|undefined} Geometry to render.\n */\nfunction defaultGeometryFunction(feature) {\n  return feature.getGeometry();\n}\n\nexport default Style;\n","/**\n * @module ol/Feature\n */\nimport {assert} from './asserts.js';\nimport {listen, unlisten, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\nimport {inherits} from './util.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport Geometry from './geom/Geometry.js';\nimport Style from './style/Style.js';\n\n/**\n * @classdesc\n * A vector object for geographic features with a geometry and other\n * attribute properties, similar to the features in vector file formats like\n * GeoJSON.\n *\n * Features can be styled individually with `setStyle`; otherwise they use the\n * style of their vector layer.\n *\n * Note that attribute properties are set as {@link module:ol/Object} properties on\n * the feature object, so they are observable, and have get/set accessors.\n *\n * Typically, a feature has a single geometry property. You can set the\n * geometry using the `setGeometry` method and get it with `getGeometry`.\n * It is possible to store more than one geometry on a feature using attribute\n * properties. By default, the geometry used for rendering is identified by\n * the property name `geometry`. If you want to use another geometry property\n * for rendering, use the `setGeometryName` method to change the attribute\n * property associated with the geometry for the feature.  For example:\n *\n * ```js\n *\n * import Feature from 'ol/Feature';\n * import Polygon from 'ol/geom/Polygon';\n * import Point from 'ol/geom/Point';\n *\n * var feature = new Feature({\n *   geometry: new Polygon(polyCoords),\n *   labelPoint: new Point(labelCoords),\n *   name: 'My Polygon'\n * });\n *\n * // get the polygon geometry\n * var poly = feature.getGeometry();\n *\n * // Render the feature as a point using the coordinates from labelPoint\n * feature.setGeometryName('labelPoint');\n *\n * // get the point geometry\n * var point = feature.getGeometry();\n * ```\n *\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/geom/Geometry|Object.<string, *>=} opt_geometryOrProperties\n * You may pass a Geometry object directly, or an object literal containing\n * properties. If you pass an object literal, you may include a Geometry\n * associated with a `geometry` key.\n * @api\n */\nconst Feature = function(opt_geometryOrProperties) {\n\n  BaseObject.call(this);\n\n  /**\n   * @private\n   * @type {number|string|undefined}\n   */\n  this.id_ = undefined;\n\n  /**\n   * @type {string}\n   * @private\n   */\n  this.geometryName_ = 'geometry';\n\n  /**\n   * User provided style.\n   * @private\n   * @type {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction}\n   */\n  this.style_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Style~StyleFunction|undefined}\n   */\n  this.styleFunction_ = undefined;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.geometryChangeKey_ = null;\n\n  listen(\n    this, getChangeEventType(this.geometryName_),\n    this.handleGeometryChanged_, this);\n\n  if (opt_geometryOrProperties !== undefined) {\n    if (opt_geometryOrProperties instanceof Geometry ||\n        !opt_geometryOrProperties) {\n      const geometry = opt_geometryOrProperties;\n      this.setGeometry(geometry);\n    } else {\n      /** @type {Object.<string, *>} */\n      const properties = opt_geometryOrProperties;\n      this.setProperties(properties);\n    }\n  }\n};\n\ninherits(Feature, BaseObject);\n\n\n/**\n * Clone this feature. If the original feature has a geometry it\n * is also cloned. The feature id is not set in the clone.\n * @return {module:ol/Feature} The clone.\n * @api\n */\nFeature.prototype.clone = function() {\n  const clone = new Feature(this.getProperties());\n  clone.setGeometryName(this.getGeometryName());\n  const geometry = this.getGeometry();\n  if (geometry) {\n    clone.setGeometry(geometry.clone());\n  }\n  const style = this.getStyle();\n  if (style) {\n    clone.setStyle(style);\n  }\n  return clone;\n};\n\n\n/**\n * Get the feature's default geometry.  A feature may have any number of named\n * geometries.  The \"default\" geometry (the one that is rendered by default) is\n * set when calling {@link module:ol/Feature~Feature#setGeometry}.\n * @return {module:ol/geom/Geometry|undefined} The default geometry for the feature.\n * @api\n * @observable\n */\nFeature.prototype.getGeometry = function() {\n  return (\n    /** @type {module:ol/geom/Geometry|undefined} */ (this.get(this.geometryName_))\n  );\n};\n\n\n/**\n * Get the feature identifier.  This is a stable identifier for the feature and\n * is either set when reading data from a remote source or set explicitly by\n * calling {@link module:ol/Feature~Feature#setId}.\n * @return {number|string|undefined} Id.\n * @api\n */\nFeature.prototype.getId = function() {\n  return this.id_;\n};\n\n\n/**\n * Get the name of the feature's default geometry.  By default, the default\n * geometry is named `geometry`.\n * @return {string} Get the property name associated with the default geometry\n *     for this feature.\n * @api\n */\nFeature.prototype.getGeometryName = function() {\n  return this.geometryName_;\n};\n\n\n/**\n * Get the feature's style. Will return what was provided to the\n * {@link module:ol/Feature~Feature#setStyle} method.\n * @return {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} The feature style.\n * @api\n */\nFeature.prototype.getStyle = function() {\n  return this.style_;\n};\n\n\n/**\n * Get the feature's style function.\n * @return {module:ol/style/Style~StyleFunction|undefined} Return a function\n * representing the current style of this feature.\n * @api\n */\nFeature.prototype.getStyleFunction = function() {\n  return this.styleFunction_;\n};\n\n\n/**\n * @private\n */\nFeature.prototype.handleGeometryChange_ = function() {\n  this.changed();\n};\n\n\n/**\n * @private\n */\nFeature.prototype.handleGeometryChanged_ = function() {\n  if (this.geometryChangeKey_) {\n    unlistenByKey(this.geometryChangeKey_);\n    this.geometryChangeKey_ = null;\n  }\n  const geometry = this.getGeometry();\n  if (geometry) {\n    this.geometryChangeKey_ = listen(geometry,\n      EventType.CHANGE, this.handleGeometryChange_, this);\n  }\n  this.changed();\n};\n\n\n/**\n * Set the default geometry for the feature.  This will update the property\n * with the name returned by {@link module:ol/Feature~Feature#getGeometryName}.\n * @param {module:ol/geom/Geometry|undefined} geometry The new geometry.\n * @api\n * @observable\n */\nFeature.prototype.setGeometry = function(geometry) {\n  this.set(this.geometryName_, geometry);\n};\n\n\n/**\n * Set the style for the feature.  This can be a single style object, an array\n * of styles, or a function that takes a resolution and returns an array of\n * styles. If it is `null` the feature has no style (a `null` style).\n * @param {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} style Style for this feature.\n * @api\n * @fires module:ol/events/Event~Event#event:change\n */\nFeature.prototype.setStyle = function(style) {\n  this.style_ = style;\n  this.styleFunction_ = !style ? undefined : createStyleFunction(style);\n  this.changed();\n};\n\n\n/**\n * Set the feature id.  The feature id is considered stable and may be used when\n * requesting features or comparing identifiers returned from a remote source.\n * The feature id can be used with the\n * {@link module:ol/source/Vector~VectorSource#getFeatureById} method.\n * @param {number|string|undefined} id The feature id.\n * @api\n * @fires module:ol/events/Event~Event#event:change\n */\nFeature.prototype.setId = function(id) {\n  this.id_ = id;\n  this.changed();\n};\n\n\n/**\n * Set the property name to be used when getting the feature's default geometry.\n * When calling {@link module:ol/Feature~Feature#getGeometry}, the value of the property with\n * this name will be returned.\n * @param {string} name The property name of the default geometry.\n * @api\n */\nFeature.prototype.setGeometryName = function(name) {\n  unlisten(\n    this, getChangeEventType(this.geometryName_),\n    this.handleGeometryChanged_, this);\n  this.geometryName_ = name;\n  listen(\n    this, getChangeEventType(this.geometryName_),\n    this.handleGeometryChanged_, this);\n  this.handleGeometryChanged_();\n};\n\n\n/**\n * Convert the provided object into a feature style function.  Functions passed\n * through unchanged.  Arrays of module:ol/style/Style or single style objects wrapped\n * in a new feature style function.\n * @param {module:ol/style/Style~StyleFunction|!Array.<module:ol/style/Style>|!module:ol/style/Style} obj\n *     A feature style function, a single style, or an array of styles.\n * @return {module:ol/style/Style~StyleFunction} A style function.\n */\nexport function createStyleFunction(obj) {\n  if (typeof obj === 'function') {\n    return obj;\n  } else {\n    /**\n     * @type {Array.<module:ol/style/Style>}\n     */\n    let styles;\n    if (Array.isArray(obj)) {\n      styles = obj;\n    } else {\n      assert(obj instanceof Style,\n        41); // Expected an `module:ol/style/Style~Style` or an array of `module:ol/style/Style~Style`\n      styles = [obj];\n    }\n    return function() {\n      return styles;\n    };\n  }\n}\nexport default Feature;\n","/**\n * @module ol/GeolocationProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  ACCURACY: 'accuracy',\n  ACCURACY_GEOMETRY: 'accuracyGeometry',\n  ALTITUDE: 'altitude',\n  ALTITUDE_ACCURACY: 'altitudeAccuracy',\n  HEADING: 'heading',\n  POSITION: 'position',\n  PROJECTION: 'projection',\n  SPEED: 'speed',\n  TRACKING: 'tracking',\n  TRACKING_OPTIONS: 'trackingOptions'\n};\n","/**\n * @module ol/array\n */\n\n\n/**\n * Performs a binary search on the provided sorted list and returns the index of the item if found. If it can't be found it'll return -1.\n * https://github.com/darkskyapp/binary-search\n *\n * @param {Array.<*>} haystack Items to search through.\n * @param {*} needle The item to look for.\n * @param {Function=} opt_comparator Comparator function.\n * @return {number} The index of the item if found, -1 if not.\n */\nexport function binarySearch(haystack, needle, opt_comparator) {\n  let mid, cmp;\n  const comparator = opt_comparator || numberSafeCompareFunction;\n  let low = 0;\n  let high = haystack.length;\n  let found = false;\n\n  while (low < high) {\n    /* Note that \"(low + high) >>> 1\" may overflow, and results in a typecast\n     * to double (which gives the wrong results). */\n    mid = low + (high - low >> 1);\n    cmp = +comparator(haystack[mid], needle);\n\n    if (cmp < 0.0) { /* Too low. */\n      low  = mid + 1;\n\n    } else { /* Key found or too high */\n      high = mid;\n      found = !cmp;\n    }\n  }\n\n  /* Key not found. */\n  return found ? low : ~low;\n}\n\n\n/**\n * Compare function for array sort that is safe for numbers.\n * @param {*} a The first object to be compared.\n * @param {*} b The second object to be compared.\n * @return {number} A negative number, zero, or a positive number as the first\n *     argument is less than, equal to, or greater than the second.\n */\nexport function numberSafeCompareFunction(a, b) {\n  return a > b ? 1 : a < b ? -1 : 0;\n}\n\n\n/**\n * Whether the array contains the given object.\n * @param {Array.<*>} arr The array to test for the presence of the element.\n * @param {*} obj The object for which to test.\n * @return {boolean} The object is in the array.\n */\nexport function includes(arr, obj) {\n  return arr.indexOf(obj) >= 0;\n}\n\n\n/**\n * @param {Array.<number>} arr Array.\n * @param {number} target Target.\n * @param {number} direction 0 means return the nearest, > 0\n *    means return the largest nearest, < 0 means return the\n *    smallest nearest.\n * @return {number} Index.\n */\nexport function linearFindNearest(arr, target, direction) {\n  const n = arr.length;\n  if (arr[0] <= target) {\n    return 0;\n  } else if (target <= arr[n - 1]) {\n    return n - 1;\n  } else {\n    let i;\n    if (direction > 0) {\n      for (i = 1; i < n; ++i) {\n        if (arr[i] < target) {\n          return i - 1;\n        }\n      }\n    } else if (direction < 0) {\n      for (i = 1; i < n; ++i) {\n        if (arr[i] <= target) {\n          return i;\n        }\n      }\n    } else {\n      for (i = 1; i < n; ++i) {\n        if (arr[i] == target) {\n          return i;\n        } else if (arr[i] < target) {\n          if (arr[i - 1] - target < target - arr[i]) {\n            return i - 1;\n          } else {\n            return i;\n          }\n        }\n      }\n    }\n    return n - 1;\n  }\n}\n\n\n/**\n * @param {Array.<*>} arr Array.\n * @param {number} begin Begin index.\n * @param {number} end End index.\n */\nexport function reverseSubArray(arr, begin, end) {\n  while (begin < end) {\n    const tmp = arr[begin];\n    arr[begin] = arr[end];\n    arr[end] = tmp;\n    ++begin;\n    --end;\n  }\n}\n\n\n/**\n * @param {Array.<VALUE>} arr The array to modify.\n * @param {!Array.<VALUE>|VALUE} data The elements or arrays of elements to add to arr.\n * @template VALUE\n */\nexport function extend(arr, data) {\n  const extension = Array.isArray(data) ? data : [data];\n  const length = extension.length;\n  for (let i = 0; i < length; i++) {\n    arr[arr.length] = extension[i];\n  }\n}\n\n\n/**\n * @param {Array.<VALUE>} arr The array to modify.\n * @param {VALUE} obj The element to remove.\n * @template VALUE\n * @return {boolean} If the element was removed.\n */\nexport function remove(arr, obj) {\n  const i = arr.indexOf(obj);\n  const found = i > -1;\n  if (found) {\n    arr.splice(i, 1);\n  }\n  return found;\n}\n\n\n/**\n * @param {Array.<VALUE>} arr The array to search in.\n * @param {function(VALUE, number, ?) : boolean} func The function to compare.\n * @template VALUE\n * @return {VALUE|null} The element found or null.\n */\nexport function find(arr, func) {\n  const length = arr.length >>> 0;\n  let value;\n\n  for (let i = 0; i < length; i++) {\n    value = arr[i];\n    if (func(value, i, arr)) {\n      return value;\n    }\n  }\n  return null;\n}\n\n\n/**\n * @param {Array|Uint8ClampedArray} arr1 The first array to compare.\n * @param {Array|Uint8ClampedArray} arr2 The second array to compare.\n * @return {boolean} Whether the two arrays are equal.\n */\nexport function equals(arr1, arr2) {\n  const len1 = arr1.length;\n  if (len1 !== arr2.length) {\n    return false;\n  }\n  for (let i = 0; i < len1; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n\n/**\n * @param {Array.<*>} arr The array to sort (modifies original).\n * @param {Function} compareFnc Comparison function.\n */\nexport function stableSort(arr, compareFnc) {\n  const length = arr.length;\n  const tmp = Array(arr.length);\n  let i;\n  for (i = 0; i < length; i++) {\n    tmp[i] = {index: i, value: arr[i]};\n  }\n  tmp.sort(function(a, b) {\n    return compareFnc(a.value, b.value) || a.index - b.index;\n  });\n  for (i = 0; i < arr.length; i++) {\n    arr[i] = tmp[i].value;\n  }\n}\n\n\n/**\n * @param {Array.<*>} arr The array to search in.\n * @param {Function} func Comparison function.\n * @return {number} Return index.\n */\nexport function findIndex(arr, func) {\n  let index;\n  const found = !arr.every(function(el, idx) {\n    index = idx;\n    return !func(el, idx, arr);\n  });\n  return found ? index : -1;\n}\n\n\n/**\n * @param {Array.<*>} arr The array to test.\n * @param {Function=} opt_func Comparison function.\n * @param {boolean=} opt_strict Strictly sorted (default false).\n * @return {boolean} Return index.\n */\nexport function isSorted(arr, opt_func, opt_strict) {\n  const compare = opt_func || numberSafeCompareFunction;\n  return arr.every(function(currentVal, index) {\n    if (index === 0) {\n      return true;\n    }\n    const res = compare(arr[index - 1], currentVal);\n    return !(res > 0 || opt_strict && res === 0);\n  });\n}\n","/**\n * @module ol/geom/GeometryLayout\n */\n\n/**\n * The coordinate layout for geometries, indicating whether a 3rd or 4th z ('Z')\n * or measure ('M') coordinate is available. Supported values are `'XY'`,\n * `'XYZ'`, `'XYM'`, `'XYZM'`.\n * @enum {string}\n */\nexport default {\n  XY: 'XY',\n  XYZ: 'XYZ',\n  XYM: 'XYM',\n  XYZM: 'XYZM'\n};\n","/**\n * @module ol/geom/SimpleGeometry\n */\nimport {inherits} from '../util.js';\nimport {FALSE} from '../functions.js';\nimport {createOrUpdateFromFlatCoordinates, getCenter} from '../extent.js';\nimport Geometry from '../geom/Geometry.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport {rotate, scale, translate, transform2D} from '../geom/flat/transform.js';\nimport {clear} from '../obj.js';\n\n/**\n * @classdesc\n * Abstract base class; only used for creating subclasses; do not instantiate\n * in apps, as cannot be rendered.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/geom/Geometry}\n * @api\n */\nconst SimpleGeometry = function() {\n\n  Geometry.call(this);\n\n  /**\n   * @protected\n   * @type {module:ol/geom/GeometryLayout}\n   */\n  this.layout = GeometryLayout.XY;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.stride = 2;\n\n  /**\n   * @protected\n   * @type {Array.<number>}\n   */\n  this.flatCoordinates = null;\n\n};\n\ninherits(SimpleGeometry, Geometry);\n\n\n/**\n * @param {number} stride Stride.\n * @return {module:ol/geom/GeometryLayout} layout Layout.\n */\nfunction getLayoutForStride(stride) {\n  let layout;\n  if (stride == 2) {\n    layout = GeometryLayout.XY;\n  } else if (stride == 3) {\n    layout = GeometryLayout.XYZ;\n  } else if (stride == 4) {\n    layout = GeometryLayout.XYZM;\n  }\n  return (\n    /** @type {module:ol/geom/GeometryLayout} */ (layout)\n  );\n}\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @return {number} Stride.\n */\nexport function getStrideForLayout(layout) {\n  let stride;\n  if (layout == GeometryLayout.XY) {\n    stride = 2;\n  } else if (layout == GeometryLayout.XYZ || layout == GeometryLayout.XYM) {\n    stride = 3;\n  } else if (layout == GeometryLayout.XYZM) {\n    stride = 4;\n  }\n  return /** @type {number} */ (stride);\n}\n\n\n/**\n * @inheritDoc\n */\nSimpleGeometry.prototype.containsXY = FALSE;\n\n\n/**\n * @inheritDoc\n */\nSimpleGeometry.prototype.computeExtent = function(extent) {\n  return createOrUpdateFromFlatCoordinates(this.flatCoordinates,\n    0, this.flatCoordinates.length, this.stride, extent);\n};\n\n\n/**\n * @abstract\n * @return {Array} Coordinates.\n */\nSimpleGeometry.prototype.getCoordinates = function() {};\n\n\n/**\n * Return the first coordinate of the geometry.\n * @return {module:ol/coordinate~Coordinate} First coordinate.\n * @api\n */\nSimpleGeometry.prototype.getFirstCoordinate = function() {\n  return this.flatCoordinates.slice(0, this.stride);\n};\n\n\n/**\n * @return {Array.<number>} Flat coordinates.\n */\nSimpleGeometry.prototype.getFlatCoordinates = function() {\n  return this.flatCoordinates;\n};\n\n\n/**\n * Return the last coordinate of the geometry.\n * @return {module:ol/coordinate~Coordinate} Last point.\n * @api\n */\nSimpleGeometry.prototype.getLastCoordinate = function() {\n  return this.flatCoordinates.slice(this.flatCoordinates.length - this.stride);\n};\n\n\n/**\n * Return the {@link module:ol/geom/GeometryLayout~GeometryLayout layout} of the geometry.\n * @return {module:ol/geom/GeometryLayout} Layout.\n * @api\n */\nSimpleGeometry.prototype.getLayout = function() {\n  return this.layout;\n};\n\n\n/**\n * @inheritDoc\n */\nSimpleGeometry.prototype.getSimplifiedGeometry = function(squaredTolerance) {\n  if (this.simplifiedGeometryRevision != this.getRevision()) {\n    clear(this.simplifiedGeometryCache);\n    this.simplifiedGeometryMaxMinSquaredTolerance = 0;\n    this.simplifiedGeometryRevision = this.getRevision();\n  }\n  // If squaredTolerance is negative or if we know that simplification will not\n  // have any effect then just return this.\n  if (squaredTolerance < 0 ||\n      (this.simplifiedGeometryMaxMinSquaredTolerance !== 0 &&\n       squaredTolerance <= this.simplifiedGeometryMaxMinSquaredTolerance)) {\n    return this;\n  }\n  const key = squaredTolerance.toString();\n  if (this.simplifiedGeometryCache.hasOwnProperty(key)) {\n    return this.simplifiedGeometryCache[key];\n  } else {\n    const simplifiedGeometry =\n        this.getSimplifiedGeometryInternal(squaredTolerance);\n    const simplifiedFlatCoordinates = simplifiedGeometry.getFlatCoordinates();\n    if (simplifiedFlatCoordinates.length < this.flatCoordinates.length) {\n      this.simplifiedGeometryCache[key] = simplifiedGeometry;\n      return simplifiedGeometry;\n    } else {\n      // Simplification did not actually remove any coordinates.  We now know\n      // that any calls to getSimplifiedGeometry with a squaredTolerance less\n      // than or equal to the current squaredTolerance will also not have any\n      // effect.  This allows us to short circuit simplification (saving CPU\n      // cycles) and prevents the cache of simplified geometries from filling\n      // up with useless identical copies of this geometry (saving memory).\n      this.simplifiedGeometryMaxMinSquaredTolerance = squaredTolerance;\n      return this;\n    }\n  }\n};\n\n\n/**\n * @param {number} squaredTolerance Squared tolerance.\n * @return {module:ol/geom/SimpleGeometry} Simplified geometry.\n * @protected\n */\nSimpleGeometry.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  return this;\n};\n\n\n/**\n * @return {number} Stride.\n */\nSimpleGeometry.prototype.getStride = function() {\n  return this.stride;\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @protected\n */\nSimpleGeometry.prototype.setFlatCoordinatesInternal = function(layout, flatCoordinates) {\n  this.stride = getStrideForLayout(layout);\n  this.layout = layout;\n  this.flatCoordinates = flatCoordinates;\n};\n\n\n/**\n * @abstract\n * @param {Array} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n */\nSimpleGeometry.prototype.setCoordinates = function(coordinates, opt_layout) {};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout|undefined} layout Layout.\n * @param {Array} coordinates Coordinates.\n * @param {number} nesting Nesting.\n * @protected\n */\nSimpleGeometry.prototype.setLayout = function(layout, coordinates, nesting) {\n  /** @type {number} */\n  let stride;\n  if (layout) {\n    stride = getStrideForLayout(layout);\n  } else {\n    for (let i = 0; i < nesting; ++i) {\n      if (coordinates.length === 0) {\n        this.layout = GeometryLayout.XY;\n        this.stride = 2;\n        return;\n      } else {\n        coordinates = /** @type {Array} */ (coordinates[0]);\n      }\n    }\n    stride = coordinates.length;\n    layout = getLayoutForStride(stride);\n  }\n  this.layout = layout;\n  this.stride = stride;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nSimpleGeometry.prototype.applyTransform = function(transformFn) {\n  if (this.flatCoordinates) {\n    transformFn(this.flatCoordinates, this.flatCoordinates, this.stride);\n    this.changed();\n  }\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nSimpleGeometry.prototype.rotate = function(angle, anchor) {\n  const flatCoordinates = this.getFlatCoordinates();\n  if (flatCoordinates) {\n    const stride = this.getStride();\n    rotate(\n      flatCoordinates, 0, flatCoordinates.length,\n      stride, angle, anchor, flatCoordinates);\n    this.changed();\n  }\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nSimpleGeometry.prototype.scale = function(sx, opt_sy, opt_anchor) {\n  let sy = opt_sy;\n  if (sy === undefined) {\n    sy = sx;\n  }\n  let anchor = opt_anchor;\n  if (!anchor) {\n    anchor = getCenter(this.getExtent());\n  }\n  const flatCoordinates = this.getFlatCoordinates();\n  if (flatCoordinates) {\n    const stride = this.getStride();\n    scale(\n      flatCoordinates, 0, flatCoordinates.length,\n      stride, sx, sy, anchor, flatCoordinates);\n    this.changed();\n  }\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nSimpleGeometry.prototype.translate = function(deltaX, deltaY) {\n  const flatCoordinates = this.getFlatCoordinates();\n  if (flatCoordinates) {\n    const stride = this.getStride();\n    translate(\n      flatCoordinates, 0, flatCoordinates.length, stride,\n      deltaX, deltaY, flatCoordinates);\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/SimpleGeometry} simpleGeometry Simple geometry.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Transformed flat coordinates.\n */\nexport function transformGeom2D(simpleGeometry, transform, opt_dest) {\n  const flatCoordinates = simpleGeometry.getFlatCoordinates();\n  if (!flatCoordinates) {\n    return null;\n  } else {\n    const stride = simpleGeometry.getStride();\n    return transform2D(\n      flatCoordinates, 0, flatCoordinates.length, stride,\n      transform, opt_dest);\n  }\n}\n\nexport default SimpleGeometry;\n","/**\n * @module ol/geom/flat/area\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {number} Area.\n */\nexport function linearRing(flatCoordinates, offset, end, stride) {\n  let twiceArea = 0;\n  let x1 = flatCoordinates[end - stride];\n  let y1 = flatCoordinates[end - stride + 1];\n  for (; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    twiceArea += y1 * x2 - x1 * y2;\n    x1 = x2;\n    y1 = y2;\n  }\n  return twiceArea / 2;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @return {number} Area.\n */\nexport function linearRings(flatCoordinates, offset, ends, stride) {\n  let area = 0;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    area += linearRing(flatCoordinates, offset, end, stride);\n    offset = end;\n  }\n  return area;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @return {number} Area.\n */\nexport function linearRingss(flatCoordinates, offset, endss, stride) {\n  let area = 0;\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    area += linearRings(flatCoordinates, offset, ends, stride);\n    offset = ends[ends.length - 1];\n  }\n  return area;\n}\n","/**\n * @module ol/geom/flat/closest\n */\nimport {lerp, squaredDistance as squaredDx} from '../../math.js';\n\n\n/**\n * Returns the point on the 2D line segment flatCoordinates[offset1] to\n * flatCoordinates[offset2] that is closest to the point (x, y).  Extra\n * dimensions are linearly interpolated.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset1 Offset 1.\n * @param {number} offset2 Offset 2.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array.<number>} closestPoint Closest point.\n */\nfunction assignClosest(flatCoordinates, offset1, offset2, stride, x, y, closestPoint) {\n  const x1 = flatCoordinates[offset1];\n  const y1 = flatCoordinates[offset1 + 1];\n  const dx = flatCoordinates[offset2] - x1;\n  const dy = flatCoordinates[offset2 + 1] - y1;\n  let offset;\n  if (dx === 0 && dy === 0) {\n    offset = offset1;\n  } else {\n    const t = ((x - x1) * dx + (y - y1) * dy) / (dx * dx + dy * dy);\n    if (t > 1) {\n      offset = offset2;\n    } else if (t > 0) {\n      for (let i = 0; i < stride; ++i) {\n        closestPoint[i] = lerp(flatCoordinates[offset1 + i],\n          flatCoordinates[offset2 + i], t);\n      }\n      closestPoint.length = stride;\n      return;\n    } else {\n      offset = offset1;\n    }\n  }\n  for (let i = 0; i < stride; ++i) {\n    closestPoint[i] = flatCoordinates[offset + i];\n  }\n  closestPoint.length = stride;\n}\n\n\n/**\n * Return the squared of the largest distance between any pair of consecutive\n * coordinates.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} max Max squared delta.\n * @return {number} Max squared delta.\n */\nexport function maxSquaredDelta(flatCoordinates, offset, end, stride, max) {\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  for (offset += stride; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    const squaredDelta = squaredDx(x1, y1, x2, y2);\n    if (squaredDelta > max) {\n      max = squaredDelta;\n    }\n    x1 = x2;\n    y1 = y2;\n  }\n  return max;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} max Max squared delta.\n * @return {number} Max squared delta.\n */\nexport function arrayMaxSquaredDelta(flatCoordinates, offset, ends, stride, max) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    max = maxSquaredDelta(\n      flatCoordinates, offset, end, stride, max);\n    offset = end;\n  }\n  return max;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} max Max squared delta.\n * @return {number} Max squared delta.\n */\nexport function multiArrayMaxSquaredDelta(flatCoordinates, offset, endss, stride, max) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    max = arrayMaxSquaredDelta(\n      flatCoordinates, offset, ends, stride, max);\n    offset = ends[ends.length - 1];\n  }\n  return max;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} maxDelta Max delta.\n * @param {boolean} isRing Is ring.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array.<number>} closestPoint Closest point.\n * @param {number} minSquaredDistance Minimum squared distance.\n * @param {Array.<number>=} opt_tmpPoint Temporary point object.\n * @return {number} Minimum squared distance.\n */\nexport function assignClosestPoint(flatCoordinates, offset, end,\n  stride, maxDelta, isRing, x, y, closestPoint, minSquaredDistance,\n  opt_tmpPoint) {\n  if (offset == end) {\n    return minSquaredDistance;\n  }\n  let i, squaredDistance;\n  if (maxDelta === 0) {\n    // All points are identical, so just test the first point.\n    squaredDistance = squaredDx(\n      x, y, flatCoordinates[offset], flatCoordinates[offset + 1]);\n    if (squaredDistance < minSquaredDistance) {\n      for (i = 0; i < stride; ++i) {\n        closestPoint[i] = flatCoordinates[offset + i];\n      }\n      closestPoint.length = stride;\n      return squaredDistance;\n    } else {\n      return minSquaredDistance;\n    }\n  }\n  const tmpPoint = opt_tmpPoint ? opt_tmpPoint : [NaN, NaN];\n  let index = offset + stride;\n  while (index < end) {\n    assignClosest(\n      flatCoordinates, index - stride, index, stride, x, y, tmpPoint);\n    squaredDistance = squaredDx(x, y, tmpPoint[0], tmpPoint[1]);\n    if (squaredDistance < minSquaredDistance) {\n      minSquaredDistance = squaredDistance;\n      for (i = 0; i < stride; ++i) {\n        closestPoint[i] = tmpPoint[i];\n      }\n      closestPoint.length = stride;\n      index += stride;\n    } else {\n      // Skip ahead multiple points, because we know that all the skipped\n      // points cannot be any closer than the closest point we have found so\n      // far.  We know this because we know how close the current point is, how\n      // close the closest point we have found so far is, and the maximum\n      // distance between consecutive points.  For example, if we're currently\n      // at distance 10, the best we've found so far is 3, and that the maximum\n      // distance between consecutive points is 2, then we'll need to skip at\n      // least (10 - 3) / 2 == 3 (rounded down) points to have any chance of\n      // finding a closer point.  We use Math.max(..., 1) to ensure that we\n      // always advance at least one point, to avoid an infinite loop.\n      index += stride * Math.max(\n        ((Math.sqrt(squaredDistance) -\n            Math.sqrt(minSquaredDistance)) / maxDelta) | 0, 1);\n    }\n  }\n  if (isRing) {\n    // Check the closing segment.\n    assignClosest(\n      flatCoordinates, end - stride, offset, stride, x, y, tmpPoint);\n    squaredDistance = squaredDx(x, y, tmpPoint[0], tmpPoint[1]);\n    if (squaredDistance < minSquaredDistance) {\n      minSquaredDistance = squaredDistance;\n      for (i = 0; i < stride; ++i) {\n        closestPoint[i] = tmpPoint[i];\n      }\n      closestPoint.length = stride;\n    }\n  }\n  return minSquaredDistance;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} maxDelta Max delta.\n * @param {boolean} isRing Is ring.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array.<number>} closestPoint Closest point.\n * @param {number} minSquaredDistance Minimum squared distance.\n * @param {Array.<number>=} opt_tmpPoint Temporary point object.\n * @return {number} Minimum squared distance.\n */\nexport function assignClosestArrayPoint(flatCoordinates, offset, ends,\n  stride, maxDelta, isRing, x, y, closestPoint, minSquaredDistance,\n  opt_tmpPoint) {\n  const tmpPoint = opt_tmpPoint ? opt_tmpPoint : [NaN, NaN];\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    minSquaredDistance = assignClosestPoint(\n      flatCoordinates, offset, end, stride,\n      maxDelta, isRing, x, y, closestPoint, minSquaredDistance, tmpPoint);\n    offset = end;\n  }\n  return minSquaredDistance;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} maxDelta Max delta.\n * @param {boolean} isRing Is ring.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array.<number>} closestPoint Closest point.\n * @param {number} minSquaredDistance Minimum squared distance.\n * @param {Array.<number>=} opt_tmpPoint Temporary point object.\n * @return {number} Minimum squared distance.\n */\nexport function assignClosestMultiArrayPoint(flatCoordinates, offset,\n  endss, stride, maxDelta, isRing, x, y, closestPoint, minSquaredDistance,\n  opt_tmpPoint) {\n  const tmpPoint = opt_tmpPoint ? opt_tmpPoint : [NaN, NaN];\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    minSquaredDistance = assignClosestArrayPoint(\n      flatCoordinates, offset, ends, stride,\n      maxDelta, isRing, x, y, closestPoint, minSquaredDistance, tmpPoint);\n    offset = ends[ends.length - 1];\n  }\n  return minSquaredDistance;\n}\n","/**\n * @module ol/geom/flat/deflate\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} stride Stride.\n * @return {number} offset Offset.\n */\nexport function deflateCoordinate(flatCoordinates, offset, coordinate, stride) {\n  for (let i = 0, ii = coordinate.length; i < ii; ++i) {\n    flatCoordinates[offset++] = coordinate[i];\n  }\n  return offset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {number} stride Stride.\n * @return {number} offset Offset.\n */\nexport function deflateCoordinates(flatCoordinates, offset, coordinates, stride) {\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    const coordinate = coordinates[i];\n    for (let j = 0; j < stride; ++j) {\n      flatCoordinates[offset++] = coordinate[j];\n    }\n  }\n  return offset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} coordinatess Coordinatess.\n * @param {number} stride Stride.\n * @param {Array.<number>=} opt_ends Ends.\n * @return {Array.<number>} Ends.\n */\nexport function deflateCoordinatesArray(flatCoordinates, offset, coordinatess, stride, opt_ends) {\n  const ends = opt_ends ? opt_ends : [];\n  let i = 0;\n  for (let j = 0, jj = coordinatess.length; j < jj; ++j) {\n    const end = deflateCoordinates(\n      flatCoordinates, offset, coordinatess[j], stride);\n    ends[i++] = end;\n    offset = end;\n  }\n  ends.length = i;\n  return ends;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>} coordinatesss Coordinatesss.\n * @param {number} stride Stride.\n * @param {Array.<Array.<number>>=} opt_endss Endss.\n * @return {Array.<Array.<number>>} Endss.\n */\nexport function deflateMultiCoordinatesArray(flatCoordinates, offset, coordinatesss, stride, opt_endss) {\n  const endss = opt_endss ? opt_endss : [];\n  let i = 0;\n  for (let j = 0, jj = coordinatesss.length; j < jj; ++j) {\n    const ends = deflateCoordinatesArray(\n      flatCoordinates, offset, coordinatesss[j], stride, endss[i]);\n    endss[i++] = ends;\n    offset = ends[ends.length - 1];\n  }\n  endss.length = i;\n  return endss;\n}\n","/**\n * @module ol/geom/flat/inflate\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {Array.<module:ol/coordinate~Coordinate>=} opt_coordinates Coordinates.\n * @return {Array.<module:ol/coordinate~Coordinate>} Coordinates.\n */\nexport function inflateCoordinates(flatCoordinates, offset, end, stride, opt_coordinates) {\n  const coordinates = opt_coordinates !== undefined ? opt_coordinates : [];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    coordinates[i++] = flatCoordinates.slice(j, j + stride);\n  }\n  coordinates.length = i;\n  return coordinates;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>=} opt_coordinatess Coordinatess.\n * @return {Array.<Array.<module:ol/coordinate~Coordinate>>} Coordinatess.\n */\nexport function inflateCoordinatesArray(flatCoordinates, offset, ends, stride, opt_coordinatess) {\n  const coordinatess = opt_coordinatess !== undefined ? opt_coordinatess : [];\n  let i = 0;\n  for (let j = 0, jj = ends.length; j < jj; ++j) {\n    const end = ends[j];\n    coordinatess[i++] = inflateCoordinates(\n      flatCoordinates, offset, end, stride, coordinatess[i]);\n    offset = end;\n  }\n  coordinatess.length = i;\n  return coordinatess;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>=} opt_coordinatesss\n *     Coordinatesss.\n * @return {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>} Coordinatesss.\n */\nexport function inflateMultiCoordinatesArray(flatCoordinates, offset, endss, stride, opt_coordinatesss) {\n  const coordinatesss = opt_coordinatesss !== undefined ? opt_coordinatesss : [];\n  let i = 0;\n  for (let j = 0, jj = endss.length; j < jj; ++j) {\n    const ends = endss[j];\n    coordinatesss[i++] = inflateCoordinatesArray(\n      flatCoordinates, offset, ends, stride, coordinatesss[i]);\n    offset = ends[ends.length - 1];\n  }\n  coordinatesss.length = i;\n  return coordinatesss;\n}\n","/**\n * @module ol/geom/flat/simplify\n */\n// Based on simplify-js https://github.com/mourner/simplify-js\n// Copyright (c) 2012, Vladimir Agafonkin\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n//    1. Redistributions of source code must retain the above copyright notice,\n//       this list of conditions and the following disclaimer.\n//\n//    2. Redistributions in binary form must reproduce the above copyright\n//       notice, this list of conditions and the following disclaimer in the\n//       documentation and/or other materials provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n// ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE\n// LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n// SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n// INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n// CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n// POSSIBILITY OF SUCH DAMAGE.\n\nimport {squaredSegmentDistance, squaredDistance} from '../../math.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {boolean} highQuality Highest quality.\n * @param {Array.<number>=} opt_simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @return {Array.<number>} Simplified line string.\n */\nexport function simplifyLineString(flatCoordinates, offset, end,\n  stride, squaredTolerance, highQuality, opt_simplifiedFlatCoordinates) {\n  const simplifiedFlatCoordinates = opt_simplifiedFlatCoordinates !== undefined ?\n    opt_simplifiedFlatCoordinates : [];\n  if (!highQuality) {\n    end = radialDistance(flatCoordinates, offset, end,\n      stride, squaredTolerance,\n      simplifiedFlatCoordinates, 0);\n    flatCoordinates = simplifiedFlatCoordinates;\n    offset = 0;\n    stride = 2;\n  }\n  simplifiedFlatCoordinates.length = douglasPeucker(\n    flatCoordinates, offset, end, stride, squaredTolerance,\n    simplifiedFlatCoordinates, 0);\n  return simplifiedFlatCoordinates;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @return {number} Simplified offset.\n */\nexport function douglasPeucker(flatCoordinates, offset, end,\n  stride, squaredTolerance, simplifiedFlatCoordinates, simplifiedOffset) {\n  const n = (end - offset) / stride;\n  if (n < 3) {\n    for (; offset < end; offset += stride) {\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset];\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + 1];\n    }\n    return simplifiedOffset;\n  }\n  /** @type {Array.<number>} */\n  const markers = new Array(n);\n  markers[0] = 1;\n  markers[n - 1] = 1;\n  /** @type {Array.<number>} */\n  const stack = [offset, end - stride];\n  let index = 0;\n  while (stack.length > 0) {\n    const last = stack.pop();\n    const first = stack.pop();\n    let maxSquaredDistance = 0;\n    const x1 = flatCoordinates[first];\n    const y1 = flatCoordinates[first + 1];\n    const x2 = flatCoordinates[last];\n    const y2 = flatCoordinates[last + 1];\n    for (let i = first + stride; i < last; i += stride) {\n      const x = flatCoordinates[i];\n      const y = flatCoordinates[i + 1];\n      const squaredDistance = squaredSegmentDistance(\n        x, y, x1, y1, x2, y2);\n      if (squaredDistance > maxSquaredDistance) {\n        index = i;\n        maxSquaredDistance = squaredDistance;\n      }\n    }\n    if (maxSquaredDistance > squaredTolerance) {\n      markers[(index - offset) / stride] = 1;\n      if (first + stride < index) {\n        stack.push(first, index);\n      }\n      if (index + stride < last) {\n        stack.push(index, last);\n      }\n    }\n  }\n  for (let i = 0; i < n; ++i) {\n    if (markers[i]) {\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + i * stride];\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + i * stride + 1];\n    }\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array.<number>} simplifiedEnds Simplified ends.\n * @return {number} Simplified offset.\n */\nexport function douglasPeuckerArray(flatCoordinates, offset,\n  ends, stride, squaredTolerance, simplifiedFlatCoordinates,\n  simplifiedOffset, simplifiedEnds) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    simplifiedOffset = douglasPeucker(\n      flatCoordinates, offset, end, stride, squaredTolerance,\n      simplifiedFlatCoordinates, simplifiedOffset);\n    simplifiedEnds.push(simplifiedOffset);\n    offset = end;\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array.<Array.<number>>} simplifiedEndss Simplified endss.\n * @return {number} Simplified offset.\n */\nexport function douglasPeuckerMultiArray(\n  flatCoordinates, offset, endss, stride, squaredTolerance,\n  simplifiedFlatCoordinates, simplifiedOffset, simplifiedEndss) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    const simplifiedEnds = [];\n    simplifiedOffset = douglasPeuckerArray(\n      flatCoordinates, offset, ends, stride, squaredTolerance,\n      simplifiedFlatCoordinates, simplifiedOffset, simplifiedEnds);\n    simplifiedEndss.push(simplifiedEnds);\n    offset = ends[ends.length - 1];\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @return {number} Simplified offset.\n */\nexport function radialDistance(flatCoordinates, offset, end,\n  stride, squaredTolerance, simplifiedFlatCoordinates, simplifiedOffset) {\n  if (end <= offset + stride) {\n    // zero or one point, no simplification possible, so copy and return\n    for (; offset < end; offset += stride) {\n      simplifiedFlatCoordinates[simplifiedOffset++] = flatCoordinates[offset];\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + 1];\n    }\n    return simplifiedOffset;\n  }\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  // copy first point\n  simplifiedFlatCoordinates[simplifiedOffset++] = x1;\n  simplifiedFlatCoordinates[simplifiedOffset++] = y1;\n  let x2 = x1;\n  let y2 = y1;\n  for (offset += stride; offset < end; offset += stride) {\n    x2 = flatCoordinates[offset];\n    y2 = flatCoordinates[offset + 1];\n    if (squaredDistance(x1, y1, x2, y2) > squaredTolerance) {\n      // copy point at offset\n      simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n      simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n      x1 = x2;\n      y1 = y2;\n    }\n  }\n  if (x2 != x1 || y2 != y1) {\n    // copy last point\n    simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n    simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {number} value Value.\n * @param {number} tolerance Tolerance.\n * @return {number} Rounded value.\n */\nexport function snap(value, tolerance) {\n  return tolerance * Math.round(value / tolerance);\n}\n\n\n/**\n * Simplifies a line string using an algorithm designed by Tim Schaub.\n * Coordinates are snapped to the nearest value in a virtual grid and\n * consecutive duplicate coordinates are discarded.  This effectively preserves\n * topology as the simplification of any subsection of a line string is\n * independent of the rest of the line string.  This means that, for examples,\n * the common edge between two polygons will be simplified to the same line\n * string independently in both polygons.  This implementation uses a single\n * pass over the coordinates and eliminates intermediate collinear points.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} tolerance Tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @return {number} Simplified offset.\n */\nexport function quantize(flatCoordinates, offset, end, stride,\n  tolerance, simplifiedFlatCoordinates, simplifiedOffset) {\n  // do nothing if the line is empty\n  if (offset == end) {\n    return simplifiedOffset;\n  }\n  // snap the first coordinate (P1)\n  let x1 = snap(flatCoordinates[offset], tolerance);\n  let y1 = snap(flatCoordinates[offset + 1], tolerance);\n  offset += stride;\n  // add the first coordinate to the output\n  simplifiedFlatCoordinates[simplifiedOffset++] = x1;\n  simplifiedFlatCoordinates[simplifiedOffset++] = y1;\n  // find the next coordinate that does not snap to the same value as the first\n  // coordinate (P2)\n  let x2, y2;\n  do {\n    x2 = snap(flatCoordinates[offset], tolerance);\n    y2 = snap(flatCoordinates[offset + 1], tolerance);\n    offset += stride;\n    if (offset == end) {\n      // all coordinates snap to the same value, the line collapses to a point\n      // push the last snapped value anyway to ensure that the output contains\n      // at least two points\n      // FIXME should we really return at least two points anyway?\n      simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n      simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n      return simplifiedOffset;\n    }\n  } while (x2 == x1 && y2 == y1);\n  while (offset < end) {\n    // snap the next coordinate (P3)\n    const x3 = snap(flatCoordinates[offset], tolerance);\n    const y3 = snap(flatCoordinates[offset + 1], tolerance);\n    offset += stride;\n    // skip P3 if it is equal to P2\n    if (x3 == x2 && y3 == y2) {\n      continue;\n    }\n    // calculate the delta between P1 and P2\n    const dx1 = x2 - x1;\n    const dy1 = y2 - y1;\n    // calculate the delta between P3 and P1\n    const dx2 = x3 - x1;\n    const dy2 = y3 - y1;\n    // if P1, P2, and P3 are colinear and P3 is further from P1 than P2 is from\n    // P1 in the same direction then P2 is on the straight line between P1 and\n    // P3\n    if ((dx1 * dy2 == dy1 * dx2) &&\n        ((dx1 < 0 && dx2 < dx1) || dx1 == dx2 || (dx1 > 0 && dx2 > dx1)) &&\n        ((dy1 < 0 && dy2 < dy1) || dy1 == dy2 || (dy1 > 0 && dy2 > dy1))) {\n      // discard P2 and set P2 = P3\n      x2 = x3;\n      y2 = y3;\n      continue;\n    }\n    // either P1, P2, and P3 are not colinear, or they are colinear but P3 is\n    // between P3 and P1 or on the opposite half of the line to P2.  add P2,\n    // and continue with P1 = P2 and P2 = P3\n    simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n    simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n    x1 = x2;\n    y1 = y2;\n    x2 = x3;\n    y2 = y3;\n  }\n  // add the last point (P2)\n  simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n  simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} tolerance Tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array.<number>} simplifiedEnds Simplified ends.\n * @return {number} Simplified offset.\n */\nexport function quantizeArray(\n  flatCoordinates, offset, ends, stride,\n  tolerance,\n  simplifiedFlatCoordinates, simplifiedOffset, simplifiedEnds) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    simplifiedOffset = quantize(\n      flatCoordinates, offset, end, stride,\n      tolerance,\n      simplifiedFlatCoordinates, simplifiedOffset);\n    simplifiedEnds.push(simplifiedOffset);\n    offset = end;\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} tolerance Tolerance.\n * @param {Array.<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array.<Array.<number>>} simplifiedEndss Simplified endss.\n * @return {number} Simplified offset.\n */\nexport function quantizeMultiArray(\n  flatCoordinates, offset, endss, stride,\n  tolerance,\n  simplifiedFlatCoordinates, simplifiedOffset, simplifiedEndss) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    const simplifiedEnds = [];\n    simplifiedOffset = quantizeArray(\n      flatCoordinates, offset, ends, stride,\n      tolerance,\n      simplifiedFlatCoordinates, simplifiedOffset, simplifiedEnds);\n    simplifiedEndss.push(simplifiedEnds);\n    offset = ends[ends.length - 1];\n  }\n  return simplifiedOffset;\n}\n","/**\n * @module ol/geom/LinearRing\n */\nimport {inherits} from '../util.js';\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {linearRing as linearRingArea} from '../geom/flat/area.js';\nimport {assignClosestPoint, maxSquaredDelta} from '../geom/flat/closest.js';\nimport {deflateCoordinates} from '../geom/flat/deflate.js';\nimport {inflateCoordinates} from '../geom/flat/inflate.js';\nimport {douglasPeucker} from '../geom/flat/simplify.js';\n\n/**\n * @classdesc\n * Linear ring geometry. Only used as part of polygon; cannot be rendered\n * on its own.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst LinearRing = function(coordinates, opt_layout) {\n\n  SimpleGeometry.call(this);\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDelta_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDeltaRevision_ = -1;\n\n  this.setCoordinates(coordinates, opt_layout);\n\n};\n\ninherits(LinearRing, SimpleGeometry);\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/LinearRing} Clone.\n * @override\n * @api\n */\nLinearRing.prototype.clone = function() {\n  const linearRing = new LinearRing(null);\n  linearRing.setFlatCoordinates(this.layout, this.flatCoordinates.slice());\n  return linearRing;\n};\n\n\n/**\n * @inheritDoc\n */\nLinearRing.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  if (this.maxDeltaRevision_ != this.getRevision()) {\n    this.maxDelta_ = Math.sqrt(maxSquaredDelta(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride, 0));\n    this.maxDeltaRevision_ = this.getRevision();\n  }\n  return assignClosestPoint(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    this.maxDelta_, true, x, y, closestPoint, minSquaredDistance);\n};\n\n\n/**\n * Return the area of the linear ring on projected plane.\n * @return {number} Area (on projected plane).\n * @api\n */\nLinearRing.prototype.getArea = function() {\n  return linearRingArea(this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n};\n\n\n/**\n * Return the coordinates of the linear ring.\n * @return {Array.<module:ol/coordinate~Coordinate>} Coordinates.\n * @override\n * @api\n */\nLinearRing.prototype.getCoordinates = function() {\n  return inflateCoordinates(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n};\n\n\n/**\n * @inheritDoc\n */\nLinearRing.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  const simplifiedFlatCoordinates = [];\n  simplifiedFlatCoordinates.length = douglasPeucker(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    squaredTolerance, simplifiedFlatCoordinates, 0);\n  const simplifiedLinearRing = new LinearRing(null);\n  simplifiedLinearRing.setFlatCoordinates(\n    GeometryLayout.XY, simplifiedFlatCoordinates);\n  return simplifiedLinearRing;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nLinearRing.prototype.getType = function() {\n  return GeometryType.LINEAR_RING;\n};\n\n\n/**\n * @inheritDoc\n */\nLinearRing.prototype.intersectsExtent = function(extent) {};\n\n\n/**\n * Set the coordinates of the linear ring.\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nLinearRing.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null);\n  } else {\n    this.setLayout(opt_layout, coordinates, 1);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinates(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n */\nLinearRing.prototype.setFlatCoordinates = function(layout, flatCoordinates) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.changed();\n};\nexport default LinearRing;\n","/**\n * @module ol/geom/Point\n */\nimport {inherits} from '../util.js';\nimport {createOrUpdateFromCoordinate, containsXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {deflateCoordinate} from '../geom/flat/deflate.js';\nimport {squaredDistance as squaredDx} from '../math.js';\n\n/**\n * @classdesc\n * Point geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {module:ol/coordinate~Coordinate} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst Point = function(coordinates, opt_layout) {\n  SimpleGeometry.call(this);\n  this.setCoordinates(coordinates, opt_layout);\n};\n\ninherits(Point, SimpleGeometry);\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/Point} Clone.\n * @override\n * @api\n */\nPoint.prototype.clone = function() {\n  const point = new Point(null);\n  point.setFlatCoordinates(this.layout, this.flatCoordinates.slice());\n  return point;\n};\n\n\n/**\n * @inheritDoc\n */\nPoint.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  const flatCoordinates = this.flatCoordinates;\n  const squaredDistance = squaredDx(x, y, flatCoordinates[0], flatCoordinates[1]);\n  if (squaredDistance < minSquaredDistance) {\n    const stride = this.stride;\n    for (let i = 0; i < stride; ++i) {\n      closestPoint[i] = flatCoordinates[i];\n    }\n    closestPoint.length = stride;\n    return squaredDistance;\n  } else {\n    return minSquaredDistance;\n  }\n};\n\n\n/**\n * Return the coordinate of the point.\n * @return {module:ol/coordinate~Coordinate} Coordinates.\n * @override\n * @api\n */\nPoint.prototype.getCoordinates = function() {\n  return !this.flatCoordinates ? [] : this.flatCoordinates.slice();\n};\n\n\n/**\n * @inheritDoc\n */\nPoint.prototype.computeExtent = function(extent) {\n  return createOrUpdateFromCoordinate(this.flatCoordinates, extent);\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nPoint.prototype.getType = function() {\n  return GeometryType.POINT;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nPoint.prototype.intersectsExtent = function(extent) {\n  return containsXY(extent, this.flatCoordinates[0], this.flatCoordinates[1]);\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nPoint.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null);\n  } else {\n    this.setLayout(opt_layout, coordinates, 0);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinate(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n */\nPoint.prototype.setFlatCoordinates = function(layout, flatCoordinates) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.changed();\n};\nexport default Point;\n","/**\n * @module ol/geom/flat/contains\n */\nimport {forEachCorner} from '../../extent.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} Contains extent.\n */\nexport function linearRingContainsExtent(flatCoordinates, offset, end, stride, extent) {\n  const outside = forEachCorner(extent,\n    /**\n     * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n     * @return {boolean} Contains (x, y).\n     */\n    function(coordinate) {\n      return !linearRingContainsXY(flatCoordinates, offset, end, stride, coordinate[0], coordinate[1]);\n    });\n  return !outside;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nexport function linearRingContainsXY(flatCoordinates, offset, end, stride, x, y) {\n  // http://geomalgorithms.com/a03-_inclusion.html\n  // Copyright 2000 softSurfer, 2012 Dan Sunday\n  // This code may be freely used and modified for any purpose\n  // providing that this copyright notice is included with it.\n  // SoftSurfer makes no warranty for this code, and cannot be held\n  // liable for any real or imagined damage resulting from its use.\n  // Users of this code must verify correctness for their application.\n  let wn = 0;\n  let x1 = flatCoordinates[end - stride];\n  let y1 = flatCoordinates[end - stride + 1];\n  for (; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    if (y1 <= y) {\n      if (y2 > y && ((x2 - x1) * (y - y1)) - ((x - x1) * (y2 - y1)) > 0) {\n        wn++;\n      }\n    } else if (y2 <= y && ((x2 - x1) * (y - y1)) - ((x - x1) * (y2 - y1)) < 0) {\n      wn--;\n    }\n    x1 = x2;\n    y1 = y2;\n  }\n  return wn !== 0;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nexport function linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y) {\n  if (ends.length === 0) {\n    return false;\n  }\n  if (!linearRingContainsXY(flatCoordinates, offset, ends[0], stride, x, y)) {\n    return false;\n  }\n  for (let i = 1, ii = ends.length; i < ii; ++i) {\n    if (linearRingContainsXY(flatCoordinates, ends[i - 1], ends[i], stride, x, y)) {\n      return false;\n    }\n  }\n  return true;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nexport function linearRingssContainsXY(flatCoordinates, offset, endss, stride, x, y) {\n  if (endss.length === 0) {\n    return false;\n  }\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    if (linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y)) {\n      return true;\n    }\n    offset = ends[ends.length - 1];\n  }\n  return false;\n}\n","/**\n * @module ol/geom/flat/interiorpoint\n */\nimport {numberSafeCompareFunction} from '../../array.js';\nimport {linearRingsContainsXY} from '../flat/contains.js';\n\n\n/**\n * Calculates a point that is likely to lie in the interior of the linear rings.\n * Inspired by JTS's com.vividsolutions.jts.geom.Geometry#getInteriorPoint.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {Array.<number>} flatCenters Flat centers.\n * @param {number} flatCentersOffset Flat center offset.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Destination point as XYM coordinate, where M is the\n * length of the horizontal intersection that the point belongs to.\n */\nexport function getInteriorPointOfArray(flatCoordinates, offset,\n  ends, stride, flatCenters, flatCentersOffset, opt_dest) {\n  let i, ii, x, x1, x2, y1, y2;\n  const y = flatCenters[flatCentersOffset + 1];\n  /** @type {Array.<number>} */\n  const intersections = [];\n  // Calculate intersections with the horizontal line\n  for (let r = 0, rr = ends.length; r < rr; ++r) {\n    const end = ends[r];\n    x1 = flatCoordinates[end - stride];\n    y1 = flatCoordinates[end - stride + 1];\n    for (i = offset; i < end; i += stride) {\n      x2 = flatCoordinates[i];\n      y2 = flatCoordinates[i + 1];\n      if ((y <= y1 && y2 <= y) || (y1 <= y && y <= y2)) {\n        x = (y - y1) / (y2 - y1) * (x2 - x1) + x1;\n        intersections.push(x);\n      }\n      x1 = x2;\n      y1 = y2;\n    }\n  }\n  // Find the longest segment of the horizontal line that has its center point\n  // inside the linear ring.\n  let pointX = NaN;\n  let maxSegmentLength = -Infinity;\n  intersections.sort(numberSafeCompareFunction);\n  x1 = intersections[0];\n  for (i = 1, ii = intersections.length; i < ii; ++i) {\n    x2 = intersections[i];\n    const segmentLength = Math.abs(x2 - x1);\n    if (segmentLength > maxSegmentLength) {\n      x = (x1 + x2) / 2;\n      if (linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y)) {\n        pointX = x;\n        maxSegmentLength = segmentLength;\n      }\n    }\n    x1 = x2;\n  }\n  if (isNaN(pointX)) {\n    // There is no horizontal line that has its center point inside the linear\n    // ring.  Use the center of the the linear ring's extent.\n    pointX = flatCenters[flatCentersOffset];\n  }\n  if (opt_dest) {\n    opt_dest.push(pointX, y, maxSegmentLength);\n    return opt_dest;\n  } else {\n    return [pointX, y, maxSegmentLength];\n  }\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {Array.<number>} flatCenters Flat centers.\n * @return {Array.<number>} Interior points as XYM coordinates, where M is the\n * length of the horizontal intersection that the point belongs to.\n */\nexport function getInteriorPointsOfMultiArray(flatCoordinates, offset, endss, stride, flatCenters) {\n  let interiorPoints = [];\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    interiorPoints = getInteriorPointOfArray(flatCoordinates,\n      offset, ends, stride, flatCenters, 2 * i, interiorPoints);\n    offset = ends[ends.length - 1];\n  }\n  return interiorPoints;\n}\n","/**\n * @module ol/geom/flat/segments\n */\n\n\n/**\n * This function calls `callback` for each segment of the flat coordinates\n * array. If the callback returns a truthy value the function returns that\n * value immediately. Otherwise the function returns `false`.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {function(this: S, module:ol/coordinate~Coordinate, module:ol/coordinate~Coordinate): T} callback Function\n *     called for each segment.\n * @param {S=} opt_this The object to be used as the value of 'this'\n *     within callback.\n * @return {T|boolean} Value.\n * @template T,S\n */\nexport function forEach(flatCoordinates, offset, end, stride, callback, opt_this) {\n  const point1 = [flatCoordinates[offset], flatCoordinates[offset + 1]];\n  const point2 = [];\n  let ret;\n  for (; (offset + stride) < end; offset += stride) {\n    point2[0] = flatCoordinates[offset + stride];\n    point2[1] = flatCoordinates[offset + stride + 1];\n    ret = callback.call(opt_this, point1, point2);\n    if (ret) {\n      return ret;\n    }\n    point1[0] = point2[0];\n    point1[1] = point2[1];\n  }\n  return false;\n}\n","/**\n * @module ol/geom/flat/intersectsextent\n */\nimport {containsExtent, createEmpty, extendFlatCoordinates, intersects, intersectsSegment} from '../../extent.js';\nimport {linearRingContainsXY, linearRingContainsExtent} from '../flat/contains.js';\nimport {forEach as forEachSegment} from '../flat/segments.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLineString(flatCoordinates, offset, end, stride, extent) {\n  const coordinatesExtent = extendFlatCoordinates(\n    createEmpty(), flatCoordinates, offset, end, stride);\n  if (!intersects(extent, coordinatesExtent)) {\n    return false;\n  }\n  if (containsExtent(extent, coordinatesExtent)) {\n    return true;\n  }\n  if (coordinatesExtent[0] >= extent[0] &&\n      coordinatesExtent[2] <= extent[2]) {\n    return true;\n  }\n  if (coordinatesExtent[1] >= extent[1] &&\n      coordinatesExtent[3] <= extent[3]) {\n    return true;\n  }\n  return forEachSegment(flatCoordinates, offset, end, stride,\n    /**\n     * @param {module:ol/coordinate~Coordinate} point1 Start point.\n     * @param {module:ol/coordinate~Coordinate} point2 End point.\n     * @return {boolean} `true` if the segment and the extent intersect,\n     *     `false` otherwise.\n     */\n    function(point1, point2) {\n      return intersectsSegment(extent, point1, point2);\n    });\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLineStringArray(flatCoordinates, offset, ends, stride, extent) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    if (intersectsLineString(\n      flatCoordinates, offset, ends[i], stride, extent)) {\n      return true;\n    }\n    offset = ends[i];\n  }\n  return false;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLinearRing(flatCoordinates, offset, end, stride, extent) {\n  if (intersectsLineString(\n    flatCoordinates, offset, end, stride, extent)) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[0], extent[1])) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[0], extent[3])) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[2], extent[1])) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[2], extent[3])) {\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLinearRingArray(flatCoordinates, offset, ends, stride, extent) {\n  if (!intersectsLinearRing(\n    flatCoordinates, offset, ends[0], stride, extent)) {\n    return false;\n  }\n  if (ends.length === 1) {\n    return true;\n  }\n  for (let i = 1, ii = ends.length; i < ii; ++i) {\n    if (linearRingContainsExtent(flatCoordinates, ends[i - 1], ends[i], stride, extent)) {\n      return false;\n    }\n  }\n  return true;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLinearRingMultiArray(flatCoordinates, offset, endss, stride, extent) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    if (intersectsLinearRingArray(\n      flatCoordinates, offset, ends, stride, extent)) {\n      return true;\n    }\n    offset = ends[ends.length - 1];\n  }\n  return false;\n}\n","/**\n * @module ol/geom/flat/reverse\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n */\nexport function coordinates(flatCoordinates, offset, end, stride) {\n  while (offset < end - stride) {\n    for (let i = 0; i < stride; ++i) {\n      const tmp = flatCoordinates[offset + i];\n      flatCoordinates[offset + i] = flatCoordinates[end - stride + i];\n      flatCoordinates[end - stride + i] = tmp;\n    }\n    offset += stride;\n    end -= stride;\n  }\n}\n","/**\n * @module ol/geom/flat/orient\n */\nimport {coordinates as reverseCoordinates} from '../flat/reverse.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {boolean} Is clockwise.\n */\nexport function linearRingIsClockwise(flatCoordinates, offset, end, stride) {\n  // http://tinyurl.com/clockwise-method\n  // https://github.com/OSGeo/gdal/blob/trunk/gdal/ogr/ogrlinearring.cpp\n  let edge = 0;\n  let x1 = flatCoordinates[end - stride];\n  let y1 = flatCoordinates[end - stride + 1];\n  for (; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    edge += (x2 - x1) * (y2 + y1);\n    x1 = x2;\n    y1 = y2;\n  }\n  return edge > 0;\n}\n\n\n/**\n * Determines if linear rings are oriented.  By default, left-hand orientation\n * is tested (first ring must be clockwise, remaining rings counter-clockwise).\n * To test for right-hand orientation, use the `opt_right` argument.\n *\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Array of end indexes.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Test for right-hand orientation\n *     (counter-clockwise exterior ring and clockwise interior rings).\n * @return {boolean} Rings are correctly oriented.\n */\nexport function linearRingIsOriented(flatCoordinates, offset, ends, stride, opt_right) {\n  const right = opt_right !== undefined ? opt_right : false;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const isClockwise = linearRingIsClockwise(\n      flatCoordinates, offset, end, stride);\n    if (i === 0) {\n      if ((right && isClockwise) || (!right && !isClockwise)) {\n        return false;\n      }\n    } else {\n      if ((right && !isClockwise) || (!right && isClockwise)) {\n        return false;\n      }\n    }\n    offset = end;\n  }\n  return true;\n}\n\n\n/**\n * Determines if linear rings are oriented.  By default, left-hand orientation\n * is tested (first ring must be clockwise, remaining rings counter-clockwise).\n * To test for right-hand orientation, use the `opt_right` argument.\n *\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Array of array of end indexes.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Test for right-hand orientation\n *     (counter-clockwise exterior ring and clockwise interior rings).\n * @return {boolean} Rings are correctly oriented.\n */\nexport function linearRingsAreOriented(flatCoordinates, offset, endss, stride, opt_right) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    if (!linearRingIsOriented(\n      flatCoordinates, offset, endss[i], stride, opt_right)) {\n      return false;\n    }\n  }\n  return true;\n}\n\n\n/**\n * Orient coordinates in a flat array of linear rings.  By default, rings\n * are oriented following the left-hand rule (clockwise for exterior and\n * counter-clockwise for interior rings).  To orient according to the\n * right-hand rule, use the `opt_right` argument.\n *\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Follow the right-hand rule for orientation.\n * @return {number} End.\n */\nexport function orientLinearRings(flatCoordinates, offset, ends, stride, opt_right) {\n  const right = opt_right !== undefined ? opt_right : false;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const isClockwise = linearRingIsClockwise(\n      flatCoordinates, offset, end, stride);\n    const reverse = i === 0 ?\n      (right && isClockwise) || (!right && !isClockwise) :\n      (right && !isClockwise) || (!right && isClockwise);\n    if (reverse) {\n      reverseCoordinates(flatCoordinates, offset, end, stride);\n    }\n    offset = end;\n  }\n  return offset;\n}\n\n\n/**\n * Orient coordinates in a flat array of linear rings.  By default, rings\n * are oriented following the left-hand rule (clockwise for exterior and\n * counter-clockwise for interior rings).  To orient according to the\n * right-hand rule, use the `opt_right` argument.\n *\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Array of array of end indexes.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Follow the right-hand rule for orientation.\n * @return {number} End.\n */\nexport function orientLinearRingsArray(flatCoordinates, offset, endss, stride, opt_right) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    offset = orientLinearRings(\n      flatCoordinates, offset, endss[i], stride, opt_right);\n  }\n  return offset;\n}\n","/**\n * @module ol/geom/Polygon\n */\nimport {inherits} from '../util.js';\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY, getCenter} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LinearRing from '../geom/LinearRing.js';\nimport Point from '../geom/Point.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {offset as sphereOffset} from '../sphere.js';\nimport {linearRings as linearRingsArea} from '../geom/flat/area.js';\nimport {assignClosestArrayPoint, arrayMaxSquaredDelta} from '../geom/flat/closest.js';\nimport {linearRingsContainsXY} from '../geom/flat/contains.js';\nimport {deflateCoordinatesArray} from '../geom/flat/deflate.js';\nimport {inflateCoordinatesArray} from '../geom/flat/inflate.js';\nimport {getInteriorPointOfArray} from '../geom/flat/interiorpoint.js';\nimport {intersectsLinearRingArray} from '../geom/flat/intersectsextent.js';\nimport {linearRingIsOriented, orientLinearRings} from '../geom/flat/orient.js';\nimport {quantizeArray} from '../geom/flat/simplify.js';\nimport {modulo} from '../math.js';\n\n/**\n * @classdesc\n * Polygon geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} coordinates Array of linear\n *     rings that define the polygon. The first linear ring of the array\n *     defines the outer-boundary or surface of the polygon. Each subsequent\n *     linear ring defines a hole in the surface of the polygon. A linear ring\n *     is an array of vertices' coordinates where the first coordinate and the\n *     last are equivalent.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst Polygon = function(coordinates, opt_layout) {\n\n  SimpleGeometry.call(this);\n\n  /**\n   * @type {Array.<number>}\n   * @private\n   */\n  this.ends_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.flatInteriorPointRevision_ = -1;\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.flatInteriorPoint_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDelta_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDeltaRevision_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.orientedRevision_ = -1;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.orientedFlatCoordinates_ = null;\n\n  this.setCoordinates(coordinates, opt_layout);\n\n};\n\ninherits(Polygon, SimpleGeometry);\n\n\n/**\n * Append the passed linear ring to this polygon.\n * @param {module:ol/geom/LinearRing} linearRing Linear ring.\n * @api\n */\nPolygon.prototype.appendLinearRing = function(linearRing) {\n  if (!this.flatCoordinates) {\n    this.flatCoordinates = linearRing.getFlatCoordinates().slice();\n  } else {\n    extend(this.flatCoordinates, linearRing.getFlatCoordinates());\n  }\n  this.ends_.push(this.flatCoordinates.length);\n  this.changed();\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/Polygon} Clone.\n * @override\n * @api\n */\nPolygon.prototype.clone = function() {\n  const polygon = new Polygon(null);\n  polygon.setFlatCoordinates(\n    this.layout, this.flatCoordinates.slice(), this.ends_.slice());\n  return polygon;\n};\n\n\n/**\n * @inheritDoc\n */\nPolygon.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  if (this.maxDeltaRevision_ != this.getRevision()) {\n    this.maxDelta_ = Math.sqrt(arrayMaxSquaredDelta(\n      this.flatCoordinates, 0, this.ends_, this.stride, 0));\n    this.maxDeltaRevision_ = this.getRevision();\n  }\n  return assignClosestArrayPoint(\n    this.flatCoordinates, 0, this.ends_, this.stride,\n    this.maxDelta_, true, x, y, closestPoint, minSquaredDistance);\n};\n\n\n/**\n * @inheritDoc\n */\nPolygon.prototype.containsXY = function(x, y) {\n  return linearRingsContainsXY(this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride, x, y);\n};\n\n\n/**\n * Return the area of the polygon on projected plane.\n * @return {number} Area (on projected plane).\n * @api\n */\nPolygon.prototype.getArea = function() {\n  return linearRingsArea(this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride);\n};\n\n\n/**\n * Get the coordinate array for this geometry.  This array has the structure\n * of a GeoJSON coordinate array for polygons.\n *\n * @param {boolean=} opt_right Orient coordinates according to the right-hand\n *     rule (counter-clockwise for exterior and clockwise for interior rings).\n *     If `false`, coordinates will be oriented according to the left-hand rule\n *     (clockwise for exterior and counter-clockwise for interior rings).\n *     By default, coordinate orientation will depend on how the geometry was\n *     constructed.\n * @return {Array.<Array.<module:ol/coordinate~Coordinate>>} Coordinates.\n * @override\n * @api\n */\nPolygon.prototype.getCoordinates = function(opt_right) {\n  let flatCoordinates;\n  if (opt_right !== undefined) {\n    flatCoordinates = this.getOrientedFlatCoordinates().slice();\n    orientLinearRings(\n      flatCoordinates, 0, this.ends_, this.stride, opt_right);\n  } else {\n    flatCoordinates = this.flatCoordinates;\n  }\n\n  return inflateCoordinatesArray(\n    flatCoordinates, 0, this.ends_, this.stride);\n};\n\n\n/**\n * @return {Array.<number>} Ends.\n */\nPolygon.prototype.getEnds = function() {\n  return this.ends_;\n};\n\n\n/**\n * @return {Array.<number>} Interior point.\n */\nPolygon.prototype.getFlatInteriorPoint = function() {\n  if (this.flatInteriorPointRevision_ != this.getRevision()) {\n    const flatCenter = getCenter(this.getExtent());\n    this.flatInteriorPoint_ = getInteriorPointOfArray(\n      this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride,\n      flatCenter, 0);\n    this.flatInteriorPointRevision_ = this.getRevision();\n  }\n  return this.flatInteriorPoint_;\n};\n\n\n/**\n * Return an interior point of the polygon.\n * @return {module:ol/geom/Point} Interior point as XYM coordinate, where M is the\n * length of the horizontal intersection that the point belongs to.\n * @api\n */\nPolygon.prototype.getInteriorPoint = function() {\n  return new Point(this.getFlatInteriorPoint(), GeometryLayout.XYM);\n};\n\n\n/**\n * Return the number of rings of the polygon,  this includes the exterior\n * ring and any interior rings.\n *\n * @return {number} Number of rings.\n * @api\n */\nPolygon.prototype.getLinearRingCount = function() {\n  return this.ends_.length;\n};\n\n\n/**\n * Return the Nth linear ring of the polygon geometry. Return `null` if the\n * given index is out of range.\n * The exterior linear ring is available at index `0` and the interior rings\n * at index `1` and beyond.\n *\n * @param {number} index Index.\n * @return {module:ol/geom/LinearRing} Linear ring.\n * @api\n */\nPolygon.prototype.getLinearRing = function(index) {\n  if (index < 0 || this.ends_.length <= index) {\n    return null;\n  }\n  const linearRing = new LinearRing(null);\n  linearRing.setFlatCoordinates(this.layout, this.flatCoordinates.slice(\n    index === 0 ? 0 : this.ends_[index - 1], this.ends_[index]));\n  return linearRing;\n};\n\n\n/**\n * Return the linear rings of the polygon.\n * @return {Array.<module:ol/geom/LinearRing>} Linear rings.\n * @api\n */\nPolygon.prototype.getLinearRings = function() {\n  const layout = this.layout;\n  const flatCoordinates = this.flatCoordinates;\n  const ends = this.ends_;\n  const linearRings = [];\n  let offset = 0;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const linearRing = new LinearRing(null);\n    linearRing.setFlatCoordinates(layout, flatCoordinates.slice(offset, end));\n    linearRings.push(linearRing);\n    offset = end;\n  }\n  return linearRings;\n};\n\n\n/**\n * @return {Array.<number>} Oriented flat coordinates.\n */\nPolygon.prototype.getOrientedFlatCoordinates = function() {\n  if (this.orientedRevision_ != this.getRevision()) {\n    const flatCoordinates = this.flatCoordinates;\n    if (linearRingIsOriented(\n      flatCoordinates, 0, this.ends_, this.stride)) {\n      this.orientedFlatCoordinates_ = flatCoordinates;\n    } else {\n      this.orientedFlatCoordinates_ = flatCoordinates.slice();\n      this.orientedFlatCoordinates_.length =\n          orientLinearRings(\n            this.orientedFlatCoordinates_, 0, this.ends_, this.stride);\n    }\n    this.orientedRevision_ = this.getRevision();\n  }\n  return this.orientedFlatCoordinates_;\n};\n\n\n/**\n * @inheritDoc\n */\nPolygon.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  const simplifiedFlatCoordinates = [];\n  const simplifiedEnds = [];\n  simplifiedFlatCoordinates.length = quantizeArray(\n    this.flatCoordinates, 0, this.ends_, this.stride,\n    Math.sqrt(squaredTolerance),\n    simplifiedFlatCoordinates, 0, simplifiedEnds);\n  const simplifiedPolygon = new Polygon(null);\n  simplifiedPolygon.setFlatCoordinates(\n    GeometryLayout.XY, simplifiedFlatCoordinates, simplifiedEnds);\n  return simplifiedPolygon;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nPolygon.prototype.getType = function() {\n  return GeometryType.POLYGON;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nPolygon.prototype.intersectsExtent = function(extent) {\n  return intersectsLinearRingArray(\n    this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride, extent);\n};\n\n\n/**\n * Set the coordinates of the polygon.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nPolygon.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null, this.ends_);\n  } else {\n    this.setLayout(opt_layout, coordinates, 2);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    const ends = deflateCoordinatesArray(\n      this.flatCoordinates, 0, coordinates, this.stride, this.ends_);\n    this.flatCoordinates.length = ends.length === 0 ? 0 : ends[ends.length - 1];\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {Array.<number>} ends Ends.\n */\nPolygon.prototype.setFlatCoordinates = function(layout, flatCoordinates, ends) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.ends_ = ends;\n  this.changed();\n};\n\nexport default Polygon;\n\n\n/**\n * Create an approximation of a circle on the surface of a sphere.\n * @param {module:ol/coordinate~Coordinate} center Center (`[lon, lat]` in degrees).\n * @param {number} radius The great-circle distance from the center to\n *     the polygon vertices.\n * @param {number=} opt_n Optional number of vertices for the resulting\n *     polygon. Default is `32`.\n * @param {number=} opt_sphereRadius Optional radius for the sphere (defaults to\n *     the Earth's mean radius using the WGS84 ellipsoid).\n * @return {module:ol/geom/Polygon} The \"circular\" polygon.\n * @api\n */\nexport function circular(center, radius, opt_n, opt_sphereRadius) {\n  const n = opt_n ? opt_n : 32;\n  /** @type {Array.<number>} */\n  const flatCoordinates = [];\n  for (let i = 0; i < n; ++i) {\n    extend(flatCoordinates, sphereOffset(center, radius, 2 * Math.PI * i / n, opt_sphereRadius));\n  }\n  flatCoordinates.push(flatCoordinates[0], flatCoordinates[1]);\n  const polygon = new Polygon(null);\n  polygon.setFlatCoordinates(GeometryLayout.XY, flatCoordinates, [flatCoordinates.length]);\n  return polygon;\n}\n\n\n/**\n * Create a polygon from an extent. The layout used is `XY`.\n * @param {module:ol/extent~Extent} extent The extent.\n * @return {module:ol/geom/Polygon} The polygon.\n * @api\n */\nexport function fromExtent(extent) {\n  const minX = extent[0];\n  const minY = extent[1];\n  const maxX = extent[2];\n  const maxY = extent[3];\n  const flatCoordinates =\n      [minX, minY, minX, maxY, maxX, maxY, maxX, minY, minX, minY];\n  const polygon = new Polygon(null);\n  polygon.setFlatCoordinates(\n    GeometryLayout.XY, flatCoordinates, [flatCoordinates.length]);\n  return polygon;\n}\n\n\n/**\n * Create a regular polygon from a circle.\n * @param {module:ol/geom/Circle} circle Circle geometry.\n * @param {number=} opt_sides Number of sides of the polygon. Default is 32.\n * @param {number=} opt_angle Start angle for the first vertex of the polygon in\n *     radians. Default is 0.\n * @return {module:ol/geom/Polygon} Polygon geometry.\n * @api\n */\nexport function fromCircle(circle, opt_sides, opt_angle) {\n  const sides = opt_sides ? opt_sides : 32;\n  const stride = circle.getStride();\n  const layout = circle.getLayout();\n  const polygon = new Polygon(null, layout);\n  const arrayLength = stride * (sides + 1);\n  const flatCoordinates = new Array(arrayLength);\n  for (let i = 0; i < arrayLength; i++) {\n    flatCoordinates[i] = 0;\n  }\n  const ends = [flatCoordinates.length];\n  polygon.setFlatCoordinates(layout, flatCoordinates, ends);\n  makeRegular(polygon, circle.getCenter(), circle.getRadius(), opt_angle);\n  return polygon;\n}\n\n\n/**\n * Modify the coordinates of a polygon to make it a regular polygon.\n * @param {module:ol/geom/Polygon} polygon Polygon geometry.\n * @param {module:ol/coordinate~Coordinate} center Center of the regular polygon.\n * @param {number} radius Radius of the regular polygon.\n * @param {number=} opt_angle Start angle for the first vertex of the polygon in\n *     radians. Default is 0.\n */\nexport function makeRegular(polygon, center, radius, opt_angle) {\n  const flatCoordinates = polygon.getFlatCoordinates();\n  const layout = polygon.getLayout();\n  const stride = polygon.getStride();\n  const ends = polygon.getEnds();\n  const sides = flatCoordinates.length / stride - 1;\n  const startAngle = opt_angle ? opt_angle : 0;\n  for (let i = 0; i <= sides; ++i) {\n    const offset = i * stride;\n    const angle = startAngle + (modulo(i, sides) * 2 * Math.PI / sides);\n    flatCoordinates[offset] = center[0] + (radius * Math.cos(angle));\n    flatCoordinates[offset + 1] = center[1] + (radius * Math.sin(angle));\n  }\n  polygon.setFlatCoordinates(layout, flatCoordinates, ends);\n}\n","/**\n * @module ol/Geolocation\n */\nimport {inherits} from './util.js';\nimport GeolocationProperty from './GeolocationProperty.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport {listen} from './events.js';\nimport EventType from './events/EventType.js';\nimport {circular as circularPolygon} from './geom/Polygon.js';\nimport {GEOLOCATION} from './has.js';\nimport {toRadians} from './math.js';\nimport {get as getProjection, getTransformFromProjections, identityTransform} from './proj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [tracking=false] Start Tracking right after\n * instantiation.\n * @property {GeolocationPositionOptions} [trackingOptions] Tracking options.\n * See {@link http://www.w3.org/TR/geolocation-API/#position_options_interface}.\n * @property {module:ol/proj~ProjectionLike} [projection] The projection the position\n * is reported in.\n */\n\n\n/**\n * @classdesc\n * Helper class for providing HTML5 Geolocation capabilities.\n * The [Geolocation API](http://www.w3.org/TR/geolocation-API/)\n * is used to locate a user's position.\n *\n * To get notified of position changes, register a listener for the generic\n * `change` event on your instance of {@link module:ol/Geolocation~Geolocation}.\n *\n * Example:\n *\n *     var geolocation = new Geolocation({\n *       // take the projection to use from the map's view\n *       projection: view.getProjection()\n *     });\n *     // listen to changes in position\n *     geolocation.on('change', function(evt) {\n *       window.console.log(geolocation.getPosition());\n *     });\n *\n * @fires error\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/Geolocation~Options=} opt_options Options.\n * @api\n */\nconst Geolocation = function(opt_options) {\n\n  BaseObject.call(this);\n\n  const options = opt_options || {};\n\n  /**\n   * The unprojected (EPSG:4326) device position.\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.position_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/proj~TransformFunction}\n   */\n  this.transform_ = identityTransform;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.watchId_ = undefined;\n\n  listen(\n    this, getChangeEventType(GeolocationProperty.PROJECTION),\n    this.handleProjectionChanged_, this);\n  listen(\n    this, getChangeEventType(GeolocationProperty.TRACKING),\n    this.handleTrackingChanged_, this);\n\n  if (options.projection !== undefined) {\n    this.setProjection(options.projection);\n  }\n  if (options.trackingOptions !== undefined) {\n    this.setTrackingOptions(options.trackingOptions);\n  }\n\n  this.setTracking(options.tracking !== undefined ? options.tracking : false);\n\n};\n\ninherits(Geolocation, BaseObject);\n\n\n/**\n * @inheritDoc\n */\nGeolocation.prototype.disposeInternal = function() {\n  this.setTracking(false);\n  BaseObject.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @private\n */\nGeolocation.prototype.handleProjectionChanged_ = function() {\n  const projection = this.getProjection();\n  if (projection) {\n    this.transform_ = getTransformFromProjections(\n      getProjection('EPSG:4326'), projection);\n    if (this.position_) {\n      this.set(GeolocationProperty.POSITION, this.transform_(this.position_));\n    }\n  }\n};\n\n\n/**\n * @private\n */\nGeolocation.prototype.handleTrackingChanged_ = function() {\n  if (GEOLOCATION) {\n    const tracking = this.getTracking();\n    if (tracking && this.watchId_ === undefined) {\n      this.watchId_ = navigator.geolocation.watchPosition(\n        this.positionChange_.bind(this),\n        this.positionError_.bind(this),\n        this.getTrackingOptions());\n    } else if (!tracking && this.watchId_ !== undefined) {\n      navigator.geolocation.clearWatch(this.watchId_);\n      this.watchId_ = undefined;\n    }\n  }\n};\n\n\n/**\n * @private\n * @param {GeolocationPosition} position position event.\n */\nGeolocation.prototype.positionChange_ = function(position) {\n  const coords = position.coords;\n  this.set(GeolocationProperty.ACCURACY, coords.accuracy);\n  this.set(GeolocationProperty.ALTITUDE,\n    coords.altitude === null ? undefined : coords.altitude);\n  this.set(GeolocationProperty.ALTITUDE_ACCURACY,\n    coords.altitudeAccuracy === null ?\n      undefined : coords.altitudeAccuracy);\n  this.set(GeolocationProperty.HEADING, coords.heading === null ?\n    undefined : toRadians(coords.heading));\n  if (!this.position_) {\n    this.position_ = [coords.longitude, coords.latitude];\n  } else {\n    this.position_[0] = coords.longitude;\n    this.position_[1] = coords.latitude;\n  }\n  const projectedPosition = this.transform_(this.position_);\n  this.set(GeolocationProperty.POSITION, projectedPosition);\n  this.set(GeolocationProperty.SPEED,\n    coords.speed === null ? undefined : coords.speed);\n  const geometry = circularPolygon(this.position_, coords.accuracy);\n  geometry.applyTransform(this.transform_);\n  this.set(GeolocationProperty.ACCURACY_GEOMETRY, geometry);\n  this.changed();\n};\n\n/**\n * Triggered when the Geolocation returns an error.\n * @event error\n * @api\n */\n\n/**\n * @private\n * @param {GeolocationPositionError} error error object.\n */\nGeolocation.prototype.positionError_ = function(error) {\n  error.type = EventType.ERROR;\n  this.setTracking(false);\n  this.dispatchEvent(/** @type {{type: string, target: undefined}} */ (error));\n};\n\n\n/**\n * Get the accuracy of the position in meters.\n * @return {number|undefined} The accuracy of the position measurement in\n *     meters.\n * @observable\n * @api\n */\nGeolocation.prototype.getAccuracy = function() {\n  return /** @type {number|undefined} */ (this.get(GeolocationProperty.ACCURACY));\n};\n\n\n/**\n * Get a geometry of the position accuracy.\n * @return {?module:ol/geom/Polygon} A geometry of the position accuracy.\n * @observable\n * @api\n */\nGeolocation.prototype.getAccuracyGeometry = function() {\n  return (\n    /** @type {?module:ol/geom/Polygon} */ (this.get(GeolocationProperty.ACCURACY_GEOMETRY) || null)\n  );\n};\n\n\n/**\n * Get the altitude associated with the position.\n * @return {number|undefined} The altitude of the position in meters above mean\n *     sea level.\n * @observable\n * @api\n */\nGeolocation.prototype.getAltitude = function() {\n  return /** @type {number|undefined} */ (this.get(GeolocationProperty.ALTITUDE));\n};\n\n\n/**\n * Get the altitude accuracy of the position.\n * @return {number|undefined} The accuracy of the altitude measurement in\n *     meters.\n * @observable\n * @api\n */\nGeolocation.prototype.getAltitudeAccuracy = function() {\n  return /** @type {number|undefined} */ (this.get(GeolocationProperty.ALTITUDE_ACCURACY));\n};\n\n\n/**\n * Get the heading as radians clockwise from North.\n * Note: depending on the browser, the heading is only defined if the `enableHighAccuracy`\n * is set to `true` in the tracking options.\n * @return {number|undefined} The heading of the device in radians from north.\n * @observable\n * @api\n */\nGeolocation.prototype.getHeading = function() {\n  return /** @type {number|undefined} */ (this.get(GeolocationProperty.HEADING));\n};\n\n\n/**\n * Get the position of the device.\n * @return {module:ol/coordinate~Coordinate|undefined} The current position of the device reported\n *     in the current projection.\n * @observable\n * @api\n */\nGeolocation.prototype.getPosition = function() {\n  return (\n    /** @type {module:ol/coordinate~Coordinate|undefined} */ (this.get(GeolocationProperty.POSITION))\n  );\n};\n\n\n/**\n * Get the projection associated with the position.\n * @return {module:ol/proj/Projection|undefined} The projection the position is\n *     reported in.\n * @observable\n * @api\n */\nGeolocation.prototype.getProjection = function() {\n  return (\n    /** @type {module:ol/proj/Projection|undefined} */ (this.get(GeolocationProperty.PROJECTION))\n  );\n};\n\n\n/**\n * Get the speed in meters per second.\n * @return {number|undefined} The instantaneous speed of the device in meters\n *     per second.\n * @observable\n * @api\n */\nGeolocation.prototype.getSpeed = function() {\n  return /** @type {number|undefined} */ (this.get(GeolocationProperty.SPEED));\n};\n\n\n/**\n * Determine if the device location is being tracked.\n * @return {boolean} The device location is being tracked.\n * @observable\n * @api\n */\nGeolocation.prototype.getTracking = function() {\n  return /** @type {boolean} */ (this.get(GeolocationProperty.TRACKING));\n};\n\n\n/**\n * Get the tracking options.\n * @see http://www.w3.org/TR/geolocation-API/#position-options\n * @return {GeolocationPositionOptions|undefined} PositionOptions as defined by\n *     the [HTML5 Geolocation spec\n *     ](http://www.w3.org/TR/geolocation-API/#position_options_interface).\n * @observable\n * @api\n */\nGeolocation.prototype.getTrackingOptions = function() {\n  return /** @type {GeolocationPositionOptions|undefined} */ (this.get(GeolocationProperty.TRACKING_OPTIONS));\n};\n\n\n/**\n * Set the projection to use for transforming the coordinates.\n * @param {module:ol/proj~ProjectionLike} projection The projection the position is\n *     reported in.\n * @observable\n * @api\n */\nGeolocation.prototype.setProjection = function(projection) {\n  this.set(GeolocationProperty.PROJECTION, getProjection(projection));\n};\n\n\n/**\n * Enable or disable tracking.\n * @param {boolean} tracking Enable tracking.\n * @observable\n * @api\n */\nGeolocation.prototype.setTracking = function(tracking) {\n  this.set(GeolocationProperty.TRACKING, tracking);\n};\n\n\n/**\n * Set the tracking options.\n * @see http://www.w3.org/TR/geolocation-API/#position-options\n * @param {GeolocationPositionOptions} options PositionOptions as defined by the\n *     [HTML5 Geolocation spec\n *     ](http://www.w3.org/TR/geolocation-API/#position_options_interface).\n * @observable\n * @api\n */\nGeolocation.prototype.setTrackingOptions = function(options) {\n  this.set(GeolocationProperty.TRACKING_OPTIONS, options);\n};\nexport default Geolocation;\n","/**\n * @module ol/string\n */\n\n/**\n * @param {number} number Number to be formatted\n * @param {number} width The desired width\n * @param {number=} opt_precision Precision of the output string (i.e. number of decimal places)\n * @returns {string} Formatted string\n */\nexport function padNumber(number, width, opt_precision) {\n  const numberString = opt_precision !== undefined ? number.toFixed(opt_precision) : '' + number;\n  let decimal = numberString.indexOf('.');\n  decimal = decimal === -1 ? numberString.length : decimal;\n  return decimal > width ? numberString : new Array(1 + width - decimal).join('0') + numberString;\n}\n\n\n/**\n * Adapted from https://github.com/omichelsen/compare-versions/blob/master/index.js\n * @param {string|number} v1 First version\n * @param {string|number} v2 Second version\n * @returns {number} Value\n */\nexport function compareVersions(v1, v2) {\n  const s1 = ('' + v1).split('.');\n  const s2 = ('' + v2).split('.');\n\n  for (let i = 0; i < Math.max(s1.length, s2.length); i++) {\n    const n1 = parseInt(s1[i] || '0', 10);\n    const n2 = parseInt(s2[i] || '0', 10);\n\n    if (n1 > n2) {\n      return 1;\n    }\n    if (n2 > n1) {\n      return -1;\n    }\n  }\n\n  return 0;\n}\n","/**\n * @module ol/coordinate\n */\nimport {modulo} from './math.js';\nimport {padNumber} from './string.js';\n\n\n/**\n * An array of numbers representing an xy coordinate. Example: `[16, 48]`.\n * @typedef {Array.<number>} Coordinate\n * @api\n */\n\n\n/**\n * A function that takes a {@link module:ol/coordinate~Coordinate} and\n * transforms it into a `{string}`.\n *\n * @typedef {function((module:ol/coordinate~Coordinate|undefined)): string} CoordinateFormat\n * @api\n */\n\n\n/**\n * Add `delta` to `coordinate`. `coordinate` is modified in place and returned\n * by the function.\n *\n * Example:\n *\n *     import {add} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     add(coord, [-2, 4]);\n *     // coord is now [5.85, 51.983333]\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/coordinate~Coordinate} delta Delta.\n * @return {module:ol/coordinate~Coordinate} The input coordinate adjusted by\n * the given delta.\n * @api\n */\nexport function add(coordinate, delta) {\n  coordinate[0] += delta[0];\n  coordinate[1] += delta[1];\n  return coordinate;\n}\n\n\n/**\n * Calculates the point closest to the passed coordinate on the passed circle.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate The coordinate.\n * @param {module:ol/geom/Circle} circle The circle.\n * @return {module:ol/coordinate~Coordinate} Closest point on the circumference.\n */\nexport function closestOnCircle(coordinate, circle) {\n  const r = circle.getRadius();\n  const center = circle.getCenter();\n  const x0 = center[0];\n  const y0 = center[1];\n  const x1 = coordinate[0];\n  const y1 = coordinate[1];\n\n  let dx = x1 - x0;\n  const dy = y1 - y0;\n  if (dx === 0 && dy === 0) {\n    dx = 1;\n  }\n  const d = Math.sqrt(dx * dx + dy * dy);\n\n  const x = x0 + r * dx / d;\n  const y = y0 + r * dy / d;\n\n  return [x, y];\n}\n\n\n/**\n * Calculates the point closest to the passed coordinate on the passed segment.\n * This is the foot of the perpendicular of the coordinate to the segment when\n * the foot is on the segment, or the closest segment coordinate when the foot\n * is outside the segment.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate The coordinate.\n * @param {Array.<module:ol/coordinate~Coordinate>} segment The two coordinates\n * of the segment.\n * @return {module:ol/coordinate~Coordinate} The foot of the perpendicular of\n * the coordinate to the segment.\n */\nexport function closestOnSegment(coordinate, segment) {\n  const x0 = coordinate[0];\n  const y0 = coordinate[1];\n  const start = segment[0];\n  const end = segment[1];\n  const x1 = start[0];\n  const y1 = start[1];\n  const x2 = end[0];\n  const y2 = end[1];\n  const dx = x2 - x1;\n  const dy = y2 - y1;\n  const along = (dx === 0 && dy === 0) ? 0 :\n    ((dx * (x0 - x1)) + (dy * (y0 - y1))) / ((dx * dx + dy * dy) || 0);\n  let x, y;\n  if (along <= 0) {\n    x = x1;\n    y = y1;\n  } else if (along >= 1) {\n    x = x2;\n    y = y2;\n  } else {\n    x = x1 + along * dx;\n    y = y1 + along * dy;\n  }\n  return [x, y];\n}\n\n\n/**\n * Returns a {@link module:ol/coordinate~CoordinateFormat} function that can be\n * used to format\n * a {module:ol/coordinate~Coordinate} to a string.\n *\n * Example without specifying the fractional digits:\n *\n *     import {createStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var stringifyFunc = createStringXY();\n *     var out = stringifyFunc(coord);\n *     // out is now '8, 48'\n *\n * Example with explicitly specifying 2 fractional digits:\n *\n *     import {createStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var stringifyFunc = createStringXY(2);\n *     var out = stringifyFunc(coord);\n *     // out is now '7.85, 47.98'\n *\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {module:ol/coordinate~CoordinateFormat} Coordinate format.\n * @api\n */\nexport function createStringXY(opt_fractionDigits) {\n  return (\n    /**\n     * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n     * @return {string} String XY.\n     */\n    function(coordinate) {\n      return toStringXY(coordinate, opt_fractionDigits);\n    }\n  );\n}\n\n\n/**\n * @param {string} hemispheres Hemispheres.\n * @param {number} degrees Degrees.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} String.\n */\nexport function degreesToStringHDMS(hemispheres, degrees, opt_fractionDigits) {\n  const normalizedDegrees = modulo(degrees + 180, 360) - 180;\n  const x = Math.abs(3600 * normalizedDegrees);\n  const dflPrecision = opt_fractionDigits || 0;\n  const precision = Math.pow(10, dflPrecision);\n\n  let deg = Math.floor(x / 3600);\n  let min = Math.floor((x - deg * 3600) / 60);\n  let sec = x - (deg * 3600) - (min * 60);\n  sec = Math.ceil(sec * precision) / precision;\n\n  if (sec >= 60) {\n    sec = 0;\n    min += 1;\n  }\n\n  if (min >= 60) {\n    min = 0;\n    deg += 1;\n  }\n\n  return deg + '\\u00b0 ' + padNumber(min, 2) + '\\u2032 ' +\n    padNumber(sec, 2, dflPrecision) + '\\u2033' +\n    (normalizedDegrees == 0 ? '' : ' ' + hemispheres.charAt(normalizedDegrees < 0 ? 1 : 0));\n}\n\n\n/**\n * Transforms the given {@link module:ol/coordinate~Coordinate} to a string\n * using the given string template. The strings `{x}` and `{y}` in the template\n * will be replaced with the first and second coordinate values respectively.\n *\n * Example without specifying the fractional digits:\n *\n *     import {format} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var template = 'Coordinate is ({x}|{y}).';\n *     var out = format(coord, template);\n *     // out is now 'Coordinate is (8|48).'\n *\n * Example explicitly specifying the fractional digits:\n *\n *     import {format} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var template = 'Coordinate is ({x}|{y}).';\n *     var out = format(coord, template, 2);\n *     // out is now 'Coordinate is (7.85|47.98).'\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {string} template A template string with `{x}` and `{y}` placeholders\n *     that will be replaced by first and second coordinate values.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} Formatted coordinate.\n * @api\n */\nexport function format(coordinate, template, opt_fractionDigits) {\n  if (coordinate) {\n    return template\n      .replace('{x}', coordinate[0].toFixed(opt_fractionDigits))\n      .replace('{y}', coordinate[1].toFixed(opt_fractionDigits));\n  } else {\n    return '';\n  }\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate1 First coordinate.\n * @param {module:ol/coordinate~Coordinate} coordinate2 Second coordinate.\n * @return {boolean} The two coordinates are equal.\n */\nexport function equals(coordinate1, coordinate2) {\n  let equals = true;\n  for (let i = coordinate1.length - 1; i >= 0; --i) {\n    if (coordinate1[i] != coordinate2[i]) {\n      equals = false;\n      break;\n    }\n  }\n  return equals;\n}\n\n\n/**\n * Rotate `coordinate` by `angle`. `coordinate` is modified in place and\n * returned by the function.\n *\n * Example:\n *\n *     import {rotate} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var rotateRadians = Math.PI / 2; // 90 degrees\n *     rotate(coord, rotateRadians);\n *     // coord is now [-47.983333, 7.85]\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} angle Angle in radian.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n * @api\n */\nexport function rotate(coordinate, angle) {\n  const cosAngle = Math.cos(angle);\n  const sinAngle = Math.sin(angle);\n  const x = coordinate[0] * cosAngle - coordinate[1] * sinAngle;\n  const y = coordinate[1] * cosAngle + coordinate[0] * sinAngle;\n  coordinate[0] = x;\n  coordinate[1] = y;\n  return coordinate;\n}\n\n\n/**\n * Scale `coordinate` by `scale`. `coordinate` is modified in place and returned\n * by the function.\n *\n * Example:\n *\n *     import {scale as scaleCoordinate} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var scale = 1.2;\n *     scaleCoordinate(coord, scale);\n *     // coord is now [9.42, 57.5799996]\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} scale Scale factor.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n */\nexport function scale(coordinate, scale) {\n  coordinate[0] *= scale;\n  coordinate[1] *= scale;\n  return coordinate;\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coord1 First coordinate.\n * @param {module:ol/coordinate~Coordinate} coord2 Second coordinate.\n * @return {number} Squared distance between coord1 and coord2.\n */\nexport function squaredDistance(coord1, coord2) {\n  const dx = coord1[0] - coord2[0];\n  const dy = coord1[1] - coord2[1];\n  return dx * dx + dy * dy;\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coord1 First coordinate.\n * @param {module:ol/coordinate~Coordinate} coord2 Second coordinate.\n * @return {number} Distance between coord1 and coord2.\n */\nexport function distance(coord1, coord2) {\n  return Math.sqrt(squaredDistance(coord1, coord2));\n}\n\n\n/**\n * Calculate the squared distance from a coordinate to a line segment.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate of the point.\n * @param {Array.<module:ol/coordinate~Coordinate>} segment Line segment (2\n * coordinates).\n * @return {number} Squared distance from the point to the line segment.\n */\nexport function squaredDistanceToSegment(coordinate, segment) {\n  return squaredDistance(coordinate,\n    closestOnSegment(coordinate, segment));\n}\n\n\n/**\n * Format a geographic coordinate with the hemisphere, degrees, minutes, and\n * seconds.\n *\n * Example without specifying fractional digits:\n *\n *     import {toStringHDMS} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringHDMS(coord);\n *     // out is now '47° 58′ 60″ N 7° 50′ 60″ E'\n *\n * Example explicitly specifying 1 fractional digit:\n *\n *     import {toStringHDMS} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringHDMS(coord, 1);\n *     // out is now '47° 58′ 60.0″ N 7° 50′ 60.0″ E'\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} Hemisphere, degrees, minutes and seconds.\n * @api\n */\nexport function toStringHDMS(coordinate, opt_fractionDigits) {\n  if (coordinate) {\n    return degreesToStringHDMS('NS', coordinate[1], opt_fractionDigits) + ' ' +\n        degreesToStringHDMS('EW', coordinate[0], opt_fractionDigits);\n  } else {\n    return '';\n  }\n}\n\n\n/**\n * Format a coordinate as a comma delimited string.\n *\n * Example without specifying fractional digits:\n *\n *     import {toStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringXY(coord);\n *     // out is now '8, 48'\n *\n * Example explicitly specifying 1 fractional digit:\n *\n *     import {toStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringXY(coord, 1);\n *     // out is now '7.8, 48.0'\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} XY.\n * @api\n */\nexport function toStringXY(coordinate, opt_fractionDigits) {\n  return format(coordinate, '{x}, {y}', opt_fractionDigits);\n}\n","/**\n * @module ol/geom/flat/interpolate\n */\nimport {binarySearch} from '../../array.js';\nimport {lerp} from '../../math.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} fraction Fraction.\n * @param {Array.<number>=} opt_dest Destination.\n * @return {Array.<number>} Destination.\n */\nexport function interpolatePoint(flatCoordinates, offset, end, stride, fraction, opt_dest) {\n  let pointX = NaN;\n  let pointY = NaN;\n  const n = (end - offset) / stride;\n  if (n === 1) {\n    pointX = flatCoordinates[offset];\n    pointY = flatCoordinates[offset + 1];\n  } else if (n == 2) {\n    pointX = (1 - fraction) * flatCoordinates[offset] +\n        fraction * flatCoordinates[offset + stride];\n    pointY = (1 - fraction) * flatCoordinates[offset + 1] +\n        fraction * flatCoordinates[offset + stride + 1];\n  } else if (n !== 0) {\n    let x1 = flatCoordinates[offset];\n    let y1 = flatCoordinates[offset + 1];\n    let length = 0;\n    const cumulativeLengths = [0];\n    for (let i = offset + stride; i < end; i += stride) {\n      const x2 = flatCoordinates[i];\n      const y2 = flatCoordinates[i + 1];\n      length += Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n      cumulativeLengths.push(length);\n      x1 = x2;\n      y1 = y2;\n    }\n    const target = fraction * length;\n    const index = binarySearch(cumulativeLengths, target);\n    if (index < 0) {\n      const t = (target - cumulativeLengths[-index - 2]) /\n          (cumulativeLengths[-index - 1] - cumulativeLengths[-index - 2]);\n      const o = offset + (-index - 2) * stride;\n      pointX = lerp(\n        flatCoordinates[o], flatCoordinates[o + stride], t);\n      pointY = lerp(\n        flatCoordinates[o + 1], flatCoordinates[o + stride + 1], t);\n    } else {\n      pointX = flatCoordinates[offset + index * stride];\n      pointY = flatCoordinates[offset + index * stride + 1];\n    }\n  }\n  if (opt_dest) {\n    opt_dest[0] = pointX;\n    opt_dest[1] = pointY;\n    return opt_dest;\n  } else {\n    return [pointX, pointY];\n  }\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} m M.\n * @param {boolean} extrapolate Extrapolate.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n */\nexport function lineStringCoordinateAtM(flatCoordinates, offset, end, stride, m, extrapolate) {\n  if (end == offset) {\n    return null;\n  }\n  let coordinate;\n  if (m < flatCoordinates[offset + stride - 1]) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(offset, offset + stride);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  } else if (flatCoordinates[end - 1] < m) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(end - stride, end);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  }\n  // FIXME use O(1) search\n  if (m == flatCoordinates[offset + stride - 1]) {\n    return flatCoordinates.slice(offset, offset + stride);\n  }\n  let lo = offset / stride;\n  let hi = end / stride;\n  while (lo < hi) {\n    const mid = (lo + hi) >> 1;\n    if (m < flatCoordinates[(mid + 1) * stride - 1]) {\n      hi = mid;\n    } else {\n      lo = mid + 1;\n    }\n  }\n  const m0 = flatCoordinates[lo * stride - 1];\n  if (m == m0) {\n    return flatCoordinates.slice((lo - 1) * stride, (lo - 1) * stride + stride);\n  }\n  const m1 = flatCoordinates[(lo + 1) * stride - 1];\n  const t = (m - m0) / (m1 - m0);\n  coordinate = [];\n  for (let i = 0; i < stride - 1; ++i) {\n    coordinate.push(lerp(flatCoordinates[(lo - 1) * stride + i],\n      flatCoordinates[lo * stride + i], t));\n  }\n  coordinate.push(m);\n  return coordinate;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} m M.\n * @param {boolean} extrapolate Extrapolate.\n * @param {boolean} interpolate Interpolate.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n */\nexport function lineStringsCoordinateAtM(\n  flatCoordinates, offset, ends, stride, m, extrapolate, interpolate) {\n  if (interpolate) {\n    return lineStringCoordinateAtM(\n      flatCoordinates, offset, ends[ends.length - 1], stride, m, extrapolate);\n  }\n  let coordinate;\n  if (m < flatCoordinates[stride - 1]) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(0, stride);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  }\n  if (flatCoordinates[flatCoordinates.length - 1] < m) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(flatCoordinates.length - stride);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  }\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    if (offset == end) {\n      continue;\n    }\n    if (m < flatCoordinates[offset + stride - 1]) {\n      return null;\n    } else if (m <= flatCoordinates[end - 1]) {\n      return lineStringCoordinateAtM(\n        flatCoordinates, offset, end, stride, m, false);\n    }\n    offset = end;\n  }\n  return null;\n}\n","/**\n * @module ol/geom/flat/length\n */\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {number} Length.\n */\nexport function lineStringLength(flatCoordinates, offset, end, stride) {\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  let length = 0;\n  for (let i = offset + stride; i < end; i += stride) {\n    const x2 = flatCoordinates[i];\n    const y2 = flatCoordinates[i + 1];\n    length += Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n    x1 = x2;\n    y1 = y2;\n  }\n  return length;\n}\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {number} Perimeter.\n */\nexport function linearRingLength(flatCoordinates, offset, end, stride) {\n  let perimeter = lineStringLength(flatCoordinates, offset, end, stride);\n  const dx = flatCoordinates[end - stride] - flatCoordinates[offset];\n  const dy = flatCoordinates[end - stride + 1] - flatCoordinates[offset + 1];\n  perimeter += Math.sqrt(dx * dx + dy * dy);\n  return perimeter;\n}\n","/**\n * @module ol/geom/LineString\n */\nimport {inherits} from '../util.js';\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {assignClosestPoint, maxSquaredDelta} from '../geom/flat/closest.js';\nimport {deflateCoordinates} from '../geom/flat/deflate.js';\nimport {inflateCoordinates} from '../geom/flat/inflate.js';\nimport {interpolatePoint, lineStringCoordinateAtM} from '../geom/flat/interpolate.js';\nimport {intersectsLineString} from '../geom/flat/intersectsextent.js';\nimport {lineStringLength} from '../geom/flat/length.js';\nimport {forEach as forEachSegment} from '../geom/flat/segments.js';\nimport {douglasPeucker} from '../geom/flat/simplify.js';\n\n/**\n * @classdesc\n * Linestring geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst LineString = function(coordinates, opt_layout) {\n\n  SimpleGeometry.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.flatMidpoint_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.flatMidpointRevision_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDelta_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDeltaRevision_ = -1;\n\n  this.setCoordinates(coordinates, opt_layout);\n\n};\n\ninherits(LineString, SimpleGeometry);\n\n\n/**\n * Append the passed coordinate to the coordinates of the linestring.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @api\n */\nLineString.prototype.appendCoordinate = function(coordinate) {\n  if (!this.flatCoordinates) {\n    this.flatCoordinates = coordinate.slice();\n  } else {\n    extend(this.flatCoordinates, coordinate);\n  }\n  this.changed();\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/LineString} Clone.\n * @override\n * @api\n */\nLineString.prototype.clone = function() {\n  const lineString = new LineString(null);\n  lineString.setFlatCoordinates(this.layout, this.flatCoordinates.slice());\n  return lineString;\n};\n\n\n/**\n * @inheritDoc\n */\nLineString.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  if (this.maxDeltaRevision_ != this.getRevision()) {\n    this.maxDelta_ = Math.sqrt(maxSquaredDelta(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride, 0));\n    this.maxDeltaRevision_ = this.getRevision();\n  }\n  return assignClosestPoint(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    this.maxDelta_, false, x, y, closestPoint, minSquaredDistance);\n};\n\n\n/**\n * Iterate over each segment, calling the provided callback.\n * If the callback returns a truthy value the function returns that\n * value immediately. Otherwise the function returns `false`.\n *\n * @param {function(this: S, module:ol/coordinate~Coordinate, module:ol/coordinate~Coordinate): T} callback Function\n *     called for each segment.\n * @return {T|boolean} Value.\n * @template T,S\n * @api\n */\nLineString.prototype.forEachSegment = function(callback) {\n  return forEachSegment(this.flatCoordinates, 0, this.flatCoordinates.length, this.stride, callback);\n};\n\n\n/**\n * Returns the coordinate at `m` using linear interpolation, or `null` if no\n * such coordinate exists.\n *\n * `opt_extrapolate` controls extrapolation beyond the range of Ms in the\n * MultiLineString. If `opt_extrapolate` is `true` then Ms less than the first\n * M will return the first coordinate and Ms greater than the last M will\n * return the last coordinate.\n *\n * @param {number} m M.\n * @param {boolean=} opt_extrapolate Extrapolate. Default is `false`.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n * @api\n */\nLineString.prototype.getCoordinateAtM = function(m, opt_extrapolate) {\n  if (this.layout != GeometryLayout.XYM &&\n      this.layout != GeometryLayout.XYZM) {\n    return null;\n  }\n  const extrapolate = opt_extrapolate !== undefined ? opt_extrapolate : false;\n  return lineStringCoordinateAtM(this.flatCoordinates, 0,\n    this.flatCoordinates.length, this.stride, m, extrapolate);\n};\n\n\n/**\n * Return the coordinates of the linestring.\n * @return {Array.<module:ol/coordinate~Coordinate>} Coordinates.\n * @override\n * @api\n */\nLineString.prototype.getCoordinates = function() {\n  return inflateCoordinates(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n};\n\n\n/**\n * Return the coordinate at the provided fraction along the linestring.\n * The `fraction` is a number between 0 and 1, where 0 is the start of the\n * linestring and 1 is the end.\n * @param {number} fraction Fraction.\n * @param {module:ol/coordinate~Coordinate=} opt_dest Optional coordinate whose values will\n *     be modified. If not provided, a new coordinate will be returned.\n * @return {module:ol/coordinate~Coordinate} Coordinate of the interpolated point.\n * @api\n */\nLineString.prototype.getCoordinateAt = function(fraction, opt_dest) {\n  return interpolatePoint(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    fraction, opt_dest);\n};\n\n\n/**\n * Return the length of the linestring on projected plane.\n * @return {number} Length (on projected plane).\n * @api\n */\nLineString.prototype.getLength = function() {\n  return lineStringLength(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n};\n\n\n/**\n * @return {Array.<number>} Flat midpoint.\n */\nLineString.prototype.getFlatMidpoint = function() {\n  if (this.flatMidpointRevision_ != this.getRevision()) {\n    this.flatMidpoint_ = this.getCoordinateAt(0.5, this.flatMidpoint_);\n    this.flatMidpointRevision_ = this.getRevision();\n  }\n  return this.flatMidpoint_;\n};\n\n\n/**\n * @inheritDoc\n */\nLineString.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  const simplifiedFlatCoordinates = [];\n  simplifiedFlatCoordinates.length = douglasPeucker(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    squaredTolerance, simplifiedFlatCoordinates, 0);\n  const simplifiedLineString = new LineString(null);\n  simplifiedLineString.setFlatCoordinates(\n    GeometryLayout.XY, simplifiedFlatCoordinates);\n  return simplifiedLineString;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nLineString.prototype.getType = function() {\n  return GeometryType.LINE_STRING;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nLineString.prototype.intersectsExtent = function(extent) {\n  return intersectsLineString(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n    extent);\n};\n\n\n/**\n * Set the coordinates of the linestring.\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nLineString.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null);\n  } else {\n    this.setLayout(opt_layout, coordinates, 1);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinates(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n */\nLineString.prototype.setFlatCoordinates = function(layout, flatCoordinates) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.changed();\n};\nexport default LineString;\n","/**\n * @module ol/geom/flat/geodesic\n */\nimport {squaredSegmentDistance, toRadians, toDegrees} from '../../math.js';\nimport {get as getProjection, getTransform} from '../../proj.js';\n\n\n/**\n * @param {function(number): module:ol/coordinate~Coordinate} interpolate Interpolate function.\n * @param {module:ol/proj~TransformFunction} transform Transform from longitude/latitude to\n *     projected coordinates.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {Array.<number>} Flat coordinates.\n */\nfunction line(interpolate, transform, squaredTolerance) {\n  // FIXME reduce garbage generation\n  // FIXME optimize stack operations\n\n  /** @type {Array.<number>} */\n  const flatCoordinates = [];\n\n  let geoA = interpolate(0);\n  let geoB = interpolate(1);\n\n  let a = transform(geoA);\n  let b = transform(geoB);\n\n  /** @type {Array.<module:ol/coordinate~Coordinate>} */\n  const geoStack = [geoB, geoA];\n  /** @type {Array.<module:ol/coordinate~Coordinate>} */\n  const stack = [b, a];\n  /** @type {Array.<number>} */\n  const fractionStack = [1, 0];\n\n  /** @type {!Object.<string, boolean>} */\n  const fractions = {};\n\n  let maxIterations = 1e5;\n  let geoM, m, fracA, fracB, fracM, key;\n\n  while (--maxIterations > 0 && fractionStack.length > 0) {\n    // Pop the a coordinate off the stack\n    fracA = fractionStack.pop();\n    geoA = geoStack.pop();\n    a = stack.pop();\n    // Add the a coordinate if it has not been added yet\n    key = fracA.toString();\n    if (!(key in fractions)) {\n      flatCoordinates.push(a[0], a[1]);\n      fractions[key] = true;\n    }\n    // Pop the b coordinate off the stack\n    fracB = fractionStack.pop();\n    geoB = geoStack.pop();\n    b = stack.pop();\n    // Find the m point between the a and b coordinates\n    fracM = (fracA + fracB) / 2;\n    geoM = interpolate(fracM);\n    m = transform(geoM);\n    if (squaredSegmentDistance(m[0], m[1], a[0], a[1],\n      b[0], b[1]) < squaredTolerance) {\n      // If the m point is sufficiently close to the straight line, then we\n      // discard it.  Just use the b coordinate and move on to the next line\n      // segment.\n      flatCoordinates.push(b[0], b[1]);\n      key = fracB.toString();\n      fractions[key] = true;\n    } else {\n      // Otherwise, we need to subdivide the current line segment.  Split it\n      // into two and push the two line segments onto the stack.\n      fractionStack.push(fracB, fracM, fracM, fracA);\n      stack.push(b, m, m, a);\n      geoStack.push(geoB, geoM, geoM, geoA);\n    }\n  }\n\n  return flatCoordinates;\n}\n\n\n/**\n * Generate a great-circle arcs between two lat/lon points.\n * @param {number} lon1 Longitude 1 in degrees.\n * @param {number} lat1 Latitude 1 in degrees.\n * @param {number} lon2 Longitude 2 in degrees.\n * @param {number} lat2 Latitude 2 in degrees.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {Array.<number>} Flat coordinates.\n */\nexport function greatCircleArc(lon1, lat1, lon2, lat2, projection, squaredTolerance) {\n  const geoProjection = getProjection('EPSG:4326');\n\n  const cosLat1 = Math.cos(toRadians(lat1));\n  const sinLat1 = Math.sin(toRadians(lat1));\n  const cosLat2 = Math.cos(toRadians(lat2));\n  const sinLat2 = Math.sin(toRadians(lat2));\n  const cosDeltaLon = Math.cos(toRadians(lon2 - lon1));\n  const sinDeltaLon = Math.sin(toRadians(lon2 - lon1));\n  const d = sinLat1 * sinLat2 + cosLat1 * cosLat2 * cosDeltaLon;\n\n  return line(\n    /**\n     * @param {number} frac Fraction.\n     * @return {module:ol/coordinate~Coordinate} Coordinate.\n     */\n    function(frac) {\n      if (1 <= d) {\n        return [lon2, lat2];\n      }\n      const D = frac * Math.acos(d);\n      const cosD = Math.cos(D);\n      const sinD = Math.sin(D);\n      const y = sinDeltaLon * cosLat2;\n      const x = cosLat1 * sinLat2 - sinLat1 * cosLat2 * cosDeltaLon;\n      const theta = Math.atan2(y, x);\n      const lat = Math.asin(sinLat1 * cosD + cosLat1 * sinD * Math.cos(theta));\n      const lon = toRadians(lon1) +\n            Math.atan2(Math.sin(theta) * sinD * cosLat1,\n              cosD - sinLat1 * Math.sin(lat));\n      return [toDegrees(lon), toDegrees(lat)];\n    }, getTransform(geoProjection, projection), squaredTolerance);\n}\n\n\n/**\n * Generate a meridian (line at constant longitude).\n * @param {number} lon Longitude.\n * @param {number} lat1 Latitude 1.\n * @param {number} lat2 Latitude 2.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {Array.<number>} Flat coordinates.\n */\nexport function meridian(lon, lat1, lat2, projection, squaredTolerance) {\n  const epsg4326Projection = getProjection('EPSG:4326');\n  return line(\n    /**\n     * @param {number} frac Fraction.\n     * @return {module:ol/coordinate~Coordinate} Coordinate.\n     */\n    function(frac) {\n      return [lon, lat1 + ((lat2 - lat1) * frac)];\n    },\n    getTransform(epsg4326Projection, projection), squaredTolerance);\n}\n\n\n/**\n * Generate a parallel (line at constant latitude).\n * @param {number} lat Latitude.\n * @param {number} lon1 Longitude 1.\n * @param {number} lon2 Longitude 2.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {Array.<number>} Flat coordinates.\n */\nexport function parallel(lat, lon1, lon2, projection, squaredTolerance) {\n  const epsg4326Projection = getProjection('EPSG:4326');\n  return line(\n    /**\n     * @param {number} frac Fraction.\n     * @return {module:ol/coordinate~Coordinate} Coordinate.\n     */\n    function(frac) {\n      return [lon1 + ((lon2 - lon1) * frac), lat];\n    },\n    getTransform(epsg4326Projection, projection), squaredTolerance);\n}\n","/**\n * @module ol/render/EventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * @event module:ol/render/Event~RenderEvent#postcompose\n   * @api\n   */\n  POSTCOMPOSE: 'postcompose',\n  /**\n   * @event module:ol/render/Event~RenderEvent#precompose\n   * @api\n   */\n  PRECOMPOSE: 'precompose',\n  /**\n   * @event module:ol/render/Event~RenderEvent#render\n   * @api\n   */\n  RENDER: 'render'\n};\n","/**\n * @module ol/style/TextPlacement\n */\n\n/**\n * Text placement. One of `'point'`, `'line'`. Default is `'point'`. Note that\n * `'line'` requires the underlying geometry to be a {@link module:ol/geom/LineString~LineString},\n * {@link module:ol/geom/Polygon~Polygon}, {@link module:ol/geom/MultiLineString~MultiLineString} or\n * {@link module:ol/geom/MultiPolygon~MultiPolygon}.\n * @enum {string}\n */\nexport default {\n  POINT: 'point',\n  LINE: 'line'\n};\n","/**\n * @module ol/style/Text\n */\nimport Fill from '../style/Fill.js';\nimport TextPlacement from '../style/TextPlacement.js';\n\n\n/**\n * The default fill color to use if no fill was set at construction time; a\n * blackish `#333`.\n *\n * @const {string}\n */\nconst DEFAULT_FILL_COLOR = '#333';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [font] Font style as CSS 'font' value, see:\n * {@link https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/font}. Default is '10px sans-serif'\n * @property {number} [maxAngle] When `placement` is set to `'line'`, allow a maximum angle between adjacent characters.\n * The expected value is in radians, and the default is 45° (`Math.PI / 4`).\n * @property {number} [offsetX=0] Horizontal text offset in pixels. A positive will shift the text right.\n * @property {number} [offsetY=0] Vertical text offset in pixels. A positive will shift the text down.\n * @property {boolean} [overflow=false] For polygon labels or when `placement` is set to `'line'`, allow text to exceed\n * the width of the polygon at the label position or the length of the path that it follows.\n * @property {module:ol/style/TextPlacement|string} [placement] Text placement.\n * @property {number} [scale] Scale.\n * @property {boolean} [rotateWithView=false] Whether to rotate the text with the view.\n * @property {number} [rotation=0] Rotation in radians (positive rotation clockwise).\n * @property {string} [text] Text content.\n * @property {string} [textAlign] Text alignment. Possible values: 'left', 'right', 'center', 'end' or 'start'.\n * Default is 'center' for `placement: 'point'`. For `placement: 'line'`, the default is to let the renderer choose a\n * placement where `maxAngle` is not exceeded.\n * @property {string} [textBaseline='middle'] Text base line. Possible values: 'bottom', 'top', 'middle', 'alphabetic',\n * 'hanging', 'ideographic'.\n * @property {module:ol/style/Fill} [fill] Fill style. If none is provided, we'll use a dark fill-style (#333).\n * @property {module:ol/style/Stroke} [stroke] Stroke style.\n * @property {module:ol/style/Fill} [backgroundFill] Fill style for the text background when `placement` is\n * `'point'`. Default is no fill.\n * @property {module:ol/style/Stroke} [backgroundStroke] Stroke style for the text background  when `placement`\n * is `'point'`. Default is no stroke.\n * @property {Array.<number>} [padding=[0, 0, 0, 0]] Padding in pixels around the text for decluttering and background. The order of\n * values in the array is `[top, right, bottom, left]`.\n */\n\n\n/**\n * @classdesc\n * Set text style for vector features.\n *\n * @constructor\n * @param {module:ol/style/Text~Options=} opt_options Options.\n * @api\n */\nconst Text = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.font_ = options.font;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.rotation_ = options.rotation;\n\n  /**\n   * @private\n   * @type {boolean|undefined}\n   */\n  this.rotateWithView_ = options.rotateWithView;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.scale_ = options.scale;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.text_ = options.text;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.textAlign_ = options.textAlign;\n\n  /**\n   * @private\n   * @type {string|undefined}\n   */\n  this.textBaseline_ = options.textBaseline;\n\n  /**\n   * @private\n   * @type {module:ol/style/Fill}\n   */\n  this.fill_ = options.fill !== undefined ? options.fill :\n    new Fill({color: DEFAULT_FILL_COLOR});\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxAngle_ = options.maxAngle !== undefined ? options.maxAngle : Math.PI / 4;\n\n  /**\n   * @private\n   * @type {module:ol/style/TextPlacement|string}\n   */\n  this.placement_ = options.placement !== undefined ? options.placement : TextPlacement.POINT;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.overflow_ = !!options.overflow;\n\n  /**\n   * @private\n   * @type {module:ol/style/Stroke}\n   */\n  this.stroke_ = options.stroke !== undefined ? options.stroke : null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.offsetX_ = options.offsetX !== undefined ? options.offsetX : 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.offsetY_ = options.offsetY !== undefined ? options.offsetY : 0;\n\n  /**\n   * @private\n   * @type {module:ol/style/Fill}\n   */\n  this.backgroundFill_ = options.backgroundFill ? options.backgroundFill : null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Stroke}\n   */\n  this.backgroundStroke_ = options.backgroundStroke ? options.backgroundStroke : null;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.padding_ = options.padding === undefined ? null : options.padding;\n};\n\n\n/**\n * Clones the style.\n * @return {module:ol/style/Text} The cloned style.\n * @api\n */\nText.prototype.clone = function() {\n  return new Text({\n    font: this.getFont(),\n    placement: this.getPlacement(),\n    maxAngle: this.getMaxAngle(),\n    overflow: this.getOverflow(),\n    rotation: this.getRotation(),\n    rotateWithView: this.getRotateWithView(),\n    scale: this.getScale(),\n    text: this.getText(),\n    textAlign: this.getTextAlign(),\n    textBaseline: this.getTextBaseline(),\n    fill: this.getFill() ? this.getFill().clone() : undefined,\n    stroke: this.getStroke() ? this.getStroke().clone() : undefined,\n    offsetX: this.getOffsetX(),\n    offsetY: this.getOffsetY(),\n    backgroundFill: this.getBackgroundFill() ? this.getBackgroundFill().clone() : undefined,\n    backgroundStroke: this.getBackgroundStroke() ? this.getBackgroundStroke().clone() : undefined\n  });\n};\n\n\n/**\n * Get the `overflow` configuration.\n * @return {boolean} Let text overflow the length of the path they follow.\n * @api\n */\nText.prototype.getOverflow = function() {\n  return this.overflow_;\n};\n\n\n/**\n * Get the font name.\n * @return {string|undefined} Font.\n * @api\n */\nText.prototype.getFont = function() {\n  return this.font_;\n};\n\n\n/**\n * Get the maximum angle between adjacent characters.\n * @return {number} Angle in radians.\n * @api\n */\nText.prototype.getMaxAngle = function() {\n  return this.maxAngle_;\n};\n\n\n/**\n * Get the label placement.\n * @return {module:ol/style/TextPlacement|string} Text placement.\n * @api\n */\nText.prototype.getPlacement = function() {\n  return this.placement_;\n};\n\n\n/**\n * Get the x-offset for the text.\n * @return {number} Horizontal text offset.\n * @api\n */\nText.prototype.getOffsetX = function() {\n  return this.offsetX_;\n};\n\n\n/**\n * Get the y-offset for the text.\n * @return {number} Vertical text offset.\n * @api\n */\nText.prototype.getOffsetY = function() {\n  return this.offsetY_;\n};\n\n\n/**\n * Get the fill style for the text.\n * @return {module:ol/style/Fill} Fill style.\n * @api\n */\nText.prototype.getFill = function() {\n  return this.fill_;\n};\n\n\n/**\n * Determine whether the text rotates with the map.\n * @return {boolean|undefined} Rotate with map.\n * @api\n */\nText.prototype.getRotateWithView = function() {\n  return this.rotateWithView_;\n};\n\n\n/**\n * Get the text rotation.\n * @return {number|undefined} Rotation.\n * @api\n */\nText.prototype.getRotation = function() {\n  return this.rotation_;\n};\n\n\n/**\n * Get the text scale.\n * @return {number|undefined} Scale.\n * @api\n */\nText.prototype.getScale = function() {\n  return this.scale_;\n};\n\n\n/**\n * Get the stroke style for the text.\n * @return {module:ol/style/Stroke} Stroke style.\n * @api\n */\nText.prototype.getStroke = function() {\n  return this.stroke_;\n};\n\n\n/**\n * Get the text to be rendered.\n * @return {string|undefined} Text.\n * @api\n */\nText.prototype.getText = function() {\n  return this.text_;\n};\n\n\n/**\n * Get the text alignment.\n * @return {string|undefined} Text align.\n * @api\n */\nText.prototype.getTextAlign = function() {\n  return this.textAlign_;\n};\n\n\n/**\n * Get the text baseline.\n * @return {string|undefined} Text baseline.\n * @api\n */\nText.prototype.getTextBaseline = function() {\n  return this.textBaseline_;\n};\n\n\n/**\n * Get the background fill style for the text.\n * @return {module:ol/style/Fill} Fill style.\n * @api\n */\nText.prototype.getBackgroundFill = function() {\n  return this.backgroundFill_;\n};\n\n\n/**\n * Get the background stroke style for the text.\n * @return {module:ol/style/Stroke} Stroke style.\n * @api\n */\nText.prototype.getBackgroundStroke = function() {\n  return this.backgroundStroke_;\n};\n\n\n/**\n * Get the padding for the text.\n * @return {Array.<number>} Padding.\n * @api\n */\nText.prototype.getPadding = function() {\n  return this.padding_;\n};\n\n\n/**\n * Set the `overflow` property.\n *\n * @param {boolean} overflow Let text overflow the path that it follows.\n * @api\n */\nText.prototype.setOverflow = function(overflow) {\n  this.overflow_ = overflow;\n};\n\n\n/**\n * Set the font.\n *\n * @param {string|undefined} font Font.\n * @api\n */\nText.prototype.setFont = function(font) {\n  this.font_ = font;\n};\n\n\n/**\n * Set the maximum angle between adjacent characters.\n *\n * @param {number} maxAngle Angle in radians.\n * @api\n */\nText.prototype.setMaxAngle = function(maxAngle) {\n  this.maxAngle_ = maxAngle;\n};\n\n\n/**\n * Set the x offset.\n *\n * @param {number} offsetX Horizontal text offset.\n * @api\n */\nText.prototype.setOffsetX = function(offsetX) {\n  this.offsetX_ = offsetX;\n};\n\n\n/**\n * Set the y offset.\n *\n * @param {number} offsetY Vertical text offset.\n * @api\n */\nText.prototype.setOffsetY = function(offsetY) {\n  this.offsetY_ = offsetY;\n};\n\n\n/**\n * Set the text placement.\n *\n * @param {module:ol/style/TextPlacement|string} placement Placement.\n * @api\n */\nText.prototype.setPlacement = function(placement) {\n  this.placement_ = placement;\n};\n\n\n/**\n * Set the fill.\n *\n * @param {module:ol/style/Fill} fill Fill style.\n * @api\n */\nText.prototype.setFill = function(fill) {\n  this.fill_ = fill;\n};\n\n\n/**\n * Set the rotation.\n *\n * @param {number|undefined} rotation Rotation.\n * @api\n */\nText.prototype.setRotation = function(rotation) {\n  this.rotation_ = rotation;\n};\n\n\n/**\n * Set the scale.\n *\n * @param {number|undefined} scale Scale.\n * @api\n */\nText.prototype.setScale = function(scale) {\n  this.scale_ = scale;\n};\n\n\n/**\n * Set the stroke.\n *\n * @param {module:ol/style/Stroke} stroke Stroke style.\n * @api\n */\nText.prototype.setStroke = function(stroke) {\n  this.stroke_ = stroke;\n};\n\n\n/**\n * Set the text.\n *\n * @param {string|undefined} text Text.\n * @api\n */\nText.prototype.setText = function(text) {\n  this.text_ = text;\n};\n\n\n/**\n * Set the text alignment.\n *\n * @param {string|undefined} textAlign Text align.\n * @api\n */\nText.prototype.setTextAlign = function(textAlign) {\n  this.textAlign_ = textAlign;\n};\n\n\n/**\n * Set the text baseline.\n *\n * @param {string|undefined} textBaseline Text baseline.\n * @api\n */\nText.prototype.setTextBaseline = function(textBaseline) {\n  this.textBaseline_ = textBaseline;\n};\n\n\n/**\n * Set the background fill.\n *\n * @param {module:ol/style/Fill} fill Fill style.\n * @api\n */\nText.prototype.setBackgroundFill = function(fill) {\n  this.backgroundFill_ = fill;\n};\n\n\n/**\n * Set the background stroke.\n *\n * @param {module:ol/style/Stroke} stroke Stroke style.\n * @api\n */\nText.prototype.setBackgroundStroke = function(stroke) {\n  this.backgroundStroke_ = stroke;\n};\n\n\n/**\n * Set the padding (`[top, right, bottom, left]`).\n *\n * @param {!Array.<number>} padding Padding.\n * @api\n */\nText.prototype.setPadding = function(padding) {\n  this.padding_ = padding;\n};\nexport default Text;\n","/**\n * @module ol/Graticule\n */\nimport {degreesToStringHDMS} from './coordinate.js';\nimport {listen, unlistenByKey} from './events.js';\nimport {intersects, getCenter} from './extent.js';\nimport GeometryLayout from './geom/GeometryLayout.js';\nimport LineString from './geom/LineString.js';\nimport Point from './geom/Point.js';\nimport {meridian, parallel} from './geom/flat/geodesic.js';\nimport {clamp} from './math.js';\nimport {get as getProjection, equivalent as equivalentProjection, getTransform, transformExtent} from './proj.js';\nimport RenderEventType from './render/EventType.js';\nimport Fill from './style/Fill.js';\nimport Stroke from './style/Stroke.js';\nimport Text from './style/Text.js';\n\n\n/**\n * @type {module:ol/style/Stroke}\n * @private\n * @const\n */\nconst DEFAULT_STROKE_STYLE = new Stroke({\n  color: 'rgba(0,0,0,0.2)'\n});\n\n/**\n * TODO can be configurable\n * @type {Array.<number>}\n * @private\n */\nconst INTERVALS = [\n  90, 45, 30, 20, 10, 5, 2, 1, 0.5, 0.2, 0.1, 0.05, 0.01, 0.005, 0.002, 0.001\n];\n\n/**\n * @typedef {Object} GraticuleLabelDataType\n * @property {module:ol/geom/Point} geom\n * @property {string} text\n */\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/PluggableMap} [map] Reference to an\n * {@link module:ol/Map~Map} object.\n * @property {number} [maxLines=100] The maximum number of meridians and\n * parallels from the center of the map. The default value of 100 means that at\n * most 200 meridians and 200 parallels will be displayed. The default value is\n * appropriate for conformal projections like Spherical Mercator. If you\n * increase the value, more lines will be drawn and the drawing performance will\n * decrease.\n * @property {module:ol/style/Stroke} [strokeStyle='rgba(0,0,0,0.2)'] The\n * stroke style to use for drawing the graticule. If not provided, a not fully\n * opaque black will be used.\n * @property {number} [targetSize=100] The target size of the graticule cells,\n * in pixels.\n * @property {boolean} [showLabels=false] Render a label with the respective\n * latitude/longitude for each graticule line.\n * @property {function(number):string} [lonLabelFormatter] Label formatter for\n * longitudes. This function is called with the longitude as argument, and\n * should return a formatted string representing the longitude. By default,\n * labels are formatted as degrees, minutes, seconds and hemisphere.\n * @property {function(number):string} [latLabelFormatter] Label formatter for\n * latitudes. This function is called with the latitude as argument, and\n * should return a formatted string representing the latitude. By default,\n * labels are formatted as degrees, minutes, seconds and hemisphere.\n * @property {number} [lonLabelPosition=0] Longitude label position in fractions\n * (0..1) of view extent. 0 means at the bottom of the viewport, 1 means at the\n * top.\n * @property {number} [latLabelPosition=1] Latitude label position in fractions\n * (0..1) of view extent. 0 means at the left of the viewport, 1 means at the\n * right.\n * @property {module:ol/style/Text} [lonLabelStyle] Longitude label text\n * style. If not provided, the following style will be used:\n * ```js\n * new Text({\n *   font: '12px Calibri,sans-serif',\n *   textBaseline: 'bottom',\n *   fill: new Fill({\n *     color: 'rgba(0,0,0,1)'\n *   }),\n *   stroke: new Stroke({\n *     color: 'rgba(255,255,255,1)',\n *     width: 3\n *   })\n * });\n * ```\n * Note that the default's `textBaseline` configuration will not work well for\n * `lonLabelPosition` configurations that position labels close to the top of\n * the viewport.\n * @property {module:ol/style/Text} [latLabelStyle] Latitude label text style.\n * If not provided, the following style will be used:\n * ```js\n * new Text({\n *   font: '12px Calibri,sans-serif',\n *   textAlign: 'end',\n *   fill: new Fill({\n *     color: 'rgba(0,0,0,1)'\n *   }),\n *   stroke: Stroke({\n *     color: 'rgba(255,255,255,1)',\n *     width: 3\n *   })\n * });\n * ```\n * Note that the default's `textAlign` configuration will not work well for\n * `latLabelPosition` configurations that position labels close to the left of\n * the viewport.\n */\n\n\n/**\n * Render a grid for a coordinate system on a map.\n * @constructor\n * @param {module:ol/Graticule~Options=} opt_options Options.\n * @api\n */\nconst Graticule = function(opt_options) {\n  const options = opt_options || {};\n\n  /**\n   * @type {module:ol/PluggableMap}\n   * @private\n   */\n  this.map_ = null;\n\n  /**\n   * @type {?module:ol/events~EventsKey}\n   * @private\n   */\n  this.postcomposeListenerKey_ = null;\n\n  /**\n   * @type {module:ol/proj/Projection}\n   */\n  this.projection_ = null;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxLat_ = Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxLon_ = Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.minLat_ = -Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.minLon_ = -Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxLatP_ = Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxLonP_ = Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.minLatP_ = -Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.minLonP_ = -Infinity;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.targetSize_ = options.targetSize !== undefined ? options.targetSize : 100;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxLines_ = options.maxLines !== undefined ? options.maxLines : 100;\n\n  /**\n   * @type {Array.<module:ol/geom/LineString>}\n   * @private\n   */\n  this.meridians_ = [];\n\n  /**\n   * @type {Array.<module:ol/geom/LineString>}\n   * @private\n   */\n  this.parallels_ = [];\n\n  /**\n   * @type {module:ol/style/Stroke}\n   * @private\n   */\n  this.strokeStyle_ = options.strokeStyle !== undefined ? options.strokeStyle : DEFAULT_STROKE_STYLE;\n\n  /**\n   * @type {module:ol/proj~TransformFunction|undefined}\n   * @private\n   */\n  this.fromLonLatTransform_ = undefined;\n\n  /**\n   * @type {module:ol/proj~TransformFunction|undefined}\n   * @private\n   */\n  this.toLonLatTransform_ = undefined;\n\n  /**\n   * @type {module:ol/coordinate~Coordinate}\n   * @private\n   */\n  this.projectionCenterLonLat_ = null;\n\n  /**\n   * @type {Array.<module:ol/Graticule~GraticuleLabelDataType>}\n   * @private\n   */\n  this.meridiansLabels_ = null;\n\n  /**\n   * @type {Array.<module:ol/Graticule~GraticuleLabelDataType>}\n   * @private\n   */\n  this.parallelsLabels_ = null;\n\n  if (options.showLabels == true) {\n\n    /**\n     * @type {null|function(number):string}\n     * @private\n     */\n    this.lonLabelFormatter_ = options.lonLabelFormatter == undefined ?\n      degreesToStringHDMS.bind(this, 'EW') : options.lonLabelFormatter;\n\n    /**\n     * @type {function(number):string}\n     * @private\n     */\n    this.latLabelFormatter_ = options.latLabelFormatter == undefined ?\n      degreesToStringHDMS.bind(this, 'NS') : options.latLabelFormatter;\n\n    /**\n     * Longitude label position in fractions (0..1) of view extent. 0 means\n     * bottom, 1 means top.\n     * @type {number}\n     * @private\n     */\n    this.lonLabelPosition_ = options.lonLabelPosition == undefined ? 0 :\n      options.lonLabelPosition;\n\n    /**\n     * Latitude Label position in fractions (0..1) of view extent. 0 means left, 1\n     * means right.\n     * @type {number}\n     * @private\n     */\n    this.latLabelPosition_ = options.latLabelPosition == undefined ? 1 :\n      options.latLabelPosition;\n\n    /**\n     * @type {module:ol/style/Text}\n     * @private\n     */\n    this.lonLabelStyle_ = options.lonLabelStyle !== undefined ? options.lonLabelStyle :\n      new Text({\n        font: '12px Calibri,sans-serif',\n        textBaseline: 'bottom',\n        fill: new Fill({\n          color: 'rgba(0,0,0,1)'\n        }),\n        stroke: new Stroke({\n          color: 'rgba(255,255,255,1)',\n          width: 3\n        })\n      });\n\n    /**\n     * @type {module:ol/style/Text}\n     * @private\n     */\n    this.latLabelStyle_ = options.latLabelStyle !== undefined ? options.latLabelStyle :\n      new Text({\n        font: '12px Calibri,sans-serif',\n        textAlign: 'end',\n        fill: new Fill({\n          color: 'rgba(0,0,0,1)'\n        }),\n        stroke: new Stroke({\n          color: 'rgba(255,255,255,1)',\n          width: 3\n        })\n      });\n\n    this.meridiansLabels_ = [];\n    this.parallelsLabels_ = [];\n  }\n\n  this.setMap(options.map !== undefined ? options.map : null);\n};\n\n\n/**\n * @param {number} lon Longitude.\n * @param {number} minLat Minimal latitude.\n * @param {number} maxLat Maximal latitude.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} index Index.\n * @return {number} Index.\n * @private\n */\nGraticule.prototype.addMeridian_ = function(lon, minLat, maxLat, squaredTolerance, extent, index) {\n  const lineString = this.getMeridian_(lon, minLat, maxLat, squaredTolerance, index);\n  if (intersects(lineString.getExtent(), extent)) {\n    if (this.meridiansLabels_) {\n      const textPoint = this.getMeridianPoint_(lineString, extent, index);\n      this.meridiansLabels_[index] = {\n        geom: textPoint,\n        text: this.lonLabelFormatter_(lon)\n      };\n    }\n    this.meridians_[index++] = lineString;\n  }\n  return index;\n};\n\n/**\n * @param {module:ol/geom/LineString} lineString Meridian\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} index Index.\n * @return {module:ol/geom/Point} Meridian point.\n * @private\n */\nGraticule.prototype.getMeridianPoint_ = function(lineString, extent, index) {\n  const flatCoordinates = lineString.getFlatCoordinates();\n  const clampedBottom = Math.max(extent[1], flatCoordinates[1]);\n  const clampedTop = Math.min(extent[3], flatCoordinates[flatCoordinates.length - 1]);\n  const lat = clamp(\n    extent[1] + Math.abs(extent[1] - extent[3]) * this.lonLabelPosition_,\n    clampedBottom, clampedTop);\n  const coordinate = [flatCoordinates[0], lat];\n  const point = this.meridiansLabels_[index] !== undefined ?\n    this.meridiansLabels_[index].geom : new Point(null);\n  point.setCoordinates(coordinate);\n  return point;\n};\n\n\n/**\n * @param {number} lat Latitude.\n * @param {number} minLon Minimal longitude.\n * @param {number} maxLon Maximal longitude.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} index Index.\n * @return {number} Index.\n * @private\n */\nGraticule.prototype.addParallel_ = function(lat, minLon, maxLon, squaredTolerance, extent, index) {\n  const lineString = this.getParallel_(lat, minLon, maxLon, squaredTolerance, index);\n  if (intersects(lineString.getExtent(), extent)) {\n    if (this.parallelsLabels_) {\n      const textPoint = this.getParallelPoint_(lineString, extent, index);\n      this.parallelsLabels_[index] = {\n        geom: textPoint,\n        text: this.latLabelFormatter_(lat)\n      };\n    }\n    this.parallels_[index++] = lineString;\n  }\n  return index;\n};\n\n\n/**\n * @param {module:ol/geom/LineString} lineString Parallels.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} index Index.\n * @return {module:ol/geom/Point} Parallel point.\n * @private\n */\nGraticule.prototype.getParallelPoint_ = function(lineString, extent, index) {\n  const flatCoordinates = lineString.getFlatCoordinates();\n  const clampedLeft = Math.max(extent[0], flatCoordinates[0]);\n  const clampedRight = Math.min(extent[2], flatCoordinates[flatCoordinates.length - 2]);\n  const lon = clamp(\n    extent[0] + Math.abs(extent[0] - extent[2]) * this.latLabelPosition_,\n    clampedLeft, clampedRight);\n  const coordinate = [lon, flatCoordinates[1]];\n  const point = this.parallelsLabels_[index] !== undefined ?\n    this.parallelsLabels_[index].geom : new Point(null);\n  point.setCoordinates(coordinate);\n  return point;\n};\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} squaredTolerance Squared tolerance.\n * @private\n */\nGraticule.prototype.createGraticule_ = function(extent, center, resolution, squaredTolerance) {\n\n  const interval = this.getInterval_(resolution);\n  if (interval == -1) {\n    this.meridians_.length = this.parallels_.length = 0;\n    if (this.meridiansLabels_) {\n      this.meridiansLabels_.length = 0;\n    }\n    if (this.parallelsLabels_) {\n      this.parallelsLabels_.length = 0;\n    }\n    return;\n  }\n\n  const centerLonLat = this.toLonLatTransform_(center);\n  let centerLon = centerLonLat[0];\n  let centerLat = centerLonLat[1];\n  const maxLines = this.maxLines_;\n  let cnt, idx, lat, lon;\n\n  let validExtent = [\n    Math.max(extent[0], this.minLonP_),\n    Math.max(extent[1], this.minLatP_),\n    Math.min(extent[2], this.maxLonP_),\n    Math.min(extent[3], this.maxLatP_)\n  ];\n\n  validExtent = transformExtent(validExtent, this.projection_, 'EPSG:4326');\n  const maxLat = validExtent[3];\n  const maxLon = validExtent[2];\n  const minLat = validExtent[1];\n  const minLon = validExtent[0];\n\n  // Create meridians\n\n  centerLon = Math.floor(centerLon / interval) * interval;\n  lon = clamp(centerLon, this.minLon_, this.maxLon_);\n\n  idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, 0);\n\n  cnt = 0;\n  while (lon != this.minLon_ && cnt++ < maxLines) {\n    lon = Math.max(lon - interval, this.minLon_);\n    idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, idx);\n  }\n\n  lon = clamp(centerLon, this.minLon_, this.maxLon_);\n\n  cnt = 0;\n  while (lon != this.maxLon_ && cnt++ < maxLines) {\n    lon = Math.min(lon + interval, this.maxLon_);\n    idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, idx);\n  }\n\n  this.meridians_.length = idx;\n  if (this.meridiansLabels_) {\n    this.meridiansLabels_.length = idx;\n  }\n\n  // Create parallels\n\n  centerLat = Math.floor(centerLat / interval) * interval;\n  lat = clamp(centerLat, this.minLat_, this.maxLat_);\n\n  idx = this.addParallel_(lat, minLon, maxLon, squaredTolerance, extent, 0);\n\n  cnt = 0;\n  while (lat != this.minLat_ && cnt++ < maxLines) {\n    lat = Math.max(lat - interval, this.minLat_);\n    idx = this.addParallel_(lat, minLon, maxLon, squaredTolerance, extent, idx);\n  }\n\n  lat = clamp(centerLat, this.minLat_, this.maxLat_);\n\n  cnt = 0;\n  while (lat != this.maxLat_ && cnt++ < maxLines) {\n    lat = Math.min(lat + interval, this.maxLat_);\n    idx = this.addParallel_(lat, minLon, maxLon, squaredTolerance, extent, idx);\n  }\n\n  this.parallels_.length = idx;\n  if (this.parallelsLabels_) {\n    this.parallelsLabels_.length = idx;\n  }\n\n};\n\n\n/**\n * @param {number} resolution Resolution.\n * @return {number} The interval in degrees.\n * @private\n */\nGraticule.prototype.getInterval_ = function(resolution) {\n  const centerLon = this.projectionCenterLonLat_[0];\n  const centerLat = this.projectionCenterLonLat_[1];\n  let interval = -1;\n  const target = Math.pow(this.targetSize_ * resolution, 2);\n  /** @type {Array.<number>} **/\n  const p1 = [];\n  /** @type {Array.<number>} **/\n  const p2 = [];\n  for (let i = 0, ii = INTERVALS.length; i < ii; ++i) {\n    const delta = INTERVALS[i] / 2;\n    p1[0] = centerLon - delta;\n    p1[1] = centerLat - delta;\n    p2[0] = centerLon + delta;\n    p2[1] = centerLat + delta;\n    this.fromLonLatTransform_(p1, p1);\n    this.fromLonLatTransform_(p2, p2);\n    const dist = Math.pow(p2[0] - p1[0], 2) + Math.pow(p2[1] - p1[1], 2);\n    if (dist <= target) {\n      break;\n    }\n    interval = INTERVALS[i];\n  }\n  return interval;\n};\n\n\n/**\n * Get the map associated with this graticule.\n * @return {module:ol/PluggableMap} The map.\n * @api\n */\nGraticule.prototype.getMap = function() {\n  return this.map_;\n};\n\n\n/**\n * @param {number} lon Longitude.\n * @param {number} minLat Minimal latitude.\n * @param {number} maxLat Maximal latitude.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {module:ol/geom/LineString} The meridian line string.\n * @param {number} index Index.\n * @private\n */\nGraticule.prototype.getMeridian_ = function(lon, minLat, maxLat, squaredTolerance, index) {\n  const flatCoordinates = meridian(lon, minLat, maxLat, this.projection_, squaredTolerance);\n  const lineString = this.meridians_[index] !== undefined ? this.meridians_[index] : new LineString(null);\n  lineString.setFlatCoordinates(GeometryLayout.XY, flatCoordinates);\n  return lineString;\n};\n\n\n/**\n * Get the list of meridians.  Meridians are lines of equal longitude.\n * @return {Array.<module:ol/geom/LineString>} The meridians.\n * @api\n */\nGraticule.prototype.getMeridians = function() {\n  return this.meridians_;\n};\n\n\n/**\n * @param {number} lat Latitude.\n * @param {number} minLon Minimal longitude.\n * @param {number} maxLon Maximal longitude.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {module:ol/geom/LineString} The parallel line string.\n * @param {number} index Index.\n * @private\n */\nGraticule.prototype.getParallel_ = function(lat, minLon, maxLon, squaredTolerance, index) {\n  const flatCoordinates = parallel(lat, minLon, maxLon, this.projection_, squaredTolerance);\n  const lineString = this.parallels_[index] !== undefined ? this.parallels_[index] : new LineString(null);\n  lineString.setFlatCoordinates(GeometryLayout.XY, flatCoordinates);\n  return lineString;\n};\n\n\n/**\n * Get the list of parallels.  Parallels are lines of equal latitude.\n * @return {Array.<module:ol/geom/LineString>} The parallels.\n * @api\n */\nGraticule.prototype.getParallels = function() {\n  return this.parallels_;\n};\n\n\n/**\n * @param {module:ol/render/Event} e Event.\n * @private\n */\nGraticule.prototype.handlePostCompose_ = function(e) {\n  const vectorContext = e.vectorContext;\n  const frameState = e.frameState;\n  const extent = frameState.extent;\n  const viewState = frameState.viewState;\n  const center = viewState.center;\n  const projection = viewState.projection;\n  const resolution = viewState.resolution;\n  const pixelRatio = frameState.pixelRatio;\n  const squaredTolerance =\n      resolution * resolution / (4 * pixelRatio * pixelRatio);\n\n  const updateProjectionInfo = !this.projection_ ||\n      !equivalentProjection(this.projection_, projection);\n\n  if (updateProjectionInfo) {\n    this.updateProjectionInfo_(projection);\n  }\n\n  this.createGraticule_(extent, center, resolution, squaredTolerance);\n\n  // Draw the lines\n  vectorContext.setFillStrokeStyle(null, this.strokeStyle_);\n  let i, l, line;\n  for (i = 0, l = this.meridians_.length; i < l; ++i) {\n    line = this.meridians_[i];\n    vectorContext.drawGeometry(line);\n  }\n  for (i = 0, l = this.parallels_.length; i < l; ++i) {\n    line = this.parallels_[i];\n    vectorContext.drawGeometry(line);\n  }\n  let labelData;\n  if (this.meridiansLabels_) {\n    for (i = 0, l = this.meridiansLabels_.length; i < l; ++i) {\n      labelData = this.meridiansLabels_[i];\n      this.lonLabelStyle_.setText(labelData.text);\n      vectorContext.setTextStyle(this.lonLabelStyle_);\n      vectorContext.drawGeometry(labelData.geom);\n    }\n  }\n  if (this.parallelsLabels_) {\n    for (i = 0, l = this.parallelsLabels_.length; i < l; ++i) {\n      labelData = this.parallelsLabels_[i];\n      this.latLabelStyle_.setText(labelData.text);\n      vectorContext.setTextStyle(this.latLabelStyle_);\n      vectorContext.drawGeometry(labelData.geom);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @private\n */\nGraticule.prototype.updateProjectionInfo_ = function(projection) {\n  const epsg4326Projection = getProjection('EPSG:4326');\n\n  const worldExtent = projection.getWorldExtent();\n  const worldExtentP = transformExtent(worldExtent, epsg4326Projection, projection);\n\n  this.maxLat_ = worldExtent[3];\n  this.maxLon_ = worldExtent[2];\n  this.minLat_ = worldExtent[1];\n  this.minLon_ = worldExtent[0];\n\n  this.maxLatP_ = worldExtentP[3];\n  this.maxLonP_ = worldExtentP[2];\n  this.minLatP_ = worldExtentP[1];\n  this.minLonP_ = worldExtentP[0];\n\n  this.fromLonLatTransform_ = getTransform(epsg4326Projection, projection);\n\n  this.toLonLatTransform_ = getTransform(projection, epsg4326Projection);\n\n  this.projectionCenterLonLat_ = this.toLonLatTransform_(getCenter(projection.getExtent()));\n\n  this.projection_ = projection;\n};\n\n\n/**\n * Set the map for this graticule.  The graticule will be rendered on the\n * provided map.\n * @param {module:ol/PluggableMap} map Map.\n * @api\n */\nGraticule.prototype.setMap = function(map) {\n  if (this.map_) {\n    unlistenByKey(this.postcomposeListenerKey_);\n    this.postcomposeListenerKey_ = null;\n    this.map_.render();\n  }\n  if (map) {\n    this.postcomposeListenerKey_ = listen(map, RenderEventType.POSTCOMPOSE, this.handlePostCompose_, this);\n    map.render();\n  }\n  this.map_ = map;\n};\nexport default Graticule;\n","/**\n * @module ol/ImageBase\n */\nimport {inherits} from './util.js';\nimport EventTarget from './events/EventTarget.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/events/EventTarget}\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number|undefined} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/ImageState} state State.\n */\nconst ImageBase = function(extent, resolution, pixelRatio, state) {\n\n  EventTarget.call(this);\n\n  /**\n   * @protected\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent = extent;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelRatio_ = pixelRatio;\n\n  /**\n   * @protected\n   * @type {number|undefined}\n   */\n  this.resolution = resolution;\n\n  /**\n   * @protected\n   * @type {module:ol/ImageState}\n   */\n  this.state = state;\n\n};\n\ninherits(ImageBase, EventTarget);\n\n\n/**\n * @protected\n */\nImageBase.prototype.changed = function() {\n  this.dispatchEvent(EventType.CHANGE);\n};\n\n\n/**\n * @return {module:ol/extent~Extent} Extent.\n */\nImageBase.prototype.getExtent = function() {\n  return this.extent;\n};\n\n\n/**\n * @abstract\n * @return {HTMLCanvasElement|Image|HTMLVideoElement} Image.\n */\nImageBase.prototype.getImage = function() {};\n\n\n/**\n * @return {number} PixelRatio.\n */\nImageBase.prototype.getPixelRatio = function() {\n  return this.pixelRatio_;\n};\n\n\n/**\n * @return {number} Resolution.\n */\nImageBase.prototype.getResolution = function() {\n  return /** @type {number} */ (this.resolution);\n};\n\n\n/**\n * @return {module:ol/ImageState} State.\n */\nImageBase.prototype.getState = function() {\n  return this.state;\n};\n\n\n/**\n * Load not yet loaded URI.\n * @abstract\n */\nImageBase.prototype.load = function() {};\n\nexport default ImageBase;\n","/**\n * @module ol/Image\n */\nimport {inherits} from './util.js';\nimport ImageBase from './ImageBase.js';\nimport ImageState from './ImageState.js';\nimport {listenOnce, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\nimport {getHeight} from './extent.js';\n\n\n/**\n * A function that takes an {@link module:ol/Image~Image} for the image and a\n * `{string}` for the src as arguments. It is supposed to make it so the\n * underlying image {@link module:ol/Image~Image#getImage} is assigned the\n * content specified by the src. If not specified, the default is\n *\n *     function(image, src) {\n *       image.getImage().src = src;\n *     }\n *\n * Providing a custom `imageLoadFunction` can be useful to load images with\n * post requests or - in general - through XHR requests, where the src of the\n * image element would be set to a data URI when the content is loaded.\n *\n * @typedef {function(module:ol/Image, string)} LoadFunction\n * @api\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/ImageBase}\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number|undefined} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {string} src Image source URI.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/Image~LoadFunction} imageLoadFunction Image load function.\n */\nconst ImageWrapper = function(extent, resolution, pixelRatio, src, crossOrigin, imageLoadFunction) {\n\n  ImageBase.call(this, extent, resolution, pixelRatio, ImageState.IDLE);\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.src_ = src;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement|Image|HTMLVideoElement}\n   */\n  this.image_ = new Image();\n  if (crossOrigin !== null) {\n    this.image_.crossOrigin = crossOrigin;\n  }\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.imageListenerKeys_ = null;\n\n  /**\n   * @protected\n   * @type {module:ol/ImageState}\n   */\n  this.state = ImageState.IDLE;\n\n  /**\n   * @private\n   * @type {module:ol/Image~LoadFunction}\n   */\n  this.imageLoadFunction_ = imageLoadFunction;\n\n};\n\ninherits(ImageWrapper, ImageBase);\n\n\n/**\n * @inheritDoc\n * @api\n */\nImageWrapper.prototype.getImage = function() {\n  return this.image_;\n};\n\n\n/**\n * Tracks loading or read errors.\n *\n * @private\n */\nImageWrapper.prototype.handleImageError_ = function() {\n  this.state = ImageState.ERROR;\n  this.unlistenImage_();\n  this.changed();\n};\n\n\n/**\n * Tracks successful image load.\n *\n * @private\n */\nImageWrapper.prototype.handleImageLoad_ = function() {\n  if (this.resolution === undefined) {\n    this.resolution = getHeight(this.extent) / this.image_.height;\n  }\n  this.state = ImageState.LOADED;\n  this.unlistenImage_();\n  this.changed();\n};\n\n\n/**\n * Load the image or retry if loading previously failed.\n * Loading is taken care of by the tile queue, and calling this method is\n * only needed for preloading or for reloading in case of an error.\n * @override\n * @api\n */\nImageWrapper.prototype.load = function() {\n  if (this.state == ImageState.IDLE || this.state == ImageState.ERROR) {\n    this.state = ImageState.LOADING;\n    this.changed();\n    this.imageListenerKeys_ = [\n      listenOnce(this.image_, EventType.ERROR,\n        this.handleImageError_, this),\n      listenOnce(this.image_, EventType.LOAD,\n        this.handleImageLoad_, this)\n    ];\n    this.imageLoadFunction_(this, this.src_);\n  }\n};\n\n\n/**\n * @param {HTMLCanvasElement|Image|HTMLVideoElement} image Image.\n */\nImageWrapper.prototype.setImage = function(image) {\n  this.image_ = image;\n};\n\n\n/**\n * Discards event handlers which listen for load completion or errors.\n *\n * @private\n */\nImageWrapper.prototype.unlistenImage_ = function() {\n  this.imageListenerKeys_.forEach(unlistenByKey);\n  this.imageListenerKeys_ = null;\n};\n\nexport default ImageWrapper;\n","/**\n * @module ol/ImageCanvas\n */\nimport {inherits} from './util.js';\nimport ImageBase from './ImageBase.js';\nimport ImageState from './ImageState.js';\n\n\n/**\n * A function that is called to trigger asynchronous canvas drawing.  It is\n * called with a \"done\" callback that should be called when drawing is done.\n * If any error occurs during drawing, the \"done\" callback should be called with\n * that error.\n *\n * @typedef {function(function(Error))} Loader\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/ImageBase}\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {HTMLCanvasElement} canvas Canvas.\n * @param {module:ol/ImageCanvas~Loader=} opt_loader Optional loader function to\n *     support asynchronous canvas drawing.\n */\nconst ImageCanvas = function(extent, resolution, pixelRatio, canvas, opt_loader) {\n\n  /**\n   * Optional canvas loader function.\n   * @type {?module:ol/ImageCanvas~Loader}\n   * @private\n   */\n  this.loader_ = opt_loader !== undefined ? opt_loader : null;\n\n  const state = opt_loader !== undefined ? ImageState.IDLE : ImageState.LOADED;\n\n  ImageBase.call(this, extent, resolution, pixelRatio, state);\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = canvas;\n\n  /**\n   * @private\n   * @type {Error}\n   */\n  this.error_ = null;\n\n};\n\ninherits(ImageCanvas, ImageBase);\n\n\n/**\n * Get any error associated with asynchronous rendering.\n * @return {Error} Any error that occurred during rendering.\n */\nImageCanvas.prototype.getError = function() {\n  return this.error_;\n};\n\n\n/**\n * Handle async drawing complete.\n * @param {Error} err Any error during drawing.\n * @private\n */\nImageCanvas.prototype.handleLoad_ = function(err) {\n  if (err) {\n    this.error_ = err;\n    this.state = ImageState.ERROR;\n  } else {\n    this.state = ImageState.LOADED;\n  }\n  this.changed();\n};\n\n\n/**\n * @inheritDoc\n */\nImageCanvas.prototype.load = function() {\n  if (this.state == ImageState.IDLE) {\n    this.state = ImageState.LOADING;\n    this.changed();\n    this.loader_(this.handleLoad_.bind(this));\n  }\n};\n\n\n/**\n * @return {HTMLCanvasElement} Canvas element.\n */\nImageCanvas.prototype.getImage = function() {\n  return this.canvas_;\n};\nexport default ImageCanvas;\n","/**\n * @module ol/TileState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  ERROR: 3,\n  EMPTY: 4,\n  ABORT: 5\n};\n","/**\n * @module ol/easing\n */\n\n\n/**\n * Start slow and speed up.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function easeIn(t) {\n  return Math.pow(t, 3);\n}\n\n\n/**\n * Start fast and slow down.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function easeOut(t) {\n  return 1 - easeIn(1 - t);\n}\n\n\n/**\n * Start slow, speed up, and then slow down again.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function inAndOut(t) {\n  return 3 * t * t - 2 * t * t * t;\n}\n\n\n/**\n * Maintain a constant speed over time.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function linear(t) {\n  return t;\n}\n\n\n/**\n * Start slow, speed up, and at the very end slow down again.  This has the\n * same general behavior as {@link module:ol/easing~inAndOut}, but the final\n * slowdown is delayed.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function upAndDown(t) {\n  if (t < 0.5) {\n    return inAndOut(2 * t);\n  } else {\n    return 1 - inAndOut(2 * (t - 0.5));\n  }\n}\n","/**\n * @module ol/Tile\n */\nimport {inherits} from './util.js';\nimport TileState from './TileState.js';\nimport {easeIn} from './easing.js';\nimport EventTarget from './events/EventTarget.js';\nimport EventType from './events/EventType.js';\n\n\n/**\n * A function that takes an {@link module:ol/Tile} for the tile and a\n * `{string}` for the url as arguments.\n *\n * @typedef {function(module:ol/Tile, string)} LoadFunction\n * @api\n */\n\n/**\n * {@link module:ol/source/Tile~Tile} sources use a function of this type to get\n * the url that provides a tile for a given tile coordinate.\n *\n * This function takes an {@link module:ol/tilecoord~TileCoord} for the tile\n * coordinate, a `{number}` representing the pixel ratio and a\n * {@link module:ol/proj/Projection} for the projection  as arguments\n * and returns a `{string}` representing the tile URL, or undefined if no tile\n * should be requested for the passed tile coordinate.\n *\n * @typedef {function(module:ol/tilecoord~TileCoord, number,\n *           module:ol/proj/Projection): (string|undefined)} UrlFunction\n * @api\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [transition=250] A duration for tile opacity\n * transitions in milliseconds. A duration of 0 disables the opacity transition.\n * @api\n */\n\n\n/**\n * @classdesc\n * Base class for tiles.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/events/EventTarget}\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/TileState} state State.\n * @param {module:ol/Tile~Options=} opt_options Tile options.\n */\nconst Tile = function(tileCoord, state, opt_options) {\n  EventTarget.call(this);\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @type {module:ol/tilecoord~TileCoord}\n   */\n  this.tileCoord = tileCoord;\n\n  /**\n   * @protected\n   * @type {module:ol/TileState}\n   */\n  this.state = state;\n\n  /**\n   * An \"interim\" tile for this tile. The interim tile may be used while this\n   * one is loading, for \"smooth\" transitions when changing params/dimensions\n   * on the source.\n   * @type {module:ol/Tile}\n   */\n  this.interimTile = null;\n\n  /**\n   * A key assigned to the tile. This is used by the tile source to determine\n   * if this tile can effectively be used, or if a new tile should be created\n   * and this one be used as an interim tile for this new tile.\n   * @type {string}\n   */\n  this.key = '';\n\n  /**\n   * The duration for the opacity transition.\n   * @type {number}\n   */\n  this.transition_ = options.transition === undefined ? 250 : options.transition;\n\n  /**\n   * Lookup of start times for rendering transitions.  If the start time is\n   * equal to -1, the transition is complete.\n   * @type {Object.<number, number>}\n   */\n  this.transitionStarts_ = {};\n\n};\n\ninherits(Tile, EventTarget);\n\n\n/**\n * @protected\n */\nTile.prototype.changed = function() {\n  this.dispatchEvent(EventType.CHANGE);\n};\n\n\n/**\n * @return {string} Key.\n */\nTile.prototype.getKey = function() {\n  return this.key + '/' + this.tileCoord;\n};\n\n/**\n * Get the interim tile most suitable for rendering using the chain of interim\n * tiles. This corresponds to the  most recent tile that has been loaded, if no\n * such tile exists, the original tile is returned.\n * @return {!module:ol/Tile} Best tile for rendering.\n */\nTile.prototype.getInterimTile = function() {\n  if (!this.interimTile) {\n    //empty chain\n    return this;\n  }\n  let tile = this.interimTile;\n\n  // find the first loaded tile and return it. Since the chain is sorted in\n  // decreasing order of creation time, there is no need to search the remainder\n  // of the list (all those tiles correspond to older requests and will be\n  // cleaned up by refreshInterimChain)\n  do {\n    if (tile.getState() == TileState.LOADED) {\n      return tile;\n    }\n    tile = tile.interimTile;\n  } while (tile);\n\n  // we can not find a better tile\n  return this;\n};\n\n/**\n * Goes through the chain of interim tiles and discards sections of the chain\n * that are no longer relevant.\n */\nTile.prototype.refreshInterimChain = function() {\n  if (!this.interimTile) {\n    return;\n  }\n\n  let tile = this.interimTile;\n  let prev = this;\n\n  do {\n    if (tile.getState() == TileState.LOADED) {\n      //we have a loaded tile, we can discard the rest of the list\n      //we would could abort any LOADING tile request\n      //older than this tile (i.e. any LOADING tile following this entry in the chain)\n      tile.interimTile = null;\n      break;\n    } else if (tile.getState() == TileState.LOADING) {\n      //keep this LOADING tile any loaded tiles later in the chain are\n      //older than this tile, so we're still interested in the request\n      prev = tile;\n    } else if (tile.getState() == TileState.IDLE) {\n      //the head of the list is the most current tile, we don't need\n      //to start any other requests for this chain\n      prev.interimTile = tile.interimTile;\n    } else {\n      prev = tile;\n    }\n    tile = prev.interimTile;\n  } while (tile);\n};\n\n/**\n * Get the tile coordinate for this tile.\n * @return {module:ol/tilecoord~TileCoord} The tile coordinate.\n * @api\n */\nTile.prototype.getTileCoord = function() {\n  return this.tileCoord;\n};\n\n\n/**\n * @return {module:ol/TileState} State.\n */\nTile.prototype.getState = function() {\n  return this.state;\n};\n\n/**\n * @param {module:ol/TileState} state State.\n */\nTile.prototype.setState = function(state) {\n  this.state = state;\n  this.changed();\n};\n\n/**\n * Load the image or retry if loading previously failed.\n * Loading is taken care of by the tile queue, and calling this method is\n * only needed for preloading or for reloading in case of an error.\n * @abstract\n * @api\n */\nTile.prototype.load = function() {};\n\n/**\n * Get the alpha value for rendering.\n * @param {number} id An id for the renderer.\n * @param {number} time The render frame time.\n * @return {number} A number between 0 and 1.\n */\nTile.prototype.getAlpha = function(id, time) {\n  if (!this.transition_) {\n    return 1;\n  }\n\n  let start = this.transitionStarts_[id];\n  if (!start) {\n    start = time;\n    this.transitionStarts_[id] = start;\n  } else if (start === -1) {\n    return 1;\n  }\n\n  const delta = time - start + (1000 / 60); // avoid rendering at 0\n  if (delta >= this.transition_) {\n    return 1;\n  }\n  return easeIn(delta / this.transition_);\n};\n\n/**\n * Determine if a tile is in an alpha transition.  A tile is considered in\n * transition if tile.getAlpha() has not yet been called or has been called\n * and returned 1.\n * @param {number} id An id for the renderer.\n * @return {boolean} The tile is in transition.\n */\nTile.prototype.inTransition = function(id) {\n  if (!this.transition_) {\n    return false;\n  }\n  return this.transitionStarts_[id] !== -1;\n};\n\n/**\n * Mark a transition as complete.\n * @param {number} id An id for the renderer.\n */\nTile.prototype.endTransition = function(id) {\n  if (this.transition_) {\n    this.transitionStarts_[id] = -1;\n  }\n};\nexport default Tile;\n","/**\n * @module ol/ImageTile\n */\nimport {inherits} from './util.js';\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\nimport {createCanvasContext2D} from './dom.js';\nimport {listenOnce, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @typedef {function(new: module:ol/ImageTile, module:ol/tilecoord~TileCoord,\n * module:ol/TileState, string, ?string, module:ol/Tile~LoadFunction)} TileClass\n * @api\n */\n\n/**\n * @constructor\n * @extends {module:ol/Tile}\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/TileState} state State.\n * @param {string} src Image source URI.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/Tile~LoadFunction} tileLoadFunction Tile load function.\n * @param {module:ol/Tile~Options=} opt_options Tile options.\n */\nconst ImageTile = function(tileCoord, state, src, crossOrigin, tileLoadFunction, opt_options) {\n\n  Tile.call(this, tileCoord, state, opt_options);\n\n  /**\n   * @private\n   * @type {?string}\n   */\n  this.crossOrigin_ = crossOrigin;\n\n  /**\n   * Image URI\n   *\n   * @private\n   * @type {string}\n   */\n  this.src_ = src;\n\n  /**\n   * @private\n   * @type {Image|HTMLCanvasElement}\n   */\n  this.image_ = new Image();\n  if (crossOrigin !== null) {\n    this.image_.crossOrigin = crossOrigin;\n  }\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.imageListenerKeys_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/Tile~LoadFunction}\n   */\n  this.tileLoadFunction_ = tileLoadFunction;\n\n};\n\ninherits(ImageTile, Tile);\n\n\n/**\n * @inheritDoc\n */\nImageTile.prototype.disposeInternal = function() {\n  if (this.state == TileState.LOADING) {\n    this.unlistenImage_();\n    this.image_ = getBlankImage();\n  }\n  if (this.interimTile) {\n    this.interimTile.dispose();\n  }\n  this.state = TileState.ABORT;\n  this.changed();\n  Tile.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * Get the HTML image element for this tile (may be a Canvas, Image, or Video).\n * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n * @api\n */\nImageTile.prototype.getImage = function() {\n  return this.image_;\n};\n\n\n/**\n * @inheritDoc\n */\nImageTile.prototype.getKey = function() {\n  return this.src_;\n};\n\n\n/**\n * Tracks loading or read errors.\n *\n * @private\n */\nImageTile.prototype.handleImageError_ = function() {\n  this.state = TileState.ERROR;\n  this.unlistenImage_();\n  this.image_ = getBlankImage();\n  this.changed();\n};\n\n\n/**\n * Tracks successful image load.\n *\n * @private\n */\nImageTile.prototype.handleImageLoad_ = function() {\n  if (this.image_.naturalWidth && this.image_.naturalHeight) {\n    this.state = TileState.LOADED;\n  } else {\n    this.state = TileState.EMPTY;\n  }\n  this.unlistenImage_();\n  this.changed();\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nImageTile.prototype.load = function() {\n  if (this.state == TileState.ERROR) {\n    this.state = TileState.IDLE;\n    this.image_ = new Image();\n    if (this.crossOrigin_ !== null) {\n      this.image_.crossOrigin = this.crossOrigin_;\n    }\n  }\n  if (this.state == TileState.IDLE) {\n    this.state = TileState.LOADING;\n    this.changed();\n    this.imageListenerKeys_ = [\n      listenOnce(this.image_, EventType.ERROR,\n        this.handleImageError_, this),\n      listenOnce(this.image_, EventType.LOAD,\n        this.handleImageLoad_, this)\n    ];\n    this.tileLoadFunction_(this, this.src_);\n  }\n};\n\n\n/**\n * Discards event handlers which listen for load completion or errors.\n *\n * @private\n */\nImageTile.prototype.unlistenImage_ = function() {\n  this.imageListenerKeys_.forEach(unlistenByKey);\n  this.imageListenerKeys_ = null;\n};\n\n\n/**\n * Get a 1-pixel blank image.\n * @return {HTMLCanvasElement} Blank image.\n */\nfunction getBlankImage() {\n  const ctx = createCanvasContext2D(1, 1);\n  ctx.fillStyle = 'rgba(0,0,0,0)';\n  ctx.fillRect(0, 0, 1, 1);\n  return ctx.canvas;\n}\n\nexport default ImageTile;\n","/**\n * @module ol/Kinetic\n */\n\n/**\n * @classdesc\n * Implementation of inertial deceleration for map movement.\n *\n * @constructor\n * @param {number} decay Rate of decay (must be negative).\n * @param {number} minVelocity Minimum velocity (pixels/millisecond).\n * @param {number} delay Delay to consider to calculate the kinetic\n *     initial values (milliseconds).\n * @struct\n * @api\n */\nconst Kinetic = function(decay, minVelocity, delay) {\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.decay_ = decay;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.minVelocity_ = minVelocity;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.delay_ = delay;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.points_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.angle_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.initialVelocity_ = 0;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nKinetic.prototype.begin = function() {\n  this.points_.length = 0;\n  this.angle_ = 0;\n  this.initialVelocity_ = 0;\n};\n\n\n/**\n * @param {number} x X.\n * @param {number} y Y.\n */\nKinetic.prototype.update = function(x, y) {\n  this.points_.push(x, y, Date.now());\n};\n\n\n/**\n * @return {boolean} Whether we should do kinetic animation.\n */\nKinetic.prototype.end = function() {\n  if (this.points_.length < 6) {\n    // at least 2 points are required (i.e. there must be at least 6 elements\n    // in the array)\n    return false;\n  }\n  const delay = Date.now() - this.delay_;\n  const lastIndex = this.points_.length - 3;\n  if (this.points_[lastIndex + 2] < delay) {\n    // the last tracked point is too old, which means that the user stopped\n    // panning before releasing the map\n    return false;\n  }\n\n  // get the first point which still falls into the delay time\n  let firstIndex = lastIndex - 3;\n  while (firstIndex > 0 && this.points_[firstIndex + 2] > delay) {\n    firstIndex -= 3;\n  }\n\n  const duration = this.points_[lastIndex + 2] - this.points_[firstIndex + 2];\n  // we don't want a duration of 0 (divide by zero)\n  // we also make sure the user panned for a duration of at least one frame\n  // (1/60s) to compute sane displacement values\n  if (duration < 1000 / 60) {\n    return false;\n  }\n\n  const dx = this.points_[lastIndex] - this.points_[firstIndex];\n  const dy = this.points_[lastIndex + 1] - this.points_[firstIndex + 1];\n  this.angle_ = Math.atan2(dy, dx);\n  this.initialVelocity_ = Math.sqrt(dx * dx + dy * dy) / duration;\n  return this.initialVelocity_ > this.minVelocity_;\n};\n\n\n/**\n * @return {number} Total distance travelled (pixels).\n */\nKinetic.prototype.getDistance = function() {\n  return (this.minVelocity_ - this.initialVelocity_) / this.decay_;\n};\n\n\n/**\n * @return {number} Angle of the kinetic panning animation (radians).\n */\nKinetic.prototype.getAngle = function() {\n  return this.angle_;\n};\nexport default Kinetic;\n","/**\n * @module ol/MapEvent\n */\nimport {inherits} from './util.js';\nimport Event from './events/Event.js';\n\n/**\n * @classdesc\n * Events emitted as map events are instances of this type.\n * See {@link module:ol/Map~Map} for which events trigger a map event.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {string} type Event type.\n * @param {module:ol/PluggableMap} map Map.\n * @param {?module:ol/PluggableMap~FrameState=} opt_frameState Frame state.\n */\nconst MapEvent = function(type, map, opt_frameState) {\n\n  Event.call(this, type);\n\n  /**\n   * The map where the event occurred.\n   * @type {module:ol/PluggableMap}\n   * @api\n   */\n  this.map = map;\n\n  /**\n   * The frame state at the time of the event.\n   * @type {?module:ol/PluggableMap~FrameState}\n   * @api\n   */\n  this.frameState = opt_frameState !== undefined ? opt_frameState : null;\n\n};\n\ninherits(MapEvent, Event);\nexport default MapEvent;\n","/**\n * @module ol/MapBrowserEvent\n */\nimport {inherits} from './util.js';\nimport MapEvent from './MapEvent.js';\n\n/**\n * @classdesc\n * Events emitted as map browser events are instances of this type.\n * See {@link module:ol/Map~Map} for which events trigger a map browser event.\n *\n * @constructor\n * @extends {module:ol/MapEvent}\n * @param {string} type Event type.\n * @param {module:ol/PluggableMap} map Map.\n * @param {Event} browserEvent Browser event.\n * @param {boolean=} opt_dragging Is the map currently being dragged?\n * @param {?module:ol/PluggableMap~FrameState=} opt_frameState Frame state.\n */\nconst MapBrowserEvent = function(type, map, browserEvent, opt_dragging, opt_frameState) {\n\n  MapEvent.call(this, type, map, opt_frameState);\n\n  /**\n   * The original browser event.\n   * @const\n   * @type {Event}\n   * @api\n   */\n  this.originalEvent = browserEvent;\n\n  /**\n   * The map pixel relative to the viewport corresponding to the original browser event.\n   * @type {module:ol~Pixel}\n   * @api\n   */\n  this.pixel = map.getEventPixel(browserEvent);\n\n  /**\n   * The coordinate in view projection corresponding to the original browser event.\n   * @type {module:ol/coordinate~Coordinate}\n   * @api\n   */\n  this.coordinate = map.getCoordinateFromPixel(this.pixel);\n\n  /**\n   * Indicates if the map is currently being dragged. Only set for\n   * `POINTERDRAG` and `POINTERMOVE` events. Default is `false`.\n   *\n   * @type {boolean}\n   * @api\n   */\n  this.dragging = opt_dragging !== undefined ? opt_dragging : false;\n\n};\n\ninherits(MapBrowserEvent, MapEvent);\n\n\n/**\n * Prevents the default browser action.\n * @see https://developer.mozilla.org/en-US/docs/Web/API/event.preventDefault\n * @override\n * @api\n */\nMapBrowserEvent.prototype.preventDefault = function() {\n  MapEvent.prototype.preventDefault.call(this);\n  this.originalEvent.preventDefault();\n};\n\n\n/**\n * Prevents further propagation of the current event.\n * @see https://developer.mozilla.org/en-US/docs/Web/API/event.stopPropagation\n * @override\n * @api\n */\nMapBrowserEvent.prototype.stopPropagation = function() {\n  MapEvent.prototype.stopPropagation.call(this);\n  this.originalEvent.stopPropagation();\n};\nexport default MapBrowserEvent;\n","/**\n * @module ol/MapBrowserEventType\n */\nimport EventType from './events/EventType.js';\n\n/**\n * Constants for event names.\n * @enum {string}\n */\nexport default {\n\n  /**\n   * A true single click with no dragging and no double click. Note that this\n   * event is delayed by 250 ms to ensure that it is not a double click.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#singleclick\n   * @api\n   */\n  SINGLECLICK: 'singleclick',\n\n  /**\n   * A click with no dragging. A double click will fire two of this.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#click\n   * @api\n   */\n  CLICK: EventType.CLICK,\n\n  /**\n   * A true double click, with no dragging.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#dblclick\n   * @api\n   */\n  DBLCLICK: EventType.DBLCLICK,\n\n  /**\n   * Triggered when a pointer is dragged.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointerdrag\n   * @api\n   */\n  POINTERDRAG: 'pointerdrag',\n\n  /**\n   * Triggered when a pointer is moved. Note that on touch devices this is\n   * triggered when the map is panned, so is not the same as mousemove.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointermove\n   * @api\n   */\n  POINTERMOVE: 'pointermove',\n\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  POINTERCANCEL: 'pointercancel'\n};\n","/**\n * @module ol/MapBrowserPointerEvent\n */\nimport {inherits} from './util.js';\nimport MapBrowserEvent from './MapBrowserEvent.js';\n\n/**\n * @constructor\n * @extends {module:ol/MapBrowserEvent}\n * @param {string} type Event type.\n * @param {module:ol/PluggableMap} map Map.\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @param {boolean=} opt_dragging Is the map currently being dragged?\n * @param {?module:ol/PluggableMap~FrameState=} opt_frameState Frame state.\n */\nconst MapBrowserPointerEvent = function(type, map, pointerEvent, opt_dragging,\n  opt_frameState) {\n\n  MapBrowserEvent.call(this, type, map, pointerEvent.originalEvent, opt_dragging,\n    opt_frameState);\n\n  /**\n   * @const\n   * @type {module:ol/pointer/PointerEvent}\n   */\n  this.pointerEvent = pointerEvent;\n\n};\n\ninherits(MapBrowserPointerEvent, MapBrowserEvent);\nexport default MapBrowserPointerEvent;\n","/**\n * @module ol/pointer/EventType\n */\n\n/**\n * Constants for event names.\n * @enum {string}\n */\nexport default {\n  POINTERMOVE: 'pointermove',\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  POINTERCANCEL: 'pointercancel'\n};\n","/**\n * @module ol/pointer/EventSource\n */\n/**\n * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\n * @param {!Object.<string, function(Event)>} mapping Event mapping.\n * @constructor\n */\nconst EventSource = function(dispatcher, mapping) {\n  /**\n   * @type {module:ol/pointer/PointerEventHandler}\n   */\n  this.dispatcher = dispatcher;\n\n  /**\n   * @private\n   * @const\n   * @type {!Object.<string, function(Event)>}\n   */\n  this.mapping_ = mapping;\n};\n\n\n/**\n * List of events supported by this source.\n * @return {Array.<string>} Event names\n */\nEventSource.prototype.getEvents = function() {\n  return Object.keys(this.mapping_);\n};\n\n\n/**\n * Returns the handler that should handle a given event type.\n * @param {string} eventType The event type.\n * @return {function(Event)} Handler\n */\nEventSource.prototype.getHandlerForEvent = function(eventType) {\n  return this.mapping_[eventType];\n};\nexport default EventSource;\n","/**\n * @module ol/pointer/MouseSource\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../util.js';\nimport EventSource from '../pointer/EventSource.js';\n\n/**\n * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\n * @constructor\n * @extends {module:ol/pointer/EventSource}\n */\nconst MouseSource = function(dispatcher) {\n  const mapping = {\n    'mousedown': this.mousedown,\n    'mousemove': this.mousemove,\n    'mouseup': this.mouseup,\n    'mouseover': this.mouseover,\n    'mouseout': this.mouseout\n  };\n  EventSource.call(this, dispatcher, mapping);\n\n  /**\n   * @const\n   * @type {!Object.<string, Event|Object>}\n   */\n  this.pointerMap = dispatcher.pointerMap;\n\n  /**\n   * @const\n   * @type {Array.<module:ol~Pixel>}\n   */\n  this.lastTouches = [];\n};\n\ninherits(MouseSource, EventSource);\n\n\n/**\n * @type {number}\n */\nexport const POINTER_ID = 1;\n\n\n/**\n * @type {string}\n */\nexport const POINTER_TYPE = 'mouse';\n\n\n/**\n * Radius around touchend that swallows mouse events.\n *\n * @type {number}\n */\nconst DEDUP_DIST = 25;\n\n\n/**\n * Detect if a mouse event was simulated from a touch by\n * checking if previously there was a touch event at the\n * same position.\n *\n * FIXME - Known problem with the native Android browser on\n * Samsung GT-I9100 (Android 4.1.2):\n * In case the page is scrolled, this function does not work\n * correctly when a canvas is used (WebGL or canvas renderer).\n * Mouse listeners on canvas elements (for this browser), create\n * two mouse events: One 'good' and one 'bad' one (on other browsers or\n * when a div is used, there is only one event). For the 'bad' one,\n * clientX/clientY and also pageX/pageY are wrong when the page\n * is scrolled. Because of that, this function can not detect if\n * the events were simulated from a touch event. As result, a\n * pointer event at a wrong position is dispatched, which confuses\n * the map interactions.\n * It is unclear, how one can get the correct position for the event\n * or detect that the positions are invalid.\n *\n * @private\n * @param {Event} inEvent The in event.\n * @return {boolean} True, if the event was generated by a touch.\n */\nMouseSource.prototype.isEventSimulatedFromTouch_ = function(inEvent) {\n  const lts = this.lastTouches;\n  const x = inEvent.clientX;\n  const y = inEvent.clientY;\n  for (let i = 0, l = lts.length, t; i < l && (t = lts[i]); i++) {\n    // simulated mouse events will be swallowed near a primary touchend\n    const dx = Math.abs(x - t[0]);\n    const dy = Math.abs(y - t[1]);\n    if (dx <= DEDUP_DIST && dy <= DEDUP_DIST) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Creates a copy of the original event that will be used\n * for the fake pointer event.\n *\n * @param {Event} inEvent The in event.\n * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\n * @return {Object} The copied event.\n */\nfunction prepareEvent(inEvent, dispatcher) {\n  const e = dispatcher.cloneEvent(inEvent, inEvent);\n\n  // forward mouse preventDefault\n  const pd = e.preventDefault;\n  e.preventDefault = function() {\n    inEvent.preventDefault();\n    pd();\n  };\n\n  e.pointerId = POINTER_ID;\n  e.isPrimary = true;\n  e.pointerType = POINTER_TYPE;\n\n  return e;\n}\n\n\n/**\n * Handler for `mousedown`.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.mousedown = function(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    // TODO(dfreedman) workaround for some elements not sending mouseup\n    // http://crbug/149091\n    if (POINTER_ID.toString() in this.pointerMap) {\n      this.cancel(inEvent);\n    }\n    const e = prepareEvent(inEvent, this.dispatcher);\n    this.pointerMap[POINTER_ID.toString()] = inEvent;\n    this.dispatcher.down(e, inEvent);\n  }\n};\n\n\n/**\n * Handler for `mousemove`.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.mousemove = function(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    const e = prepareEvent(inEvent, this.dispatcher);\n    this.dispatcher.move(e, inEvent);\n  }\n};\n\n\n/**\n * Handler for `mouseup`.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.mouseup = function(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    const p = this.pointerMap[POINTER_ID.toString()];\n\n    if (p && p.button === inEvent.button) {\n      const e = prepareEvent(inEvent, this.dispatcher);\n      this.dispatcher.up(e, inEvent);\n      this.cleanupMouse();\n    }\n  }\n};\n\n\n/**\n * Handler for `mouseover`.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.mouseover = function(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    const e = prepareEvent(inEvent, this.dispatcher);\n    this.dispatcher.enterOver(e, inEvent);\n  }\n};\n\n\n/**\n * Handler for `mouseout`.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.mouseout = function(inEvent) {\n  if (!this.isEventSimulatedFromTouch_(inEvent)) {\n    const e = prepareEvent(inEvent, this.dispatcher);\n    this.dispatcher.leaveOut(e, inEvent);\n  }\n};\n\n\n/**\n * Dispatches a `pointercancel` event.\n *\n * @param {Event} inEvent The in event.\n */\nMouseSource.prototype.cancel = function(inEvent) {\n  const e = prepareEvent(inEvent, this.dispatcher);\n  this.dispatcher.cancel(e, inEvent);\n  this.cleanupMouse();\n};\n\n\n/**\n * Remove the mouse from the list of active pointers.\n */\nMouseSource.prototype.cleanupMouse = function() {\n  delete this.pointerMap[POINTER_ID.toString()];\n};\nexport default MouseSource;\n","/**\n * @module ol/pointer/MsSource\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../util.js';\nimport EventSource from '../pointer/EventSource.js';\n\n/**\n * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\n * @constructor\n * @extends {module:ol/pointer/EventSource}\n */\nconst MsSource = function(dispatcher) {\n  const mapping = {\n    'MSPointerDown': this.msPointerDown,\n    'MSPointerMove': this.msPointerMove,\n    'MSPointerUp': this.msPointerUp,\n    'MSPointerOut': this.msPointerOut,\n    'MSPointerOver': this.msPointerOver,\n    'MSPointerCancel': this.msPointerCancel,\n    'MSGotPointerCapture': this.msGotPointerCapture,\n    'MSLostPointerCapture': this.msLostPointerCapture\n  };\n  EventSource.call(this, dispatcher, mapping);\n\n  /**\n   * @const\n   * @type {!Object.<string, MSPointerEvent|Object>}\n   */\n  this.pointerMap = dispatcher.pointerMap;\n};\n\ninherits(MsSource, EventSource);\n\n/**\n * @const\n * @type {Array.<string>}\n */\nconst POINTER_TYPES = [\n  '',\n  'unavailable',\n  'touch',\n  'pen',\n  'mouse'\n];\n\n\n/**\n * Creates a copy of the original event that will be used\n * for the fake pointer event.\n *\n * @private\n * @param {MSPointerEvent} inEvent The in event.\n * @return {Object} The copied event.\n */\nMsSource.prototype.prepareEvent_ = function(inEvent) {\n  let e = inEvent;\n  if (typeof inEvent.pointerType === 'number') {\n    e = this.dispatcher.cloneEvent(inEvent, inEvent);\n    e.pointerType = POINTER_TYPES[inEvent.pointerType];\n  }\n\n  return e;\n};\n\n\n/**\n * Remove this pointer from the list of active pointers.\n * @param {number} pointerId Pointer identifier.\n */\nMsSource.prototype.cleanup = function(pointerId) {\n  delete this.pointerMap[pointerId.toString()];\n};\n\n\n/**\n * Handler for `msPointerDown`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerDown = function(inEvent) {\n  this.pointerMap[inEvent.pointerId.toString()] = inEvent;\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.down(e, inEvent);\n};\n\n\n/**\n * Handler for `msPointerMove`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerMove = function(inEvent) {\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.move(e, inEvent);\n};\n\n\n/**\n * Handler for `msPointerUp`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerUp = function(inEvent) {\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.up(e, inEvent);\n  this.cleanup(inEvent.pointerId);\n};\n\n\n/**\n * Handler for `msPointerOut`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerOut = function(inEvent) {\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.leaveOut(e, inEvent);\n};\n\n\n/**\n * Handler for `msPointerOver`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerOver = function(inEvent) {\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.enterOver(e, inEvent);\n};\n\n\n/**\n * Handler for `msPointerCancel`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msPointerCancel = function(inEvent) {\n  const e = this.prepareEvent_(inEvent);\n  this.dispatcher.cancel(e, inEvent);\n  this.cleanup(inEvent.pointerId);\n};\n\n\n/**\n * Handler for `msLostPointerCapture`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msLostPointerCapture = function(inEvent) {\n  const e = this.dispatcher.makeEvent('lostpointercapture', inEvent, inEvent);\n  this.dispatcher.dispatchEvent(e);\n};\n\n\n/**\n * Handler for `msGotPointerCapture`.\n *\n * @param {MSPointerEvent} inEvent The in event.\n */\nMsSource.prototype.msGotPointerCapture = function(inEvent) {\n  const e = this.dispatcher.makeEvent('gotpointercapture', inEvent, inEvent);\n  this.dispatcher.dispatchEvent(e);\n};\nexport default MsSource;\n","/**\n * @module ol/pointer/NativeSource\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../util.js';\nimport EventSource from '../pointer/EventSource.js';\n\n/**\n * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\n * @constructor\n * @extends {module:ol/pointer/EventSource}\n */\nconst NativeSource = function(dispatcher) {\n  const mapping = {\n    'pointerdown': this.pointerDown,\n    'pointermove': this.pointerMove,\n    'pointerup': this.pointerUp,\n    'pointerout': this.pointerOut,\n    'pointerover': this.pointerOver,\n    'pointercancel': this.pointerCancel,\n    'gotpointercapture': this.gotPointerCapture,\n    'lostpointercapture': this.lostPointerCapture\n  };\n  EventSource.call(this, dispatcher, mapping);\n};\n\ninherits(NativeSource, EventSource);\n\n\n/**\n * Handler for `pointerdown`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerDown = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `pointermove`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerMove = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `pointerup`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerUp = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `pointerout`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerOut = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `pointerover`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerOver = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `pointercancel`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.pointerCancel = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `lostpointercapture`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.lostPointerCapture = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\n\n\n/**\n * Handler for `gotpointercapture`.\n *\n * @param {Event} inEvent The in event.\n */\nNativeSource.prototype.gotPointerCapture = function(inEvent) {\n  this.dispatcher.fireNativeEvent(inEvent);\n};\nexport default NativeSource;\n","/**\n * @module ol/pointer/PointerEvent\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../util.js';\nimport Event from '../events/Event.js';\n\n/**\n * A class for pointer events.\n *\n * This class is used as an abstraction for mouse events,\n * touch events and even native pointer events.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {string} type The type of the event to create.\n * @param {Event} originalEvent The event.\n * @param {Object.<string, ?>=} opt_eventDict An optional dictionary of\n *    initial event properties.\n */\nconst PointerEvent = function(type, originalEvent, opt_eventDict) {\n  Event.call(this, type);\n\n  /**\n   * @const\n   * @type {Event}\n   */\n  this.originalEvent = originalEvent;\n\n  const eventDict = opt_eventDict ? opt_eventDict : {};\n\n  /**\n   * @type {number}\n   */\n  this.buttons = this.getButtons_(eventDict);\n\n  /**\n   * @type {number}\n   */\n  this.pressure = this.getPressure_(eventDict, this.buttons);\n\n  // MouseEvent related properties\n\n  /**\n   * @type {boolean}\n   */\n  this.bubbles = 'bubbles' in eventDict ? eventDict['bubbles'] : false;\n\n  /**\n   * @type {boolean}\n   */\n  this.cancelable = 'cancelable' in eventDict ? eventDict['cancelable'] : false;\n\n  /**\n   * @type {Object}\n   */\n  this.view = 'view' in eventDict ? eventDict['view'] : null;\n\n  /**\n   * @type {number}\n   */\n  this.detail = 'detail' in eventDict ? eventDict['detail'] : null;\n\n  /**\n   * @type {number}\n   */\n  this.screenX = 'screenX' in eventDict ? eventDict['screenX'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.screenY = 'screenY' in eventDict ? eventDict['screenY'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.clientX = 'clientX' in eventDict ? eventDict['clientX'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.clientY = 'clientY' in eventDict ? eventDict['clientY'] : 0;\n\n  /**\n   * @type {boolean}\n   */\n  this.ctrlKey = 'ctrlKey' in eventDict ? eventDict['ctrlKey'] : false;\n\n  /**\n   * @type {boolean}\n   */\n  this.altKey = 'altKey' in eventDict ? eventDict['altKey'] : false;\n\n  /**\n   * @type {boolean}\n   */\n  this.shiftKey = 'shiftKey' in eventDict ? eventDict['shiftKey'] : false;\n\n  /**\n   * @type {boolean}\n   */\n  this.metaKey = 'metaKey' in eventDict ? eventDict['metaKey'] : false;\n\n  /**\n   * @type {number}\n   */\n  this.button = 'button' in eventDict ? eventDict['button'] : 0;\n\n  /**\n   * @type {Node}\n   */\n  this.relatedTarget = 'relatedTarget' in eventDict ?\n    eventDict['relatedTarget'] : null;\n\n  // PointerEvent related properties\n\n  /**\n   * @const\n   * @type {number}\n   */\n  this.pointerId = 'pointerId' in eventDict ? eventDict['pointerId'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.width = 'width' in eventDict ? eventDict['width'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.height = 'height' in eventDict ? eventDict['height'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.tiltX = 'tiltX' in eventDict ? eventDict['tiltX'] : 0;\n\n  /**\n   * @type {number}\n   */\n  this.tiltY = 'tiltY' in eventDict ? eventDict['tiltY'] : 0;\n\n  /**\n   * @type {string}\n   */\n  this.pointerType = 'pointerType' in eventDict ? eventDict['pointerType'] : '';\n\n  /**\n   * @type {number}\n   */\n  this.hwTimestamp = 'hwTimestamp' in eventDict ? eventDict['hwTimestamp'] : 0;\n\n  /**\n   * @type {boolean}\n   */\n  this.isPrimary = 'isPrimary' in eventDict ? eventDict['isPrimary'] : false;\n\n  // keep the semantics of preventDefault\n  if (originalEvent.preventDefault) {\n    this.preventDefault = function() {\n      originalEvent.preventDefault();\n    };\n  }\n};\n\ninherits(PointerEvent, Event);\n\n\n/**\n * Is the `buttons` property supported?\n * @type {boolean}\n */\nlet HAS_BUTTONS = false;\n\n\n/**\n * @private\n * @param {Object.<string, ?>} eventDict The event dictionary.\n * @return {number} Button indicator.\n */\nPointerEvent.prototype.getButtons_ = function(eventDict) {\n  // According to the w3c spec,\n  // http://www.w3.org/TR/DOM-Level-3-Events/#events-MouseEvent-button\n  // MouseEvent.button == 0 can mean either no mouse button depressed, or the\n  // left mouse button depressed.\n  //\n  // As of now, the only way to distinguish between the two states of\n  // MouseEvent.button is by using the deprecated MouseEvent.which property, as\n  // this maps mouse buttons to positive integers > 0, and uses 0 to mean that\n  // no mouse button is held.\n  //\n  // MouseEvent.which is derived from MouseEvent.button at MouseEvent creation,\n  // but initMouseEvent does not expose an argument with which to set\n  // MouseEvent.which. Calling initMouseEvent with a buttonArg of 0 will set\n  // MouseEvent.button == 0 and MouseEvent.which == 1, breaking the expectations\n  // of app developers.\n  //\n  // The only way to propagate the correct state of MouseEvent.which and\n  // MouseEvent.button to a new MouseEvent.button == 0 and MouseEvent.which == 0\n  // is to call initMouseEvent with a buttonArg value of -1.\n  //\n  // This is fixed with DOM Level 4's use of buttons\n  let buttons;\n  if (eventDict.buttons || HAS_BUTTONS) {\n    buttons = eventDict.buttons;\n  } else {\n    switch (eventDict.which) {\n      case 1: buttons = 1; break;\n      case 2: buttons = 4; break;\n      case 3: buttons = 2; break;\n      default: buttons = 0;\n    }\n  }\n  return buttons;\n};\n\n\n/**\n * @private\n * @param {Object.<string, ?>} eventDict The event dictionary.\n * @param {number} buttons Button indicator.\n * @return {number} The pressure.\n */\nPointerEvent.prototype.getPressure_ = function(eventDict, buttons) {\n  // Spec requires that pointers without pressure specified use 0.5 for down\n  // state and 0 for up state.\n  let pressure = 0;\n  if (eventDict.pressure) {\n    pressure = eventDict.pressure;\n  } else {\n    pressure = buttons ? 0.5 : 0;\n  }\n  return pressure;\n};\n\n\n/**\n * Checks if the `buttons` property is supported.\n */\n(function() {\n  try {\n    const ev = new MouseEvent('click', {buttons: 1});\n    HAS_BUTTONS = ev.buttons === 1;\n  } catch (e) {\n    // pass\n  }\n})();\nexport default PointerEvent;\n","/**\n * @module ol/pointer/TouchSource\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../util.js';\nimport {remove} from '../array.js';\nimport EventSource from '../pointer/EventSource.js';\nimport {POINTER_ID} from '../pointer/MouseSource.js';\n\n\n/**\n * @constructor\n * @param {module:ol/pointer/PointerEventHandler} dispatcher The event handler.\n * @param {module:ol/pointer/MouseSource} mouseSource Mouse source.\n * @extends {module:ol/pointer/EventSource}\n */\nconst TouchSource = function(dispatcher, mouseSource) {\n  const mapping = {\n    'touchstart': this.touchstart,\n    'touchmove': this.touchmove,\n    'touchend': this.touchend,\n    'touchcancel': this.touchcancel\n  };\n  EventSource.call(this, dispatcher, mapping);\n\n  /**\n   * @const\n   * @type {!Object.<string, Event|Object>}\n   */\n  this.pointerMap = dispatcher.pointerMap;\n\n  /**\n   * @const\n   * @type {module:ol/pointer/MouseSource}\n   */\n  this.mouseSource = mouseSource;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.firstTouchId_ = undefined;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.clickCount_ = 0;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.resetId_ = undefined;\n\n  /**\n   * Mouse event timeout: This should be long enough to\n   * ignore compat mouse events made by touch.\n   * @private\n   * @type {number}\n   */\n  this.dedupTimeout_ = 2500;\n};\n\ninherits(TouchSource, EventSource);\n\n\n/**\n * @type {number}\n */\nconst CLICK_COUNT_TIMEOUT = 200;\n\n\n/**\n * @type {string}\n */\nconst POINTER_TYPE = 'touch';\n\n/**\n * @private\n * @param {Touch} inTouch The in touch.\n * @return {boolean} True, if this is the primary touch.\n */\nTouchSource.prototype.isPrimaryTouch_ = function(inTouch) {\n  return this.firstTouchId_ === inTouch.identifier;\n};\n\n\n/**\n * Set primary touch if there are no pointers, or the only pointer is the mouse.\n * @param {Touch} inTouch The in touch.\n * @private\n */\nTouchSource.prototype.setPrimaryTouch_ = function(inTouch) {\n  const count = Object.keys(this.pointerMap).length;\n  if (count === 0 || (count === 1 && POINTER_ID.toString() in this.pointerMap)) {\n    this.firstTouchId_ = inTouch.identifier;\n    this.cancelResetClickCount_();\n  }\n};\n\n\n/**\n * @private\n * @param {Object} inPointer The in pointer object.\n */\nTouchSource.prototype.removePrimaryPointer_ = function(inPointer) {\n  if (inPointer.isPrimary) {\n    this.firstTouchId_ = undefined;\n    this.resetClickCount_();\n  }\n};\n\n\n/**\n * @private\n */\nTouchSource.prototype.resetClickCount_ = function() {\n  this.resetId_ = setTimeout(\n    this.resetClickCountHandler_.bind(this),\n    CLICK_COUNT_TIMEOUT);\n};\n\n\n/**\n * @private\n */\nTouchSource.prototype.resetClickCountHandler_ = function() {\n  this.clickCount_ = 0;\n  this.resetId_ = undefined;\n};\n\n\n/**\n * @private\n */\nTouchSource.prototype.cancelResetClickCount_ = function() {\n  if (this.resetId_ !== undefined) {\n    clearTimeout(this.resetId_);\n  }\n};\n\n\n/**\n * @private\n * @param {Event} browserEvent Browser event\n * @param {Touch} inTouch Touch event\n * @return {Object} A pointer object.\n */\nTouchSource.prototype.touchToPointer_ = function(browserEvent, inTouch) {\n  const e = this.dispatcher.cloneEvent(browserEvent, inTouch);\n  // Spec specifies that pointerId 1 is reserved for Mouse.\n  // Touch identifiers can start at 0.\n  // Add 2 to the touch identifier for compatibility.\n  e.pointerId = inTouch.identifier + 2;\n  // TODO: check if this is necessary?\n  //e.target = findTarget(e);\n  e.bubbles = true;\n  e.cancelable = true;\n  e.detail = this.clickCount_;\n  e.button = 0;\n  e.buttons = 1;\n  e.width = inTouch.webkitRadiusX || inTouch.radiusX || 0;\n  e.height = inTouch.webkitRadiusY || inTouch.radiusY || 0;\n  e.pressure = inTouch.webkitForce || inTouch.force || 0.5;\n  e.isPrimary = this.isPrimaryTouch_(inTouch);\n  e.pointerType = POINTER_TYPE;\n\n  // make sure that the properties that are different for\n  // each `Touch` object are not copied from the BrowserEvent object\n  e.clientX = inTouch.clientX;\n  e.clientY = inTouch.clientY;\n  e.screenX = inTouch.screenX;\n  e.screenY = inTouch.screenY;\n\n  return e;\n};\n\n\n/**\n * @private\n * @param {Event} inEvent Touch event\n * @param {function(Event, Object)} inFunction In function.\n */\nTouchSource.prototype.processTouches_ = function(inEvent, inFunction) {\n  const touches = Array.prototype.slice.call(inEvent.changedTouches);\n  const count = touches.length;\n  function preventDefault() {\n    inEvent.preventDefault();\n  }\n  for (let i = 0; i < count; ++i) {\n    const pointer = this.touchToPointer_(inEvent, touches[i]);\n    // forward touch preventDefaults\n    pointer.preventDefault = preventDefault;\n    inFunction.call(this, inEvent, pointer);\n  }\n};\n\n\n/**\n * @private\n * @param {TouchList} touchList The touch list.\n * @param {number} searchId Search identifier.\n * @return {boolean} True, if the `Touch` with the given id is in the list.\n */\nTouchSource.prototype.findTouch_ = function(touchList, searchId) {\n  const l = touchList.length;\n  for (let i = 0; i < l; i++) {\n    const touch = touchList[i];\n    if (touch.identifier === searchId) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * In some instances, a touchstart can happen without a touchend. This\n * leaves the pointermap in a broken state.\n * Therefore, on every touchstart, we remove the touches that did not fire a\n * touchend event.\n * To keep state globally consistent, we fire a pointercancel for\n * this \"abandoned\" touch\n *\n * @private\n * @param {Event} inEvent The in event.\n */\nTouchSource.prototype.vacuumTouches_ = function(inEvent) {\n  const touchList = inEvent.touches;\n  // pointerMap.getCount() should be < touchList.length here,\n  // as the touchstart has not been processed yet.\n  const keys = Object.keys(this.pointerMap);\n  const count = keys.length;\n  if (count >= touchList.length) {\n    const d = [];\n    for (let i = 0; i < count; ++i) {\n      const key = keys[i];\n      const value = this.pointerMap[key];\n      // Never remove pointerId == 1, which is mouse.\n      // Touch identifiers are 2 smaller than their pointerId, which is the\n      // index in pointermap.\n      if (key != POINTER_ID && !this.findTouch_(touchList, key - 2)) {\n        d.push(value.out);\n      }\n    }\n    for (let i = 0; i < d.length; ++i) {\n      this.cancelOut_(inEvent, d[i]);\n    }\n  }\n};\n\n\n/**\n * Handler for `touchstart`, triggers `pointerover`,\n * `pointerenter` and `pointerdown` events.\n *\n * @param {Event} inEvent The in event.\n */\nTouchSource.prototype.touchstart = function(inEvent) {\n  this.vacuumTouches_(inEvent);\n  this.setPrimaryTouch_(inEvent.changedTouches[0]);\n  this.dedupSynthMouse_(inEvent);\n  this.clickCount_++;\n  this.processTouches_(inEvent, this.overDown_);\n};\n\n\n/**\n * @private\n * @param {Event} browserEvent The event.\n * @param {Object} inPointer The in pointer object.\n */\nTouchSource.prototype.overDown_ = function(browserEvent, inPointer) {\n  this.pointerMap[inPointer.pointerId] = {\n    target: inPointer.target,\n    out: inPointer,\n    outTarget: inPointer.target\n  };\n  this.dispatcher.over(inPointer, browserEvent);\n  this.dispatcher.enter(inPointer, browserEvent);\n  this.dispatcher.down(inPointer, browserEvent);\n};\n\n\n/**\n * Handler for `touchmove`.\n *\n * @param {Event} inEvent The in event.\n */\nTouchSource.prototype.touchmove = function(inEvent) {\n  inEvent.preventDefault();\n  this.processTouches_(inEvent, this.moveOverOut_);\n};\n\n\n/**\n * @private\n * @param {Event} browserEvent The event.\n * @param {Object} inPointer The in pointer.\n */\nTouchSource.prototype.moveOverOut_ = function(browserEvent, inPointer) {\n  const event = inPointer;\n  const pointer = this.pointerMap[event.pointerId];\n  // a finger drifted off the screen, ignore it\n  if (!pointer) {\n    return;\n  }\n  const outEvent = pointer.out;\n  const outTarget = pointer.outTarget;\n  this.dispatcher.move(event, browserEvent);\n  if (outEvent && outTarget !== event.target) {\n    outEvent.relatedTarget = event.target;\n    event.relatedTarget = outTarget;\n    // recover from retargeting by shadow\n    outEvent.target = outTarget;\n    if (event.target) {\n      this.dispatcher.leaveOut(outEvent, browserEvent);\n      this.dispatcher.enterOver(event, browserEvent);\n    } else {\n      // clean up case when finger leaves the screen\n      event.target = outTarget;\n      event.relatedTarget = null;\n      this.cancelOut_(browserEvent, event);\n    }\n  }\n  pointer.out = event;\n  pointer.outTarget = event.target;\n};\n\n\n/**\n * Handler for `touchend`, triggers `pointerup`,\n * `pointerout` and `pointerleave` events.\n *\n * @param {Event} inEvent The event.\n */\nTouchSource.prototype.touchend = function(inEvent) {\n  this.dedupSynthMouse_(inEvent);\n  this.processTouches_(inEvent, this.upOut_);\n};\n\n\n/**\n * @private\n * @param {Event} browserEvent An event.\n * @param {Object} inPointer The inPointer object.\n */\nTouchSource.prototype.upOut_ = function(browserEvent, inPointer) {\n  this.dispatcher.up(inPointer, browserEvent);\n  this.dispatcher.out(inPointer, browserEvent);\n  this.dispatcher.leave(inPointer, browserEvent);\n  this.cleanUpPointer_(inPointer);\n};\n\n\n/**\n * Handler for `touchcancel`, triggers `pointercancel`,\n * `pointerout` and `pointerleave` events.\n *\n * @param {Event} inEvent The in event.\n */\nTouchSource.prototype.touchcancel = function(inEvent) {\n  this.processTouches_(inEvent, this.cancelOut_);\n};\n\n\n/**\n * @private\n * @param {Event} browserEvent The event.\n * @param {Object} inPointer The in pointer.\n */\nTouchSource.prototype.cancelOut_ = function(browserEvent, inPointer) {\n  this.dispatcher.cancel(inPointer, browserEvent);\n  this.dispatcher.out(inPointer, browserEvent);\n  this.dispatcher.leave(inPointer, browserEvent);\n  this.cleanUpPointer_(inPointer);\n};\n\n\n/**\n * @private\n * @param {Object} inPointer The inPointer object.\n */\nTouchSource.prototype.cleanUpPointer_ = function(inPointer) {\n  delete this.pointerMap[inPointer.pointerId];\n  this.removePrimaryPointer_(inPointer);\n};\n\n\n/**\n * Prevent synth mouse events from creating pointer events.\n *\n * @private\n * @param {Event} inEvent The in event.\n */\nTouchSource.prototype.dedupSynthMouse_ = function(inEvent) {\n  const lts = this.mouseSource.lastTouches;\n  const t = inEvent.changedTouches[0];\n  // only the primary finger will synth mouse events\n  if (this.isPrimaryTouch_(t)) {\n    // remember x/y of last touch\n    const lt = [t.clientX, t.clientY];\n    lts.push(lt);\n\n    setTimeout(function() {\n      // remove touch after timeout\n      remove(lts, lt);\n    }, this.dedupTimeout_);\n  }\n};\nexport default TouchSource;\n","/**\n * @module ol/pointer/PointerEventHandler\n */\n// Based on https://github.com/Polymer/PointerEvents\n\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n// * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n// * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n// * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nimport {inherits} from '../util.js';\nimport {listen, unlisten} from '../events.js';\nimport EventTarget from '../events/EventTarget.js';\nimport {POINTER, MSPOINTER, TOUCH} from '../has.js';\nimport PointerEventType from '../pointer/EventType.js';\nimport MouseSource from '../pointer/MouseSource.js';\nimport MsSource from '../pointer/MsSource.js';\nimport NativeSource from '../pointer/NativeSource.js';\nimport PointerEvent from '../pointer/PointerEvent.js';\nimport TouchSource from '../pointer/TouchSource.js';\n\n/**\n * @constructor\n * @extends {module:ol/events/EventTarget}\n * @param {Element|HTMLDocument} element Viewport element.\n */\nconst PointerEventHandler = function(element) {\n  EventTarget.call(this);\n\n  /**\n   * @const\n   * @private\n   * @type {Element|HTMLDocument}\n   */\n  this.element_ = element;\n\n  /**\n   * @const\n   * @type {!Object.<string, Event|Object>}\n   */\n  this.pointerMap = {};\n\n  /**\n   * @type {Object.<string, function(Event)>}\n   * @private\n   */\n  this.eventMap_ = {};\n\n  /**\n   * @type {Array.<module:ol/pointer/EventSource>}\n   * @private\n   */\n  this.eventSourceList_ = [];\n\n  this.registerSources();\n};\n\ninherits(PointerEventHandler, EventTarget);\n\n/**\n * Properties to copy when cloning an event, with default values.\n * @type {Array.<Array>}\n */\nconst CLONE_PROPS = [\n  // MouseEvent\n  ['bubbles', false],\n  ['cancelable', false],\n  ['view', null],\n  ['detail', null],\n  ['screenX', 0],\n  ['screenY', 0],\n  ['clientX', 0],\n  ['clientY', 0],\n  ['ctrlKey', false],\n  ['altKey', false],\n  ['shiftKey', false],\n  ['metaKey', false],\n  ['button', 0],\n  ['relatedTarget', null],\n  // DOM Level 3\n  ['buttons', 0],\n  // PointerEvent\n  ['pointerId', 0],\n  ['width', 0],\n  ['height', 0],\n  ['pressure', 0],\n  ['tiltX', 0],\n  ['tiltY', 0],\n  ['pointerType', ''],\n  ['hwTimestamp', 0],\n  ['isPrimary', false],\n  // event instance\n  ['type', ''],\n  ['target', null],\n  ['currentTarget', null],\n  ['which', 0]\n];\n\n\n/**\n * Set up the event sources (mouse, touch and native pointers)\n * that generate pointer events.\n */\nPointerEventHandler.prototype.registerSources = function() {\n  if (POINTER) {\n    this.registerSource('native', new NativeSource(this));\n  } else if (MSPOINTER) {\n    this.registerSource('ms', new MsSource(this));\n  } else {\n    const mouseSource = new MouseSource(this);\n    this.registerSource('mouse', mouseSource);\n\n    if (TOUCH) {\n      this.registerSource('touch', new TouchSource(this, mouseSource));\n    }\n  }\n\n  // register events on the viewport element\n  this.register_();\n};\n\n\n/**\n * Add a new event source that will generate pointer events.\n *\n * @param {string} name A name for the event source\n * @param {module:ol/pointer/EventSource} source The source event.\n */\nPointerEventHandler.prototype.registerSource = function(name, source) {\n  const s = source;\n  const newEvents = s.getEvents();\n\n  if (newEvents) {\n    newEvents.forEach(function(e) {\n      const handler = s.getHandlerForEvent(e);\n\n      if (handler) {\n        this.eventMap_[e] = handler.bind(s);\n      }\n    }.bind(this));\n    this.eventSourceList_.push(s);\n  }\n};\n\n\n/**\n * Set up the events for all registered event sources.\n * @private\n */\nPointerEventHandler.prototype.register_ = function() {\n  const l = this.eventSourceList_.length;\n  for (let i = 0; i < l; i++) {\n    const eventSource = this.eventSourceList_[i];\n    this.addEvents_(eventSource.getEvents());\n  }\n};\n\n\n/**\n * Remove all registered events.\n * @private\n */\nPointerEventHandler.prototype.unregister_ = function() {\n  const l = this.eventSourceList_.length;\n  for (let i = 0; i < l; i++) {\n    const eventSource = this.eventSourceList_[i];\n    this.removeEvents_(eventSource.getEvents());\n  }\n};\n\n\n/**\n * Calls the right handler for a new event.\n * @private\n * @param {Event} inEvent Browser event.\n */\nPointerEventHandler.prototype.eventHandler_ = function(inEvent) {\n  const type = inEvent.type;\n  const handler = this.eventMap_[type];\n  if (handler) {\n    handler(inEvent);\n  }\n};\n\n\n/**\n * Setup listeners for the given events.\n * @private\n * @param {Array.<string>} events List of events.\n */\nPointerEventHandler.prototype.addEvents_ = function(events) {\n  events.forEach(function(eventName) {\n    listen(this.element_, eventName, this.eventHandler_, this);\n  }.bind(this));\n};\n\n\n/**\n * Unregister listeners for the given events.\n * @private\n * @param {Array.<string>} events List of events.\n */\nPointerEventHandler.prototype.removeEvents_ = function(events) {\n  events.forEach(function(e) {\n    unlisten(this.element_, e, this.eventHandler_, this);\n  }.bind(this));\n};\n\n\n/**\n * Returns a snapshot of inEvent, with writable properties.\n *\n * @param {Event} event Browser event.\n * @param {Event|Touch} inEvent An event that contains\n *    properties to copy.\n * @return {Object} An object containing shallow copies of\n *    `inEvent`'s properties.\n */\nPointerEventHandler.prototype.cloneEvent = function(event, inEvent) {\n  const eventCopy = {};\n  for (let i = 0, ii = CLONE_PROPS.length; i < ii; i++) {\n    const p = CLONE_PROPS[i][0];\n    eventCopy[p] = event[p] || inEvent[p] || CLONE_PROPS[i][1];\n  }\n\n  return eventCopy;\n};\n\n\n// EVENTS\n\n\n/**\n * Triggers a 'pointerdown' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.down = function(data, event) {\n  this.fireEvent(PointerEventType.POINTERDOWN, data, event);\n};\n\n\n/**\n * Triggers a 'pointermove' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.move = function(data, event) {\n  this.fireEvent(PointerEventType.POINTERMOVE, data, event);\n};\n\n\n/**\n * Triggers a 'pointerup' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.up = function(data, event) {\n  this.fireEvent(PointerEventType.POINTERUP, data, event);\n};\n\n\n/**\n * Triggers a 'pointerenter' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.enter = function(data, event) {\n  data.bubbles = false;\n  this.fireEvent(PointerEventType.POINTERENTER, data, event);\n};\n\n\n/**\n * Triggers a 'pointerleave' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.leave = function(data, event) {\n  data.bubbles = false;\n  this.fireEvent(PointerEventType.POINTERLEAVE, data, event);\n};\n\n\n/**\n * Triggers a 'pointerover' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.over = function(data, event) {\n  data.bubbles = true;\n  this.fireEvent(PointerEventType.POINTEROVER, data, event);\n};\n\n\n/**\n * Triggers a 'pointerout' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.out = function(data, event) {\n  data.bubbles = true;\n  this.fireEvent(PointerEventType.POINTEROUT, data, event);\n};\n\n\n/**\n * Triggers a 'pointercancel' event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.cancel = function(data, event) {\n  this.fireEvent(PointerEventType.POINTERCANCEL, data, event);\n};\n\n\n/**\n * Triggers a combination of 'pointerout' and 'pointerleave' events.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.leaveOut = function(data, event) {\n  this.out(data, event);\n  if (!this.contains_(data.target, data.relatedTarget)) {\n    this.leave(data, event);\n  }\n};\n\n\n/**\n * Triggers a combination of 'pointerover' and 'pointerevents' events.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.enterOver = function(data, event) {\n  this.over(data, event);\n  if (!this.contains_(data.target, data.relatedTarget)) {\n    this.enter(data, event);\n  }\n};\n\n\n/**\n * @private\n * @param {Element} container The container element.\n * @param {Element} contained The contained element.\n * @return {boolean} Returns true if the container element\n *   contains the other element.\n */\nPointerEventHandler.prototype.contains_ = function(container, contained) {\n  if (!container || !contained) {\n    return false;\n  }\n  return container.contains(contained);\n};\n\n\n// EVENT CREATION AND TRACKING\n/**\n * Creates a new Event of type `inType`, based on the information in\n * `data`.\n *\n * @param {string} inType A string representing the type of event to create.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n * @return {module:ol/pointer/PointerEvent} A PointerEvent of type `inType`.\n */\nPointerEventHandler.prototype.makeEvent = function(inType, data, event) {\n  return new PointerEvent(inType, event, data);\n};\n\n\n/**\n * Make and dispatch an event in one call.\n * @param {string} inType A string representing the type of event.\n * @param {Object} data Pointer event data.\n * @param {Event} event The event.\n */\nPointerEventHandler.prototype.fireEvent = function(inType, data, event) {\n  const e = this.makeEvent(inType, data, event);\n  this.dispatchEvent(e);\n};\n\n\n/**\n * Creates a pointer event from a native pointer event\n * and dispatches this event.\n * @param {Event} event A platform event with a target.\n */\nPointerEventHandler.prototype.fireNativeEvent = function(event) {\n  const e = this.makeEvent(event.type, event, event);\n  this.dispatchEvent(e);\n};\n\n\n/**\n * Wrap a native mouse event into a pointer event.\n * This proxy method is required for the legacy IE support.\n * @param {string} eventType The pointer event type.\n * @param {Event} event The event.\n * @return {module:ol/pointer/PointerEvent} The wrapped event.\n */\nPointerEventHandler.prototype.wrapMouseEvent = function(eventType, event) {\n  const pointerEvent = this.makeEvent(\n    eventType, MouseSource.prepareEvent(event, this), event);\n  return pointerEvent;\n};\n\n\n/**\n * @inheritDoc\n */\nPointerEventHandler.prototype.disposeInternal = function() {\n  this.unregister_();\n  EventTarget.prototype.disposeInternal.call(this);\n};\n\n\nexport default PointerEventHandler;\n","/**\n * @module ol/MapBrowserEventHandler\n */\nimport {inherits} from './util.js';\nimport {DEVICE_PIXEL_RATIO} from './has.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapBrowserPointerEvent from './MapBrowserPointerEvent.js';\nimport {listen, unlistenByKey} from './events.js';\nimport EventTarget from './events/EventTarget.js';\nimport PointerEventType from './pointer/EventType.js';\nimport PointerEventHandler from './pointer/PointerEventHandler.js';\n\n/**\n * @param {module:ol/PluggableMap} map The map with the viewport to\n * listen to events on.\n * @param {number=} moveTolerance The minimal distance the pointer must travel\n * to trigger a move.\n * @constructor\n * @extends {module:ol/events/EventTarget}\n */\nconst MapBrowserEventHandler = function(map, moveTolerance) {\n\n  EventTarget.call(this);\n\n  /**\n   * This is the element that we will listen to the real events on.\n   * @type {module:ol/PluggableMap}\n   * @private\n   */\n  this.map_ = map;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.clickTimeoutId_ = 0;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.dragging_ = false;\n\n  /**\n   * @type {!Array.<module:ol/events~EventsKey>}\n   * @private\n   */\n  this.dragListenerKeys_ = [];\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.moveTolerance_ = moveTolerance ?\n    moveTolerance * DEVICE_PIXEL_RATIO : DEVICE_PIXEL_RATIO;\n\n  /**\n   * The most recent \"down\" type event (or null if none have occurred).\n   * Set on pointerdown.\n   * @type {module:ol/pointer/PointerEvent}\n   * @private\n   */\n  this.down_ = null;\n\n  const element = this.map_.getViewport();\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.activePointers_ = 0;\n\n  /**\n   * @type {!Object.<number, boolean>}\n   * @private\n   */\n  this.trackedTouches_ = {};\n\n  /**\n   * Event handler which generates pointer events for\n   * the viewport element.\n   *\n   * @type {module:ol/pointer/PointerEventHandler}\n   * @private\n   */\n  this.pointerEventHandler_ = new PointerEventHandler(element);\n\n  /**\n   * Event handler which generates pointer events for\n   * the document (used when dragging).\n   *\n   * @type {module:ol/pointer/PointerEventHandler}\n   * @private\n   */\n  this.documentPointerEventHandler_ = null;\n\n  /**\n   * @type {?module:ol/events~EventsKey}\n   * @private\n   */\n  this.pointerdownListenerKey_ = listen(this.pointerEventHandler_,\n    PointerEventType.POINTERDOWN,\n    this.handlePointerDown_, this);\n\n  /**\n   * @type {?module:ol/events~EventsKey}\n   * @private\n   */\n  this.relayedListenerKey_ = listen(this.pointerEventHandler_,\n    PointerEventType.POINTERMOVE,\n    this.relayEvent_, this);\n\n};\n\ninherits(MapBrowserEventHandler, EventTarget);\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.emulateClick_ = function(pointerEvent) {\n  let newEvent = new MapBrowserPointerEvent(\n    MapBrowserEventType.CLICK, this.map_, pointerEvent);\n  this.dispatchEvent(newEvent);\n  if (this.clickTimeoutId_ !== 0) {\n    // double-click\n    clearTimeout(this.clickTimeoutId_);\n    this.clickTimeoutId_ = 0;\n    newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.DBLCLICK, this.map_, pointerEvent);\n    this.dispatchEvent(newEvent);\n  } else {\n    // click\n    this.clickTimeoutId_ = setTimeout(function() {\n      this.clickTimeoutId_ = 0;\n      const newEvent = new MapBrowserPointerEvent(\n        MapBrowserEventType.SINGLECLICK, this.map_, pointerEvent);\n      this.dispatchEvent(newEvent);\n    }.bind(this), 250);\n  }\n};\n\n\n/**\n * Keeps track on how many pointers are currently active.\n *\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.updateActivePointers_ = function(pointerEvent) {\n  const event = pointerEvent;\n\n  if (event.type == MapBrowserEventType.POINTERUP ||\n      event.type == MapBrowserEventType.POINTERCANCEL) {\n    delete this.trackedTouches_[event.pointerId];\n  } else if (event.type == MapBrowserEventType.POINTERDOWN) {\n    this.trackedTouches_[event.pointerId] = true;\n  }\n  this.activePointers_ = Object.keys(this.trackedTouches_).length;\n};\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.handlePointerUp_ = function(pointerEvent) {\n  this.updateActivePointers_(pointerEvent);\n  const newEvent = new MapBrowserPointerEvent(\n    MapBrowserEventType.POINTERUP, this.map_, pointerEvent);\n  this.dispatchEvent(newEvent);\n\n  // We emulate click events on left mouse button click, touch contact, and pen\n  // contact. isMouseActionButton returns true in these cases (evt.button is set\n  // to 0).\n  // See http://www.w3.org/TR/pointerevents/#button-states\n  // We only fire click, singleclick, and doubleclick if nobody has called\n  // event.stopPropagation() or event.preventDefault().\n  if (!newEvent.propagationStopped && !this.dragging_ && this.isMouseActionButton_(pointerEvent)) {\n    this.emulateClick_(this.down_);\n  }\n\n  if (this.activePointers_ === 0) {\n    this.dragListenerKeys_.forEach(unlistenByKey);\n    this.dragListenerKeys_.length = 0;\n    this.dragging_ = false;\n    this.down_ = null;\n    this.documentPointerEventHandler_.dispose();\n    this.documentPointerEventHandler_ = null;\n  }\n};\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @return {boolean} If the left mouse button was pressed.\n * @private\n */\nMapBrowserEventHandler.prototype.isMouseActionButton_ = function(pointerEvent) {\n  return pointerEvent.button === 0;\n};\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.handlePointerDown_ = function(pointerEvent) {\n  this.updateActivePointers_(pointerEvent);\n  const newEvent = new MapBrowserPointerEvent(\n    MapBrowserEventType.POINTERDOWN, this.map_, pointerEvent);\n  this.dispatchEvent(newEvent);\n\n  this.down_ = pointerEvent;\n\n  if (this.dragListenerKeys_.length === 0) {\n    /* Set up a pointer event handler on the `document`,\n     * which is required when the pointer is moved outside\n     * the viewport when dragging.\n     */\n    this.documentPointerEventHandler_ =\n        new PointerEventHandler(document);\n\n    this.dragListenerKeys_.push(\n      listen(this.documentPointerEventHandler_,\n        MapBrowserEventType.POINTERMOVE,\n        this.handlePointerMove_, this),\n      listen(this.documentPointerEventHandler_,\n        MapBrowserEventType.POINTERUP,\n        this.handlePointerUp_, this),\n      /* Note that the listener for `pointercancel is set up on\n       * `pointerEventHandler_` and not `documentPointerEventHandler_` like\n       * the `pointerup` and `pointermove` listeners.\n       *\n       * The reason for this is the following: `TouchSource.vacuumTouches_()`\n       * issues `pointercancel` events, when there was no `touchend` for a\n       * `touchstart`. Now, let's say a first `touchstart` is registered on\n       * `pointerEventHandler_`. The `documentPointerEventHandler_` is set up.\n       * But `documentPointerEventHandler_` doesn't know about the first\n       * `touchstart`. If there is no `touchend` for the `touchstart`, we can\n       * only receive a `touchcancel` from `pointerEventHandler_`, because it is\n       * only registered there.\n       */\n      listen(this.pointerEventHandler_,\n        MapBrowserEventType.POINTERCANCEL,\n        this.handlePointerUp_, this)\n    );\n  }\n};\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.handlePointerMove_ = function(pointerEvent) {\n  // Between pointerdown and pointerup, pointermove events are triggered.\n  // To avoid a 'false' touchmove event to be dispatched, we test if the pointer\n  // moved a significant distance.\n  if (this.isMoving_(pointerEvent)) {\n    this.dragging_ = true;\n    const newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.POINTERDRAG, this.map_, pointerEvent,\n      this.dragging_);\n    this.dispatchEvent(newEvent);\n  }\n\n  // Some native android browser triggers mousemove events during small period\n  // of time. See: https://code.google.com/p/android/issues/detail?id=5491 or\n  // https://code.google.com/p/android/issues/detail?id=19827\n  // ex: Galaxy Tab P3110 + Android 4.1.1\n  pointerEvent.preventDefault();\n};\n\n\n/**\n * Wrap and relay a pointer event.  Note that this requires that the type\n * string for the MapBrowserPointerEvent matches the PointerEvent type.\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @private\n */\nMapBrowserEventHandler.prototype.relayEvent_ = function(pointerEvent) {\n  const dragging = !!(this.down_ && this.isMoving_(pointerEvent));\n  this.dispatchEvent(new MapBrowserPointerEvent(\n    pointerEvent.type, this.map_, pointerEvent, dragging));\n};\n\n\n/**\n * @param {module:ol/pointer/PointerEvent} pointerEvent Pointer\n * event.\n * @return {boolean} Is moving.\n * @private\n */\nMapBrowserEventHandler.prototype.isMoving_ = function(pointerEvent) {\n  return this.dragging_ ||\n      Math.abs(pointerEvent.clientX - this.down_.clientX) > this.moveTolerance_ ||\n      Math.abs(pointerEvent.clientY - this.down_.clientY) > this.moveTolerance_;\n};\n\n\n/**\n * @inheritDoc\n */\nMapBrowserEventHandler.prototype.disposeInternal = function() {\n  if (this.relayedListenerKey_) {\n    unlistenByKey(this.relayedListenerKey_);\n    this.relayedListenerKey_ = null;\n  }\n  if (this.pointerdownListenerKey_) {\n    unlistenByKey(this.pointerdownListenerKey_);\n    this.pointerdownListenerKey_ = null;\n  }\n\n  this.dragListenerKeys_.forEach(unlistenByKey);\n  this.dragListenerKeys_.length = 0;\n\n  if (this.documentPointerEventHandler_) {\n    this.documentPointerEventHandler_.dispose();\n    this.documentPointerEventHandler_ = null;\n  }\n  if (this.pointerEventHandler_) {\n    this.pointerEventHandler_.dispose();\n    this.pointerEventHandler_ = null;\n  }\n  EventTarget.prototype.disposeInternal.call(this);\n};\nexport default MapBrowserEventHandler;\n","/**\n * @module ol/MapEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n\n  /**\n   * Triggered after a map frame is rendered.\n   * @event module:ol/MapEvent~MapEvent#postrender\n   * @api\n   */\n  POSTRENDER: 'postrender',\n\n  /**\n   * Triggered when the map starts moving.\n   * @event module:ol/MapEvent~MapEvent#movestart\n   * @api\n   */\n  MOVESTART: 'movestart',\n\n  /**\n   * Triggered after the map is moved.\n   * @event module:ol/MapEvent~MapEvent#moveend\n   * @api\n   */\n  MOVEEND: 'moveend'\n\n};\n","/**\n * @module ol/MapProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  LAYERGROUP: 'layergroup',\n  SIZE: 'size',\n  TARGET: 'target',\n  VIEW: 'view'\n};\n","/**\n * @module ol/structs/PriorityQueue\n */\nimport {assert} from '../asserts.js';\nimport {clear} from '../obj.js';\n\n/**\n * Priority queue.\n *\n * The implementation is inspired from the Closure Library's Heap class and\n * Python's heapq module.\n *\n * @see http://closure-library.googlecode.com/svn/docs/closure_goog_structs_heap.js.source.html\n * @see http://hg.python.org/cpython/file/2.7/Lib/heapq.py\n *\n * @constructor\n * @param {function(T): number} priorityFunction Priority function.\n * @param {function(T): string} keyFunction Key function.\n * @struct\n * @template T\n */\nconst PriorityQueue = function(priorityFunction, keyFunction) {\n\n  /**\n   * @type {function(T): number}\n   * @private\n   */\n  this.priorityFunction_ = priorityFunction;\n\n  /**\n   * @type {function(T): string}\n   * @private\n   */\n  this.keyFunction_ = keyFunction;\n\n  /**\n   * @type {Array.<T>}\n   * @private\n   */\n  this.elements_ = [];\n\n  /**\n   * @type {Array.<number>}\n   * @private\n   */\n  this.priorities_ = [];\n\n  /**\n   * @type {!Object.<string, boolean>}\n   * @private\n   */\n  this.queuedElements_ = {};\n\n};\n\n\n/**\n * @type {number}\n */\nexport const DROP = Infinity;\n\n\n/**\n * FIXME empty description for jsdoc\n */\nPriorityQueue.prototype.clear = function() {\n  this.elements_.length = 0;\n  this.priorities_.length = 0;\n  clear(this.queuedElements_);\n};\n\n\n/**\n * Remove and return the highest-priority element. O(log N).\n * @return {T} Element.\n */\nPriorityQueue.prototype.dequeue = function() {\n  const elements = this.elements_;\n  const priorities = this.priorities_;\n  const element = elements[0];\n  if (elements.length == 1) {\n    elements.length = 0;\n    priorities.length = 0;\n  } else {\n    elements[0] = elements.pop();\n    priorities[0] = priorities.pop();\n    this.siftUp_(0);\n  }\n  const elementKey = this.keyFunction_(element);\n  delete this.queuedElements_[elementKey];\n  return element;\n};\n\n\n/**\n * Enqueue an element. O(log N).\n * @param {T} element Element.\n * @return {boolean} The element was added to the queue.\n */\nPriorityQueue.prototype.enqueue = function(element) {\n  assert(!(this.keyFunction_(element) in this.queuedElements_),\n    31); // Tried to enqueue an `element` that was already added to the queue\n  const priority = this.priorityFunction_(element);\n  if (priority != DROP) {\n    this.elements_.push(element);\n    this.priorities_.push(priority);\n    this.queuedElements_[this.keyFunction_(element)] = true;\n    this.siftDown_(0, this.elements_.length - 1);\n    return true;\n  }\n  return false;\n};\n\n\n/**\n * @return {number} Count.\n */\nPriorityQueue.prototype.getCount = function() {\n  return this.elements_.length;\n};\n\n\n/**\n * Gets the index of the left child of the node at the given index.\n * @param {number} index The index of the node to get the left child for.\n * @return {number} The index of the left child.\n * @private\n */\nPriorityQueue.prototype.getLeftChildIndex_ = function(index) {\n  return index * 2 + 1;\n};\n\n\n/**\n * Gets the index of the right child of the node at the given index.\n * @param {number} index The index of the node to get the right child for.\n * @return {number} The index of the right child.\n * @private\n */\nPriorityQueue.prototype.getRightChildIndex_ = function(index) {\n  return index * 2 + 2;\n};\n\n\n/**\n * Gets the index of the parent of the node at the given index.\n * @param {number} index The index of the node to get the parent for.\n * @return {number} The index of the parent.\n * @private\n */\nPriorityQueue.prototype.getParentIndex_ = function(index) {\n  return (index - 1) >> 1;\n};\n\n\n/**\n * Make this a heap. O(N).\n * @private\n */\nPriorityQueue.prototype.heapify_ = function() {\n  let i;\n  for (i = (this.elements_.length >> 1) - 1; i >= 0; i--) {\n    this.siftUp_(i);\n  }\n};\n\n\n/**\n * @return {boolean} Is empty.\n */\nPriorityQueue.prototype.isEmpty = function() {\n  return this.elements_.length === 0;\n};\n\n\n/**\n * @param {string} key Key.\n * @return {boolean} Is key queued.\n */\nPriorityQueue.prototype.isKeyQueued = function(key) {\n  return key in this.queuedElements_;\n};\n\n\n/**\n * @param {T} element Element.\n * @return {boolean} Is queued.\n */\nPriorityQueue.prototype.isQueued = function(element) {\n  return this.isKeyQueued(this.keyFunction_(element));\n};\n\n\n/**\n * @param {number} index The index of the node to move down.\n * @private\n */\nPriorityQueue.prototype.siftUp_ = function(index) {\n  const elements = this.elements_;\n  const priorities = this.priorities_;\n  const count = elements.length;\n  const element = elements[index];\n  const priority = priorities[index];\n  const startIndex = index;\n\n  while (index < (count >> 1)) {\n    const lIndex = this.getLeftChildIndex_(index);\n    const rIndex = this.getRightChildIndex_(index);\n\n    const smallerChildIndex = rIndex < count &&\n        priorities[rIndex] < priorities[lIndex] ?\n      rIndex : lIndex;\n\n    elements[index] = elements[smallerChildIndex];\n    priorities[index] = priorities[smallerChildIndex];\n    index = smallerChildIndex;\n  }\n\n  elements[index] = element;\n  priorities[index] = priority;\n  this.siftDown_(startIndex, index);\n};\n\n\n/**\n * @param {number} startIndex The index of the root.\n * @param {number} index The index of the node to move up.\n * @private\n */\nPriorityQueue.prototype.siftDown_ = function(startIndex, index) {\n  const elements = this.elements_;\n  const priorities = this.priorities_;\n  const element = elements[index];\n  const priority = priorities[index];\n\n  while (index > startIndex) {\n    const parentIndex = this.getParentIndex_(index);\n    if (priorities[parentIndex] > priority) {\n      elements[index] = elements[parentIndex];\n      priorities[index] = priorities[parentIndex];\n      index = parentIndex;\n    } else {\n      break;\n    }\n  }\n  elements[index] = element;\n  priorities[index] = priority;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nPriorityQueue.prototype.reprioritize = function() {\n  const priorityFunction = this.priorityFunction_;\n  const elements = this.elements_;\n  const priorities = this.priorities_;\n  let index = 0;\n  const n = elements.length;\n  let element, i, priority;\n  for (i = 0; i < n; ++i) {\n    element = elements[i];\n    priority = priorityFunction(element);\n    if (priority == DROP) {\n      delete this.queuedElements_[this.keyFunction_(element)];\n    } else {\n      priorities[index] = priority;\n      elements[index++] = element;\n    }\n  }\n  elements.length = index;\n  priorities.length = index;\n  this.heapify_();\n};\nexport default PriorityQueue;\n","/**\n * @module ol/TileQueue\n */\nimport {inherits} from './util.js';\nimport TileState from './TileState.js';\nimport {listen, unlisten} from './events.js';\nimport EventType from './events/EventType.js';\nimport PriorityQueue from './structs/PriorityQueue.js';\n\n\n/**\n * @typedef {function(module:ol/Tile, string, module:ol/coordinate~Coordinate, number): number} PriorityFunction\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/structs/PriorityQueue.<Array>}\n * @param {module:ol/TileQueue~PriorityFunction} tilePriorityFunction\n *     Tile priority function.\n * @param {function(): ?} tileChangeCallback\n *     Function called on each tile change event.\n * @struct\n */\nconst TileQueue = function(tilePriorityFunction, tileChangeCallback) {\n\n  PriorityQueue.call(\n    this,\n    /**\n     * @param {Array} element Element.\n     * @return {number} Priority.\n     */\n    function(element) {\n      return tilePriorityFunction.apply(null, element);\n    },\n    /**\n     * @param {Array} element Element.\n     * @return {string} Key.\n     */\n    function(element) {\n      return (/** @type {module:ol/Tile} */ (element[0]).getKey());\n    });\n\n  /**\n   * @private\n   * @type {function(): ?}\n   */\n  this.tileChangeCallback_ = tileChangeCallback;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.tilesLoading_ = 0;\n\n  /**\n   * @private\n   * @type {!Object.<string,boolean>}\n   */\n  this.tilesLoadingKeys_ = {};\n\n};\n\ninherits(TileQueue, PriorityQueue);\n\n\n/**\n * @inheritDoc\n */\nTileQueue.prototype.enqueue = function(element) {\n  const added = PriorityQueue.prototype.enqueue.call(this, element);\n  if (added) {\n    const tile = element[0];\n    listen(tile, EventType.CHANGE, this.handleTileChange, this);\n  }\n  return added;\n};\n\n\n/**\n * @return {number} Number of tiles loading.\n */\nTileQueue.prototype.getTilesLoading = function() {\n  return this.tilesLoading_;\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n * @protected\n */\nTileQueue.prototype.handleTileChange = function(event) {\n  const tile = /** @type {module:ol/Tile} */ (event.target);\n  const state = tile.getState();\n  if (state === TileState.LOADED || state === TileState.ERROR ||\n      state === TileState.EMPTY || state === TileState.ABORT) {\n    unlisten(tile, EventType.CHANGE, this.handleTileChange, this);\n    const tileKey = tile.getKey();\n    if (tileKey in this.tilesLoadingKeys_) {\n      delete this.tilesLoadingKeys_[tileKey];\n      --this.tilesLoading_;\n    }\n    this.tileChangeCallback_();\n  }\n};\n\n\n/**\n * @param {number} maxTotalLoading Maximum number tiles to load simultaneously.\n * @param {number} maxNewLoads Maximum number of new tiles to load.\n */\nTileQueue.prototype.loadMoreTiles = function(maxTotalLoading, maxNewLoads) {\n  let newLoads = 0;\n  let abortedTiles = false;\n  let state, tile, tileKey;\n  while (this.tilesLoading_ < maxTotalLoading && newLoads < maxNewLoads &&\n         this.getCount() > 0) {\n    tile = /** @type {module:ol/Tile} */ (this.dequeue()[0]);\n    tileKey = tile.getKey();\n    state = tile.getState();\n    if (state === TileState.ABORT) {\n      abortedTiles = true;\n    } else if (state === TileState.IDLE && !(tileKey in this.tilesLoadingKeys_)) {\n      this.tilesLoadingKeys_[tileKey] = true;\n      ++this.tilesLoading_;\n      ++newLoads;\n      tile.load();\n    }\n  }\n  if (newLoads === 0 && abortedTiles) {\n    // Do not stop the render loop when all wanted tiles were aborted due to\n    // a small, saturated tile cache.\n    this.tileChangeCallback_();\n  }\n};\nexport default TileQueue;\n","/**\n * @module ol/tilegrid/common\n */\n\n/**\n * Default maximum zoom for default tile grids.\n * @type {number}\n */\nexport const DEFAULT_MAX_ZOOM = 42;\n\n/**\n * Default tile size.\n * @type {number}\n */\nexport const DEFAULT_TILE_SIZE = 256;\n","/**\n * @module ol/centerconstraint\n */\nimport {clamp} from './math.js';\n\n\n/**\n * @typedef {function((module:ol/coordinate~Coordinate|undefined)): (module:ol/coordinate~Coordinate|undefined)} Type\n */\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {module:ol/centerconstraint~Type} The constraint.\n */\nexport function createExtent(extent) {\n  return (\n    /**\n     * @param {module:ol/coordinate~Coordinate=} center Center.\n     * @return {module:ol/coordinate~Coordinate|undefined} Center.\n     */\n    function(center) {\n      if (center) {\n        return [\n          clamp(center[0], extent[0], extent[2]),\n          clamp(center[1], extent[1], extent[3])\n        ];\n      } else {\n        return undefined;\n      }\n    }\n  );\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate=} center Center.\n * @return {module:ol/coordinate~Coordinate|undefined} Center.\n */\nexport function none(center) {\n  return center;\n}\n","/**\n * @module ol/resolutionconstraint\n */\nimport {linearFindNearest} from './array.js';\nimport {clamp} from './math.js';\n\n\n/**\n * @typedef {function((number|undefined), number, number): (number|undefined)} Type\n */\n\n\n/**\n * @param {Array.<number>} resolutions Resolutions.\n * @return {module:ol/resolutionconstraint~Type} Zoom function.\n */\nexport function createSnapToResolutions(resolutions) {\n  return (\n    /**\n     * @param {number|undefined} resolution Resolution.\n     * @param {number} delta Delta.\n     * @param {number} direction Direction.\n     * @return {number|undefined} Resolution.\n     */\n    function(resolution, delta, direction) {\n      if (resolution !== undefined) {\n        let z = linearFindNearest(resolutions, resolution, direction);\n        z = clamp(z + delta, 0, resolutions.length - 1);\n        const index = Math.floor(z);\n        if (z != index && index < resolutions.length - 1) {\n          const power = resolutions[index] / resolutions[index + 1];\n          return resolutions[index] / Math.pow(power, z - index);\n        } else {\n          return resolutions[index];\n        }\n      } else {\n        return undefined;\n      }\n    }\n  );\n}\n\n\n/**\n * @param {number} power Power.\n * @param {number} maxResolution Maximum resolution.\n * @param {number=} opt_maxLevel Maximum level.\n * @return {module:ol/resolutionconstraint~Type} Zoom function.\n */\nexport function createSnapToPower(power, maxResolution, opt_maxLevel) {\n  return (\n    /**\n     * @param {number|undefined} resolution Resolution.\n     * @param {number} delta Delta.\n     * @param {number} direction Direction.\n     * @return {number|undefined} Resolution.\n     */\n    function(resolution, delta, direction) {\n      if (resolution !== undefined) {\n        const offset = -direction / 2 + 0.5;\n        const oldLevel = Math.floor(\n          Math.log(maxResolution / resolution) / Math.log(power) + offset);\n        let newLevel = Math.max(oldLevel + delta, 0);\n        if (opt_maxLevel !== undefined) {\n          newLevel = Math.min(newLevel, opt_maxLevel);\n        }\n        return maxResolution / Math.pow(power, newLevel);\n      } else {\n        return undefined;\n      }\n    });\n}\n","/**\n * @module ol/rotationconstraint\n */\nimport {toRadians} from './math.js';\n\n\n/**\n * @typedef {function((number|undefined), number): (number|undefined)} Type\n */\n\n\n/**\n * @param {number|undefined} rotation Rotation.\n * @param {number} delta Delta.\n * @return {number|undefined} Rotation.\n */\nexport function disable(rotation, delta) {\n  if (rotation !== undefined) {\n    return 0;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {number|undefined} rotation Rotation.\n * @param {number} delta Delta.\n * @return {number|undefined} Rotation.\n */\nexport function none(rotation, delta) {\n  if (rotation !== undefined) {\n    return rotation + delta;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {number} n N.\n * @return {module:ol/rotationconstraint~Type} Rotation constraint.\n */\nexport function createSnapToN(n) {\n  const theta = 2 * Math.PI / n;\n  return (\n    /**\n     * @param {number|undefined} rotation Rotation.\n     * @param {number} delta Delta.\n     * @return {number|undefined} Rotation.\n     */\n    function(rotation, delta) {\n      if (rotation !== undefined) {\n        rotation = Math.floor((rotation + delta) / theta + 0.5) * theta;\n        return rotation;\n      } else {\n        return undefined;\n      }\n    });\n}\n\n\n/**\n * @param {number=} opt_tolerance Tolerance.\n * @return {module:ol/rotationconstraint~Type} Rotation constraint.\n */\nexport function createSnapToZero(opt_tolerance) {\n  const tolerance = opt_tolerance || toRadians(5);\n  return (\n    /**\n     * @param {number|undefined} rotation Rotation.\n     * @param {number} delta Delta.\n     * @return {number|undefined} Rotation.\n     */\n    function(rotation, delta) {\n      if (rotation !== undefined) {\n        if (Math.abs(rotation + delta) <= tolerance) {\n          return 0;\n        } else {\n          return rotation + delta;\n        }\n      } else {\n        return undefined;\n      }\n    });\n}\n","/**\n * @module ol/ViewHint\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  ANIMATING: 0,\n  INTERACTING: 1\n};\n","/**\n * @module ol/ViewProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  CENTER: 'center',\n  RESOLUTION: 'resolution',\n  ROTATION: 'rotation'\n};\n","/**\n * @module ol/View\n */\nimport {DEFAULT_TILE_SIZE} from './tilegrid/common.js';\nimport {getUid, inherits} from './util.js';\nimport {UNDEFINED} from './functions.js';\nimport {createExtent, none as centerNone} from './centerconstraint.js';\nimport BaseObject from './Object.js';\nimport {createSnapToResolutions, createSnapToPower} from './resolutionconstraint.js';\nimport {createSnapToZero, createSnapToN, none as rotationNone, disable} from './rotationconstraint.js';\nimport ViewHint from './ViewHint.js';\nimport ViewProperty from './ViewProperty.js';\nimport {linearFindNearest} from './array.js';\nimport {assert} from './asserts.js';\nimport {add as addCoordinate, rotate as rotateCoordinate, equals as coordinatesEqual} from './coordinate.js';\nimport {inAndOut} from './easing.js';\nimport {getForViewAndSize, getCenter, getHeight, getWidth, isEmpty} from './extent.js';\nimport GeometryType from './geom/GeometryType.js';\nimport {fromExtent as polygonFromExtent} from './geom/Polygon.js';\nimport SimpleGeometry from './geom/SimpleGeometry.js';\nimport {clamp, modulo} from './math.js';\nimport {assign} from './obj.js';\nimport {createProjection, METERS_PER_UNIT} from './proj.js';\nimport Units from './proj/Units.js';\n\n\n/**\n * An animation configuration\n *\n * @typedef {Object} Animation\n * @property {module:ol/coordinate~Coordinate} [sourceCenter]\n * @property {module:ol/coordinate~Coordinate} [targetCenter]\n * @property {number} [sourceResolution]\n * @property {number} [targetResolution]\n * @property {number} [sourceRotation]\n * @property {number} [sourceRotation]\n * @property {module:ol/coordinate~Coordinate} [anchor]\n * @property {number} start\n * @property {number} duration\n * @property {boolean} complete\n * @property {function(number):number} easing\n * @property {function(boolean)} callback\n */\n\n\n/**\n * @typedef {Object} Constraints\n * @property {module:ol/centerconstraint~Type} center\n * @property {module:ol/resolutionconstraint~Type} resolution\n * @property {module:ol/rotationconstraint~Type} rotation\n */\n\n\n/**\n * @typedef {Object} FitOptions\n * @property {module:ol/size~Size} [size] The size in pixels of the box to fit\n * the extent into. Default is the current size of the first map in the DOM that\n * uses this view, or `[100, 100]` if no such map is found.\n * @property {!Array.<number>} [padding=[0, 0, 0, 0]] Padding (in pixels) to be\n * cleared inside the view. Values in the array are top, right, bottom and left\n * padding.\n * @property {boolean} [constrainResolution=true] Constrain the resolution.\n * @property {boolean} [nearest=false] If `constrainResolution` is `true`, get\n * the nearest extent instead of the closest that actually fits the view.\n * @property {number} [minResolution=0] Minimum resolution that we zoom to.\n * @property {number} [maxZoom] Maximum zoom level that we zoom to. If\n * `minResolution` is given, this property is ignored.\n * @property {number} [duration] The duration of the animation in milliseconds.\n * By default, there is no animation to the target extent.\n * @property {function(number):number} [easing] The easing function used during\n * the animation (defaults to {@link module:ol/easing~inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n * @property {function(boolean)} [callback] Function called when the view is in\n * its final position. The callback will be called with `true` if the animation\n * series completed on its own or `false` if it was cancelled.\n */\n\n\n/**\n * @typedef {Object} ViewOptions\n * @property {module:ol/coordinate~Coordinate} [center] The initial center for\n * the view. The coordinate system for the center is specified with the\n * `projection` option. Layer sources will not be fetched if this is not set,\n * but the center can be set later with {@link #setCenter}.\n * @property {boolean|number} [constrainRotation=true] Rotation constraint.\n * `false` means no constraint. `true` means no constraint, but snap to zero\n * near zero. A number constrains the rotation to that number of values. For\n * example, `4` will constrain the rotation to 0, 90, 180, and 270 degrees.\n * @property {boolean} [enableRotation=true] Enable rotation.\n * If `false`, a rotation constraint that always sets the rotation to zero is\n * used. The `constrainRotation` option has no effect if `enableRotation` is\n * `false`.\n * @property {module:ol/extent~Extent} [extent] The extent that constrains the\n * center, in other words, center cannot be set outside this extent.\n * @property {number} [maxResolution] The maximum resolution used to determine\n * the resolution constraint. It is used together with `minResolution` (or\n * `maxZoom`) and `zoomFactor`. If unspecified it is calculated in such a way\n * that the projection's validity extent fits in a 256x256 px tile. If the\n * projection is Spherical Mercator (the default) then `maxResolution` defaults\n * to `40075016.68557849 / 256 = 156543.03392804097`.\n * @property {number} [minResolution] The minimum resolution used to determine\n * the resolution constraint.  It is used together with `maxResolution` (or\n * `minZoom`) and `zoomFactor`.  If unspecified it is calculated assuming 29\n * zoom levels (with a factor of 2). If the projection is Spherical Mercator\n * (the default) then `minResolution` defaults to\n * `40075016.68557849 / 256 / Math.pow(2, 28) = 0.0005831682455839253`.\n * @property {number} [maxZoom=28] The maximum zoom level used to determine the\n * resolution constraint. It is used together with `minZoom` (or\n * `maxResolution`) and `zoomFactor`.  Note that if `minResolution` is also\n * provided, it is given precedence over `maxZoom`.\n * @property {number} [minZoom=0] The minimum zoom level used to determine the\n * resolution constraint. It is used together with `maxZoom` (or\n * `minResolution`) and `zoomFactor`.  Note that if `maxResolution` is also\n * provided, it is given precedence over `minZoom`.\n * @property {module:ol/proj~ProjectionLike} [projection='EPSG:3857'] The\n * projection. The default is Spherical Mercator.\n * @property {number} [resolution] The initial resolution for the view. The\n * units are `projection` units per pixel (e.g. meters per pixel). An\n * alternative to setting this is to set `zoom`. Layer sources will not be\n * fetched if neither this nor `zoom` are defined, but they can be set later\n * with {@link #setZoom} or {@link #setResolution}.\n * @property {Array.<number>} [resolutions] Resolutions to determine the\n * resolution constraint. If set the `maxResolution`, `minResolution`,\n * `minZoom`, `maxZoom`, and `zoomFactor` options are ignored.\n * @property {number} [rotation=0] The initial rotation for the view in radians\n * (positive rotation clockwise, 0 means North).\n * @property {number} [zoom] Only used if `resolution` is not defined. Zoom\n * level used to calculate the initial resolution for the view. The initial\n * resolution is determined using the {@link #constrainResolution} method.\n * @property {number} [zoomFactor=2] The zoom factor used to determine the\n * resolution constraint.\n */\n\n\n/**\n * @typedef {Object} AnimationOptions\n * @property {module:ol/coordinate~Coordinate|undefined} center The center of the view at the end of\n * the animation.\n * @property {number|undefined} zoom The zoom level of the view at the end of the\n * animation. This takes precedence over `resolution`.\n * @property {number|undefined} resolution The resolution of the view at the end\n * of the animation.  If `zoom` is also provided, this option will be ignored.\n * @property {number|undefined} rotation The rotation of the view at the end of\n * the animation.\n * @property {module:ol/coordinate~Coordinate|undefined} anchor Optional anchor to remained fixed\n * during a rotation or resolution animation.\n * @property {number} [duration=1000] The duration of the animation in milliseconds.\n * @property {function(number):number} [easing] The easing function used\n * during the animation (defaults to {@link module:ol/easing~inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n */\n\n\n/**\n * @typedef {Object} State\n * @property {module:ol/coordinate~Coordinate} center\n * @property {module:ol/proj/Projection} projection\n * @property {number} resolution\n * @property {number} rotation\n * @property {number} zoom\n */\n\n\n/**\n * Default min zoom level for the map view.\n * @type {number}\n */\nconst DEFAULT_MIN_ZOOM = 0;\n\n\n/**\n * @classdesc\n * A View object represents a simple 2D view of the map.\n *\n * This is the object to act upon to change the center, resolution,\n * and rotation of the map.\n *\n * ### The view states\n *\n * An View is determined by three states: `center`, `resolution`,\n * and `rotation`. Each state has a corresponding getter and setter, e.g.\n * `getCenter` and `setCenter` for the `center` state.\n *\n * An View has a `projection`. The projection determines the\n * coordinate system of the center, and its units determine the units of the\n * resolution (projection units per pixel). The default projection is\n * Spherical Mercator (EPSG:3857).\n *\n * ### The constraints\n *\n * `setCenter`, `setResolution` and `setRotation` can be used to change the\n * states of the view. Any value can be passed to the setters. And the value\n * that is passed to a setter will effectively be the value set in the view,\n * and returned by the corresponding getter.\n *\n * But a View object also has a *resolution constraint*, a\n * *rotation constraint* and a *center constraint*.\n *\n * As said above, no constraints are applied when the setters are used to set\n * new states for the view. Applying constraints is done explicitly through\n * the use of the `constrain*` functions (`constrainResolution` and\n * `constrainRotation` and `constrainCenter`).\n *\n * The main users of the constraints are the interactions and the\n * controls. For example, double-clicking on the map changes the view to\n * the \"next\" resolution. And releasing the fingers after pinch-zooming\n * snaps to the closest resolution (with an animation).\n *\n * The *resolution constraint* snaps to specific resolutions. It is\n * determined by the following options: `resolutions`, `maxResolution`,\n * `maxZoom`, and `zoomFactor`. If `resolutions` is set, the other three\n * options are ignored. See documentation for each option for more\n * information.\n *\n * The *rotation constraint* snaps to specific angles. It is determined\n * by the following options: `enableRotation` and `constrainRotation`.\n * By default the rotation value is snapped to zero when approaching the\n * horizontal.\n *\n * The *center constraint* is determined by the `extent` option. By\n * default the center is not constrained at all.\n *\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/View~ViewOptions=} opt_options View options.\n * @api\n */\nconst View = function(opt_options) {\n  BaseObject.call(this);\n\n  const options = assign({}, opt_options);\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.hints_ = [0, 0];\n\n  /**\n   * @private\n   * @type {Array.<Array.<module:ol/View~Animation>>}\n   */\n  this.animations_ = [];\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.updateAnimationKey_;\n\n  this.updateAnimations_ = this.updateAnimations_.bind(this);\n\n  /**\n   * @private\n   * @const\n   * @type {module:ol/proj/Projection}\n   */\n  this.projection_ = createProjection(options.projection, 'EPSG:3857');\n\n  this.applyOptions_(options);\n};\n\ninherits(View, BaseObject);\n\n\n/**\n * Set up the view with the given options.\n * @param {module:ol/View~ViewOptions} options View options.\n */\nView.prototype.applyOptions_ = function(options) {\n\n  /**\n   * @type {Object.<string, *>}\n   */\n  const properties = {};\n  properties[ViewProperty.CENTER] = options.center !== undefined ?\n    options.center : null;\n\n  const resolutionConstraintInfo = createResolutionConstraint(options);\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxResolution_ = resolutionConstraintInfo.maxResolution;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.minResolution_ = resolutionConstraintInfo.minResolution;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.zoomFactor_ = resolutionConstraintInfo.zoomFactor;\n\n  /**\n   * @private\n   * @type {Array.<number>|undefined}\n   */\n  this.resolutions_ = options.resolutions;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.minZoom_ = resolutionConstraintInfo.minZoom;\n\n  const centerConstraint = createCenterConstraint(options);\n  const resolutionConstraint = resolutionConstraintInfo.constraint;\n  const rotationConstraint = createRotationConstraint(options);\n\n  /**\n   * @private\n   * @type {module:ol/View~Constraints}\n   */\n  this.constraints_ = {\n    center: centerConstraint,\n    resolution: resolutionConstraint,\n    rotation: rotationConstraint\n  };\n\n  if (options.resolution !== undefined) {\n    properties[ViewProperty.RESOLUTION] = options.resolution;\n  } else if (options.zoom !== undefined) {\n    properties[ViewProperty.RESOLUTION] = this.constrainResolution(\n      this.maxResolution_, options.zoom - this.minZoom_);\n\n    if (this.resolutions_) { // in case map zoom is out of min/max zoom range\n      properties[ViewProperty.RESOLUTION] = clamp(\n        Number(this.getResolution() || properties[ViewProperty.RESOLUTION]),\n        this.minResolution_, this.maxResolution_);\n    }\n  }\n  properties[ViewProperty.ROTATION] = options.rotation !== undefined ? options.rotation : 0;\n  this.setProperties(properties);\n\n  /**\n   * @private\n   * @type {module:ol/View~ViewOptions}\n   */\n  this.options_ = options;\n\n};\n\n/**\n * Get an updated version of the view options used to construct the view.  The\n * current resolution (or zoom), center, and rotation are applied to any stored\n * options.  The provided options can be used to apply new min/max zoom or\n * resolution limits.\n * @param {module:ol/View~ViewOptions} newOptions New options to be applied.\n * @return {module:ol/View~ViewOptions} New options updated with the current view state.\n */\nView.prototype.getUpdatedOptions_ = function(newOptions) {\n  const options = assign({}, this.options_);\n\n  // preserve resolution (or zoom)\n  if (options.resolution !== undefined) {\n    options.resolution = this.getResolution();\n  } else {\n    options.zoom = this.getZoom();\n  }\n\n  // preserve center\n  options.center = this.getCenter();\n\n  // preserve rotation\n  options.rotation = this.getRotation();\n\n  return assign({}, options, newOptions);\n};\n\n\n/**\n * Animate the view.  The view's center, zoom (or resolution), and rotation\n * can be animated for smooth transitions between view states.  For example,\n * to animate the view to a new zoom level:\n *\n *     view.animate({zoom: view.getZoom() + 1});\n *\n * By default, the animation lasts one second and uses in-and-out easing.  You\n * can customize this behavior by including `duration` (in milliseconds) and\n * `easing` options (see {@link module:ol/easing}).\n *\n * To chain together multiple animations, call the method with multiple\n * animation objects.  For example, to first zoom and then pan:\n *\n *     view.animate({zoom: 10}, {center: [0, 0]});\n *\n * If you provide a function as the last argument to the animate method, it\n * will get called at the end of an animation series.  The callback will be\n * called with `true` if the animation series completed on its own or `false`\n * if it was cancelled.\n *\n * Animations are cancelled by user interactions (e.g. dragging the map) or by\n * calling `view.setCenter()`, `view.setResolution()`, or `view.setRotation()`\n * (or another method that calls one of these).\n *\n * @param {...(module:ol/View~AnimationOptions|function(boolean))} var_args Animation\n *     options.  Multiple animations can be run in series by passing multiple\n *     options objects.  To run multiple animations in parallel, call the method\n *     multiple times.  An optional callback can be provided as a final\n *     argument.  The callback will be called with a boolean indicating whether\n *     the animation completed without being cancelled.\n * @api\n */\nView.prototype.animate = function(var_args) {\n  let animationCount = arguments.length;\n  let callback;\n  if (animationCount > 1 && typeof arguments[animationCount - 1] === 'function') {\n    callback = arguments[animationCount - 1];\n    --animationCount;\n  }\n  if (!this.isDef()) {\n    // if view properties are not yet set, shortcut to the final state\n    const state = arguments[animationCount - 1];\n    if (state.center) {\n      this.setCenter(state.center);\n    }\n    if (state.zoom !== undefined) {\n      this.setZoom(state.zoom);\n    }\n    if (state.rotation !== undefined) {\n      this.setRotation(state.rotation);\n    }\n    if (callback) {\n      setTimeout(function() {\n        callback(true);\n      }, 0);\n    }\n    return;\n  }\n  let start = Date.now();\n  let center = this.getCenter().slice();\n  let resolution = this.getResolution();\n  let rotation = this.getRotation();\n  const series = [];\n  for (let i = 0; i < animationCount; ++i) {\n    const options = /** @type {module:ol/View~AnimationOptions} */ (arguments[i]);\n\n    const animation = /** @type {module:ol/View~Animation} */ ({\n      start: start,\n      complete: false,\n      anchor: options.anchor,\n      duration: options.duration !== undefined ? options.duration : 1000,\n      easing: options.easing || inAndOut\n    });\n\n    if (options.center) {\n      animation.sourceCenter = center;\n      animation.targetCenter = options.center;\n      center = animation.targetCenter;\n    }\n\n    if (options.zoom !== undefined) {\n      animation.sourceResolution = resolution;\n      animation.targetResolution = this.constrainResolution(\n        this.maxResolution_, options.zoom - this.minZoom_, 0);\n      resolution = animation.targetResolution;\n    } else if (options.resolution) {\n      animation.sourceResolution = resolution;\n      animation.targetResolution = options.resolution;\n      resolution = animation.targetResolution;\n    }\n\n    if (options.rotation !== undefined) {\n      animation.sourceRotation = rotation;\n      const delta = modulo(options.rotation - rotation + Math.PI, 2 * Math.PI) - Math.PI;\n      animation.targetRotation = rotation + delta;\n      rotation = animation.targetRotation;\n    }\n\n    animation.callback = callback;\n\n    // check if animation is a no-op\n    if (isNoopAnimation(animation)) {\n      animation.complete = true;\n      // we still push it onto the series for callback handling\n    } else {\n      start += animation.duration;\n    }\n    series.push(animation);\n  }\n  this.animations_.push(series);\n  this.setHint(ViewHint.ANIMATING, 1);\n  this.updateAnimations_();\n};\n\n\n/**\n * Determine if the view is being animated.\n * @return {boolean} The view is being animated.\n * @api\n */\nView.prototype.getAnimating = function() {\n  return this.hints_[ViewHint.ANIMATING] > 0;\n};\n\n\n/**\n * Determine if the user is interacting with the view, such as panning or zooming.\n * @return {boolean} The view is being interacted with.\n * @api\n */\nView.prototype.getInteracting = function() {\n  return this.hints_[ViewHint.INTERACTING] > 0;\n};\n\n\n/**\n * Cancel any ongoing animations.\n * @api\n */\nView.prototype.cancelAnimations = function() {\n  this.setHint(ViewHint.ANIMATING, -this.hints_[ViewHint.ANIMATING]);\n  for (let i = 0, ii = this.animations_.length; i < ii; ++i) {\n    const series = this.animations_[i];\n    if (series[0].callback) {\n      series[0].callback(false);\n    }\n  }\n  this.animations_.length = 0;\n};\n\n/**\n * Update all animations.\n */\nView.prototype.updateAnimations_ = function() {\n  if (this.updateAnimationKey_ !== undefined) {\n    cancelAnimationFrame(this.updateAnimationKey_);\n    this.updateAnimationKey_ = undefined;\n  }\n  if (!this.getAnimating()) {\n    return;\n  }\n  const now = Date.now();\n  let more = false;\n  for (let i = this.animations_.length - 1; i >= 0; --i) {\n    const series = this.animations_[i];\n    let seriesComplete = true;\n    for (let j = 0, jj = series.length; j < jj; ++j) {\n      const animation = series[j];\n      if (animation.complete) {\n        continue;\n      }\n      const elapsed = now - animation.start;\n      let fraction = animation.duration > 0 ? elapsed / animation.duration : 1;\n      if (fraction >= 1) {\n        animation.complete = true;\n        fraction = 1;\n      } else {\n        seriesComplete = false;\n      }\n      const progress = animation.easing(fraction);\n      if (animation.sourceCenter) {\n        const x0 = animation.sourceCenter[0];\n        const y0 = animation.sourceCenter[1];\n        const x1 = animation.targetCenter[0];\n        const y1 = animation.targetCenter[1];\n        const x = x0 + progress * (x1 - x0);\n        const y = y0 + progress * (y1 - y0);\n        this.set(ViewProperty.CENTER, [x, y]);\n      }\n      if (animation.sourceResolution && animation.targetResolution) {\n        const resolution = progress === 1 ?\n          animation.targetResolution :\n          animation.sourceResolution + progress * (animation.targetResolution - animation.sourceResolution);\n        if (animation.anchor) {\n          this.set(ViewProperty.CENTER,\n            this.calculateCenterZoom(resolution, animation.anchor));\n        }\n        this.set(ViewProperty.RESOLUTION, resolution);\n      }\n      if (animation.sourceRotation !== undefined && animation.targetRotation !== undefined) {\n        const rotation = progress === 1 ?\n          modulo(animation.targetRotation + Math.PI, 2 * Math.PI) - Math.PI :\n          animation.sourceRotation + progress * (animation.targetRotation - animation.sourceRotation);\n        if (animation.anchor) {\n          this.set(ViewProperty.CENTER,\n            this.calculateCenterRotate(rotation, animation.anchor));\n        }\n        this.set(ViewProperty.ROTATION, rotation);\n      }\n      more = true;\n      if (!animation.complete) {\n        break;\n      }\n    }\n    if (seriesComplete) {\n      this.animations_[i] = null;\n      this.setHint(ViewHint.ANIMATING, -1);\n      const callback = series[0].callback;\n      if (callback) {\n        setTimeout(function() {\n          callback(true);\n        }, 0);\n      }\n    }\n  }\n  // prune completed series\n  this.animations_ = this.animations_.filter(Boolean);\n  if (more && this.updateAnimationKey_ === undefined) {\n    this.updateAnimationKey_ = requestAnimationFrame(this.updateAnimations_);\n  }\n};\n\n/**\n * @param {number} rotation Target rotation.\n * @param {module:ol/coordinate~Coordinate} anchor Rotation anchor.\n * @return {module:ol/coordinate~Coordinate|undefined} Center for rotation and anchor.\n */\nView.prototype.calculateCenterRotate = function(rotation, anchor) {\n  let center;\n  const currentCenter = this.getCenter();\n  if (currentCenter !== undefined) {\n    center = [currentCenter[0] - anchor[0], currentCenter[1] - anchor[1]];\n    rotateCoordinate(center, rotation - this.getRotation());\n    addCoordinate(center, anchor);\n  }\n  return center;\n};\n\n\n/**\n * @param {number} resolution Target resolution.\n * @param {module:ol/coordinate~Coordinate} anchor Zoom anchor.\n * @return {module:ol/coordinate~Coordinate|undefined} Center for resolution and anchor.\n */\nView.prototype.calculateCenterZoom = function(resolution, anchor) {\n  let center;\n  const currentCenter = this.getCenter();\n  const currentResolution = this.getResolution();\n  if (currentCenter !== undefined && currentResolution !== undefined) {\n    const x = anchor[0] - resolution * (anchor[0] - currentCenter[0]) / currentResolution;\n    const y = anchor[1] - resolution * (anchor[1] - currentCenter[1]) / currentResolution;\n    center = [x, y];\n  }\n  return center;\n};\n\n\n/**\n * @private\n * @return {module:ol/size~Size} Viewport size or `[100, 100]` when no viewport is found.\n */\nView.prototype.getSizeFromViewport_ = function() {\n  const size = [100, 100];\n  const selector = '.ol-viewport[data-view=\"' + getUid(this) + '\"]';\n  const element = document.querySelector(selector);\n  if (element) {\n    const metrics = getComputedStyle(element);\n    size[0] = parseInt(metrics.width, 10);\n    size[1] = parseInt(metrics.height, 10);\n  }\n  return size;\n};\n\n\n/**\n * Get the constrained center of this view.\n * @param {module:ol/coordinate~Coordinate|undefined} center Center.\n * @return {module:ol/coordinate~Coordinate|undefined} Constrained center.\n * @api\n */\nView.prototype.constrainCenter = function(center) {\n  return this.constraints_.center(center);\n};\n\n\n/**\n * Get the constrained resolution of this view.\n * @param {number|undefined} resolution Resolution.\n * @param {number=} opt_delta Delta. Default is `0`.\n * @param {number=} opt_direction Direction. Default is `0`.\n * @return {number|undefined} Constrained resolution.\n * @api\n */\nView.prototype.constrainResolution = function(resolution, opt_delta, opt_direction) {\n  const delta = opt_delta || 0;\n  const direction = opt_direction || 0;\n  return this.constraints_.resolution(resolution, delta, direction);\n};\n\n\n/**\n * Get the constrained rotation of this view.\n * @param {number|undefined} rotation Rotation.\n * @param {number=} opt_delta Delta. Default is `0`.\n * @return {number|undefined} Constrained rotation.\n * @api\n */\nView.prototype.constrainRotation = function(rotation, opt_delta) {\n  const delta = opt_delta || 0;\n  return this.constraints_.rotation(rotation, delta);\n};\n\n\n/**\n * Get the view center.\n * @return {module:ol/coordinate~Coordinate|undefined} The center of the view.\n * @observable\n * @api\n */\nView.prototype.getCenter = function() {\n  return (\n    /** @type {module:ol/coordinate~Coordinate|undefined} */ (this.get(ViewProperty.CENTER))\n  );\n};\n\n\n/**\n * @return {module:ol/View~Constraints} Constraints.\n */\nView.prototype.getConstraints = function() {\n  return this.constraints_;\n};\n\n\n/**\n * @param {Array.<number>=} opt_hints Destination array.\n * @return {Array.<number>} Hint.\n */\nView.prototype.getHints = function(opt_hints) {\n  if (opt_hints !== undefined) {\n    opt_hints[0] = this.hints_[0];\n    opt_hints[1] = this.hints_[1];\n    return opt_hints;\n  } else {\n    return this.hints_.slice();\n  }\n};\n\n\n/**\n * Calculate the extent for the current view state and the passed size.\n * The size is the pixel dimensions of the box into which the calculated extent\n * should fit. In most cases you want to get the extent of the entire map,\n * that is `map.getSize()`.\n * @param {module:ol/size~Size=} opt_size Box pixel size. If not provided, the size of the\n * first map that uses this view will be used.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nView.prototype.calculateExtent = function(opt_size) {\n  const size = opt_size || this.getSizeFromViewport_();\n  const center = /** @type {!module:ol/coordinate~Coordinate} */ (this.getCenter());\n  assert(center, 1); // The view center is not defined\n  const resolution = /** @type {!number} */ (this.getResolution());\n  assert(resolution !== undefined, 2); // The view resolution is not defined\n  const rotation = /** @type {!number} */ (this.getRotation());\n  assert(rotation !== undefined, 3); // The view rotation is not defined\n\n  return getForViewAndSize(center, resolution, rotation, size);\n};\n\n\n/**\n * Get the maximum resolution of the view.\n * @return {number} The maximum resolution of the view.\n * @api\n */\nView.prototype.getMaxResolution = function() {\n  return this.maxResolution_;\n};\n\n\n/**\n * Get the minimum resolution of the view.\n * @return {number} The minimum resolution of the view.\n * @api\n */\nView.prototype.getMinResolution = function() {\n  return this.minResolution_;\n};\n\n\n/**\n * Get the maximum zoom level for the view.\n * @return {number} The maximum zoom level.\n * @api\n */\nView.prototype.getMaxZoom = function() {\n  return /** @type {number} */ (this.getZoomForResolution(this.minResolution_));\n};\n\n\n/**\n * Set a new maximum zoom level for the view.\n * @param {number} zoom The maximum zoom level.\n * @api\n */\nView.prototype.setMaxZoom = function(zoom) {\n  this.applyOptions_(this.getUpdatedOptions_({maxZoom: zoom}));\n};\n\n\n/**\n * Get the minimum zoom level for the view.\n * @return {number} The minimum zoom level.\n * @api\n */\nView.prototype.getMinZoom = function() {\n  return /** @type {number} */ (this.getZoomForResolution(this.maxResolution_));\n};\n\n\n/**\n * Set a new minimum zoom level for the view.\n * @param {number} zoom The minimum zoom level.\n * @api\n */\nView.prototype.setMinZoom = function(zoom) {\n  this.applyOptions_(this.getUpdatedOptions_({minZoom: zoom}));\n};\n\n\n/**\n * Get the view projection.\n * @return {module:ol/proj/Projection} The projection of the view.\n * @api\n */\nView.prototype.getProjection = function() {\n  return this.projection_;\n};\n\n\n/**\n * Get the view resolution.\n * @return {number|undefined} The resolution of the view.\n * @observable\n * @api\n */\nView.prototype.getResolution = function() {\n  return /** @type {number|undefined} */ (this.get(ViewProperty.RESOLUTION));\n};\n\n\n/**\n * Get the resolutions for the view. This returns the array of resolutions\n * passed to the constructor of the View, or undefined if none were given.\n * @return {Array.<number>|undefined} The resolutions of the view.\n * @api\n */\nView.prototype.getResolutions = function() {\n  return this.resolutions_;\n};\n\n\n/**\n * Get the resolution for a provided extent (in map units) and size (in pixels).\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/size~Size=} opt_size Box pixel size.\n * @return {number} The resolution at which the provided extent will render at\n *     the given size.\n * @api\n */\nView.prototype.getResolutionForExtent = function(extent, opt_size) {\n  const size = opt_size || this.getSizeFromViewport_();\n  const xResolution = getWidth(extent) / size[0];\n  const yResolution = getHeight(extent) / size[1];\n  return Math.max(xResolution, yResolution);\n};\n\n\n/**\n * Return a function that returns a value between 0 and 1 for a\n * resolution. Exponential scaling is assumed.\n * @param {number=} opt_power Power.\n * @return {function(number): number} Resolution for value function.\n */\nView.prototype.getResolutionForValueFunction = function(opt_power) {\n  const power = opt_power || 2;\n  const maxResolution = this.maxResolution_;\n  const minResolution = this.minResolution_;\n  const max = Math.log(maxResolution / minResolution) / Math.log(power);\n  return (\n    /**\n     * @param {number} value Value.\n     * @return {number} Resolution.\n     */\n    function(value) {\n      const resolution = maxResolution / Math.pow(power, value * max);\n      return resolution;\n    });\n};\n\n\n/**\n * Get the view rotation.\n * @return {number} The rotation of the view in radians.\n * @observable\n * @api\n */\nView.prototype.getRotation = function() {\n  return /** @type {number} */ (this.get(ViewProperty.ROTATION));\n};\n\n\n/**\n * Return a function that returns a resolution for a value between\n * 0 and 1. Exponential scaling is assumed.\n * @param {number=} opt_power Power.\n * @return {function(number): number} Value for resolution function.\n */\nView.prototype.getValueForResolutionFunction = function(opt_power) {\n  const power = opt_power || 2;\n  const maxResolution = this.maxResolution_;\n  const minResolution = this.minResolution_;\n  const max = Math.log(maxResolution / minResolution) / Math.log(power);\n  return (\n    /**\n     * @param {number} resolution Resolution.\n     * @return {number} Value.\n     */\n    function(resolution) {\n      const value = (Math.log(maxResolution / resolution) / Math.log(power)) / max;\n      return value;\n    });\n};\n\n\n/**\n * @return {module:ol/View~State} View state.\n */\nView.prototype.getState = function() {\n  const center = /** @type {module:ol/coordinate~Coordinate} */ (this.getCenter());\n  const projection = this.getProjection();\n  const resolution = /** @type {number} */ (this.getResolution());\n  const rotation = this.getRotation();\n  return (\n    /** @type {module:ol/View~State} */ ({\n      center: center.slice(),\n      projection: projection !== undefined ? projection : null,\n      resolution: resolution,\n      rotation: rotation,\n      zoom: this.getZoom()\n    })\n  );\n};\n\n\n/**\n * Get the current zoom level.  If you configured your view with a resolutions\n * array (this is rare), this method may return non-integer zoom levels (so\n * the zoom level is not safe to use as an index into a resolutions array).\n * @return {number|undefined} Zoom.\n * @api\n */\nView.prototype.getZoom = function() {\n  let zoom;\n  const resolution = this.getResolution();\n  if (resolution !== undefined) {\n    zoom = this.getZoomForResolution(resolution);\n  }\n  return zoom;\n};\n\n\n/**\n * Get the zoom level for a resolution.\n * @param {number} resolution The resolution.\n * @return {number|undefined} The zoom level for the provided resolution.\n * @api\n */\nView.prototype.getZoomForResolution = function(resolution) {\n  let offset = this.minZoom_ || 0;\n  let max, zoomFactor;\n  if (this.resolutions_) {\n    const nearest = linearFindNearest(this.resolutions_, resolution, 1);\n    offset = nearest;\n    max = this.resolutions_[nearest];\n    if (nearest == this.resolutions_.length - 1) {\n      zoomFactor = 2;\n    } else {\n      zoomFactor = max / this.resolutions_[nearest + 1];\n    }\n  } else {\n    max = this.maxResolution_;\n    zoomFactor = this.zoomFactor_;\n  }\n  return offset + Math.log(max / resolution) / Math.log(zoomFactor);\n};\n\n\n/**\n * Get the resolution for a zoom level.\n * @param {number} zoom Zoom level.\n * @return {number} The view resolution for the provided zoom level.\n * @api\n */\nView.prototype.getResolutionForZoom = function(zoom) {\n  return /** @type {number} */ (this.constrainResolution(\n    this.maxResolution_, zoom - this.minZoom_, 0));\n};\n\n\n/**\n * Fit the given geometry or extent based on the given map size and border.\n * The size is pixel dimensions of the box to fit the extent into.\n * In most cases you will want to use the map size, that is `map.getSize()`.\n * Takes care of the map angle.\n * @param {module:ol/geom/SimpleGeometry|module:ol/extent~Extent} geometryOrExtent The geometry or\n *     extent to fit the view to.\n * @param {module:ol/View~FitOptions=} opt_options Options.\n * @api\n */\nView.prototype.fit = function(geometryOrExtent, opt_options) {\n  const options = opt_options || {};\n  let size = options.size;\n  if (!size) {\n    size = this.getSizeFromViewport_();\n  }\n  /** @type {module:ol/geom/SimpleGeometry} */\n  let geometry;\n  if (!(geometryOrExtent instanceof SimpleGeometry)) {\n    assert(Array.isArray(geometryOrExtent),\n      24); // Invalid extent or geometry provided as `geometry`\n    assert(!isEmpty(geometryOrExtent),\n      25); // Cannot fit empty extent provided as `geometry`\n    geometry = polygonFromExtent(geometryOrExtent);\n  } else if (geometryOrExtent.getType() === GeometryType.CIRCLE) {\n    geometryOrExtent = geometryOrExtent.getExtent();\n    geometry = polygonFromExtent(geometryOrExtent);\n    geometry.rotate(this.getRotation(), getCenter(geometryOrExtent));\n  } else {\n    geometry = geometryOrExtent;\n  }\n\n  const padding = options.padding !== undefined ? options.padding : [0, 0, 0, 0];\n  const constrainResolution = options.constrainResolution !== undefined ?\n    options.constrainResolution : true;\n  const nearest = options.nearest !== undefined ? options.nearest : false;\n  let minResolution;\n  if (options.minResolution !== undefined) {\n    minResolution = options.minResolution;\n  } else if (options.maxZoom !== undefined) {\n    minResolution = this.constrainResolution(\n      this.maxResolution_, options.maxZoom - this.minZoom_, 0);\n  } else {\n    minResolution = 0;\n  }\n  const coords = geometry.getFlatCoordinates();\n\n  // calculate rotated extent\n  const rotation = this.getRotation();\n  const cosAngle = Math.cos(-rotation);\n  let sinAngle = Math.sin(-rotation);\n  let minRotX = +Infinity;\n  let minRotY = +Infinity;\n  let maxRotX = -Infinity;\n  let maxRotY = -Infinity;\n  const stride = geometry.getStride();\n  for (let i = 0, ii = coords.length; i < ii; i += stride) {\n    const rotX = coords[i] * cosAngle - coords[i + 1] * sinAngle;\n    const rotY = coords[i] * sinAngle + coords[i + 1] * cosAngle;\n    minRotX = Math.min(minRotX, rotX);\n    minRotY = Math.min(minRotY, rotY);\n    maxRotX = Math.max(maxRotX, rotX);\n    maxRotY = Math.max(maxRotY, rotY);\n  }\n\n  // calculate resolution\n  let resolution = this.getResolutionForExtent(\n    [minRotX, minRotY, maxRotX, maxRotY],\n    [size[0] - padding[1] - padding[3], size[1] - padding[0] - padding[2]]);\n  resolution = isNaN(resolution) ? minResolution :\n    Math.max(resolution, minResolution);\n  if (constrainResolution) {\n    let constrainedResolution = this.constrainResolution(resolution, 0, 0);\n    if (!nearest && constrainedResolution < resolution) {\n      constrainedResolution = this.constrainResolution(\n        constrainedResolution, -1, 0);\n    }\n    resolution = constrainedResolution;\n  }\n\n  // calculate center\n  sinAngle = -sinAngle; // go back to original rotation\n  let centerRotX = (minRotX + maxRotX) / 2;\n  let centerRotY = (minRotY + maxRotY) / 2;\n  centerRotX += (padding[1] - padding[3]) / 2 * resolution;\n  centerRotY += (padding[0] - padding[2]) / 2 * resolution;\n  const centerX = centerRotX * cosAngle - centerRotY * sinAngle;\n  const centerY = centerRotY * cosAngle + centerRotX * sinAngle;\n  const center = [centerX, centerY];\n  const callback = options.callback ? options.callback : UNDEFINED;\n\n  if (options.duration !== undefined) {\n    this.animate({\n      resolution: resolution,\n      center: center,\n      duration: options.duration,\n      easing: options.easing\n    }, callback);\n  } else {\n    this.setResolution(resolution);\n    this.setCenter(center);\n    setTimeout(callback.bind(undefined, true), 0);\n  }\n};\n\n\n/**\n * Center on coordinate and view position.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/size~Size} size Box pixel size.\n * @param {module:ol~Pixel} position Position on the view to center on.\n * @api\n */\nView.prototype.centerOn = function(coordinate, size, position) {\n  // calculate rotated position\n  const rotation = this.getRotation();\n  const cosAngle = Math.cos(-rotation);\n  let sinAngle = Math.sin(-rotation);\n  let rotX = coordinate[0] * cosAngle - coordinate[1] * sinAngle;\n  let rotY = coordinate[1] * cosAngle + coordinate[0] * sinAngle;\n  const resolution = this.getResolution();\n  rotX += (size[0] / 2 - position[0]) * resolution;\n  rotY += (position[1] - size[1] / 2) * resolution;\n\n  // go back to original angle\n  sinAngle = -sinAngle; // go back to original rotation\n  const centerX = rotX * cosAngle - rotY * sinAngle;\n  const centerY = rotY * cosAngle + rotX * sinAngle;\n\n  this.setCenter([centerX, centerY]);\n};\n\n\n/**\n * @return {boolean} Is defined.\n */\nView.prototype.isDef = function() {\n  return !!this.getCenter() && this.getResolution() !== undefined;\n};\n\n\n/**\n * Rotate the view around a given coordinate.\n * @param {number} rotation New rotation value for the view.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor The rotation center.\n * @api\n */\nView.prototype.rotate = function(rotation, opt_anchor) {\n  if (opt_anchor !== undefined) {\n    const center = this.calculateCenterRotate(rotation, opt_anchor);\n    this.setCenter(center);\n  }\n  this.setRotation(rotation);\n};\n\n\n/**\n * Set the center of the current view.\n * @param {module:ol/coordinate~Coordinate|undefined} center The center of the view.\n * @observable\n * @api\n */\nView.prototype.setCenter = function(center) {\n  this.set(ViewProperty.CENTER, center);\n  if (this.getAnimating()) {\n    this.cancelAnimations();\n  }\n};\n\n\n/**\n * @param {module:ol/ViewHint} hint Hint.\n * @param {number} delta Delta.\n * @return {number} New value.\n */\nView.prototype.setHint = function(hint, delta) {\n  this.hints_[hint] += delta;\n  this.changed();\n  return this.hints_[hint];\n};\n\n\n/**\n * Set the resolution for this view.\n * @param {number|undefined} resolution The resolution of the view.\n * @observable\n * @api\n */\nView.prototype.setResolution = function(resolution) {\n  this.set(ViewProperty.RESOLUTION, resolution);\n  if (this.getAnimating()) {\n    this.cancelAnimations();\n  }\n};\n\n\n/**\n * Set the rotation for this view.\n * @param {number} rotation The rotation of the view in radians.\n * @observable\n * @api\n */\nView.prototype.setRotation = function(rotation) {\n  this.set(ViewProperty.ROTATION, rotation);\n  if (this.getAnimating()) {\n    this.cancelAnimations();\n  }\n};\n\n\n/**\n * Zoom to a specific zoom level.\n * @param {number} zoom Zoom level.\n * @api\n */\nView.prototype.setZoom = function(zoom) {\n  this.setResolution(this.getResolutionForZoom(zoom));\n};\n\n\n/**\n * @param {module:ol/View~ViewOptions} options View options.\n * @return {module:ol/centerconstraint~Type} The constraint.\n */\nexport function createCenterConstraint(options) {\n  if (options.extent !== undefined) {\n    return createExtent(options.extent);\n  } else {\n    return centerNone;\n  }\n}\n\n\n/**\n * @param {module:ol/View~ViewOptions} options View options.\n * @return {{constraint: module:ol/resolutionconstraint~Type, maxResolution: number,\n *     minResolution: number, minZoom: number, zoomFactor: number}} The constraint.\n */\nexport function createResolutionConstraint(options) {\n  let resolutionConstraint;\n  let maxResolution;\n  let minResolution;\n\n  // TODO: move these to be ol constants\n  // see https://github.com/openlayers/openlayers/issues/2076\n  const defaultMaxZoom = 28;\n  const defaultZoomFactor = 2;\n\n  let minZoom = options.minZoom !== undefined ?\n    options.minZoom : DEFAULT_MIN_ZOOM;\n\n  let maxZoom = options.maxZoom !== undefined ?\n    options.maxZoom : defaultMaxZoom;\n\n  const zoomFactor = options.zoomFactor !== undefined ?\n    options.zoomFactor : defaultZoomFactor;\n\n  if (options.resolutions !== undefined) {\n    const resolutions = options.resolutions;\n    maxResolution = resolutions[minZoom];\n    minResolution = resolutions[maxZoom] !== undefined ?\n      resolutions[maxZoom] : resolutions[resolutions.length - 1];\n    resolutionConstraint = createSnapToResolutions(\n      resolutions);\n  } else {\n    // calculate the default min and max resolution\n    const projection = createProjection(options.projection, 'EPSG:3857');\n    const extent = projection.getExtent();\n    const size = !extent ?\n      // use an extent that can fit the whole world if need be\n      360 * METERS_PER_UNIT[Units.DEGREES] /\n            projection.getMetersPerUnit() :\n      Math.max(getWidth(extent), getHeight(extent));\n\n    const defaultMaxResolution = size / DEFAULT_TILE_SIZE / Math.pow(\n      defaultZoomFactor, DEFAULT_MIN_ZOOM);\n\n    const defaultMinResolution = defaultMaxResolution / Math.pow(\n      defaultZoomFactor, defaultMaxZoom - DEFAULT_MIN_ZOOM);\n\n    // user provided maxResolution takes precedence\n    maxResolution = options.maxResolution;\n    if (maxResolution !== undefined) {\n      minZoom = 0;\n    } else {\n      maxResolution = defaultMaxResolution / Math.pow(zoomFactor, minZoom);\n    }\n\n    // user provided minResolution takes precedence\n    minResolution = options.minResolution;\n    if (minResolution === undefined) {\n      if (options.maxZoom !== undefined) {\n        if (options.maxResolution !== undefined) {\n          minResolution = maxResolution / Math.pow(zoomFactor, maxZoom);\n        } else {\n          minResolution = defaultMaxResolution / Math.pow(zoomFactor, maxZoom);\n        }\n      } else {\n        minResolution = defaultMinResolution;\n      }\n    }\n\n    // given discrete zoom levels, minResolution may be different than provided\n    maxZoom = minZoom + Math.floor(\n      Math.log(maxResolution / minResolution) / Math.log(zoomFactor));\n    minResolution = maxResolution / Math.pow(zoomFactor, maxZoom - minZoom);\n\n    resolutionConstraint = createSnapToPower(\n      zoomFactor, maxResolution, maxZoom - minZoom);\n  }\n  return {constraint: resolutionConstraint, maxResolution: maxResolution,\n    minResolution: minResolution, minZoom: minZoom, zoomFactor: zoomFactor};\n}\n\n\n/**\n * @param {module:ol/View~ViewOptions} options View options.\n * @return {module:ol/rotationconstraint~Type} Rotation constraint.\n */\nexport function createRotationConstraint(options) {\n  const enableRotation = options.enableRotation !== undefined ?\n    options.enableRotation : true;\n  if (enableRotation) {\n    const constrainRotation = options.constrainRotation;\n    if (constrainRotation === undefined || constrainRotation === true) {\n      return createSnapToZero();\n    } else if (constrainRotation === false) {\n      return rotationNone;\n    } else if (typeof constrainRotation === 'number') {\n      return createSnapToN(constrainRotation);\n    } else {\n      return rotationNone;\n    }\n  } else {\n    return disable;\n  }\n}\n\n\n/**\n * Determine if an animation involves no view change.\n * @param {module:ol/View~Animation} animation The animation.\n * @return {boolean} The animation involves no view change.\n */\nexport function isNoopAnimation(animation) {\n  if (animation.sourceCenter && animation.targetCenter) {\n    if (!coordinatesEqual(animation.sourceCenter, animation.targetCenter)) {\n      return false;\n    }\n  }\n  if (animation.sourceResolution !== animation.targetResolution) {\n    return false;\n  }\n  if (animation.sourceRotation !== animation.targetRotation) {\n    return false;\n  }\n  return true;\n}\n\nexport default View;\n","/**\n * @module ol/layer/Property\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  OPACITY: 'opacity',\n  VISIBLE: 'visible',\n  EXTENT: 'extent',\n  Z_INDEX: 'zIndex',\n  MAX_RESOLUTION: 'maxResolution',\n  MIN_RESOLUTION: 'minResolution',\n  SOURCE: 'source'\n};\n","/**\n * @module ol/layer/Base\n */\nimport {inherits} from '../util.js';\nimport BaseObject from '../Object.js';\nimport LayerProperty from '../layer/Property.js';\nimport {clamp} from '../math.js';\nimport {assign} from '../obj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Note that with {@link module:ol/layer/Base} and all its subclasses, any property set in\n * the options is set as a {@link module:ol/Object} property on the layer object, so\n * is observable, and has get/set accessors.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/Object}\n * @param {module:ol/layer/Base~Options} options Layer options.\n * @api\n */\nconst BaseLayer = function(options) {\n\n  BaseObject.call(this);\n\n  /**\n   * @type {Object.<string, *>}\n   */\n  const properties = assign({}, options);\n  properties[LayerProperty.OPACITY] =\n      options.opacity !== undefined ? options.opacity : 1;\n  properties[LayerProperty.VISIBLE] =\n      options.visible !== undefined ? options.visible : true;\n  properties[LayerProperty.Z_INDEX] =\n      options.zIndex !== undefined ? options.zIndex : 0;\n  properties[LayerProperty.MAX_RESOLUTION] =\n      options.maxResolution !== undefined ? options.maxResolution : Infinity;\n  properties[LayerProperty.MIN_RESOLUTION] =\n      options.minResolution !== undefined ? options.minResolution : 0;\n\n  this.setProperties(properties);\n\n  /**\n   * @type {module:ol/layer/Layer~State}\n   * @private\n   */\n  this.state_ = /** @type {module:ol/layer/Layer~State} */ ({\n    layer: /** @type {module:ol/layer/Layer} */ (this),\n    managed: true\n  });\n\n  /**\n   * The layer type.\n   * @type {module:ol/LayerType}\n   * @protected;\n   */\n  this.type;\n\n};\n\ninherits(BaseLayer, BaseObject);\n\n\n/**\n * Get the layer type (used when creating a layer renderer).\n * @return {module:ol/LayerType} The layer type.\n */\nBaseLayer.prototype.getType = function() {\n  return this.type;\n};\n\n\n/**\n * @return {module:ol/layer/Layer~State} Layer state.\n */\nBaseLayer.prototype.getLayerState = function() {\n  this.state_.opacity = clamp(this.getOpacity(), 0, 1);\n  this.state_.sourceState = this.getSourceState();\n  this.state_.visible = this.getVisible();\n  this.state_.extent = this.getExtent();\n  this.state_.zIndex = this.getZIndex();\n  this.state_.maxResolution = this.getMaxResolution();\n  this.state_.minResolution = Math.max(this.getMinResolution(), 0);\n\n  return this.state_;\n};\n\n\n/**\n * @abstract\n * @param {Array.<module:ol/layer/Layer>=} opt_array Array of layers (to be\n *     modified in place).\n * @return {Array.<module:ol/layer/Layer>} Array of layers.\n */\nBaseLayer.prototype.getLayersArray = function(opt_array) {};\n\n\n/**\n * @abstract\n * @param {Array.<module:ol/layer/Layer~State>=} opt_states Optional list of layer\n *     states (to be modified in place).\n * @return {Array.<module:ol/layer/Layer~State>} List of layer states.\n */\nBaseLayer.prototype.getLayerStatesArray = function(opt_states) {};\n\n\n/**\n * Return the {@link module:ol/extent~Extent extent} of the layer or `undefined` if it\n * will be visible regardless of extent.\n * @return {module:ol/extent~Extent|undefined} The layer extent.\n * @observable\n * @api\n */\nBaseLayer.prototype.getExtent = function() {\n  return (\n    /** @type {module:ol/extent~Extent|undefined} */ (this.get(LayerProperty.EXTENT))\n  );\n};\n\n\n/**\n * Return the maximum resolution of the layer.\n * @return {number} The maximum resolution of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.getMaxResolution = function() {\n  return /** @type {number} */ (this.get(LayerProperty.MAX_RESOLUTION));\n};\n\n\n/**\n * Return the minimum resolution of the layer.\n * @return {number} The minimum resolution of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.getMinResolution = function() {\n  return /** @type {number} */ (this.get(LayerProperty.MIN_RESOLUTION));\n};\n\n\n/**\n * Return the opacity of the layer (between 0 and 1).\n * @return {number} The opacity of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.getOpacity = function() {\n  return /** @type {number} */ (this.get(LayerProperty.OPACITY));\n};\n\n\n/**\n * @abstract\n * @return {module:ol/source/State} Source state.\n */\nBaseLayer.prototype.getSourceState = function() {};\n\n\n/**\n * Return the visibility of the layer (`true` or `false`).\n * @return {boolean} The visibility of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.getVisible = function() {\n  return /** @type {boolean} */ (this.get(LayerProperty.VISIBLE));\n};\n\n\n/**\n * Return the Z-index of the layer, which is used to order layers before\n * rendering. The default Z-index is 0.\n * @return {number} The Z-index of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.getZIndex = function() {\n  return /** @type {number} */ (this.get(LayerProperty.Z_INDEX));\n};\n\n\n/**\n * Set the extent at which the layer is visible.  If `undefined`, the layer\n * will be visible at all extents.\n * @param {module:ol/extent~Extent|undefined} extent The extent of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setExtent = function(extent) {\n  this.set(LayerProperty.EXTENT, extent);\n};\n\n\n/**\n * Set the maximum resolution at which the layer is visible.\n * @param {number} maxResolution The maximum resolution of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setMaxResolution = function(maxResolution) {\n  this.set(LayerProperty.MAX_RESOLUTION, maxResolution);\n};\n\n\n/**\n * Set the minimum resolution at which the layer is visible.\n * @param {number} minResolution The minimum resolution of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setMinResolution = function(minResolution) {\n  this.set(LayerProperty.MIN_RESOLUTION, minResolution);\n};\n\n\n/**\n * Set the opacity of the layer, allowed values range from 0 to 1.\n * @param {number} opacity The opacity of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setOpacity = function(opacity) {\n  this.set(LayerProperty.OPACITY, opacity);\n};\n\n\n/**\n * Set the visibility of the layer (`true` or `false`).\n * @param {boolean} visible The visibility of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setVisible = function(visible) {\n  this.set(LayerProperty.VISIBLE, visible);\n};\n\n\n/**\n * Set Z-index of the layer, which is used to order layers before rendering.\n * The default Z-index is 0.\n * @param {number} zindex The z-index of the layer.\n * @observable\n * @api\n */\nBaseLayer.prototype.setZIndex = function(zindex) {\n  this.set(LayerProperty.Z_INDEX, zindex);\n};\nexport default BaseLayer;\n","/**\n * @module ol/source/State\n */\n\n/**\n * State of the source, one of 'undefined', 'loading', 'ready' or 'error'.\n * @enum {string}\n */\nexport default {\n  UNDEFINED: 'undefined',\n  LOADING: 'loading',\n  READY: 'ready',\n  ERROR: 'error'\n};\n","/**\n * @module ol/layer/Group\n */\nimport {getUid, inherits} from '../util.js';\nimport Collection from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport {getChangeEventType} from '../Object.js';\nimport ObjectEventType from '../ObjectEventType.js';\nimport {assert} from '../asserts.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getIntersection} from '../extent.js';\nimport BaseLayer from '../layer/Base.js';\nimport {assign, clear} from '../obj.js';\nimport SourceState from '../source/State.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {(Array.<module:ol/layer/Base>|module:ol/Collection.<module:ol/layer/Base>)} [layers] Child layers.\n */\n\n\n/**\n * @enum {string}\n * @private\n */\nconst Property = {\n  LAYERS: 'layers'\n};\n\n\n/**\n * @classdesc\n * A {@link module:ol/Collection~Collection} of layers that are handled together.\n *\n * A generic `change` event is triggered when the group/Collection changes.\n *\n * @constructor\n * @extends {module:ol/layer/Base}\n * @param {module:ol/layer/Group~Options=} opt_options Layer options.\n * @api\n */\nconst LayerGroup = function(opt_options) {\n\n  const options = opt_options || {};\n  const baseOptions = /** @type {module:ol/layer/Group~Options} */ (assign({}, options));\n  delete baseOptions.layers;\n\n  let layers = options.layers;\n\n  BaseLayer.call(this, baseOptions);\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.layersListenerKeys_ = [];\n\n  /**\n   * @private\n   * @type {Object.<string, Array.<module:ol/events~EventsKey>>}\n   */\n  this.listenerKeys_ = {};\n\n  listen(this,\n    getChangeEventType(Property.LAYERS),\n    this.handleLayersChanged_, this);\n\n  if (layers) {\n    if (Array.isArray(layers)) {\n      layers = new Collection(layers.slice(), {unique: true});\n    } else {\n      assert(layers instanceof Collection,\n        43); // Expected `layers` to be an array or a `Collection`\n      layers = layers;\n    }\n  } else {\n    layers = new Collection(undefined, {unique: true});\n  }\n\n  this.setLayers(layers);\n\n};\n\ninherits(LayerGroup, BaseLayer);\n\n\n/**\n * @private\n */\nLayerGroup.prototype.handleLayerChange_ = function() {\n  this.changed();\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n * @private\n */\nLayerGroup.prototype.handleLayersChanged_ = function(event) {\n  this.layersListenerKeys_.forEach(unlistenByKey);\n  this.layersListenerKeys_.length = 0;\n\n  const layers = this.getLayers();\n  this.layersListenerKeys_.push(\n    listen(layers, CollectionEventType.ADD, this.handleLayersAdd_, this),\n    listen(layers, CollectionEventType.REMOVE, this.handleLayersRemove_, this)\n  );\n\n  for (const id in this.listenerKeys_) {\n    this.listenerKeys_[id].forEach(unlistenByKey);\n  }\n  clear(this.listenerKeys_);\n\n  const layersArray = layers.getArray();\n  for (let i = 0, ii = layersArray.length; i < ii; i++) {\n    const layer = layersArray[i];\n    this.listenerKeys_[getUid(layer).toString()] = [\n      listen(layer, ObjectEventType.PROPERTYCHANGE, this.handleLayerChange_, this),\n      listen(layer, EventType.CHANGE, this.handleLayerChange_, this)\n    ];\n  }\n\n  this.changed();\n};\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} collectionEvent CollectionEvent.\n * @private\n */\nLayerGroup.prototype.handleLayersAdd_ = function(collectionEvent) {\n  const layer = /** @type {module:ol/layer/Base} */ (collectionEvent.element);\n  const key = getUid(layer).toString();\n  this.listenerKeys_[key] = [\n    listen(layer, ObjectEventType.PROPERTYCHANGE, this.handleLayerChange_, this),\n    listen(layer, EventType.CHANGE, this.handleLayerChange_, this)\n  ];\n  this.changed();\n};\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} collectionEvent CollectionEvent.\n * @private\n */\nLayerGroup.prototype.handleLayersRemove_ = function(collectionEvent) {\n  const layer = /** @type {module:ol/layer/Base} */ (collectionEvent.element);\n  const key = getUid(layer).toString();\n  this.listenerKeys_[key].forEach(unlistenByKey);\n  delete this.listenerKeys_[key];\n  this.changed();\n};\n\n\n/**\n * Returns the {@link module:ol/Collection collection} of {@link module:ol/layer/Layer~Layer layers}\n * in this group.\n * @return {!module:ol/Collection.<module:ol/layer/Base>} Collection of\n *   {@link module:ol/layer/Base layers} that are part of this group.\n * @observable\n * @api\n */\nLayerGroup.prototype.getLayers = function() {\n  return (\n    /** @type {!module:ol/Collection.<module:ol/layer/Base>} */ (this.get(Property.LAYERS))\n  );\n};\n\n\n/**\n * Set the {@link module:ol/Collection collection} of {@link module:ol/layer/Layer~Layer layers}\n * in this group.\n * @param {!module:ol/Collection.<module:ol/layer/Base>} layers Collection of\n *   {@link module:ol/layer/Base layers} that are part of this group.\n * @observable\n * @api\n */\nLayerGroup.prototype.setLayers = function(layers) {\n  this.set(Property.LAYERS, layers);\n};\n\n\n/**\n * @inheritDoc\n */\nLayerGroup.prototype.getLayersArray = function(opt_array) {\n  const array = opt_array !== undefined ? opt_array : [];\n  this.getLayers().forEach(function(layer) {\n    layer.getLayersArray(array);\n  });\n  return array;\n};\n\n\n/**\n * @inheritDoc\n */\nLayerGroup.prototype.getLayerStatesArray = function(opt_states) {\n  const states = opt_states !== undefined ? opt_states : [];\n\n  const pos = states.length;\n\n  this.getLayers().forEach(function(layer) {\n    layer.getLayerStatesArray(states);\n  });\n\n  const ownLayerState = this.getLayerState();\n  for (let i = pos, ii = states.length; i < ii; i++) {\n    const layerState = states[i];\n    layerState.opacity *= ownLayerState.opacity;\n    layerState.visible = layerState.visible && ownLayerState.visible;\n    layerState.maxResolution = Math.min(\n      layerState.maxResolution, ownLayerState.maxResolution);\n    layerState.minResolution = Math.max(\n      layerState.minResolution, ownLayerState.minResolution);\n    if (ownLayerState.extent !== undefined) {\n      if (layerState.extent !== undefined) {\n        layerState.extent = getIntersection(layerState.extent, ownLayerState.extent);\n      } else {\n        layerState.extent = ownLayerState.extent;\n      }\n    }\n  }\n\n  return states;\n};\n\n\n/**\n * @inheritDoc\n */\nLayerGroup.prototype.getSourceState = function() {\n  return SourceState.READY;\n};\n\nexport default LayerGroup;\n","/**\n * @module ol/size\n */\n\n\n/**\n * An array of numbers representing a size: `[width, height]`.\n * @typedef {Array.<number>} Size\n * @api\n */\n\n\n/**\n * Returns a buffered size.\n * @param {module:ol/size~Size} size Size.\n * @param {number} num The amount by which to buffer.\n * @param {module:ol/size~Size=} opt_size Optional reusable size array.\n * @return {module:ol/size~Size} The buffered size.\n */\nexport function buffer(size, num, opt_size) {\n  if (opt_size === undefined) {\n    opt_size = [0, 0];\n  }\n  opt_size[0] = size[0] + 2 * num;\n  opt_size[1] = size[1] + 2 * num;\n  return opt_size;\n}\n\n\n/**\n * Determines if a size has a positive area.\n * @param {module:ol/size~Size} size The size to test.\n * @return {boolean} The size has a positive area.\n */\nexport function hasArea(size) {\n  return size[0] > 0 && size[1] > 0;\n}\n\n\n/**\n * Returns a size scaled by a ratio. The result will be an array of integers.\n * @param {module:ol/size~Size} size Size.\n * @param {number} ratio Ratio.\n * @param {module:ol/size~Size=} opt_size Optional reusable size array.\n * @return {module:ol/size~Size} The scaled size.\n */\nexport function scale(size, ratio, opt_size) {\n  if (opt_size === undefined) {\n    opt_size = [0, 0];\n  }\n  opt_size[0] = (size[0] * ratio + 0.5) | 0;\n  opt_size[1] = (size[1] * ratio + 0.5) | 0;\n  return opt_size;\n}\n\n\n/**\n * Returns an `module:ol/size~Size` array for the passed in number (meaning: square) or\n * `module:ol/size~Size` array.\n * (meaning: non-square),\n * @param {number|module:ol/size~Size} size Width and height.\n * @param {module:ol/size~Size=} opt_size Optional reusable size array.\n * @return {module:ol/size~Size} Size.\n * @api\n */\nexport function toSize(size, opt_size) {\n  if (Array.isArray(size)) {\n    return size;\n  } else {\n    if (opt_size === undefined) {\n      opt_size = [size, size];\n    } else {\n      opt_size[0] = opt_size[1] = /** @type {number} */ (size);\n    }\n    return opt_size;\n  }\n}\n","/**\n * @module ol/PluggableMap\n */\nimport {getUid, inherits} from './util.js';\nimport Collection from './Collection.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport MapBrowserEvent from './MapBrowserEvent.js';\nimport MapBrowserEventHandler from './MapBrowserEventHandler.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapEvent from './MapEvent.js';\nimport MapEventType from './MapEventType.js';\nimport MapProperty from './MapProperty.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport TileQueue from './TileQueue.js';\nimport View from './View.js';\nimport ViewHint from './ViewHint.js';\nimport {assert} from './asserts.js';\nimport {removeNode} from './dom.js';\nimport {listen, unlistenByKey, unlisten} from './events.js';\nimport {stopPropagation} from './events/Event.js';\nimport EventType from './events/EventType.js';\nimport {createEmpty, clone, createOrUpdateEmpty, equals, getForViewAndSize, isEmpty} from './extent.js';\nimport {TRUE} from './functions.js';\nimport {DEVICE_PIXEL_RATIO, TOUCH} from './has.js';\nimport LayerGroup from './layer/Group.js';\nimport {hasArea} from './size.js';\nimport {DROP} from './structs/PriorityQueue.js';\nimport {create as createTransform, apply as applyTransform} from './transform.js';\n\n\n/**\n * State of the current frame. Only `pixelRatio`, `time` and `viewState` should\n * be used in applications.\n * @typedef {Object} FrameState\n * @property {number} pixelRatio The pixel ratio of the frame.\n * @property {number} time The time when rendering of the frame was requested.\n * @property {module:ol/View~State} viewState The state of the current view.\n * @property {boolean} animate\n * @property {module:ol/transform~Transform} coordinateToPixelTransform\n * @property {null|module:ol/extent~Extent} extent\n * @property {module:ol/coordinate~Coordinate} focus\n * @property {number} index\n * @property {Object.<number, module:ol/layer/Layer~State>} layerStates\n * @property {Array.<module:ol/layer/Layer~State>} layerStatesArray\n * @property {module:ol/transform~Transform} pixelToCoordinateTransform\n * @property {Array.<module:ol/PluggableMap~PostRenderFunction>} postRenderFunctions\n * @property {module:ol/size~Size} size\n * @property {!Object.<string, boolean>} skippedFeatureUids\n * @property {module:ol/TileQueue} tileQueue\n * @property {Object.<string, Object.<string, module:ol/TileRange>>} usedTiles\n * @property {Array.<number>} viewHints\n * @property {!Object.<string, Object.<string, boolean>>} wantedTiles\n */\n\n\n/**\n * @typedef {function(module:ol/PluggableMap, ?module:ol/PluggableMap~FrameState): boolean} PostRenderFunction\n */\n\n\n/**\n * @typedef {Object} AtPixelOptions\n * @property {((function(module:ol/layer/Layer): boolean)|undefined)} layerFilter Layer filter\n * function. The filter function will receive one argument, the\n * {@link module:ol/layer/Layer layer-candidate} and it should return a boolean value.\n * Only layers which are visible and for which this function returns `true`\n * will be tested for features. By default, all visible layers will be tested.\n * @property {number} [hitTolerance=0] Hit-detection tolerance in pixels. Pixels\n * inside the radius around the given position will be checked for features. This only\n * works for the canvas renderer and not for WebGL.\n */\n\n\n/**\n * @typedef {Object} MapOptionsInternal\n * @property {module:ol/Collection.<module:ol/control/Control>} [controls]\n * @property {module:ol/Collection.<module:ol/interaction/Interaction>} [interactions]\n * @property {Element|Document} keyboardEventTarget\n * @property {module:ol/Collection.<module:ol/Overlay>} overlays\n * @property {Object.<string, *>} values\n */\n\n\n/**\n * Object literal with config options for the map.\n * @typedef {Object} MapOptions\n * @property {module:ol/Collection.<module:ol/control/Control>|Array.<module:ol/control/Control>} [controls]\n * Controls initially added to the map. If not specified,\n * {@link module:ol/control/util~defaults} is used.\n * @property {number} [pixelRatio=window.devicePixelRatio] The ratio between\n * physical pixels and device-independent pixels (dips) on the device.\n * @property {module:ol/Collection.<module:ol/interaction/Interaction>|Array.<module:ol/interaction/Interaction>} [interactions]\n * Interactions that are initially added to the map. If not specified,\n * {@link module:ol/interaction~defaults} is used.\n * @property {Element|Document|string} [keyboardEventTarget] The element to\n * listen to keyboard events on. This determines when the `KeyboardPan` and\n * `KeyboardZoom` interactions trigger. For example, if this option is set to\n * `document` the keyboard interactions will always trigger. If this option is\n * not specified, the element the library listens to keyboard events on is the\n * map target (i.e. the user-provided div for the map). If this is not\n * `document`, the target element needs to be focused for key events to be\n * emitted, requiring that the target element has a `tabindex` attribute.\n * @property {Array.<module:ol/layer/Base>|module:ol/Collection.<module:ol/layer/Base>} [layers]\n * Layers. If this is not defined, a map with no layers will be rendered. Note\n * that layers are rendered in the order supplied, so if you want, for example,\n * a vector layer to appear on top of a tile layer, it must come after the tile\n * layer.\n * @property {number} [maxTilesLoading=16] Maximum number tiles to load\n * simultaneously.\n * @property {boolean} [loadTilesWhileAnimating=false] When set to `true`, tiles\n * will be loaded during animations. This may improve the user experience, but\n * can also make animations stutter on devices with slow memory.\n * @property {boolean} [loadTilesWhileInteracting=false] When set to `true`,\n * tiles will be loaded while interacting with the map. This may improve the\n * user experience, but can also make map panning and zooming choppy on devices\n * with slow memory.\n * @property {number} [moveTolerance=1] The minimum distance in pixels the\n * cursor must move to be detected as a map move event instead of a click.\n * Increasing this value can make it easier to click on the map.\n * @property {module:ol/Collection.<module:ol/Overlay>|Array.<module:ol/Overlay>} [overlays]\n * Overlays initially added to the map. By default, no overlays are added.\n * @property {Element|string} [target] The container for the map, either the\n * element itself or the `id` of the element. If not specified at construction\n * time, {@link module:ol/Map~Map#setTarget} must be called for the map to be\n * rendered.\n * @property {module:ol/View} [view] The map's view.  No layer sources will be\n * fetched unless this is specified at construction time or through\n * {@link module:ol/Map~Map#setView}.\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/PluggableMap~MapOptions} options Map options.\n * @fires module:ol/MapBrowserEvent~MapBrowserEvent\n * @fires module:ol/MapEvent~MapEvent\n * @fires module:ol/render/Event~RenderEvent#postcompose\n * @fires module:ol/render/Event~RenderEvent#precompose\n * @api\n */\nconst PluggableMap = function(options) {\n\n  BaseObject.call(this);\n\n  const optionsInternal = createOptionsInternal(options);\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxTilesLoading_ = options.maxTilesLoading !== undefined ? options.maxTilesLoading : 16;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.loadTilesWhileAnimating_ =\n      options.loadTilesWhileAnimating !== undefined ?\n        options.loadTilesWhileAnimating : false;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.loadTilesWhileInteracting_ =\n      options.loadTilesWhileInteracting !== undefined ?\n        options.loadTilesWhileInteracting : false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelRatio_ = options.pixelRatio !== undefined ?\n    options.pixelRatio : DEVICE_PIXEL_RATIO;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.animationDelayKey_;\n\n  /**\n   * @private\n   */\n  this.animationDelay_ = function() {\n    this.animationDelayKey_ = undefined;\n    this.renderFrame_.call(this, Date.now());\n  }.bind(this);\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.coordinateToPixelTransform_ = createTransform();\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.pixelToCoordinateTransform_ = createTransform();\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.frameIndex_ = 0;\n\n  /**\n   * @private\n   * @type {?module:ol/PluggableMap~FrameState}\n   */\n  this.frameState_ = null;\n\n  /**\n   * The extent at the previous 'moveend' event.\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.previousExtent_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.viewPropertyListenerKey_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.viewChangeListenerKey_ = null;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.layerGroupPropertyListenerKeys_ = null;\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.viewport_ = document.createElement('DIV');\n  this.viewport_.className = 'ol-viewport' + (TOUCH ? ' ol-touch' : '');\n  this.viewport_.style.position = 'relative';\n  this.viewport_.style.overflow = 'hidden';\n  this.viewport_.style.width = '100%';\n  this.viewport_.style.height = '100%';\n  // prevent page zoom on IE >= 10 browsers\n  this.viewport_.style.msTouchAction = 'none';\n  this.viewport_.style.touchAction = 'none';\n\n  /**\n   * @private\n   * @type {!Element}\n   */\n  this.overlayContainer_ = document.createElement('DIV');\n  this.overlayContainer_.className = 'ol-overlaycontainer';\n  this.viewport_.appendChild(this.overlayContainer_);\n\n  /**\n   * @private\n   * @type {!Element}\n   */\n  this.overlayContainerStopEvent_ = document.createElement('DIV');\n  this.overlayContainerStopEvent_.className = 'ol-overlaycontainer-stopevent';\n  const overlayEvents = [\n    EventType.CLICK,\n    EventType.DBLCLICK,\n    EventType.MOUSEDOWN,\n    EventType.TOUCHSTART,\n    EventType.MSPOINTERDOWN,\n    MapBrowserEventType.POINTERDOWN,\n    EventType.MOUSEWHEEL,\n    EventType.WHEEL\n  ];\n  for (let i = 0, ii = overlayEvents.length; i < ii; ++i) {\n    listen(this.overlayContainerStopEvent_, overlayEvents[i], stopPropagation);\n  }\n  this.viewport_.appendChild(this.overlayContainerStopEvent_);\n\n  /**\n   * @private\n   * @type {module:ol/MapBrowserEventHandler}\n   */\n  this.mapBrowserEventHandler_ = new MapBrowserEventHandler(this, options.moveTolerance);\n  for (const key in MapBrowserEventType) {\n    listen(this.mapBrowserEventHandler_, MapBrowserEventType[key],\n      this.handleMapBrowserEvent, this);\n  }\n\n  /**\n   * @private\n   * @type {Element|Document}\n   */\n  this.keyboardEventTarget_ = optionsInternal.keyboardEventTarget;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.keyHandlerKeys_ = null;\n\n  listen(this.viewport_, EventType.CONTEXTMENU, this.handleBrowserEvent, this);\n  listen(this.viewport_, EventType.WHEEL, this.handleBrowserEvent, this);\n  listen(this.viewport_, EventType.MOUSEWHEEL, this.handleBrowserEvent, this);\n\n  /**\n   * @type {module:ol/Collection.<module:ol/control/Control>}\n   * @protected\n   */\n  this.controls = optionsInternal.controls || new Collection();\n\n  /**\n   * @type {module:ol/Collection.<module:ol/interaction/Interaction>}\n   * @protected\n   */\n  this.interactions = optionsInternal.interactions || new Collection();\n\n  /**\n   * @type {module:ol/Collection.<module:ol/Overlay>}\n   * @private\n   */\n  this.overlays_ = optionsInternal.overlays;\n\n  /**\n   * A lookup of overlays by id.\n   * @private\n   * @type {Object.<string, module:ol/Overlay>}\n   */\n  this.overlayIdIndex_ = {};\n\n  /**\n   * @type {module:ol/renderer/Map}\n   * @private\n   */\n  this.renderer_ = this.createRenderer();\n\n  /**\n   * @type {function(Event)|undefined}\n   * @private\n   */\n  this.handleResize_;\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.focus_ = null;\n\n  /**\n   * @private\n   * @type {!Array.<module:ol/PluggableMap~PostRenderFunction>}\n   */\n  this.postRenderFunctions_ = [];\n\n  /**\n   * @private\n   * @type {module:ol/TileQueue}\n   */\n  this.tileQueue_ = new TileQueue(\n    this.getTilePriority.bind(this),\n    this.handleTileChange_.bind(this));\n\n  /**\n   * Uids of features to skip at rendering time.\n   * @type {Object.<string, boolean>}\n   * @private\n   */\n  this.skippedFeatureUids_ = {};\n\n  listen(\n    this, getChangeEventType(MapProperty.LAYERGROUP),\n    this.handleLayerGroupChanged_, this);\n  listen(this, getChangeEventType(MapProperty.VIEW),\n    this.handleViewChanged_, this);\n  listen(this, getChangeEventType(MapProperty.SIZE),\n    this.handleSizeChanged_, this);\n  listen(this, getChangeEventType(MapProperty.TARGET),\n    this.handleTargetChanged_, this);\n\n  // setProperties will trigger the rendering of the map if the map\n  // is \"defined\" already.\n  this.setProperties(optionsInternal.values);\n\n  this.controls.forEach(\n    /**\n     * @param {module:ol/control/Control} control Control.\n     * @this {module:ol/PluggableMap}\n     */\n    (function(control) {\n      control.setMap(this);\n    }).bind(this));\n\n  listen(this.controls, CollectionEventType.ADD,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      event.element.setMap(this);\n    }, this);\n\n  listen(this.controls, CollectionEventType.REMOVE,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      event.element.setMap(null);\n    }, this);\n\n  this.interactions.forEach(\n    /**\n     * @param {module:ol/interaction/Interaction} interaction Interaction.\n     * @this {module:ol/PluggableMap}\n     */\n    (function(interaction) {\n      interaction.setMap(this);\n    }).bind(this));\n\n  listen(this.interactions, CollectionEventType.ADD,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      event.element.setMap(this);\n    }, this);\n\n  listen(this.interactions, CollectionEventType.REMOVE,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      event.element.setMap(null);\n    }, this);\n\n  this.overlays_.forEach(this.addOverlayInternal_.bind(this));\n\n  listen(this.overlays_, CollectionEventType.ADD,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      this.addOverlayInternal_(/** @type {module:ol/Overlay} */ (event.element));\n    }, this);\n\n  listen(this.overlays_, CollectionEventType.REMOVE,\n    /**\n     * @param {module:ol/Collection~CollectionEvent} event CollectionEvent.\n     */\n    function(event) {\n      const overlay = /** @type {module:ol/Overlay} */ (event.element);\n      const id = overlay.getId();\n      if (id !== undefined) {\n        delete this.overlayIdIndex_[id.toString()];\n      }\n      event.element.setMap(null);\n    }, this);\n\n};\n\ninherits(PluggableMap, BaseObject);\n\n\nPluggableMap.prototype.createRenderer = function() {\n  throw new Error('Use a map type that has a createRenderer method');\n};\n\n\n/**\n * Add the given control to the map.\n * @param {module:ol/control/Control} control Control.\n * @api\n */\nPluggableMap.prototype.addControl = function(control) {\n  this.getControls().push(control);\n};\n\n\n/**\n * Add the given interaction to the map.\n * @param {module:ol/interaction/Interaction} interaction Interaction to add.\n * @api\n */\nPluggableMap.prototype.addInteraction = function(interaction) {\n  this.getInteractions().push(interaction);\n};\n\n\n/**\n * Adds the given layer to the top of this map. If you want to add a layer\n * elsewhere in the stack, use `getLayers()` and the methods available on\n * {@link module:ol/Collection~Collection}.\n * @param {module:ol/layer/Base} layer Layer.\n * @api\n */\nPluggableMap.prototype.addLayer = function(layer) {\n  const layers = this.getLayerGroup().getLayers();\n  layers.push(layer);\n};\n\n\n/**\n * Add the given overlay to the map.\n * @param {module:ol/Overlay} overlay Overlay.\n * @api\n */\nPluggableMap.prototype.addOverlay = function(overlay) {\n  this.getOverlays().push(overlay);\n};\n\n\n/**\n * This deals with map's overlay collection changes.\n * @param {module:ol/Overlay} overlay Overlay.\n * @private\n */\nPluggableMap.prototype.addOverlayInternal_ = function(overlay) {\n  const id = overlay.getId();\n  if (id !== undefined) {\n    this.overlayIdIndex_[id.toString()] = overlay;\n  }\n  overlay.setMap(this);\n};\n\n\n/**\n *\n * @inheritDoc\n */\nPluggableMap.prototype.disposeInternal = function() {\n  this.mapBrowserEventHandler_.dispose();\n  unlisten(this.viewport_, EventType.CONTEXTMENU, this.handleBrowserEvent, this);\n  unlisten(this.viewport_, EventType.WHEEL, this.handleBrowserEvent, this);\n  unlisten(this.viewport_, EventType.MOUSEWHEEL, this.handleBrowserEvent, this);\n  if (this.handleResize_ !== undefined) {\n    removeEventListener(EventType.RESIZE, this.handleResize_, false);\n    this.handleResize_ = undefined;\n  }\n  if (this.animationDelayKey_) {\n    cancelAnimationFrame(this.animationDelayKey_);\n    this.animationDelayKey_ = undefined;\n  }\n  this.setTarget(null);\n  BaseObject.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * Detect features that intersect a pixel on the viewport, and execute a\n * callback with each intersecting feature. Layers included in the detection can\n * be configured through the `layerFilter` option in `opt_options`.\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {function(this: S, (module:ol/Feature|module:ol/render/Feature),\n *     module:ol/layer/Layer): T} callback Feature callback. The callback will be\n *     called with two arguments. The first argument is one\n *     {@link module:ol/Feature feature} or\n *     {@link module:ol/render/Feature render feature} at the pixel, the second is\n *     the {@link module:ol/layer/Layer layer} of the feature and will be null for\n *     unmanaged layers. To stop detection, callback functions can return a\n *     truthy value.\n * @param {module:ol/PluggableMap~AtPixelOptions=} opt_options Optional options.\n * @return {T|undefined} Callback result, i.e. the return value of last\n * callback execution, or the first truthy callback return value.\n * @template S,T\n * @api\n */\nPluggableMap.prototype.forEachFeatureAtPixel = function(pixel, callback, opt_options) {\n  if (!this.frameState_) {\n    return;\n  }\n  const coordinate = this.getCoordinateFromPixel(pixel);\n  opt_options = opt_options !== undefined ? opt_options : {};\n  const hitTolerance = opt_options.hitTolerance !== undefined ?\n    opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n  const layerFilter = opt_options.layerFilter !== undefined ?\n    opt_options.layerFilter : TRUE;\n  return this.renderer_.forEachFeatureAtCoordinate(\n    coordinate, this.frameState_, hitTolerance, callback, null,\n    layerFilter, null);\n};\n\n\n/**\n * Get all features that intersect a pixel on the viewport.\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {module:ol/PluggableMap~AtPixelOptions=} opt_options Optional options.\n * @return {Array.<module:ol/Feature|module:ol/render/Feature>} The detected features or\n * `null` if none were found.\n * @api\n */\nPluggableMap.prototype.getFeaturesAtPixel = function(pixel, opt_options) {\n  let features = null;\n  this.forEachFeatureAtPixel(pixel, function(feature) {\n    if (!features) {\n      features = [];\n    }\n    features.push(feature);\n  }, opt_options);\n  return features;\n};\n\n/**\n * Detect layers that have a color value at a pixel on the viewport, and\n * execute a callback with each matching layer. Layers included in the\n * detection can be configured through `opt_layerFilter`.\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {function(this: S, module:ol/layer/Layer, (Uint8ClampedArray|Uint8Array)): T} callback\n *     Layer callback. This callback will receive two arguments: first is the\n *     {@link module:ol/layer/Layer layer}, second argument is an array representing\n *     [R, G, B, A] pixel values (0 - 255) and will be `null` for layer types\n *     that do not currently support this argument. To stop detection, callback\n *     functions can return a truthy value.\n * @param {module:ol/PluggableMap~AtPixelOptions=} opt_options Configuration options.\n * @return {T|undefined} Callback result, i.e. the return value of last\n * callback execution, or the first truthy callback return value.\n * @template S,T\n * @api\n */\nPluggableMap.prototype.forEachLayerAtPixel = function(pixel, callback, opt_options) {\n  if (!this.frameState_) {\n    return;\n  }\n  const options = opt_options || {};\n  const hitTolerance = options.hitTolerance !== undefined ?\n    opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n  const layerFilter = options.layerFilter || TRUE;\n  return this.renderer_.forEachLayerAtPixel(\n    pixel, this.frameState_, hitTolerance, callback, null, layerFilter, null);\n};\n\n\n/**\n * Detect if features intersect a pixel on the viewport. Layers included in the\n * detection can be configured through `opt_layerFilter`.\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {module:ol/PluggableMap~AtPixelOptions=} opt_options Optional options.\n * @return {boolean} Is there a feature at the given pixel?\n * @template U\n * @api\n */\nPluggableMap.prototype.hasFeatureAtPixel = function(pixel, opt_options) {\n  if (!this.frameState_) {\n    return false;\n  }\n  const coordinate = this.getCoordinateFromPixel(pixel);\n  opt_options = opt_options !== undefined ? opt_options : {};\n  const layerFilter = opt_options.layerFilter !== undefined ? opt_options.layerFilter : TRUE;\n  const hitTolerance = opt_options.hitTolerance !== undefined ?\n    opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n  return this.renderer_.hasFeatureAtCoordinate(\n    coordinate, this.frameState_, hitTolerance, layerFilter, null);\n};\n\n\n/**\n * Returns the coordinate in view projection for a browser event.\n * @param {Event} event Event.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n * @api\n */\nPluggableMap.prototype.getEventCoordinate = function(event) {\n  return this.getCoordinateFromPixel(this.getEventPixel(event));\n};\n\n\n/**\n * Returns the map pixel position for a browser event relative to the viewport.\n * @param {Event} event Event.\n * @return {module:ol~Pixel} Pixel.\n * @api\n */\nPluggableMap.prototype.getEventPixel = function(event) {\n  const viewportPosition = this.viewport_.getBoundingClientRect();\n  const eventPosition = event.changedTouches ? event.changedTouches[0] : event;\n  return [\n    eventPosition.clientX - viewportPosition.left,\n    eventPosition.clientY - viewportPosition.top\n  ];\n};\n\n\n/**\n * Get the target in which this map is rendered.\n * Note that this returns what is entered as an option or in setTarget:\n * if that was an element, it returns an element; if a string, it returns that.\n * @return {Element|string|undefined} The Element or id of the Element that the\n *     map is rendered in.\n * @observable\n * @api\n */\nPluggableMap.prototype.getTarget = function() {\n  return /** @type {Element|string|undefined} */ (this.get(MapProperty.TARGET));\n};\n\n\n/**\n * Get the DOM element into which this map is rendered. In contrast to\n * `getTarget` this method always return an `Element`, or `null` if the\n * map has no target.\n * @return {Element} The element that the map is rendered in.\n * @api\n */\nPluggableMap.prototype.getTargetElement = function() {\n  const target = this.getTarget();\n  if (target !== undefined) {\n    return typeof target === 'string' ? document.getElementById(target) : target;\n  } else {\n    return null;\n  }\n};\n\n\n/**\n * Get the coordinate for a given pixel.  This returns a coordinate in the\n * map view projection.\n * @param {module:ol~Pixel} pixel Pixel position in the map viewport.\n * @return {module:ol/coordinate~Coordinate} The coordinate for the pixel position.\n * @api\n */\nPluggableMap.prototype.getCoordinateFromPixel = function(pixel) {\n  const frameState = this.frameState_;\n  if (!frameState) {\n    return null;\n  } else {\n    return applyTransform(frameState.pixelToCoordinateTransform, pixel.slice());\n  }\n};\n\n\n/**\n * Get the map controls. Modifying this collection changes the controls\n * associated with the map.\n * @return {module:ol/Collection.<module:ol/control/Control>} Controls.\n * @api\n */\nPluggableMap.prototype.getControls = function() {\n  return this.controls;\n};\n\n\n/**\n * Get the map overlays. Modifying this collection changes the overlays\n * associated with the map.\n * @return {module:ol/Collection.<module:ol/Overlay>} Overlays.\n * @api\n */\nPluggableMap.prototype.getOverlays = function() {\n  return this.overlays_;\n};\n\n\n/**\n * Get an overlay by its identifier (the value returned by overlay.getId()).\n * Note that the index treats string and numeric identifiers as the same. So\n * `map.getOverlayById(2)` will return an overlay with id `'2'` or `2`.\n * @param {string|number} id Overlay identifier.\n * @return {module:ol/Overlay} Overlay.\n * @api\n */\nPluggableMap.prototype.getOverlayById = function(id) {\n  const overlay = this.overlayIdIndex_[id.toString()];\n  return overlay !== undefined ? overlay : null;\n};\n\n\n/**\n * Get the map interactions. Modifying this collection changes the interactions\n * associated with the map.\n *\n * Interactions are used for e.g. pan, zoom and rotate.\n * @return {module:ol/Collection.<module:ol/interaction/Interaction>} Interactions.\n * @api\n */\nPluggableMap.prototype.getInteractions = function() {\n  return this.interactions;\n};\n\n\n/**\n * Get the layergroup associated with this map.\n * @return {module:ol/layer/Group} A layer group containing the layers in this map.\n * @observable\n * @api\n */\nPluggableMap.prototype.getLayerGroup = function() {\n  return (\n    /** @type {module:ol/layer/Group} */ (this.get(MapProperty.LAYERGROUP))\n  );\n};\n\n\n/**\n * Get the collection of layers associated with this map.\n * @return {!module:ol/Collection.<module:ol/layer/Base>} Layers.\n * @api\n */\nPluggableMap.prototype.getLayers = function() {\n  const layers = this.getLayerGroup().getLayers();\n  return layers;\n};\n\n\n/**\n * Get the pixel for a coordinate.  This takes a coordinate in the map view\n * projection and returns the corresponding pixel.\n * @param {module:ol/coordinate~Coordinate} coordinate A map coordinate.\n * @return {module:ol~Pixel} A pixel position in the map viewport.\n * @api\n */\nPluggableMap.prototype.getPixelFromCoordinate = function(coordinate) {\n  const frameState = this.frameState_;\n  if (!frameState) {\n    return null;\n  } else {\n    return applyTransform(frameState.coordinateToPixelTransform, coordinate.slice(0, 2));\n  }\n};\n\n\n/**\n * Get the map renderer.\n * @return {module:ol/renderer/Map} Renderer\n */\nPluggableMap.prototype.getRenderer = function() {\n  return this.renderer_;\n};\n\n\n/**\n * Get the size of this map.\n * @return {module:ol/size~Size|undefined} The size in pixels of the map in the DOM.\n * @observable\n * @api\n */\nPluggableMap.prototype.getSize = function() {\n  return (\n    /** @type {module:ol/size~Size|undefined} */ (this.get(MapProperty.SIZE))\n  );\n};\n\n\n/**\n * Get the view associated with this map. A view manages properties such as\n * center and resolution.\n * @return {module:ol/View} The view that controls this map.\n * @observable\n * @api\n */\nPluggableMap.prototype.getView = function() {\n  return (\n    /** @type {module:ol/View} */ (this.get(MapProperty.VIEW))\n  );\n};\n\n\n/**\n * Get the element that serves as the map viewport.\n * @return {Element} Viewport.\n * @api\n */\nPluggableMap.prototype.getViewport = function() {\n  return this.viewport_;\n};\n\n\n/**\n * Get the element that serves as the container for overlays.  Elements added to\n * this container will let mousedown and touchstart events through to the map,\n * so clicks and gestures on an overlay will trigger {@link module:ol/MapBrowserEvent~MapBrowserEvent}\n * events.\n * @return {!Element} The map's overlay container.\n */\nPluggableMap.prototype.getOverlayContainer = function() {\n  return this.overlayContainer_;\n};\n\n\n/**\n * Get the element that serves as a container for overlays that don't allow\n * event propagation. Elements added to this container won't let mousedown and\n * touchstart events through to the map, so clicks and gestures on an overlay\n * don't trigger any {@link module:ol/MapBrowserEvent~MapBrowserEvent}.\n * @return {!Element} The map's overlay container that stops events.\n */\nPluggableMap.prototype.getOverlayContainerStopEvent = function() {\n  return this.overlayContainerStopEvent_;\n};\n\n\n/**\n * @param {module:ol/Tile} tile Tile.\n * @param {string} tileSourceKey Tile source key.\n * @param {module:ol/coordinate~Coordinate} tileCenter Tile center.\n * @param {number} tileResolution Tile resolution.\n * @return {number} Tile priority.\n */\nPluggableMap.prototype.getTilePriority = function(tile, tileSourceKey, tileCenter, tileResolution) {\n  // Filter out tiles at higher zoom levels than the current zoom level, or that\n  // are outside the visible extent.\n  const frameState = this.frameState_;\n  if (!frameState || !(tileSourceKey in frameState.wantedTiles)) {\n    return DROP;\n  }\n  if (!frameState.wantedTiles[tileSourceKey][tile.getKey()]) {\n    return DROP;\n  }\n  // Prioritize the highest zoom level tiles closest to the focus.\n  // Tiles at higher zoom levels are prioritized using Math.log(tileResolution).\n  // Within a zoom level, tiles are prioritized by the distance in pixels\n  // between the center of the tile and the focus.  The factor of 65536 means\n  // that the prioritization should behave as desired for tiles up to\n  // 65536 * Math.log(2) = 45426 pixels from the focus.\n  const deltaX = tileCenter[0] - frameState.focus[0];\n  const deltaY = tileCenter[1] - frameState.focus[1];\n  return 65536 * Math.log(tileResolution) +\n      Math.sqrt(deltaX * deltaX + deltaY * deltaY) / tileResolution;\n};\n\n\n/**\n * @param {Event} browserEvent Browser event.\n * @param {string=} opt_type Type.\n */\nPluggableMap.prototype.handleBrowserEvent = function(browserEvent, opt_type) {\n  const type = opt_type || browserEvent.type;\n  const mapBrowserEvent = new MapBrowserEvent(type, this, browserEvent);\n  this.handleMapBrowserEvent(mapBrowserEvent);\n};\n\n\n/**\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent The event to handle.\n */\nPluggableMap.prototype.handleMapBrowserEvent = function(mapBrowserEvent) {\n  if (!this.frameState_) {\n    // With no view defined, we cannot translate pixels into geographical\n    // coordinates so interactions cannot be used.\n    return;\n  }\n  this.focus_ = mapBrowserEvent.coordinate;\n  mapBrowserEvent.frameState = this.frameState_;\n  const interactionsArray = this.getInteractions().getArray();\n  if (this.dispatchEvent(mapBrowserEvent) !== false) {\n    for (let i = interactionsArray.length - 1; i >= 0; i--) {\n      const interaction = interactionsArray[i];\n      if (!interaction.getActive()) {\n        continue;\n      }\n      const cont = interaction.handleEvent(mapBrowserEvent);\n      if (!cont) {\n        break;\n      }\n    }\n  }\n};\n\n\n/**\n * @protected\n */\nPluggableMap.prototype.handlePostRender = function() {\n\n  const frameState = this.frameState_;\n\n  // Manage the tile queue\n  // Image loads are expensive and a limited resource, so try to use them\n  // efficiently:\n  // * When the view is static we allow a large number of parallel tile loads\n  //   to complete the frame as quickly as possible.\n  // * When animating or interacting, image loads can cause janks, so we reduce\n  //   the maximum number of loads per frame and limit the number of parallel\n  //   tile loads to remain reactive to view changes and to reduce the chance of\n  //   loading tiles that will quickly disappear from view.\n  const tileQueue = this.tileQueue_;\n  if (!tileQueue.isEmpty()) {\n    let maxTotalLoading = this.maxTilesLoading_;\n    let maxNewLoads = maxTotalLoading;\n    if (frameState) {\n      const hints = frameState.viewHints;\n      if (hints[ViewHint.ANIMATING]) {\n        maxTotalLoading = this.loadTilesWhileAnimating_ ? 8 : 0;\n        maxNewLoads = 2;\n      }\n      if (hints[ViewHint.INTERACTING]) {\n        maxTotalLoading = this.loadTilesWhileInteracting_ ? 8 : 0;\n        maxNewLoads = 2;\n      }\n    }\n    if (tileQueue.getTilesLoading() < maxTotalLoading) {\n      tileQueue.reprioritize(); // FIXME only call if view has changed\n      tileQueue.loadMoreTiles(maxTotalLoading, maxNewLoads);\n    }\n  }\n\n  const postRenderFunctions = this.postRenderFunctions_;\n  for (let i = 0, ii = postRenderFunctions.length; i < ii; ++i) {\n    postRenderFunctions[i](this, frameState);\n  }\n  postRenderFunctions.length = 0;\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleSizeChanged_ = function() {\n  this.render();\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleTargetChanged_ = function() {\n  // target may be undefined, null, a string or an Element.\n  // If it's a string we convert it to an Element before proceeding.\n  // If it's not now an Element we remove the viewport from the DOM.\n  // If it's an Element we append the viewport element to it.\n\n  let targetElement;\n  if (this.getTarget()) {\n    targetElement = this.getTargetElement();\n  }\n\n  if (this.keyHandlerKeys_) {\n    for (let i = 0, ii = this.keyHandlerKeys_.length; i < ii; ++i) {\n      unlistenByKey(this.keyHandlerKeys_[i]);\n    }\n    this.keyHandlerKeys_ = null;\n  }\n\n  if (!targetElement) {\n    this.renderer_.removeLayerRenderers();\n    removeNode(this.viewport_);\n    if (this.handleResize_ !== undefined) {\n      removeEventListener(EventType.RESIZE, this.handleResize_, false);\n      this.handleResize_ = undefined;\n    }\n  } else {\n    targetElement.appendChild(this.viewport_);\n\n    const keyboardEventTarget = !this.keyboardEventTarget_ ?\n      targetElement : this.keyboardEventTarget_;\n    this.keyHandlerKeys_ = [\n      listen(keyboardEventTarget, EventType.KEYDOWN, this.handleBrowserEvent, this),\n      listen(keyboardEventTarget, EventType.KEYPRESS, this.handleBrowserEvent, this)\n    ];\n\n    if (!this.handleResize_) {\n      this.handleResize_ = this.updateSize.bind(this);\n      addEventListener(EventType.RESIZE, this.handleResize_, false);\n    }\n  }\n\n  this.updateSize();\n  // updateSize calls setSize, so no need to call this.render\n  // ourselves here.\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleTileChange_ = function() {\n  this.render();\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleViewPropertyChanged_ = function() {\n  this.render();\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleViewChanged_ = function() {\n  if (this.viewPropertyListenerKey_) {\n    unlistenByKey(this.viewPropertyListenerKey_);\n    this.viewPropertyListenerKey_ = null;\n  }\n  if (this.viewChangeListenerKey_) {\n    unlistenByKey(this.viewChangeListenerKey_);\n    this.viewChangeListenerKey_ = null;\n  }\n  const view = this.getView();\n  if (view) {\n    this.viewport_.setAttribute('data-view', getUid(view));\n    this.viewPropertyListenerKey_ = listen(\n      view, ObjectEventType.PROPERTYCHANGE,\n      this.handleViewPropertyChanged_, this);\n    this.viewChangeListenerKey_ = listen(\n      view, EventType.CHANGE,\n      this.handleViewPropertyChanged_, this);\n  }\n  this.render();\n};\n\n\n/**\n * @private\n */\nPluggableMap.prototype.handleLayerGroupChanged_ = function() {\n  if (this.layerGroupPropertyListenerKeys_) {\n    this.layerGroupPropertyListenerKeys_.forEach(unlistenByKey);\n    this.layerGroupPropertyListenerKeys_ = null;\n  }\n  const layerGroup = this.getLayerGroup();\n  if (layerGroup) {\n    this.layerGroupPropertyListenerKeys_ = [\n      listen(\n        layerGroup, ObjectEventType.PROPERTYCHANGE,\n        this.render, this),\n      listen(\n        layerGroup, EventType.CHANGE,\n        this.render, this)\n    ];\n  }\n  this.render();\n};\n\n\n/**\n * @return {boolean} Is rendered.\n */\nPluggableMap.prototype.isRendered = function() {\n  return !!this.frameState_;\n};\n\n\n/**\n * Requests an immediate render in a synchronous manner.\n * @api\n */\nPluggableMap.prototype.renderSync = function() {\n  if (this.animationDelayKey_) {\n    cancelAnimationFrame(this.animationDelayKey_);\n  }\n  this.animationDelay_();\n};\n\n\n/**\n * Request a map rendering (at the next animation frame).\n * @api\n */\nPluggableMap.prototype.render = function() {\n  if (this.animationDelayKey_ === undefined) {\n    this.animationDelayKey_ = requestAnimationFrame(this.animationDelay_);\n  }\n};\n\n\n/**\n * Remove the given control from the map.\n * @param {module:ol/control/Control} control Control.\n * @return {module:ol/control/Control|undefined} The removed control (or undefined\n *     if the control was not found).\n * @api\n */\nPluggableMap.prototype.removeControl = function(control) {\n  return this.getControls().remove(control);\n};\n\n\n/**\n * Remove the given interaction from the map.\n * @param {module:ol/interaction/Interaction} interaction Interaction to remove.\n * @return {module:ol/interaction/Interaction|undefined} The removed interaction (or\n *     undefined if the interaction was not found).\n * @api\n */\nPluggableMap.prototype.removeInteraction = function(interaction) {\n  return this.getInteractions().remove(interaction);\n};\n\n\n/**\n * Removes the given layer from the map.\n * @param {module:ol/layer/Base} layer Layer.\n * @return {module:ol/layer/Base|undefined} The removed layer (or undefined if the\n *     layer was not found).\n * @api\n */\nPluggableMap.prototype.removeLayer = function(layer) {\n  const layers = this.getLayerGroup().getLayers();\n  return layers.remove(layer);\n};\n\n\n/**\n * Remove the given overlay from the map.\n * @param {module:ol/Overlay} overlay Overlay.\n * @return {module:ol/Overlay|undefined} The removed overlay (or undefined\n *     if the overlay was not found).\n * @api\n */\nPluggableMap.prototype.removeOverlay = function(overlay) {\n  return this.getOverlays().remove(overlay);\n};\n\n\n/**\n * @param {number} time Time.\n * @private\n */\nPluggableMap.prototype.renderFrame_ = function(time) {\n  let viewState;\n\n  const size = this.getSize();\n  const view = this.getView();\n  const extent = createEmpty();\n  const previousFrameState = this.frameState_;\n  /** @type {?module:ol/PluggableMap~FrameState} */\n  let frameState = null;\n  if (size !== undefined && hasArea(size) && view && view.isDef()) {\n    const viewHints = view.getHints(this.frameState_ ? this.frameState_.viewHints : undefined);\n    const layerStatesArray = this.getLayerGroup().getLayerStatesArray();\n    const layerStates = {};\n    for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n      layerStates[getUid(layerStatesArray[i].layer)] = layerStatesArray[i];\n    }\n    viewState = view.getState();\n    let focus = this.focus_;\n    if (!focus) {\n      focus = viewState.center;\n      const pixelResolution = viewState.resolution / this.pixelRatio_;\n      focus[0] = Math.round(focus[0] / pixelResolution) * pixelResolution;\n      focus[1] = Math.round(focus[1] / pixelResolution) * pixelResolution;\n    }\n    frameState = /** @type {module:ol/PluggableMap~FrameState} */ ({\n      animate: false,\n      coordinateToPixelTransform: this.coordinateToPixelTransform_,\n      extent: extent,\n      focus: focus,\n      index: this.frameIndex_++,\n      layerStates: layerStates,\n      layerStatesArray: layerStatesArray,\n      pixelRatio: this.pixelRatio_,\n      pixelToCoordinateTransform: this.pixelToCoordinateTransform_,\n      postRenderFunctions: [],\n      size: size,\n      skippedFeatureUids: this.skippedFeatureUids_,\n      tileQueue: this.tileQueue_,\n      time: time,\n      usedTiles: {},\n      viewState: viewState,\n      viewHints: viewHints,\n      wantedTiles: {}\n    });\n  }\n\n  if (frameState) {\n    frameState.extent = getForViewAndSize(viewState.center,\n      viewState.resolution, viewState.rotation, frameState.size, extent);\n  }\n\n  this.frameState_ = frameState;\n  this.renderer_.renderFrame(frameState);\n\n  if (frameState) {\n    if (frameState.animate) {\n      this.render();\n    }\n    Array.prototype.push.apply(this.postRenderFunctions_, frameState.postRenderFunctions);\n\n    if (previousFrameState) {\n      const moveStart = !this.previousExtent_ ||\n                  (!isEmpty(this.previousExtent_) &&\n                  !equals(frameState.extent, this.previousExtent_));\n      if (moveStart) {\n        this.dispatchEvent(\n          new MapEvent(MapEventType.MOVESTART, this, previousFrameState));\n        this.previousExtent_ = createOrUpdateEmpty(this.previousExtent_);\n      }\n    }\n\n    const idle = this.previousExtent_ &&\n        !frameState.viewHints[ViewHint.ANIMATING] &&\n        !frameState.viewHints[ViewHint.INTERACTING] &&\n        !equals(frameState.extent, this.previousExtent_);\n\n    if (idle) {\n      this.dispatchEvent(new MapEvent(MapEventType.MOVEEND, this, frameState));\n      clone(frameState.extent, this.previousExtent_);\n    }\n  }\n\n  this.dispatchEvent(new MapEvent(MapEventType.POSTRENDER, this, frameState));\n\n  setTimeout(this.handlePostRender.bind(this), 0);\n\n};\n\n\n/**\n * Sets the layergroup of this map.\n * @param {module:ol/layer/Group} layerGroup A layer group containing the layers in this map.\n * @observable\n * @api\n */\nPluggableMap.prototype.setLayerGroup = function(layerGroup) {\n  this.set(MapProperty.LAYERGROUP, layerGroup);\n};\n\n\n/**\n * Set the size of this map.\n * @param {module:ol/size~Size|undefined} size The size in pixels of the map in the DOM.\n * @observable\n * @api\n */\nPluggableMap.prototype.setSize = function(size) {\n  this.set(MapProperty.SIZE, size);\n};\n\n\n/**\n * Set the target element to render this map into.\n * @param {Element|string|undefined} target The Element or id of the Element\n *     that the map is rendered in.\n * @observable\n * @api\n */\nPluggableMap.prototype.setTarget = function(target) {\n  this.set(MapProperty.TARGET, target);\n};\n\n\n/**\n * Set the view for this map.\n * @param {module:ol/View} view The view that controls this map.\n * @observable\n * @api\n */\nPluggableMap.prototype.setView = function(view) {\n  this.set(MapProperty.VIEW, view);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n */\nPluggableMap.prototype.skipFeature = function(feature) {\n  const featureUid = getUid(feature).toString();\n  this.skippedFeatureUids_[featureUid] = true;\n  this.render();\n};\n\n\n/**\n * Force a recalculation of the map viewport size.  This should be called when\n * third-party code changes the size of the map viewport.\n * @api\n */\nPluggableMap.prototype.updateSize = function() {\n  const targetElement = this.getTargetElement();\n\n  if (!targetElement) {\n    this.setSize(undefined);\n  } else {\n    const computedStyle = getComputedStyle(targetElement);\n    this.setSize([\n      targetElement.offsetWidth -\n          parseFloat(computedStyle['borderLeftWidth']) -\n          parseFloat(computedStyle['paddingLeft']) -\n          parseFloat(computedStyle['paddingRight']) -\n          parseFloat(computedStyle['borderRightWidth']),\n      targetElement.offsetHeight -\n          parseFloat(computedStyle['borderTopWidth']) -\n          parseFloat(computedStyle['paddingTop']) -\n          parseFloat(computedStyle['paddingBottom']) -\n          parseFloat(computedStyle['borderBottomWidth'])\n    ]);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n */\nPluggableMap.prototype.unskipFeature = function(feature) {\n  const featureUid = getUid(feature).toString();\n  delete this.skippedFeatureUids_[featureUid];\n  this.render();\n};\n\n\n/**\n * @param {MapOptions} options Map options.\n * @return {module:ol/PluggableMap~MapOptionsInternal} Internal map options.\n */\nfunction createOptionsInternal(options) {\n\n  /**\n   * @type {Element|Document}\n   */\n  let keyboardEventTarget = null;\n  if (options.keyboardEventTarget !== undefined) {\n    keyboardEventTarget = typeof options.keyboardEventTarget === 'string' ?\n      document.getElementById(options.keyboardEventTarget) :\n      options.keyboardEventTarget;\n  }\n\n  /**\n   * @type {Object.<string, *>}\n   */\n  const values = {};\n\n  const layerGroup = (options.layers instanceof LayerGroup) ?\n    options.layers : new LayerGroup({layers: options.layers});\n  values[MapProperty.LAYERGROUP] = layerGroup;\n\n  values[MapProperty.TARGET] = options.target;\n\n  values[MapProperty.VIEW] = options.view !== undefined ?\n    options.view : new View();\n\n  let controls;\n  if (options.controls !== undefined) {\n    if (Array.isArray(options.controls)) {\n      controls = new Collection(options.controls.slice());\n    } else {\n      assert(options.controls instanceof Collection,\n        47); // Expected `controls` to be an array or an `module:ol/Collection~Collection`\n      controls = options.controls;\n    }\n  }\n\n  let interactions;\n  if (options.interactions !== undefined) {\n    if (Array.isArray(options.interactions)) {\n      interactions = new Collection(options.interactions.slice());\n    } else {\n      assert(options.interactions instanceof Collection,\n        48); // Expected `interactions` to be an array or an `module:ol/Collection~Collection`\n      interactions = options.interactions;\n    }\n  }\n\n  let overlays;\n  if (options.overlays !== undefined) {\n    if (Array.isArray(options.overlays)) {\n      overlays = new Collection(options.overlays.slice());\n    } else {\n      assert(options.overlays instanceof Collection,\n        49); // Expected `overlays` to be an array or an `module:ol/Collection~Collection`\n      overlays = options.overlays;\n    }\n  } else {\n    overlays = new Collection();\n  }\n\n  return {\n    controls: controls,\n    interactions: interactions,\n    keyboardEventTarget: keyboardEventTarget,\n    overlays: overlays,\n    values: values\n  };\n\n}\nexport default PluggableMap;\n","/**\n * @module ol/control/Control\n */\nimport {inherits} from '../util.js';\nimport {UNDEFINED} from '../functions.js';\nimport MapEventType from '../MapEventType.js';\nimport BaseObject from '../Object.js';\nimport {removeNode} from '../dom.js';\nimport {listen, unlistenByKey} from '../events.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {Element} [element] The element is the control's\n * container element. This only needs to be specified if you're developing\n * a custom control.\n * @property {function(module:ol/MapEvent)} [render] Function called when\n * the control should be re-rendered. This is called in a `requestAnimationFrame`\n * callback.\n * @property {Element|string} [target] Specify a target if you want\n * the control to be rendered outside of the map's viewport.\n */\n\n\n/**\n * @classdesc\n * A control is a visible widget with a DOM element in a fixed position on the\n * screen. They can involve user input (buttons), or be informational only;\n * the position is determined using CSS. By default these are placed in the\n * container with CSS class name `ol-overlaycontainer-stopevent`, but can use\n * any outside DOM element.\n *\n * This is the base class for controls. You can use it for simple custom\n * controls by creating the element with listeners, creating an instance:\n * ```js\n * var myControl = new Control({element: myElement});\n * ```\n * and then adding this to the map.\n *\n * The main advantage of having this as a control rather than a simple separate\n * DOM element is that preventing propagation is handled for you. Controls\n * will also be objects in a {@link module:ol/Collection~Collection}, so you can use their methods.\n *\n * You can also extend this base for your own control class. See\n * examples/custom-controls for an example of how to do this.\n *\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/control/Control~Options} options Control options.\n * @api\n */\nconst Control = function(options) {\n\n  BaseObject.call(this);\n\n  /**\n   * @protected\n   * @type {Element}\n   */\n  this.element = options.element ? options.element : null;\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.target_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/PluggableMap}\n   */\n  this.map_ = null;\n\n  /**\n   * @protected\n   * @type {!Array.<module:ol/events~EventsKey>}\n   */\n  this.listenerKeys = [];\n\n  /**\n   * @type {function(module:ol/MapEvent)}\n   */\n  this.render = options.render ? options.render : UNDEFINED;\n\n  if (options.target) {\n    this.setTarget(options.target);\n  }\n\n};\n\ninherits(Control, BaseObject);\n\n\n/**\n * @inheritDoc\n */\nControl.prototype.disposeInternal = function() {\n  removeNode(this.element);\n  BaseObject.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * Get the map associated with this control.\n * @return {module:ol/PluggableMap} Map.\n * @api\n */\nControl.prototype.getMap = function() {\n  return this.map_;\n};\n\n\n/**\n * Remove the control from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {module:ol/PluggableMap} map Map.\n * @api\n */\nControl.prototype.setMap = function(map) {\n  if (this.map_) {\n    removeNode(this.element);\n  }\n  for (let i = 0, ii = this.listenerKeys.length; i < ii; ++i) {\n    unlistenByKey(this.listenerKeys[i]);\n  }\n  this.listenerKeys.length = 0;\n  this.map_ = map;\n  if (this.map_) {\n    const target = this.target_ ?\n      this.target_ : map.getOverlayContainerStopEvent();\n    target.appendChild(this.element);\n    if (this.render !== UNDEFINED) {\n      this.listenerKeys.push(listen(map,\n        MapEventType.POSTRENDER, this.render, this));\n    }\n    map.render();\n  }\n};\n\n\n/**\n * This function is used to set a target element for the control. It has no\n * effect if it is called after the control has been added to the map (i.e.\n * after `setMap` is called on the control). If no `target` is set in the\n * options passed to the control constructor and if `setTarget` is not called\n * then the control is added to the map's overlay container.\n * @param {Element|string} target Target.\n * @api\n */\nControl.prototype.setTarget = function(target) {\n  this.target_ = typeof target === 'string' ?\n    document.getElementById(target) :\n    target;\n};\nexport default Control;\n","/**\n * @module ol/layer/Layer\n */\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getUid, inherits} from '../util.js';\nimport {getChangeEventType} from '../Object.js';\nimport BaseLayer from '../layer/Base.js';\nimport LayerProperty from '../layer/Property.js';\nimport {assign} from '../obj.js';\nimport RenderEventType from '../render/EventType.js';\nimport SourceState from '../source/State.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {module:ol/source/Source} [source] Source for this layer.  If not provided to the constructor,\n * the source can be set by calling {@link module:ol/layer/Layer#setSource layer.setSource(source)} after\n * construction.\n */\n\n\n/**\n * @typedef {Object} State\n * @property {module:ol/layer/Layer} layer\n * @property {number} opacity\n * @property {module:ol/source/Source~State} sourceState\n * @property {boolean} visible\n * @property {boolean} managed\n * @property {module:ol/extent~Extent} [extent]\n * @property {number} zIndex\n * @property {number} maxResolution\n * @property {number} minResolution\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * A visual representation of raster or vector map data.\n * Layers group together those properties that pertain to how the data is to be\n * displayed, irrespective of the source of that data.\n *\n * Layers are usually added to a map with {@link module:ol/Map#addLayer}. Components\n * like {@link module:ol/interaction/Select~Select} use unmanaged layers\n * internally. These unmanaged layers are associated with the map using\n * {@link module:ol/layer/Layer~Layer#setMap} instead.\n *\n * A generic `change` event is fired when the state of the source changes.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/layer/Base}\n * @fires module:ol/render/Event~RenderEvent\n * @param {module:ol/layer/Layer~Options} options Layer options.\n * @api\n */\nconst Layer = function(options) {\n\n  const baseOptions = assign({}, options);\n  delete baseOptions.source;\n\n  BaseLayer.call(this, /** @type {module:ol/layer/Base~Options} */ (baseOptions));\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.mapPrecomposeKey_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.mapRenderKey_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.sourceChangeKey_ = null;\n\n  if (options.map) {\n    this.setMap(options.map);\n  }\n\n  listen(this,\n    getChangeEventType(LayerProperty.SOURCE),\n    this.handleSourcePropertyChange_, this);\n\n  const source = options.source ? options.source : null;\n  this.setSource(source);\n};\n\ninherits(Layer, BaseLayer);\n\n\n/**\n * Return `true` if the layer is visible, and if the passed resolution is\n * between the layer's minResolution and maxResolution. The comparison is\n * inclusive for `minResolution` and exclusive for `maxResolution`.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {number} resolution Resolution.\n * @return {boolean} The layer is visible at the given resolution.\n */\nexport function visibleAtResolution(layerState, resolution) {\n  return layerState.visible && resolution >= layerState.minResolution &&\n      resolution < layerState.maxResolution;\n}\n\n\n/**\n * @inheritDoc\n */\nLayer.prototype.getLayersArray = function(opt_array) {\n  const array = opt_array ? opt_array : [];\n  array.push(this);\n  return array;\n};\n\n\n/**\n * @inheritDoc\n */\nLayer.prototype.getLayerStatesArray = function(opt_states) {\n  const states = opt_states ? opt_states : [];\n  states.push(this.getLayerState());\n  return states;\n};\n\n\n/**\n * Get the layer source.\n * @return {module:ol/source/Source} The layer source (or `null` if not yet set).\n * @observable\n * @api\n */\nLayer.prototype.getSource = function() {\n  const source = this.get(LayerProperty.SOURCE);\n  return (\n    /** @type {module:ol/source/Source} */ (source) || null\n  );\n};\n\n\n/**\n  * @inheritDoc\n  */\nLayer.prototype.getSourceState = function() {\n  const source = this.getSource();\n  return !source ? SourceState.UNDEFINED : source.getState();\n};\n\n\n/**\n * @private\n */\nLayer.prototype.handleSourceChange_ = function() {\n  this.changed();\n};\n\n\n/**\n * @private\n */\nLayer.prototype.handleSourcePropertyChange_ = function() {\n  if (this.sourceChangeKey_) {\n    unlistenByKey(this.sourceChangeKey_);\n    this.sourceChangeKey_ = null;\n  }\n  const source = this.getSource();\n  if (source) {\n    this.sourceChangeKey_ = listen(source,\n      EventType.CHANGE, this.handleSourceChange_, this);\n  }\n  this.changed();\n};\n\n\n/**\n * Sets the layer to be rendered on top of other layers on a map. The map will\n * not manage this layer in its layers collection, and the callback in\n * {@link module:ol/Map#forEachLayerAtPixel} will receive `null` as layer. This\n * is useful for temporary layers. To remove an unmanaged layer from the map,\n * use `#setMap(null)`.\n *\n * To add the layer to a map and have it managed by the map, use\n * {@link module:ol/Map#addLayer} instead.\n * @param {module:ol/PluggableMap} map Map.\n * @api\n */\nLayer.prototype.setMap = function(map) {\n  if (this.mapPrecomposeKey_) {\n    unlistenByKey(this.mapPrecomposeKey_);\n    this.mapPrecomposeKey_ = null;\n  }\n  if (!map) {\n    this.changed();\n  }\n  if (this.mapRenderKey_) {\n    unlistenByKey(this.mapRenderKey_);\n    this.mapRenderKey_ = null;\n  }\n  if (map) {\n    this.mapPrecomposeKey_ = listen(map, RenderEventType.PRECOMPOSE, function(evt) {\n      const layerState = this.getLayerState();\n      layerState.managed = false;\n      layerState.zIndex = Infinity;\n      evt.frameState.layerStatesArray.push(layerState);\n      evt.frameState.layerStates[getUid(this)] = layerState;\n    }, this);\n    this.mapRenderKey_ = listen(this, EventType.CHANGE, map.render, map);\n    this.changed();\n  }\n};\n\n\n/**\n * Set the layer source.\n * @param {module:ol/source/Source} source The layer source.\n * @observable\n * @api\n */\nLayer.prototype.setSource = function(source) {\n  this.set(LayerProperty.SOURCE, source);\n};\nexport default Layer;\n","/**\n * @module ol/control/Attribution\n */\nimport {inherits} from '../util.js';\nimport {equals} from '../array.js';\nimport Control from '../control/Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE, CLASS_COLLAPSED} from '../css.js';\nimport {removeChildren, replaceNode} from '../dom.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {visibleAtResolution} from '../layer/Layer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-attribution'] CSS class name.\n * @property {Element|string} [target] Specify a target if you\n * want the control to be rendered outside of the map's\n * viewport.\n * @property {boolean} [collapsible=true] Specify if attributions can\n * be collapsed. If you use an OSM source, should be set to `false` — see\n * {@link https://www.openstreetmap.org/copyright OSM Copyright} —\n * @property {boolean} [collapsed=true] Specify if attributions should\n * be collapsed at startup.\n * @property {string} [tipLabel='Attributions'] Text label to use for the button tip.\n * @property {string} [label='i'] Text label to use for the\n * collapsed attributions button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string|Element} [collapseLabel='»'] Text label to use\n * for the expanded attributions button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {function(module:ol/MapEvent)} [render] Function called when\n * the control should be re-rendered. This is called in a `requestAnimationFrame`\n * callback.\n */\n\n\n/**\n * @classdesc\n * Control to show all the attributions associated with the layer sources\n * in the map. This control is one of the default controls included in maps.\n * By default it will show in the bottom right portion of the map, but this can\n * be changed by using a css selector for `.ol-attribution`.\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/Attribution~Options=} opt_options Attribution options.\n * @api\n */\nconst Attribution = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.ulElement_ = document.createElement('UL');\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.collapsed_ = options.collapsed !== undefined ? options.collapsed : true;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.collapsible_ = options.collapsible !== undefined ?\n    options.collapsible : true;\n\n  if (!this.collapsible_) {\n    this.collapsed_ = false;\n  }\n\n  const className = options.className !== undefined ? options.className : 'ol-attribution';\n\n  const tipLabel = options.tipLabel !== undefined ? options.tipLabel : 'Attributions';\n\n  const collapseLabel = options.collapseLabel !== undefined ? options.collapseLabel : '\\u00BB';\n\n  if (typeof collapseLabel === 'string') {\n    /**\n     * @private\n     * @type {Element}\n     */\n    this.collapseLabel_ = document.createElement('span');\n    this.collapseLabel_.textContent = collapseLabel;\n  } else {\n    this.collapseLabel_ = collapseLabel;\n  }\n\n  const label = options.label !== undefined ? options.label : 'i';\n\n  if (typeof label === 'string') {\n    /**\n     * @private\n     * @type {Element}\n     */\n    this.label_ = document.createElement('span');\n    this.label_.textContent = label;\n  } else {\n    this.label_ = label;\n  }\n\n\n  const activeLabel = (this.collapsible_ && !this.collapsed_) ?\n    this.collapseLabel_ : this.label_;\n  const button = document.createElement('button');\n  button.setAttribute('type', 'button');\n  button.title = tipLabel;\n  button.appendChild(activeLabel);\n\n  listen(button, EventType.CLICK, this.handleClick_, this);\n\n  const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL +\n      (this.collapsed_ && this.collapsible_ ? ' ' + CLASS_COLLAPSED : '') +\n      (this.collapsible_ ? '' : ' ol-uncollapsible');\n  const element = document.createElement('div');\n  element.className = cssClasses;\n  element.appendChild(this.ulElement_);\n  element.appendChild(button);\n\n  Control.call(this, {\n    element: element,\n    render: options.render || render,\n    target: options.target\n  });\n\n  /**\n   * A list of currently rendered resolutions.\n   * @type {Array.<string>}\n   * @private\n   */\n  this.renderedAttributions_ = [];\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.renderedVisible_ = true;\n\n};\n\ninherits(Attribution, Control);\n\n\n/**\n * Get a list of visible attributions.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @return {Array.<string>} Attributions.\n * @private\n */\nAttribution.prototype.getSourceAttributions_ = function(frameState) {\n  /**\n   * Used to determine if an attribution already exists.\n   * @type {!Object.<string, boolean>}\n   */\n  const lookup = {};\n\n  /**\n   * A list of visible attributions.\n   * @type {Array.<string>}\n   */\n  const visibleAttributions = [];\n\n  const layerStatesArray = frameState.layerStatesArray;\n  const resolution = frameState.viewState.resolution;\n  for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n    const layerState = layerStatesArray[i];\n    if (!visibleAtResolution(layerState, resolution)) {\n      continue;\n    }\n\n    const source = layerState.layer.getSource();\n    if (!source) {\n      continue;\n    }\n\n    const attributionGetter = source.getAttributions();\n    if (!attributionGetter) {\n      continue;\n    }\n\n    const attributions = attributionGetter(frameState);\n    if (!attributions) {\n      continue;\n    }\n\n    if (Array.isArray(attributions)) {\n      for (let j = 0, jj = attributions.length; j < jj; ++j) {\n        if (!(attributions[j] in lookup)) {\n          visibleAttributions.push(attributions[j]);\n          lookup[attributions[j]] = true;\n        }\n      }\n    } else {\n      if (!(attributions in lookup)) {\n        visibleAttributions.push(attributions);\n        lookup[attributions] = true;\n      }\n    }\n  }\n  return visibleAttributions;\n};\n\n\n/**\n * Update the attribution element.\n * @param {module:ol/MapEvent} mapEvent Map event.\n * @this {module:ol/control/Attribution}\n * @api\n */\nexport function render(mapEvent) {\n  this.updateElement_(mapEvent.frameState);\n}\n\n\n/**\n * @private\n * @param {?module:ol/PluggableMap~FrameState} frameState Frame state.\n */\nAttribution.prototype.updateElement_ = function(frameState) {\n  if (!frameState) {\n    if (this.renderedVisible_) {\n      this.element.style.display = 'none';\n      this.renderedVisible_ = false;\n    }\n    return;\n  }\n\n  const attributions = this.getSourceAttributions_(frameState);\n\n  const visible = attributions.length > 0;\n  if (this.renderedVisible_ != visible) {\n    this.element.style.display = visible ? '' : 'none';\n    this.renderedVisible_ = visible;\n  }\n\n  if (equals(attributions, this.renderedAttributions_)) {\n    return;\n  }\n\n  removeChildren(this.ulElement_);\n\n  // append the attributions\n  for (let i = 0, ii = attributions.length; i < ii; ++i) {\n    const element = document.createElement('LI');\n    element.innerHTML = attributions[i];\n    this.ulElement_.appendChild(element);\n  }\n\n  this.renderedAttributions_ = attributions;\n};\n\n\n/**\n * @param {Event} event The event to handle\n * @private\n */\nAttribution.prototype.handleClick_ = function(event) {\n  event.preventDefault();\n  this.handleToggle_();\n};\n\n\n/**\n * @private\n */\nAttribution.prototype.handleToggle_ = function() {\n  this.element.classList.toggle(CLASS_COLLAPSED);\n  if (this.collapsed_) {\n    replaceNode(this.collapseLabel_, this.label_);\n  } else {\n    replaceNode(this.label_, this.collapseLabel_);\n  }\n  this.collapsed_ = !this.collapsed_;\n};\n\n\n/**\n * Return `true` if the attribution is collapsible, `false` otherwise.\n * @return {boolean} True if the widget is collapsible.\n * @api\n */\nAttribution.prototype.getCollapsible = function() {\n  return this.collapsible_;\n};\n\n\n/**\n * Set whether the attribution should be collapsible.\n * @param {boolean} collapsible True if the widget is collapsible.\n * @api\n */\nAttribution.prototype.setCollapsible = function(collapsible) {\n  if (this.collapsible_ === collapsible) {\n    return;\n  }\n  this.collapsible_ = collapsible;\n  this.element.classList.toggle('ol-uncollapsible');\n  if (!collapsible && this.collapsed_) {\n    this.handleToggle_();\n  }\n};\n\n\n/**\n * Collapse or expand the attribution according to the passed parameter. Will\n * not do anything if the attribution isn't collapsible or if the current\n * collapsed state is already the one requested.\n * @param {boolean} collapsed True if the widget is collapsed.\n * @api\n */\nAttribution.prototype.setCollapsed = function(collapsed) {\n  if (!this.collapsible_ || this.collapsed_ === collapsed) {\n    return;\n  }\n  this.handleToggle_();\n};\n\n\n/**\n * Return `true` when the attribution is currently collapsed or `false`\n * otherwise.\n * @return {boolean} True if the widget is collapsed.\n * @api\n */\nAttribution.prototype.getCollapsed = function() {\n  return this.collapsed_;\n};\nexport default Attribution;\n","/**\n * @module ol/control/Rotate\n */\n\nimport Control from '../control/Control.js';\nimport {CLASS_CONTROL, CLASS_HIDDEN, CLASS_UNSELECTABLE} from '../css.js';\nimport {easeOut} from '../easing.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {inherits} from '../util.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-rotate'] CSS class name.\n * @property {string|Element} [label='⇧'] Text label to use for the rotate button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string} [tipLabel='Reset rotation'] Text label to use for the rotate tip.\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {boolean} [autoHide=true] Hide the control when rotation is 0.\n * @property {function(module:ol/MapEvent)} [render] Function called when the control should\n * be re-rendered. This is called in a `requestAnimationFrame` callback.\n * @property {function()} [resetNorth] Function called when the control is clicked.\n * This will override the default `resetNorth`.\n * @property {Element|string} [target] Specify a target if you want the control to be\n * rendered outside of the map's viewport.\n */\n\n\n/**\n * @classdesc\n * A button control to reset rotation to 0.\n * To style this control use css selector `.ol-rotate`. A `.ol-hidden` css\n * selector is added to the button when the rotation is 0.\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/Rotate~Options=} opt_options Rotate options.\n * @api\n */\nconst Rotate = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const className = options.className !== undefined ? options.className : 'ol-rotate';\n\n  const label = options.label !== undefined ? options.label : '\\u21E7';\n\n  /**\n   * @type {Element}\n   * @private\n   */\n  this.label_ = null;\n\n  if (typeof label === 'string') {\n    this.label_ = document.createElement('span');\n    this.label_.className = 'ol-compass';\n    this.label_.textContent = label;\n  } else {\n    this.label_ = label;\n    this.label_.classList.add('ol-compass');\n  }\n\n  const tipLabel = options.tipLabel ? options.tipLabel : 'Reset rotation';\n\n  const button = document.createElement('button');\n  button.className = className + '-reset';\n  button.setAttribute('type', 'button');\n  button.title = tipLabel;\n  button.appendChild(this.label_);\n\n  listen(button, EventType.CLICK,\n    Rotate.prototype.handleClick_, this);\n\n  const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL;\n  const element = document.createElement('div');\n  element.className = cssClasses;\n  element.appendChild(button);\n\n  this.callResetNorth_ = options.resetNorth ? options.resetNorth : undefined;\n\n  Control.call(this, {\n    element: element,\n    render: options.render || render,\n    target: options.target\n  });\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.autoHide_ = options.autoHide !== undefined ? options.autoHide : true;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.rotation_ = undefined;\n\n  if (this.autoHide_) {\n    this.element.classList.add(CLASS_HIDDEN);\n  }\n\n};\n\ninherits(Rotate, Control);\n\n\n/**\n * @param {Event} event The event to handle\n * @private\n */\nRotate.prototype.handleClick_ = function(event) {\n  event.preventDefault();\n  if (this.callResetNorth_ !== undefined) {\n    this.callResetNorth_();\n  } else {\n    this.resetNorth_();\n  }\n};\n\n\n/**\n * @private\n */\nRotate.prototype.resetNorth_ = function() {\n  const map = this.getMap();\n  const view = map.getView();\n  if (!view) {\n    // the map does not have a view, so we can't act\n    // upon it\n    return;\n  }\n  if (view.getRotation() !== undefined) {\n    if (this.duration_ > 0) {\n      view.animate({\n        rotation: 0,\n        duration: this.duration_,\n        easing: easeOut\n      });\n    } else {\n      view.setRotation(0);\n    }\n  }\n};\n\n\n/**\n * Update the rotate control element.\n * @param {module:ol/MapEvent} mapEvent Map event.\n * @this {module:ol/control/Rotate}\n * @api\n */\nexport function render(mapEvent) {\n  const frameState = mapEvent.frameState;\n  if (!frameState) {\n    return;\n  }\n  const rotation = frameState.viewState.rotation;\n  if (rotation != this.rotation_) {\n    const transform = 'rotate(' + rotation + 'rad)';\n    if (this.autoHide_) {\n      const contains = this.element.classList.contains(CLASS_HIDDEN);\n      if (!contains && rotation === 0) {\n        this.element.classList.add(CLASS_HIDDEN);\n      } else if (contains && rotation !== 0) {\n        this.element.classList.remove(CLASS_HIDDEN);\n      }\n    }\n    this.label_.style.msTransform = transform;\n    this.label_.style.webkitTransform = transform;\n    this.label_.style.transform = transform;\n  }\n  this.rotation_ = rotation;\n}\n\nexport default Rotate;\n","/**\n * @module ol/control/Zoom\n */\nimport {inherits} from '../util.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport Control from '../control/Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE} from '../css.js';\nimport {easeOut} from '../easing.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {string} [className='ol-zoom'] CSS class name.\n * @property {string|Element} [zoomInLabel='+'] Text label to use for the zoom-in\n * button. Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string|Element} [zoomOutLabel='-'] Text label to use for the zoom-out button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string} [zoomInTipLabel='Zoom in'] Text label to use for the button tip.\n * @property {string} [zoomOutTipLabel='Zoom out'] Text label to use for the button tip.\n * @property {number} [delta=1] The zoom delta applied on each click.\n * @property {Element|string} [target] Specify a target if you want the control to be\n * rendered outside of the map's viewport.\n */\n\n\n/**\n * @classdesc\n * A control with 2 buttons, one for zoom in and one for zoom out.\n * This control is one of the default controls of a map. To style this control\n * use css selectors `.ol-zoom-in` and `.ol-zoom-out`.\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/Zoom~Options=} opt_options Zoom options.\n * @api\n */\nconst Zoom = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const className = options.className !== undefined ? options.className : 'ol-zoom';\n\n  const delta = options.delta !== undefined ? options.delta : 1;\n\n  const zoomInLabel = options.zoomInLabel !== undefined ? options.zoomInLabel : '+';\n  const zoomOutLabel = options.zoomOutLabel !== undefined ? options.zoomOutLabel : '\\u2212';\n\n  const zoomInTipLabel = options.zoomInTipLabel !== undefined ?\n    options.zoomInTipLabel : 'Zoom in';\n  const zoomOutTipLabel = options.zoomOutTipLabel !== undefined ?\n    options.zoomOutTipLabel : 'Zoom out';\n\n  const inElement = document.createElement('button');\n  inElement.className = className + '-in';\n  inElement.setAttribute('type', 'button');\n  inElement.title = zoomInTipLabel;\n  inElement.appendChild(\n    typeof zoomInLabel === 'string' ? document.createTextNode(zoomInLabel) : zoomInLabel\n  );\n\n  listen(inElement, EventType.CLICK,\n    Zoom.prototype.handleClick_.bind(this, delta));\n\n  const outElement = document.createElement('button');\n  outElement.className = className + '-out';\n  outElement.setAttribute('type', 'button');\n  outElement.title = zoomOutTipLabel;\n  outElement.appendChild(\n    typeof zoomOutLabel === 'string' ? document.createTextNode(zoomOutLabel) : zoomOutLabel\n  );\n\n  listen(outElement, EventType.CLICK,\n    Zoom.prototype.handleClick_.bind(this, -delta));\n\n  const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL;\n  const element = document.createElement('div');\n  element.className = cssClasses;\n  element.appendChild(inElement);\n  element.appendChild(outElement);\n\n  Control.call(this, {\n    element: element,\n    target: options.target\n  });\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n};\n\ninherits(Zoom, Control);\n\n\n/**\n * @param {number} delta Zoom delta.\n * @param {Event} event The event to handle\n * @private\n */\nZoom.prototype.handleClick_ = function(delta, event) {\n  event.preventDefault();\n  this.zoomByDelta_(delta);\n};\n\n\n/**\n * @param {number} delta Zoom delta.\n * @private\n */\nZoom.prototype.zoomByDelta_ = function(delta) {\n  const map = this.getMap();\n  const view = map.getView();\n  if (!view) {\n    // the map does not have a view, so we can't act\n    // upon it\n    return;\n  }\n  const currentResolution = view.getResolution();\n  if (currentResolution) {\n    const newResolution = view.constrainResolution(currentResolution, delta);\n    if (this.duration_ > 0) {\n      if (view.getAnimating()) {\n        view.cancelAnimations();\n      }\n      view.animate({\n        resolution: newResolution,\n        duration: this.duration_,\n        easing: easeOut\n      });\n    } else {\n      view.setResolution(newResolution);\n    }\n  }\n};\nexport default Zoom;\n","/**\n * @module ol/control/util\n */\nimport Collection from '../Collection.js';\nimport Attribution from './Attribution.js';\nimport Rotate from './Rotate.js';\nimport Zoom from './Zoom.js';\n\n\n/**\n * @typedef {Object} DefaultsOptions\n * @property {boolean} [attribution=true] Include\n * {@link module:ol/control/Attribution~Attribution}.\n * @property {module:ol/control/Attribution~Options} [attributionOptions]\n * Options for {@link module:ol/control/Attribution~Attribution}.\n * @property {boolean} [rotate=true] Include\n * {@link module:ol/control/Rotate~Rotate}.\n * @property {module:ol/control/Rotate~Options} [rotateOptions] Options\n * for {@link module:ol/control/Rotate~Rotate}.\n * @property {boolean} [zoom] Include {@link module:ol/control/Zoom~Zoom}.\n * @property {module:ol/control/Zoom~Options} [zoomOptions] Options for\n * {@link module:ol/control/Zoom~Zoom}.\n * @api\n */\n\n\n/**\n * Set of controls included in maps by default. Unless configured otherwise,\n * this returns a collection containing an instance of each of the following\n * controls:\n * * {@link module:ol/control/Zoom~Zoom}\n * * {@link module:ol/control/Rotate~Rotate}\n * * {@link module:ol/control/Attribution~Attribution}\n *\n * @param {module:ol/control/util~DefaultsOptions=} opt_options\n * Defaults options.\n * @return {module:ol/Collection.<module:ol/control/Control>}\n * Controls.\n * @function module:ol/control.defaults\n * @api\n */\nexport function defaults(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const controls = new Collection();\n\n  const zoomControl = options.zoom !== undefined ? options.zoom : true;\n  if (zoomControl) {\n    controls.push(new Zoom(options.zoomOptions));\n  }\n\n  const rotateControl = options.rotate !== undefined ? options.rotate : true;\n  if (rotateControl) {\n    controls.push(new Rotate(options.rotateOptions));\n  }\n\n  const attributionControl = options.attribution !== undefined ?\n    options.attribution : true;\n  if (attributionControl) {\n    controls.push(new Attribution(options.attributionOptions));\n  }\n\n  return controls;\n}\n","/**\n * @module ol/interaction/Property\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  ACTIVE: 'active'\n};\n","/**\n * @module ol/interaction/Interaction\n */\nimport {inherits} from '../util.js';\nimport BaseObject from '../Object.js';\nimport {easeOut, linear} from '../easing.js';\nimport InteractionProperty from '../interaction/Property.js';\nimport {clamp} from '../math.js';\n\n\n/**\n * Object literal with config options for interactions.\n * @typedef {Object} InteractionOptions\n * @property {function(module:ol/MapBrowserEvent):boolean} handleEvent\n * Method called by the map to notify the interaction that a browser event was\n * dispatched to the map. If the function returns a falsy value, propagation of\n * the event to other interactions in the map's interactions chain will be\n * prevented (this includes functions with no explicit return).\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * User actions that change the state of the map. Some are similar to controls,\n * but are not associated with a DOM element.\n * For example, {@link module:ol/interaction/KeyboardZoom~KeyboardZoom} is\n * functionally the same as {@link module:ol/control/Zoom~Zoom}, but triggered\n * by a keyboard event not a button element event.\n * Although interactions do not have a DOM element, some of them do render\n * vectors and so are visible on the screen.\n *\n * @constructor\n * @param {module:ol/interaction/Interaction~InteractionOptions} options Options.\n * @extends {module:ol/Object}\n * @api\n */\nconst Interaction = function(options) {\n\n  BaseObject.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/PluggableMap}\n   */\n  this.map_ = null;\n\n  this.setActive(true);\n\n  /**\n   * @type {function(module:ol/MapBrowserEvent):boolean}\n   */\n  this.handleEvent = options.handleEvent;\n\n};\n\ninherits(Interaction, BaseObject);\n\n\n/**\n * Return whether the interaction is currently active.\n * @return {boolean} `true` if the interaction is active, `false` otherwise.\n * @observable\n * @api\n */\nInteraction.prototype.getActive = function() {\n  return /** @type {boolean} */ (this.get(InteractionProperty.ACTIVE));\n};\n\n\n/**\n * Get the map associated with this interaction.\n * @return {module:ol/PluggableMap} Map.\n * @api\n */\nInteraction.prototype.getMap = function() {\n  return this.map_;\n};\n\n\n/**\n * Activate or deactivate the interaction.\n * @param {boolean} active Active.\n * @observable\n * @api\n */\nInteraction.prototype.setActive = function(active) {\n  this.set(InteractionProperty.ACTIVE, active);\n};\n\n\n/**\n * Remove the interaction from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {module:ol/PluggableMap} map Map.\n */\nInteraction.prototype.setMap = function(map) {\n  this.map_ = map;\n};\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {module:ol/coordinate~Coordinate} delta Delta.\n * @param {number=} opt_duration Duration.\n */\nexport function pan(view, delta, opt_duration) {\n  const currentCenter = view.getCenter();\n  if (currentCenter) {\n    const center = view.constrainCenter(\n      [currentCenter[0] + delta[0], currentCenter[1] + delta[1]]);\n    if (opt_duration) {\n      view.animate({\n        duration: opt_duration,\n        easing: linear,\n        center: center\n      });\n    } else {\n      view.setCenter(center);\n    }\n  }\n}\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {number|undefined} rotation Rotation.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor Anchor coordinate.\n * @param {number=} opt_duration Duration.\n */\nexport function rotate(view, rotation, opt_anchor, opt_duration) {\n  rotation = view.constrainRotation(rotation, 0);\n  rotateWithoutConstraints(view, rotation, opt_anchor, opt_duration);\n}\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {number|undefined} rotation Rotation.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor Anchor coordinate.\n * @param {number=} opt_duration Duration.\n */\nexport function rotateWithoutConstraints(view, rotation, opt_anchor, opt_duration) {\n  if (rotation !== undefined) {\n    const currentRotation = view.getRotation();\n    const currentCenter = view.getCenter();\n    if (currentRotation !== undefined && currentCenter && opt_duration > 0) {\n      view.animate({\n        rotation: rotation,\n        anchor: opt_anchor,\n        duration: opt_duration,\n        easing: easeOut\n      });\n    } else {\n      view.rotate(rotation, opt_anchor);\n    }\n  }\n}\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {number|undefined} resolution Resolution to go to.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor Anchor coordinate.\n * @param {number=} opt_duration Duration.\n * @param {number=} opt_direction Zooming direction; > 0 indicates\n *     zooming out, in which case the constraints system will select\n *     the largest nearest resolution; < 0 indicates zooming in, in\n *     which case the constraints system will select the smallest\n *     nearest resolution; == 0 indicates that the zooming direction\n *     is unknown/not relevant, in which case the constraints system\n *     will select the nearest resolution. If not defined 0 is\n *     assumed.\n */\nexport function zoom(view, resolution, opt_anchor, opt_duration, opt_direction) {\n  resolution = view.constrainResolution(resolution, 0, opt_direction);\n  zoomWithoutConstraints(view, resolution, opt_anchor, opt_duration);\n}\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {number} delta Delta from previous zoom level.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor Anchor coordinate.\n * @param {number=} opt_duration Duration.\n */\nexport function zoomByDelta(view, delta, opt_anchor, opt_duration) {\n  const currentResolution = view.getResolution();\n  let resolution = view.constrainResolution(currentResolution, delta, 0);\n\n  if (resolution !== undefined) {\n    const resolutions = view.getResolutions();\n    resolution = clamp(\n      resolution,\n      view.getMinResolution() || resolutions[resolutions.length - 1],\n      view.getMaxResolution() || resolutions[0]);\n  }\n\n  // If we have a constraint on center, we need to change the anchor so that the\n  // new center is within the extent. We first calculate the new center, apply\n  // the constraint to it, and then calculate back the anchor\n  if (opt_anchor && resolution !== undefined && resolution !== currentResolution) {\n    const currentCenter = view.getCenter();\n    let center = view.calculateCenterZoom(resolution, opt_anchor);\n    center = view.constrainCenter(center);\n\n    opt_anchor = [\n      (resolution * currentCenter[0] - currentResolution * center[0]) /\n          (resolution - currentResolution),\n      (resolution * currentCenter[1] - currentResolution * center[1]) /\n          (resolution - currentResolution)\n    ];\n  }\n\n  zoomWithoutConstraints(view, resolution, opt_anchor, opt_duration);\n}\n\n\n/**\n * @param {module:ol/View} view View.\n * @param {number|undefined} resolution Resolution to go to.\n * @param {module:ol/coordinate~Coordinate=} opt_anchor Anchor coordinate.\n * @param {number=} opt_duration Duration.\n */\nexport function zoomWithoutConstraints(view, resolution, opt_anchor, opt_duration) {\n  if (resolution) {\n    const currentResolution = view.getResolution();\n    const currentCenter = view.getCenter();\n    if (currentResolution !== undefined && currentCenter &&\n        resolution !== currentResolution && opt_duration) {\n      view.animate({\n        resolution: resolution,\n        anchor: opt_anchor,\n        duration: opt_duration,\n        easing: easeOut\n      });\n    } else {\n      if (opt_anchor) {\n        const center = view.calculateCenterZoom(resolution, opt_anchor);\n        view.setCenter(center);\n      }\n      view.setResolution(resolution);\n    }\n  }\n}\n\nexport default Interaction;\n","/**\n * @module ol/interaction/DoubleClickZoom\n */\nimport {inherits} from '../util.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport Interaction, {zoomByDelta} from '../interaction/Interaction.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {number} [delta=1] The zoom delta applied on each double click.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom by double-clicking on the map.\n *\n * @constructor\n * @extends {module:ol/interaction/Interaction}\n * @param {module:ol/interaction/DoubleClickZoom~Options=} opt_options Options.\n * @api\n */\nconst DoubleClickZoom = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.delta_ = options.delta ? options.delta : 1;\n\n  Interaction.call(this, {\n    handleEvent: handleEvent\n  });\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n};\n\ninherits(DoubleClickZoom, Interaction);\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} (if it was a\n * doubleclick) and eventually zooms the map.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/DoubleClickZoom}\n */\nfunction handleEvent(mapBrowserEvent) {\n  let stopEvent = false;\n  const browserEvent = mapBrowserEvent.originalEvent;\n  if (mapBrowserEvent.type == MapBrowserEventType.DBLCLICK) {\n    const map = mapBrowserEvent.map;\n    const anchor = mapBrowserEvent.coordinate;\n    const delta = browserEvent.shiftKey ? -this.delta_ : this.delta_;\n    const view = map.getView();\n    zoomByDelta(view, delta, anchor, this.duration_);\n    mapBrowserEvent.preventDefault();\n    stopEvent = true;\n  }\n  return !stopEvent;\n}\n\nexport default DoubleClickZoom;\n","/**\n * @module ol/events/condition\n */\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport {assert} from '../asserts.js';\nimport {TRUE, FALSE} from '../functions.js';\nimport {WEBKIT, MAC} from '../has.js';\n\n\n/**\n * A function that takes an {@link module:ol/MapBrowserEvent} and returns a\n * `{boolean}`. If the condition is met, true should be returned.\n *\n * @typedef {function(this: ?, module:ol/MapBrowserEvent): boolean} Condition\n */\n\n\n/**\n * Return `true` if only the alt-key is pressed, `false` otherwise (e.g. when\n * additionally the shift-key is pressed).\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the alt key is pressed.\n * @api\n */\nexport const altKeyOnly = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return (\n    originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      !originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if only the alt-key and shift-key is pressed, `false` otherwise\n * (e.g. when additionally the platform-modifier-key is pressed).\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the alt and shift keys are pressed.\n * @api\n */\nexport const altShiftKeysOnly = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return (\n    originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if the map has the focus. This condition requires a map target\n * element with a `tabindex` attribute, e.g. `<div id=\"map\" tabindex=\"1\">`.\n *\n * @param {module:ol/MapBrowserEvent} event Map browser event.\n * @return {boolean} The map has the focus.\n * @api\n */\nexport const focus = function(event) {\n  return event.target.getTargetElement() === document.activeElement;\n};\n\n\n/**\n * Return always true.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True.\n * @function\n * @api\n */\nexport const always = TRUE;\n\n\n/**\n * Return `true` if the event is a `click` event, `false` otherwise.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event is a map `click` event.\n * @api\n */\nexport const click = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == MapBrowserEventType.CLICK;\n};\n\n\n/**\n * Return `true` if the event has an \"action\"-producing mouse button.\n *\n * By definition, this includes left-click on windows/linux, and left-click\n * without the ctrl key on Macs.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} The result.\n */\nexport const mouseActionButton = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return originalEvent.button == 0 &&\n      !(WEBKIT && MAC && originalEvent.ctrlKey);\n};\n\n\n/**\n * Return always false.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} False.\n * @function\n * @api\n */\nexport const never = FALSE;\n\n\n/**\n * Return `true` if the browser event is a `pointermove` event, `false`\n * otherwise.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the browser event is a `pointermove` event.\n * @api\n */\nexport const pointerMove = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == 'pointermove';\n};\n\n\n/**\n * Return `true` if the event is a map `singleclick` event, `false` otherwise.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event is a map `singleclick` event.\n * @api\n */\nexport const singleClick = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == MapBrowserEventType.SINGLECLICK;\n};\n\n\n/**\n * Return `true` if the event is a map `dblclick` event, `false` otherwise.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event is a map `dblclick` event.\n * @api\n */\nexport const doubleClick = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == MapBrowserEventType.DBLCLICK;\n};\n\n\n/**\n * Return `true` if no modifier key (alt-, shift- or platform-modifier-key) is\n * pressed.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True only if there no modifier keys are pressed.\n * @api\n */\nexport const noModifierKeys = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return (\n    !originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      !originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if only the platform-modifier-key (the meta-key on Mac,\n * ctrl-key otherwise) is pressed, `false` otherwise (e.g. when additionally\n * the shift-key is pressed).\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the platform modifier key is pressed.\n * @api\n */\nexport const platformModifierKeyOnly = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return !originalEvent.altKey &&\n    (MAC ? originalEvent.metaKey : originalEvent.ctrlKey) &&\n    !originalEvent.shiftKey;\n};\n\n\n/**\n * Return `true` if only the shift-key is pressed, `false` otherwise (e.g. when\n * additionally the alt-key is pressed).\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the shift key is pressed.\n * @api\n */\nexport const shiftKeyOnly = function(mapBrowserEvent) {\n  const originalEvent = mapBrowserEvent.originalEvent;\n  return (\n    !originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if the target element is not editable, i.e. not a `<input>`-,\n * `<select>`- or `<textarea>`-element, `false` otherwise.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True only if the target element is not editable.\n * @api\n */\nexport const targetNotEditable = function(mapBrowserEvent) {\n  const target = mapBrowserEvent.originalEvent.target;\n  const tagName = target.tagName;\n  return (\n    tagName !== 'INPUT' &&\n      tagName !== 'SELECT' &&\n      tagName !== 'TEXTAREA');\n};\n\n\n/**\n * Return `true` if the event originates from a mouse device.\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event originates from a mouse device.\n * @api\n */\nexport const mouseOnly = function(mapBrowserEvent) {\n  assert(mapBrowserEvent.pointerEvent, 56); // mapBrowserEvent must originate from a pointer event\n  // see http://www.w3.org/TR/pointerevents/#widl-PointerEvent-pointerType\n  return (\n    /** @type {module:ol/MapBrowserEvent} */ (mapBrowserEvent).pointerEvent.pointerType == 'mouse'\n  );\n};\n\n\n/**\n * Return `true` if the event originates from a primary pointer in\n * contact with the surface or if the left mouse button is pressed.\n * @see http://www.w3.org/TR/pointerevents/#button-states\n *\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event originates from a primary pointer.\n * @api\n */\nexport const primaryAction = function(mapBrowserEvent) {\n  const pointerEvent = mapBrowserEvent.pointerEvent;\n  return pointerEvent.isPrimary && pointerEvent.button === 0;\n};\n","/**\n * @module ol/interaction/Pointer\n */\nimport {inherits} from '../util.js';\nimport {FALSE, UNDEFINED} from '../functions.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport MapBrowserPointerEvent from '../MapBrowserPointerEvent.js';\nimport Interaction from '../interaction/Interaction.js';\nimport {getValues} from '../obj.js';\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/Pointer}\n */\nconst handleDragEvent = UNDEFINED;\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Capture dragging.\n * @this {module:ol/interaction/Pointer}\n */\nconst handleUpEvent = FALSE;\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Capture dragging.\n * @this {module:ol/interaction/Pointer}\n */\nconst handleDownEvent = FALSE;\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/Pointer}\n */\nconst handleMoveEvent = UNDEFINED;\n\n\n/**\n * @typedef {Object} Options\n * @property {(function(module:ol/MapBrowserPointerEvent):boolean)} [handleDownEvent]\n * Function handling \"down\" events. If the function returns `true` then a drag\n * sequence is started.\n * @property {(function(module:ol/MapBrowserPointerEvent))} [handleDragEvent]\n * Function handling \"drag\" events. This function is called on \"move\" events\n * during a drag sequence.\n * @property {(function(module:ol/MapBrowserEvent):boolean)} [handleEvent]\n * Method called by the map to notify the interaction that a browser event was\n * dispatched to the map. The function may return `false` to prevent the\n * propagation of the event to other interactions in the map's interactions\n * chain.\n * @property {(function(module:ol/MapBrowserPointerEvent))} [handleMoveEvent]\n * Function handling \"move\" events. This function is called on \"move\" events,\n * also during a drag sequence (so during a drag sequence both the\n * `handleDragEvent` function and this function are called).\n * @property {(function(module:ol/MapBrowserPointerEvent):boolean)} [handleUpEvent]\n *  Function handling \"up\" events. If the function returns `false` then the\n * current drag sequence is stopped.\n */\n\n\n/**\n * @classdesc\n * Base class that calls user-defined functions on `down`, `move` and `up`\n * events. This class also manages \"drag sequences\".\n *\n * When the `handleDownEvent` user function returns `true` a drag sequence is\n * started. During a drag sequence the `handleDragEvent` user function is\n * called on `move` events. The drag sequence ends when the `handleUpEvent`\n * user function is called and returns `false`.\n *\n * @constructor\n * @param {module:ol/interaction/Pointer~Options=} opt_options Options.\n * @extends {module:ol/interaction/Interaction}\n * @api\n */\nconst PointerInteraction = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  Interaction.call(this, {\n    handleEvent: options.handleEvent || handleEvent\n  });\n\n  /**\n   * @type {function(module:ol/MapBrowserPointerEvent):boolean}\n   * @private\n   */\n  this.handleDownEvent_ = options.handleDownEvent ?\n    options.handleDownEvent : handleDownEvent;\n\n  /**\n   * @type {function(module:ol/MapBrowserPointerEvent)}\n   * @private\n   */\n  this.handleDragEvent_ = options.handleDragEvent ?\n    options.handleDragEvent : handleDragEvent;\n\n  /**\n   * @type {function(module:ol/MapBrowserPointerEvent)}\n   * @private\n   */\n  this.handleMoveEvent_ = options.handleMoveEvent ?\n    options.handleMoveEvent : handleMoveEvent;\n\n  /**\n   * @type {function(module:ol/MapBrowserPointerEvent):boolean}\n   * @private\n   */\n  this.handleUpEvent_ = options.handleUpEvent ?\n    options.handleUpEvent : handleUpEvent;\n\n  /**\n   * @type {boolean}\n   * @protected\n   */\n  this.handlingDownUpSequence = false;\n\n  /**\n   * @type {!Object.<string, module:ol/pointer/PointerEvent>}\n   * @private\n   */\n  this.trackedPointers_ = {};\n\n  /**\n   * @type {Array.<module:ol/pointer/PointerEvent>}\n   * @protected\n   */\n  this.targetPointers = [];\n\n};\n\ninherits(PointerInteraction, Interaction);\n\n\n/**\n * @param {Array.<module:ol/pointer/PointerEvent>} pointerEvents List of events.\n * @return {module:ol~Pixel} Centroid pixel.\n */\nexport function centroid(pointerEvents) {\n  const length = pointerEvents.length;\n  let clientX = 0;\n  let clientY = 0;\n  for (let i = 0; i < length; i++) {\n    clientX += pointerEvents[i].clientX;\n    clientY += pointerEvents[i].clientY;\n  }\n  return [clientX / length, clientY / length];\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Whether the event is a pointerdown, pointerdrag\n *     or pointerup event.\n */\nfunction isPointerDraggingEvent(mapBrowserEvent) {\n  const type = mapBrowserEvent.type;\n  return type === MapBrowserEventType.POINTERDOWN ||\n    type === MapBrowserEventType.POINTERDRAG ||\n    type === MapBrowserEventType.POINTERUP;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @private\n */\nPointerInteraction.prototype.updateTrackedPointers_ = function(mapBrowserEvent) {\n  if (isPointerDraggingEvent(mapBrowserEvent)) {\n    const event = mapBrowserEvent.pointerEvent;\n\n    const id = event.pointerId.toString();\n    if (mapBrowserEvent.type == MapBrowserEventType.POINTERUP) {\n      delete this.trackedPointers_[id];\n    } else if (mapBrowserEvent.type ==\n        MapBrowserEventType.POINTERDOWN) {\n      this.trackedPointers_[id] = event;\n    } else if (id in this.trackedPointers_) {\n      // update only when there was a pointerdown event for this pointer\n      this.trackedPointers_[id] = event;\n    }\n    this.targetPointers = getValues(this.trackedPointers_);\n  }\n};\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} and may call into\n * other functions, if event sequences like e.g. 'drag' or 'down-up' etc. are\n * detected.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/Pointer}\n * @api\n */\nexport function handleEvent(mapBrowserEvent) {\n  if (!(mapBrowserEvent instanceof MapBrowserPointerEvent)) {\n    return true;\n  }\n\n  let stopEvent = false;\n  this.updateTrackedPointers_(mapBrowserEvent);\n  if (this.handlingDownUpSequence) {\n    if (mapBrowserEvent.type == MapBrowserEventType.POINTERDRAG) {\n      this.handleDragEvent_(mapBrowserEvent);\n    } else if (mapBrowserEvent.type == MapBrowserEventType.POINTERUP) {\n      const handledUp = this.handleUpEvent_(mapBrowserEvent);\n      this.handlingDownUpSequence = handledUp && this.targetPointers.length > 0;\n    }\n  } else {\n    if (mapBrowserEvent.type == MapBrowserEventType.POINTERDOWN) {\n      const handled = this.handleDownEvent_(mapBrowserEvent);\n      this.handlingDownUpSequence = handled;\n      stopEvent = this.shouldStopEvent(handled);\n    } else if (mapBrowserEvent.type == MapBrowserEventType.POINTERMOVE) {\n      this.handleMoveEvent_(mapBrowserEvent);\n    }\n  }\n  return !stopEvent;\n}\n\n\n/**\n * This method is used to determine if \"down\" events should be propagated to\n * other interactions or should be stopped.\n *\n * The method receives the return code of the \"handleDownEvent\" function.\n *\n * By default this function is the \"identity\" function. It's overridden in\n * child classes.\n *\n * @param {boolean} handled Was the event handled by the interaction?\n * @return {boolean} Should the event be stopped?\n * @protected\n */\nPointerInteraction.prototype.shouldStopEvent = function(handled) {\n  return handled;\n};\n\nexport default PointerInteraction;\n","/**\n * @module ol/interaction/DragPan\n */\nimport {inherits} from '../util.js';\nimport ViewHint from '../ViewHint.js';\nimport {scale as scaleCoordinate, rotate as rotateCoordinate, add as addCoordinate} from '../coordinate.js';\nimport {easeOut} from '../easing.js';\nimport {noModifierKeys} from '../events/condition.js';\nimport {FALSE} from '../functions.js';\nimport PointerInteraction, {centroid as centroidFromPointers} from '../interaction/Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a boolean\n * to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~noModifierKeys}.\n * @property {module:ol/Kinetic} [kinetic] Kinetic inertia to apply to the pan.\n */\n\n\n/**\n * @classdesc\n * Allows the user to pan the map by dragging the map.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/DragPan~Options=} opt_options Options.\n * @api\n */\nconst DragPan = function(opt_options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {module:ol/Kinetic|undefined}\n   */\n  this.kinetic_ = options.kinetic;\n\n  /**\n   * @type {module:ol~Pixel}\n   */\n  this.lastCentroid = null;\n\n  /**\n   * @type {number}\n   */\n  this.lastPointersCount_;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : noModifierKeys;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.noKinetic_ = false;\n\n};\n\ninherits(DragPan, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/DragPan}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  const targetPointers = this.targetPointers;\n  const centroid = centroidFromPointers(targetPointers);\n  if (targetPointers.length == this.lastPointersCount_) {\n    if (this.kinetic_) {\n      this.kinetic_.update(centroid[0], centroid[1]);\n    }\n    if (this.lastCentroid) {\n      const deltaX = this.lastCentroid[0] - centroid[0];\n      const deltaY = centroid[1] - this.lastCentroid[1];\n      const map = mapBrowserEvent.map;\n      const view = map.getView();\n      let center = [deltaX, deltaY];\n      scaleCoordinate(center, view.getResolution());\n      rotateCoordinate(center, view.getRotation());\n      addCoordinate(center, view.getCenter());\n      center = view.constrainCenter(center);\n      view.setCenter(center);\n    }\n  } else if (this.kinetic_) {\n    // reset so we don't overestimate the kinetic energy after\n    // after one finger down, tiny drag, second finger down\n    this.kinetic_.begin();\n  }\n  this.lastCentroid = centroid;\n  this.lastPointersCount_ = targetPointers.length;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/DragPan}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  if (this.targetPointers.length === 0) {\n    if (!this.noKinetic_ && this.kinetic_ && this.kinetic_.end()) {\n      const distance = this.kinetic_.getDistance();\n      const angle = this.kinetic_.getAngle();\n      const center = /** @type {!module:ol/coordinate~Coordinate} */ (view.getCenter());\n      const centerpx = map.getPixelFromCoordinate(center);\n      const dest = map.getCoordinateFromPixel([\n        centerpx[0] - distance * Math.cos(angle),\n        centerpx[1] - distance * Math.sin(angle)\n      ]);\n      view.animate({\n        center: view.constrainCenter(dest),\n        duration: 500,\n        easing: easeOut\n      });\n    }\n    view.setHint(ViewHint.INTERACTING, -1);\n    return false;\n  } else {\n    if (this.kinetic_) {\n      // reset so we don't overestimate the kinetic energy after\n      // after one finger up, tiny drag, second finger up\n      this.kinetic_.begin();\n    }\n    this.lastCentroid = null;\n    return true;\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/DragPan}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (this.targetPointers.length > 0 && this.condition_(mapBrowserEvent)) {\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n    this.lastCentroid = null;\n    if (!this.handlingDownUpSequence) {\n      view.setHint(ViewHint.INTERACTING, 1);\n    }\n    // stop any current animation\n    if (view.getAnimating()) {\n      view.setCenter(mapBrowserEvent.frameState.viewState.center);\n    }\n    if (this.kinetic_) {\n      this.kinetic_.begin();\n    }\n    // No kinetic as soon as more than one pointer on the screen is\n    // detected. This is to prevent nasty pans after pinch.\n    this.noKinetic_ = this.targetPointers.length > 1;\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\n/**\n * @inheritDoc\n */\nDragPan.prototype.shouldStopEvent = FALSE;\nexport default DragPan;\n","/**\n * @module ol/interaction/DragRotate\n */\nimport {inherits} from '../util.js';\nimport {disable} from '../rotationconstraint.js';\nimport ViewHint from '../ViewHint.js';\nimport {altShiftKeysOnly, mouseOnly, mouseActionButton} from '../events/condition.js';\nimport {FALSE} from '../functions.js';\nimport {rotate, rotateWithoutConstraints} from '../interaction/Interaction.js';\nimport PointerInteraction from '../interaction/Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that takes an\n * {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a boolean\n * to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~altShiftKeysOnly}.\n * @property {number} [duration=250] Animation duration in milliseconds.\n */\n\n\n/**\n * @classdesc\n * Allows the user to rotate the map by clicking and dragging on the map,\n * normally combined with an {@link module:ol/events/condition} that limits\n * it to when the alt and shift keys are held down.\n *\n * This interaction is only supported for mouse devices.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/DragRotate~Options=} opt_options Options.\n * @api\n */\nconst DragRotate = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : altShiftKeysOnly;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lastAngle_ = undefined;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n};\n\ninherits(DragRotate, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/DragRotate}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return;\n  }\n\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  if (view.getConstraints().rotation === disable) {\n    return;\n  }\n  const size = map.getSize();\n  const offset = mapBrowserEvent.pixel;\n  const theta =\n      Math.atan2(size[1] / 2 - offset[1], offset[0] - size[0] / 2);\n  if (this.lastAngle_ !== undefined) {\n    const delta = theta - this.lastAngle_;\n    const rotation = view.getRotation();\n    rotateWithoutConstraints(view, rotation - delta);\n  }\n  this.lastAngle_ = theta;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/DragRotate}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return true;\n  }\n\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  view.setHint(ViewHint.INTERACTING, -1);\n  const rotation = view.getRotation();\n  rotate(view, rotation, undefined, this.duration_);\n  return false;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/DragRotate}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return false;\n  }\n\n  if (mouseActionButton(mapBrowserEvent) && this.condition_(mapBrowserEvent)) {\n    const map = mapBrowserEvent.map;\n    map.getView().setHint(ViewHint.INTERACTING, 1);\n    this.lastAngle_ = undefined;\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\n/**\n * @inheritDoc\n */\nDragRotate.prototype.shouldStopEvent = FALSE;\nexport default DragRotate;\n","/**\n * @module ol/render/Box\n */\n// FIXME add rotation\n\nimport {inherits} from '../util.js';\nimport Disposable from '../Disposable.js';\nimport Polygon from '../geom/Polygon.js';\n\n/**\n * @constructor\n * @extends {module:ol/Disposable}\n * @param {string} className CSS class name.\n */\nconst RenderBox = function(className) {\n\n  /**\n   * @type {module:ol/geom/Polygon}\n   * @private\n   */\n  this.geometry_ = null;\n\n  /**\n   * @type {HTMLDivElement}\n   * @private\n   */\n  this.element_ = /** @type {HTMLDivElement} */ (document.createElement('div'));\n  this.element_.style.position = 'absolute';\n  this.element_.className = 'ol-box ' + className;\n\n  /**\n   * @private\n   * @type {module:ol/PluggableMap}\n   */\n  this.map_ = null;\n\n  /**\n   * @private\n   * @type {module:ol~Pixel}\n   */\n  this.startPixel_ = null;\n\n  /**\n   * @private\n   * @type {module:ol~Pixel}\n   */\n  this.endPixel_ = null;\n\n};\n\ninherits(RenderBox, Disposable);\n\n\n/**\n * @inheritDoc\n */\nRenderBox.prototype.disposeInternal = function() {\n  this.setMap(null);\n};\n\n\n/**\n * @private\n */\nRenderBox.prototype.render_ = function() {\n  const startPixel = this.startPixel_;\n  const endPixel = this.endPixel_;\n  const px = 'px';\n  const style = this.element_.style;\n  style.left = Math.min(startPixel[0], endPixel[0]) + px;\n  style.top = Math.min(startPixel[1], endPixel[1]) + px;\n  style.width = Math.abs(endPixel[0] - startPixel[0]) + px;\n  style.height = Math.abs(endPixel[1] - startPixel[1]) + px;\n};\n\n\n/**\n * @param {module:ol/PluggableMap} map Map.\n */\nRenderBox.prototype.setMap = function(map) {\n  if (this.map_) {\n    this.map_.getOverlayContainer().removeChild(this.element_);\n    const style = this.element_.style;\n    style.left = style.top = style.width = style.height = 'inherit';\n  }\n  this.map_ = map;\n  if (this.map_) {\n    this.map_.getOverlayContainer().appendChild(this.element_);\n  }\n};\n\n\n/**\n * @param {module:ol~Pixel} startPixel Start pixel.\n * @param {module:ol~Pixel} endPixel End pixel.\n */\nRenderBox.prototype.setPixels = function(startPixel, endPixel) {\n  this.startPixel_ = startPixel;\n  this.endPixel_ = endPixel;\n  this.createOrUpdateGeometry();\n  this.render_();\n};\n\n\n/**\n * Creates or updates the cached geometry.\n */\nRenderBox.prototype.createOrUpdateGeometry = function() {\n  const startPixel = this.startPixel_;\n  const endPixel = this.endPixel_;\n  const pixels = [\n    startPixel,\n    [startPixel[0], endPixel[1]],\n    endPixel,\n    [endPixel[0], startPixel[1]]\n  ];\n  const coordinates = pixels.map(this.map_.getCoordinateFromPixel, this.map_);\n  // close the polygon\n  coordinates[4] = coordinates[0].slice();\n  if (!this.geometry_) {\n    this.geometry_ = new Polygon([coordinates]);\n  } else {\n    this.geometry_.setCoordinates([coordinates]);\n  }\n};\n\n\n/**\n * @return {module:ol/geom/Polygon} Geometry.\n */\nRenderBox.prototype.getGeometry = function() {\n  return this.geometry_;\n};\nexport default RenderBox;\n","/**\n * @module ol/interaction/DragBox\n */\n// FIXME draw drag box\nimport Event from '../events/Event.js';\nimport {inherits} from '../util.js';\nimport {always, mouseOnly, mouseActionButton} from '../events/condition.js';\nimport {UNDEFINED} from '../functions.js';\nimport PointerInteraction from '../interaction/Pointer.js';\nimport RenderBox from '../render/Box.js';\n\n\n/**\n * A function that takes a {@link module:ol/MapBrowserEvent} and two\n * {@link module:ol~Pixel}s and returns a `{boolean}`. If the condition is met,\n * true should be returned.\n * @typedef {function(this: ?, module:ol/MapBrowserEvent, module:ol~Pixel, module:ol~Pixel):boolean} EndCondition\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-dragbox'] CSS class name for styling the box.\n * @property {module:ol/events/condition~Condition} [condition] A function that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a boolean\n * to indicate whether that event should be handled.\n * Default is {@link ol/events/condition~always}.\n * @property {number} [minArea=64] The minimum area of the box in pixel, this value is used by the default\n * `boxEndCondition` function.\n * @property {module:ol/interaction/DragBox~EndCondition} [boxEndCondition] A function that takes a {@link module:ol/MapBrowserEvent~MapBrowserEvent} and two\n * {@link module:ol~Pixel}s to indicate whether a `boxend` event should be fired.\n * Default is `true` if the area of the box is bigger than the `minArea` option.\n */\n\n\n/**\n * @enum {string}\n */\nconst DragBoxEventType = {\n  /**\n   * Triggered upon drag box start.\n   * @event module:ol/interaction/DragBox~DragBoxEvent#boxstart\n   * @api\n   */\n  BOXSTART: 'boxstart',\n\n  /**\n   * Triggered on drag when box is active.\n   * @event module:ol/interaction/DragBox~DragBoxEvent#boxdrag\n   * @api\n   */\n  BOXDRAG: 'boxdrag',\n\n  /**\n   * Triggered upon drag box end.\n   * @event module:ol/interaction/DragBox~DragBoxEvent#boxend\n   * @api\n   */\n  BOXEND: 'boxend'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/DragBox~DragBox} instances are instances of\n * this type.\n *\n * @param {string} type The event type.\n * @param {module:ol/coordinate~Coordinate} coordinate The event coordinate.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Originating event.\n * @extends {module:ol/events/Event}\n * @constructor\n */\nconst DragBoxEvent = function(type, coordinate, mapBrowserEvent) {\n  Event.call(this, type);\n\n  /**\n   * The coordinate of the drag event.\n   * @const\n   * @type {module:ol/coordinate~Coordinate}\n   * @api\n   */\n  this.coordinate = coordinate;\n\n  /**\n   * @const\n   * @type {module:ol/MapBrowserEvent}\n   * @api\n   */\n  this.mapBrowserEvent = mapBrowserEvent;\n\n};\n\ninherits(DragBoxEvent, Event);\n\n\n/**\n * @classdesc\n * Allows the user to draw a vector box by clicking and dragging on the map,\n * normally combined with an {@link module:ol/events/condition} that limits\n * it to when the shift or other key is held down. This is used, for example,\n * for zooming to a specific area of the map\n * (see {@link module:ol/interaction/DragZoom~DragZoom} and\n * {@link module:ol/interaction/DragRotateAndZoom}).\n *\n * This interaction is only supported for mouse devices.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @fires module:ol/interaction/DragBox~DragBoxEvent\n * @param {module:ol/interaction/DragBox~Options=} opt_options Options.\n * @api\n */\nconst DragBox = function(opt_options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @type {module:ol/render/Box}\n   * @private\n   */\n  this.box_ = new RenderBox(options.className || 'ol-dragbox');\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.minArea_ = options.minArea !== undefined ? options.minArea : 64;\n\n  /**\n   * @type {module:ol~Pixel}\n   * @private\n   */\n  this.startPixel_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : always;\n\n  /**\n   * @private\n   * @type {module:ol/interaction/DragBox~EndCondition}\n   */\n  this.boxEndCondition_ = options.boxEndCondition ?\n    options.boxEndCondition : defaultBoxEndCondition;\n};\n\ninherits(DragBox, PointerInteraction);\n\n\n/**\n * The default condition for determining whether the boxend event\n * should fire.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent The originating MapBrowserEvent\n *     leading to the box end.\n * @param {module:ol~Pixel} startPixel The starting pixel of the box.\n * @param {module:ol~Pixel} endPixel The end pixel of the box.\n * @return {boolean} Whether or not the boxend condition should be fired.\n * @this {module:ol/interaction/DragBox}\n */\nfunction defaultBoxEndCondition(mapBrowserEvent, startPixel, endPixel) {\n  const width = endPixel[0] - startPixel[0];\n  const height = endPixel[1] - startPixel[1];\n  return width * width + height * height >= this.minArea_;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/DragBox}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return;\n  }\n\n  this.box_.setPixels(this.startPixel_, mapBrowserEvent.pixel);\n\n  this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXDRAG,\n    mapBrowserEvent.coordinate, mapBrowserEvent));\n}\n\n\n/**\n * Returns geometry of last drawn box.\n * @return {module:ol/geom/Polygon} Geometry.\n * @api\n */\nDragBox.prototype.getGeometry = function() {\n  return this.box_.getGeometry();\n};\n\n\n/**\n * To be overridden by child classes.\n * FIXME: use constructor option instead of relying on overriding.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @protected\n */\nDragBox.prototype.onBoxEnd = UNDEFINED;\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/DragBox}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return true;\n  }\n\n  this.box_.setMap(null);\n\n  if (this.boxEndCondition_(mapBrowserEvent,\n    this.startPixel_, mapBrowserEvent.pixel)) {\n    this.onBoxEnd(mapBrowserEvent);\n    this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXEND,\n      mapBrowserEvent.coordinate, mapBrowserEvent));\n  }\n  return false;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/DragBox}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return false;\n  }\n\n  if (mouseActionButton(mapBrowserEvent) &&\n      this.condition_(mapBrowserEvent)) {\n    this.startPixel_ = mapBrowserEvent.pixel;\n    this.box_.setMap(mapBrowserEvent.map);\n    this.box_.setPixels(this.startPixel_, this.startPixel_);\n    this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXSTART,\n      mapBrowserEvent.coordinate, mapBrowserEvent));\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\nexport default DragBox;\n","/**\n * @module ol/interaction/DragZoom\n */\nimport {inherits} from '../util.js';\nimport {easeOut} from '../easing.js';\nimport {shiftKeyOnly} from '../events/condition.js';\nimport {createOrUpdateFromCoordinates, getBottomLeft, getCenter, getTopRight, scaleFromCenter} from '../extent.js';\nimport DragBox from '../interaction/DragBox.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-dragzoom'] CSS class name for styling the\n * box.\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~shiftKeyOnly}.\n * @property {number} [duration=200] Animation duration in milliseconds.\n * @property {boolean} [out=false] Use interaction for zooming out.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map by clicking and dragging on the map,\n * normally combined with an {@link module:ol/events/condition} that limits\n * it to when a key, shift by default, is held down.\n *\n * To change the style of the box, use CSS and the `.ol-dragzoom` selector, or\n * your custom one configured with `className`.\n *\n * @constructor\n * @extends {module:ol/interaction/DragBox}\n * @param {module:ol/interaction/DragZoom~Options=} opt_options Options.\n * @api\n */\nconst DragZoom = function(opt_options) {\n  const options = opt_options ? opt_options : {};\n\n  const condition = options.condition ? options.condition : shiftKeyOnly;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 200;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.out_ = options.out !== undefined ? options.out : false;\n\n  DragBox.call(this, {\n    condition: condition,\n    className: options.className || 'ol-dragzoom'\n  });\n\n};\n\ninherits(DragZoom, DragBox);\n\n\n/**\n * @inheritDoc\n */\nDragZoom.prototype.onBoxEnd = function() {\n  const map = this.getMap();\n\n  const view = /** @type {!module:ol/View} */ (map.getView());\n\n  const size = /** @type {!module:ol/size~Size} */ (map.getSize());\n\n  let extent = this.getGeometry().getExtent();\n\n  if (this.out_) {\n    const mapExtent = view.calculateExtent(size);\n    const boxPixelExtent = createOrUpdateFromCoordinates([\n      map.getPixelFromCoordinate(getBottomLeft(extent)),\n      map.getPixelFromCoordinate(getTopRight(extent))]);\n    const factor = view.getResolutionForExtent(boxPixelExtent, size);\n\n    scaleFromCenter(mapExtent, 1 / factor);\n    extent = mapExtent;\n  }\n\n  const resolution = view.constrainResolution(\n    view.getResolutionForExtent(extent, size));\n\n  let center = getCenter(extent);\n  center = view.constrainCenter(center);\n\n  view.animate({\n    resolution: resolution,\n    center: center,\n    duration: this.duration_,\n    easing: easeOut\n  });\n\n};\nexport default DragZoom;\n","/**\n * @module ol/events/KeyCode\n */\n\n/**\n * @enum {number}\n * @const\n */\nexport default {\n  LEFT: 37,\n  UP: 38,\n  RIGHT: 39,\n  DOWN: 40\n};\n","/**\n * @module ol/interaction/KeyboardPan\n */\nimport {inherits} from '../util.js';\nimport {rotate as rotateCoordinate} from '../coordinate.js';\nimport EventType from '../events/EventType.js';\nimport KeyCode from '../events/KeyCode.js';\nimport {noModifierKeys, targetNotEditable} from '../events/condition.js';\nimport Interaction, {pan} from '../interaction/Interaction.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. Default is\n * {@link module:ol/events/condition~noModifierKeys} and\n * {@link module:ol/events/condition~targetNotEditable}.\n * @property {number} [duration=100] Animation duration in milliseconds.\n * @property {number} [pixelDelta=128] The amount of pixels to pan on each key\n * press.\n */\n\n\n/**\n * @classdesc\n * Allows the user to pan the map using keyboard arrows.\n * Note that, although this interaction is by default included in maps,\n * the keys can only be used when browser focus is on the element to which\n * the keyboard events are attached. By default, this is the map div,\n * though you can change this with the `keyboardEventTarget` in\n * {@link module:ol/Map~Map}. `document` never loses focus but, for any other\n * element, focus will have to be on, and returned to, this element if the keys\n * are to function.\n * See also {@link module:ol/interaction/KeyboardZoom~KeyboardZoom}.\n *\n * @constructor\n * @extends {module:ol/interaction/Interaction}\n * @param {module:ol/interaction/KeyboardPan~Options=} opt_options Options.\n * @api\n */\nconst KeyboardPan = function(opt_options) {\n\n  Interaction.call(this, {\n    handleEvent: handleEvent\n  });\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @param {module:ol/MapBrowserEvent} mapBrowserEvent Browser event.\n   * @return {boolean} Combined condition result.\n   */\n  this.defaultCondition_ = function(mapBrowserEvent) {\n    return noModifierKeys(mapBrowserEvent) &&\n      targetNotEditable(mapBrowserEvent);\n  };\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition !== undefined ?\n    options.condition : this.defaultCondition_;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 100;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelDelta_ = options.pixelDelta !== undefined ?\n    options.pixelDelta : 128;\n\n};\n\ninherits(KeyboardPan, Interaction);\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} if it was a\n * `KeyEvent`, and decides the direction to pan to (if an arrow key was\n * pressed).\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/KeyboardPan}\n */\nfunction handleEvent(mapBrowserEvent) {\n  let stopEvent = false;\n  if (mapBrowserEvent.type == EventType.KEYDOWN) {\n    const keyEvent = mapBrowserEvent.originalEvent;\n    const keyCode = keyEvent.keyCode;\n    if (this.condition_(mapBrowserEvent) &&\n        (keyCode == KeyCode.DOWN ||\n        keyCode == KeyCode.LEFT ||\n        keyCode == KeyCode.RIGHT ||\n        keyCode == KeyCode.UP)) {\n      const map = mapBrowserEvent.map;\n      const view = map.getView();\n      const mapUnitsDelta = view.getResolution() * this.pixelDelta_;\n      let deltaX = 0, deltaY = 0;\n      if (keyCode == KeyCode.DOWN) {\n        deltaY = -mapUnitsDelta;\n      } else if (keyCode == KeyCode.LEFT) {\n        deltaX = -mapUnitsDelta;\n      } else if (keyCode == KeyCode.RIGHT) {\n        deltaX = mapUnitsDelta;\n      } else {\n        deltaY = mapUnitsDelta;\n      }\n      const delta = [deltaX, deltaY];\n      rotateCoordinate(delta, view.getRotation());\n      pan(view, delta, this.duration_);\n      mapBrowserEvent.preventDefault();\n      stopEvent = true;\n    }\n  }\n  return !stopEvent;\n}\n\nexport default KeyboardPan;\n","/**\n * @module ol/interaction/KeyboardZoom\n */\nimport {inherits} from '../util.js';\nimport EventType from '../events/EventType.js';\nimport {targetNotEditable} from '../events/condition.js';\nimport Interaction, {zoomByDelta} from '../interaction/Interaction.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=100] Animation duration in milliseconds.\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. Default is\n * {@link module:ol/events/condition~targetNotEditable}.\n * @property {number} [delta=1] The zoom level delta on each key press.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map using keyboard + and -.\n * Note that, although this interaction is by default included in maps,\n * the keys can only be used when browser focus is on the element to which\n * the keyboard events are attached. By default, this is the map div,\n * though you can change this with the `keyboardEventTarget` in\n * {@link module:ol/Map~Map}. `document` never loses focus but, for any other\n * element, focus will have to be on, and returned to, this element if the keys\n * are to function.\n * See also {@link moudle:ol/interaction/KeyboardPan~KeyboardPan}.\n *\n * @constructor\n * @param {module:ol/interaction/KeyboardZoom~Options=} opt_options Options.\n * @extends {module:ol/interaction/Interaction}\n * @api\n */\nconst KeyboardZoom = function(opt_options) {\n\n  Interaction.call(this, {\n    handleEvent: handleEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : targetNotEditable;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.delta_ = options.delta ? options.delta : 1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 100;\n\n};\n\ninherits(KeyboardZoom, Interaction);\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} if it was a\n * `KeyEvent`, and decides whether to zoom in or out (depending on whether the\n * key pressed was '+' or '-').\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/KeyboardZoom}\n */\nfunction handleEvent(mapBrowserEvent) {\n  let stopEvent = false;\n  if (mapBrowserEvent.type == EventType.KEYDOWN ||\n      mapBrowserEvent.type == EventType.KEYPRESS) {\n    const keyEvent = mapBrowserEvent.originalEvent;\n    const charCode = keyEvent.charCode;\n    if (this.condition_(mapBrowserEvent) &&\n        (charCode == '+'.charCodeAt(0) || charCode == '-'.charCodeAt(0))) {\n      const map = mapBrowserEvent.map;\n      const delta = (charCode == '+'.charCodeAt(0)) ? this.delta_ : -this.delta_;\n      const view = map.getView();\n      zoomByDelta(view, delta, undefined, this.duration_);\n      mapBrowserEvent.preventDefault();\n      stopEvent = true;\n    }\n  }\n  return !stopEvent;\n}\n\nexport default KeyboardZoom;\n","/**\n * @module ol/interaction/MouseWheelZoom\n */\nimport {inherits} from '../util.js';\nimport ViewHint from '../ViewHint.js';\nimport {always} from '../events/condition.js';\nimport {easeOut} from '../easing.js';\nimport EventType from '../events/EventType.js';\nimport {DEVICE_PIXEL_RATIO, FIREFOX, SAFARI} from '../has.js';\nimport Interaction, {zoomByDelta} from '../interaction/Interaction.js';\nimport {clamp} from '../math.js';\n\n\n/**\n * Maximum mouse wheel delta.\n * @type {number}\n */\nconst MAX_DELTA = 1;\n\n\n/**\n * @enum {string}\n */\nexport const Mode = {\n  TRACKPAD: 'trackpad',\n  WHEEL: 'wheel'\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. Default is\n * {@link module:ol/events/condition~always}.\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {number} [timeout=80] Mouse wheel timeout duration in milliseconds.\n * @property {boolean} [constrainResolution=false] When using a trackpad or\n * magic mouse, zoom to the closest integer zoom level after the scroll gesture\n * ends.\n * @property {boolean} [useAnchor=true] Enable zooming using the mouse's\n * location as the anchor. When set to `false`, zooming in and out will zoom to\n * the center of the screen instead of zooming on the mouse's location.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map by scrolling the mouse wheel.\n *\n * @constructor\n * @extends {module:ol/interaction/Interaction}\n * @param {module:ol/interaction/MouseWheelZoom~Options=} opt_options Options.\n * @api\n */\nconst MouseWheelZoom = function(opt_options) {\n\n  Interaction.call(this, {\n    handleEvent: handleEvent\n  });\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.delta_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.timeout_ = options.timeout !== undefined ? options.timeout : 80;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.useAnchor_ = options.useAnchor !== undefined ? options.useAnchor : true;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.constrainResolution_ = options.constrainResolution || false;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : always;\n\n  /**\n   * @private\n   * @type {?module:ol/coordinate~Coordinate}\n   */\n  this.lastAnchor_ = null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.startTime_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.timeoutId_ = undefined;\n\n  /**\n   * @private\n   * @type {module:ol/interaction/MouseWheelZoom~Mode|undefined}\n   */\n  this.mode_ = undefined;\n\n  /**\n   * Trackpad events separated by this delay will be considered separate\n   * interactions.\n   * @type {number}\n   */\n  this.trackpadEventGap_ = 400;\n\n  /**\n   * @type {number|undefined}\n   */\n  this.trackpadTimeoutId_ = undefined;\n\n  /**\n   * The number of delta values per zoom level\n   * @private\n   * @type {number}\n   */\n  this.trackpadDeltaPerZoom_ = 300;\n\n  /**\n   * The zoom factor by which scroll zooming is allowed to exceed the limits.\n   * @private\n   * @type {number}\n   */\n  this.trackpadZoomBuffer_ = 1.5;\n\n};\n\ninherits(MouseWheelZoom, Interaction);\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} (if it was a\n * mousewheel-event) and eventually zooms the map.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} Allow event propagation.\n * @this {module:ol/interaction/MouseWheelZoom}\n */\nfunction handleEvent(mapBrowserEvent) {\n  if (!this.condition_(mapBrowserEvent)) {\n    return true;\n  }\n  const type = mapBrowserEvent.type;\n  if (type !== EventType.WHEEL && type !== EventType.MOUSEWHEEL) {\n    return true;\n  }\n\n  mapBrowserEvent.preventDefault();\n\n  const map = mapBrowserEvent.map;\n  const wheelEvent = /** @type {WheelEvent} */ (mapBrowserEvent.originalEvent);\n\n  if (this.useAnchor_) {\n    this.lastAnchor_ = mapBrowserEvent.coordinate;\n  }\n\n  // Delta normalisation inspired by\n  // https://github.com/mapbox/mapbox-gl-js/blob/001c7b9/js/ui/handler/scroll_zoom.js\n  let delta;\n  if (mapBrowserEvent.type == EventType.WHEEL) {\n    delta = wheelEvent.deltaY;\n    if (FIREFOX &&\n        wheelEvent.deltaMode === WheelEvent.DOM_DELTA_PIXEL) {\n      delta /= DEVICE_PIXEL_RATIO;\n    }\n    if (wheelEvent.deltaMode === WheelEvent.DOM_DELTA_LINE) {\n      delta *= 40;\n    }\n  } else if (mapBrowserEvent.type == EventType.MOUSEWHEEL) {\n    delta = -wheelEvent.wheelDeltaY;\n    if (SAFARI) {\n      delta /= 3;\n    }\n  }\n\n  if (delta === 0) {\n    return false;\n  }\n\n  const now = Date.now();\n\n  if (this.startTime_ === undefined) {\n    this.startTime_ = now;\n  }\n\n  if (!this.mode_ || now - this.startTime_ > this.trackpadEventGap_) {\n    this.mode_ = Math.abs(delta) < 4 ?\n      Mode.TRACKPAD :\n      Mode.WHEEL;\n  }\n\n  if (this.mode_ === Mode.TRACKPAD) {\n    const view = map.getView();\n    if (this.trackpadTimeoutId_) {\n      clearTimeout(this.trackpadTimeoutId_);\n    } else {\n      view.setHint(ViewHint.INTERACTING, 1);\n    }\n    this.trackpadTimeoutId_ = setTimeout(this.decrementInteractingHint_.bind(this), this.trackpadEventGap_);\n    let resolution = view.getResolution() * Math.pow(2, delta / this.trackpadDeltaPerZoom_);\n    const minResolution = view.getMinResolution();\n    const maxResolution = view.getMaxResolution();\n    let rebound = 0;\n    if (resolution < minResolution) {\n      resolution = Math.max(resolution, minResolution / this.trackpadZoomBuffer_);\n      rebound = 1;\n    } else if (resolution > maxResolution) {\n      resolution = Math.min(resolution, maxResolution * this.trackpadZoomBuffer_);\n      rebound = -1;\n    }\n    if (this.lastAnchor_) {\n      const center = view.calculateCenterZoom(resolution, this.lastAnchor_);\n      view.setCenter(view.constrainCenter(center));\n    }\n    view.setResolution(resolution);\n\n    if (rebound === 0 && this.constrainResolution_) {\n      view.animate({\n        resolution: view.constrainResolution(resolution, delta > 0 ? -1 : 1),\n        easing: easeOut,\n        anchor: this.lastAnchor_,\n        duration: this.duration_\n      });\n    }\n\n    if (rebound > 0) {\n      view.animate({\n        resolution: minResolution,\n        easing: easeOut,\n        anchor: this.lastAnchor_,\n        duration: 500\n      });\n    } else if (rebound < 0) {\n      view.animate({\n        resolution: maxResolution,\n        easing: easeOut,\n        anchor: this.lastAnchor_,\n        duration: 500\n      });\n    }\n    this.startTime_ = now;\n    return false;\n  }\n\n  this.delta_ += delta;\n\n  const timeLeft = Math.max(this.timeout_ - (now - this.startTime_), 0);\n\n  clearTimeout(this.timeoutId_);\n  this.timeoutId_ = setTimeout(this.handleWheelZoom_.bind(this, map), timeLeft);\n\n  return false;\n}\n\n\n/**\n * @private\n */\nMouseWheelZoom.prototype.decrementInteractingHint_ = function() {\n  this.trackpadTimeoutId_ = undefined;\n  const view = this.getMap().getView();\n  view.setHint(ViewHint.INTERACTING, -1);\n};\n\n\n/**\n * @private\n * @param {module:ol/PluggableMap} map Map.\n */\nMouseWheelZoom.prototype.handleWheelZoom_ = function(map) {\n  const view = map.getView();\n  if (view.getAnimating()) {\n    view.cancelAnimations();\n  }\n  const maxDelta = MAX_DELTA;\n  const delta = clamp(this.delta_, -maxDelta, maxDelta);\n  zoomByDelta(view, -delta, this.lastAnchor_, this.duration_);\n  this.mode_ = undefined;\n  this.delta_ = 0;\n  this.lastAnchor_ = null;\n  this.startTime_ = undefined;\n  this.timeoutId_ = undefined;\n};\n\n\n/**\n * Enable or disable using the mouse's location as an anchor when zooming\n * @param {boolean} useAnchor true to zoom to the mouse's location, false\n * to zoom to the center of the map\n * @api\n */\nMouseWheelZoom.prototype.setMouseAnchor = function(useAnchor) {\n  this.useAnchor_ = useAnchor;\n  if (!useAnchor) {\n    this.lastAnchor_ = null;\n  }\n};\n\n\nexport default MouseWheelZoom;\n","/**\n * @module ol/interaction/PinchRotate\n */\nimport {inherits} from '../util.js';\nimport ViewHint from '../ViewHint.js';\nimport {FALSE} from '../functions.js';\nimport {rotate, rotateWithoutConstraints} from '../interaction/Interaction.js';\nimport PointerInteraction, {centroid as centroidFromPointers} from '../interaction/Pointer.js';\nimport {disable} from '../rotationconstraint.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=250] The duration of the animation in\n * milliseconds.\n * @property {number} [threshold=0.3] Minimal angle in radians to start a rotation.\n */\n\n\n/**\n * @classdesc\n * Allows the user to rotate the map by twisting with two fingers\n * on a touch screen.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/PinchRotate~Options=} opt_options Options.\n * @api\n */\nconst PinchRotate = function(opt_options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options || {};\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.anchor_ = null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lastAngle_ = undefined;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.rotating_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.rotationDelta_ = 0.0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.threshold_ = options.threshold !== undefined ? options.threshold : 0.3;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n};\n\ninherits(PinchRotate, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/PinchRotate}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  let rotationDelta = 0.0;\n\n  const touch0 = this.targetPointers[0];\n  const touch1 = this.targetPointers[1];\n\n  // angle between touches\n  const angle = Math.atan2(\n    touch1.clientY - touch0.clientY,\n    touch1.clientX - touch0.clientX);\n\n  if (this.lastAngle_ !== undefined) {\n    const delta = angle - this.lastAngle_;\n    this.rotationDelta_ += delta;\n    if (!this.rotating_ &&\n        Math.abs(this.rotationDelta_) > this.threshold_) {\n      this.rotating_ = true;\n    }\n    rotationDelta = delta;\n  }\n  this.lastAngle_ = angle;\n\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  if (view.getConstraints().rotation === disable) {\n    return;\n  }\n\n  // rotate anchor point.\n  // FIXME: should be the intersection point between the lines:\n  //     touch0,touch1 and previousTouch0,previousTouch1\n  const viewportPosition = map.getViewport().getBoundingClientRect();\n  const centroid = centroidFromPointers(this.targetPointers);\n  centroid[0] -= viewportPosition.left;\n  centroid[1] -= viewportPosition.top;\n  this.anchor_ = map.getCoordinateFromPixel(centroid);\n\n  // rotate\n  if (this.rotating_) {\n    const rotation = view.getRotation();\n    map.render();\n    rotateWithoutConstraints(view, rotation + rotationDelta, this.anchor_);\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/PinchRotate}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  if (this.targetPointers.length < 2) {\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n    view.setHint(ViewHint.INTERACTING, -1);\n    if (this.rotating_) {\n      const rotation = view.getRotation();\n      rotate(view, rotation, this.anchor_, this.duration_);\n    }\n    return false;\n  } else {\n    return true;\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/PinchRotate}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (this.targetPointers.length >= 2) {\n    const map = mapBrowserEvent.map;\n    this.anchor_ = null;\n    this.lastAngle_ = undefined;\n    this.rotating_ = false;\n    this.rotationDelta_ = 0.0;\n    if (!this.handlingDownUpSequence) {\n      map.getView().setHint(ViewHint.INTERACTING, 1);\n    }\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\n/**\n * @inheritDoc\n */\nPinchRotate.prototype.shouldStopEvent = FALSE;\n\nexport default PinchRotate;\n","/**\n * @module ol/interaction/PinchZoom\n */\nimport {inherits} from '../util.js';\nimport ViewHint from '../ViewHint.js';\nimport {FALSE} from '../functions.js';\nimport {zoom, zoomWithoutConstraints} from '../interaction/Interaction.js';\nimport PointerInteraction, {centroid as centroidFromPointers} from '../interaction/Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=400] Animation duration in milliseconds.\n * @property {boolean} [constrainResolution=false] Zoom to the closest integer\n * zoom level after the pinch gesture ends.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map by pinching with two fingers\n * on a touch screen.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/PinchZoom~Options=} opt_options Options.\n * @api\n */\nconst PinchZoom = function(opt_options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.constrainResolution_ = options.constrainResolution || false;\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.anchor_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 400;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lastDistance_ = undefined;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.lastScaleDelta_ = 1;\n\n};\n\ninherits(PinchZoom, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/PinchZoom}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  let scaleDelta = 1.0;\n\n  const touch0 = this.targetPointers[0];\n  const touch1 = this.targetPointers[1];\n  const dx = touch0.clientX - touch1.clientX;\n  const dy = touch0.clientY - touch1.clientY;\n\n  // distance between touches\n  const distance = Math.sqrt(dx * dx + dy * dy);\n\n  if (this.lastDistance_ !== undefined) {\n    scaleDelta = this.lastDistance_ / distance;\n  }\n  this.lastDistance_ = distance;\n\n\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  const resolution = view.getResolution();\n  const maxResolution = view.getMaxResolution();\n  const minResolution = view.getMinResolution();\n  let newResolution = resolution * scaleDelta;\n  if (newResolution > maxResolution) {\n    scaleDelta = maxResolution / resolution;\n    newResolution = maxResolution;\n  } else if (newResolution < minResolution) {\n    scaleDelta = minResolution / resolution;\n    newResolution = minResolution;\n  }\n\n  if (scaleDelta != 1.0) {\n    this.lastScaleDelta_ = scaleDelta;\n  }\n\n  // scale anchor point.\n  const viewportPosition = map.getViewport().getBoundingClientRect();\n  const centroid = centroidFromPointers(this.targetPointers);\n  centroid[0] -= viewportPosition.left;\n  centroid[1] -= viewportPosition.top;\n  this.anchor_ = map.getCoordinateFromPixel(centroid);\n\n  // scale, bypass the resolution constraint\n  map.render();\n  zoomWithoutConstraints(view, newResolution, this.anchor_);\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/PinchZoom}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  if (this.targetPointers.length < 2) {\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n    view.setHint(ViewHint.INTERACTING, -1);\n    const resolution = view.getResolution();\n    if (this.constrainResolution_ ||\n        resolution < view.getMinResolution() ||\n        resolution > view.getMaxResolution()) {\n      // Zoom to final resolution, with an animation, and provide a\n      // direction not to zoom out/in if user was pinching in/out.\n      // Direction is > 0 if pinching out, and < 0 if pinching in.\n      const direction = this.lastScaleDelta_ - 1;\n      zoom(view, resolution, this.anchor_, this.duration_, direction);\n    }\n    return false;\n  } else {\n    return true;\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/PinchZoom}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (this.targetPointers.length >= 2) {\n    const map = mapBrowserEvent.map;\n    this.anchor_ = null;\n    this.lastDistance_ = undefined;\n    this.lastScaleDelta_ = 1;\n    if (!this.handlingDownUpSequence) {\n      map.getView().setHint(ViewHint.INTERACTING, 1);\n    }\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\n/**\n * @inheritDoc\n */\nPinchZoom.prototype.shouldStopEvent = FALSE;\nexport default PinchZoom;\n","/**\n * @module ol/interaction/DragAndDrop\n */\n// FIXME should handle all geo-referenced data, not just vector data\n\nimport {inherits} from '../util.js';\nimport {TRUE} from '../functions.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport Interaction from '../interaction/Interaction.js';\nimport {get as getProjection} from '../proj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {Array.<function(new: module:ol/format/Feature)>} [formatConstructors] Format constructors.\n * @property {module:ol/source/Vector} [source] Optional vector source where features will be added.  If a source is provided\n * all existing features will be removed and new features will be added when\n * they are dropped on the target.  If you want to add features to a vector\n * source without removing the existing features (append only), instead of\n * providing the source option listen for the \"addfeatures\" event.\n * @property {module:ol/proj~ProjectionLike} [projection] Target projection. By default, the map's view's projection is used.\n * @property {Element} [target] The element that is used as the drop target, default is the viewport element.\n */\n\n\n/**\n * @enum {string}\n */\nconst DragAndDropEventType = {\n  /**\n   * Triggered when features are added\n   * @event module:ol/interaction/DragAndDrop~DragAndDropEvent#addfeatures\n   * @api\n   */\n  ADD_FEATURES: 'addfeatures'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/DragAndDrop~DragAndDrop} instances are instances\n * of this type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {module:ol/interaction/DragAndDrop~DragAndDropEventType} type Type.\n * @param {File} file File.\n * @param {Array.<module:ol/Feature>=} opt_features Features.\n * @param {module:ol/proj/Projection=} opt_projection Projection.\n */\nconst DragAndDropEvent = function(type, file, opt_features, opt_projection) {\n\n  Event.call(this, type);\n\n  /**\n   * The features parsed from dropped data.\n   * @type {Array.<module:ol/Feature>|undefined}\n   * @api\n   */\n  this.features = opt_features;\n\n  /**\n   * The dropped file.\n   * @type {File}\n   * @api\n   */\n  this.file = file;\n\n  /**\n   * The feature projection.\n   * @type {module:ol/proj/Projection|undefined}\n   * @api\n   */\n  this.projection = opt_projection;\n\n};\ninherits(DragAndDropEvent, Event);\n\n\n/**\n * @classdesc\n * Handles input of vector data by drag and drop.\n *\n * @constructor\n * @extends {module:ol/interaction/Interaction}\n * @fires module:ol/interaction/DragAndDrop~DragAndDropEvent\n * @param {module:ol/interaction/DragAndDrop~Options=} opt_options Options.\n * @api\n */\nconst DragAndDrop = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  Interaction.call(this, {\n    handleEvent: TRUE\n  });\n\n  /**\n   * @private\n   * @type {Array.<function(new: module:ol/format/Feature)>}\n   */\n  this.formatConstructors_ = options.formatConstructors ?\n    options.formatConstructors : [];\n\n  /**\n   * @private\n   * @type {module:ol/proj/Projection}\n   */\n  this.projection_ = options.projection ?\n    getProjection(options.projection) : null;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.dropListenKeys_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/source/Vector}\n   */\n  this.source_ = options.source || null;\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.target = options.target ? options.target : null;\n\n};\n\ninherits(DragAndDrop, Interaction);\n\n\n/**\n * @param {DragEvent} event Event.\n * @this {module:ol/interaction/DragAndDrop}\n */\nfunction handleDrop(event) {\n  const files = event.dataTransfer.files;\n  for (let i = 0, ii = files.length; i < ii; ++i) {\n    const file = files.item(i);\n    const reader = new FileReader();\n    reader.addEventListener(EventType.LOAD, this.handleResult_.bind(this, file));\n    reader.readAsText(file);\n  }\n}\n\n\n/**\n * @param {DragEvent} event Event.\n */\nfunction handleStop(event) {\n  event.stopPropagation();\n  event.preventDefault();\n  event.dataTransfer.dropEffect = 'copy';\n}\n\n\n/**\n * @param {File} file File.\n * @param {Event} event Load event.\n * @private\n */\nDragAndDrop.prototype.handleResult_ = function(file, event) {\n  const result = event.target.result;\n  const map = this.getMap();\n  let projection = this.projection_;\n  if (!projection) {\n    const view = map.getView();\n    projection = view.getProjection();\n  }\n\n  const formatConstructors = this.formatConstructors_;\n  let features = [];\n  for (let i = 0, ii = formatConstructors.length; i < ii; ++i) {\n    /**\n     * Avoid \"cannot instantiate abstract class\" error.\n     * @type {Function}\n     */\n    const formatConstructor = formatConstructors[i];\n    /**\n     * @type {module:ol/format/Feature}\n     */\n    const format = new formatConstructor();\n    features = this.tryReadFeatures_(format, result, {\n      featureProjection: projection\n    });\n    if (features && features.length > 0) {\n      break;\n    }\n  }\n  if (this.source_) {\n    this.source_.clear();\n    this.source_.addFeatures(features);\n  }\n  this.dispatchEvent(\n    new DragAndDropEvent(\n      DragAndDropEventType.ADD_FEATURES, file,\n      features, projection));\n};\n\n\n/**\n * @private\n */\nDragAndDrop.prototype.registerListeners_ = function() {\n  const map = this.getMap();\n  if (map) {\n    const dropArea = this.target ? this.target : map.getViewport();\n    this.dropListenKeys_ = [\n      listen(dropArea, EventType.DROP, handleDrop, this),\n      listen(dropArea, EventType.DRAGENTER, handleStop, this),\n      listen(dropArea, EventType.DRAGOVER, handleStop, this),\n      listen(dropArea, EventType.DROP, handleStop, this)\n    ];\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nDragAndDrop.prototype.setActive = function(active) {\n  Interaction.prototype.setActive.call(this, active);\n  if (active) {\n    this.registerListeners_();\n  } else {\n    this.unregisterListeners_();\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nDragAndDrop.prototype.setMap = function(map) {\n  this.unregisterListeners_();\n  Interaction.prototype.setMap.call(this, map);\n  if (this.getActive()) {\n    this.registerListeners_();\n  }\n};\n\n\n/**\n * @param {module:ol/format/Feature} format Format.\n * @param {string} text Text.\n * @param {module:ol/format/Feature~ReadOptions} options Read options.\n * @private\n * @return {Array.<module:ol/Feature>} Features.\n */\nDragAndDrop.prototype.tryReadFeatures_ = function(format, text, options) {\n  try {\n    return format.readFeatures(text, options);\n  } catch (e) {\n    return null;\n  }\n};\n\n\n/**\n * @private\n */\nDragAndDrop.prototype.unregisterListeners_ = function() {\n  if (this.dropListenKeys_) {\n    this.dropListenKeys_.forEach(unlistenByKey);\n    this.dropListenKeys_ = null;\n  }\n};\n\n\nexport default DragAndDrop;\n","/**\n * @module ol/interaction/DragRotateAndZoom\n */\nimport {inherits} from '../util.js';\nimport {disable} from '../rotationconstraint.js';\nimport ViewHint from '../ViewHint.js';\nimport {shiftKeyOnly, mouseOnly} from '../events/condition.js';\nimport {rotate, rotateWithoutConstraints, zoom, zoomWithoutConstraints} from '../interaction/Interaction.js';\nimport PointerInteraction from '../interaction/Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~shiftKeyOnly}.\n * @property {number} [duration=400] Animation duration in milliseconds.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom and rotate the map by clicking and dragging\n * on the map.  By default, this interaction is limited to when the shift\n * key is held down.\n *\n * This interaction is only supported for mouse devices.\n *\n * And this interaction is not included in the default interactions.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/DragRotateAndZoom~Options=} opt_options Options.\n * @api\n */\nconst DragRotateAndZoom = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : shiftKeyOnly;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lastAngle_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.lastMagnitude_ = undefined;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.lastScaleDelta_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 400;\n\n};\n\ninherits(DragRotateAndZoom, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @this {module:ol/interaction/DragRotateAndZoom}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return;\n  }\n\n  const map = mapBrowserEvent.map;\n  const size = map.getSize();\n  const offset = mapBrowserEvent.pixel;\n  const deltaX = offset[0] - size[0] / 2;\n  const deltaY = size[1] / 2 - offset[1];\n  const theta = Math.atan2(deltaY, deltaX);\n  const magnitude = Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n  const view = map.getView();\n  if (view.getConstraints().rotation !== disable && this.lastAngle_ !== undefined) {\n    const angleDelta = theta - this.lastAngle_;\n    rotateWithoutConstraints(view, view.getRotation() - angleDelta);\n  }\n  this.lastAngle_ = theta;\n  if (this.lastMagnitude_ !== undefined) {\n    const resolution = this.lastMagnitude_ * (view.getResolution() / magnitude);\n    zoomWithoutConstraints(view, resolution);\n  }\n  if (this.lastMagnitude_ !== undefined) {\n    this.lastScaleDelta_ = this.lastMagnitude_ / magnitude;\n  }\n  this.lastMagnitude_ = magnitude;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/DragRotateAndZoom}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return true;\n  }\n\n  const map = mapBrowserEvent.map;\n  const view = map.getView();\n  view.setHint(ViewHint.INTERACTING, -1);\n  const direction = this.lastScaleDelta_ - 1;\n  rotate(view, view.getRotation());\n  zoom(view, view.getResolution(), undefined, this.duration_, direction);\n  this.lastScaleDelta_ = 0;\n  return false;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/DragRotateAndZoom}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  if (!mouseOnly(mapBrowserEvent)) {\n    return false;\n  }\n\n  if (this.condition_(mapBrowserEvent)) {\n    mapBrowserEvent.map.getView().setHint(ViewHint.INTERACTING, 1);\n    this.lastAngle_ = undefined;\n    this.lastMagnitude_ = undefined;\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport default DragRotateAndZoom;\n","/**\n * @module ol/geom/Circle\n */\nimport {inherits} from '../util.js';\nimport {createOrUpdate, forEachCorner, intersects} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {deflateCoordinate} from '../geom/flat/deflate.js';\n\n/**\n * @classdesc\n * Circle geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number=} opt_radius Radius.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst Circle = function(center, opt_radius, opt_layout) {\n  SimpleGeometry.call(this);\n  const radius = opt_radius ? opt_radius : 0;\n  this.setCenterAndRadius(center, radius, opt_layout);\n};\n\ninherits(Circle, SimpleGeometry);\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/Circle} Clone.\n * @override\n * @api\n */\nCircle.prototype.clone = function() {\n  const circle = new Circle(null);\n  circle.setFlatCoordinates(this.layout, this.flatCoordinates.slice());\n  return circle;\n};\n\n\n/**\n * @inheritDoc\n */\nCircle.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  const flatCoordinates = this.flatCoordinates;\n  const dx = x - flatCoordinates[0];\n  const dy = y - flatCoordinates[1];\n  const squaredDistance = dx * dx + dy * dy;\n  if (squaredDistance < minSquaredDistance) {\n    if (squaredDistance === 0) {\n      for (let i = 0; i < this.stride; ++i) {\n        closestPoint[i] = flatCoordinates[i];\n      }\n    } else {\n      const delta = this.getRadius() / Math.sqrt(squaredDistance);\n      closestPoint[0] = flatCoordinates[0] + delta * dx;\n      closestPoint[1] = flatCoordinates[1] + delta * dy;\n      for (let i = 2; i < this.stride; ++i) {\n        closestPoint[i] = flatCoordinates[i];\n      }\n    }\n    closestPoint.length = this.stride;\n    return squaredDistance;\n  } else {\n    return minSquaredDistance;\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCircle.prototype.containsXY = function(x, y) {\n  const flatCoordinates = this.flatCoordinates;\n  const dx = x - flatCoordinates[0];\n  const dy = y - flatCoordinates[1];\n  return dx * dx + dy * dy <= this.getRadiusSquared_();\n};\n\n\n/**\n * Return the center of the circle as {@link module:ol/coordinate~Coordinate coordinate}.\n * @return {module:ol/coordinate~Coordinate} Center.\n * @api\n */\nCircle.prototype.getCenter = function() {\n  return this.flatCoordinates.slice(0, this.stride);\n};\n\n\n/**\n * @inheritDoc\n */\nCircle.prototype.computeExtent = function(extent) {\n  const flatCoordinates = this.flatCoordinates;\n  const radius = flatCoordinates[this.stride] - flatCoordinates[0];\n  return createOrUpdate(\n    flatCoordinates[0] - radius, flatCoordinates[1] - radius,\n    flatCoordinates[0] + radius, flatCoordinates[1] + radius,\n    extent);\n};\n\n\n/**\n * Return the radius of the circle.\n * @return {number} Radius.\n * @api\n */\nCircle.prototype.getRadius = function() {\n  return Math.sqrt(this.getRadiusSquared_());\n};\n\n\n/**\n * @private\n * @return {number} Radius squared.\n */\nCircle.prototype.getRadiusSquared_ = function() {\n  const dx = this.flatCoordinates[this.stride] - this.flatCoordinates[0];\n  const dy = this.flatCoordinates[this.stride + 1] - this.flatCoordinates[1];\n  return dx * dx + dy * dy;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nCircle.prototype.getType = function() {\n  return GeometryType.CIRCLE;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nCircle.prototype.intersectsExtent = function(extent) {\n  const circleExtent = this.getExtent();\n  if (intersects(extent, circleExtent)) {\n    const center = this.getCenter();\n\n    if (extent[0] <= center[0] && extent[2] >= center[0]) {\n      return true;\n    }\n    if (extent[1] <= center[1] && extent[3] >= center[1]) {\n      return true;\n    }\n\n    return forEachCorner(extent, this.intersectsCoordinate, this);\n  }\n  return false;\n\n};\n\n\n/**\n * Set the center of the circle as {@link module:ol/coordinate~Coordinate coordinate}.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @api\n */\nCircle.prototype.setCenter = function(center) {\n  const stride = this.stride;\n  const radius = this.flatCoordinates[stride] - this.flatCoordinates[0];\n  const flatCoordinates = center.slice();\n  flatCoordinates[stride] = flatCoordinates[0] + radius;\n  for (let i = 1; i < stride; ++i) {\n    flatCoordinates[stride + i] = center[i];\n  }\n  this.setFlatCoordinates(this.layout, flatCoordinates);\n};\n\n\n/**\n * Set the center (as {@link module:ol/coordinate~Coordinate coordinate}) and the radius (as\n * number) of the circle.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} radius Radius.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nCircle.prototype.setCenterAndRadius = function(center, radius, opt_layout) {\n  if (!center) {\n    this.setFlatCoordinates(GeometryLayout.XY, null);\n  } else {\n    this.setLayout(opt_layout, center, 0);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    /** @type {Array.<number>} */\n    const flatCoordinates = this.flatCoordinates;\n    let offset = deflateCoordinate(\n      flatCoordinates, 0, center, this.stride);\n    flatCoordinates[offset++] = flatCoordinates[0] + radius;\n    for (let i = 1, ii = this.stride; i < ii; ++i) {\n      flatCoordinates[offset++] = flatCoordinates[i];\n    }\n    flatCoordinates.length = offset;\n    this.changed();\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCircle.prototype.getCoordinates = function() {};\n\n\n/**\n * @inheritDoc\n */\nCircle.prototype.setCoordinates = function(coordinates, opt_layout) {};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n */\nCircle.prototype.setFlatCoordinates = function(layout, flatCoordinates) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.changed();\n};\n\n\n/**\n * Set the radius of the circle. The radius is in the units of the projection.\n * @param {number} radius Radius.\n * @api\n */\nCircle.prototype.setRadius = function(radius) {\n  this.flatCoordinates[this.stride] = this.flatCoordinates[0] + radius;\n  this.changed();\n};\n\n\n/**\n * Transform each coordinate of the circle from one coordinate reference system\n * to another. The geometry is modified in place.\n * If you do not want the geometry modified in place, first clone() it and\n * then use this function on the clone.\n *\n * Internally a circle is currently represented by two points: the center of\n * the circle `[cx, cy]`, and the point to the right of the circle\n * `[cx + r, cy]`. This `transform` function just transforms these two points.\n * So the resulting geometry is also a circle, and that circle does not\n * correspond to the shape that would be obtained by transforming every point\n * of the original circle.\n *\n * @param {module:ol/proj~ProjectionLike} source The current projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @param {module:ol/proj~ProjectionLike} destination The desired projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @return {module:ol/geom/Circle} This geometry.  Note that original geometry is\n *     modified in place.\n * @function\n * @api\n */\nCircle.prototype.transform;\nexport default Circle;\n","/**\n * @module ol/geom/MultiLineString\n */\nimport {inherits} from '../util.js';\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {assignClosestArrayPoint, arrayMaxSquaredDelta} from '../geom/flat/closest.js';\nimport {deflateCoordinatesArray} from '../geom/flat/deflate.js';\nimport {inflateCoordinatesArray} from '../geom/flat/inflate.js';\nimport {interpolatePoint, lineStringsCoordinateAtM} from '../geom/flat/interpolate.js';\nimport {intersectsLineStringArray} from '../geom/flat/intersectsextent.js';\nimport {douglasPeuckerArray} from '../geom/flat/simplify.js';\n\n/**\n * @classdesc\n * Multi-linestring geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst MultiLineString = function(coordinates, opt_layout) {\n\n  SimpleGeometry.call(this);\n\n  /**\n   * @type {Array.<number>}\n   * @private\n   */\n  this.ends_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDelta_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDeltaRevision_ = -1;\n\n  this.setCoordinates(coordinates, opt_layout);\n\n};\n\ninherits(MultiLineString, SimpleGeometry);\n\n\n/**\n * Append the passed linestring to the multilinestring.\n * @param {module:ol/geom/LineString} lineString LineString.\n * @api\n */\nMultiLineString.prototype.appendLineString = function(lineString) {\n  if (!this.flatCoordinates) {\n    this.flatCoordinates = lineString.getFlatCoordinates().slice();\n  } else {\n    extend(this.flatCoordinates, lineString.getFlatCoordinates().slice());\n  }\n  this.ends_.push(this.flatCoordinates.length);\n  this.changed();\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/MultiLineString} Clone.\n * @override\n * @api\n */\nMultiLineString.prototype.clone = function() {\n  const multiLineString = new MultiLineString(null);\n  multiLineString.setFlatCoordinates(\n    this.layout, this.flatCoordinates.slice(), this.ends_.slice());\n  return multiLineString;\n};\n\n\n/**\n * @inheritDoc\n */\nMultiLineString.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  if (this.maxDeltaRevision_ != this.getRevision()) {\n    this.maxDelta_ = Math.sqrt(arrayMaxSquaredDelta(\n      this.flatCoordinates, 0, this.ends_, this.stride, 0));\n    this.maxDeltaRevision_ = this.getRevision();\n  }\n  return assignClosestArrayPoint(\n    this.flatCoordinates, 0, this.ends_, this.stride,\n    this.maxDelta_, false, x, y, closestPoint, minSquaredDistance);\n};\n\n\n/**\n * Returns the coordinate at `m` using linear interpolation, or `null` if no\n * such coordinate exists.\n *\n * `opt_extrapolate` controls extrapolation beyond the range of Ms in the\n * MultiLineString. If `opt_extrapolate` is `true` then Ms less than the first\n * M will return the first coordinate and Ms greater than the last M will\n * return the last coordinate.\n *\n * `opt_interpolate` controls interpolation between consecutive LineStrings\n * within the MultiLineString. If `opt_interpolate` is `true` the coordinates\n * will be linearly interpolated between the last coordinate of one LineString\n * and the first coordinate of the next LineString.  If `opt_interpolate` is\n * `false` then the function will return `null` for Ms falling between\n * LineStrings.\n *\n * @param {number} m M.\n * @param {boolean=} opt_extrapolate Extrapolate. Default is `false`.\n * @param {boolean=} opt_interpolate Interpolate. Default is `false`.\n * @return {module:ol/coordinate~Coordinate} Coordinate.\n * @api\n */\nMultiLineString.prototype.getCoordinateAtM = function(m, opt_extrapolate, opt_interpolate) {\n  if ((this.layout != GeometryLayout.XYM &&\n       this.layout != GeometryLayout.XYZM) ||\n      this.flatCoordinates.length === 0) {\n    return null;\n  }\n  const extrapolate = opt_extrapolate !== undefined ? opt_extrapolate : false;\n  const interpolate = opt_interpolate !== undefined ? opt_interpolate : false;\n  return lineStringsCoordinateAtM(this.flatCoordinates, 0,\n    this.ends_, this.stride, m, extrapolate, interpolate);\n};\n\n\n/**\n * Return the coordinates of the multilinestring.\n * @return {Array.<Array.<module:ol/coordinate~Coordinate>>} Coordinates.\n * @override\n * @api\n */\nMultiLineString.prototype.getCoordinates = function() {\n  return inflateCoordinatesArray(\n    this.flatCoordinates, 0, this.ends_, this.stride);\n};\n\n\n/**\n * @return {Array.<number>} Ends.\n */\nMultiLineString.prototype.getEnds = function() {\n  return this.ends_;\n};\n\n\n/**\n * Return the linestring at the specified index.\n * @param {number} index Index.\n * @return {module:ol/geom/LineString} LineString.\n * @api\n */\nMultiLineString.prototype.getLineString = function(index) {\n  if (index < 0 || this.ends_.length <= index) {\n    return null;\n  }\n  const lineString = new LineString(null);\n  lineString.setFlatCoordinates(this.layout, this.flatCoordinates.slice(\n    index === 0 ? 0 : this.ends_[index - 1], this.ends_[index]));\n  return lineString;\n};\n\n\n/**\n * Return the linestrings of this multilinestring.\n * @return {Array.<module:ol/geom/LineString>} LineStrings.\n * @api\n */\nMultiLineString.prototype.getLineStrings = function() {\n  const flatCoordinates = this.flatCoordinates;\n  const ends = this.ends_;\n  const layout = this.layout;\n  /** @type {Array.<module:ol/geom/LineString>} */\n  const lineStrings = [];\n  let offset = 0;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const lineString = new LineString(null);\n    lineString.setFlatCoordinates(layout, flatCoordinates.slice(offset, end));\n    lineStrings.push(lineString);\n    offset = end;\n  }\n  return lineStrings;\n};\n\n\n/**\n * @return {Array.<number>} Flat midpoints.\n */\nMultiLineString.prototype.getFlatMidpoints = function() {\n  const midpoints = [];\n  const flatCoordinates = this.flatCoordinates;\n  let offset = 0;\n  const ends = this.ends_;\n  const stride = this.stride;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const midpoint = interpolatePoint(\n      flatCoordinates, offset, end, stride, 0.5);\n    extend(midpoints, midpoint);\n    offset = end;\n  }\n  return midpoints;\n};\n\n\n/**\n * @inheritDoc\n */\nMultiLineString.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  const simplifiedFlatCoordinates = [];\n  const simplifiedEnds = [];\n  simplifiedFlatCoordinates.length = douglasPeuckerArray(\n    this.flatCoordinates, 0, this.ends_, this.stride, squaredTolerance,\n    simplifiedFlatCoordinates, 0, simplifiedEnds);\n  const simplifiedMultiLineString = new MultiLineString(null);\n  simplifiedMultiLineString.setFlatCoordinates(\n    GeometryLayout.XY, simplifiedFlatCoordinates, simplifiedEnds);\n  return simplifiedMultiLineString;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiLineString.prototype.getType = function() {\n  return GeometryType.MULTI_LINE_STRING;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiLineString.prototype.intersectsExtent = function(extent) {\n  return intersectsLineStringArray(\n    this.flatCoordinates, 0, this.ends_, this.stride, extent);\n};\n\n\n/**\n * Set the coordinates of the multilinestring.\n * @param {Array.<Array.<module:ol/coordinate~Coordinate>>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nMultiLineString.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null, this.ends_);\n  } else {\n    this.setLayout(opt_layout, coordinates, 2);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    const ends = deflateCoordinatesArray(\n      this.flatCoordinates, 0, coordinates, this.stride, this.ends_);\n    this.flatCoordinates.length = ends.length === 0 ? 0 : ends[ends.length - 1];\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {Array.<number>} ends Ends.\n */\nMultiLineString.prototype.setFlatCoordinates = function(layout, flatCoordinates, ends) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.ends_ = ends;\n  this.changed();\n};\n\n\n/**\n * @param {Array.<module:ol/geom/LineString>} lineStrings LineStrings.\n */\nMultiLineString.prototype.setLineStrings = function(lineStrings) {\n  let layout = this.getLayout();\n  const flatCoordinates = [];\n  const ends = [];\n  for (let i = 0, ii = lineStrings.length; i < ii; ++i) {\n    const lineString = lineStrings[i];\n    if (i === 0) {\n      layout = lineString.getLayout();\n    }\n    extend(flatCoordinates, lineString.getFlatCoordinates());\n    ends.push(flatCoordinates.length);\n  }\n  this.setFlatCoordinates(layout, flatCoordinates, ends);\n};\nexport default MultiLineString;\n","/**\n * @module ol/geom/MultiPoint\n */\nimport {inherits} from '../util.js';\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY, containsXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport Point from '../geom/Point.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {deflateCoordinates} from '../geom/flat/deflate.js';\nimport {inflateCoordinates} from '../geom/flat/inflate.js';\nimport {squaredDistance as squaredDx} from '../math.js';\n\n/**\n * @classdesc\n * Multi-point geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst MultiPoint = function(coordinates, opt_layout) {\n  SimpleGeometry.call(this);\n  this.setCoordinates(coordinates, opt_layout);\n};\n\ninherits(MultiPoint, SimpleGeometry);\n\n\n/**\n * Append the passed point to this multipoint.\n * @param {module:ol/geom/Point} point Point.\n * @api\n */\nMultiPoint.prototype.appendPoint = function(point) {\n  if (!this.flatCoordinates) {\n    this.flatCoordinates = point.getFlatCoordinates().slice();\n  } else {\n    extend(this.flatCoordinates, point.getFlatCoordinates());\n  }\n  this.changed();\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/MultiPoint} Clone.\n * @override\n * @api\n */\nMultiPoint.prototype.clone = function() {\n  const multiPoint = new MultiPoint(null);\n  multiPoint.setFlatCoordinates(this.layout, this.flatCoordinates.slice());\n  return multiPoint;\n};\n\n\n/**\n * @inheritDoc\n */\nMultiPoint.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  const flatCoordinates = this.flatCoordinates;\n  const stride = this.stride;\n  for (let i = 0, ii = flatCoordinates.length; i < ii; i += stride) {\n    const squaredDistance = squaredDx(\n      x, y, flatCoordinates[i], flatCoordinates[i + 1]);\n    if (squaredDistance < minSquaredDistance) {\n      minSquaredDistance = squaredDistance;\n      for (let j = 0; j < stride; ++j) {\n        closestPoint[j] = flatCoordinates[i + j];\n      }\n      closestPoint.length = stride;\n    }\n  }\n  return minSquaredDistance;\n};\n\n\n/**\n * Return the coordinates of the multipoint.\n * @return {Array.<module:ol/coordinate~Coordinate>} Coordinates.\n * @override\n * @api\n */\nMultiPoint.prototype.getCoordinates = function() {\n  return inflateCoordinates(\n    this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n};\n\n\n/**\n * Return the point at the specified index.\n * @param {number} index Index.\n * @return {module:ol/geom/Point} Point.\n * @api\n */\nMultiPoint.prototype.getPoint = function(index) {\n  const n = !this.flatCoordinates ? 0 : this.flatCoordinates.length / this.stride;\n  if (index < 0 || n <= index) {\n    return null;\n  }\n  const point = new Point(null);\n  point.setFlatCoordinates(this.layout, this.flatCoordinates.slice(\n    index * this.stride, (index + 1) * this.stride));\n  return point;\n};\n\n\n/**\n * Return the points of this multipoint.\n * @return {Array.<module:ol/geom/Point>} Points.\n * @api\n */\nMultiPoint.prototype.getPoints = function() {\n  const flatCoordinates = this.flatCoordinates;\n  const layout = this.layout;\n  const stride = this.stride;\n  /** @type {Array.<module:ol/geom/Point>} */\n  const points = [];\n  for (let i = 0, ii = flatCoordinates.length; i < ii; i += stride) {\n    const point = new Point(null);\n    point.setFlatCoordinates(layout, flatCoordinates.slice(i, i + stride));\n    points.push(point);\n  }\n  return points;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiPoint.prototype.getType = function() {\n  return GeometryType.MULTI_POINT;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiPoint.prototype.intersectsExtent = function(extent) {\n  const flatCoordinates = this.flatCoordinates;\n  const stride = this.stride;\n  for (let i = 0, ii = flatCoordinates.length; i < ii; i += stride) {\n    const x = flatCoordinates[i];\n    const y = flatCoordinates[i + 1];\n    if (containsXY(extent, x, y)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Set the coordinates of the multipoint.\n * @param {Array.<module:ol/coordinate~Coordinate>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nMultiPoint.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null);\n  } else {\n    this.setLayout(opt_layout, coordinates, 1);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinates(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n */\nMultiPoint.prototype.setFlatCoordinates = function(layout, flatCoordinates) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.changed();\n};\nexport default MultiPoint;\n","/**\n * @module ol/geom/flat/center\n */\nimport {createEmpty, createOrUpdateFromFlatCoordinates} from '../../extent.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<Array.<number>>} endss Endss.\n * @param {number} stride Stride.\n * @return {Array.<number>} Flat centers.\n */\nexport function linearRingss(flatCoordinates, offset, endss, stride) {\n  const flatCenters = [];\n  let extent = createEmpty();\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    extent = createOrUpdateFromFlatCoordinates(flatCoordinates, offset, ends[0], stride);\n    flatCenters.push((extent[0] + extent[2]) / 2, (extent[1] + extent[3]) / 2);\n    offset = ends[ends.length - 1];\n  }\n  return flatCenters;\n}\n","/**\n * @module ol/geom/MultiPolygon\n */\nimport {inherits} from '../util.js';\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport Polygon from '../geom/Polygon.js';\nimport SimpleGeometry from '../geom/SimpleGeometry.js';\nimport {linearRingss as linearRingssArea} from '../geom/flat/area.js';\nimport {linearRingss as linearRingssCenter} from '../geom/flat/center.js';\nimport {assignClosestMultiArrayPoint, multiArrayMaxSquaredDelta} from '../geom/flat/closest.js';\nimport {linearRingssContainsXY} from '../geom/flat/contains.js';\nimport {deflateMultiCoordinatesArray} from '../geom/flat/deflate.js';\nimport {inflateMultiCoordinatesArray} from '../geom/flat/inflate.js';\nimport {getInteriorPointsOfMultiArray} from '../geom/flat/interiorpoint.js';\nimport {intersectsLinearRingMultiArray} from '../geom/flat/intersectsextent.js';\nimport {linearRingsAreOriented, orientLinearRingsArray} from '../geom/flat/orient.js';\nimport {quantizeMultiArray} from '../geom/flat/simplify.js';\n\n/**\n * @classdesc\n * Multi-polygon geometry.\n *\n * @constructor\n * @extends {module:ol/geom/SimpleGeometry}\n * @param {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @api\n */\nconst MultiPolygon = function(coordinates, opt_layout) {\n\n  SimpleGeometry.call(this);\n\n  /**\n   * @type {Array.<Array.<number>>}\n   * @private\n   */\n  this.endss_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.flatInteriorPointsRevision_ = -1;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.flatInteriorPoints_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDelta_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.maxDeltaRevision_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.orientedRevision_ = -1;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.orientedFlatCoordinates_ = null;\n\n  this.setCoordinates(coordinates, opt_layout);\n\n};\n\ninherits(MultiPolygon, SimpleGeometry);\n\n\n/**\n * Append the passed polygon to this multipolygon.\n * @param {module:ol/geom/Polygon} polygon Polygon.\n * @api\n */\nMultiPolygon.prototype.appendPolygon = function(polygon) {\n  /** @type {Array.<number>} */\n  let ends;\n  if (!this.flatCoordinates) {\n    this.flatCoordinates = polygon.getFlatCoordinates().slice();\n    ends = polygon.getEnds().slice();\n    this.endss_.push();\n  } else {\n    const offset = this.flatCoordinates.length;\n    extend(this.flatCoordinates, polygon.getFlatCoordinates());\n    ends = polygon.getEnds().slice();\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      ends[i] += offset;\n    }\n  }\n  this.endss_.push(ends);\n  this.changed();\n};\n\n\n/**\n * Make a complete copy of the geometry.\n * @return {!module:ol/geom/MultiPolygon} Clone.\n * @override\n * @api\n */\nMultiPolygon.prototype.clone = function() {\n  const multiPolygon = new MultiPolygon(null);\n\n  const len = this.endss_.length;\n  const newEndss = new Array(len);\n  for (let i = 0; i < len; ++i) {\n    newEndss[i] = this.endss_[i].slice();\n  }\n\n  multiPolygon.setFlatCoordinates(\n    this.layout, this.flatCoordinates.slice(), newEndss);\n  return multiPolygon;\n};\n\n\n/**\n * @inheritDoc\n */\nMultiPolygon.prototype.closestPointXY = function(x, y, closestPoint, minSquaredDistance) {\n  if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n    return minSquaredDistance;\n  }\n  if (this.maxDeltaRevision_ != this.getRevision()) {\n    this.maxDelta_ = Math.sqrt(multiArrayMaxSquaredDelta(\n      this.flatCoordinates, 0, this.endss_, this.stride, 0));\n    this.maxDeltaRevision_ = this.getRevision();\n  }\n  return assignClosestMultiArrayPoint(\n    this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride,\n    this.maxDelta_, true, x, y, closestPoint, minSquaredDistance);\n};\n\n\n/**\n * @inheritDoc\n */\nMultiPolygon.prototype.containsXY = function(x, y) {\n  return linearRingssContainsXY(this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride, x, y);\n};\n\n\n/**\n * Return the area of the multipolygon on projected plane.\n * @return {number} Area (on projected plane).\n * @api\n */\nMultiPolygon.prototype.getArea = function() {\n  return linearRingssArea(this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride);\n};\n\n\n/**\n * Get the coordinate array for this geometry.  This array has the structure\n * of a GeoJSON coordinate array for multi-polygons.\n *\n * @param {boolean=} opt_right Orient coordinates according to the right-hand\n *     rule (counter-clockwise for exterior and clockwise for interior rings).\n *     If `false`, coordinates will be oriented according to the left-hand rule\n *     (clockwise for exterior and counter-clockwise for interior rings).\n *     By default, coordinate orientation will depend on how the geometry was\n *     constructed.\n * @return {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>} Coordinates.\n * @override\n * @api\n */\nMultiPolygon.prototype.getCoordinates = function(opt_right) {\n  let flatCoordinates;\n  if (opt_right !== undefined) {\n    flatCoordinates = this.getOrientedFlatCoordinates().slice();\n    orientLinearRingsArray(\n      flatCoordinates, 0, this.endss_, this.stride, opt_right);\n  } else {\n    flatCoordinates = this.flatCoordinates;\n  }\n\n  return inflateMultiCoordinatesArray(\n    flatCoordinates, 0, this.endss_, this.stride);\n};\n\n\n/**\n * @return {Array.<Array.<number>>} Endss.\n */\nMultiPolygon.prototype.getEndss = function() {\n  return this.endss_;\n};\n\n\n/**\n * @return {Array.<number>} Flat interior points.\n */\nMultiPolygon.prototype.getFlatInteriorPoints = function() {\n  if (this.flatInteriorPointsRevision_ != this.getRevision()) {\n    const flatCenters = linearRingssCenter(\n      this.flatCoordinates, 0, this.endss_, this.stride);\n    this.flatInteriorPoints_ = getInteriorPointsOfMultiArray(\n      this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride,\n      flatCenters);\n    this.flatInteriorPointsRevision_ = this.getRevision();\n  }\n  return this.flatInteriorPoints_;\n};\n\n\n/**\n * Return the interior points as {@link module:ol/geom/MultiPoint multipoint}.\n * @return {module:ol/geom/MultiPoint} Interior points as XYM coordinates, where M is\n * the length of the horizontal intersection that the point belongs to.\n * @api\n */\nMultiPolygon.prototype.getInteriorPoints = function() {\n  const interiorPoints = new MultiPoint(null);\n  interiorPoints.setFlatCoordinates(GeometryLayout.XYM,\n    this.getFlatInteriorPoints().slice());\n  return interiorPoints;\n};\n\n\n/**\n * @return {Array.<number>} Oriented flat coordinates.\n */\nMultiPolygon.prototype.getOrientedFlatCoordinates = function() {\n  if (this.orientedRevision_ != this.getRevision()) {\n    const flatCoordinates = this.flatCoordinates;\n    if (linearRingsAreOriented(\n      flatCoordinates, 0, this.endss_, this.stride)) {\n      this.orientedFlatCoordinates_ = flatCoordinates;\n    } else {\n      this.orientedFlatCoordinates_ = flatCoordinates.slice();\n      this.orientedFlatCoordinates_.length =\n          orientLinearRingsArray(\n            this.orientedFlatCoordinates_, 0, this.endss_, this.stride);\n    }\n    this.orientedRevision_ = this.getRevision();\n  }\n  return this.orientedFlatCoordinates_;\n};\n\n\n/**\n * @inheritDoc\n */\nMultiPolygon.prototype.getSimplifiedGeometryInternal = function(squaredTolerance) {\n  const simplifiedFlatCoordinates = [];\n  const simplifiedEndss = [];\n  simplifiedFlatCoordinates.length = quantizeMultiArray(\n    this.flatCoordinates, 0, this.endss_, this.stride,\n    Math.sqrt(squaredTolerance),\n    simplifiedFlatCoordinates, 0, simplifiedEndss);\n  const simplifiedMultiPolygon = new MultiPolygon(null);\n  simplifiedMultiPolygon.setFlatCoordinates(\n    GeometryLayout.XY, simplifiedFlatCoordinates, simplifiedEndss);\n  return simplifiedMultiPolygon;\n};\n\n\n/**\n * Return the polygon at the specified index.\n * @param {number} index Index.\n * @return {module:ol/geom/Polygon} Polygon.\n * @api\n */\nMultiPolygon.prototype.getPolygon = function(index) {\n  if (index < 0 || this.endss_.length <= index) {\n    return null;\n  }\n  let offset;\n  if (index === 0) {\n    offset = 0;\n  } else {\n    const prevEnds = this.endss_[index - 1];\n    offset = prevEnds[prevEnds.length - 1];\n  }\n  const ends = this.endss_[index].slice();\n  const end = ends[ends.length - 1];\n  if (offset !== 0) {\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      ends[i] -= offset;\n    }\n  }\n  const polygon = new Polygon(null);\n  polygon.setFlatCoordinates(\n    this.layout, this.flatCoordinates.slice(offset, end), ends);\n  return polygon;\n};\n\n\n/**\n * Return the polygons of this multipolygon.\n * @return {Array.<module:ol/geom/Polygon>} Polygons.\n * @api\n */\nMultiPolygon.prototype.getPolygons = function() {\n  const layout = this.layout;\n  const flatCoordinates = this.flatCoordinates;\n  const endss = this.endss_;\n  const polygons = [];\n  let offset = 0;\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i].slice();\n    const end = ends[ends.length - 1];\n    if (offset !== 0) {\n      for (let j = 0, jj = ends.length; j < jj; ++j) {\n        ends[j] -= offset;\n      }\n    }\n    const polygon = new Polygon(null);\n    polygon.setFlatCoordinates(\n      layout, flatCoordinates.slice(offset, end), ends);\n    polygons.push(polygon);\n    offset = end;\n  }\n  return polygons;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiPolygon.prototype.getType = function() {\n  return GeometryType.MULTI_POLYGON;\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nMultiPolygon.prototype.intersectsExtent = function(extent) {\n  return intersectsLinearRingMultiArray(\n    this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride, extent);\n};\n\n\n/**\n * Set the coordinates of the multipolygon.\n * @param {Array.<Array.<Array.<module:ol/coordinate~Coordinate>>>} coordinates Coordinates.\n * @param {module:ol/geom/GeometryLayout=} opt_layout Layout.\n * @override\n * @api\n */\nMultiPolygon.prototype.setCoordinates = function(coordinates, opt_layout) {\n  if (!coordinates) {\n    this.setFlatCoordinates(GeometryLayout.XY, null, this.endss_);\n  } else {\n    this.setLayout(opt_layout, coordinates, 3);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    const endss = deflateMultiCoordinatesArray(\n      this.flatCoordinates, 0, coordinates, this.stride, this.endss_);\n    if (endss.length === 0) {\n      this.flatCoordinates.length = 0;\n    } else {\n      const lastEnds = endss[endss.length - 1];\n      this.flatCoordinates.length = lastEnds.length === 0 ?\n        0 : lastEnds[lastEnds.length - 1];\n    }\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/geom/GeometryLayout} layout Layout.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {Array.<Array.<number>>} endss Endss.\n */\nMultiPolygon.prototype.setFlatCoordinates = function(layout, flatCoordinates, endss) {\n  this.setFlatCoordinatesInternal(layout, flatCoordinates);\n  this.endss_ = endss;\n  this.changed();\n};\n\n\n/**\n * @param {Array.<module:ol/geom/Polygon>} polygons Polygons.\n */\nMultiPolygon.prototype.setPolygons = function(polygons) {\n  let layout = this.getLayout();\n  const flatCoordinates = [];\n  const endss = [];\n  for (let i = 0, ii = polygons.length; i < ii; ++i) {\n    const polygon = polygons[i];\n    if (i === 0) {\n      layout = polygon.getLayout();\n    }\n    const offset = flatCoordinates.length;\n    const ends = polygon.getEnds();\n    for (let j = 0, jj = ends.length; j < jj; ++j) {\n      ends[j] += offset;\n    }\n    extend(flatCoordinates, polygon.getFlatCoordinates());\n    endss.push(ends);\n  }\n  this.setFlatCoordinates(layout, flatCoordinates, endss);\n};\n\nexport default MultiPolygon;\n","/**\n * @module ol/LayerType\n */\n\n/**\n * A layer type used when creating layer renderers.\n * @enum {string}\n */\nexport default {\n  IMAGE: 'IMAGE',\n  TILE: 'TILE',\n  VECTOR_TILE: 'VECTOR_TILE',\n  VECTOR: 'VECTOR'\n};\n","/**\n * @module ol/layer/VectorRenderType\n */\n\n/**\n * @enum {string}\n * Render mode for vector layers:\n *  * `'image'`: Vector layers are rendered as images. Great performance, but\n *    point symbols and texts are always rotated with the view and pixels are\n *    scaled during zoom animations.\n *  * `'vector'`: Vector layers are rendered as vectors. Most accurate rendering\n *    even during animations, but slower performance.\n * @api\n */\nexport default {\n  IMAGE: 'image',\n  VECTOR: 'vector'\n};\n","/**\n * @module ol/layer/Vector\n */\nimport {inherits} from '../util.js';\nimport LayerType from '../LayerType.js';\nimport Layer from '../layer/Layer.js';\nimport VectorRenderType from '../layer/VectorRenderType.js';\nimport {assign} from '../obj.js';\nimport {createDefaultStyle, toFunction as toStyleFunction} from '../style/Style.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {module:ol/render~OrderFunction} [renderOrder] Render order. Function to be used when sorting\n * features before rendering. By default features are drawn in the order that they are created. Use\n * `null` to avoid the sort, but get an undefined draw order.\n * @property {number} [renderBuffer=100] The buffer in pixels around the viewport extent used by the\n * renderer when getting features from the vector source for the rendering or hit-detection.\n * Recommended value: the size of the largest symbol, line width or label.\n * @property {module:ol/layer/VectorRenderType|string} [renderMode='vector'] Render mode for vector layers:\n *  * `'image'`: Vector layers are rendered as images. Great performance, but point symbols and\n *    texts are always rotated with the view and pixels are scaled during zoom animations.\n *  * `'vector'`: Vector layers are rendered as vectors. Most accurate rendering even during\n *    animations, but slower performance.\n * @property {module:ol/source/Vector} [source] Source.\n * @property {module:ol/PluggableMap} [map] Sets the layer as overlay on a map. The map will not manage\n * this layer in its layers collection, and the layer will be rendered on top. This is useful for\n * temporary layers. The standard way to add a layer to a map and have it managed by the map is to\n * use {@link module:ol/Map#addLayer}.\n * @property {boolean} [declutter=false] Declutter images and text. Decluttering is applied to all\n * image and text styles, and the priority is defined by the z-index of the style. Lower z-index\n * means higher priority.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [style] Layer style. See\n * {@link module:ol/style} for default style which will be used if this is not defined.\n * @property {boolean} [updateWhileAnimating=false] When set to `true` and `renderMode`\n * is `vector`, feature batches will be recreated during animations. This means that no\n * vectors will be shown clipped, but the setting will have a performance impact for large\n * amounts of vector data. When set to `false`, batches will be recreated when no animation\n * is active.\n * @property {boolean} [updateWhileInteracting=false] When set to `true` and `renderMode`\n * is `vector`, feature batches will be recreated during interactions. See also\n * `updateWhileAnimating`.\n */\n\n\n/**\n * @enum {string}\n * Render mode for vector layers:\n *  * `'image'`: Vector layers are rendered as images. Great performance, but\n *    point symbols and texts are always rotated with the view and pixels are\n *    scaled during zoom animations.\n *  * `'vector'`: Vector layers are rendered as vectors. Most accurate rendering\n *    even during animations, but slower performance.\n * @api\n */\nexport const RenderType = {\n  IMAGE: 'image',\n  VECTOR: 'vector'\n};\n\n\n/**\n * @enum {string}\n * @private\n */\nconst Property = {\n  RENDER_ORDER: 'renderOrder'\n};\n\n\n/**\n * @classdesc\n * Vector data that is rendered client-side.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @constructor\n * @extends {module:ol/layer/Layer}\n * @fires module:ol/render/Event~RenderEvent\n * @param {module:ol/layer/Vector~Options=} opt_options Options.\n * @api\n */\nconst VectorLayer = function(opt_options) {\n  const options = opt_options ?\n    opt_options : /** @type {module:ol/layer/Vector~Options} */ ({});\n\n  const baseOptions = assign({}, options);\n\n  delete baseOptions.style;\n  delete baseOptions.renderBuffer;\n  delete baseOptions.updateWhileAnimating;\n  delete baseOptions.updateWhileInteracting;\n  Layer.call(this, /** @type {module:ol/layer/Layer~Options} */ (baseOptions));\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.declutter_ = options.declutter !== undefined ? options.declutter : false;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.renderBuffer_ = options.renderBuffer !== undefined ?\n    options.renderBuffer : 100;\n\n  /**\n   * User provided style.\n   * @type {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction}\n   * @private\n   */\n  this.style_ = null;\n\n  /**\n   * Style function for use within the library.\n   * @type {module:ol/style/Style~StyleFunction|undefined}\n   * @private\n   */\n  this.styleFunction_ = undefined;\n\n  this.setStyle(options.style);\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.updateWhileAnimating_ = options.updateWhileAnimating !== undefined ?\n    options.updateWhileAnimating : false;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.updateWhileInteracting_ = options.updateWhileInteracting !== undefined ?\n    options.updateWhileInteracting : false;\n\n  /**\n   * @private\n   * @type {module:ol/layer/VectorTileRenderType|string}\n   */\n  this.renderMode_ = options.renderMode || VectorRenderType.VECTOR;\n\n  /**\n   * The layer type.\n   * @protected\n   * @type {module:ol/LayerType}\n   */\n  this.type = LayerType.VECTOR;\n\n};\n\ninherits(VectorLayer, Layer);\n\n\n/**\n * @return {boolean} Declutter.\n */\nVectorLayer.prototype.getDeclutter = function() {\n  return this.declutter_;\n};\n\n\n/**\n * @param {boolean} declutter Declutter.\n */\nVectorLayer.prototype.setDeclutter = function(declutter) {\n  this.declutter_ = declutter;\n};\n\n\n/**\n * @return {number|undefined} Render buffer.\n */\nVectorLayer.prototype.getRenderBuffer = function() {\n  return this.renderBuffer_;\n};\n\n\n/**\n * @return {function(module:ol/Feature, module:ol/Feature): number|null|undefined} Render\n *     order.\n */\nVectorLayer.prototype.getRenderOrder = function() {\n  return (\n    /** @type {module:ol/render~OrderFunction|null|undefined} */ (this.get(Property.RENDER_ORDER))\n  );\n};\n\n\n/**\n * Return the associated {@link module:ol/source/Vector vectorsource} of the layer.\n * @function\n * @return {module:ol/source/Vector} Source.\n * @api\n */\nVectorLayer.prototype.getSource;\n\n\n/**\n * Get the style for features.  This returns whatever was passed to the `style`\n * option at construction or to the `setStyle` method.\n * @return {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction}\n *     Layer style.\n * @api\n */\nVectorLayer.prototype.getStyle = function() {\n  return this.style_;\n};\n\n\n/**\n * Get the style function.\n * @return {module:ol/style/Style~StyleFunction|undefined} Layer style function.\n * @api\n */\nVectorLayer.prototype.getStyleFunction = function() {\n  return this.styleFunction_;\n};\n\n\n/**\n * @return {boolean} Whether the rendered layer should be updated while\n *     animating.\n */\nVectorLayer.prototype.getUpdateWhileAnimating = function() {\n  return this.updateWhileAnimating_;\n};\n\n\n/**\n * @return {boolean} Whether the rendered layer should be updated while\n *     interacting.\n */\nVectorLayer.prototype.getUpdateWhileInteracting = function() {\n  return this.updateWhileInteracting_;\n};\n\n\n/**\n * @param {module:ol/render~OrderFunction|null|undefined} renderOrder\n *     Render order.\n */\nVectorLayer.prototype.setRenderOrder = function(renderOrder) {\n  this.set(Property.RENDER_ORDER, renderOrder);\n};\n\n\n/**\n * Set the style for features.  This can be a single style object, an array\n * of styles, or a function that takes a feature and resolution and returns\n * an array of styles. If it is `undefined` the default style is used. If\n * it is `null` the layer has no style (a `null` style), so only features\n * that have their own styles will be rendered in the layer. See\n * {@link module:ol/style} for information on the default style.\n * @param {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction|null|undefined}\n *     style Layer style.\n * @api\n */\nVectorLayer.prototype.setStyle = function(style) {\n  this.style_ = style !== undefined ? style : createDefaultStyle;\n  this.styleFunction_ = style === null ?\n    undefined : toStyleFunction(this.style_);\n  this.changed();\n};\n\n\n/**\n * @return {module:ol/layer/VectorRenderType|string} The render mode.\n */\nVectorLayer.prototype.getRenderMode = function() {\n  return this.renderMode_;\n};\n\n\nexport default VectorLayer;\n","/**\n * @module ol/format/FormatType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  ARRAY_BUFFER: 'arraybuffer',\n  JSON: 'json',\n  TEXT: 'text',\n  XML: 'xml'\n};\n","/**\n * @module ol/featureloader\n */\nimport {UNDEFINED} from './functions.js';\nimport FormatType from './format/FormatType.js';\n\n\n/**\n * {@link module:ol/source/Vector} sources use a function of this type to\n * load features.\n *\n * This function takes an {@link module:ol/extent~Extent} representing the area to be loaded,\n * a `{number}` representing the resolution (map units per pixel) and an\n * {@link module:ol/proj/Projection} for the projection  as\n * arguments. `this` within the function is bound to the\n * {@link module:ol/source/Vector} it's called from.\n *\n * The function is responsible for loading the features and adding them to the\n * source.\n * @typedef {function(this:module:ol/source/Vector, module:ol/extent~Extent, number,\n *                    module:ol/proj/Projection)} FeatureLoader\n * @api\n */\n\n\n/**\n * {@link module:ol/source/Vector} sources use a function of this type to\n * get the url to load features from.\n *\n * This function takes an {@link module:ol/extent~Extent} representing the area\n * to be loaded, a `{number}` representing the resolution (map units per pixel)\n * and an {@link module:ol/proj/Projection} for the projection  as\n * arguments and returns a `{string}` representing the URL.\n * @typedef {function(module:ol/extent~Extent, number, module:ol/proj/Projection): string} FeatureUrlFunction\n * @api\n */\n\n\n/**\n * @param {string|module:ol/featureloader~FeatureUrlFunction} url Feature URL service.\n * @param {module:ol/format/Feature} format Feature format.\n * @param {function(this:module:ol/VectorTile, Array.<module:ol/Feature>, module:ol/proj/Projection, module:ol/extent~Extent)|function(this:module:ol/source/Vector, Array.<module:ol/Feature>)} success\n *     Function called with the loaded features and optionally with the data\n *     projection. Called with the vector tile or source as `this`.\n * @param {function(this:module:ol/VectorTile)|function(this:module:ol/source/Vector)} failure\n *     Function called when loading failed. Called with the vector tile or\n *     source as `this`.\n * @return {module:ol/featureloader~FeatureLoader} The feature loader.\n */\nexport function loadFeaturesXhr(url, format, success, failure) {\n  return (\n    /**\n     * @param {module:ol/extent~Extent} extent Extent.\n     * @param {number} resolution Resolution.\n     * @param {module:ol/proj/Projection} projection Projection.\n     * @this {module:ol/source/Vector|module:ol/VectorTile}\n     */\n    function(extent, resolution, projection) {\n      const xhr = new XMLHttpRequest();\n      xhr.open('GET',\n        typeof url === 'function' ? url(extent, resolution, projection) : url,\n        true);\n      if (format.getType() == FormatType.ARRAY_BUFFER) {\n        xhr.responseType = 'arraybuffer';\n      }\n      /**\n       * @param {Event} event Event.\n       * @private\n       */\n      xhr.onload = function(event) {\n        // status will be 0 for file:// urls\n        if (!xhr.status || xhr.status >= 200 && xhr.status < 300) {\n          const type = format.getType();\n          /** @type {Document|Node|Object|string|undefined} */\n          let source;\n          if (type == FormatType.JSON || type == FormatType.TEXT) {\n            source = xhr.responseText;\n          } else if (type == FormatType.XML) {\n            source = xhr.responseXML;\n            if (!source) {\n              source = new DOMParser().parseFromString(xhr.responseText, 'application/xml');\n            }\n          } else if (type == FormatType.ARRAY_BUFFER) {\n            source = /** @type {ArrayBuffer} */ (xhr.response);\n          }\n          if (source) {\n            success.call(this, format.readFeatures(source,\n              {featureProjection: projection}),\n            format.readProjection(source), format.getLastExtent());\n          } else {\n            failure.call(this);\n          }\n        } else {\n          failure.call(this);\n        }\n      }.bind(this);\n      /**\n       * @private\n       */\n      xhr.onerror = function() {\n        failure.call(this);\n      }.bind(this);\n      xhr.send();\n    }\n  );\n}\n\n\n/**\n * Create an XHR feature loader for a `url` and `format`. The feature loader\n * loads features (with XHR), parses the features, and adds them to the\n * vector source.\n * @param {string|module:ol/featureloader~FeatureUrlFunction} url Feature URL service.\n * @param {module:ol/format/Feature} format Feature format.\n * @return {module:ol/featureloader~FeatureLoader} The feature loader.\n * @api\n */\nexport function xhr(url, format) {\n  return loadFeaturesXhr(url, format,\n    /**\n     * @param {Array.<module:ol/Feature>} features The loaded features.\n     * @param {module:ol/proj/Projection} dataProjection Data\n     * projection.\n     * @this {module:ol/source/Vector}\n     */\n    function(features, dataProjection) {\n      this.addFeatures(features);\n    }, /* FIXME handle error */ UNDEFINED);\n}\n","/**\n * @module ol/loadingstrategy\n */\n\n\n/**\n * Strategy function for loading all features with a single request.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @return {Array.<module:ol/extent~Extent>} Extents.\n * @api\n */\nexport function all(extent, resolution) {\n  return [[-Infinity, -Infinity, Infinity, Infinity]];\n}\n\n\n/**\n * Strategy function for loading features based on the view's extent and\n * resolution.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @return {Array.<module:ol/extent~Extent>} Extents.\n * @api\n */\nexport function bbox(extent, resolution) {\n  return [extent];\n}\n\n\n/**\n * Creates a strategy function for loading features based on a tile grid.\n * @param {module:ol/tilegrid/TileGrid} tileGrid Tile grid.\n * @return {function(module:ol/extent~Extent, number): Array.<module:ol/extent~Extent>} Loading strategy.\n * @api\n */\nexport function tile(tileGrid) {\n  return (\n    /**\n     * @param {module:ol/extent~Extent} extent Extent.\n     * @param {number} resolution Resolution.\n     * @return {Array.<module:ol/extent~Extent>} Extents.\n     */\n    function(extent, resolution) {\n      const z = tileGrid.getZForResolution(resolution);\n      const tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);\n      /** @type {Array.<module:ol/extent~Extent>} */\n      const extents = [];\n      /** @type {module:ol/tilecoord~TileCoord} */\n      const tileCoord = [z, 0, 0];\n      for (tileCoord[1] = tileRange.minX; tileCoord[1] <= tileRange.maxX; ++tileCoord[1]) {\n        for (tileCoord[2] = tileRange.minY; tileCoord[2] <= tileRange.maxY; ++tileCoord[2]) {\n          extents.push(tileGrid.getTileCoordExtent(tileCoord));\n        }\n      }\n      return extents;\n    }\n  );\n}\n","/**\n * @module ol/source/Source\n */\nimport {inherits} from '../util.js';\nimport {UNDEFINED} from '../functions.js';\nimport BaseObject from '../Object.js';\nimport {get as getProjection} from '../proj.js';\nimport SourceState from '../source/State.js';\n\n\n/**\n * A function that returns a string or an array of strings representing source\n * attributions.\n *\n * @typedef {function(module:ol/PluggableMap~FrameState): (string|Array.<string>)} Attribution\n */\n\n\n/**\n * A type that can be used to provide attribution information for data sources.\n *\n * It represents either\n * * a simple string (e.g. `'© Acme Inc.'`)\n * * an array of simple strings (e.g. `['© Acme Inc.', '© Bacme Inc.']`)\n * * a function that returns a string or array of strings (`{@link module:ol/source/Source~Attribution}`)\n *\n * @typedef {string|Array.<string>|module:ol/source/Source~Attribution} AttributionLike\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions]\n * @property {module:ol/proj~ProjectionLike} projection\n * @property {module:ol/source/State} [state]\n * @property {boolean} [wrapX]\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for {@link module:ol/layer/Layer~Layer} sources.\n *\n * A generic `change` event is triggered when the state of the source changes.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/Object}\n * @param {module:ol/source/Source~Options} options Source options.\n * @api\n */\nconst Source = function(options) {\n\n  BaseObject.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/proj/Projection}\n   */\n  this.projection_ = getProjection(options.projection);\n\n  /**\n   * @private\n   * @type {?module:ol/source/Source~Attribution}\n   */\n  this.attributions_ = this.adaptAttributions_(options.attributions);\n\n  /**\n   * @private\n   * @type {module:ol/source/State}\n   */\n  this.state_ = options.state !== undefined ?\n    options.state : SourceState.READY;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.wrapX_ = options.wrapX !== undefined ? options.wrapX : false;\n\n};\n\ninherits(Source, BaseObject);\n\n/**\n * Turns the attributions option into an attributions function.\n * @param {module:ol/source/Source~AttributionLike|undefined} attributionLike The attribution option.\n * @return {?module:ol/source/Source~Attribution} An attribution function (or null).\n */\nSource.prototype.adaptAttributions_ = function(attributionLike) {\n  if (!attributionLike) {\n    return null;\n  }\n  if (Array.isArray(attributionLike)) {\n    return function(frameState) {\n      return attributionLike;\n    };\n  }\n\n  if (typeof attributionLike === 'function') {\n    return attributionLike;\n  }\n\n  return function(frameState) {\n    return [attributionLike];\n  };\n};\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {Object.<string, boolean>} skippedFeatureUids Skipped feature uids.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T} callback Feature callback.\n * @return {T|undefined} Callback result.\n * @template T\n */\nSource.prototype.forEachFeatureAtCoordinate = UNDEFINED;\n\n\n/**\n * Get the attribution function for the source.\n * @return {?module:ol/source/Source~Attribution} Attribution function.\n */\nSource.prototype.getAttributions = function() {\n  return this.attributions_;\n};\n\n\n/**\n * Get the projection of the source.\n * @return {module:ol/proj/Projection} Projection.\n * @api\n */\nSource.prototype.getProjection = function() {\n  return this.projection_;\n};\n\n\n/**\n * @abstract\n * @return {Array.<number>|undefined} Resolutions.\n */\nSource.prototype.getResolutions = function() {};\n\n\n/**\n * Get the state of the source, see {@link module:ol/source/State~State} for possible states.\n * @return {module:ol/source/State} State.\n * @api\n */\nSource.prototype.getState = function() {\n  return this.state_;\n};\n\n\n/**\n * @return {boolean|undefined} Wrap X.\n */\nSource.prototype.getWrapX = function() {\n  return this.wrapX_;\n};\n\n\n/**\n * Refreshes the source and finally dispatches a 'change' event.\n * @api\n */\nSource.prototype.refresh = function() {\n  this.changed();\n};\n\n\n/**\n * Set the attributions of the source.\n * @param {module:ol/source/Source~AttributionLike|undefined} attributions Attributions.\n *     Can be passed as `string`, `Array<string>`, `{@link module:ol/source/Source~Attribution}`,\n *     or `undefined`.\n * @api\n */\nSource.prototype.setAttributions = function(attributions) {\n  this.attributions_ = this.adaptAttributions_(attributions);\n  this.changed();\n};\n\n\n/**\n * Set the state of the source.\n * @param {module:ol/source/State} state State.\n * @protected\n */\nSource.prototype.setState = function(state) {\n  this.state_ = state;\n  this.changed();\n};\nexport default Source;\n","/**\n * @module ol/source/VectorEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when a feature is added to the source.\n   * @event ol/source/Vector~VectorSourceEvent#addfeature\n   * @api\n   */\n  ADDFEATURE: 'addfeature',\n\n  /**\n   * Triggered when a feature is updated.\n   * @event ol/source/Vector~VectorSourceEvent#changefeature\n   * @api\n   */\n  CHANGEFEATURE: 'changefeature',\n\n  /**\n   * Triggered when the clear method is called on the source.\n   * @event ol/source/Vector~VectorSourceEvent#clear\n   * @api\n   */\n  CLEAR: 'clear',\n\n  /**\n   * Triggered when a feature is removed from the source.\n   * See {@link module:ol/source/Vector#clear source.clear()} for exceptions.\n   * @event ol/source/Vector~VectorSourceEvent#removefeature\n   * @api\n   */\n  REMOVEFEATURE: 'removefeature'\n};\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.quickselect = factory());\n}(this, (function () { 'use strict';\n\nfunction quickselect(arr, k, left, right, compare) {\n    quickselectStep(arr, k, left || 0, right || (arr.length - 1), compare || defaultCompare);\n}\n\nfunction quickselectStep(arr, k, left, right, compare) {\n\n    while (right > left) {\n        if (right - left > 600) {\n            var n = right - left + 1;\n            var m = k - left + 1;\n            var z = Math.log(n);\n            var s = 0.5 * Math.exp(2 * z / 3);\n            var sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);\n            var newLeft = Math.max(left, Math.floor(k - m * s / n + sd));\n            var newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));\n            quickselectStep(arr, k, newLeft, newRight, compare);\n        }\n\n        var t = arr[k];\n        var i = left;\n        var j = right;\n\n        swap(arr, left, k);\n        if (compare(arr[right], t) > 0) swap(arr, left, right);\n\n        while (i < j) {\n            swap(arr, i, j);\n            i++;\n            j--;\n            while (compare(arr[i], t) < 0) i++;\n            while (compare(arr[j], t) > 0) j--;\n        }\n\n        if (compare(arr[left], t) === 0) swap(arr, left, j);\n        else {\n            j++;\n            swap(arr, j, right);\n        }\n\n        if (j <= k) left = j + 1;\n        if (k <= j) right = j - 1;\n    }\n}\n\nfunction swap(arr, i, j) {\n    var tmp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = tmp;\n}\n\nfunction defaultCompare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n\nreturn quickselect;\n\n})));\n","'use strict';\n\nmodule.exports = rbush;\nmodule.exports.default = rbush;\n\nvar quickselect = require('quickselect');\n\nfunction rbush(maxEntries, format) {\n    if (!(this instanceof rbush)) return new rbush(maxEntries, format);\n\n    // max entries in a node is 9 by default; min node fill is 40% for best performance\n    this._maxEntries = Math.max(4, maxEntries || 9);\n    this._minEntries = Math.max(2, Math.ceil(this._maxEntries * 0.4));\n\n    if (format) {\n        this._initFormat(format);\n    }\n\n    this.clear();\n}\n\nrbush.prototype = {\n\n    all: function () {\n        return this._all(this.data, []);\n    },\n\n    search: function (bbox) {\n\n        var node = this.data,\n            result = [],\n            toBBox = this.toBBox;\n\n        if (!intersects(bbox, node)) return result;\n\n        var nodesToSearch = [],\n            i, len, child, childBBox;\n\n        while (node) {\n            for (i = 0, len = node.children.length; i < len; i++) {\n\n                child = node.children[i];\n                childBBox = node.leaf ? toBBox(child) : child;\n\n                if (intersects(bbox, childBBox)) {\n                    if (node.leaf) result.push(child);\n                    else if (contains(bbox, childBBox)) this._all(child, result);\n                    else nodesToSearch.push(child);\n                }\n            }\n            node = nodesToSearch.pop();\n        }\n\n        return result;\n    },\n\n    collides: function (bbox) {\n\n        var node = this.data,\n            toBBox = this.toBBox;\n\n        if (!intersects(bbox, node)) return false;\n\n        var nodesToSearch = [],\n            i, len, child, childBBox;\n\n        while (node) {\n            for (i = 0, len = node.children.length; i < len; i++) {\n\n                child = node.children[i];\n                childBBox = node.leaf ? toBBox(child) : child;\n\n                if (intersects(bbox, childBBox)) {\n                    if (node.leaf || contains(bbox, childBBox)) return true;\n                    nodesToSearch.push(child);\n                }\n            }\n            node = nodesToSearch.pop();\n        }\n\n        return false;\n    },\n\n    load: function (data) {\n        if (!(data && data.length)) return this;\n\n        if (data.length < this._minEntries) {\n            for (var i = 0, len = data.length; i < len; i++) {\n                this.insert(data[i]);\n            }\n            return this;\n        }\n\n        // recursively build the tree with the given data from scratch using OMT algorithm\n        var node = this._build(data.slice(), 0, data.length - 1, 0);\n\n        if (!this.data.children.length) {\n            // save as is if tree is empty\n            this.data = node;\n\n        } else if (this.data.height === node.height) {\n            // split root if trees have the same height\n            this._splitRoot(this.data, node);\n\n        } else {\n            if (this.data.height < node.height) {\n                // swap trees if inserted one is bigger\n                var tmpNode = this.data;\n                this.data = node;\n                node = tmpNode;\n            }\n\n            // insert the small tree into the large tree at appropriate level\n            this._insert(node, this.data.height - node.height - 1, true);\n        }\n\n        return this;\n    },\n\n    insert: function (item) {\n        if (item) this._insert(item, this.data.height - 1);\n        return this;\n    },\n\n    clear: function () {\n        this.data = createNode([]);\n        return this;\n    },\n\n    remove: function (item, equalsFn) {\n        if (!item) return this;\n\n        var node = this.data,\n            bbox = this.toBBox(item),\n            path = [],\n            indexes = [],\n            i, parent, index, goingUp;\n\n        // depth-first iterative tree traversal\n        while (node || path.length) {\n\n            if (!node) { // go up\n                node = path.pop();\n                parent = path[path.length - 1];\n                i = indexes.pop();\n                goingUp = true;\n            }\n\n            if (node.leaf) { // check current node\n                index = findItem(item, node.children, equalsFn);\n\n                if (index !== -1) {\n                    // item found, remove the item and condense tree upwards\n                    node.children.splice(index, 1);\n                    path.push(node);\n                    this._condense(path);\n                    return this;\n                }\n            }\n\n            if (!goingUp && !node.leaf && contains(node, bbox)) { // go down\n                path.push(node);\n                indexes.push(i);\n                i = 0;\n                parent = node;\n                node = node.children[0];\n\n            } else if (parent) { // go right\n                i++;\n                node = parent.children[i];\n                goingUp = false;\n\n            } else node = null; // nothing found\n        }\n\n        return this;\n    },\n\n    toBBox: function (item) { return item; },\n\n    compareMinX: compareNodeMinX,\n    compareMinY: compareNodeMinY,\n\n    toJSON: function () { return this.data; },\n\n    fromJSON: function (data) {\n        this.data = data;\n        return this;\n    },\n\n    _all: function (node, result) {\n        var nodesToSearch = [];\n        while (node) {\n            if (node.leaf) result.push.apply(result, node.children);\n            else nodesToSearch.push.apply(nodesToSearch, node.children);\n\n            node = nodesToSearch.pop();\n        }\n        return result;\n    },\n\n    _build: function (items, left, right, height) {\n\n        var N = right - left + 1,\n            M = this._maxEntries,\n            node;\n\n        if (N <= M) {\n            // reached leaf level; return leaf\n            node = createNode(items.slice(left, right + 1));\n            calcBBox(node, this.toBBox);\n            return node;\n        }\n\n        if (!height) {\n            // target height of the bulk-loaded tree\n            height = Math.ceil(Math.log(N) / Math.log(M));\n\n            // target number of root entries to maximize storage utilization\n            M = Math.ceil(N / Math.pow(M, height - 1));\n        }\n\n        node = createNode([]);\n        node.leaf = false;\n        node.height = height;\n\n        // split the items into M mostly square tiles\n\n        var N2 = Math.ceil(N / M),\n            N1 = N2 * Math.ceil(Math.sqrt(M)),\n            i, j, right2, right3;\n\n        multiSelect(items, left, right, N1, this.compareMinX);\n\n        for (i = left; i <= right; i += N1) {\n\n            right2 = Math.min(i + N1 - 1, right);\n\n            multiSelect(items, i, right2, N2, this.compareMinY);\n\n            for (j = i; j <= right2; j += N2) {\n\n                right3 = Math.min(j + N2 - 1, right2);\n\n                // pack each entry recursively\n                node.children.push(this._build(items, j, right3, height - 1));\n            }\n        }\n\n        calcBBox(node, this.toBBox);\n\n        return node;\n    },\n\n    _chooseSubtree: function (bbox, node, level, path) {\n\n        var i, len, child, targetNode, area, enlargement, minArea, minEnlargement;\n\n        while (true) {\n            path.push(node);\n\n            if (node.leaf || path.length - 1 === level) break;\n\n            minArea = minEnlargement = Infinity;\n\n            for (i = 0, len = node.children.length; i < len; i++) {\n                child = node.children[i];\n                area = bboxArea(child);\n                enlargement = enlargedArea(bbox, child) - area;\n\n                // choose entry with the least area enlargement\n                if (enlargement < minEnlargement) {\n                    minEnlargement = enlargement;\n                    minArea = area < minArea ? area : minArea;\n                    targetNode = child;\n\n                } else if (enlargement === minEnlargement) {\n                    // otherwise choose one with the smallest area\n                    if (area < minArea) {\n                        minArea = area;\n                        targetNode = child;\n                    }\n                }\n            }\n\n            node = targetNode || node.children[0];\n        }\n\n        return node;\n    },\n\n    _insert: function (item, level, isNode) {\n\n        var toBBox = this.toBBox,\n            bbox = isNode ? item : toBBox(item),\n            insertPath = [];\n\n        // find the best node for accommodating the item, saving all nodes along the path too\n        var node = this._chooseSubtree(bbox, this.data, level, insertPath);\n\n        // put the item into the node\n        node.children.push(item);\n        extend(node, bbox);\n\n        // split on node overflow; propagate upwards if necessary\n        while (level >= 0) {\n            if (insertPath[level].children.length > this._maxEntries) {\n                this._split(insertPath, level);\n                level--;\n            } else break;\n        }\n\n        // adjust bboxes along the insertion path\n        this._adjustParentBBoxes(bbox, insertPath, level);\n    },\n\n    // split overflowed node into two\n    _split: function (insertPath, level) {\n\n        var node = insertPath[level],\n            M = node.children.length,\n            m = this._minEntries;\n\n        this._chooseSplitAxis(node, m, M);\n\n        var splitIndex = this._chooseSplitIndex(node, m, M);\n\n        var newNode = createNode(node.children.splice(splitIndex, node.children.length - splitIndex));\n        newNode.height = node.height;\n        newNode.leaf = node.leaf;\n\n        calcBBox(node, this.toBBox);\n        calcBBox(newNode, this.toBBox);\n\n        if (level) insertPath[level - 1].children.push(newNode);\n        else this._splitRoot(node, newNode);\n    },\n\n    _splitRoot: function (node, newNode) {\n        // split root node\n        this.data = createNode([node, newNode]);\n        this.data.height = node.height + 1;\n        this.data.leaf = false;\n        calcBBox(this.data, this.toBBox);\n    },\n\n    _chooseSplitIndex: function (node, m, M) {\n\n        var i, bbox1, bbox2, overlap, area, minOverlap, minArea, index;\n\n        minOverlap = minArea = Infinity;\n\n        for (i = m; i <= M - m; i++) {\n            bbox1 = distBBox(node, 0, i, this.toBBox);\n            bbox2 = distBBox(node, i, M, this.toBBox);\n\n            overlap = intersectionArea(bbox1, bbox2);\n            area = bboxArea(bbox1) + bboxArea(bbox2);\n\n            // choose distribution with minimum overlap\n            if (overlap < minOverlap) {\n                minOverlap = overlap;\n                index = i;\n\n                minArea = area < minArea ? area : minArea;\n\n            } else if (overlap === minOverlap) {\n                // otherwise choose distribution with minimum area\n                if (area < minArea) {\n                    minArea = area;\n                    index = i;\n                }\n            }\n        }\n\n        return index;\n    },\n\n    // sorts node children by the best axis for split\n    _chooseSplitAxis: function (node, m, M) {\n\n        var compareMinX = node.leaf ? this.compareMinX : compareNodeMinX,\n            compareMinY = node.leaf ? this.compareMinY : compareNodeMinY,\n            xMargin = this._allDistMargin(node, m, M, compareMinX),\n            yMargin = this._allDistMargin(node, m, M, compareMinY);\n\n        // if total distributions margin value is minimal for x, sort by minX,\n        // otherwise it's already sorted by minY\n        if (xMargin < yMargin) node.children.sort(compareMinX);\n    },\n\n    // total margin of all possible split distributions where each node is at least m full\n    _allDistMargin: function (node, m, M, compare) {\n\n        node.children.sort(compare);\n\n        var toBBox = this.toBBox,\n            leftBBox = distBBox(node, 0, m, toBBox),\n            rightBBox = distBBox(node, M - m, M, toBBox),\n            margin = bboxMargin(leftBBox) + bboxMargin(rightBBox),\n            i, child;\n\n        for (i = m; i < M - m; i++) {\n            child = node.children[i];\n            extend(leftBBox, node.leaf ? toBBox(child) : child);\n            margin += bboxMargin(leftBBox);\n        }\n\n        for (i = M - m - 1; i >= m; i--) {\n            child = node.children[i];\n            extend(rightBBox, node.leaf ? toBBox(child) : child);\n            margin += bboxMargin(rightBBox);\n        }\n\n        return margin;\n    },\n\n    _adjustParentBBoxes: function (bbox, path, level) {\n        // adjust bboxes along the given tree path\n        for (var i = level; i >= 0; i--) {\n            extend(path[i], bbox);\n        }\n    },\n\n    _condense: function (path) {\n        // go through the path, removing empty nodes and updating bboxes\n        for (var i = path.length - 1, siblings; i >= 0; i--) {\n            if (path[i].children.length === 0) {\n                if (i > 0) {\n                    siblings = path[i - 1].children;\n                    siblings.splice(siblings.indexOf(path[i]), 1);\n\n                } else this.clear();\n\n            } else calcBBox(path[i], this.toBBox);\n        }\n    },\n\n    _initFormat: function (format) {\n        // data format (minX, minY, maxX, maxY accessors)\n\n        // uses eval-type function compilation instead of just accepting a toBBox function\n        // because the algorithms are very sensitive to sorting functions performance,\n        // so they should be dead simple and without inner calls\n\n        var compareArr = ['return a', ' - b', ';'];\n\n        this.compareMinX = new Function('a', 'b', compareArr.join(format[0]));\n        this.compareMinY = new Function('a', 'b', compareArr.join(format[1]));\n\n        this.toBBox = new Function('a',\n            'return {minX: a' + format[0] +\n            ', minY: a' + format[1] +\n            ', maxX: a' + format[2] +\n            ', maxY: a' + format[3] + '};');\n    }\n};\n\nfunction findItem(item, items, equalsFn) {\n    if (!equalsFn) return items.indexOf(item);\n\n    for (var i = 0; i < items.length; i++) {\n        if (equalsFn(item, items[i])) return i;\n    }\n    return -1;\n}\n\n// calculate node's bbox from bboxes of its children\nfunction calcBBox(node, toBBox) {\n    distBBox(node, 0, node.children.length, toBBox, node);\n}\n\n// min bounding rectangle of node children from k to p-1\nfunction distBBox(node, k, p, toBBox, destNode) {\n    if (!destNode) destNode = createNode(null);\n    destNode.minX = Infinity;\n    destNode.minY = Infinity;\n    destNode.maxX = -Infinity;\n    destNode.maxY = -Infinity;\n\n    for (var i = k, child; i < p; i++) {\n        child = node.children[i];\n        extend(destNode, node.leaf ? toBBox(child) : child);\n    }\n\n    return destNode;\n}\n\nfunction extend(a, b) {\n    a.minX = Math.min(a.minX, b.minX);\n    a.minY = Math.min(a.minY, b.minY);\n    a.maxX = Math.max(a.maxX, b.maxX);\n    a.maxY = Math.max(a.maxY, b.maxY);\n    return a;\n}\n\nfunction compareNodeMinX(a, b) { return a.minX - b.minX; }\nfunction compareNodeMinY(a, b) { return a.minY - b.minY; }\n\nfunction bboxArea(a)   { return (a.maxX - a.minX) * (a.maxY - a.minY); }\nfunction bboxMargin(a) { return (a.maxX - a.minX) + (a.maxY - a.minY); }\n\nfunction enlargedArea(a, b) {\n    return (Math.max(b.maxX, a.maxX) - Math.min(b.minX, a.minX)) *\n           (Math.max(b.maxY, a.maxY) - Math.min(b.minY, a.minY));\n}\n\nfunction intersectionArea(a, b) {\n    var minX = Math.max(a.minX, b.minX),\n        minY = Math.max(a.minY, b.minY),\n        maxX = Math.min(a.maxX, b.maxX),\n        maxY = Math.min(a.maxY, b.maxY);\n\n    return Math.max(0, maxX - minX) *\n           Math.max(0, maxY - minY);\n}\n\nfunction contains(a, b) {\n    return a.minX <= b.minX &&\n           a.minY <= b.minY &&\n           b.maxX <= a.maxX &&\n           b.maxY <= a.maxY;\n}\n\nfunction intersects(a, b) {\n    return b.minX <= a.maxX &&\n           b.minY <= a.maxY &&\n           b.maxX >= a.minX &&\n           b.maxY >= a.minY;\n}\n\nfunction createNode(children) {\n    return {\n        children: children,\n        height: 1,\n        leaf: true,\n        minX: Infinity,\n        minY: Infinity,\n        maxX: -Infinity,\n        maxY: -Infinity\n    };\n}\n\n// sort an array so that items come in groups of n unsorted items, with groups sorted between each other;\n// combines selection algorithm with binary divide & conquer approach\n\nfunction multiSelect(arr, left, right, n, compare) {\n    var stack = [left, right],\n        mid;\n\n    while (stack.length) {\n        right = stack.pop();\n        left = stack.pop();\n\n        if (right - left <= n) continue;\n\n        mid = left + Math.ceil((right - left) / n / 2) * n;\n        quickselect(arr, mid, left, right, compare);\n\n        stack.push(left, mid, mid, right);\n    }\n}\n","/**\n * @module ol/structs/RBush\n */\nimport {getUid} from '../util.js';\nimport rbush from 'rbush';\nimport {createOrUpdate, equals} from '../extent.js';\nimport {isEmpty} from '../obj.js';\n\n/**\n * @typedef {Object} Entry\n * @property {number} minX\n * @property {number} minY\n * @property {number} maxX\n * @property {number} maxY\n * @property {Object} [value]\n */\n\n/**\n * Wrapper around the RBush by Vladimir Agafonkin.\n *\n * @constructor\n * @param {number=} opt_maxEntries Max entries.\n * @see https://github.com/mourner/rbush\n * @struct\n * @template T\n */\nconst RBush = function(opt_maxEntries) {\n\n  /**\n   * @private\n   */\n  this.rbush_ = rbush(opt_maxEntries, undefined);\n\n  /**\n   * A mapping between the objects added to this rbush wrapper\n   * and the objects that are actually added to the internal rbush.\n   * @private\n   * @type {Object.<number, module:ol/structs/RBush~Entry>}\n   */\n  this.items_ = {};\n\n};\n\n\n/**\n * Insert a value into the RBush.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {T} value Value.\n */\nRBush.prototype.insert = function(extent, value) {\n  /** @type {module:ol/structs/RBush~Entry} */\n  const item = {\n    minX: extent[0],\n    minY: extent[1],\n    maxX: extent[2],\n    maxY: extent[3],\n    value: value\n  };\n\n  this.rbush_.insert(item);\n  this.items_[getUid(value)] = item;\n};\n\n\n/**\n * Bulk-insert values into the RBush.\n * @param {Array.<module:ol/extent~Extent>} extents Extents.\n * @param {Array.<T>} values Values.\n */\nRBush.prototype.load = function(extents, values) {\n  const items = new Array(values.length);\n  for (let i = 0, l = values.length; i < l; i++) {\n    const extent = extents[i];\n    const value = values[i];\n\n    /** @type {module:ol/structs/RBush~Entry} */\n    const item = {\n      minX: extent[0],\n      minY: extent[1],\n      maxX: extent[2],\n      maxY: extent[3],\n      value: value\n    };\n    items[i] = item;\n    this.items_[getUid(value)] = item;\n  }\n  this.rbush_.load(items);\n};\n\n\n/**\n * Remove a value from the RBush.\n * @param {T} value Value.\n * @return {boolean} Removed.\n */\nRBush.prototype.remove = function(value) {\n  const uid = getUid(value);\n\n  // get the object in which the value was wrapped when adding to the\n  // internal rbush. then use that object to do the removal.\n  const item = this.items_[uid];\n  delete this.items_[uid];\n  return this.rbush_.remove(item) !== null;\n};\n\n\n/**\n * Update the extent of a value in the RBush.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {T} value Value.\n */\nRBush.prototype.update = function(extent, value) {\n  const item = this.items_[getUid(value)];\n  const bbox = [item.minX, item.minY, item.maxX, item.maxY];\n  if (!equals(bbox, extent)) {\n    this.remove(value);\n    this.insert(extent, value);\n  }\n};\n\n\n/**\n * Return all values in the RBush.\n * @return {Array.<T>} All.\n */\nRBush.prototype.getAll = function() {\n  const items = this.rbush_.all();\n  return items.map(function(item) {\n    return item.value;\n  });\n};\n\n\n/**\n * Return all values in the given extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {Array.<T>} All in extent.\n */\nRBush.prototype.getInExtent = function(extent) {\n  /** @type {module:ol/structs/RBush~Entry} */\n  const bbox = {\n    minX: extent[0],\n    minY: extent[1],\n    maxX: extent[2],\n    maxY: extent[3]\n  };\n  const items = this.rbush_.search(bbox);\n  return items.map(function(item) {\n    return item.value;\n  });\n};\n\n\n/**\n * Calls a callback function with each value in the tree.\n * If the callback returns a truthy value, this value is returned without\n * checking the rest of the tree.\n * @param {function(this: S, T): *} callback Callback.\n * @param {S=} opt_this The object to use as `this` in `callback`.\n * @return {*} Callback return value.\n * @template S\n */\nRBush.prototype.forEach = function(callback, opt_this) {\n  return this.forEach_(this.getAll(), callback, opt_this);\n};\n\n\n/**\n * Calls a callback function with each value in the provided extent.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {function(this: S, T): *} callback Callback.\n * @param {S=} opt_this The object to use as `this` in `callback`.\n * @return {*} Callback return value.\n * @template S\n */\nRBush.prototype.forEachInExtent = function(extent, callback, opt_this) {\n  return this.forEach_(this.getInExtent(extent), callback, opt_this);\n};\n\n\n/**\n * @param {Array.<T>} values Values.\n * @param {function(this: S, T): *} callback Callback.\n * @param {S=} opt_this The object to use as `this` in `callback`.\n * @private\n * @return {*} Callback return value.\n * @template S\n */\nRBush.prototype.forEach_ = function(values, callback, opt_this) {\n  let result;\n  for (let i = 0, l = values.length; i < l; i++) {\n    result = callback.call(opt_this, values[i]);\n    if (result) {\n      return result;\n    }\n  }\n  return result;\n};\n\n\n/**\n * @return {boolean} Is empty.\n */\nRBush.prototype.isEmpty = function() {\n  return isEmpty(this.items_);\n};\n\n\n/**\n * Remove all values from the RBush.\n */\nRBush.prototype.clear = function() {\n  this.rbush_.clear();\n  this.items_ = {};\n};\n\n\n/**\n * @param {module:ol/extent~Extent=} opt_extent Extent.\n * @return {module:ol/extent~Extent} Extent.\n */\nRBush.prototype.getExtent = function(opt_extent) {\n  // FIXME add getExtent() to rbush\n  const data = this.rbush_.data;\n  return createOrUpdate(data.minX, data.minY, data.maxX, data.maxY, opt_extent);\n};\n\n\n/**\n * @param {module:ol/structs/RBush} rbush R-Tree.\n */\nRBush.prototype.concat = function(rbush) {\n  this.rbush_.load(rbush.rbush_.all());\n  for (const i in rbush.items_) {\n    this.items_[i | 0] = rbush.items_[i | 0];\n  }\n};\nexport default RBush;\n","/**\n * @module ol/source/Vector\n */\n\nimport {getUid, inherits} from '../util.js';\nimport Collection from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport ObjectEventType from '../ObjectEventType.js';\nimport {extend} from '../array.js';\nimport {assert} from '../asserts.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport {containsExtent, equals} from '../extent.js';\nimport {xhr} from '../featureloader.js';\nimport {TRUE, UNDEFINED} from '../functions.js';\nimport {all as allStrategy} from '../loadingstrategy.js';\nimport {isEmpty, getValues} from '../obj.js';\nimport Source from '../source/Source.js';\nimport SourceState from '../source/State.js';\nimport VectorEventType from '../source/VectorEventType.js';\nimport RBush from '../structs/RBush.js';\n\n/**\n * A function that takes an {@link module:ol/extent~Extent} and a resolution as arguments, and\n * returns an array of {@link module:ol/extent~Extent} with the extents to load. Usually this\n * is one of the standard {@link module:ol/loadingstrategy} strategies.\n *\n * @typedef {function(module:ol/extent~Extent, number): Array.<module:ol/extent~Extent>} LoadingStrategy\n * @api\n */\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/source/Vector} instances are instances of this\n * type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {string} type Type.\n * @param {module:ol/Feature=} opt_feature Feature.\n */\nexport const VectorSourceEvent = function(type, opt_feature) {\n\n  Event.call(this, type);\n\n  /**\n   * The feature being added or removed.\n   * @type {module:ol/Feature|undefined}\n   * @api\n   */\n  this.feature = opt_feature;\n\n};\ninherits(VectorSourceEvent, Event);\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {Array.<module:ol/Feature>|module:ol/Collection.<module:ol/Feature>} [features]\n * Features. If provided as {@link module:ol/Collection}, the features in the source\n * and the collection will stay in sync.\n * @property {module:ol/format/Feature} [format] The feature format used by the XHR\n * feature loader when `url` is set. Required if `url` is set, otherwise ignored.\n * @property {module:ol/featureloader~FeatureLoader} [loader]\n * The loader function used to load features, from a remote source for example.\n * If this is not set and `url` is set, the source will create and use an XHR\n * feature loader.\n *\n * Example:\n *\n * ```js\n * import {Vector} from 'ol/source';\n * import {GeoJSON} from 'ol/format';\n * import {bbox} from 'ol/loadingstrategy';\n *\n * var vectorSource = new Vector({\n *   format: new GeoJSON(),\n *   loader: function(extent, resolution, projection) {\n *      var proj = projection.getCode();\n *      var url = 'https://ahocevar.com/geoserver/wfs?service=WFS&' +\n *          'version=1.1.0&request=GetFeature&typename=osm:water_areas&' +\n *          'outputFormat=application/json&srsname=' + proj + '&' +\n *          'bbox=' + extent.join(',') + ',' + proj;\n *      var xhr = new XMLHttpRequest();\n *      xhr.open('GET', url);\n *      var onError = function() {\n *        vectorSource.removeLoadedExtent(extent);\n *      }\n *      xhr.onerror = onError;\n *      xhr.onload = function() {\n *        if (xhr.status == 200) {\n *          vectorSource.addFeatures(\n *              vectorSource.getFormat().readFeatures(xhr.responseText));\n *        } else {\n *          onError();\n *        }\n *      }\n *      xhr.send();\n *    },\n *    strategy: bbox\n *  });\n * ```\n * @property {boolean} [overlaps=true] This source may have overlapping geometries.\n * Setting this to `false` (e.g. for sources with polygons that represent administrative\n * boundaries or TopoJSON sources) allows the renderer to optimise fill and\n * stroke operations.\n * @property {module:ol/source/Vector~LoadingStrategy} [strategy] The loading strategy to use.\n * By default an {@link module:ol/loadingstrategy~all}\n * strategy is used, a one-off strategy which loads all features at once.\n * @property {string|module:ol/featureloader~FeatureUrlfunction} [url]\n * Setting this option instructs the source to load features using an XHR loader\n * (see {@link module:ol/featureloader~xhr}). Use a `string` and an\n * {@link module:ol/loadingstrategy~all} for a one-off download of all features from\n * the given URL. Use a {@link module:ol/featureloader~FeatureUrlfunction} to generate the url with\n * other loading strategies.\n * Requires `format` to be set as well.\n * When default XHR feature loader is provided, the features will\n * be transformed from the data projection to the view projection\n * during parsing. If your remote data source does not advertise its projection\n * properly, this transformation will be incorrect. For some formats, the\n * default projection (usually EPSG:4326) can be overridden by setting the\n * dataProjection constructor option on the format.\n * Note that if a source contains non-feature data, such as a GeoJSON geometry\n * or a KML NetworkLink, these will be ignored. Use a custom loader to load these.\n * @property {boolean} [useSpatialIndex=true]\n * By default, an RTree is used as spatial index. When features are removed and\n * added frequently, and the total number of features is low, setting this to\n * `false` may improve performance.\n *\n * Note that\n * {@link module:ol/source/Vector~VectorSource#getFeaturesInExtent},\n * {@link module:ol/source/Vector~VectorSource#getClosestFeatureToCoordinate} and\n * {@link module:ol/source/Vector~VectorSource#getExtent} cannot be used when `useSpatialIndex` is\n * set to `false`, and {@link module:ol/source/Vector~VectorSource#forEachFeatureInExtent} will loop\n * through all features.\n *\n * When set to `false`, the features will be maintained in an\n * {@link module:ol/Collection}, which can be retrieved through\n * {@link module:ol/source/Vector~VectorSource#getFeaturesCollection}.\n * @property {boolean} [wrapX=true] Wrap the world horizontally. For vector editing across the\n * -180° and 180° meridians to work properly, this should be set to `false`. The\n * resulting geometry coordinates will then exceed the world bounds.\n */\n\n\n/**\n * @classdesc\n * Provides a source of features for vector layers. Vector features provided\n * by this source are suitable for editing. See {@link module:ol/source/VectorTile~VectorTile} for\n * vector data that is optimized for rendering.\n *\n * @constructor\n * @extends {module:ol/source/Source}\n * @fires ol/source/Vector~VectorSourceEvent\n * @param {module:ol/source/Vector~Options=} opt_options Vector source options.\n * @api\n */\nconst VectorSource = function(opt_options) {\n\n  const options = opt_options || {};\n\n  Source.call(this, {\n    attributions: options.attributions,\n    projection: undefined,\n    state: SourceState.READY,\n    wrapX: options.wrapX !== undefined ? options.wrapX : true\n  });\n\n  /**\n   * @private\n   * @type {module:ol/featureloader~FeatureLoader}\n   */\n  this.loader_ = UNDEFINED;\n\n  /**\n   * @private\n   * @type {module:ol/format/Feature|undefined}\n   */\n  this.format_ = options.format;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.overlaps_ = options.overlaps == undefined ? true : options.overlaps;\n\n  /**\n   * @private\n   * @type {string|module:ol/featureloader~FeatureUrlFunction|undefined}\n   */\n  this.url_ = options.url;\n\n  if (options.loader !== undefined) {\n    this.loader_ = options.loader;\n  } else if (this.url_ !== undefined) {\n    assert(this.format_, 7); // `format` must be set when `url` is set\n    // create a XHR feature loader for \"url\" and \"format\"\n    this.loader_ = xhr(this.url_, /** @type {module:ol/format/Feature} */ (this.format_));\n  }\n\n  /**\n   * @private\n   * @type {module:ol/source/Vector~LoadingStrategy}\n   */\n  this.strategy_ = options.strategy !== undefined ? options.strategy : allStrategy;\n\n  const useSpatialIndex =\n      options.useSpatialIndex !== undefined ? options.useSpatialIndex : true;\n\n  /**\n   * @private\n   * @type {module:ol/structs/RBush.<module:ol/Feature>}\n   */\n  this.featuresRtree_ = useSpatialIndex ? new RBush() : null;\n\n  /**\n   * @private\n   * @type {module:ol/structs/RBush.<{extent: module:ol/extent~Extent}>}\n   */\n  this.loadedExtentsRtree_ = new RBush();\n\n  /**\n   * @private\n   * @type {!Object.<string, module:ol/Feature>}\n   */\n  this.nullGeometryFeatures_ = {};\n\n  /**\n   * A lookup of features by id (the return from feature.getId()).\n   * @private\n   * @type {!Object.<string, module:ol/Feature>}\n   */\n  this.idIndex_ = {};\n\n  /**\n   * A lookup of features without id (keyed by getUid(feature)).\n   * @private\n   * @type {!Object.<string, module:ol/Feature>}\n   */\n  this.undefIdIndex_ = {};\n\n  /**\n   * @private\n   * @type {Object.<string, Array.<module:ol/events~EventsKey>>}\n   */\n  this.featureChangeKeys_ = {};\n\n  /**\n   * @private\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   */\n  this.featuresCollection_ = null;\n\n  let collection, features;\n  if (options.features instanceof Collection) {\n    collection = options.features;\n    features = collection.getArray();\n  } else if (Array.isArray(options.features)) {\n    features = options.features;\n  }\n  if (!useSpatialIndex && collection === undefined) {\n    collection = new Collection(features);\n  }\n  if (features !== undefined) {\n    this.addFeaturesInternal(features);\n  }\n  if (collection !== undefined) {\n    this.bindFeaturesCollection_(collection);\n  }\n\n};\n\ninherits(VectorSource, Source);\n\n\n/**\n * Add a single feature to the source.  If you want to add a batch of features\n * at once, call {@link module:ol/source/Vector~VectorSource#addFeatures #addFeatures()}\n * instead. A feature will not be added to the source if feature with\n * the same id is already there. The reason for this behavior is to avoid\n * feature duplication when using bbox or tile loading strategies.\n * @param {module:ol/Feature} feature Feature to add.\n * @api\n */\nVectorSource.prototype.addFeature = function(feature) {\n  this.addFeatureInternal(feature);\n  this.changed();\n};\n\n\n/**\n * Add a feature without firing a `change` event.\n * @param {module:ol/Feature} feature Feature.\n * @protected\n */\nVectorSource.prototype.addFeatureInternal = function(feature) {\n  const featureKey = getUid(feature).toString();\n\n  if (!this.addToIndex_(featureKey, feature)) {\n    return;\n  }\n\n  this.setupChangeEvents_(featureKey, feature);\n\n  const geometry = feature.getGeometry();\n  if (geometry) {\n    const extent = geometry.getExtent();\n    if (this.featuresRtree_) {\n      this.featuresRtree_.insert(extent, feature);\n    }\n  } else {\n    this.nullGeometryFeatures_[featureKey] = feature;\n  }\n\n  this.dispatchEvent(\n    new VectorSourceEvent(VectorEventType.ADDFEATURE, feature));\n};\n\n\n/**\n * @param {string} featureKey Unique identifier for the feature.\n * @param {module:ol/Feature} feature The feature.\n * @private\n */\nVectorSource.prototype.setupChangeEvents_ = function(featureKey, feature) {\n  this.featureChangeKeys_[featureKey] = [\n    listen(feature, EventType.CHANGE,\n      this.handleFeatureChange_, this),\n    listen(feature, ObjectEventType.PROPERTYCHANGE,\n      this.handleFeatureChange_, this)\n  ];\n};\n\n\n/**\n * @param {string} featureKey Unique identifier for the feature.\n * @param {module:ol/Feature} feature The feature.\n * @return {boolean} The feature is \"valid\", in the sense that it is also a\n *     candidate for insertion into the Rtree.\n * @private\n */\nVectorSource.prototype.addToIndex_ = function(featureKey, feature) {\n  let valid = true;\n  const id = feature.getId();\n  if (id !== undefined) {\n    if (!(id.toString() in this.idIndex_)) {\n      this.idIndex_[id.toString()] = feature;\n    } else {\n      valid = false;\n    }\n  } else {\n    assert(!(featureKey in this.undefIdIndex_),\n      30); // The passed `feature` was already added to the source\n    this.undefIdIndex_[featureKey] = feature;\n  }\n  return valid;\n};\n\n\n/**\n * Add a batch of features to the source.\n * @param {Array.<module:ol/Feature>} features Features to add.\n * @api\n */\nVectorSource.prototype.addFeatures = function(features) {\n  this.addFeaturesInternal(features);\n  this.changed();\n};\n\n\n/**\n * Add features without firing a `change` event.\n * @param {Array.<module:ol/Feature>} features Features.\n * @protected\n */\nVectorSource.prototype.addFeaturesInternal = function(features) {\n  const extents = [];\n  const newFeatures = [];\n  const geometryFeatures = [];\n\n  for (let i = 0, length = features.length; i < length; i++) {\n    const feature = features[i];\n    const featureKey = getUid(feature).toString();\n    if (this.addToIndex_(featureKey, feature)) {\n      newFeatures.push(feature);\n    }\n  }\n\n  for (let i = 0, length = newFeatures.length; i < length; i++) {\n    const feature = newFeatures[i];\n    const featureKey = getUid(feature).toString();\n    this.setupChangeEvents_(featureKey, feature);\n\n    const geometry = feature.getGeometry();\n    if (geometry) {\n      const extent = geometry.getExtent();\n      extents.push(extent);\n      geometryFeatures.push(feature);\n    } else {\n      this.nullGeometryFeatures_[featureKey] = feature;\n    }\n  }\n  if (this.featuresRtree_) {\n    this.featuresRtree_.load(extents, geometryFeatures);\n  }\n\n  for (let i = 0, length = newFeatures.length; i < length; i++) {\n    this.dispatchEvent(new VectorSourceEvent(VectorEventType.ADDFEATURE, newFeatures[i]));\n  }\n};\n\n\n/**\n * @param {!module:ol/Collection.<module:ol/Feature>} collection Collection.\n * @private\n */\nVectorSource.prototype.bindFeaturesCollection_ = function(collection) {\n  let modifyingCollection = false;\n  listen(this, VectorEventType.ADDFEATURE,\n    function(evt) {\n      if (!modifyingCollection) {\n        modifyingCollection = true;\n        collection.push(evt.feature);\n        modifyingCollection = false;\n      }\n    });\n  listen(this, VectorEventType.REMOVEFEATURE,\n    function(evt) {\n      if (!modifyingCollection) {\n        modifyingCollection = true;\n        collection.remove(evt.feature);\n        modifyingCollection = false;\n      }\n    });\n  listen(collection, CollectionEventType.ADD,\n    function(evt) {\n      if (!modifyingCollection) {\n        modifyingCollection = true;\n        this.addFeature(/** @type {module:ol/Feature} */ (evt.element));\n        modifyingCollection = false;\n      }\n    }, this);\n  listen(collection, CollectionEventType.REMOVE,\n    function(evt) {\n      if (!modifyingCollection) {\n        modifyingCollection = true;\n        this.removeFeature(/** @type {module:ol/Feature} */ (evt.element));\n        modifyingCollection = false;\n      }\n    }, this);\n  this.featuresCollection_ = collection;\n};\n\n\n/**\n * Remove all features from the source.\n * @param {boolean=} opt_fast Skip dispatching of {@link module:ol/source/Vector~VectorSourceEvent#removefeature} events.\n * @api\n */\nVectorSource.prototype.clear = function(opt_fast) {\n  if (opt_fast) {\n    for (const featureId in this.featureChangeKeys_) {\n      const keys = this.featureChangeKeys_[featureId];\n      keys.forEach(unlistenByKey);\n    }\n    if (!this.featuresCollection_) {\n      this.featureChangeKeys_ = {};\n      this.idIndex_ = {};\n      this.undefIdIndex_ = {};\n    }\n  } else {\n    if (this.featuresRtree_) {\n      this.featuresRtree_.forEach(this.removeFeatureInternal, this);\n      for (const id in this.nullGeometryFeatures_) {\n        this.removeFeatureInternal(this.nullGeometryFeatures_[id]);\n      }\n    }\n  }\n  if (this.featuresCollection_) {\n    this.featuresCollection_.clear();\n  }\n\n  if (this.featuresRtree_) {\n    this.featuresRtree_.clear();\n  }\n  this.loadedExtentsRtree_.clear();\n  this.nullGeometryFeatures_ = {};\n\n  const clearEvent = new VectorSourceEvent(VectorEventType.CLEAR);\n  this.dispatchEvent(clearEvent);\n  this.changed();\n};\n\n\n/**\n * Iterate through all features on the source, calling the provided callback\n * with each one.  If the callback returns any \"truthy\" value, iteration will\n * stop and the function will return the same value.\n * Note: this function only iterate through the feature that have a defined geometry.\n *\n * @param {function(module:ol/Feature): T} callback Called with each feature\n *     on the source.  Return a truthy value to stop iteration.\n * @return {T|undefined} The return value from the last call to the callback.\n * @template T\n * @api\n */\nVectorSource.prototype.forEachFeature = function(callback) {\n  if (this.featuresRtree_) {\n    return this.featuresRtree_.forEach(callback);\n  } else if (this.featuresCollection_) {\n    return this.featuresCollection_.forEach(callback);\n  }\n};\n\n\n/**\n * Iterate through all features whose geometries contain the provided\n * coordinate, calling the callback with each feature.  If the callback returns\n * a \"truthy\" value, iteration will stop and the function will return the same\n * value.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {function(module:ol/Feature): T} callback Called with each feature\n *     whose goemetry contains the provided coordinate.\n * @return {T|undefined} The return value from the last call to the callback.\n * @template T\n */\nVectorSource.prototype.forEachFeatureAtCoordinateDirect = function(coordinate, callback) {\n  const extent = [coordinate[0], coordinate[1], coordinate[0], coordinate[1]];\n  return this.forEachFeatureInExtent(extent, function(feature) {\n    const geometry = feature.getGeometry();\n    if (geometry.intersectsCoordinate(coordinate)) {\n      return callback(feature);\n    } else {\n      return undefined;\n    }\n  });\n};\n\n\n/**\n * Iterate through all features whose bounding box intersects the provided\n * extent (note that the feature's geometry may not intersect the extent),\n * calling the callback with each feature.  If the callback returns a \"truthy\"\n * value, iteration will stop and the function will return the same value.\n *\n * If you are interested in features whose geometry intersects an extent, call\n * the {@link module:ol/source/Vector~VectorSource#forEachFeatureIntersectingExtent #forEachFeatureIntersectingExtent()} method instead.\n *\n * When `useSpatialIndex` is set to false, this method will loop through all\n * features, equivalent to {@link module:ol/source/Vector~VectorSource#forEachFeature #forEachFeature()}.\n *\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {function(module:ol/Feature): T} callback Called with each feature\n *     whose bounding box intersects the provided extent.\n * @return {T|undefined} The return value from the last call to the callback.\n * @template T\n * @api\n */\nVectorSource.prototype.forEachFeatureInExtent = function(extent, callback) {\n  if (this.featuresRtree_) {\n    return this.featuresRtree_.forEachInExtent(extent, callback);\n  } else if (this.featuresCollection_) {\n    return this.featuresCollection_.forEach(callback);\n  }\n};\n\n\n/**\n * Iterate through all features whose geometry intersects the provided extent,\n * calling the callback with each feature.  If the callback returns a \"truthy\"\n * value, iteration will stop and the function will return the same value.\n *\n * If you only want to test for bounding box intersection, call the\n * {@link module:ol/source/Vector~VectorSource#forEachFeatureInExtent #forEachFeatureInExtent()} method instead.\n *\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {function(module:ol/Feature): T} callback Called with each feature\n *     whose geometry intersects the provided extent.\n * @return {T|undefined} The return value from the last call to the callback.\n * @template T\n * @api\n */\nVectorSource.prototype.forEachFeatureIntersectingExtent = function(extent, callback) {\n  return this.forEachFeatureInExtent(extent,\n    /**\n     * @param {module:ol/Feature} feature Feature.\n     * @return {T|undefined} The return value from the last call to the callback.\n     * @template T\n     */\n    function(feature) {\n      const geometry = feature.getGeometry();\n      if (geometry.intersectsExtent(extent)) {\n        const result = callback(feature);\n        if (result) {\n          return result;\n        }\n      }\n    });\n};\n\n\n/**\n * Get the features collection associated with this source. Will be `null`\n * unless the source was configured with `useSpatialIndex` set to `false`, or\n * with an {@link module:ol/Collection} as `features`.\n * @return {module:ol/Collection.<module:ol/Feature>} The collection of features.\n * @api\n */\nVectorSource.prototype.getFeaturesCollection = function() {\n  return this.featuresCollection_;\n};\n\n\n/**\n * Get all features on the source in random order.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nVectorSource.prototype.getFeatures = function() {\n  let features;\n  if (this.featuresCollection_) {\n    features = this.featuresCollection_.getArray();\n  } else if (this.featuresRtree_) {\n    features = this.featuresRtree_.getAll();\n    if (!isEmpty(this.nullGeometryFeatures_)) {\n      extend(features, getValues(this.nullGeometryFeatures_));\n    }\n  }\n  return (\n    /** @type {Array.<module:ol/Feature>} */ (features)\n  );\n};\n\n\n/**\n * Get all features whose geometry intersects the provided coordinate.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nVectorSource.prototype.getFeaturesAtCoordinate = function(coordinate) {\n  const features = [];\n  this.forEachFeatureAtCoordinateDirect(coordinate, function(feature) {\n    features.push(feature);\n  });\n  return features;\n};\n\n\n/**\n * Get all features in the provided extent.  Note that this returns an array of\n * all features intersecting the given extent in random order (so it may include\n * features whose geometries do not intersect the extent).\n *\n * This method is not available when the source is configured with\n * `useSpatialIndex` set to `false`.\n * @param {module:ol/extent~Extent} extent Extent.\n * @return {Array.<module:ol/Feature>} Features.\n * @api\n */\nVectorSource.prototype.getFeaturesInExtent = function(extent) {\n  return this.featuresRtree_.getInExtent(extent);\n};\n\n\n/**\n * Get the closest feature to the provided coordinate.\n *\n * This method is not available when the source is configured with\n * `useSpatialIndex` set to `false`.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {function(module:ol/Feature):boolean=} opt_filter Feature filter function.\n *     The filter function will receive one argument, the {@link module:ol/Feature feature}\n *     and it should return a boolean value. By default, no filtering is made.\n * @return {module:ol/Feature} Closest feature.\n * @api\n */\nVectorSource.prototype.getClosestFeatureToCoordinate = function(coordinate, opt_filter) {\n  // Find the closest feature using branch and bound.  We start searching an\n  // infinite extent, and find the distance from the first feature found.  This\n  // becomes the closest feature.  We then compute a smaller extent which any\n  // closer feature must intersect.  We continue searching with this smaller\n  // extent, trying to find a closer feature.  Every time we find a closer\n  // feature, we update the extent being searched so that any even closer\n  // feature must intersect it.  We continue until we run out of features.\n  const x = coordinate[0];\n  const y = coordinate[1];\n  let closestFeature = null;\n  const closestPoint = [NaN, NaN];\n  let minSquaredDistance = Infinity;\n  const extent = [-Infinity, -Infinity, Infinity, Infinity];\n  const filter = opt_filter ? opt_filter : TRUE;\n  this.featuresRtree_.forEachInExtent(extent,\n    /**\n     * @param {module:ol/Feature} feature Feature.\n     */\n    function(feature) {\n      if (filter(feature)) {\n        const geometry = feature.getGeometry();\n        const previousMinSquaredDistance = minSquaredDistance;\n        minSquaredDistance = geometry.closestPointXY(\n          x, y, closestPoint, minSquaredDistance);\n        if (minSquaredDistance < previousMinSquaredDistance) {\n          closestFeature = feature;\n          // This is sneaky.  Reduce the extent that it is currently being\n          // searched while the R-Tree traversal using this same extent object\n          // is still in progress.  This is safe because the new extent is\n          // strictly contained by the old extent.\n          const minDistance = Math.sqrt(minSquaredDistance);\n          extent[0] = x - minDistance;\n          extent[1] = y - minDistance;\n          extent[2] = x + minDistance;\n          extent[3] = y + minDistance;\n        }\n      }\n    });\n  return closestFeature;\n};\n\n\n/**\n * Get the extent of the features currently in the source.\n *\n * This method is not available when the source is configured with\n * `useSpatialIndex` set to `false`.\n * @param {module:ol/extent~Extent=} opt_extent Destination extent. If provided, no new extent\n *     will be created. Instead, that extent's coordinates will be overwritten.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nVectorSource.prototype.getExtent = function(opt_extent) {\n  return this.featuresRtree_.getExtent(opt_extent);\n};\n\n\n/**\n * Get a feature by its identifier (the value returned by feature.getId()).\n * Note that the index treats string and numeric identifiers as the same.  So\n * `source.getFeatureById(2)` will return a feature with id `'2'` or `2`.\n *\n * @param {string|number} id Feature identifier.\n * @return {module:ol/Feature} The feature (or `null` if not found).\n * @api\n */\nVectorSource.prototype.getFeatureById = function(id) {\n  const feature = this.idIndex_[id.toString()];\n  return feature !== undefined ? feature : null;\n};\n\n\n/**\n * Get the format associated with this source.\n *\n * @return {module:ol/format/Feature|undefined} The feature format.\n * @api\n */\nVectorSource.prototype.getFormat = function() {\n  return this.format_;\n};\n\n\n/**\n * @return {boolean} The source can have overlapping geometries.\n */\nVectorSource.prototype.getOverlaps = function() {\n  return this.overlaps_;\n};\n\n\n/**\n * @override\n */\nVectorSource.prototype.getResolutions = function() {};\n\n\n/**\n * Get the url associated with this source.\n *\n * @return {string|module:ol/featureloader~FeatureUrlFunction|undefined} The url.\n * @api\n */\nVectorSource.prototype.getUrl = function() {\n  return this.url_;\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n * @private\n */\nVectorSource.prototype.handleFeatureChange_ = function(event) {\n  const feature = /** @type {module:ol/Feature} */ (event.target);\n  const featureKey = getUid(feature).toString();\n  const geometry = feature.getGeometry();\n  if (!geometry) {\n    if (!(featureKey in this.nullGeometryFeatures_)) {\n      if (this.featuresRtree_) {\n        this.featuresRtree_.remove(feature);\n      }\n      this.nullGeometryFeatures_[featureKey] = feature;\n    }\n  } else {\n    const extent = geometry.getExtent();\n    if (featureKey in this.nullGeometryFeatures_) {\n      delete this.nullGeometryFeatures_[featureKey];\n      if (this.featuresRtree_) {\n        this.featuresRtree_.insert(extent, feature);\n      }\n    } else {\n      if (this.featuresRtree_) {\n        this.featuresRtree_.update(extent, feature);\n      }\n    }\n  }\n  const id = feature.getId();\n  if (id !== undefined) {\n    const sid = id.toString();\n    if (featureKey in this.undefIdIndex_) {\n      delete this.undefIdIndex_[featureKey];\n      this.idIndex_[sid] = feature;\n    } else {\n      if (this.idIndex_[sid] !== feature) {\n        this.removeFromIdIndex_(feature);\n        this.idIndex_[sid] = feature;\n      }\n    }\n  } else {\n    if (!(featureKey in this.undefIdIndex_)) {\n      this.removeFromIdIndex_(feature);\n      this.undefIdIndex_[featureKey] = feature;\n    }\n  }\n  this.changed();\n  this.dispatchEvent(new VectorSourceEvent(\n    VectorEventType.CHANGEFEATURE, feature));\n};\n\n/**\n * Returns true if the feature is contained within the source.\n * @param {module:ol/Feature} feature Feature.\n * @return {boolean} Has feature.\n * @api\n */\nVectorSource.prototype.hasFeature = function(feature) {\n  const id = feature.getId();\n  if (id !== undefined) {\n    return id in this.idIndex_;\n  } else {\n    const featureKey = getUid(feature).toString();\n    return featureKey in this.undefIdIndex_;\n  }\n};\n\n/**\n * @return {boolean} Is empty.\n */\nVectorSource.prototype.isEmpty = function() {\n  return this.featuresRtree_.isEmpty() && isEmpty(this.nullGeometryFeatures_);\n};\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @param {module:ol/proj/Projection} projection Projection.\n */\nVectorSource.prototype.loadFeatures = function(extent, resolution, projection) {\n  const loadedExtentsRtree = this.loadedExtentsRtree_;\n  const extentsToLoad = this.strategy_(extent, resolution);\n  for (let i = 0, ii = extentsToLoad.length; i < ii; ++i) {\n    const extentToLoad = extentsToLoad[i];\n    const alreadyLoaded = loadedExtentsRtree.forEachInExtent(extentToLoad,\n      /**\n       * @param {{extent: module:ol/extent~Extent}} object Object.\n       * @return {boolean} Contains.\n       */\n      function(object) {\n        return containsExtent(object.extent, extentToLoad);\n      });\n    if (!alreadyLoaded) {\n      this.loader_.call(this, extentToLoad, resolution, projection);\n      loadedExtentsRtree.insert(extentToLoad, {extent: extentToLoad.slice()});\n    }\n  }\n};\n\n\n/**\n * Remove an extent from the list of loaded extents.\n * @param {module:ol/extent~Extent} extent Extent.\n * @api\n */\nVectorSource.prototype.removeLoadedExtent = function(extent) {\n  const loadedExtentsRtree = this.loadedExtentsRtree_;\n  let obj;\n  loadedExtentsRtree.forEachInExtent(extent, function(object) {\n    if (equals(object.extent, extent)) {\n      obj = object;\n      return true;\n    }\n  });\n  if (obj) {\n    loadedExtentsRtree.remove(obj);\n  }\n};\n\n\n/**\n * Remove a single feature from the source.  If you want to remove all features\n * at once, use the {@link module:ol/source/Vector~VectorSource#clear #clear()} method\n * instead.\n * @param {module:ol/Feature} feature Feature to remove.\n * @api\n */\nVectorSource.prototype.removeFeature = function(feature) {\n  const featureKey = getUid(feature).toString();\n  if (featureKey in this.nullGeometryFeatures_) {\n    delete this.nullGeometryFeatures_[featureKey];\n  } else {\n    if (this.featuresRtree_) {\n      this.featuresRtree_.remove(feature);\n    }\n  }\n  this.removeFeatureInternal(feature);\n  this.changed();\n};\n\n\n/**\n * Remove feature without firing a `change` event.\n * @param {module:ol/Feature} feature Feature.\n * @protected\n */\nVectorSource.prototype.removeFeatureInternal = function(feature) {\n  const featureKey = getUid(feature).toString();\n  this.featureChangeKeys_[featureKey].forEach(unlistenByKey);\n  delete this.featureChangeKeys_[featureKey];\n  const id = feature.getId();\n  if (id !== undefined) {\n    delete this.idIndex_[id.toString()];\n  } else {\n    delete this.undefIdIndex_[featureKey];\n  }\n  this.dispatchEvent(new VectorSourceEvent(\n    VectorEventType.REMOVEFEATURE, feature));\n};\n\n\n/**\n * Remove a feature from the id index.  Called internally when the feature id\n * may have changed.\n * @param {module:ol/Feature} feature The feature.\n * @return {boolean} Removed the feature from the index.\n * @private\n */\nVectorSource.prototype.removeFromIdIndex_ = function(feature) {\n  let removed = false;\n  for (const id in this.idIndex_) {\n    if (this.idIndex_[id] === feature) {\n      delete this.idIndex_[id];\n      removed = true;\n      break;\n    }\n  }\n  return removed;\n};\n\n\n/**\n * Set the new loader of the source. The next loadFeatures call will use the\n * new loader.\n * @param {module:ol/featureloader~FeatureLoader} loader The loader to set.\n * @api\n */\nVectorSource.prototype.setLoader = function(loader) {\n  this.loader_ = loader;\n};\n\nexport default VectorSource;\n","/**\n * @module ol/interaction/Draw\n */\nimport {inherits} from '../util.js';\nimport EventType from '../events/EventType.js';\nimport Feature from '../Feature.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport MapBrowserPointerEvent from '../MapBrowserPointerEvent.js';\nimport {getChangeEventType} from '../Object.js';\nimport {squaredDistance as squaredCoordinateDistance} from '../coordinate.js';\nimport {listen} from '../events.js';\nimport Event from '../events/Event.js';\nimport {noModifierKeys, always, shiftKeyOnly} from '../events/condition.js';\nimport {boundingExtent, getBottomLeft, getBottomRight, getTopLeft, getTopRight} from '../extent.js';\nimport {TRUE, FALSE} from '../functions.js';\nimport Circle from '../geom/Circle.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport {POINTER_TYPE} from '../pointer/MouseSource.js';\nimport Point from '../geom/Point.js';\nimport Polygon, {fromCircle, makeRegular} from '../geom/Polygon.js';\nimport PointerInteraction, {handleEvent as handlePointerEvent} from '../interaction/Pointer.js';\nimport InteractionProperty from '../interaction/Property.js';\nimport VectorLayer from '../layer/Vector.js';\nimport VectorSource from '../source/Vector.js';\nimport {createEditingStyle} from '../style/Style.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/geom/GeometryType} type Geometry type of\n * the geometries being drawn with this instance.\n * @property {number} [clickTolerance=6] The maximum distance in pixels between\n * \"down\" and \"up\" for a \"up\" event to be considered a \"click\" event and\n * actually add a point/vertex to the geometry being drawn.  The default of `6`\n * was chosen for the draw interaction to behave correctly on mouse as well as\n * on touch devices.\n * @property {module:ol/Collection.<module:ol/Feature>} [features]\n * Destination collection for the drawn features.\n * @property {module:ol/source/Vector} [source] Destination source for\n * the drawn features.\n * @property {number} [dragVertexDelay=500] Delay in milliseconds after pointerdown\n * before the current vertex can be dragged to its exact position.\n * @property {number} [snapTolerance=12] Pixel distance for snapping to the\n * drawing finish.\n * @property {boolean} [stopClick=false] Stop click, singleclick, and\n * doubleclick events from firing during drawing.\n * @property {number} [maxPoints] The number of points that can be drawn before\n * a polygon ring or line string is finished. By default there is no\n * restriction.\n * @property {number} [minPoints] The number of points that must be drawn\n * before a polygon ring or line string can be finished. Default is `3` for\n * polygon rings and `2` for line strings.\n * @property {module:ol/events/condition~Condition} [finishCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether the drawing can be finished.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [style]\n * Style for sketch features.\n * @property {module:ol/interaction/Draw~GeometryFunction} [geometryFunction]\n * Function that is called when a geometry's coordinates are updated.\n * @property {string} [geometryName] Geometry name to use for features created\n * by the draw interaction.\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * By default {@link module:ol/events/condition~noModifierKeys}, i.e. a click,\n * adds a vertex or deactivates freehand drawing.\n * @property {boolean} [freehand=false] Operate in freehand mode for lines,\n * polygons, and circles.  This makes the interaction always operate in freehand\n * mode and takes precedence over any `freehandCondition` option.\n * @property {module:ol/events/condition~Condition} [freehandCondition]\n * Condition that activates freehand drawing for lines and polygons. This\n * function takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and\n * returns a boolean to indicate whether that event should be handled. The\n * default is {@link module:ol/events/condition~shiftKeyOnly}, meaning that the\n * Shift key activates freehand drawing.\n * @property {boolean} [wrapX=false] Wrap the world horizontally on the sketch\n * overlay.\n */\n\n\n/**\n * Function that takes an array of coordinates and an optional existing geometry as\n * arguments, and returns a geometry. The optional existing geometry is the\n * geometry that is returned when the function is called without a second\n * argument.\n * @typedef {function(!Array.<module:ol/coordinate~Coordinate>, module:ol/geom/SimpleGeometry=):\n *     module:ol/geom/SimpleGeometry} GeometryFunction\n */\n\n\n/**\n * Draw mode.  This collapses multi-part geometry types with their single-part\n * cousins.\n * @enum {string}\n */\nconst Mode = {\n  POINT: 'Point',\n  LINE_STRING: 'LineString',\n  POLYGON: 'Polygon',\n  CIRCLE: 'Circle'\n};\n\n\n/**\n * @enum {string}\n */\nconst DrawEventType = {\n  /**\n   * Triggered upon feature draw start\n   * @event module:ol/interaction/Draw~DrawEvent#drawstart\n   * @api\n   */\n  DRAWSTART: 'drawstart',\n  /**\n   * Triggered upon feature draw end\n   * @event module:ol/interaction/Draw~DrawEvent#drawend\n   * @api\n   */\n  DRAWEND: 'drawend'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Draw~Draw} instances are\n * instances of this type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {module:ol/interaction/Draw~DrawEventType} type Type.\n * @param {module:ol/Feature} feature The feature drawn.\n */\nconst DrawEvent = function(type, feature) {\n\n  Event.call(this, type);\n\n  /**\n   * The feature being drawn.\n   * @type {module:ol/Feature}\n   * @api\n   */\n  this.feature = feature;\n\n};\n\ninherits(DrawEvent, Event);\n\n\n/**\n * @classdesc\n * Interaction for drawing feature geometries.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @fires module:ol/interaction/Draw~DrawEvent\n * @param {module:ol/interaction/Draw~Options} options Options.\n * @api\n */\nconst Draw = function(options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleEvent: handleEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.shouldHandle_ = false;\n\n  /**\n   * @type {module:ol~Pixel}\n   * @private\n   */\n  this.downPx_ = null;\n\n  /**\n   * @type {number|undefined}\n   * @private\n   */\n  this.downTimeout_;\n\n  /**\n   * @type {number|undefined}\n   * @private\n   */\n  this.lastDragTime_;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.freehand_ = false;\n\n  /**\n   * Target source for drawn features.\n   * @type {module:ol/source/Vector}\n   * @private\n   */\n  this.source_ = options.source ? options.source : null;\n\n  /**\n   * Target collection for drawn features.\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @private\n   */\n  this.features_ = options.features ? options.features : null;\n\n  /**\n   * Pixel distance for snapping.\n   * @type {number}\n   * @private\n   */\n  this.snapTolerance_ = options.snapTolerance ? options.snapTolerance : 12;\n\n  /**\n   * Geometry type.\n   * @type {module:ol/geom/GeometryType}\n   * @private\n   */\n  this.type_ = /** @type {module:ol/geom/GeometryType} */ (options.type);\n\n  /**\n   * Drawing mode (derived from geometry type.\n   * @type {module:ol/interaction/Draw~Mode}\n   * @private\n   */\n  this.mode_ = getMode(this.type_);\n\n  /**\n   * Stop click, singleclick, and doubleclick events from firing during drawing.\n   * Default is `false`.\n   * @type {boolean}\n   * @private\n   */\n  this.stopClick_ = !!options.stopClick;\n\n  /**\n   * The number of points that must be drawn before a polygon ring or line\n   * string can be finished.  The default is 3 for polygon rings and 2 for\n   * line strings.\n   * @type {number}\n   * @private\n   */\n  this.minPoints_ = options.minPoints ?\n    options.minPoints :\n    (this.mode_ === Mode.POLYGON ? 3 : 2);\n\n  /**\n   * The number of points that can be drawn before a polygon ring or line string\n   * is finished. The default is no restriction.\n   * @type {number}\n   * @private\n   */\n  this.maxPoints_ = options.maxPoints ? options.maxPoints : Infinity;\n\n  /**\n   * A function to decide if a potential finish coordinate is permissible\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.finishCondition_ = options.finishCondition ? options.finishCondition : TRUE;\n\n  let geometryFunction = options.geometryFunction;\n  if (!geometryFunction) {\n    if (this.type_ === GeometryType.CIRCLE) {\n      /**\n       * @param {!Array.<module:ol/coordinate~Coordinate>} coordinates\n       *     The coordinates.\n       * @param {module:ol/geom/SimpleGeometry=} opt_geometry Optional geometry.\n       * @return {module:ol/geom/SimpleGeometry} A geometry.\n       */\n      geometryFunction = function(coordinates, opt_geometry) {\n        const circle = opt_geometry ? /** @type {module:ol/geom/Circle} */ (opt_geometry) :\n          new Circle([NaN, NaN]);\n        const squaredLength = squaredCoordinateDistance(\n          coordinates[0], coordinates[1]);\n        circle.setCenterAndRadius(coordinates[0], Math.sqrt(squaredLength));\n        return circle;\n      };\n    } else {\n      let Constructor;\n      const mode = this.mode_;\n      if (mode === Mode.POINT) {\n        Constructor = Point;\n      } else if (mode === Mode.LINE_STRING) {\n        Constructor = LineString;\n      } else if (mode === Mode.POLYGON) {\n        Constructor = Polygon;\n      }\n      /**\n       * @param {!Array.<module:ol/coordinate~Coordinate>} coordinates\n       *     The coordinates.\n       * @param {module:ol/geom/SimpleGeometry=} opt_geometry Optional geometry.\n       * @return {module:ol/geom/SimpleGeometry} A geometry.\n       */\n      geometryFunction = function(coordinates, opt_geometry) {\n        let geometry = opt_geometry;\n        if (geometry) {\n          if (mode === Mode.POLYGON) {\n            if (coordinates[0].length) {\n              // Add a closing coordinate to match the first\n              geometry.setCoordinates([coordinates[0].concat([coordinates[0][0]])]);\n            } else {\n              geometry.setCoordinates([]);\n            }\n          } else {\n            geometry.setCoordinates(coordinates);\n          }\n        } else {\n          geometry = new Constructor(coordinates);\n        }\n        return geometry;\n      };\n    }\n  }\n\n  /**\n   * @type {module:ol/interaction/Draw~GeometryFunction}\n   * @private\n   */\n  this.geometryFunction_ = geometryFunction;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.dragVertexDelay_ = options.dragVertexDelay !== undefined ? options.dragVertexDelay : 500;\n\n  /**\n   * Finish coordinate for the feature (first point for polygons, last point for\n   * linestrings).\n   * @type {module:ol/coordinate~Coordinate}\n   * @private\n   */\n  this.finishCoordinate_ = null;\n\n  /**\n   * Sketch feature.\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.sketchFeature_ = null;\n\n  /**\n   * Sketch point.\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.sketchPoint_ = null;\n\n  /**\n   * Sketch coordinates. Used when drawing a line or polygon.\n   * @type {module:ol/coordinate~Coordinate|Array.<module:ol/coordinate~Coordinate>|Array.<Array.<module:ol/coordinate~Coordinate>>}\n   * @private\n   */\n  this.sketchCoords_ = null;\n\n  /**\n   * Sketch line. Used when drawing polygon.\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.sketchLine_ = null;\n\n  /**\n   * Sketch line coordinates. Used when drawing a polygon or circle.\n   * @type {Array.<module:ol/coordinate~Coordinate>}\n   * @private\n   */\n  this.sketchLineCoords_ = null;\n\n  /**\n   * Squared tolerance for handling up events.  If the squared distance\n   * between a down and up event is greater than this tolerance, up events\n   * will not be handled.\n   * @type {number}\n   * @private\n   */\n  this.squaredClickTolerance_ = options.clickTolerance ?\n    options.clickTolerance * options.clickTolerance : 36;\n\n  /**\n   * Draw overlay where our sketch features are drawn.\n   * @type {module:ol/layer/Vector}\n   * @private\n   */\n  this.overlay_ = new VectorLayer({\n    source: new VectorSource({\n      useSpatialIndex: false,\n      wrapX: options.wrapX ? options.wrapX : false\n    }),\n    style: options.style ? options.style :\n      getDefaultStyleFunction(),\n    updateWhileInteracting: true\n  });\n\n  /**\n   * Name of the geometry attribute for newly created features.\n   * @type {string|undefined}\n   * @private\n   */\n  this.geometryName_ = options.geometryName;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : noModifierKeys;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.freehandCondition_;\n  if (options.freehand) {\n    this.freehandCondition_ = always;\n  } else {\n    this.freehandCondition_ = options.freehandCondition ?\n      options.freehandCondition : shiftKeyOnly;\n  }\n\n  listen(this,\n    getChangeEventType(InteractionProperty.ACTIVE),\n    this.updateState_, this);\n\n};\n\ninherits(Draw, PointerInteraction);\n\n\n/**\n * @return {module:ol/style/Style~StyleFunction} Styles.\n */\nfunction getDefaultStyleFunction() {\n  const styles = createEditingStyle();\n  return function(feature, resolution) {\n    return styles[feature.getGeometry().getType()];\n  };\n}\n\n\n/**\n * @inheritDoc\n */\nDraw.prototype.setMap = function(map) {\n  PointerInteraction.prototype.setMap.call(this, map);\n  this.updateState_();\n};\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} and may actually\n * draw or finish the drawing.\n * @param {module:ol/MapBrowserEvent} event Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/Draw}\n * @api\n */\nexport function handleEvent(event) {\n  if (event.originalEvent.type === EventType.CONTEXTMENU) {\n    // Avoid context menu for long taps when drawing on mobile\n    event.preventDefault();\n  }\n  this.freehand_ = this.mode_ !== Mode.POINT && this.freehandCondition_(event);\n  let move = event.type === MapBrowserEventType.POINTERMOVE;\n  let pass = true;\n  if (this.lastDragTime_ && event.type === MapBrowserEventType.POINTERDRAG) {\n    const now = Date.now();\n    if (now - this.lastDragTime_ >= this.dragVertexDelay_) {\n      this.downPx_ = event.pixel;\n      this.shouldHandle_ = !this.freehand_;\n      move = true;\n    } else {\n      this.lastDragTime_ = undefined;\n    }\n    if (this.shouldHandle_ && this.downTimeout_) {\n      clearTimeout(this.downTimeout_);\n      this.downTimeout_ = undefined;\n    }\n  }\n  if (this.freehand_ &&\n      event.type === MapBrowserEventType.POINTERDRAG &&\n      this.sketchFeature_ !== null) {\n    this.addToDrawing_(event);\n    pass = false;\n  } else if (this.freehand_ &&\n      event.type === MapBrowserEventType.POINTERDOWN) {\n    pass = false;\n  } else if (move) {\n    pass = event.type === MapBrowserEventType.POINTERMOVE;\n    if (pass && this.freehand_) {\n      pass = this.handlePointerMove_(event);\n    } else if (event.pointerEvent.pointerType == POINTER_TYPE ||\n        (event.type === MapBrowserEventType.POINTERDRAG && !this.downTimeout_)) {\n      this.handlePointerMove_(event);\n    }\n  } else if (event.type === MapBrowserEventType.DBLCLICK) {\n    pass = false;\n  }\n\n  return handlePointerEvent.call(this, event) && pass;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} event Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/Draw}\n */\nfunction handleDownEvent(event) {\n  this.shouldHandle_ = !this.freehand_;\n\n  if (this.freehand_) {\n    this.downPx_ = event.pixel;\n    if (!this.finishCoordinate_) {\n      this.startDrawing_(event);\n    }\n    return true;\n  } else if (this.condition_(event)) {\n    this.lastDragTime_ = Date.now();\n    this.downTimeout_ = setTimeout(function() {\n      this.handlePointerMove_(new MapBrowserPointerEvent(\n        MapBrowserEventType.POINTERMOVE, event.map, event.pointerEvent, event.frameState));\n    }.bind(this), this.dragVertexDelay_);\n    this.downPx_ = event.pixel;\n    return true;\n  } else {\n    return false;\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} event Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/Draw}\n */\nfunction handleUpEvent(event) {\n  let pass = true;\n\n  if (this.downTimeout_) {\n    clearTimeout(this.downTimeout_);\n    this.downTimeout_ = undefined;\n  }\n\n  this.handlePointerMove_(event);\n\n  const circleMode = this.mode_ === Mode.CIRCLE;\n\n  if (this.shouldHandle_) {\n    if (!this.finishCoordinate_) {\n      this.startDrawing_(event);\n      if (this.mode_ === Mode.POINT) {\n        this.finishDrawing();\n      }\n    } else if (this.freehand_ || circleMode) {\n      this.finishDrawing();\n    } else if (this.atFinish_(event)) {\n      if (this.finishCondition_(event)) {\n        this.finishDrawing();\n      }\n    } else {\n      this.addToDrawing_(event);\n    }\n    pass = false;\n  } else if (this.freehand_) {\n    this.finishCoordinate_ = null;\n    this.abortDrawing_();\n  }\n  if (!pass && this.stopClick_) {\n    event.stopPropagation();\n  }\n  return pass;\n}\n\n\n/**\n * Handle move events.\n * @param {module:ol/MapBrowserEvent} event A move event.\n * @return {boolean} Pass the event to other interactions.\n * @private\n */\nDraw.prototype.handlePointerMove_ = function(event) {\n  if (this.downPx_ &&\n      ((!this.freehand_ && this.shouldHandle_) ||\n      (this.freehand_ && !this.shouldHandle_))) {\n    const downPx = this.downPx_;\n    const clickPx = event.pixel;\n    const dx = downPx[0] - clickPx[0];\n    const dy = downPx[1] - clickPx[1];\n    const squaredDistance = dx * dx + dy * dy;\n    this.shouldHandle_ = this.freehand_ ?\n      squaredDistance > this.squaredClickTolerance_ :\n      squaredDistance <= this.squaredClickTolerance_;\n    if (!this.shouldHandle_) {\n      return true;\n    }\n  }\n\n  if (this.finishCoordinate_) {\n    this.modifyDrawing_(event);\n  } else {\n    this.createOrUpdateSketchPoint_(event);\n  }\n  return true;\n};\n\n\n/**\n * Determine if an event is within the snapping tolerance of the start coord.\n * @param {module:ol/MapBrowserEvent} event Event.\n * @return {boolean} The event is within the snapping tolerance of the start.\n * @private\n */\nDraw.prototype.atFinish_ = function(event) {\n  let at = false;\n  if (this.sketchFeature_) {\n    let potentiallyDone = false;\n    let potentiallyFinishCoordinates = [this.finishCoordinate_];\n    if (this.mode_ === Mode.LINE_STRING) {\n      potentiallyDone = this.sketchCoords_.length > this.minPoints_;\n    } else if (this.mode_ === Mode.POLYGON) {\n      potentiallyDone = this.sketchCoords_[0].length >\n          this.minPoints_;\n      potentiallyFinishCoordinates = [this.sketchCoords_[0][0],\n        this.sketchCoords_[0][this.sketchCoords_[0].length - 2]];\n    }\n    if (potentiallyDone) {\n      const map = event.map;\n      for (let i = 0, ii = potentiallyFinishCoordinates.length; i < ii; i++) {\n        const finishCoordinate = potentiallyFinishCoordinates[i];\n        const finishPixel = map.getPixelFromCoordinate(finishCoordinate);\n        const pixel = event.pixel;\n        const dx = pixel[0] - finishPixel[0];\n        const dy = pixel[1] - finishPixel[1];\n        const snapTolerance = this.freehand_ ? 1 : this.snapTolerance_;\n        at = Math.sqrt(dx * dx + dy * dy) <= snapTolerance;\n        if (at) {\n          this.finishCoordinate_ = finishCoordinate;\n          break;\n        }\n      }\n    }\n  }\n  return at;\n};\n\n\n/**\n * @param {module:ol/MapBrowserEvent} event Event.\n * @private\n */\nDraw.prototype.createOrUpdateSketchPoint_ = function(event) {\n  const coordinates = event.coordinate.slice();\n  if (!this.sketchPoint_) {\n    this.sketchPoint_ = new Feature(new Point(coordinates));\n    this.updateSketchFeatures_();\n  } else {\n    const sketchPointGeom = /** @type {module:ol/geom/Point} */ (this.sketchPoint_.getGeometry());\n    sketchPointGeom.setCoordinates(coordinates);\n  }\n};\n\n\n/**\n * Start the drawing.\n * @param {module:ol/MapBrowserEvent} event Event.\n * @private\n */\nDraw.prototype.startDrawing_ = function(event) {\n  const start = event.coordinate;\n  this.finishCoordinate_ = start;\n  if (this.mode_ === Mode.POINT) {\n    this.sketchCoords_ = start.slice();\n  } else if (this.mode_ === Mode.POLYGON) {\n    this.sketchCoords_ = [[start.slice(), start.slice()]];\n    this.sketchLineCoords_ = this.sketchCoords_[0];\n  } else {\n    this.sketchCoords_ = [start.slice(), start.slice()];\n  }\n  if (this.sketchLineCoords_) {\n    this.sketchLine_ = new Feature(\n      new LineString(this.sketchLineCoords_));\n  }\n  const geometry = this.geometryFunction_(this.sketchCoords_);\n  this.sketchFeature_ = new Feature();\n  if (this.geometryName_) {\n    this.sketchFeature_.setGeometryName(this.geometryName_);\n  }\n  this.sketchFeature_.setGeometry(geometry);\n  this.updateSketchFeatures_();\n  this.dispatchEvent(new DrawEvent(DrawEventType.DRAWSTART, this.sketchFeature_));\n};\n\n\n/**\n * Modify the drawing.\n * @param {module:ol/MapBrowserEvent} event Event.\n * @private\n */\nDraw.prototype.modifyDrawing_ = function(event) {\n  let coordinate = event.coordinate;\n  const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (this.sketchFeature_.getGeometry());\n  let coordinates, last;\n  if (this.mode_ === Mode.POINT) {\n    last = this.sketchCoords_;\n  } else if (this.mode_ === Mode.POLYGON) {\n    coordinates = this.sketchCoords_[0];\n    last = coordinates[coordinates.length - 1];\n    if (this.atFinish_(event)) {\n      // snap to finish\n      coordinate = this.finishCoordinate_.slice();\n    }\n  } else {\n    coordinates = this.sketchCoords_;\n    last = coordinates[coordinates.length - 1];\n  }\n  last[0] = coordinate[0];\n  last[1] = coordinate[1];\n  this.geometryFunction_(/** @type {!Array.<module:ol/coordinate~Coordinate>} */ (this.sketchCoords_), geometry);\n  if (this.sketchPoint_) {\n    const sketchPointGeom = /** @type {module:ol/geom/Point} */ (this.sketchPoint_.getGeometry());\n    sketchPointGeom.setCoordinates(coordinate);\n  }\n  let sketchLineGeom;\n  if (geometry instanceof Polygon &&\n      this.mode_ !== Mode.POLYGON) {\n    if (!this.sketchLine_) {\n      this.sketchLine_ = new Feature(new LineString(null));\n    }\n    const ring = geometry.getLinearRing(0);\n    sketchLineGeom = /** @type {module:ol/geom/LineString} */ (this.sketchLine_.getGeometry());\n    sketchLineGeom.setFlatCoordinates(\n      ring.getLayout(), ring.getFlatCoordinates());\n  } else if (this.sketchLineCoords_) {\n    sketchLineGeom = /** @type {module:ol/geom/LineString} */ (this.sketchLine_.getGeometry());\n    sketchLineGeom.setCoordinates(this.sketchLineCoords_);\n  }\n  this.updateSketchFeatures_();\n};\n\n\n/**\n * Add a new coordinate to the drawing.\n * @param {module:ol/MapBrowserEvent} event Event.\n * @private\n */\nDraw.prototype.addToDrawing_ = function(event) {\n  const coordinate = event.coordinate;\n  const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (this.sketchFeature_.getGeometry());\n  let done;\n  let coordinates;\n  if (this.mode_ === Mode.LINE_STRING) {\n    this.finishCoordinate_ = coordinate.slice();\n    coordinates = this.sketchCoords_;\n    if (coordinates.length >= this.maxPoints_) {\n      if (this.freehand_) {\n        coordinates.pop();\n      } else {\n        done = true;\n      }\n    }\n    coordinates.push(coordinate.slice());\n    this.geometryFunction_(coordinates, geometry);\n  } else if (this.mode_ === Mode.POLYGON) {\n    coordinates = this.sketchCoords_[0];\n    if (coordinates.length >= this.maxPoints_) {\n      if (this.freehand_) {\n        coordinates.pop();\n      } else {\n        done = true;\n      }\n    }\n    coordinates.push(coordinate.slice());\n    if (done) {\n      this.finishCoordinate_ = coordinates[0];\n    }\n    this.geometryFunction_(this.sketchCoords_, geometry);\n  }\n  this.updateSketchFeatures_();\n  if (done) {\n    this.finishDrawing();\n  }\n};\n\n\n/**\n * Remove last point of the feature currently being drawn.\n * @api\n */\nDraw.prototype.removeLastPoint = function() {\n  if (!this.sketchFeature_) {\n    return;\n  }\n  const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (this.sketchFeature_.getGeometry());\n  let coordinates, sketchLineGeom;\n  if (this.mode_ === Mode.LINE_STRING) {\n    coordinates = this.sketchCoords_;\n    coordinates.splice(-2, 1);\n    this.geometryFunction_(coordinates, geometry);\n    if (coordinates.length >= 2) {\n      this.finishCoordinate_ = coordinates[coordinates.length - 2].slice();\n    }\n  } else if (this.mode_ === Mode.POLYGON) {\n    coordinates = this.sketchCoords_[0];\n    coordinates.splice(-2, 1);\n    sketchLineGeom = /** @type {module:ol/geom/LineString} */ (this.sketchLine_.getGeometry());\n    sketchLineGeom.setCoordinates(coordinates);\n    this.geometryFunction_(this.sketchCoords_, geometry);\n  }\n\n  if (coordinates.length === 0) {\n    this.finishCoordinate_ = null;\n  }\n\n  this.updateSketchFeatures_();\n};\n\n\n/**\n * Stop drawing and add the sketch feature to the target layer.\n * The {@link module:ol/interaction/Draw~DrawEventType.DRAWEND} event is\n * dispatched before inserting the feature.\n * @api\n */\nDraw.prototype.finishDrawing = function() {\n  const sketchFeature = this.abortDrawing_();\n  if (!sketchFeature) {\n    return;\n  }\n  let coordinates = this.sketchCoords_;\n  const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (sketchFeature.getGeometry());\n  if (this.mode_ === Mode.LINE_STRING) {\n    // remove the redundant last point\n    coordinates.pop();\n    this.geometryFunction_(coordinates, geometry);\n  } else if (this.mode_ === Mode.POLYGON) {\n    // remove the redundant last point in ring\n    coordinates[0].pop();\n    this.geometryFunction_(coordinates, geometry);\n    coordinates = geometry.getCoordinates();\n  }\n\n  // cast multi-part geometries\n  if (this.type_ === GeometryType.MULTI_POINT) {\n    sketchFeature.setGeometry(new MultiPoint([coordinates]));\n  } else if (this.type_ === GeometryType.MULTI_LINE_STRING) {\n    sketchFeature.setGeometry(new MultiLineString([coordinates]));\n  } else if (this.type_ === GeometryType.MULTI_POLYGON) {\n    sketchFeature.setGeometry(new MultiPolygon([coordinates]));\n  }\n\n  // First dispatch event to allow full set up of feature\n  this.dispatchEvent(new DrawEvent(DrawEventType.DRAWEND, sketchFeature));\n\n  // Then insert feature\n  if (this.features_) {\n    this.features_.push(sketchFeature);\n  }\n  if (this.source_) {\n    this.source_.addFeature(sketchFeature);\n  }\n};\n\n\n/**\n * Stop drawing without adding the sketch feature to the target layer.\n * @return {module:ol/Feature} The sketch feature (or null if none).\n * @private\n */\nDraw.prototype.abortDrawing_ = function() {\n  this.finishCoordinate_ = null;\n  const sketchFeature = this.sketchFeature_;\n  if (sketchFeature) {\n    this.sketchFeature_ = null;\n    this.sketchPoint_ = null;\n    this.sketchLine_ = null;\n    this.overlay_.getSource().clear(true);\n  }\n  return sketchFeature;\n};\n\n\n/**\n * Extend an existing geometry by adding additional points. This only works\n * on features with `LineString` geometries, where the interaction will\n * extend lines by adding points to the end of the coordinates array.\n * @param {!module:ol/Feature} feature Feature to be extended.\n * @api\n */\nDraw.prototype.extend = function(feature) {\n  const geometry = feature.getGeometry();\n  const lineString = /** @type {module:ol/geom/LineString} */ (geometry);\n  this.sketchFeature_ = feature;\n  this.sketchCoords_ = lineString.getCoordinates();\n  const last = this.sketchCoords_[this.sketchCoords_.length - 1];\n  this.finishCoordinate_ = last.slice();\n  this.sketchCoords_.push(last.slice());\n  this.updateSketchFeatures_();\n  this.dispatchEvent(new DrawEvent(DrawEventType.DRAWSTART, this.sketchFeature_));\n};\n\n\n/**\n * @inheritDoc\n */\nDraw.prototype.shouldStopEvent = FALSE;\n\n\n/**\n * Redraw the sketch features.\n * @private\n */\nDraw.prototype.updateSketchFeatures_ = function() {\n  const sketchFeatures = [];\n  if (this.sketchFeature_) {\n    sketchFeatures.push(this.sketchFeature_);\n  }\n  if (this.sketchLine_) {\n    sketchFeatures.push(this.sketchLine_);\n  }\n  if (this.sketchPoint_) {\n    sketchFeatures.push(this.sketchPoint_);\n  }\n  const overlaySource = this.overlay_.getSource();\n  overlaySource.clear(true);\n  overlaySource.addFeatures(sketchFeatures);\n};\n\n\n/**\n * @private\n */\nDraw.prototype.updateState_ = function() {\n  const map = this.getMap();\n  const active = this.getActive();\n  if (!map || !active) {\n    this.abortDrawing_();\n  }\n  this.overlay_.setMap(active ? map : null);\n};\n\n\n/**\n * Create a `geometryFunction` for `type: 'Circle'` that will create a regular\n * polygon with a user specified number of sides and start angle instead of an\n * `module:ol/geom/Circle~Circle` geometry.\n * @param {number=} opt_sides Number of sides of the regular polygon. Default is\n *     32.\n * @param {number=} opt_angle Angle of the first point in radians. 0 means East.\n *     Default is the angle defined by the heading from the center of the\n *     regular polygon to the current pointer position.\n * @return {module:ol/interaction/Draw~GeometryFunction} Function that draws a\n *     polygon.\n * @api\n */\nexport function createRegularPolygon(opt_sides, opt_angle) {\n  return function(coordinates, opt_geometry) {\n    const center = coordinates[0];\n    const end = coordinates[1];\n    const radius = Math.sqrt(\n      squaredCoordinateDistance(center, end));\n    const geometry = opt_geometry ? /** @type {module:ol/geom/Polygon} */ (opt_geometry) :\n      fromCircle(new Circle(center), opt_sides);\n    const angle = opt_angle ? opt_angle :\n      Math.atan((end[1] - center[1]) / (end[0] - center[0]));\n    makeRegular(geometry, center, radius, angle);\n    return geometry;\n  };\n}\n\n\n/**\n * Create a `geometryFunction` that will create a box-shaped polygon (aligned\n * with the coordinate system axes).  Use this with the draw interaction and\n * `type: 'Circle'` to return a box instead of a circle geometry.\n * @return {module:ol/interaction/Draw~GeometryFunction} Function that draws a box-shaped polygon.\n * @api\n */\nexport function createBox() {\n  return (\n    function(coordinates, opt_geometry) {\n      const extent = boundingExtent(coordinates);\n      const geometry = opt_geometry || new Polygon(null);\n      geometry.setCoordinates([[\n        getBottomLeft(extent),\n        getBottomRight(extent),\n        getTopRight(extent),\n        getTopLeft(extent),\n        getBottomLeft(extent)\n      ]]);\n      return geometry;\n    }\n  );\n}\n\n\n/**\n * Get the drawing mode.  The mode for mult-part geometries is the same as for\n * their single-part cousins.\n * @param {module:ol/geom/GeometryType} type Geometry type.\n * @return {module:ol/interaction/Draw~Mode} Drawing mode.\n */\nfunction getMode(type) {\n  let mode;\n  if (type === GeometryType.POINT ||\n      type === GeometryType.MULTI_POINT) {\n    mode = Mode.POINT;\n  } else if (type === GeometryType.LINE_STRING ||\n      type === GeometryType.MULTI_LINE_STRING) {\n    mode = Mode.LINE_STRING;\n  } else if (type === GeometryType.POLYGON ||\n      type === GeometryType.MULTI_POLYGON) {\n    mode = Mode.POLYGON;\n  } else if (type === GeometryType.CIRCLE) {\n    mode = Mode.CIRCLE;\n  }\n  return (\n    /** @type {!module:ol/interaction/Draw~Mode} */ (mode)\n  );\n}\n\n\nexport default Draw;\n","/**\n * @module ol/interaction/Extent\n */\nimport {inherits} from '../util.js';\nimport Feature from '../Feature.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport MapBrowserPointerEvent from '../MapBrowserPointerEvent.js';\nimport {squaredDistanceToSegment, closestOnSegment, distance as coordinateDistance, squaredDistance as squaredCoordinateDistance} from '../coordinate.js';\nimport Event from '../events/Event.js';\nimport {boundingExtent, getArea} from '../extent.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport Point from '../geom/Point.js';\nimport {fromExtent as polygonFromExtent} from '../geom/Polygon.js';\nimport PointerInteraction, {handleEvent as handlePointerEvent} from '../interaction/Pointer.js';\nimport VectorLayer from '../layer/Vector.js';\nimport VectorSource from '../source/Vector.js';\nimport {createEditingStyle} from '../style/Style.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/extent~Extent} [extent] Initial extent. Defaults to no\n * initial extent.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [boxStyle]\n * Style for the drawn extent box. Defaults to\n * {@link module:ol/style/Style~createEditing()['Polygon']}\n * @property {number} [pixelTolerance=10] Pixel tolerance for considering the\n * pointer close enough to a segment or vertex for editing.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [pointerStyle]\n * Style for the cursor used to draw the extent. Defaults to\n * {@link module:ol/style/Style~createEditing()['Point']}\n * @property {boolean} [wrapX=false] Wrap the drawn extent across multiple maps\n * in the X direction? Only affects visuals, not functionality.\n */\n\n\n/**\n * @enum {string}\n */\nconst ExtentEventType = {\n  /**\n   * Triggered after the extent is changed\n   * @event module:ol/interaction/Extent~ExtentEventType#extentchanged\n   * @api\n   */\n  EXTENTCHANGED: 'extentchanged'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Extent~Extent} instances are\n * instances of this type.\n *\n * @constructor\n * @param {module:ol/extent~Extent} extent the new extent\n * @extends {module:ol/events/Event}\n */\nconst ExtentInteractionEvent = function(extent) {\n  Event.call(this, ExtentEventType.EXTENTCHANGED);\n\n  /**\n   * The current extent.\n   * @type {module:ol/extent~Extent}\n   * @api\n   */\n  this.extent = extent;\n\n};\ninherits(ExtentInteractionEvent, Event);\n\n\n/**\n * @classdesc\n * Allows the user to draw a vector box by clicking and dragging on the map.\n * Once drawn, the vector box can be modified by dragging its vertices or edges.\n * This interaction is only supported for mouse devices.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @fires module:ol/interaction/Extent~Event\n * @param {module:ol/interaction/Extent~Options=} opt_options Options.\n * @api\n */\nconst ExtentInteraction = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * Extent of the drawn box\n   * @type {module:ol/extent~Extent}\n   * @private\n   */\n  this.extent_ = null;\n\n  /**\n   * Handler for pointer move events\n   * @type {function (module:ol/coordinate~Coordinate): module:ol/extent~Extent|null}\n   * @private\n   */\n  this.pointerHandler_ = null;\n\n  /**\n   * Pixel threshold to snap to extent\n   * @type {number}\n   * @private\n   */\n  this.pixelTolerance_ = options.pixelTolerance !== undefined ?\n    options.pixelTolerance : 10;\n\n  /**\n   * Is the pointer snapped to an extent vertex\n   * @type {boolean}\n   * @private\n   */\n  this.snappedToVertex_ = false;\n\n  /**\n   * Feature for displaying the visible extent\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.extentFeature_ = null;\n\n  /**\n   * Feature for displaying the visible pointer\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.vertexFeature_ = null;\n\n  if (!opt_options) {\n    opt_options = {};\n  }\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleEvent: handleEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  /**\n   * Layer for the extentFeature\n   * @type {module:ol/layer/Vector}\n   * @private\n   */\n  this.extentOverlay_ = new VectorLayer({\n    source: new VectorSource({\n      useSpatialIndex: false,\n      wrapX: !!opt_options.wrapX\n    }),\n    style: opt_options.boxStyle ? opt_options.boxStyle : getDefaultExtentStyleFunction(),\n    updateWhileAnimating: true,\n    updateWhileInteracting: true\n  });\n\n  /**\n   * Layer for the vertexFeature\n   * @type {module:ol/layer/Vector}\n   * @private\n   */\n  this.vertexOverlay_ = new VectorLayer({\n    source: new VectorSource({\n      useSpatialIndex: false,\n      wrapX: !!opt_options.wrapX\n    }),\n    style: opt_options.pointerStyle ? opt_options.pointerStyle : getDefaultPointerStyleFunction(),\n    updateWhileAnimating: true,\n    updateWhileInteracting: true\n  });\n\n  if (opt_options.extent) {\n    this.setExtent(opt_options.extent);\n  }\n};\n\ninherits(ExtentInteraction, PointerInteraction);\n\n/**\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Event.\n * @return {boolean} Propagate event?\n * @this {module:ol/interaction/Extent~Extent}\n */\nfunction handleEvent(mapBrowserEvent) {\n  if (!(mapBrowserEvent instanceof MapBrowserPointerEvent)) {\n    return true;\n  }\n  //display pointer (if not dragging)\n  if (mapBrowserEvent.type == MapBrowserEventType.POINTERMOVE && !this.handlingDownUpSequence) {\n    this.handlePointerMove_(mapBrowserEvent);\n  }\n  //call pointer to determine up/down/drag\n  handlePointerEvent.call(this, mapBrowserEvent);\n  //return false to stop propagation\n  return false;\n}\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Event handled?\n * @this {module:ol/interaction/Extent~Extent}\n */\nfunction handleDownEvent(mapBrowserEvent) {\n  const pixel = mapBrowserEvent.pixel;\n  const map = mapBrowserEvent.map;\n\n  const extent = this.getExtent();\n  let vertex = this.snapToVertex_(pixel, map);\n\n  //find the extent corner opposite the passed corner\n  const getOpposingPoint = function(point) {\n    let x_ = null;\n    let y_ = null;\n    if (point[0] == extent[0]) {\n      x_ = extent[2];\n    } else if (point[0] == extent[2]) {\n      x_ = extent[0];\n    }\n    if (point[1] == extent[1]) {\n      y_ = extent[3];\n    } else if (point[1] == extent[3]) {\n      y_ = extent[1];\n    }\n    if (x_ !== null && y_ !== null) {\n      return [x_, y_];\n    }\n    return null;\n  };\n  if (vertex && extent) {\n    const x = (vertex[0] == extent[0] || vertex[0] == extent[2]) ? vertex[0] : null;\n    const y = (vertex[1] == extent[1] || vertex[1] == extent[3]) ? vertex[1] : null;\n\n    //snap to point\n    if (x !== null && y !== null) {\n      this.pointerHandler_ = getPointHandler(getOpposingPoint(vertex));\n    //snap to edge\n    } else if (x !== null) {\n      this.pointerHandler_ = getEdgeHandler(\n        getOpposingPoint([x, extent[1]]),\n        getOpposingPoint([x, extent[3]])\n      );\n    } else if (y !== null) {\n      this.pointerHandler_ = getEdgeHandler(\n        getOpposingPoint([extent[0], y]),\n        getOpposingPoint([extent[2], y])\n      );\n    }\n  //no snap - new bbox\n  } else {\n    vertex = map.getCoordinateFromPixel(pixel);\n    this.setExtent([vertex[0], vertex[1], vertex[0], vertex[1]]);\n    this.pointerHandler_ = getPointHandler(vertex);\n  }\n  return true; //event handled; start downup sequence\n}\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Event handled?\n * @this {module:ol/interaction/Extent~Extent}\n */\nfunction handleDragEvent(mapBrowserEvent) {\n  if (this.pointerHandler_) {\n    const pixelCoordinate = mapBrowserEvent.coordinate;\n    this.setExtent(this.pointerHandler_(pixelCoordinate));\n    this.createOrUpdatePointerFeature_(pixelCoordinate);\n  }\n  return true;\n}\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserEvent Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/Extent~Extent}\n */\nfunction handleUpEvent(mapBrowserEvent) {\n  this.pointerHandler_ = null;\n  //If bbox is zero area, set to null;\n  const extent = this.getExtent();\n  if (!extent || getArea(extent) === 0) {\n    this.setExtent(null);\n  }\n  return false; //Stop handling downup sequence\n}\n\n/**\n * Returns the default style for the drawn bbox\n *\n * @return {module:ol/style/Style~StyleFunction} Default Extent style\n */\nfunction getDefaultExtentStyleFunction() {\n  const style = createEditingStyle();\n  return function(feature, resolution) {\n    return style[GeometryType.POLYGON];\n  };\n}\n\n/**\n * Returns the default style for the pointer\n *\n * @return {module:ol/style/Style~StyleFunction} Default pointer style\n */\nfunction getDefaultPointerStyleFunction() {\n  const style = createEditingStyle();\n  return function(feature, resolution) {\n    return style[GeometryType.POINT];\n  };\n}\n\n/**\n * @param {module:ol/coordinate~Coordinate} fixedPoint corner that will be unchanged in the new extent\n * @returns {function (module:ol/coordinate~Coordinate): module:ol/extent~Extent} event handler\n */\nfunction getPointHandler(fixedPoint) {\n  return function(point) {\n    return boundingExtent([fixedPoint, point]);\n  };\n}\n\n/**\n * @param {module:ol/coordinate~Coordinate} fixedP1 first corner that will be unchanged in the new extent\n * @param {module:ol/coordinate~Coordinate} fixedP2 second corner that will be unchanged in the new extent\n * @returns {function (module:ol/coordinate~Coordinate): module:ol/extent~Extent|null} event handler\n */\nfunction getEdgeHandler(fixedP1, fixedP2) {\n  if (fixedP1[0] == fixedP2[0]) {\n    return function(point) {\n      return boundingExtent([fixedP1, [point[0], fixedP2[1]]]);\n    };\n  } else if (fixedP1[1] == fixedP2[1]) {\n    return function(point) {\n      return boundingExtent([fixedP1, [fixedP2[0], point[1]]]);\n    };\n  } else {\n    return null;\n  }\n}\n\n/**\n * @param {module:ol/extent~Extent} extent extent\n * @returns {Array<Array<module:ol/coordinate~Coordinate>>} extent line segments\n */\nfunction getSegments(extent) {\n  return [\n    [[extent[0], extent[1]], [extent[0], extent[3]]],\n    [[extent[0], extent[3]], [extent[2], extent[3]]],\n    [[extent[2], extent[3]], [extent[2], extent[1]]],\n    [[extent[2], extent[1]], [extent[0], extent[1]]]\n  ];\n}\n\n/**\n * @param {module:ol~Pixel} pixel cursor location\n * @param {module:ol/PluggableMap} map map\n * @returns {module:ol/coordinate~Coordinate|null} snapped vertex on extent\n * @private\n */\nExtentInteraction.prototype.snapToVertex_ = function(pixel, map) {\n  const pixelCoordinate = map.getCoordinateFromPixel(pixel);\n  const sortByDistance = function(a, b) {\n    return squaredDistanceToSegment(pixelCoordinate, a) -\n        squaredDistanceToSegment(pixelCoordinate, b);\n  };\n  const extent = this.getExtent();\n  if (extent) {\n    //convert extents to line segments and find the segment closest to pixelCoordinate\n    const segments = getSegments(extent);\n    segments.sort(sortByDistance);\n    const closestSegment = segments[0];\n\n    let vertex = (closestOnSegment(pixelCoordinate,\n      closestSegment));\n    const vertexPixel = map.getPixelFromCoordinate(vertex);\n\n    //if the distance is within tolerance, snap to the segment\n    if (coordinateDistance(pixel, vertexPixel) <= this.pixelTolerance_) {\n      //test if we should further snap to a vertex\n      const pixel1 = map.getPixelFromCoordinate(closestSegment[0]);\n      const pixel2 = map.getPixelFromCoordinate(closestSegment[1]);\n      const squaredDist1 = squaredCoordinateDistance(vertexPixel, pixel1);\n      const squaredDist2 = squaredCoordinateDistance(vertexPixel, pixel2);\n      const dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));\n      this.snappedToVertex_ = dist <= this.pixelTolerance_;\n      if (this.snappedToVertex_) {\n        vertex = squaredDist1 > squaredDist2 ?\n          closestSegment[1] : closestSegment[0];\n      }\n      return vertex;\n    }\n  }\n  return null;\n};\n\n/**\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent pointer move event\n * @private\n */\nExtentInteraction.prototype.handlePointerMove_ = function(mapBrowserEvent) {\n  const pixel = mapBrowserEvent.pixel;\n  const map = mapBrowserEvent.map;\n\n  let vertex = this.snapToVertex_(pixel, map);\n  if (!vertex) {\n    vertex = map.getCoordinateFromPixel(pixel);\n  }\n  this.createOrUpdatePointerFeature_(vertex);\n};\n\n/**\n * @param {module:ol/extent~Extent} extent extent\n * @returns {module:ol/Feature} extent as featrue\n * @private\n */\nExtentInteraction.prototype.createOrUpdateExtentFeature_ = function(extent) {\n  let extentFeature = this.extentFeature_;\n\n  if (!extentFeature) {\n    if (!extent) {\n      extentFeature = new Feature({});\n    } else {\n      extentFeature = new Feature(polygonFromExtent(extent));\n    }\n    this.extentFeature_ = extentFeature;\n    this.extentOverlay_.getSource().addFeature(extentFeature);\n  } else {\n    if (!extent) {\n      extentFeature.setGeometry(undefined);\n    } else {\n      extentFeature.setGeometry(polygonFromExtent(extent));\n    }\n  }\n  return extentFeature;\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} vertex location of feature\n * @returns {module:ol/Feature} vertex as feature\n * @private\n */\nExtentInteraction.prototype.createOrUpdatePointerFeature_ = function(vertex) {\n  let vertexFeature = this.vertexFeature_;\n  if (!vertexFeature) {\n    vertexFeature = new Feature(new Point(vertex));\n    this.vertexFeature_ = vertexFeature;\n    this.vertexOverlay_.getSource().addFeature(vertexFeature);\n  } else {\n    const geometry = /** @type {module:ol/geom/Point} */ (vertexFeature.getGeometry());\n    geometry.setCoordinates(vertex);\n  }\n  return vertexFeature;\n};\n\n\n/**\n * @inheritDoc\n */\nExtentInteraction.prototype.setMap = function(map) {\n  this.extentOverlay_.setMap(map);\n  this.vertexOverlay_.setMap(map);\n  PointerInteraction.prototype.setMap.call(this, map);\n};\n\n/**\n * Returns the current drawn extent in the view projection\n *\n * @return {module:ol/extent~Extent} Drawn extent in the view projection.\n * @api\n */\nExtentInteraction.prototype.getExtent = function() {\n  return this.extent_;\n};\n\n/**\n * Manually sets the drawn extent, using the view projection.\n *\n * @param {module:ol/extent~Extent} extent Extent\n * @api\n */\nExtentInteraction.prototype.setExtent = function(extent) {\n  //Null extent means no bbox\n  this.extent_ = extent ? extent : null;\n  this.createOrUpdateExtentFeature_(extent);\n  this.dispatchEvent(new ExtentInteractionEvent(this.extent_));\n};\n\n\nexport default ExtentInteraction;\n","/**\n * @module ol/interaction/Modify\n */\nimport {getUid, inherits} from '../util.js';\nimport Collection from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport Feature from '../Feature.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport MapBrowserPointerEvent from '../MapBrowserPointerEvent.js';\nimport {equals} from '../array.js';\nimport {equals as coordinatesEqual, distance as coordinateDistance, squaredDistance as squaredCoordinateDistance, squaredDistanceToSegment, closestOnSegment} from '../coordinate.js';\nimport {listen, unlisten} from '../events.js';\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport {always, primaryAction, altKeyOnly, singleClick} from '../events/condition.js';\nimport {boundingExtent, buffer, createOrUpdateFromCoordinate} from '../extent.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport Point from '../geom/Point.js';\nimport PointerInteraction, {handleEvent as handlePointerEvent} from '../interaction/Pointer.js';\nimport VectorLayer from '../layer/Vector.js';\nimport VectorSource from '../source/Vector.js';\nimport VectorEventType from '../source/VectorEventType.js';\nimport RBush from '../structs/RBush.js';\nimport {createEditingStyle} from '../style/Style.js';\n\n\n/**\n * @enum {string}\n */\nconst ModifyEventType = {\n  /**\n   * Triggered upon feature modification start\n   * @event ModifyEvent#modifystart\n   * @api\n   */\n  MODIFYSTART: 'modifystart',\n  /**\n   * Triggered upon feature modification end\n   * @event ModifyEvent#modifyend\n   * @api\n   */\n  MODIFYEND: 'modifyend'\n};\n\n\n/**\n * @typedef {Object} SegmentData\n * @property {Array.<number>} [depth]\n * @property {module:ol/Feature} feature\n * @property {module:ol/geom/SimpleGeometry} geometry\n * @property {number} index\n * @property {Array.<module:ol/extent~Extent>} segment\n * @property {Array.<module:ol/interaction/Modify~SegmentData>} [featureSegments]\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event will be considered to add or move a\n * vertex to the sketch. Default is\n * {@link module:ol/events/condition~primaryAction}.\n * @property {module:ol/events/condition~Condition} [deleteCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. By default,\n * {@link module:ol/events/condition~singleClick} with\n * {@link module:ol/events/condition~altKeyOnly} results in a vertex deletion.\n * @property {module:ol/events/condition~Condition} [insertVertexCondition] A\n * function that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and\n * returns a boolean to indicate whether a new vertex can be added to the sketch\n * features. Default is {@link module:ol/events/condition~always}.\n * @property {number} [pixelTolerance=10] Pixel tolerance for considering the\n * pointer close enough to a segment or vertex for editing.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [style]\n * Style used for the features being modified. By default the default edit\n * style is used (see {@link module:ol/style}).\n * @property {module:ol/source/Vector} [source] The vector source with\n * features to modify.  If a vector source is not provided, a feature collection\n * must be provided with the features option.\n * @property {module:ol/Collection.<module:ol/Feature>} [features]\n * The features the interaction works on.  If a feature collection is not\n * provided, a vector source must be provided with the source option.\n * @property {boolean} [wrapX=false] Wrap the world horizontally on the sketch\n * overlay.\n */\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Modify~Modify} instances are\n * instances of this type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {ModifyEventType} type Type.\n * @param {module:ol/Collection.<module:ol/Feature>} features\n * The features modified.\n * @param {module:ol/MapBrowserPointerEvent} mapBrowserPointerEvent\n * Associated {@link module:ol/MapBrowserPointerEvent}.\n */\nexport const ModifyEvent = function(type, features, mapBrowserPointerEvent) {\n\n  Event.call(this, type);\n\n  /**\n   * The features being modified.\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @api\n   */\n  this.features = features;\n\n  /**\n   * Associated {@link module:ol/MapBrowserEvent}.\n   * @type {module:ol/MapBrowserEvent}\n   * @api\n   */\n  this.mapBrowserEvent = mapBrowserPointerEvent;\n};\n\ninherits(ModifyEvent, Event);\n\n\n/**\n * @classdesc\n * Interaction for modifying feature geometries.  To modify features that have\n * been added to an existing source, construct the modify interaction with the\n * `source` option.  If you want to modify features in a collection (for example,\n * the collection used by a select interaction), construct the interaction with\n * the `features` option.  The interaction must be constructed with either a\n * `source` or `features` option.\n *\n * By default, the interaction will allow deletion of vertices when the `alt`\n * key is pressed.  To configure the interaction with a different condition\n * for deletion, use the `deleteCondition` option.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/Modify~Options} options Options.\n * @fires module:ol/interaction/Modify~ModifyEvent\n * @api\n */\nconst Modify = function(options) {\n\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleEvent: handleEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : primaryAction;\n\n\n  /**\n   * @private\n   * @param {module:ol/MapBrowserEvent} mapBrowserEvent Browser event.\n   * @return {boolean} Combined condition result.\n   */\n  this.defaultDeleteCondition_ = function(mapBrowserEvent) {\n    return altKeyOnly(mapBrowserEvent) && singleClick(mapBrowserEvent);\n  };\n\n  /**\n   * @type {module:ol/events/condition~Condition}\n   * @private\n   */\n  this.deleteCondition_ = options.deleteCondition ?\n    options.deleteCondition : this.defaultDeleteCondition_;\n\n  /**\n   * @type {module:ol/events/condition~Condition}\n   * @private\n   */\n  this.insertVertexCondition_ = options.insertVertexCondition ?\n    options.insertVertexCondition : always;\n\n  /**\n   * Editing vertex.\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.vertexFeature_ = null;\n\n  /**\n   * Segments intersecting {@link this.vertexFeature_} by segment uid.\n   * @type {Object.<string, boolean>}\n   * @private\n   */\n  this.vertexSegments_ = null;\n\n  /**\n   * @type {module:ol~Pixel}\n   * @private\n   */\n  this.lastPixel_ = [0, 0];\n\n  /**\n   * Tracks if the next `singleclick` event should be ignored to prevent\n   * accidental deletion right after vertex creation.\n   * @type {boolean}\n   * @private\n   */\n  this.ignoreNextSingleClick_ = false;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.modified_ = false;\n\n  /**\n   * Segment RTree for each layer\n   * @type {module:ol/structs/RBush.<module:ol/interaction/Modify~SegmentData>}\n   * @private\n   */\n  this.rBush_ = new RBush();\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.pixelTolerance_ = options.pixelTolerance !== undefined ?\n    options.pixelTolerance : 10;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.snappedToVertex_ = false;\n\n  /**\n   * Indicate whether the interaction is currently changing a feature's\n   * coordinates.\n   * @type {boolean}\n   * @private\n   */\n  this.changingFeature_ = false;\n\n  /**\n   * @type {Array}\n   * @private\n   */\n  this.dragSegments_ = [];\n\n  /**\n   * Draw overlay where sketch features are drawn.\n   * @type {module:ol/layer/Vector}\n   * @private\n   */\n  this.overlay_ = new VectorLayer({\n    source: new VectorSource({\n      useSpatialIndex: false,\n      wrapX: !!options.wrapX\n    }),\n    style: options.style ? options.style :\n      getDefaultStyleFunction(),\n    updateWhileAnimating: true,\n    updateWhileInteracting: true\n  });\n\n  /**\n   * @const\n   * @private\n   * @type {!Object.<string, function(module:ol/Feature, module:ol/geom/Geometry)>}\n   */\n  this.SEGMENT_WRITERS_ = {\n    'Point': this.writePointGeometry_,\n    'LineString': this.writeLineStringGeometry_,\n    'LinearRing': this.writeLineStringGeometry_,\n    'Polygon': this.writePolygonGeometry_,\n    'MultiPoint': this.writeMultiPointGeometry_,\n    'MultiLineString': this.writeMultiLineStringGeometry_,\n    'MultiPolygon': this.writeMultiPolygonGeometry_,\n    'Circle': this.writeCircleGeometry_,\n    'GeometryCollection': this.writeGeometryCollectionGeometry_\n  };\n\n\n  /**\n   * @type {module:ol/source/Vector}\n   * @private\n   */\n  this.source_ = null;\n\n  let features;\n  if (options.source) {\n    this.source_ = options.source;\n    features = new Collection(this.source_.getFeatures());\n    listen(this.source_, VectorEventType.ADDFEATURE,\n      this.handleSourceAdd_, this);\n    listen(this.source_, VectorEventType.REMOVEFEATURE,\n      this.handleSourceRemove_, this);\n  } else {\n    features = options.features;\n  }\n  if (!features) {\n    throw new Error('The modify interaction requires features or a source');\n  }\n\n  /**\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @private\n   */\n  this.features_ = features;\n\n  this.features_.forEach(this.addFeature_.bind(this));\n  listen(this.features_, CollectionEventType.ADD,\n    this.handleFeatureAdd_, this);\n  listen(this.features_, CollectionEventType.REMOVE,\n    this.handleFeatureRemove_, this);\n\n  /**\n   * @type {module:ol/MapBrowserPointerEvent}\n   * @private\n   */\n  this.lastPointerEvent_ = null;\n\n};\n\ninherits(Modify, PointerInteraction);\n\n\n/**\n * The segment index assigned to a circle's center when\n * breaking up a circle into ModifySegmentDataType segments.\n * @type {number}\n */\nconst CIRCLE_CENTER_INDEX = 0;\n\n/**\n * The segment index assigned to a circle's circumference when\n * breaking up a circle into ModifySegmentDataType segments.\n * @type {number}\n */\nconst CIRCLE_CIRCUMFERENCE_INDEX = 1;\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @private\n */\nModify.prototype.addFeature_ = function(feature) {\n  const geometry = feature.getGeometry();\n  if (geometry && geometry.getType() in this.SEGMENT_WRITERS_) {\n    this.SEGMENT_WRITERS_[geometry.getType()].call(this, feature, geometry);\n  }\n  const map = this.getMap();\n  if (map && map.isRendered() && this.getActive()) {\n    this.handlePointerAtPixel_(this.lastPixel_, map);\n  }\n  listen(feature, EventType.CHANGE,\n    this.handleFeatureChange_, this);\n};\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} evt Map browser event\n * @private\n */\nModify.prototype.willModifyFeatures_ = function(evt) {\n  if (!this.modified_) {\n    this.modified_ = true;\n    this.dispatchEvent(new ModifyEvent(\n      ModifyEventType.MODIFYSTART, this.features_, evt));\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @private\n */\nModify.prototype.removeFeature_ = function(feature) {\n  this.removeFeatureSegmentData_(feature);\n  // Remove the vertex feature if the collection of canditate features\n  // is empty.\n  if (this.vertexFeature_ && this.features_.getLength() === 0) {\n    this.overlay_.getSource().removeFeature(this.vertexFeature_);\n    this.vertexFeature_ = null;\n  }\n  unlisten(feature, EventType.CHANGE,\n    this.handleFeatureChange_, this);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @private\n */\nModify.prototype.removeFeatureSegmentData_ = function(feature) {\n  const rBush = this.rBush_;\n  const /** @type {Array.<module:ol/interaction/Modify~SegmentData>} */ nodesToRemove = [];\n  rBush.forEach(\n    /**\n     * @param {module:ol/interaction/Modify~SegmentData} node RTree node.\n     */\n    function(node) {\n      if (feature === node.feature) {\n        nodesToRemove.push(node);\n      }\n    });\n  for (let i = nodesToRemove.length - 1; i >= 0; --i) {\n    rBush.remove(nodesToRemove[i]);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nModify.prototype.setActive = function(active) {\n  if (this.vertexFeature_ && !active) {\n    this.overlay_.getSource().removeFeature(this.vertexFeature_);\n    this.vertexFeature_ = null;\n  }\n  PointerInteraction.prototype.setActive.call(this, active);\n};\n\n\n/**\n * @inheritDoc\n */\nModify.prototype.setMap = function(map) {\n  this.overlay_.setMap(map);\n  PointerInteraction.prototype.setMap.call(this, map);\n};\n\n\n/**\n * @param {module:ol/source/Vector~VectorSourceEvent} event Event.\n * @private\n */\nModify.prototype.handleSourceAdd_ = function(event) {\n  if (event.feature) {\n    this.features_.push(event.feature);\n  }\n};\n\n\n/**\n * @param {module:ol/source/Vector~VectorSourceEvent} event Event.\n * @private\n */\nModify.prototype.handleSourceRemove_ = function(event) {\n  if (event.feature) {\n    this.features_.remove(event.feature);\n  }\n};\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nModify.prototype.handleFeatureAdd_ = function(evt) {\n  this.addFeature_(/** @type {module:ol/Feature} */ (evt.element));\n};\n\n\n/**\n * @param {module:ol/events/Event} evt Event.\n * @private\n */\nModify.prototype.handleFeatureChange_ = function(evt) {\n  if (!this.changingFeature_) {\n    const feature = /** @type {module:ol/Feature} */ (evt.target);\n    this.removeFeature_(feature);\n    this.addFeature_(feature);\n  }\n};\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nModify.prototype.handleFeatureRemove_ = function(evt) {\n  const feature = /** @type {module:ol/Feature} */ (evt.element);\n  this.removeFeature_(feature);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/Point} geometry Geometry.\n * @private\n */\nModify.prototype.writePointGeometry_ = function(feature, geometry) {\n  const coordinates = geometry.getCoordinates();\n  const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n    feature: feature,\n    geometry: geometry,\n    segment: [coordinates, coordinates]\n  });\n  this.rBush_.insert(geometry.getExtent(), segmentData);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiPoint} geometry Geometry.\n * @private\n */\nModify.prototype.writeMultiPointGeometry_ = function(feature, geometry) {\n  const points = geometry.getCoordinates();\n  for (let i = 0, ii = points.length; i < ii; ++i) {\n    const coordinates = points[i];\n    const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n      feature: feature,\n      geometry: geometry,\n      depth: [i],\n      index: i,\n      segment: [coordinates, coordinates]\n    });\n    this.rBush_.insert(geometry.getExtent(), segmentData);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/LineString} geometry Geometry.\n * @private\n */\nModify.prototype.writeLineStringGeometry_ = function(feature, geometry) {\n  const coordinates = geometry.getCoordinates();\n  for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n    const segment = coordinates.slice(i, i + 2);\n    const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n      feature: feature,\n      geometry: geometry,\n      index: i,\n      segment: segment\n    });\n    this.rBush_.insert(boundingExtent(segment), segmentData);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiLineString} geometry Geometry.\n * @private\n */\nModify.prototype.writeMultiLineStringGeometry_ = function(feature, geometry) {\n  const lines = geometry.getCoordinates();\n  for (let j = 0, jj = lines.length; j < jj; ++j) {\n    const coordinates = lines[j];\n    for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n      const segment = coordinates.slice(i, i + 2);\n      const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n        feature: feature,\n        geometry: geometry,\n        depth: [j],\n        index: i,\n        segment: segment\n      });\n      this.rBush_.insert(boundingExtent(segment), segmentData);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/Polygon} geometry Geometry.\n * @private\n */\nModify.prototype.writePolygonGeometry_ = function(feature, geometry) {\n  const rings = geometry.getCoordinates();\n  for (let j = 0, jj = rings.length; j < jj; ++j) {\n    const coordinates = rings[j];\n    for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n      const segment = coordinates.slice(i, i + 2);\n      const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n        feature: feature,\n        geometry: geometry,\n        depth: [j],\n        index: i,\n        segment: segment\n      });\n      this.rBush_.insert(boundingExtent(segment), segmentData);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiPolygon} geometry Geometry.\n * @private\n */\nModify.prototype.writeMultiPolygonGeometry_ = function(feature, geometry) {\n  const polygons = geometry.getCoordinates();\n  for (let k = 0, kk = polygons.length; k < kk; ++k) {\n    const rings = polygons[k];\n    for (let j = 0, jj = rings.length; j < jj; ++j) {\n      const coordinates = rings[j];\n      for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n        const segment = coordinates.slice(i, i + 2);\n        const segmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n          feature: feature,\n          geometry: geometry,\n          depth: [j, k],\n          index: i,\n          segment: segment\n        });\n        this.rBush_.insert(boundingExtent(segment), segmentData);\n      }\n    }\n  }\n};\n\n\n/**\n * We convert a circle into two segments.  The segment at index\n * {@link CIRCLE_CENTER_INDEX} is the\n * circle's center (a point).  The segment at index\n * {@link CIRCLE_CIRCUMFERENCE_INDEX} is\n * the circumference, and is not a line segment.\n *\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/geom/Circle} geometry Geometry.\n * @private\n */\nModify.prototype.writeCircleGeometry_ = function(feature, geometry) {\n  const coordinates = geometry.getCenter();\n  const centerSegmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n    feature: feature,\n    geometry: geometry,\n    index: CIRCLE_CENTER_INDEX,\n    segment: [coordinates, coordinates]\n  });\n  const circumferenceSegmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n    feature: feature,\n    geometry: geometry,\n    index: CIRCLE_CIRCUMFERENCE_INDEX,\n    segment: [coordinates, coordinates]\n  });\n  const featureSegments = [centerSegmentData, circumferenceSegmentData];\n  centerSegmentData.featureSegments = circumferenceSegmentData.featureSegments = featureSegments;\n  this.rBush_.insert(createOrUpdateFromCoordinate(coordinates), centerSegmentData);\n  this.rBush_.insert(geometry.getExtent(), circumferenceSegmentData);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/GeometryCollection} geometry Geometry.\n * @private\n */\nModify.prototype.writeGeometryCollectionGeometry_ = function(feature, geometry) {\n  const geometries = geometry.getGeometriesArray();\n  for (let i = 0; i < geometries.length; ++i) {\n    this.SEGMENT_WRITERS_[geometries[i].getType()].call(this, feature, geometries[i]);\n  }\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinates Coordinates.\n * @return {module:ol/Feature} Vertex feature.\n * @private\n */\nModify.prototype.createOrUpdateVertexFeature_ = function(coordinates) {\n  let vertexFeature = this.vertexFeature_;\n  if (!vertexFeature) {\n    vertexFeature = new Feature(new Point(coordinates));\n    this.vertexFeature_ = vertexFeature;\n    this.overlay_.getSource().addFeature(vertexFeature);\n  } else {\n    const geometry = /** @type {module:ol/geom/Point} */ (vertexFeature.getGeometry());\n    geometry.setCoordinates(coordinates);\n  }\n  return vertexFeature;\n};\n\n\n/**\n * @param {module:ol/interaction/Modify~SegmentData} a The first segment data.\n * @param {module:ol/interaction/Modify~SegmentData} b The second segment data.\n * @return {number} The difference in indexes.\n */\nfunction compareIndexes(a, b) {\n  return a.index - b.index;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} evt Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/Modify}\n */\nfunction handleDownEvent(evt) {\n  if (!this.condition_(evt)) {\n    return false;\n  }\n  this.handlePointerAtPixel_(evt.pixel, evt.map);\n  const pixelCoordinate = evt.map.getCoordinateFromPixel(evt.pixel);\n  this.dragSegments_.length = 0;\n  this.modified_ = false;\n  const vertexFeature = this.vertexFeature_;\n  if (vertexFeature) {\n    const insertVertices = [];\n    const geometry = /** @type {module:ol/geom/Point} */ (vertexFeature.getGeometry());\n    const vertex = geometry.getCoordinates();\n    const vertexExtent = boundingExtent([vertex]);\n    const segmentDataMatches = this.rBush_.getInExtent(vertexExtent);\n    const componentSegments = {};\n    segmentDataMatches.sort(compareIndexes);\n    for (let i = 0, ii = segmentDataMatches.length; i < ii; ++i) {\n      const segmentDataMatch = segmentDataMatches[i];\n      const segment = segmentDataMatch.segment;\n      let uid = getUid(segmentDataMatch.feature);\n      const depth = segmentDataMatch.depth;\n      if (depth) {\n        uid += '-' + depth.join('-'); // separate feature components\n      }\n      if (!componentSegments[uid]) {\n        componentSegments[uid] = new Array(2);\n      }\n      if (segmentDataMatch.geometry.getType() === GeometryType.CIRCLE &&\n      segmentDataMatch.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n\n        const closestVertex = closestOnSegmentData(pixelCoordinate, segmentDataMatch);\n        if (coordinatesEqual(closestVertex, vertex) && !componentSegments[uid][0]) {\n          this.dragSegments_.push([segmentDataMatch, 0]);\n          componentSegments[uid][0] = segmentDataMatch;\n        }\n      } else if (coordinatesEqual(segment[0], vertex) &&\n          !componentSegments[uid][0]) {\n        this.dragSegments_.push([segmentDataMatch, 0]);\n        componentSegments[uid][0] = segmentDataMatch;\n      } else if (coordinatesEqual(segment[1], vertex) &&\n          !componentSegments[uid][1]) {\n\n        // prevent dragging closed linestrings by the connecting node\n        if ((segmentDataMatch.geometry.getType() ===\n            GeometryType.LINE_STRING ||\n            segmentDataMatch.geometry.getType() ===\n            GeometryType.MULTI_LINE_STRING) &&\n            componentSegments[uid][0] &&\n            componentSegments[uid][0].index === 0) {\n          continue;\n        }\n\n        this.dragSegments_.push([segmentDataMatch, 1]);\n        componentSegments[uid][1] = segmentDataMatch;\n      } else if (this.insertVertexCondition_(evt) && getUid(segment) in this.vertexSegments_ &&\n          (!componentSegments[uid][0] && !componentSegments[uid][1])) {\n        insertVertices.push([segmentDataMatch, vertex]);\n      }\n    }\n    if (insertVertices.length) {\n      this.willModifyFeatures_(evt);\n    }\n    for (let j = insertVertices.length - 1; j >= 0; --j) {\n      this.insertVertex_.apply(this, insertVertices[j]);\n    }\n  }\n  return !!this.vertexFeature_;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} evt Event.\n * @this {module:ol/interaction/Modify}\n */\nfunction handleDragEvent(evt) {\n  this.ignoreNextSingleClick_ = false;\n  this.willModifyFeatures_(evt);\n\n  const vertex = evt.coordinate;\n  for (let i = 0, ii = this.dragSegments_.length; i < ii; ++i) {\n    const dragSegment = this.dragSegments_[i];\n    const segmentData = dragSegment[0];\n    const depth = segmentData.depth;\n    const geometry = segmentData.geometry;\n    let coordinates;\n    const segment = segmentData.segment;\n    const index = dragSegment[1];\n\n    while (vertex.length < geometry.getStride()) {\n      vertex.push(segment[index][vertex.length]);\n    }\n\n    switch (geometry.getType()) {\n      case GeometryType.POINT:\n        coordinates = vertex;\n        segment[0] = segment[1] = vertex;\n        break;\n      case GeometryType.MULTI_POINT:\n        coordinates = geometry.getCoordinates();\n        coordinates[segmentData.index] = vertex;\n        segment[0] = segment[1] = vertex;\n        break;\n      case GeometryType.LINE_STRING:\n        coordinates = geometry.getCoordinates();\n        coordinates[segmentData.index + index] = vertex;\n        segment[index] = vertex;\n        break;\n      case GeometryType.MULTI_LINE_STRING:\n        coordinates = geometry.getCoordinates();\n        coordinates[depth[0]][segmentData.index + index] = vertex;\n        segment[index] = vertex;\n        break;\n      case GeometryType.POLYGON:\n        coordinates = geometry.getCoordinates();\n        coordinates[depth[0]][segmentData.index + index] = vertex;\n        segment[index] = vertex;\n        break;\n      case GeometryType.MULTI_POLYGON:\n        coordinates = geometry.getCoordinates();\n        coordinates[depth[1]][depth[0]][segmentData.index + index] = vertex;\n        segment[index] = vertex;\n        break;\n      case GeometryType.CIRCLE:\n        segment[0] = segment[1] = vertex;\n        if (segmentData.index === CIRCLE_CENTER_INDEX) {\n          this.changingFeature_ = true;\n          geometry.setCenter(vertex);\n          this.changingFeature_ = false;\n        } else { // We're dragging the circle's circumference:\n          this.changingFeature_ = true;\n          geometry.setRadius(coordinateDistance(geometry.getCenter(), vertex));\n          this.changingFeature_ = false;\n        }\n        break;\n      default:\n        // pass\n    }\n\n    if (coordinates) {\n      this.setGeometryCoordinates_(geometry, coordinates);\n    }\n  }\n  this.createOrUpdateVertexFeature_(vertex);\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} evt Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/Modify}\n */\nfunction handleUpEvent(evt) {\n  for (let i = this.dragSegments_.length - 1; i >= 0; --i) {\n    const segmentData = this.dragSegments_[i][0];\n    const geometry = segmentData.geometry;\n    if (geometry.getType() === GeometryType.CIRCLE) {\n      // Update a circle object in the R* bush:\n      const coordinates = geometry.getCenter();\n      const centerSegmentData = segmentData.featureSegments[0];\n      const circumferenceSegmentData = segmentData.featureSegments[1];\n      centerSegmentData.segment[0] = centerSegmentData.segment[1] = coordinates;\n      circumferenceSegmentData.segment[0] = circumferenceSegmentData.segment[1] = coordinates;\n      this.rBush_.update(createOrUpdateFromCoordinate(coordinates), centerSegmentData);\n      this.rBush_.update(geometry.getExtent(), circumferenceSegmentData);\n    } else {\n      this.rBush_.update(boundingExtent(segmentData.segment), segmentData);\n    }\n  }\n  if (this.modified_) {\n    this.dispatchEvent(new ModifyEvent(ModifyEventType.MODIFYEND, this.features_, evt));\n    this.modified_ = false;\n  }\n  return false;\n}\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} and may modify the\n * geometry.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/Modify}\n */\nfunction handleEvent(mapBrowserEvent) {\n  if (!(mapBrowserEvent instanceof MapBrowserPointerEvent)) {\n    return true;\n  }\n  this.lastPointerEvent_ = mapBrowserEvent;\n\n  let handled;\n  if (!mapBrowserEvent.map.getView().getInteracting() &&\n      mapBrowserEvent.type == MapBrowserEventType.POINTERMOVE &&\n      !this.handlingDownUpSequence) {\n    this.handlePointerMove_(mapBrowserEvent);\n  }\n  if (this.vertexFeature_ && this.deleteCondition_(mapBrowserEvent)) {\n    if (mapBrowserEvent.type != MapBrowserEventType.SINGLECLICK || !this.ignoreNextSingleClick_) {\n      handled = this.removePoint();\n    } else {\n      handled = true;\n    }\n  }\n\n  if (mapBrowserEvent.type == MapBrowserEventType.SINGLECLICK) {\n    this.ignoreNextSingleClick_ = false;\n  }\n\n  return handlePointerEvent.call(this, mapBrowserEvent) && !handled;\n}\n\n\n/**\n * @param {module:ol/MapBrowserEvent} evt Event.\n * @private\n */\nModify.prototype.handlePointerMove_ = function(evt) {\n  this.lastPixel_ = evt.pixel;\n  this.handlePointerAtPixel_(evt.pixel, evt.map);\n};\n\n\n/**\n * @param {module:ol~Pixel} pixel Pixel\n * @param {module:ol/PluggableMap} map Map.\n * @private\n */\nModify.prototype.handlePointerAtPixel_ = function(pixel, map) {\n  const pixelCoordinate = map.getCoordinateFromPixel(pixel);\n  const sortByDistance = function(a, b) {\n    return pointDistanceToSegmentDataSquared(pixelCoordinate, a) -\n        pointDistanceToSegmentDataSquared(pixelCoordinate, b);\n  };\n\n  const box = buffer(createOrUpdateFromCoordinate(pixelCoordinate),\n    map.getView().getResolution() * this.pixelTolerance_);\n\n  const rBush = this.rBush_;\n  const nodes = rBush.getInExtent(box);\n  if (nodes.length > 0) {\n    nodes.sort(sortByDistance);\n    const node = nodes[0];\n    const closestSegment = node.segment;\n    let vertex = closestOnSegmentData(pixelCoordinate, node);\n    const vertexPixel = map.getPixelFromCoordinate(vertex);\n    let dist = coordinateDistance(pixel, vertexPixel);\n    if (dist <= this.pixelTolerance_) {\n      const vertexSegments = {};\n\n      if (node.geometry.getType() === GeometryType.CIRCLE &&\n      node.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n\n        this.snappedToVertex_ = true;\n        this.createOrUpdateVertexFeature_(vertex);\n      } else {\n        const pixel1 = map.getPixelFromCoordinate(closestSegment[0]);\n        const pixel2 = map.getPixelFromCoordinate(closestSegment[1]);\n        const squaredDist1 = squaredCoordinateDistance(vertexPixel, pixel1);\n        const squaredDist2 = squaredCoordinateDistance(vertexPixel, pixel2);\n        dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));\n        this.snappedToVertex_ = dist <= this.pixelTolerance_;\n        if (this.snappedToVertex_) {\n          vertex = squaredDist1 > squaredDist2 ? closestSegment[1] : closestSegment[0];\n        }\n        this.createOrUpdateVertexFeature_(vertex);\n        for (let i = 1, ii = nodes.length; i < ii; ++i) {\n          const segment = nodes[i].segment;\n          if ((coordinatesEqual(closestSegment[0], segment[0]) &&\n              coordinatesEqual(closestSegment[1], segment[1]) ||\n              (coordinatesEqual(closestSegment[0], segment[1]) &&\n              coordinatesEqual(closestSegment[1], segment[0])))) {\n            vertexSegments[getUid(segment)] = true;\n          } else {\n            break;\n          }\n        }\n      }\n\n      vertexSegments[getUid(closestSegment)] = true;\n      this.vertexSegments_ = vertexSegments;\n      return;\n    }\n  }\n  if (this.vertexFeature_) {\n    this.overlay_.getSource().removeFeature(this.vertexFeature_);\n    this.vertexFeature_ = null;\n  }\n};\n\n\n/**\n * Returns the distance from a point to a line segment.\n *\n * @param {module:ol/coordinate~Coordinate} pointCoordinates The coordinates of the point from\n *        which to calculate the distance.\n * @param {module:ol/interaction/Modify~SegmentData} segmentData The object describing the line\n *        segment we are calculating the distance to.\n * @return {number} The square of the distance between a point and a line segment.\n */\nfunction pointDistanceToSegmentDataSquared(pointCoordinates, segmentData) {\n  const geometry = segmentData.geometry;\n\n  if (geometry.getType() === GeometryType.CIRCLE) {\n    const circleGeometry = /** @type {module:ol/geom/Circle} */ (geometry);\n\n    if (segmentData.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n      const distanceToCenterSquared =\n            squaredCoordinateDistance(circleGeometry.getCenter(), pointCoordinates);\n      const distanceToCircumference =\n            Math.sqrt(distanceToCenterSquared) - circleGeometry.getRadius();\n      return distanceToCircumference * distanceToCircumference;\n    }\n  }\n  return squaredDistanceToSegment(pointCoordinates, segmentData.segment);\n}\n\n/**\n * Returns the point closest to a given line segment.\n *\n * @param {module:ol/coordinate~Coordinate} pointCoordinates The point to which a closest point\n *        should be found.\n * @param {module:ol/interaction/Modify~SegmentData} segmentData The object describing the line\n *        segment which should contain the closest point.\n * @return {module:ol/coordinate~Coordinate} The point closest to the specified line segment.\n */\nfunction closestOnSegmentData(pointCoordinates, segmentData) {\n  const geometry = segmentData.geometry;\n\n  if (geometry.getType() === GeometryType.CIRCLE &&\n  segmentData.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n    return geometry.getClosestPoint(pointCoordinates);\n  }\n  return closestOnSegment(pointCoordinates, segmentData.segment);\n}\n\n\n/**\n * @param {module:ol/interaction/Modify~SegmentData} segmentData Segment data.\n * @param {module:ol/coordinate~Coordinate} vertex Vertex.\n * @private\n */\nModify.prototype.insertVertex_ = function(segmentData, vertex) {\n  const segment = segmentData.segment;\n  const feature = segmentData.feature;\n  const geometry = segmentData.geometry;\n  const depth = segmentData.depth;\n  const index = /** @type {number} */ (segmentData.index);\n  let coordinates;\n\n  while (vertex.length < geometry.getStride()) {\n    vertex.push(0);\n  }\n\n  switch (geometry.getType()) {\n    case GeometryType.MULTI_LINE_STRING:\n      coordinates = geometry.getCoordinates();\n      coordinates[depth[0]].splice(index + 1, 0, vertex);\n      break;\n    case GeometryType.POLYGON:\n      coordinates = geometry.getCoordinates();\n      coordinates[depth[0]].splice(index + 1, 0, vertex);\n      break;\n    case GeometryType.MULTI_POLYGON:\n      coordinates = geometry.getCoordinates();\n      coordinates[depth[1]][depth[0]].splice(index + 1, 0, vertex);\n      break;\n    case GeometryType.LINE_STRING:\n      coordinates = geometry.getCoordinates();\n      coordinates.splice(index + 1, 0, vertex);\n      break;\n    default:\n      return;\n  }\n\n  this.setGeometryCoordinates_(geometry, coordinates);\n  const rTree = this.rBush_;\n  rTree.remove(segmentData);\n  this.updateSegmentIndices_(geometry, index, depth, 1);\n  const newSegmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n    segment: [segment[0], vertex],\n    feature: feature,\n    geometry: geometry,\n    depth: depth,\n    index: index\n  });\n  rTree.insert(boundingExtent(newSegmentData.segment),\n    newSegmentData);\n  this.dragSegments_.push([newSegmentData, 1]);\n\n  const newSegmentData2 = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n    segment: [vertex, segment[1]],\n    feature: feature,\n    geometry: geometry,\n    depth: depth,\n    index: index + 1\n  });\n  rTree.insert(boundingExtent(newSegmentData2.segment), newSegmentData2);\n  this.dragSegments_.push([newSegmentData2, 0]);\n  this.ignoreNextSingleClick_ = true;\n};\n\n/**\n * Removes the vertex currently being pointed.\n * @return {boolean} True when a vertex was removed.\n * @api\n */\nModify.prototype.removePoint = function() {\n  if (this.lastPointerEvent_ && this.lastPointerEvent_.type != MapBrowserEventType.POINTERDRAG) {\n    const evt = this.lastPointerEvent_;\n    this.willModifyFeatures_(evt);\n    this.removeVertex_();\n    this.dispatchEvent(new ModifyEvent(ModifyEventType.MODIFYEND, this.features_, evt));\n    this.modified_ = false;\n    return true;\n  }\n  return false;\n};\n\n/**\n * Removes a vertex from all matching features.\n * @return {boolean} True when a vertex was removed.\n * @private\n */\nModify.prototype.removeVertex_ = function() {\n  const dragSegments = this.dragSegments_;\n  const segmentsByFeature = {};\n  let deleted = false;\n  let component, coordinates, dragSegment, geometry, i, index, left;\n  let newIndex, right, segmentData, uid;\n  for (i = dragSegments.length - 1; i >= 0; --i) {\n    dragSegment = dragSegments[i];\n    segmentData = dragSegment[0];\n    uid = getUid(segmentData.feature);\n    if (segmentData.depth) {\n      // separate feature components\n      uid += '-' + segmentData.depth.join('-');\n    }\n    if (!(uid in segmentsByFeature)) {\n      segmentsByFeature[uid] = {};\n    }\n    if (dragSegment[1] === 0) {\n      segmentsByFeature[uid].right = segmentData;\n      segmentsByFeature[uid].index = segmentData.index;\n    } else if (dragSegment[1] == 1) {\n      segmentsByFeature[uid].left = segmentData;\n      segmentsByFeature[uid].index = segmentData.index + 1;\n    }\n\n  }\n  for (uid in segmentsByFeature) {\n    right = segmentsByFeature[uid].right;\n    left = segmentsByFeature[uid].left;\n    index = segmentsByFeature[uid].index;\n    newIndex = index - 1;\n    if (left !== undefined) {\n      segmentData = left;\n    } else {\n      segmentData = right;\n    }\n    if (newIndex < 0) {\n      newIndex = 0;\n    }\n    geometry = segmentData.geometry;\n    coordinates = geometry.getCoordinates();\n    component = coordinates;\n    deleted = false;\n    switch (geometry.getType()) {\n      case GeometryType.MULTI_LINE_STRING:\n        if (coordinates[segmentData.depth[0]].length > 2) {\n          coordinates[segmentData.depth[0]].splice(index, 1);\n          deleted = true;\n        }\n        break;\n      case GeometryType.LINE_STRING:\n        if (coordinates.length > 2) {\n          coordinates.splice(index, 1);\n          deleted = true;\n        }\n        break;\n      case GeometryType.MULTI_POLYGON:\n        component = component[segmentData.depth[1]];\n        /* falls through */\n      case GeometryType.POLYGON:\n        component = component[segmentData.depth[0]];\n        if (component.length > 4) {\n          if (index == component.length - 1) {\n            index = 0;\n          }\n          component.splice(index, 1);\n          deleted = true;\n          if (index === 0) {\n            // close the ring again\n            component.pop();\n            component.push(component[0]);\n            newIndex = component.length - 1;\n          }\n        }\n        break;\n      default:\n        // pass\n    }\n\n    if (deleted) {\n      this.setGeometryCoordinates_(geometry, coordinates);\n      const segments = [];\n      if (left !== undefined) {\n        this.rBush_.remove(left);\n        segments.push(left.segment[0]);\n      }\n      if (right !== undefined) {\n        this.rBush_.remove(right);\n        segments.push(right.segment[1]);\n      }\n      if (left !== undefined && right !== undefined) {\n        const newSegmentData = /** @type {module:ol/interaction/Modify~SegmentData} */ ({\n          depth: segmentData.depth,\n          feature: segmentData.feature,\n          geometry: segmentData.geometry,\n          index: newIndex,\n          segment: segments\n        });\n        this.rBush_.insert(boundingExtent(newSegmentData.segment),\n          newSegmentData);\n      }\n      this.updateSegmentIndices_(geometry, index, segmentData.depth, -1);\n      if (this.vertexFeature_) {\n        this.overlay_.getSource().removeFeature(this.vertexFeature_);\n        this.vertexFeature_ = null;\n      }\n      dragSegments.length = 0;\n    }\n\n  }\n  return deleted;\n};\n\n\n/**\n * @param {module:ol/geom/SimpleGeometry} geometry Geometry.\n * @param {Array} coordinates Coordinates.\n * @private\n */\nModify.prototype.setGeometryCoordinates_ = function(geometry, coordinates) {\n  this.changingFeature_ = true;\n  geometry.setCoordinates(coordinates);\n  this.changingFeature_ = false;\n};\n\n\n/**\n * @param {module:ol/geom/SimpleGeometry} geometry Geometry.\n * @param {number} index Index.\n * @param {Array.<number>|undefined} depth Depth.\n * @param {number} delta Delta (1 or -1).\n * @private\n */\nModify.prototype.updateSegmentIndices_ = function(\n  geometry, index, depth, delta) {\n  this.rBush_.forEachInExtent(geometry.getExtent(), function(segmentDataMatch) {\n    if (segmentDataMatch.geometry === geometry &&\n        (depth === undefined || segmentDataMatch.depth === undefined ||\n        equals(segmentDataMatch.depth, depth)) &&\n        segmentDataMatch.index > index) {\n      segmentDataMatch.index += delta;\n    }\n  });\n};\n\n\n/**\n * @return {module:ol/style/Style~StyleFunction} Styles.\n */\nfunction getDefaultStyleFunction() {\n  const style = createEditingStyle();\n  return function(feature, resolution) {\n    return style[GeometryType.POINT];\n  };\n}\n\n\nexport default Modify;\n","/**\n * @module ol/interaction/Select\n */\nimport {getUid, inherits} from '../util.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport {extend, includes} from '../array.js';\nimport {listen} from '../events.js';\nimport Event from '../events/Event.js';\nimport {singleClick, never, shiftKeyOnly, pointerMove} from '../events/condition.js';\nimport {TRUE} from '../functions.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport Interaction from '../interaction/Interaction.js';\nimport VectorLayer from '../layer/Vector.js';\nimport {clear} from '../obj.js';\nimport VectorSource from '../source/Vector.js';\nimport {createEditingStyle} from '../style/Style.js';\n\n\n/**\n * @enum {string}\n */\nconst SelectEventType = {\n  /**\n   * Triggered when feature(s) has been (de)selected.\n   * @event SelectEvent#select\n   * @api\n   */\n  SELECT: 'select'\n};\n\n\n/**\n * A function that takes an {@link module:ol/Feature} or\n * {@link module:ol/render/Feature} and an\n * {@link module:ol/layer/Layer} and returns `true` if the feature may be\n * selected or `false` otherwise.\n * @typedef {function((module:ol/Feature|module:ol/render/Feature), module:ol/layer/Layer):\n *     boolean} FilterFunction\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/events/condition~Condition} [addCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * By default, this is {@link module:ol/events/condition~never}. Use this if you\n * want to use different events for add and remove instead of `toggle`.\n * @property {module:ol/events/condition~Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. This is the event\n * for the selected features as a whole. By default, this is\n * {@link module:ol/events/condition~singleClick}. Clicking on a feature selects that\n * feature and removes any that were in the selection. Clicking outside any\n * feature removes all from the selection.\n * See `toggle`, `add`, `remove` options for adding/removing extra features to/\n * from the selection.\n * @property {Array.<module:ol/layer/Layer>|function(module:ol/layer/Layer): boolean} [layers]\n * A list of layers from which features should be selected. Alternatively, a\n * filter function can be provided. The function will be called for each layer\n * in the map and should return `true` for layers that you want to be\n * selectable. If the option is absent, all visible layers will be considered\n * selectable.\n * @property {module:ol/style/Style|Array.<module:ol/style/Style>|module:ol/style/Style~StyleFunction} [style]\n * Style for the selected features. By default the default edit style is used\n * (see {@link module:ol/style}).\n * @property {module:ol/events/condition~Condition} [removeCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * By default, this is {@link module:ol/events/condition~never}. Use this if you\n * want to use different events for add and remove instead of `toggle`.\n * @property {module:ol/events/condition~Condition} [toggleCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. This is in addition\n * to the `condition` event. By default,\n * {@link module:ol/events/condition~shiftKeyOnly}, i.e. pressing `shift` as\n * well as the `condition` event, adds that feature to the current selection if\n * it is not currently selected, and removes it if it is. See `add` and `remove`\n * if you want to use different events instead of a toggle.\n * @property {boolean} [multi=false] A boolean that determines if the default\n * behaviour should select only single features or all (overlapping) features at\n * the clicked map position. The default of `false` means single select.\n * @property {module:ol/Collection.<module:ol/Feature>} [features]\n * Collection where the interaction will place selected features. Optional. If\n * not set the interaction will create a collection. In any case the collection\n * used by the interaction is returned by\n * {@link module:ol/interaction/Select~Select#getFeatures}.\n * @property {module:ol/interaction/Select~FilterFunction} [filter] A function\n * that takes an {@link module:ol/Feature} and an\n * {@link module:ol/layer/Layer} and returns `true` if the feature may be\n * selected or `false` otherwise.\n * @property {boolean} [wrapX=true] Wrap the world horizontally on the selection\n * overlay.\n * @property {number} [hitTolerance=0] Hit-detection tolerance. Pixels inside\n * the radius around the given position will be checked for features. This only\n * works for the canvas renderer and not for WebGL.\n */\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Select~Select} instances are instances of\n * this type.\n *\n * @param {SelectEventType} type The event type.\n * @param {Array.<module:ol/Feature>} selected Selected features.\n * @param {Array.<module:ol/Feature>} deselected Deselected features.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Associated\n *     {@link module:ol/MapBrowserEvent}.\n * @extends {module:ol/events/Event}\n * @constructor\n */\nconst SelectEvent = function(type, selected, deselected, mapBrowserEvent) {\n  Event.call(this, type);\n\n  /**\n   * Selected features array.\n   * @type {Array.<module:ol/Feature>}\n   * @api\n   */\n  this.selected = selected;\n\n  /**\n   * Deselected features array.\n   * @type {Array.<module:ol/Feature>}\n   * @api\n   */\n  this.deselected = deselected;\n\n  /**\n   * Associated {@link module:ol/MapBrowserEvent}.\n   * @type {module:ol/MapBrowserEvent}\n   * @api\n   */\n  this.mapBrowserEvent = mapBrowserEvent;\n};\n\ninherits(SelectEvent, Event);\n\n\n/**\n * @classdesc\n * Interaction for selecting vector features. By default, selected features are\n * styled differently, so this interaction can be used for visual highlighting,\n * as well as selecting features for other actions, such as modification or\n * output. There are three ways of controlling which features are selected:\n * using the browser event as defined by the `condition` and optionally the\n * `toggle`, `add`/`remove`, and `multi` options; a `layers` filter; and a\n * further feature filter using the `filter` option.\n *\n * Selected features are added to an internal unmanaged layer.\n *\n * @constructor\n * @extends {module:ol/interaction/Interaction}\n * @param {module:ol/interaction/Select~Options=} opt_options Options.\n * @fires SelectEvent\n * @api\n */\nconst Select = function(opt_options) {\n\n  Interaction.call(this, {\n    handleEvent: handleEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.condition_ = options.condition ? options.condition : singleClick;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.addCondition_ = options.addCondition ? options.addCondition : never;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.removeCondition_ = options.removeCondition ? options.removeCondition : never;\n\n  /**\n   * @private\n   * @type {module:ol/events/condition~Condition}\n   */\n  this.toggleCondition_ = options.toggleCondition ? options.toggleCondition : shiftKeyOnly;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.multi_ = options.multi ? options.multi : false;\n\n  /**\n   * @private\n   * @type {module:ol/interaction/Select~FilterFunction}\n   */\n  this.filter_ = options.filter ? options.filter : TRUE;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.hitTolerance_ = options.hitTolerance ? options.hitTolerance : 0;\n\n  const featureOverlay = new VectorLayer({\n    source: new VectorSource({\n      useSpatialIndex: false,\n      features: options.features,\n      wrapX: options.wrapX\n    }),\n    style: options.style ? options.style :\n      getDefaultStyleFunction(),\n    updateWhileAnimating: true,\n    updateWhileInteracting: true\n  });\n\n  /**\n   * @private\n   * @type {module:ol/layer/Vector}\n   */\n  this.featureOverlay_ = featureOverlay;\n\n  /** @type {function(module:ol/layer/Layer): boolean} */\n  let layerFilter;\n  if (options.layers) {\n    if (typeof options.layers === 'function') {\n      layerFilter = options.layers;\n    } else {\n      const layers = options.layers;\n      layerFilter = function(layer) {\n        return includes(layers, layer);\n      };\n    }\n  } else {\n    layerFilter = TRUE;\n  }\n\n  /**\n   * @private\n   * @type {function(module:ol/layer/Layer): boolean}\n   */\n  this.layerFilter_ = layerFilter;\n\n  /**\n   * An association between selected feature (key)\n   * and layer (value)\n   * @private\n   * @type {Object.<number, module:ol/layer/Layer>}\n   */\n  this.featureLayerAssociation_ = {};\n\n  const features = this.featureOverlay_.getSource().getFeaturesCollection();\n  listen(features, CollectionEventType.ADD,\n    this.addFeature_, this);\n  listen(features, CollectionEventType.REMOVE,\n    this.removeFeature_, this);\n\n};\n\ninherits(Select, Interaction);\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {module:ol/layer/Layer} layer Layer.\n * @private\n */\nSelect.prototype.addFeatureLayerAssociation_ = function(feature, layer) {\n  const key = getUid(feature);\n  this.featureLayerAssociation_[key] = layer;\n};\n\n\n/**\n * Get the selected features.\n * @return {module:ol/Collection.<module:ol/Feature>} Features collection.\n * @api\n */\nSelect.prototype.getFeatures = function() {\n  return this.featureOverlay_.getSource().getFeaturesCollection();\n};\n\n\n/**\n * Returns the Hit-detection tolerance.\n * @returns {number} Hit tolerance in pixels.\n * @api\n */\nSelect.prototype.getHitTolerance = function() {\n  return this.hitTolerance_;\n};\n\n\n/**\n * Returns the associated {@link module:ol/layer/Vector~Vector vectorlayer} of\n * the (last) selected feature. Note that this will not work with any\n * programmatic method like pushing features to\n * {@link module:ol/interaction/Select~Select#getFeatures collection}.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature\n * @return {module:ol/layer/Vector} Layer.\n * @api\n */\nSelect.prototype.getLayer = function(feature) {\n  const key = getUid(feature);\n  return (\n    /** @type {module:ol/layer/Vector} */ (this.featureLayerAssociation_[key])\n  );\n};\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} and may change the\n * selected state of features.\n * @param {module:ol/MapBrowserEvent} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {module:ol/interaction/Select}\n */\nfunction handleEvent(mapBrowserEvent) {\n  if (!this.condition_(mapBrowserEvent)) {\n    return true;\n  }\n  const add = this.addCondition_(mapBrowserEvent);\n  const remove = this.removeCondition_(mapBrowserEvent);\n  const toggle = this.toggleCondition_(mapBrowserEvent);\n  const set = !add && !remove && !toggle;\n  const map = mapBrowserEvent.map;\n  const features = this.featureOverlay_.getSource().getFeaturesCollection();\n  const deselected = [];\n  const selected = [];\n  if (set) {\n    // Replace the currently selected feature(s) with the feature(s) at the\n    // pixel, or clear the selected feature(s) if there is no feature at\n    // the pixel.\n    clear(this.featureLayerAssociation_);\n    map.forEachFeatureAtPixel(mapBrowserEvent.pixel,\n      (\n        /**\n         * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n         * @param {module:ol/layer/Layer} layer Layer.\n         * @return {boolean|undefined} Continue to iterate over the features.\n         */\n        function(feature, layer) {\n          if (this.filter_(feature, layer)) {\n            selected.push(feature);\n            this.addFeatureLayerAssociation_(feature, layer);\n            return !this.multi_;\n          }\n        }).bind(this), {\n        layerFilter: this.layerFilter_,\n        hitTolerance: this.hitTolerance_\n      });\n    for (let i = features.getLength() - 1; i >= 0; --i) {\n      const feature = features.item(i);\n      const index = selected.indexOf(feature);\n      if (index > -1) {\n        // feature is already selected\n        selected.splice(index, 1);\n      } else {\n        features.remove(feature);\n        deselected.push(feature);\n      }\n    }\n    if (selected.length !== 0) {\n      features.extend(selected);\n    }\n  } else {\n    // Modify the currently selected feature(s).\n    map.forEachFeatureAtPixel(mapBrowserEvent.pixel,\n      (\n        /**\n         * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n         * @param {module:ol/layer/Layer} layer Layer.\n         * @return {boolean|undefined} Continue to iterate over the features.\n         */\n        function(feature, layer) {\n          if (this.filter_(feature, layer)) {\n            if ((add || toggle) && !includes(features.getArray(), feature)) {\n              selected.push(feature);\n              this.addFeatureLayerAssociation_(feature, layer);\n            } else if ((remove || toggle) && includes(features.getArray(), feature)) {\n              deselected.push(feature);\n              this.removeFeatureLayerAssociation_(feature);\n            }\n            return !this.multi_;\n          }\n        }).bind(this), {\n        layerFilter: this.layerFilter_,\n        hitTolerance: this.hitTolerance_\n      });\n    for (let j = deselected.length - 1; j >= 0; --j) {\n      features.remove(deselected[j]);\n    }\n    features.extend(selected);\n  }\n  if (selected.length > 0 || deselected.length > 0) {\n    this.dispatchEvent(\n      new SelectEvent(SelectEventType.SELECT,\n        selected, deselected, mapBrowserEvent));\n  }\n  return pointerMove(mapBrowserEvent);\n}\n\n\n/**\n * Hit-detection tolerance. Pixels inside the radius around the given position\n * will be checked for features. This only works for the canvas renderer and\n * not for WebGL.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @api\n */\nSelect.prototype.setHitTolerance = function(hitTolerance) {\n  this.hitTolerance_ = hitTolerance;\n};\n\n\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {module:ol/PluggableMap} map Map.\n * @override\n * @api\n */\nSelect.prototype.setMap = function(map) {\n  const currentMap = this.getMap();\n  const selectedFeatures =\n      this.featureOverlay_.getSource().getFeaturesCollection();\n  if (currentMap) {\n    selectedFeatures.forEach(currentMap.unskipFeature.bind(currentMap));\n  }\n  Interaction.prototype.setMap.call(this, map);\n  this.featureOverlay_.setMap(map);\n  if (map) {\n    selectedFeatures.forEach(map.skipFeature.bind(map));\n  }\n};\n\n\n/**\n * @return {module:ol/style/Style~StyleFunction} Styles.\n */\nfunction getDefaultStyleFunction() {\n  const styles = createEditingStyle();\n  extend(styles[GeometryType.POLYGON], styles[GeometryType.LINE_STRING]);\n  extend(styles[GeometryType.GEOMETRY_COLLECTION], styles[GeometryType.LINE_STRING]);\n\n  return function(feature, resolution) {\n    if (!feature.getGeometry()) {\n      return null;\n    }\n    return styles[feature.getGeometry().getType()];\n  };\n}\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nSelect.prototype.addFeature_ = function(evt) {\n  const map = this.getMap();\n  if (map) {\n    map.skipFeature(/** @type {module:ol/Feature} */ (evt.element));\n  }\n};\n\n\n/**\n * @param {module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nSelect.prototype.removeFeature_ = function(evt) {\n  const map = this.getMap();\n  if (map) {\n    map.unskipFeature(/** @type {module:ol/Feature} */ (evt.element));\n  }\n};\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @private\n */\nSelect.prototype.removeFeatureLayerAssociation_ = function(feature) {\n  const key = getUid(feature);\n  delete this.featureLayerAssociation_[key];\n};\n\n\nexport default Select;\n","/**\n * @module ol/interaction/Snap\n */\nimport {getUid, inherits} from '../util.js';\nimport {CollectionEvent} from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport {distance as coordinateDistance, squaredDistance as squaredCoordinateDistance, closestOnCircle, closestOnSegment, squaredDistanceToSegment} from '../coordinate.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {boundingExtent, createEmpty} from '../extent.js';\nimport {TRUE, FALSE} from '../functions.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport {fromCircle} from '../geom/Polygon.js';\nimport PointerInteraction, {handleEvent as handlePointerEvent} from '../interaction/Pointer.js';\nimport {getValues} from '../obj.js';\nimport {VectorSourceEvent} from '../source/Vector.js';\nimport VectorEventType from '../source/VectorEventType.js';\nimport RBush from '../structs/RBush.js';\n\n\n/**\n * @typedef {Object} Result\n * @property {boolean} snapped\n * @property {module:ol/coordinate~Coordinate|null} vertex\n * @property {module:ol~Pixel|null} vertexPixel\n */\n\n\n/**\n * @typedef {Object} SegmentData\n * @property {module:ol/Feature} feature\n * @property {Array.<module:ol/coordinate~Coordinate>} segment\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/Collection.<module:ol/Feature>} [features] Snap to these features. Either this option or source should be provided.\n * @property {boolean} [edge=true] Snap to edges.\n * @property {boolean} [vertex=true] Snap to vertices.\n * @property {number} [pixelTolerance=10] Pixel tolerance for considering the pointer close enough to a segment or\n * vertex for snapping.\n * @property {module:ol/source/Vector} [source] Snap to features from this source. Either this option or features should be provided\n */\n\n\n/**\n * @classdesc\n * Handles snapping of vector features while modifying or drawing them.  The\n * features can come from a {@link module:ol/source/Vector} or {@link module:ol/Collection~Collection}\n * Any interaction object that allows the user to interact\n * with the features using the mouse can benefit from the snapping, as long\n * as it is added before.\n *\n * The snap interaction modifies map browser event `coordinate` and `pixel`\n * properties to force the snap to occur to any interaction that them.\n *\n * Example:\n *\n *     import Snap from 'ol/interaction/Snap';\n *\n *     var snap = new Snap({\n *       source: source\n *     });\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @param {module:ol/interaction/Snap~Options=} opt_options Options.\n * @api\n */\nconst Snap = function(opt_options) {\n\n  PointerInteraction.call(this, {\n    handleEvent: handleEvent,\n    handleDownEvent: TRUE,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @type {module:ol/source/Vector}\n   * @private\n   */\n  this.source_ = options.source ? options.source : null;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.vertex_ = options.vertex !== undefined ? options.vertex : true;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.edge_ = options.edge !== undefined ? options.edge : true;\n\n  /**\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @private\n   */\n  this.features_ = options.features ? options.features : null;\n\n  /**\n   * @type {Array.<module:ol/events~EventsKey>}\n   * @private\n   */\n  this.featuresListenerKeys_ = [];\n\n  /**\n   * @type {Object.<number, module:ol/events~EventsKey>}\n   * @private\n   */\n  this.featureChangeListenerKeys_ = {};\n\n  /**\n   * Extents are preserved so indexed segment can be quickly removed\n   * when its feature geometry changes\n   * @type {Object.<number, module:ol/extent~Extent>}\n   * @private\n   */\n  this.indexedFeaturesExtents_ = {};\n\n  /**\n   * If a feature geometry changes while a pointer drag|move event occurs, the\n   * feature doesn't get updated right away.  It will be at the next 'pointerup'\n   * event fired.\n   * @type {!Object.<number, module:ol/Feature>}\n   * @private\n   */\n  this.pendingFeatures_ = {};\n\n  /**\n   * Used for distance sorting in sortByDistance_\n   * @type {module:ol/coordinate~Coordinate}\n   * @private\n   */\n  this.pixelCoordinate_ = null;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.pixelTolerance_ = options.pixelTolerance !== undefined ?\n    options.pixelTolerance : 10;\n\n  /**\n   * @type {function(module:ol/interaction/Snap~SegmentData, module:ol/interaction/Snap~SegmentData): number}\n   * @private\n   */\n  this.sortByDistance_ = sortByDistance.bind(this);\n\n\n  /**\n  * Segment RTree for each layer\n  * @type {module:ol/structs/RBush.<module:ol/interaction/Snap~SegmentData>}\n  * @private\n  */\n  this.rBush_ = new RBush();\n\n\n  /**\n  * @const\n  * @private\n  * @type {Object.<string, function(module:ol/Feature, module:ol/geom/Geometry)>}\n  */\n  this.SEGMENT_WRITERS_ = {\n    'Point': this.writePointGeometry_,\n    'LineString': this.writeLineStringGeometry_,\n    'LinearRing': this.writeLineStringGeometry_,\n    'Polygon': this.writePolygonGeometry_,\n    'MultiPoint': this.writeMultiPointGeometry_,\n    'MultiLineString': this.writeMultiLineStringGeometry_,\n    'MultiPolygon': this.writeMultiPolygonGeometry_,\n    'GeometryCollection': this.writeGeometryCollectionGeometry_,\n    'Circle': this.writeCircleGeometry_\n  };\n};\n\ninherits(Snap, PointerInteraction);\n\n\n/**\n * Add a feature to the collection of features that we may snap to.\n * @param {module:ol/Feature} feature Feature.\n * @param {boolean=} opt_listen Whether to listen to the feature change or not\n *     Defaults to `true`.\n * @api\n */\nSnap.prototype.addFeature = function(feature, opt_listen) {\n  const register = opt_listen !== undefined ? opt_listen : true;\n  const feature_uid = getUid(feature);\n  const geometry = feature.getGeometry();\n  if (geometry) {\n    const segmentWriter = this.SEGMENT_WRITERS_[geometry.getType()];\n    if (segmentWriter) {\n      this.indexedFeaturesExtents_[feature_uid] = geometry.getExtent(createEmpty());\n      segmentWriter.call(this, feature, geometry);\n    }\n  }\n\n  if (register) {\n    this.featureChangeListenerKeys_[feature_uid] = listen(\n      feature,\n      EventType.CHANGE,\n      this.handleFeatureChange_, this);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @private\n */\nSnap.prototype.forEachFeatureAdd_ = function(feature) {\n  this.addFeature(feature);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @private\n */\nSnap.prototype.forEachFeatureRemove_ = function(feature) {\n  this.removeFeature(feature);\n};\n\n\n/**\n * @return {module:ol/Collection.<module:ol/Feature>|Array.<module:ol/Feature>} Features.\n * @private\n */\nSnap.prototype.getFeatures_ = function() {\n  let features;\n  if (this.features_) {\n    features = this.features_;\n  } else if (this.source_) {\n    features = this.source_.getFeatures();\n  }\n  return (\n    /** @type {!Array.<module:ol/Feature>|!module:ol/Collection.<module:ol/Feature>} */ (features)\n  );\n};\n\n\n/**\n * @param {module:ol/source/Vector|module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nSnap.prototype.handleFeatureAdd_ = function(evt) {\n  let feature;\n  if (evt instanceof VectorSourceEvent) {\n    feature = evt.feature;\n  } else if (evt instanceof CollectionEvent) {\n    feature = evt.element;\n  }\n  this.addFeature(/** @type {module:ol/Feature} */ (feature));\n};\n\n\n/**\n * @param {module:ol/source/Vector|module:ol/Collection~CollectionEvent} evt Event.\n * @private\n */\nSnap.prototype.handleFeatureRemove_ = function(evt) {\n  let feature;\n  if (evt instanceof VectorSourceEvent) {\n    feature = evt.feature;\n  } else if (evt instanceof CollectionEvent) {\n    feature = evt.element;\n  }\n  this.removeFeature(/** @type {module:ol/Feature} */ (feature));\n};\n\n\n/**\n * @param {module:ol/events/Event} evt Event.\n * @private\n */\nSnap.prototype.handleFeatureChange_ = function(evt) {\n  const feature = /** @type {module:ol/Feature} */ (evt.target);\n  if (this.handlingDownUpSequence) {\n    const uid = getUid(feature);\n    if (!(uid in this.pendingFeatures_)) {\n      this.pendingFeatures_[uid] = feature;\n    }\n  } else {\n    this.updateFeature_(feature);\n  }\n};\n\n\n/**\n * Remove a feature from the collection of features that we may snap to.\n * @param {module:ol/Feature} feature Feature\n * @param {boolean=} opt_unlisten Whether to unlisten to the feature change\n *     or not. Defaults to `true`.\n * @api\n */\nSnap.prototype.removeFeature = function(feature, opt_unlisten) {\n  const unregister = opt_unlisten !== undefined ? opt_unlisten : true;\n  const feature_uid = getUid(feature);\n  const extent = this.indexedFeaturesExtents_[feature_uid];\n  if (extent) {\n    const rBush = this.rBush_;\n    const nodesToRemove = [];\n    rBush.forEachInExtent(extent, function(node) {\n      if (feature === node.feature) {\n        nodesToRemove.push(node);\n      }\n    });\n    for (let i = nodesToRemove.length - 1; i >= 0; --i) {\n      rBush.remove(nodesToRemove[i]);\n    }\n  }\n\n  if (unregister) {\n    unlistenByKey(this.featureChangeListenerKeys_[feature_uid]);\n    delete this.featureChangeListenerKeys_[feature_uid];\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nSnap.prototype.setMap = function(map) {\n  const currentMap = this.getMap();\n  const keys = this.featuresListenerKeys_;\n  const features = this.getFeatures_();\n\n  if (currentMap) {\n    keys.forEach(unlistenByKey);\n    keys.length = 0;\n    features.forEach(this.forEachFeatureRemove_.bind(this));\n  }\n  PointerInteraction.prototype.setMap.call(this, map);\n\n  if (map) {\n    if (this.features_) {\n      keys.push(\n        listen(this.features_, CollectionEventType.ADD,\n          this.handleFeatureAdd_, this),\n        listen(this.features_, CollectionEventType.REMOVE,\n          this.handleFeatureRemove_, this)\n      );\n    } else if (this.source_) {\n      keys.push(\n        listen(this.source_, VectorEventType.ADDFEATURE,\n          this.handleFeatureAdd_, this),\n        listen(this.source_, VectorEventType.REMOVEFEATURE,\n          this.handleFeatureRemove_, this)\n      );\n    }\n    features.forEach(this.forEachFeatureAdd_.bind(this));\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nSnap.prototype.shouldStopEvent = FALSE;\n\n\n/**\n * @param {module:ol~Pixel} pixel Pixel\n * @param {module:ol/coordinate~Coordinate} pixelCoordinate Coordinate\n * @param {module:ol/PluggableMap} map Map.\n * @return {module:ol/interaction/Snap~Result} Snap result\n */\nSnap.prototype.snapTo = function(pixel, pixelCoordinate, map) {\n\n  const lowerLeft = map.getCoordinateFromPixel(\n    [pixel[0] - this.pixelTolerance_, pixel[1] + this.pixelTolerance_]);\n  const upperRight = map.getCoordinateFromPixel(\n    [pixel[0] + this.pixelTolerance_, pixel[1] - this.pixelTolerance_]);\n  const box = boundingExtent([lowerLeft, upperRight]);\n\n  let segments = this.rBush_.getInExtent(box);\n\n  // If snapping on vertices only, don't consider circles\n  if (this.vertex_ && !this.edge_) {\n    segments = segments.filter(function(segment) {\n      return segment.feature.getGeometry().getType() !==\n          GeometryType.CIRCLE;\n    });\n  }\n\n  let snappedToVertex = false;\n  let snapped = false;\n  let vertex = null;\n  let vertexPixel = null;\n  let dist, pixel1, pixel2, squaredDist1, squaredDist2;\n  if (segments.length > 0) {\n    this.pixelCoordinate_ = pixelCoordinate;\n    segments.sort(this.sortByDistance_);\n    const closestSegment = segments[0].segment;\n    const isCircle = segments[0].feature.getGeometry().getType() ===\n        GeometryType.CIRCLE;\n    if (this.vertex_ && !this.edge_) {\n      pixel1 = map.getPixelFromCoordinate(closestSegment[0]);\n      pixel2 = map.getPixelFromCoordinate(closestSegment[1]);\n      squaredDist1 = squaredCoordinateDistance(pixel, pixel1);\n      squaredDist2 = squaredCoordinateDistance(pixel, pixel2);\n      dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));\n      snappedToVertex = dist <= this.pixelTolerance_;\n      if (snappedToVertex) {\n        snapped = true;\n        vertex = squaredDist1 > squaredDist2 ? closestSegment[1] : closestSegment[0];\n        vertexPixel = map.getPixelFromCoordinate(vertex);\n      }\n    } else if (this.edge_) {\n      if (isCircle) {\n        vertex = closestOnCircle(pixelCoordinate,\n          /** @type {module:ol/geom/Circle} */ (segments[0].feature.getGeometry()));\n      } else {\n        vertex = closestOnSegment(pixelCoordinate, closestSegment);\n      }\n      vertexPixel = map.getPixelFromCoordinate(vertex);\n      if (coordinateDistance(pixel, vertexPixel) <= this.pixelTolerance_) {\n        snapped = true;\n        if (this.vertex_ && !isCircle) {\n          pixel1 = map.getPixelFromCoordinate(closestSegment[0]);\n          pixel2 = map.getPixelFromCoordinate(closestSegment[1]);\n          squaredDist1 = squaredCoordinateDistance(vertexPixel, pixel1);\n          squaredDist2 = squaredCoordinateDistance(vertexPixel, pixel2);\n          dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));\n          snappedToVertex = dist <= this.pixelTolerance_;\n          if (snappedToVertex) {\n            vertex = squaredDist1 > squaredDist2 ? closestSegment[1] : closestSegment[0];\n            vertexPixel = map.getPixelFromCoordinate(vertex);\n          }\n        }\n      }\n    }\n    if (snapped) {\n      vertexPixel = [Math.round(vertexPixel[0]), Math.round(vertexPixel[1])];\n    }\n  }\n  return (\n    /** @type {module:ol/interaction/Snap~Result} */ ({\n      snapped: snapped,\n      vertex: vertex,\n      vertexPixel: vertexPixel\n    })\n  );\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @private\n */\nSnap.prototype.updateFeature_ = function(feature) {\n  this.removeFeature(feature, false);\n  this.addFeature(feature, false);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/Circle} geometry Geometry.\n * @private\n */\nSnap.prototype.writeCircleGeometry_ = function(feature, geometry) {\n  const polygon = fromCircle(geometry);\n  const coordinates = polygon.getCoordinates()[0];\n  for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n    const segment = coordinates.slice(i, i + 2);\n    const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n      feature: feature,\n      segment: segment\n    });\n    this.rBush_.insert(boundingExtent(segment), segmentData);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/GeometryCollection} geometry Geometry.\n * @private\n */\nSnap.prototype.writeGeometryCollectionGeometry_ = function(feature, geometry) {\n  const geometries = geometry.getGeometriesArray();\n  for (let i = 0; i < geometries.length; ++i) {\n    const segmentWriter = this.SEGMENT_WRITERS_[geometries[i].getType()];\n    if (segmentWriter) {\n      segmentWriter.call(this, feature, geometries[i]);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/LineString} geometry Geometry.\n * @private\n */\nSnap.prototype.writeLineStringGeometry_ = function(feature, geometry) {\n  const coordinates = geometry.getCoordinates();\n  for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n    const segment = coordinates.slice(i, i + 2);\n    const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n      feature: feature,\n      segment: segment\n    });\n    this.rBush_.insert(boundingExtent(segment), segmentData);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiLineString} geometry Geometry.\n * @private\n */\nSnap.prototype.writeMultiLineStringGeometry_ = function(feature, geometry) {\n  const lines = geometry.getCoordinates();\n  for (let j = 0, jj = lines.length; j < jj; ++j) {\n    const coordinates = lines[j];\n    for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n      const segment = coordinates.slice(i, i + 2);\n      const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n        feature: feature,\n        segment: segment\n      });\n      this.rBush_.insert(boundingExtent(segment), segmentData);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiPoint} geometry Geometry.\n * @private\n */\nSnap.prototype.writeMultiPointGeometry_ = function(feature, geometry) {\n  const points = geometry.getCoordinates();\n  for (let i = 0, ii = points.length; i < ii; ++i) {\n    const coordinates = points[i];\n    const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n      feature: feature,\n      segment: [coordinates, coordinates]\n    });\n    this.rBush_.insert(geometry.getExtent(), segmentData);\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/MultiPolygon} geometry Geometry.\n * @private\n */\nSnap.prototype.writeMultiPolygonGeometry_ = function(feature, geometry) {\n  const polygons = geometry.getCoordinates();\n  for (let k = 0, kk = polygons.length; k < kk; ++k) {\n    const rings = polygons[k];\n    for (let j = 0, jj = rings.length; j < jj; ++j) {\n      const coordinates = rings[j];\n      for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n        const segment = coordinates.slice(i, i + 2);\n        const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n          feature: feature,\n          segment: segment\n        });\n        this.rBush_.insert(boundingExtent(segment), segmentData);\n      }\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/Point} geometry Geometry.\n * @private\n */\nSnap.prototype.writePointGeometry_ = function(feature, geometry) {\n  const coordinates = geometry.getCoordinates();\n  const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n    feature: feature,\n    segment: [coordinates, coordinates]\n  });\n  this.rBush_.insert(geometry.getExtent(), segmentData);\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature\n * @param {module:ol/geom/Polygon} geometry Geometry.\n * @private\n */\nSnap.prototype.writePolygonGeometry_ = function(feature, geometry) {\n  const rings = geometry.getCoordinates();\n  for (let j = 0, jj = rings.length; j < jj; ++j) {\n    const coordinates = rings[j];\n    for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n      const segment = coordinates.slice(i, i + 2);\n      const segmentData = /** @type {module:ol/interaction/Snap~SegmentData} */ ({\n        feature: feature,\n        segment: segment\n      });\n      this.rBush_.insert(boundingExtent(segment), segmentData);\n    }\n  }\n};\n\n\n/**\n * Handle all pointer events events.\n * @param {module:ol/MapBrowserEvent} evt A move event.\n * @return {boolean} Pass the event to other interactions.\n * @this {module:ol/interaction/Snap}\n */\nexport function handleEvent(evt) {\n  const result = this.snapTo(evt.pixel, evt.coordinate, evt.map);\n  if (result.snapped) {\n    evt.coordinate = result.vertex.slice(0, 2);\n    evt.pixel = result.vertexPixel;\n  }\n  return handlePointerEvent.call(this, evt);\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} evt Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/Snap}\n */\nfunction handleUpEvent(evt) {\n  const featuresToUpdate = getValues(this.pendingFeatures_);\n  if (featuresToUpdate.length) {\n    featuresToUpdate.forEach(this.updateFeature_.bind(this));\n    this.pendingFeatures_ = {};\n  }\n  return false;\n}\n\n\n/**\n * Sort segments by distance, helper function\n * @param {module:ol/interaction/Snap~SegmentData} a The first segment data.\n * @param {module:ol/interaction/Snap~SegmentData} b The second segment data.\n * @return {number} The difference in distance.\n * @this {module:ol/interaction/Snap}\n */\nfunction sortByDistance(a, b) {\n  const deltaA = squaredDistanceToSegment(this.pixelCoordinate_, a.segment);\n  const deltaB = squaredDistanceToSegment(this.pixelCoordinate_, b.segment);\n  return deltaA - deltaB;\n}\n\nexport default Snap;\n","/**\n * @module ol/interaction/Translate\n */\nimport {inherits} from '../util.js';\nimport Collection from '../Collection.js';\nimport {getChangeEventType} from '../Object.js';\nimport {listen} from '../events.js';\nimport Event from '../events/Event.js';\nimport {TRUE} from '../functions.js';\nimport {includes} from '../array.js';\nimport PointerInteraction from '../interaction/Pointer.js';\nimport InteractionProperty from '../interaction/Property.js';\n\n\n/**\n * @enum {string}\n */\nconst TranslateEventType = {\n  /**\n   * Triggered upon feature translation start.\n   * @event TranslateEvent#translatestart\n   * @api\n   */\n  TRANSLATESTART: 'translatestart',\n  /**\n   * Triggered upon feature translation.\n   * @event TranslateEvent#translating\n   * @api\n   */\n  TRANSLATING: 'translating',\n  /**\n   * Triggered upon feature translation end.\n   * @event TranslateEvent#translateend\n   * @api\n   */\n  TRANSLATEEND: 'translateend'\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/Collection.<module:ol/Feature>} [features] Only features contained in this collection will be able to be translated. If\n * not specified, all features on the map will be able to be translated.\n * @property {Array.<module:ol/layer/Layer>|function(module:ol/layer/Layer): boolean} [layers] A list of layers from which features should be\n * translated. Alternatively, a filter function can be provided. The\n * function will be called for each layer in the map and should return\n * `true` for layers that you want to be translatable. If the option is\n * absent, all visible layers will be considered translatable.\n * @property {number} [hitTolerance=0] Hit-detection tolerance. Pixels inside the radius around the given position\n * will be checked for features. This only works for the canvas renderer and\n * not for WebGL.\n */\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Translate~Translate} instances\n * are instances of this type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {module:ol/interaction/Translate~TranslateEventType} type Type.\n * @param {module:ol/Collection.<module:ol/Feature>} features The features translated.\n * @param {module:ol/coordinate~Coordinate} coordinate The event coordinate.\n */\nexport const TranslateEvent = function(type, features, coordinate) {\n\n  Event.call(this, type);\n\n  /**\n   * The features being translated.\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @api\n   */\n  this.features = features;\n\n  /**\n   * The coordinate of the drag event.\n   * @const\n   * @type {module:ol/coordinate~Coordinate}\n   * @api\n   */\n  this.coordinate = coordinate;\n};\n\ninherits(TranslateEvent, Event);\n\n\n/**\n * @classdesc\n * Interaction for translating (moving) features.\n *\n * @constructor\n * @extends {module:ol/interaction/Pointer}\n * @fires module:ol/interaction/Translate~TranslateEvent\n * @param {module:ol/interaction/Translate~Options=} opt_options Options.\n * @api\n */\nconst Translate = function(opt_options) {\n  PointerInteraction.call(this, {\n    handleDownEvent: handleDownEvent,\n    handleDragEvent: handleDragEvent,\n    handleMoveEvent: handleMoveEvent,\n    handleUpEvent: handleUpEvent\n  });\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * The last position we translated to.\n   * @type {module:ol/coordinate~Coordinate}\n   * @private\n   */\n  this.lastCoordinate_ = null;\n\n\n  /**\n   * @type {module:ol/Collection.<module:ol/Feature>}\n   * @private\n   */\n  this.features_ = options.features !== undefined ? options.features : null;\n\n  /** @type {function(module:ol/layer/Layer): boolean} */\n  let layerFilter;\n  if (options.layers) {\n    if (typeof options.layers === 'function') {\n      layerFilter = options.layers;\n    } else {\n      const layers = options.layers;\n      layerFilter = function(layer) {\n        return includes(layers, layer);\n      };\n    }\n  } else {\n    layerFilter = TRUE;\n  }\n\n  /**\n   * @private\n   * @type {function(module:ol/layer/Layer): boolean}\n   */\n  this.layerFilter_ = layerFilter;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.hitTolerance_ = options.hitTolerance ? options.hitTolerance : 0;\n\n  /**\n   * @type {module:ol/Feature}\n   * @private\n   */\n  this.lastFeature_ = null;\n\n  listen(this,\n    getChangeEventType(InteractionProperty.ACTIVE),\n    this.handleActiveChanged_, this);\n\n};\n\ninherits(Translate, PointerInteraction);\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} event Event.\n * @return {boolean} Start drag sequence?\n * @this {module:ol/interaction/Translate}\n */\nfunction handleDownEvent(event) {\n  this.lastFeature_ = this.featuresAtPixel_(event.pixel, event.map);\n  if (!this.lastCoordinate_ && this.lastFeature_) {\n    this.lastCoordinate_ = event.coordinate;\n    handleMoveEvent.call(this, event);\n\n    const features = this.features_ || new Collection([this.lastFeature_]);\n\n    this.dispatchEvent(\n      new TranslateEvent(\n        TranslateEventType.TRANSLATESTART, features,\n        event.coordinate));\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} event Event.\n * @return {boolean} Stop drag sequence?\n * @this {module:ol/interaction/Translate}\n */\nfunction handleUpEvent(event) {\n  if (this.lastCoordinate_) {\n    this.lastCoordinate_ = null;\n    handleMoveEvent.call(this, event);\n\n    const features = this.features_ || new Collection([this.lastFeature_]);\n\n    this.dispatchEvent(\n      new TranslateEvent(\n        TranslateEventType.TRANSLATEEND, features,\n        event.coordinate));\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {module:ol/MapBrowserPointerEvent} event Event.\n * @this {module:ol/interaction/Translate}\n */\nfunction handleDragEvent(event) {\n  if (this.lastCoordinate_) {\n    const newCoordinate = event.coordinate;\n    const deltaX = newCoordinate[0] - this.lastCoordinate_[0];\n    const deltaY = newCoordinate[1] - this.lastCoordinate_[1];\n\n    const features = this.features_ || new Collection([this.lastFeature_]);\n\n    features.forEach(function(feature) {\n      const geom = feature.getGeometry();\n      geom.translate(deltaX, deltaY);\n      feature.setGeometry(geom);\n    });\n\n    this.lastCoordinate_ = newCoordinate;\n    this.dispatchEvent(\n      new TranslateEvent(\n        TranslateEventType.TRANSLATING, features,\n        newCoordinate));\n  }\n}\n\n\n/**\n * @param {module:ol/MapBrowserEvent} event Event.\n * @this {module:ol/interaction/Translate}\n */\nfunction handleMoveEvent(event) {\n  const elem = event.map.getViewport();\n\n  // Change the cursor to grab/grabbing if hovering any of the features managed\n  // by the interaction\n  if (this.featuresAtPixel_(event.pixel, event.map)) {\n    elem.classList.remove(this.lastCoordinate_ ? 'ol-grab' : 'ol-grabbing');\n    elem.classList.add(this.lastCoordinate_ ? 'ol-grabbing' : 'ol-grab');\n  } else {\n    elem.classList.remove('ol-grab', 'ol-grabbing');\n  }\n}\n\n\n/**\n * Tests to see if the given coordinates intersects any of our selected\n * features.\n * @param {module:ol~Pixel} pixel Pixel coordinate to test for intersection.\n * @param {module:ol/PluggableMap} map Map to test the intersection on.\n * @return {module:ol/Feature} Returns the feature found at the specified pixel\n * coordinates.\n * @private\n */\nTranslate.prototype.featuresAtPixel_ = function(pixel, map) {\n  return map.forEachFeatureAtPixel(pixel,\n    function(feature) {\n      if (!this.features_ || includes(this.features_.getArray(), feature)) {\n        return feature;\n      }\n    }.bind(this), {\n      layerFilter: this.layerFilter_,\n      hitTolerance: this.hitTolerance_\n    });\n};\n\n\n/**\n * Returns the Hit-detection tolerance.\n * @returns {number} Hit tolerance in pixels.\n * @api\n */\nTranslate.prototype.getHitTolerance = function() {\n  return this.hitTolerance_;\n};\n\n\n/**\n * Hit-detection tolerance. Pixels inside the radius around the given position\n * will be checked for features. This only works for the canvas renderer and\n * not for WebGL.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @api\n */\nTranslate.prototype.setHitTolerance = function(hitTolerance) {\n  this.hitTolerance_ = hitTolerance;\n};\n\n\n/**\n * @inheritDoc\n */\nTranslate.prototype.setMap = function(map) {\n  const oldMap = this.getMap();\n  PointerInteraction.prototype.setMap.call(this, map);\n  this.updateState_(oldMap);\n};\n\n\n/**\n * @private\n */\nTranslate.prototype.handleActiveChanged_ = function() {\n  this.updateState_(null);\n};\n\n\n/**\n * @param {module:ol/PluggableMap} oldMap Old map.\n * @private\n */\nTranslate.prototype.updateState_ = function(oldMap) {\n  let map = this.getMap();\n  const active = this.getActive();\n  if (!map || !active) {\n    map = map || oldMap;\n    if (map) {\n      const elem = map.getViewport();\n      elem.classList.remove('ol-grab', 'ol-grabbing');\n    }\n  }\n};\n\n\nexport default Translate;\n","/**\n * @module ol/interaction\n */\nimport Collection from './Collection.js';\nimport Kinetic from './Kinetic.js';\nimport DoubleClickZoom from './interaction/DoubleClickZoom.js';\nimport DragPan from './interaction/DragPan.js';\nimport DragRotate from './interaction/DragRotate.js';\nimport DragZoom from './interaction/DragZoom.js';\nimport KeyboardPan from './interaction/KeyboardPan.js';\nimport KeyboardZoom from './interaction/KeyboardZoom.js';\nimport MouseWheelZoom from './interaction/MouseWheelZoom.js';\nimport PinchRotate from './interaction/PinchRotate.js';\nimport PinchZoom from './interaction/PinchZoom.js';\n\nexport {default as DoubleClickZoom} from './interaction/DoubleClickZoom.js';\nexport {default as DragAndDrop} from './interaction/DragAndDrop.js';\nexport {default as DragBox} from './interaction/DragBox.js';\nexport {default as DragPan} from './interaction/DragPan.js';\nexport {default as DragRotate} from './interaction/DragRotate.js';\nexport {default as DragRotateAndZoom} from './interaction/DragRotateAndZoom.js';\nexport {default as DragZoom} from './interaction/DragZoom.js';\nexport {default as Draw} from './interaction/Draw.js';\nexport {default as Extent} from './interaction/Extent.js';\nexport {default as Interaction} from './interaction/Interaction.js';\nexport {default as KeyboardPan} from './interaction/KeyboardPan.js';\nexport {default as KeyboardZoom} from './interaction/KeyboardZoom.js';\nexport {default as Modify} from './interaction/Modify.js';\nexport {default as MouseWheelZoom} from './interaction/MouseWheelZoom.js';\nexport {default as PinchRotate} from './interaction/PinchRotate.js';\nexport {default as PinchZoom} from './interaction/PinchZoom.js';\nexport {default as Pointer} from './interaction/Pointer.js';\nexport {default as Select} from './interaction/Select.js';\nexport {default as Snap} from './interaction/Snap.js';\nexport {default as Translate} from './interaction/Translate.js';\n\n\n/**\n * @typedef {Object} DefaultsOptions\n * @property {boolean} [altShiftDragRotate=true] Whether Alt-Shift-drag rotate is\n * desired.\n * @property {boolean} [constrainResolution=false] Zoom to the closest integer\n * zoom level after the wheel/trackpad or pinch gesture ends.\n * @property {boolean} [doubleClickZoom=true] Whether double click zoom is\n * desired.\n * @property {boolean} [keyboard=true] Whether keyboard interaction is desired.\n * @property {boolean} [mouseWheelZoom=true] Whether mousewheel zoom is desired.\n * @property {boolean} [shiftDragZoom=true] Whether Shift-drag zoom is desired.\n * @property {boolean} [dragPan=true] Whether drag pan is desired.\n * @property {boolean} [pinchRotate=true] Whether pinch rotate is desired.\n * @property {boolean} [pinchZoom=true] Whether pinch zoom is desired.\n * @property {number} [zoomDelta] Zoom level delta when using keyboard or\n * mousewheel zoom.\n * @property {number} [zoomDuration] Duration of the zoom animation in\n * milliseconds.\n */\n\n\n/**\n * Set of interactions included in maps by default. Specific interactions can be\n * excluded by setting the appropriate option to false in the constructor\n * options, but the order of the interactions is fixed.  If you want to specify\n * a different order for interactions, you will need to create your own\n * {@link module:ol/interaction/Interaction} instances and insert\n * them into a {@link module:ol/Collection} in the order you want\n * before creating your {@link module:ol/Map~Map} instance. The default set of\n * interactions, in sequence, is:\n * * {@link module:ol/interaction/DragRotate~DragRotate}\n * * {@link module:ol/interaction/DoubleClickZoom~DoubleClickZoom}\n * * {@link module:ol/interaction/DragPan~DragPan}\n * * {@link module:ol/interaction/PinchRotate~PinchRotate}\n * * {@link module:ol/interaction/PinchZoom~PinchZoom}\n * * {@link module:ol/interaction/KeyboardPan~KeyboardPan}\n * * {@link module:ol/interaction/KeyboardZoom~KeyboardZoom}\n * * {@link module:ol/interaction/MouseWheelZoom~MouseWheelZoom}\n * * {@link module:ol/interaction/DragZoom~DragZoom}\n *\n * @param {module:ol/interaction/Interaction~DefaultsOptions=} opt_options\n * Defaults options.\n * @return {module:ol/Collection.<module:ol/interaction/Interaction>}\n * A collection of interactions to be used with the {@link module:ol/Map~Map}\n * constructor's `interactions` option.\n * @api\n */\nexport function defaults(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const interactions = new Collection();\n\n  const kinetic = new Kinetic(-0.005, 0.05, 100);\n\n  const altShiftDragRotate = options.altShiftDragRotate !== undefined ?\n    options.altShiftDragRotate : true;\n  if (altShiftDragRotate) {\n    interactions.push(new DragRotate());\n  }\n\n  const doubleClickZoom = options.doubleClickZoom !== undefined ?\n    options.doubleClickZoom : true;\n  if (doubleClickZoom) {\n    interactions.push(new DoubleClickZoom({\n      delta: options.zoomDelta,\n      duration: options.zoomDuration\n    }));\n  }\n\n  const dragPan = options.dragPan !== undefined ? options.dragPan : true;\n  if (dragPan) {\n    interactions.push(new DragPan({\n      kinetic: kinetic\n    }));\n  }\n\n  const pinchRotate = options.pinchRotate !== undefined ? options.pinchRotate :\n    true;\n  if (pinchRotate) {\n    interactions.push(new PinchRotate());\n  }\n\n  const pinchZoom = options.pinchZoom !== undefined ? options.pinchZoom : true;\n  if (pinchZoom) {\n    interactions.push(new PinchZoom({\n      constrainResolution: options.constrainResolution,\n      duration: options.zoomDuration\n    }));\n  }\n\n  const keyboard = options.keyboard !== undefined ? options.keyboard : true;\n  if (keyboard) {\n    interactions.push(new KeyboardPan());\n    interactions.push(new KeyboardZoom({\n      delta: options.zoomDelta,\n      duration: options.zoomDuration\n    }));\n  }\n\n  const mouseWheelZoom = options.mouseWheelZoom !== undefined ?\n    options.mouseWheelZoom : true;\n  if (mouseWheelZoom) {\n    interactions.push(new MouseWheelZoom({\n      constrainResolution: options.constrainResolution,\n      duration: options.zoomDuration\n    }));\n  }\n\n  const shiftDragZoom = options.shiftDragZoom !== undefined ?\n    options.shiftDragZoom : true;\n  if (shiftDragZoom) {\n    interactions.push(new DragZoom({\n      duration: options.zoomDuration\n    }));\n  }\n\n  return interactions;\n\n}\n","/**\n * Default maximum allowed threshold  (in pixels) for reprojection\n * triangulation.\n * @type {number}\n */\nexport const ERROR_THRESHOLD = 0.5;\n\n/**\n * Enable automatic reprojection of raster sources. Default is `true`.\n * TODO: decide if we want to expose this as a build flag or remove it\n * @type {boolean}\n */\nexport const ENABLE_RASTER_REPROJECTION = true;\n","/**\n * @module ol/render/Event\n */\nimport {inherits} from '../util.js';\nimport Event from '../events/Event.js';\n\n/**\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {module:ol/render/EventType} type Type.\n * @param {module:ol/render/VectorContext=} opt_vectorContext Vector context.\n * @param {module:ol/PluggableMap~FrameState=} opt_frameState Frame state.\n * @param {?CanvasRenderingContext2D=} opt_context Context.\n * @param {?module:ol/webgl/Context=} opt_glContext WebGL Context.\n */\nconst RenderEvent = function(\n  type, opt_vectorContext, opt_frameState, opt_context,\n  opt_glContext) {\n\n  Event.call(this, type);\n\n  /**\n   * For canvas, this is an instance of {@link module:ol/render/canvas/Immediate}.\n   * @type {module:ol/render/VectorContext|undefined}\n   * @api\n   */\n  this.vectorContext = opt_vectorContext;\n\n  /**\n   * An object representing the current render frame state.\n   * @type {module:ol/PluggableMap~FrameState|undefined}\n   * @api\n   */\n  this.frameState = opt_frameState;\n\n  /**\n   * Canvas context. Only available when a Canvas renderer is used, null\n   * otherwise.\n   * @type {CanvasRenderingContext2D|null|undefined}\n   * @api\n   */\n  this.context = opt_context;\n\n  /**\n   * WebGL context. Only available when a WebGL renderer is used, null\n   * otherwise.\n   * @type {module:ol/webgl/Context|null|undefined}\n   * @api\n   */\n  this.glContext = opt_glContext;\n\n};\n\ninherits(RenderEvent, Event);\nexport default RenderEvent;\n","/**\n * @module ol/render/VectorContext\n */\n/**\n * Context for drawing geometries.  A vector context is available on render\n * events and does not need to be constructed directly.\n * @constructor\n * @abstract\n * @struct\n * @api\n */\nconst VectorContext = function() {\n};\n\n\n/**\n * Render a geometry with a custom renderer.\n *\n * @param {module:ol/geom/SimpleGeometry} geometry Geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {Function} renderer Renderer.\n */\nVectorContext.prototype.drawCustom = function(geometry, feature, renderer) {};\n\n\n/**\n * Render a geometry.\n *\n * @param {module:ol/geom/Geometry} geometry The geometry to render.\n */\nVectorContext.prototype.drawGeometry = function(geometry) {};\n\n\n/**\n * Set the rendering style.\n *\n * @param {module:ol/style/Style} style The rendering style.\n */\nVectorContext.prototype.setStyle = function(style) {};\n\n\n/**\n * @param {module:ol/geom/Circle} circleGeometry Circle geometry.\n * @param {module:ol/Feature} feature Feature.\n */\nVectorContext.prototype.drawCircle = function(circleGeometry, feature) {};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/style/Style} style Style.\n */\nVectorContext.prototype.drawFeature = function(feature, style) {};\n\n\n/**\n * @param {module:ol/geom/GeometryCollection} geometryCollectionGeometry Geometry\n *     collection.\n * @param {module:ol/Feature} feature Feature.\n */\nVectorContext.prototype.drawGeometryCollection = function(geometryCollectionGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/LineString|module:ol/render/Feature} lineStringGeometry Line string geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawLineString = function(lineStringGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/MultiLineString|module:ol/render/Feature} multiLineStringGeometry MultiLineString geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawMultiLineString = function(multiLineStringGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/MultiPoint|module:ol/render/Feature} multiPointGeometry MultiPoint geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawMultiPoint = function(multiPointGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/MultiPolygon} multiPolygonGeometry MultiPolygon geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawMultiPolygon = function(multiPolygonGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/Point|module:ol/render/Feature} pointGeometry Point geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawPoint = function(pointGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/Polygon|module:ol/render/Feature} polygonGeometry Polygon geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawPolygon = function(polygonGeometry, feature) {};\n\n\n/**\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nVectorContext.prototype.drawText = function(geometry, feature) {};\n\n\n/**\n * @param {module:ol/style/Fill} fillStyle Fill style.\n * @param {module:ol/style/Stroke} strokeStyle Stroke style.\n */\nVectorContext.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {};\n\n\n/**\n * @param {module:ol/style/Image} imageStyle Image style.\n * @param {module:ol/render/canvas~DeclutterGroup=} opt_declutterGroup Declutter.\n */\nVectorContext.prototype.setImageStyle = function(imageStyle, opt_declutterGroup) {};\n\n\n/**\n * @param {module:ol/style/Text} textStyle Text style.\n * @param {module:ol/render/canvas~DeclutterGroup=} opt_declutterGroup Declutter.\n */\nVectorContext.prototype.setTextStyle = function(textStyle, opt_declutterGroup) {};\nexport default VectorContext;\n","/**\n * @module ol/render/canvas/Immediate\n */\n// FIXME test, especially polygons with holes and multipolygons\n// FIXME need to handle large thick features (where pixel size matters)\n// FIXME add offset and end to ol/geom/flat/transform~transform2D?\n\nimport {inherits} from '../../util.js';\nimport {equals} from '../../array.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {intersects} from '../../extent.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {transformGeom2D} from '../../geom/SimpleGeometry.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {CANVAS_LINE_DASH} from '../../has.js';\nimport VectorContext from '../VectorContext.js';\nimport {defaultTextAlign, defaultFillStyle, defaultLineCap, defaultLineDash, defaultLineDashOffset, defaultLineJoin, defaultLineWidth, defaultMiterLimit, defaultStrokeStyle, defaultTextBaseline, defaultFont} from '../canvas.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @classdesc\n * A concrete subclass of {@link module:ol/render/VectorContext} that implements\n * direct rendering of features and geometries to an HTML5 Canvas context.\n * Instances of this class are created internally by the library and\n * provided to application code as vectorContext member of the\n * {@link module:ol/render/Event~RenderEvent} object associated with postcompose, precompose and\n * render events emitted by layers and maps.\n *\n * @constructor\n * @extends {module:ol/render/VectorContext}\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {number} viewRotation View rotation.\n * @struct\n */\nconst CanvasImmediateRenderer = function(context, pixelRatio, extent, transform, viewRotation) {\n  VectorContext.call(this);\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context_ = context;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelRatio_ = pixelRatio;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent_ = extent;\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.transform_ = transform;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.viewRotation_ = viewRotation;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~FillState}\n   */\n  this.contextFillState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~StrokeState}\n   */\n  this.contextStrokeState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~TextState}\n   */\n  this.contextTextState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~FillState}\n   */\n  this.fillState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~StrokeState}\n   */\n  this.strokeState_ = null;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement|HTMLVideoElement|Image}\n   */\n  this.image_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageAnchorX_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageAnchorY_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageHeight_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageOpacity_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageOriginX_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageOriginY_ = 0;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.imageRotateWithView_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageRotation_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageScale_ = 0;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.imageSnapToPixel_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.imageWidth_ = 0;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.text_ = '';\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textOffsetX_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textOffsetY_ = 0;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.textRotateWithView_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textRotation_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textScale_ = 0;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~FillState}\n   */\n  this.textFillState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~StrokeState}\n   */\n  this.textStrokeState_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~TextState}\n   */\n  this.textState_ = null;\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.pixelCoordinates_ = [];\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.tmpLocalTransform_ = createTransform();\n\n};\n\ninherits(CanvasImmediateRenderer, VectorContext);\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @private\n */\nCanvasImmediateRenderer.prototype.drawImages_ = function(flatCoordinates, offset, end, stride) {\n  if (!this.image_) {\n    return;\n  }\n  const pixelCoordinates = transform2D(\n    flatCoordinates, offset, end, 2, this.transform_,\n    this.pixelCoordinates_);\n  const context = this.context_;\n  const localTransform = this.tmpLocalTransform_;\n  const alpha = context.globalAlpha;\n  if (this.imageOpacity_ != 1) {\n    context.globalAlpha = alpha * this.imageOpacity_;\n  }\n  let rotation = this.imageRotation_;\n  if (this.imageRotateWithView_) {\n    rotation += this.viewRotation_;\n  }\n  for (let i = 0, ii = pixelCoordinates.length; i < ii; i += 2) {\n    let x = pixelCoordinates[i] - this.imageAnchorX_;\n    let y = pixelCoordinates[i + 1] - this.imageAnchorY_;\n    if (this.imageSnapToPixel_) {\n      x = Math.round(x);\n      y = Math.round(y);\n    }\n    if (rotation !== 0 || this.imageScale_ != 1) {\n      const centerX = x + this.imageAnchorX_;\n      const centerY = y + this.imageAnchorY_;\n      composeTransform(localTransform,\n        centerX, centerY,\n        this.imageScale_, this.imageScale_,\n        rotation,\n        -centerX, -centerY);\n      context.setTransform.apply(context, localTransform);\n    }\n    context.drawImage(this.image_, this.imageOriginX_, this.imageOriginY_,\n      this.imageWidth_, this.imageHeight_, x, y,\n      this.imageWidth_, this.imageHeight_);\n  }\n  if (rotation !== 0 || this.imageScale_ != 1) {\n    context.setTransform(1, 0, 0, 1, 0, 0);\n  }\n  if (this.imageOpacity_ != 1) {\n    context.globalAlpha = alpha;\n  }\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @private\n */\nCanvasImmediateRenderer.prototype.drawText_ = function(flatCoordinates, offset, end, stride) {\n  if (!this.textState_ || this.text_ === '') {\n    return;\n  }\n  if (this.textFillState_) {\n    this.setContextFillState_(this.textFillState_);\n  }\n  if (this.textStrokeState_) {\n    this.setContextStrokeState_(this.textStrokeState_);\n  }\n  this.setContextTextState_(this.textState_);\n  const pixelCoordinates = transform2D(\n    flatCoordinates, offset, end, stride, this.transform_,\n    this.pixelCoordinates_);\n  const context = this.context_;\n  let rotation = this.textRotation_;\n  if (this.textRotateWithView_) {\n    rotation += this.viewRotation_;\n  }\n  for (; offset < end; offset += stride) {\n    const x = pixelCoordinates[offset] + this.textOffsetX_;\n    const y = pixelCoordinates[offset + 1] + this.textOffsetY_;\n    if (rotation !== 0 || this.textScale_ != 1) {\n      const localTransform = composeTransform(this.tmpLocalTransform_,\n        x, y,\n        this.textScale_, this.textScale_,\n        rotation,\n        -x, -y);\n      context.setTransform.apply(context, localTransform);\n    }\n    if (this.textStrokeState_) {\n      context.strokeText(this.text_, x, y);\n    }\n    if (this.textFillState_) {\n      context.fillText(this.text_, x, y);\n    }\n  }\n  if (rotation !== 0 || this.textScale_ != 1) {\n    context.setTransform(1, 0, 0, 1, 0, 0);\n  }\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {boolean} close Close.\n * @private\n * @return {number} end End.\n */\nCanvasImmediateRenderer.prototype.moveToLineTo_ = function(flatCoordinates, offset, end, stride, close) {\n  const context = this.context_;\n  const pixelCoordinates = transform2D(\n    flatCoordinates, offset, end, stride, this.transform_,\n    this.pixelCoordinates_);\n  context.moveTo(pixelCoordinates[0], pixelCoordinates[1]);\n  let length = pixelCoordinates.length;\n  if (close) {\n    length -= 2;\n  }\n  for (let i = 2; i < length; i += 2) {\n    context.lineTo(pixelCoordinates[i], pixelCoordinates[i + 1]);\n  }\n  if (close) {\n    context.closePath();\n  }\n  return end;\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @private\n * @return {number} End.\n */\nCanvasImmediateRenderer.prototype.drawRings_ = function(flatCoordinates, offset, ends, stride) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, true);\n  }\n  return offset;\n};\n\n\n/**\n * Render a circle geometry into the canvas.  Rendering is immediate and uses\n * the current fill and stroke styles.\n *\n * @param {module:ol/geom/Circle} geometry Circle geometry.\n * @override\n * @api\n */\nCanvasImmediateRenderer.prototype.drawCircle = function(geometry) {\n  if (!intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  if (this.fillState_ || this.strokeState_) {\n    if (this.fillState_) {\n      this.setContextFillState_(this.fillState_);\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n    }\n    const pixelCoordinates = transformGeom2D(\n      geometry, this.transform_, this.pixelCoordinates_);\n    const dx = pixelCoordinates[2] - pixelCoordinates[0];\n    const dy = pixelCoordinates[3] - pixelCoordinates[1];\n    const radius = Math.sqrt(dx * dx + dy * dy);\n    const context = this.context_;\n    context.beginPath();\n    context.arc(\n      pixelCoordinates[0], pixelCoordinates[1], radius, 0, 2 * Math.PI);\n    if (this.fillState_) {\n      context.fill();\n    }\n    if (this.strokeState_) {\n      context.stroke();\n    }\n  }\n  if (this.text_ !== '') {\n    this.drawText_(geometry.getCenter(), 0, 2, 2);\n  }\n};\n\n\n/**\n * Set the rendering style.  Note that since this is an immediate rendering API,\n * any `zIndex` on the provided style will be ignored.\n *\n * @param {module:ol/style/Style} style The rendering style.\n * @override\n * @api\n */\nCanvasImmediateRenderer.prototype.setStyle = function(style) {\n  this.setFillStrokeStyle(style.getFill(), style.getStroke());\n  this.setImageStyle(style.getImage());\n  this.setTextStyle(style.getText());\n};\n\n\n/**\n * Render a geometry into the canvas.  Call\n * {@link module:ol/render/canvas/Immediate#setStyle} first to set the rendering style.\n *\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry The geometry to render.\n * @override\n * @api\n */\nCanvasImmediateRenderer.prototype.drawGeometry = function(geometry) {\n  const type = geometry.getType();\n  switch (type) {\n    case GeometryType.POINT:\n      this.drawPoint(/** @type {module:ol/geom/Point} */ (geometry));\n      break;\n    case GeometryType.LINE_STRING:\n      this.drawLineString(/** @type {module:ol/geom/LineString} */ (geometry));\n      break;\n    case GeometryType.POLYGON:\n      this.drawPolygon(/** @type {module:ol/geom/Polygon} */ (geometry));\n      break;\n    case GeometryType.MULTI_POINT:\n      this.drawMultiPoint(/** @type {module:ol/geom/MultiPoint} */ (geometry));\n      break;\n    case GeometryType.MULTI_LINE_STRING:\n      this.drawMultiLineString(/** @type {module:ol/geom/MultiLineString} */ (geometry));\n      break;\n    case GeometryType.MULTI_POLYGON:\n      this.drawMultiPolygon(/** @type {module:ol/geom/MultiPolygon} */ (geometry));\n      break;\n    case GeometryType.GEOMETRY_COLLECTION:\n      this.drawGeometryCollection(/** @type {module:ol/geom/GeometryCollection} */ (geometry));\n      break;\n    case GeometryType.CIRCLE:\n      this.drawCircle(/** @type {module:ol/geom/Circle} */ (geometry));\n      break;\n    default:\n  }\n};\n\n\n/**\n * Render a feature into the canvas.  Note that any `zIndex` on the provided\n * style will be ignored - features are rendered immediately in the order that\n * this method is called.  If you need `zIndex` support, you should be using an\n * {@link module:ol/layer/Vector~VectorLayer} instead.\n *\n * @param {module:ol/Feature} feature Feature.\n * @param {module:ol/style/Style} style Style.\n * @override\n * @api\n */\nCanvasImmediateRenderer.prototype.drawFeature = function(feature, style) {\n  const geometry = style.getGeometryFunction()(feature);\n  if (!geometry || !intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  this.setStyle(style);\n  this.drawGeometry(geometry);\n};\n\n\n/**\n * Render a GeometryCollection to the canvas.  Rendering is immediate and\n * uses the current styles appropriate for each geometry in the collection.\n *\n * @param {module:ol/geom/GeometryCollection} geometry Geometry collection.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawGeometryCollection = function(geometry) {\n  const geometries = geometry.getGeometriesArray();\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    this.drawGeometry(geometries[i]);\n  }\n};\n\n\n/**\n * Render a Point geometry into the canvas.  Rendering is immediate and uses\n * the current style.\n *\n * @param {module:ol/geom/Point|module:ol/render/Feature} geometry Point geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawPoint = function(geometry) {\n  const flatCoordinates = geometry.getFlatCoordinates();\n  const stride = geometry.getStride();\n  if (this.image_) {\n    this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n  }\n  if (this.text_ !== '') {\n    this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n  }\n};\n\n\n/**\n * Render a MultiPoint geometry  into the canvas.  Rendering is immediate and\n * uses the current style.\n *\n * @param {module:ol/geom/MultiPoint|module:ol/render/Feature} geometry MultiPoint geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawMultiPoint = function(geometry) {\n  const flatCoordinates = geometry.getFlatCoordinates();\n  const stride = geometry.getStride();\n  if (this.image_) {\n    this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n  }\n  if (this.text_ !== '') {\n    this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n  }\n};\n\n\n/**\n * Render a LineString into the canvas.  Rendering is immediate and uses\n * the current style.\n *\n * @param {module:ol/geom/LineString|module:ol/render/Feature} geometry LineString geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawLineString = function(geometry) {\n  if (!intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  if (this.strokeState_) {\n    this.setContextStrokeState_(this.strokeState_);\n    const context = this.context_;\n    const flatCoordinates = geometry.getFlatCoordinates();\n    context.beginPath();\n    this.moveToLineTo_(flatCoordinates, 0, flatCoordinates.length,\n      geometry.getStride(), false);\n    context.stroke();\n  }\n  if (this.text_ !== '') {\n    const flatMidpoint = geometry.getFlatMidpoint();\n    this.drawText_(flatMidpoint, 0, 2, 2);\n  }\n};\n\n\n/**\n * Render a MultiLineString geometry into the canvas.  Rendering is immediate\n * and uses the current style.\n *\n * @param {module:ol/geom/MultiLineString|module:ol/render/Feature} geometry MultiLineString geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawMultiLineString = function(geometry) {\n  const geometryExtent = geometry.getExtent();\n  if (!intersects(this.extent_, geometryExtent)) {\n    return;\n  }\n  if (this.strokeState_) {\n    this.setContextStrokeState_(this.strokeState_);\n    const context = this.context_;\n    const flatCoordinates = geometry.getFlatCoordinates();\n    let offset = 0;\n    const ends = geometry.getEnds();\n    const stride = geometry.getStride();\n    context.beginPath();\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, false);\n    }\n    context.stroke();\n  }\n  if (this.text_ !== '') {\n    const flatMidpoints = geometry.getFlatMidpoints();\n    this.drawText_(flatMidpoints, 0, flatMidpoints.length, 2);\n  }\n};\n\n\n/**\n * Render a Polygon geometry into the canvas.  Rendering is immediate and uses\n * the current style.\n *\n * @param {module:ol/geom/Polygon|module:ol/render/Feature} geometry Polygon geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawPolygon = function(geometry) {\n  if (!intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  if (this.strokeState_ || this.fillState_) {\n    if (this.fillState_) {\n      this.setContextFillState_(this.fillState_);\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n    }\n    const context = this.context_;\n    context.beginPath();\n    this.drawRings_(geometry.getOrientedFlatCoordinates(),\n      0, geometry.getEnds(), geometry.getStride());\n    if (this.fillState_) {\n      context.fill();\n    }\n    if (this.strokeState_) {\n      context.stroke();\n    }\n  }\n  if (this.text_ !== '') {\n    const flatInteriorPoint = geometry.getFlatInteriorPoint();\n    this.drawText_(flatInteriorPoint, 0, 2, 2);\n  }\n};\n\n\n/**\n * Render MultiPolygon geometry into the canvas.  Rendering is immediate and\n * uses the current style.\n * @param {module:ol/geom/MultiPolygon} geometry MultiPolygon geometry.\n * @override\n */\nCanvasImmediateRenderer.prototype.drawMultiPolygon = function(geometry) {\n  if (!intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  if (this.strokeState_ || this.fillState_) {\n    if (this.fillState_) {\n      this.setContextFillState_(this.fillState_);\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n    }\n    const context = this.context_;\n    const flatCoordinates = geometry.getOrientedFlatCoordinates();\n    let offset = 0;\n    const endss = geometry.getEndss();\n    const stride = geometry.getStride();\n    context.beginPath();\n    for (let i = 0, ii = endss.length; i < ii; ++i) {\n      const ends = endss[i];\n      offset = this.drawRings_(flatCoordinates, offset, ends, stride);\n    }\n    if (this.fillState_) {\n      context.fill();\n    }\n    if (this.strokeState_) {\n      context.stroke();\n    }\n  }\n  if (this.text_ !== '') {\n    const flatInteriorPoints = geometry.getFlatInteriorPoints();\n    this.drawText_(flatInteriorPoints, 0, flatInteriorPoints.length, 2);\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillState} fillState Fill state.\n * @private\n */\nCanvasImmediateRenderer.prototype.setContextFillState_ = function(fillState) {\n  const context = this.context_;\n  const contextFillState = this.contextFillState_;\n  if (!contextFillState) {\n    context.fillStyle = fillState.fillStyle;\n    this.contextFillState_ = {\n      fillStyle: fillState.fillStyle\n    };\n  } else {\n    if (contextFillState.fillStyle != fillState.fillStyle) {\n      contextFillState.fillStyle = context.fillStyle = fillState.fillStyle;\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~StrokeState} strokeState Stroke state.\n * @private\n */\nCanvasImmediateRenderer.prototype.setContextStrokeState_ = function(strokeState) {\n  const context = this.context_;\n  const contextStrokeState = this.contextStrokeState_;\n  if (!contextStrokeState) {\n    context.lineCap = strokeState.lineCap;\n    if (CANVAS_LINE_DASH) {\n      context.setLineDash(strokeState.lineDash);\n      context.lineDashOffset = strokeState.lineDashOffset;\n    }\n    context.lineJoin = strokeState.lineJoin;\n    context.lineWidth = strokeState.lineWidth;\n    context.miterLimit = strokeState.miterLimit;\n    context.strokeStyle = strokeState.strokeStyle;\n    this.contextStrokeState_ = {\n      lineCap: strokeState.lineCap,\n      lineDash: strokeState.lineDash,\n      lineDashOffset: strokeState.lineDashOffset,\n      lineJoin: strokeState.lineJoin,\n      lineWidth: strokeState.lineWidth,\n      miterLimit: strokeState.miterLimit,\n      strokeStyle: strokeState.strokeStyle\n    };\n  } else {\n    if (contextStrokeState.lineCap != strokeState.lineCap) {\n      contextStrokeState.lineCap = context.lineCap = strokeState.lineCap;\n    }\n    if (CANVAS_LINE_DASH) {\n      if (!equals(contextStrokeState.lineDash, strokeState.lineDash)) {\n        context.setLineDash(contextStrokeState.lineDash = strokeState.lineDash);\n      }\n      if (contextStrokeState.lineDashOffset != strokeState.lineDashOffset) {\n        contextStrokeState.lineDashOffset = context.lineDashOffset =\n            strokeState.lineDashOffset;\n      }\n    }\n    if (contextStrokeState.lineJoin != strokeState.lineJoin) {\n      contextStrokeState.lineJoin = context.lineJoin = strokeState.lineJoin;\n    }\n    if (contextStrokeState.lineWidth != strokeState.lineWidth) {\n      contextStrokeState.lineWidth = context.lineWidth = strokeState.lineWidth;\n    }\n    if (contextStrokeState.miterLimit != strokeState.miterLimit) {\n      contextStrokeState.miterLimit = context.miterLimit =\n          strokeState.miterLimit;\n    }\n    if (contextStrokeState.strokeStyle != strokeState.strokeStyle) {\n      contextStrokeState.strokeStyle = context.strokeStyle =\n          strokeState.strokeStyle;\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~TextState} textState Text state.\n * @private\n */\nCanvasImmediateRenderer.prototype.setContextTextState_ = function(textState) {\n  const context = this.context_;\n  const contextTextState = this.contextTextState_;\n  const textAlign = textState.textAlign ?\n    textState.textAlign : defaultTextAlign;\n  if (!contextTextState) {\n    context.font = textState.font;\n    context.textAlign = textAlign;\n    context.textBaseline = textState.textBaseline;\n    this.contextTextState_ = {\n      font: textState.font,\n      textAlign: textAlign,\n      textBaseline: textState.textBaseline\n    };\n  } else {\n    if (contextTextState.font != textState.font) {\n      contextTextState.font = context.font = textState.font;\n    }\n    if (contextTextState.textAlign != textAlign) {\n      contextTextState.textAlign = context.textAlign = textAlign;\n    }\n    if (contextTextState.textBaseline != textState.textBaseline) {\n      contextTextState.textBaseline = context.textBaseline =\n          textState.textBaseline;\n    }\n  }\n};\n\n\n/**\n * Set the fill and stroke style for subsequent draw operations.  To clear\n * either fill or stroke styles, pass null for the appropriate parameter.\n *\n * @param {module:ol/style/Fill} fillStyle Fill style.\n * @param {module:ol/style/Stroke} strokeStyle Stroke style.\n * @override\n */\nCanvasImmediateRenderer.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {\n  if (!fillStyle) {\n    this.fillState_ = null;\n  } else {\n    const fillStyleColor = fillStyle.getColor();\n    this.fillState_ = {\n      fillStyle: asColorLike(fillStyleColor ?\n        fillStyleColor : defaultFillStyle)\n    };\n  }\n  if (!strokeStyle) {\n    this.strokeState_ = null;\n  } else {\n    const strokeStyleColor = strokeStyle.getColor();\n    const strokeStyleLineCap = strokeStyle.getLineCap();\n    const strokeStyleLineDash = strokeStyle.getLineDash();\n    const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n    const strokeStyleLineJoin = strokeStyle.getLineJoin();\n    const strokeStyleWidth = strokeStyle.getWidth();\n    const strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n    this.strokeState_ = {\n      lineCap: strokeStyleLineCap !== undefined ?\n        strokeStyleLineCap : defaultLineCap,\n      lineDash: strokeStyleLineDash ?\n        strokeStyleLineDash : defaultLineDash,\n      lineDashOffset: strokeStyleLineDashOffset ?\n        strokeStyleLineDashOffset : defaultLineDashOffset,\n      lineJoin: strokeStyleLineJoin !== undefined ?\n        strokeStyleLineJoin : defaultLineJoin,\n      lineWidth: this.pixelRatio_ * (strokeStyleWidth !== undefined ?\n        strokeStyleWidth : defaultLineWidth),\n      miterLimit: strokeStyleMiterLimit !== undefined ?\n        strokeStyleMiterLimit : defaultMiterLimit,\n      strokeStyle: asColorLike(strokeStyleColor ?\n        strokeStyleColor : defaultStrokeStyle)\n    };\n  }\n};\n\n\n/**\n * Set the image style for subsequent draw operations.  Pass null to remove\n * the image style.\n *\n * @param {module:ol/style/Image} imageStyle Image style.\n * @override\n */\nCanvasImmediateRenderer.prototype.setImageStyle = function(imageStyle) {\n  if (!imageStyle) {\n    this.image_ = null;\n  } else {\n    const imageAnchor = imageStyle.getAnchor();\n    // FIXME pixel ratio\n    const imageImage = imageStyle.getImage(1);\n    const imageOrigin = imageStyle.getOrigin();\n    const imageSize = imageStyle.getSize();\n    this.imageAnchorX_ = imageAnchor[0];\n    this.imageAnchorY_ = imageAnchor[1];\n    this.imageHeight_ = imageSize[1];\n    this.image_ = imageImage;\n    this.imageOpacity_ = imageStyle.getOpacity();\n    this.imageOriginX_ = imageOrigin[0];\n    this.imageOriginY_ = imageOrigin[1];\n    this.imageRotateWithView_ = imageStyle.getRotateWithView();\n    this.imageRotation_ = imageStyle.getRotation();\n    this.imageScale_ = imageStyle.getScale() * this.pixelRatio_;\n    this.imageSnapToPixel_ = imageStyle.getSnapToPixel();\n    this.imageWidth_ = imageSize[0];\n  }\n};\n\n\n/**\n * Set the text style for subsequent draw operations.  Pass null to\n * remove the text style.\n *\n * @param {module:ol/style/Text} textStyle Text style.\n * @override\n */\nCanvasImmediateRenderer.prototype.setTextStyle = function(textStyle) {\n  if (!textStyle) {\n    this.text_ = '';\n  } else {\n    const textFillStyle = textStyle.getFill();\n    if (!textFillStyle) {\n      this.textFillState_ = null;\n    } else {\n      const textFillStyleColor = textFillStyle.getColor();\n      this.textFillState_ = {\n        fillStyle: asColorLike(textFillStyleColor ?\n          textFillStyleColor : defaultFillStyle)\n      };\n    }\n    const textStrokeStyle = textStyle.getStroke();\n    if (!textStrokeStyle) {\n      this.textStrokeState_ = null;\n    } else {\n      const textStrokeStyleColor = textStrokeStyle.getColor();\n      const textStrokeStyleLineCap = textStrokeStyle.getLineCap();\n      const textStrokeStyleLineDash = textStrokeStyle.getLineDash();\n      const textStrokeStyleLineDashOffset = textStrokeStyle.getLineDashOffset();\n      const textStrokeStyleLineJoin = textStrokeStyle.getLineJoin();\n      const textStrokeStyleWidth = textStrokeStyle.getWidth();\n      const textStrokeStyleMiterLimit = textStrokeStyle.getMiterLimit();\n      this.textStrokeState_ = {\n        lineCap: textStrokeStyleLineCap !== undefined ?\n          textStrokeStyleLineCap : defaultLineCap,\n        lineDash: textStrokeStyleLineDash ?\n          textStrokeStyleLineDash : defaultLineDash,\n        lineDashOffset: textStrokeStyleLineDashOffset ?\n          textStrokeStyleLineDashOffset : defaultLineDashOffset,\n        lineJoin: textStrokeStyleLineJoin !== undefined ?\n          textStrokeStyleLineJoin : defaultLineJoin,\n        lineWidth: textStrokeStyleWidth !== undefined ?\n          textStrokeStyleWidth : defaultLineWidth,\n        miterLimit: textStrokeStyleMiterLimit !== undefined ?\n          textStrokeStyleMiterLimit : defaultMiterLimit,\n        strokeStyle: asColorLike(textStrokeStyleColor ?\n          textStrokeStyleColor : defaultStrokeStyle)\n      };\n    }\n    const textFont = textStyle.getFont();\n    const textOffsetX = textStyle.getOffsetX();\n    const textOffsetY = textStyle.getOffsetY();\n    const textRotateWithView = textStyle.getRotateWithView();\n    const textRotation = textStyle.getRotation();\n    const textScale = textStyle.getScale();\n    const textText = textStyle.getText();\n    const textTextAlign = textStyle.getTextAlign();\n    const textTextBaseline = textStyle.getTextBaseline();\n    this.textState_ = {\n      font: textFont !== undefined ?\n        textFont : defaultFont,\n      textAlign: textTextAlign !== undefined ?\n        textTextAlign : defaultTextAlign,\n      textBaseline: textTextBaseline !== undefined ?\n        textTextBaseline : defaultTextBaseline\n    };\n    this.text_ = textText !== undefined ? textText : '';\n    this.textOffsetX_ =\n        textOffsetX !== undefined ? (this.pixelRatio_ * textOffsetX) : 0;\n    this.textOffsetY_ =\n        textOffsetY !== undefined ? (this.pixelRatio_ * textOffsetY) : 0;\n    this.textRotateWithView_ = textRotateWithView !== undefined ? textRotateWithView : false;\n    this.textRotation_ = textRotation !== undefined ? textRotation : 0;\n    this.textScale_ = this.pixelRatio_ * (textScale !== undefined ?\n      textScale : 1);\n  }\n};\nexport default CanvasImmediateRenderer;\n","/**\n * @module ol/style/IconImageCache\n */\nimport {asString} from '../color.js';\n\n/**\n * Singleton class. Available through {@link module:ol/style/IconImageCache~shared}.\n * @constructor\n */\nconst IconImageCache = function() {\n\n  /**\n   * @type {!Object.<string, module:ol/style/IconImage>}\n   * @private\n   */\n  this.cache_ = {};\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.cacheSize_ = 0;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.maxCacheSize_ = 32;\n};\n\n\n/**\n * @param {string} src Src.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/color~Color} color Color.\n * @return {string} Cache key.\n */\nfunction getKey(src, crossOrigin, color) {\n  const colorString = color ? asString(color) : 'null';\n  return crossOrigin + ':' + src + ':' + colorString;\n}\n\n\n/**\n * FIXME empty description for jsdoc\n */\nIconImageCache.prototype.clear = function() {\n  this.cache_ = {};\n  this.cacheSize_ = 0;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nIconImageCache.prototype.expire = function() {\n  if (this.cacheSize_ > this.maxCacheSize_) {\n    let i = 0;\n    for (const key in this.cache_) {\n      const iconImage = this.cache_[key];\n      if ((i++ & 3) === 0 && !iconImage.hasListener()) {\n        delete this.cache_[key];\n        --this.cacheSize_;\n      }\n    }\n  }\n};\n\n\n/**\n * @param {string} src Src.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/color~Color} color Color.\n * @return {module:ol/style/IconImage} Icon image.\n */\nIconImageCache.prototype.get = function(src, crossOrigin, color) {\n  const key = getKey(src, crossOrigin, color);\n  return key in this.cache_ ? this.cache_[key] : null;\n};\n\n\n/**\n * @param {string} src Src.\n * @param {?string} crossOrigin Cross origin.\n * @param {module:ol/color~Color} color Color.\n * @param {module:ol/style/IconImage} iconImage Icon image.\n */\nIconImageCache.prototype.set = function(src, crossOrigin, color, iconImage) {\n  const key = getKey(src, crossOrigin, color);\n  this.cache_[key] = iconImage;\n  ++this.cacheSize_;\n};\n\n\n/**\n * Set the cache size of the icon cache. Default is `32`. Change this value when\n * your map uses more than 32 different icon images and you are not caching icon\n * styles on the application level.\n * @param {number} maxCacheSize Cache max size.\n * @api\n */\nIconImageCache.prototype.setSize = function(maxCacheSize) {\n  this.maxCacheSize_ = maxCacheSize;\n  this.expire();\n};\nexport default IconImageCache;\n\n\n/**\n * The {@link module:ol/style/IconImageCache~IconImageCache} for\n * {@link module:ol/style/Icon~Icon} images.\n * @api\n */\nexport const shared = new IconImageCache();\n","/**\n * @module ol/renderer/Map\n */\nimport {getUid, inherits} from '../util.js';\nimport Disposable from '../Disposable.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getWidth} from '../extent.js';\nimport {TRUE, UNDEFINED} from '../functions.js';\nimport {visibleAtResolution} from '../layer/Layer.js';\nimport {shared as iconImageCache} from '../style/IconImageCache.js';\nimport {compose as composeTransform, invert as invertTransform, setFromArray as transformSetFromArray} from '../transform.js';\n\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/Disposable}\n * @param {module:ol/PluggableMap} map Map.\n * @struct\n */\nconst MapRenderer = function(map) {\n  Disposable.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/PluggableMap}\n   */\n  this.map_ = map;\n\n  /**\n   * @private\n   * @type {!Object.<string, module:ol/renderer/Layer>}\n   */\n  this.layerRenderers_ = {};\n\n  /**\n   * @private\n   * @type {Object.<string, module:ol/events~EventsKey>}\n   */\n  this.layerRendererListeners_ = {};\n\n  /**\n   * @private\n   * @type {Array.<module:ol/renderer/Layer>}\n   */\n  this.layerRendererConstructors_ = [];\n\n};\n\ninherits(MapRenderer, Disposable);\n\n\n/**\n * Register layer renderer constructors.\n * @param {Array.<module:ol/renderer/Layer>} constructors Layer renderers.\n */\nMapRenderer.prototype.registerLayerRenderers = function(constructors) {\n  this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_, constructors);\n};\n\n\n/**\n * Get the registered layer renderer constructors.\n * @return {Array.<module:ol/renderer/Layer>} Registered layer renderers.\n */\nMapRenderer.prototype.getLayerRendererConstructors = function() {\n  return this.layerRendererConstructors_;\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @protected\n */\nMapRenderer.prototype.calculateMatrices2D = function(frameState) {\n  const viewState = frameState.viewState;\n  const coordinateToPixelTransform = frameState.coordinateToPixelTransform;\n  const pixelToCoordinateTransform = frameState.pixelToCoordinateTransform;\n\n  composeTransform(coordinateToPixelTransform,\n    frameState.size[0] / 2, frameState.size[1] / 2,\n    1 / viewState.resolution, -1 / viewState.resolution,\n    -viewState.rotation,\n    -viewState.center[0], -viewState.center[1]);\n\n  invertTransform(\n    transformSetFromArray(pixelToCoordinateTransform, coordinateToPixelTransform));\n};\n\n\n/**\n * Removes all layer renderers.\n */\nMapRenderer.prototype.removeLayerRenderers = function() {\n  for (const key in this.layerRenderers_) {\n    this.removeLayerRendererByKey_(key).dispose();\n  }\n};\n\n\n/**\n * @param {module:ol/PluggableMap} map Map.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n */\nfunction expireIconCache(map, frameState) {\n  iconImageCache.expire();\n}\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {function(this: S, (module:ol/Feature|module:ol/render/Feature),\n *     module:ol/layer/Layer): T} callback Feature callback.\n * @param {S} thisArg Value to use as `this` when executing `callback`.\n * @param {function(this: U, module:ol/layer/Layer): boolean} layerFilter Layer filter\n *     function, only layers which are visible and for which this function\n *     returns `true` will be tested for features.  By default, all visible\n *     layers will be tested.\n * @param {U} thisArg2 Value to use as `this` when executing `layerFilter`.\n * @return {T|undefined} Callback result.\n * @template S,T,U\n */\nMapRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg,\n  layerFilter, thisArg2) {\n  let result;\n  const viewState = frameState.viewState;\n  const viewResolution = viewState.resolution;\n\n  /**\n   * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n   * @param {module:ol/layer/Layer} layer Layer.\n   * @return {?} Callback result.\n   */\n  function forEachFeatureAtCoordinate(feature, layer) {\n    const key = getUid(feature).toString();\n    const managed = frameState.layerStates[getUid(layer)].managed;\n    if (!(key in frameState.skippedFeatureUids && !managed)) {\n      return callback.call(thisArg, feature, managed ? layer : null);\n    }\n  }\n\n  const projection = viewState.projection;\n\n  let translatedCoordinate = coordinate;\n  if (projection.canWrapX()) {\n    const projectionExtent = projection.getExtent();\n    const worldWidth = getWidth(projectionExtent);\n    const x = coordinate[0];\n    if (x < projectionExtent[0] || x > projectionExtent[2]) {\n      const worldsAway = Math.ceil((projectionExtent[0] - x) / worldWidth);\n      translatedCoordinate = [x + worldWidth * worldsAway, coordinate[1]];\n    }\n  }\n\n  const layerStates = frameState.layerStatesArray;\n  const numLayers = layerStates.length;\n  let i;\n  for (i = numLayers - 1; i >= 0; --i) {\n    const layerState = layerStates[i];\n    const layer = layerState.layer;\n    if (visibleAtResolution(layerState, viewResolution) && layerFilter.call(thisArg2, layer)) {\n      const layerRenderer = this.getLayerRenderer(layer);\n      if (layer.getSource()) {\n        result = layerRenderer.forEachFeatureAtCoordinate(\n          layer.getSource().getWrapX() ? translatedCoordinate : coordinate,\n          frameState, hitTolerance, forEachFeatureAtCoordinate, thisArg);\n      }\n      if (result) {\n        return result;\n      }\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @abstract\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {function(this: S, module:ol/layer/Layer, (Uint8ClampedArray|Uint8Array)): T} callback Layer\n *     callback.\n * @param {S} thisArg Value to use as `this` when executing `callback`.\n * @param {function(this: U, module:ol/layer/Layer): boolean} layerFilter Layer filter\n *     function, only layers which are visible and for which this function\n *     returns `true` will be tested for features.  By default, all visible\n *     layers will be tested.\n * @param {U} thisArg2 Value to use as `this` when executing `layerFilter`.\n * @return {T|undefined} Callback result.\n * @template S,T,U\n */\nMapRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, hitTolerance, callback, thisArg,\n  layerFilter, thisArg2) {};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {function(this: U, module:ol/layer/Layer): boolean} layerFilter Layer filter\n *     function, only layers which are visible and for which this function\n *     returns `true` will be tested for features.  By default, all visible\n *     layers will be tested.\n * @param {U} thisArg Value to use as `this` when executing `layerFilter`.\n * @return {boolean} Is there a feature at the given coordinate?\n * @template U\n */\nMapRenderer.prototype.hasFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, layerFilter, thisArg) {\n  const hasFeature = this.forEachFeatureAtCoordinate(\n    coordinate, frameState, hitTolerance, TRUE, this, layerFilter, thisArg);\n\n  return hasFeature !== undefined;\n};\n\n\n/**\n * @param {module:ol/layer/Layer} layer Layer.\n * @protected\n * @return {module:ol/renderer/Layer} Layer renderer.\n */\nMapRenderer.prototype.getLayerRenderer = function(layer) {\n  const layerKey = getUid(layer).toString();\n  if (layerKey in this.layerRenderers_) {\n    return this.layerRenderers_[layerKey];\n  } else {\n    let renderer;\n    for (let i = 0, ii = this.layerRendererConstructors_.length; i < ii; ++i) {\n      const candidate = this.layerRendererConstructors_[i];\n      if (candidate['handles'](layer)) {\n        renderer = candidate['create'](this, layer);\n        break;\n      }\n    }\n    if (renderer) {\n      this.layerRenderers_[layerKey] = renderer;\n      this.layerRendererListeners_[layerKey] = listen(renderer,\n        EventType.CHANGE, this.handleLayerRendererChange_, this);\n    } else {\n      throw new Error('Unable to create renderer for layer: ' + layer.getType());\n    }\n    return renderer;\n  }\n};\n\n\n/**\n * @param {string} layerKey Layer key.\n * @protected\n * @return {module:ol/renderer/Layer} Layer renderer.\n */\nMapRenderer.prototype.getLayerRendererByKey = function(layerKey) {\n  return this.layerRenderers_[layerKey];\n};\n\n\n/**\n * @protected\n * @return {Object.<string, module:ol/renderer/Layer>} Layer renderers.\n */\nMapRenderer.prototype.getLayerRenderers = function() {\n  return this.layerRenderers_;\n};\n\n\n/**\n * @return {module:ol/PluggableMap} Map.\n */\nMapRenderer.prototype.getMap = function() {\n  return this.map_;\n};\n\n\n/**\n * Handle changes in a layer renderer.\n * @private\n */\nMapRenderer.prototype.handleLayerRendererChange_ = function() {\n  this.map_.render();\n};\n\n\n/**\n * @param {string} layerKey Layer key.\n * @return {module:ol/renderer/Layer} Layer renderer.\n * @private\n */\nMapRenderer.prototype.removeLayerRendererByKey_ = function(layerKey) {\n  const layerRenderer = this.layerRenderers_[layerKey];\n  delete this.layerRenderers_[layerKey];\n\n  unlistenByKey(this.layerRendererListeners_[layerKey]);\n  delete this.layerRendererListeners_[layerKey];\n\n  return layerRenderer;\n};\n\n\n/**\n * Render.\n * @param {?module:ol/PluggableMap~FrameState} frameState Frame state.\n */\nMapRenderer.prototype.renderFrame = UNDEFINED;\n\n\n/**\n * @param {module:ol/PluggableMap} map Map.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @private\n */\nMapRenderer.prototype.removeUnusedLayerRenderers_ = function(map, frameState) {\n  for (const layerKey in this.layerRenderers_) {\n    if (!frameState || !(layerKey in frameState.layerStates)) {\n      this.removeLayerRendererByKey_(layerKey).dispose();\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @protected\n */\nMapRenderer.prototype.scheduleExpireIconCache = function(frameState) {\n  frameState.postRenderFunctions.push(/** @type {module:ol/PluggableMap~PostRenderFunction} */ (expireIconCache));\n};\n\n\n/**\n * @param {!module:ol/PluggableMap~FrameState} frameState Frame state.\n * @protected\n */\nMapRenderer.prototype.scheduleRemoveUnusedLayerRenderers = function(frameState) {\n  for (const layerKey in this.layerRenderers_) {\n    if (!(layerKey in frameState.layerStates)) {\n      frameState.postRenderFunctions.push(\n        /** @type {module:ol/PluggableMap~PostRenderFunction} */ (this.removeUnusedLayerRenderers_.bind(this))\n      );\n      return;\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/layer/Layer~State} state1 First layer state.\n * @param {module:ol/layer/Layer~State} state2 Second layer state.\n * @return {number} The zIndex difference.\n */\nexport function sortByZIndex(state1, state2) {\n  return state1.zIndex - state2.zIndex;\n}\nexport default MapRenderer;\n","/**\n * @module ol/renderer/canvas/Map\n */\nimport {create as createTransform, apply as applyTransform, compose as composeTransform} from '../../transform.js';\nimport {inherits} from '../../util.js';\nimport {includes, stableSort} from '../../array.js';\nimport {CLASS_UNSELECTABLE} from '../../css.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {visibleAtResolution} from '../../layer/Layer.js';\nimport RenderEvent from '../../render/Event.js';\nimport RenderEventType from '../../render/EventType.js';\nimport {rotateAtOffset} from '../../render/canvas.js';\nimport CanvasImmediateRenderer from '../../render/canvas/Immediate.js';\nimport MapRenderer, {sortByZIndex} from '../Map.js';\nimport SourceState from '../../source/State.js';\n\n\n/**\n * @type {Array.<module:ol/renderer/Layer>}\n */\nexport const layerRendererConstructors = [];\n\n\n/**\n * @constructor\n * @extends {module:ol/renderer/Map}\n * @param {module:ol/PluggableMap} map Map.\n * @api\n */\nconst CanvasMapRenderer = function(map) {\n  MapRenderer.call(this, map);\n\n  const container = map.getViewport();\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context_ = createCanvasContext2D();\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = this.context_.canvas;\n\n  this.canvas_.style.width = '100%';\n  this.canvas_.style.height = '100%';\n  this.canvas_.style.display = 'block';\n  this.canvas_.className = CLASS_UNSELECTABLE;\n  container.insertBefore(this.canvas_, container.childNodes[0] || null);\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.renderedVisible_ = true;\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.transform_ = createTransform();\n\n};\n\ninherits(CanvasMapRenderer, MapRenderer);\n\n\n/**\n * @param {module:ol/render/EventType} type Event type.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @private\n */\nCanvasMapRenderer.prototype.dispatchComposeEvent_ = function(type, frameState) {\n  const map = this.getMap();\n  const context = this.context_;\n  if (map.hasListener(type)) {\n    const extent = frameState.extent;\n    const pixelRatio = frameState.pixelRatio;\n    const viewState = frameState.viewState;\n    const rotation = viewState.rotation;\n\n    const transform = this.getTransform(frameState);\n\n    const vectorContext = new CanvasImmediateRenderer(context, pixelRatio,\n      extent, transform, rotation);\n    const composeEvent = new RenderEvent(type, vectorContext,\n      frameState, context, null);\n    map.dispatchEvent(composeEvent);\n  }\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @protected\n * @return {!module:ol/transform~Transform} Transform.\n */\nCanvasMapRenderer.prototype.getTransform = function(frameState) {\n  const viewState = frameState.viewState;\n  const dx1 = this.canvas_.width / 2;\n  const dy1 = this.canvas_.height / 2;\n  const sx = frameState.pixelRatio / viewState.resolution;\n  const sy = -sx;\n  const angle = -viewState.rotation;\n  const dx2 = -viewState.center[0];\n  const dy2 = -viewState.center[1];\n  return composeTransform(this.transform_, dx1, dy1, sx, sy, angle, dx2, dy2);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasMapRenderer.prototype.renderFrame = function(frameState) {\n\n  if (!frameState) {\n    if (this.renderedVisible_) {\n      this.canvas_.style.display = 'none';\n      this.renderedVisible_ = false;\n    }\n    return;\n  }\n\n  const context = this.context_;\n  const pixelRatio = frameState.pixelRatio;\n  const width = Math.round(frameState.size[0] * pixelRatio);\n  const height = Math.round(frameState.size[1] * pixelRatio);\n  if (this.canvas_.width != width || this.canvas_.height != height) {\n    this.canvas_.width = width;\n    this.canvas_.height = height;\n  } else {\n    context.clearRect(0, 0, width, height);\n  }\n\n  const rotation = frameState.viewState.rotation;\n\n  this.calculateMatrices2D(frameState);\n\n  this.dispatchComposeEvent_(RenderEventType.PRECOMPOSE, frameState);\n\n  const layerStatesArray = frameState.layerStatesArray;\n  stableSort(layerStatesArray, sortByZIndex);\n\n  if (rotation) {\n    context.save();\n    rotateAtOffset(context, rotation, width / 2, height / 2);\n  }\n\n  const viewResolution = frameState.viewState.resolution;\n  let i, ii, layer, layerRenderer, layerState;\n  for (i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n    layerState = layerStatesArray[i];\n    layer = layerState.layer;\n    layerRenderer = /** @type {module:ol/renderer/canvas/Layer} */ (this.getLayerRenderer(layer));\n    if (!visibleAtResolution(layerState, viewResolution) ||\n        layerState.sourceState != SourceState.READY) {\n      continue;\n    }\n    if (layerRenderer.prepareFrame(frameState, layerState)) {\n      layerRenderer.composeFrame(frameState, layerState, context);\n    }\n  }\n\n  if (rotation) {\n    context.restore();\n  }\n\n  this.dispatchComposeEvent_(RenderEventType.POSTCOMPOSE, frameState);\n\n  if (!this.renderedVisible_) {\n    this.canvas_.style.display = '';\n    this.renderedVisible_ = true;\n  }\n\n  this.scheduleRemoveUnusedLayerRenderers(frameState);\n  this.scheduleExpireIconCache(frameState);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasMapRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, hitTolerance, callback, thisArg,\n  layerFilter, thisArg2) {\n  let result;\n  const viewState = frameState.viewState;\n  const viewResolution = viewState.resolution;\n\n  const layerStates = frameState.layerStatesArray;\n  const numLayers = layerStates.length;\n\n  const coordinate = applyTransform(\n    frameState.pixelToCoordinateTransform, pixel.slice());\n\n  let i;\n  for (i = numLayers - 1; i >= 0; --i) {\n    const layerState = layerStates[i];\n    const layer = layerState.layer;\n    if (visibleAtResolution(layerState, viewResolution) && layerFilter.call(thisArg2, layer)) {\n      const layerRenderer = /** @type {module:ol/renderer/canvas/Layer} */ (this.getLayerRenderer(layer));\n      result = layerRenderer.forEachLayerAtCoordinate(\n        coordinate, frameState, hitTolerance, callback, thisArg);\n      if (result) {\n        return result;\n      }\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasMapRenderer.prototype.registerLayerRenderers = function(constructors) {\n  MapRenderer.prototype.registerLayerRenderers.call(this, constructors);\n  for (let i = 0, ii = constructors.length; i < ii; ++i) {\n    const ctor = constructors[i];\n    if (!includes(layerRendererConstructors, ctor)) {\n      layerRendererConstructors.push(ctor);\n    }\n  }\n};\n\nexport default CanvasMapRenderer;\n","/**\n * @module ol/renderer/Layer\n */\nimport {getUid, inherits} from '../util.js';\nimport ImageState from '../ImageState.js';\nimport Observable from '../Observable.js';\nimport TileState from '../TileState.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {FALSE, UNDEFINED} from '../functions.js';\nimport SourceState from '../source/State.js';\n\n/**\n * @constructor\n * @extends {module:ol/Observable}\n * @param {module:ol/layer/Layer} layer Layer.\n * @struct\n */\nconst LayerRenderer = function(layer) {\n\n  Observable.call(this);\n\n  /**\n   * @private\n   * @type {module:ol/layer/Layer}\n   */\n  this.layer_ = layer;\n\n\n};\n\ninherits(LayerRenderer, Observable);\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {function(this: S, (module:ol/Feature|module:ol/render/Feature), module:ol/layer/Layer): T}\n *     callback Feature callback.\n * @param {S} thisArg Value to use as `this` when executing `callback`.\n * @return {T|undefined} Callback result.\n * @template S,T\n */\nLayerRenderer.prototype.forEachFeatureAtCoordinate = UNDEFINED;\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @return {boolean} Is there a feature at the given coordinate?\n */\nLayerRenderer.prototype.hasFeatureAtCoordinate = FALSE;\n\n\n/**\n * Create a function that adds loaded tiles to the tile lookup.\n * @param {module:ol/source/Tile} source Tile source.\n * @param {module:ol/proj/Projection} projection Projection of the tiles.\n * @param {Object.<number, Object.<string, module:ol/Tile>>} tiles Lookup of loaded tiles by zoom level.\n * @return {function(number, module:ol/TileRange):boolean} A function that can be\n *     called with a zoom level and a tile range to add loaded tiles to the lookup.\n * @protected\n */\nLayerRenderer.prototype.createLoadedTileFinder = function(source, projection, tiles) {\n  return (\n    /**\n     * @param {number} zoom Zoom level.\n     * @param {module:ol/TileRange} tileRange Tile range.\n     * @return {boolean} The tile range is fully loaded.\n     */\n    function(zoom, tileRange) {\n      function callback(tile) {\n        if (!tiles[zoom]) {\n          tiles[zoom] = {};\n        }\n        tiles[zoom][tile.tileCoord.toString()] = tile;\n      }\n      return source.forEachLoadedTile(projection, zoom, tileRange, callback);\n    }\n  );\n};\n\n\n/**\n * @return {module:ol/layer/Layer} Layer.\n */\nLayerRenderer.prototype.getLayer = function() {\n  return this.layer_;\n};\n\n\n/**\n * Handle changes in image state.\n * @param {module:ol/events/Event} event Image change event.\n * @private\n */\nLayerRenderer.prototype.handleImageChange_ = function(event) {\n  const image = /** @type {module:ol/Image} */ (event.target);\n  if (image.getState() === ImageState.LOADED) {\n    this.renderIfReadyAndVisible();\n  }\n};\n\n\n/**\n * Load the image if not already loaded, and register the image change\n * listener if needed.\n * @param {module:ol/ImageBase} image Image.\n * @return {boolean} `true` if the image is already loaded, `false` otherwise.\n * @protected\n */\nLayerRenderer.prototype.loadImage = function(image) {\n  let imageState = image.getState();\n  if (imageState != ImageState.LOADED && imageState != ImageState.ERROR) {\n    listen(image, EventType.CHANGE, this.handleImageChange_, this);\n  }\n  if (imageState == ImageState.IDLE) {\n    image.load();\n    imageState = image.getState();\n  }\n  return imageState == ImageState.LOADED;\n};\n\n\n/**\n * @protected\n */\nLayerRenderer.prototype.renderIfReadyAndVisible = function() {\n  const layer = this.getLayer();\n  if (layer.getVisible() && layer.getSourceState() == SourceState.READY) {\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/source/Tile} tileSource Tile source.\n * @protected\n */\nLayerRenderer.prototype.scheduleExpireCache = function(frameState, tileSource) {\n  if (tileSource.canExpireCache()) {\n    /**\n     * @param {module:ol/source/Tile} tileSource Tile source.\n     * @param {module:ol/PluggableMap} map Map.\n     * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n     */\n    const postRenderFunction = function(tileSource, map, frameState) {\n      const tileSourceKey = getUid(tileSource).toString();\n      if (tileSourceKey in frameState.usedTiles) {\n        tileSource.expireCache(frameState.viewState.projection,\n          frameState.usedTiles[tileSourceKey]);\n      }\n    }.bind(null, tileSource);\n\n    frameState.postRenderFunctions.push(\n      /** @type {module:ol/PluggableMap~PostRenderFunction} */ (postRenderFunction)\n    );\n  }\n};\n\n\n/**\n * @param {!Object.<string, !Object.<string, module:ol/TileRange>>} usedTiles Used tiles.\n * @param {module:ol/source/Tile} tileSource Tile source.\n * @param {number} z Z.\n * @param {module:ol/TileRange} tileRange Tile range.\n * @protected\n */\nLayerRenderer.prototype.updateUsedTiles = function(usedTiles, tileSource, z, tileRange) {\n  // FIXME should we use tilesToDrawByZ instead?\n  const tileSourceKey = getUid(tileSource).toString();\n  const zKey = z.toString();\n  if (tileSourceKey in usedTiles) {\n    if (zKey in usedTiles[tileSourceKey]) {\n      usedTiles[tileSourceKey][zKey].extend(tileRange);\n    } else {\n      usedTiles[tileSourceKey][zKey] = tileRange;\n    }\n  } else {\n    usedTiles[tileSourceKey] = {};\n    usedTiles[tileSourceKey][zKey] = tileRange;\n  }\n};\n\n\n/**\n * Manage tile pyramid.\n * This function performs a number of functions related to the tiles at the\n * current zoom and lower zoom levels:\n * - registers idle tiles in frameState.wantedTiles so that they are not\n *   discarded by the tile queue\n * - enqueues missing tiles\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/source/Tile} tileSource Tile source.\n * @param {module:ol/tilegrid/TileGrid} tileGrid Tile grid.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} currentZ Current Z.\n * @param {number} preload Load low resolution tiles up to 'preload' levels.\n * @param {function(this: T, module:ol/Tile)=} opt_tileCallback Tile callback.\n * @param {T=} opt_this Object to use as `this` in `opt_tileCallback`.\n * @protected\n * @template T\n */\nLayerRenderer.prototype.manageTilePyramid = function(\n  frameState, tileSource, tileGrid, pixelRatio, projection, extent,\n  currentZ, preload, opt_tileCallback, opt_this) {\n  const tileSourceKey = getUid(tileSource).toString();\n  if (!(tileSourceKey in frameState.wantedTiles)) {\n    frameState.wantedTiles[tileSourceKey] = {};\n  }\n  const wantedTiles = frameState.wantedTiles[tileSourceKey];\n  const tileQueue = frameState.tileQueue;\n  const minZoom = tileGrid.getMinZoom();\n  let tile, tileRange, tileResolution, x, y, z;\n  for (z = minZoom; z <= currentZ; ++z) {\n    tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z, tileRange);\n    tileResolution = tileGrid.getResolution(z);\n    for (x = tileRange.minX; x <= tileRange.maxX; ++x) {\n      for (y = tileRange.minY; y <= tileRange.maxY; ++y) {\n        if (currentZ - z <= preload) {\n          tile = tileSource.getTile(z, x, y, pixelRatio, projection);\n          if (tile.getState() == TileState.IDLE) {\n            wantedTiles[tile.getKey()] = true;\n            if (!tileQueue.isKeyQueued(tile.getKey())) {\n              tileQueue.enqueue([tile, tileSourceKey,\n                tileGrid.getTileCoordCenter(tile.tileCoord), tileResolution]);\n            }\n          }\n          if (opt_tileCallback !== undefined) {\n            opt_tileCallback.call(opt_this, tile);\n          }\n        } else {\n          tileSource.useTile(z, x, y, projection);\n        }\n      }\n    }\n  }\n};\nexport default LayerRenderer;\n","/**\n * @module ol/renderer/canvas/Layer\n */\nimport {inherits} from '../../util.js';\nimport {getBottomLeft, getBottomRight, getTopLeft, getTopRight} from '../../extent.js';\nimport {TRUE} from '../../functions.js';\nimport RenderEvent from '../../render/Event.js';\nimport RenderEventType from '../../render/EventType.js';\nimport {rotateAtOffset} from '../../render/canvas.js';\nimport CanvasImmediateRenderer from '../../render/canvas/Immediate.js';\nimport LayerRenderer from '../Layer.js';\nimport {create as createTransform, apply as applyTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/renderer/Layer}\n * @param {module:ol/layer/Layer} layer Layer.\n */\nconst CanvasLayerRenderer = function(layer) {\n\n  LayerRenderer.call(this, layer);\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.renderedResolution;\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.transform_ = createTransform();\n\n};\n\ninherits(CanvasLayerRenderer, LayerRenderer);\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/extent~Extent} extent Clip extent.\n * @protected\n */\nCanvasLayerRenderer.prototype.clip = function(context, frameState, extent) {\n  const pixelRatio = frameState.pixelRatio;\n  const width = frameState.size[0] * pixelRatio;\n  const height = frameState.size[1] * pixelRatio;\n  const rotation = frameState.viewState.rotation;\n  const topLeft = getTopLeft(/** @type {module:ol/extent~Extent} */ (extent));\n  const topRight = getTopRight(/** @type {module:ol/extent~Extent} */ (extent));\n  const bottomRight = getBottomRight(/** @type {module:ol/extent~Extent} */ (extent));\n  const bottomLeft = getBottomLeft(/** @type {module:ol/extent~Extent} */ (extent));\n\n  applyTransform(frameState.coordinateToPixelTransform, topLeft);\n  applyTransform(frameState.coordinateToPixelTransform, topRight);\n  applyTransform(frameState.coordinateToPixelTransform, bottomRight);\n  applyTransform(frameState.coordinateToPixelTransform, bottomLeft);\n\n  context.save();\n  rotateAtOffset(context, -rotation, width / 2, height / 2);\n  context.beginPath();\n  context.moveTo(topLeft[0] * pixelRatio, topLeft[1] * pixelRatio);\n  context.lineTo(topRight[0] * pixelRatio, topRight[1] * pixelRatio);\n  context.lineTo(bottomRight[0] * pixelRatio, bottomRight[1] * pixelRatio);\n  context.lineTo(bottomLeft[0] * pixelRatio, bottomLeft[1] * pixelRatio);\n  context.clip();\n  rotateAtOffset(context, rotation, width / 2, height / 2);\n};\n\n\n/**\n * @param {module:ol/render/EventType} type Event type.\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/transform~Transform=} opt_transform Transform.\n * @private\n */\nCanvasLayerRenderer.prototype.dispatchComposeEvent_ = function(type, context, frameState, opt_transform) {\n  const layer = this.getLayer();\n  if (layer.hasListener(type)) {\n    const width = frameState.size[0] * frameState.pixelRatio;\n    const height = frameState.size[1] * frameState.pixelRatio;\n    const rotation = frameState.viewState.rotation;\n    rotateAtOffset(context, -rotation, width / 2, height / 2);\n    const transform = opt_transform !== undefined ?\n      opt_transform : this.getTransform(frameState, 0);\n    const render = new CanvasImmediateRenderer(\n      context, frameState.pixelRatio, frameState.extent, transform,\n      frameState.viewState.rotation);\n    const composeEvent = new RenderEvent(type, render, frameState,\n      context, null);\n    layer.dispatchEvent(composeEvent);\n    rotateAtOffset(context, rotation, width / 2, height / 2);\n  }\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {function(this: S, module:ol/layer/Layer, (Uint8ClampedArray|Uint8Array)): T} callback Layer\n *     callback.\n * @param {S} thisArg Value to use as `this` when executing `callback`.\n * @return {T|undefined} Callback result.\n * @template S,T,U\n */\nCanvasLayerRenderer.prototype.forEachLayerAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  const hasFeature = this.forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, TRUE, this);\n\n  if (hasFeature) {\n    return callback.call(thisArg, this.getLayer(), null);\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {module:ol/transform~Transform=} opt_transform Transform.\n * @protected\n */\nCanvasLayerRenderer.prototype.postCompose = function(context, frameState, layerState, opt_transform) {\n  this.dispatchComposeEvent_(RenderEventType.POSTCOMPOSE, context, frameState, opt_transform);\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/transform~Transform=} opt_transform Transform.\n * @protected\n */\nCanvasLayerRenderer.prototype.preCompose = function(context, frameState, opt_transform) {\n  this.dispatchComposeEvent_(RenderEventType.PRECOMPOSE, context, frameState, opt_transform);\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/transform~Transform=} opt_transform Transform.\n * @protected\n */\nCanvasLayerRenderer.prototype.dispatchRenderEvent = function(context, frameState, opt_transform) {\n  this.dispatchComposeEvent_(RenderEventType.RENDER, context, frameState, opt_transform);\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {number} offsetX Offset on the x-axis in view coordinates.\n * @protected\n * @return {!module:ol/transform~Transform} Transform.\n */\nCanvasLayerRenderer.prototype.getTransform = function(frameState, offsetX) {\n  const viewState = frameState.viewState;\n  const pixelRatio = frameState.pixelRatio;\n  const dx1 = pixelRatio * frameState.size[0] / 2;\n  const dy1 = pixelRatio * frameState.size[1] / 2;\n  const sx = pixelRatio / viewState.resolution;\n  const sy = -sx;\n  const angle = -viewState.rotation;\n  const dx2 = -viewState.center[0] + offsetX;\n  const dy2 = -viewState.center[1];\n  return composeTransform(this.transform_, dx1, dy1, sx, sy, angle, dx2, dy2);\n};\n\n\n/**\n * @abstract\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {CanvasRenderingContext2D} context Context.\n */\nCanvasLayerRenderer.prototype.composeFrame = function(frameState, layerState, context) {};\n\n/**\n * @abstract\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @return {boolean} whether composeFrame should be called.\n */\nCanvasLayerRenderer.prototype.prepareFrame = function(frameState, layerState) {};\nexport default CanvasLayerRenderer;\n","/**\n * @module ol/renderer/canvas/IntermediateCanvas\n */\nimport {inherits} from '../../util.js';\nimport {scale as scaleCoordinate} from '../../coordinate.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {containsExtent, intersects} from '../../extent.js';\nimport {UNDEFINED} from '../../functions.js';\nimport CanvasLayerRenderer from '../canvas/Layer.js';\nimport {create as createTransform, apply as applyTransform} from '../../transform.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/renderer/canvas/Layer}\n * @param {module:ol/layer/Layer} layer Layer.\n */\nconst IntermediateCanvasRenderer = function(layer) {\n\n  CanvasLayerRenderer.call(this, layer);\n\n  /**\n   * @protected\n   * @type {module:ol/transform~Transform}\n   */\n  this.coordinateToCanvasPixelTransform = createTransform();\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.hitCanvasContext_ = null;\n\n};\n\ninherits(IntermediateCanvasRenderer, CanvasLayerRenderer);\n\n\n/**\n * @inheritDoc\n */\nIntermediateCanvasRenderer.prototype.composeFrame = function(frameState, layerState, context) {\n\n  this.preCompose(context, frameState);\n\n  const image = this.getImage();\n  if (image) {\n\n    // clipped rendering if layer extent is set\n    const extent = layerState.extent;\n    const clipped = extent !== undefined &&\n        !containsExtent(extent, frameState.extent) &&\n        intersects(extent, frameState.extent);\n    if (clipped) {\n      this.clip(context, frameState, /** @type {module:ol/extent~Extent} */ (extent));\n    }\n\n    const imageTransform = this.getImageTransform();\n    // for performance reasons, context.save / context.restore is not used\n    // to save and restore the transformation matrix and the opacity.\n    // see http://jsperf.com/context-save-restore-versus-variable\n    const alpha = context.globalAlpha;\n    context.globalAlpha = layerState.opacity;\n\n    // for performance reasons, context.setTransform is only used\n    // when the view is rotated. see http://jsperf.com/canvas-transform\n    const dx = imageTransform[4];\n    const dy = imageTransform[5];\n    const dw = image.width * imageTransform[0];\n    const dh = image.height * imageTransform[3];\n    context.drawImage(image, 0, 0, +image.width, +image.height,\n      Math.round(dx), Math.round(dy), Math.round(dw), Math.round(dh));\n    context.globalAlpha = alpha;\n\n    if (clipped) {\n      context.restore();\n    }\n  }\n\n  this.postCompose(context, frameState, layerState);\n};\n\n\n/**\n * @abstract\n * @return {HTMLCanvasElement|HTMLVideoElement|Image} Canvas.\n */\nIntermediateCanvasRenderer.prototype.getImage = function() {};\n\n\n/**\n * @abstract\n * @return {!module:ol/transform~Transform} Image transform.\n */\nIntermediateCanvasRenderer.prototype.getImageTransform = function() {};\n\n\n/**\n * @inheritDoc\n */\nIntermediateCanvasRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  const layer = this.getLayer();\n  const source = layer.getSource();\n  const resolution = frameState.viewState.resolution;\n  const rotation = frameState.viewState.rotation;\n  const skippedFeatureUids = frameState.skippedFeatureUids;\n  return source.forEachFeatureAtCoordinate(\n    coordinate, resolution, rotation, hitTolerance, skippedFeatureUids,\n    /**\n     * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n     * @return {?} Callback result.\n     */\n    function(feature) {\n      return callback.call(thisArg, feature, layer);\n    });\n};\n\n\n/**\n * @inheritDoc\n */\nIntermediateCanvasRenderer.prototype.forEachLayerAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  if (!this.getImage()) {\n    return undefined;\n  }\n\n  if (this.getLayer().getSource().forEachFeatureAtCoordinate !== UNDEFINED) {\n    // for ImageCanvas sources use the original hit-detection logic,\n    // so that for example also transparent polygons are detected\n    return CanvasLayerRenderer.prototype.forEachLayerAtCoordinate.apply(this, arguments);\n  } else {\n    const pixel = applyTransform(this.coordinateToCanvasPixelTransform, coordinate.slice());\n    scaleCoordinate(pixel, frameState.viewState.resolution / this.renderedResolution);\n\n    if (!this.hitCanvasContext_) {\n      this.hitCanvasContext_ = createCanvasContext2D(1, 1);\n    }\n\n    this.hitCanvasContext_.clearRect(0, 0, 1, 1);\n    this.hitCanvasContext_.drawImage(this.getImage(), pixel[0], pixel[1], 1, 1, 0, 0, 1, 1);\n\n    const imageData = this.hitCanvasContext_.getImageData(0, 0, 1, 1).data;\n    if (imageData[3] > 0) {\n      return callback.call(thisArg, this.getLayer(),  imageData);\n    } else {\n      return undefined;\n    }\n  }\n};\n\nexport default IntermediateCanvasRenderer;\n","/**\n * @module ol/renderer/canvas/ImageLayer\n */\nimport {ENABLE_RASTER_REPROJECTION} from '../../reproj/common.js';\nimport {inherits} from '../../util.js';\nimport ImageCanvas from '../../ImageCanvas.js';\nimport LayerType from '../../LayerType.js';\nimport ViewHint from '../../ViewHint.js';\nimport {equals} from '../../array.js';\nimport {getHeight, getIntersection, getWidth, isEmpty} from '../../extent.js';\nimport VectorRenderType from '../../layer/VectorRenderType.js';\nimport {assign} from '../../obj.js';\nimport {layerRendererConstructors} from './Map.js';\nimport IntermediateCanvasRenderer from '../canvas/IntermediateCanvas.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @constructor\n * @extends {module:ol/renderer/canvas/IntermediateCanvas}\n * @param {module:ol/layer/Image|module:ol/layer/Vector} imageLayer Image or vector layer.\n * @api\n */\nconst CanvasImageLayerRenderer = function(imageLayer) {\n\n  IntermediateCanvasRenderer.call(this, imageLayer);\n\n  /**\n   * @private\n   * @type {?module:ol/ImageBase}\n   */\n  this.image_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.imageTransform_ = createTransform();\n\n  /**\n   * @type {!Array.<string>}\n   */\n  this.skippedFeatures_ = [];\n\n  /**\n   * @private\n   * @type {module:ol/renderer/canvas/VectorLayer}\n   */\n  this.vectorRenderer_ = null;\n\n  if (imageLayer.getType() === LayerType.VECTOR) {\n    for (let i = 0, ii = layerRendererConstructors.length; i < ii; ++i) {\n      const ctor = layerRendererConstructors[i];\n      if (ctor !== CanvasImageLayerRenderer && ctor['handles'](imageLayer)) {\n        this.vectorRenderer_ = new ctor(imageLayer);\n        break;\n      }\n    }\n  }\n\n};\n\ninherits(CanvasImageLayerRenderer, IntermediateCanvasRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasImageLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.IMAGE ||\n    layer.getType() === LayerType.VECTOR &&\n    /** @type {module:ol/layer/Vector} */ (layer).getRenderMode() === VectorRenderType.IMAGE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/canvas/ImageLayer} The layer renderer.\n */\nCanvasImageLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasImageLayerRenderer(/** @type {module:ol/layer/Image} */ (layer));\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageLayerRenderer.prototype.disposeInternal = function() {\n  if (this.vectorRenderer_) {\n    this.vectorRenderer_.dispose();\n  }\n  IntermediateCanvasRenderer.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageLayerRenderer.prototype.getImage = function() {\n  return !this.image_ ? null : this.image_.getImage();\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageLayerRenderer.prototype.getImageTransform = function() {\n  return this.imageTransform_;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageLayerRenderer.prototype.prepareFrame = function(frameState, layerState) {\n\n  const pixelRatio = frameState.pixelRatio;\n  const size = frameState.size;\n  const viewState = frameState.viewState;\n  const viewCenter = viewState.center;\n  const viewResolution = viewState.resolution;\n\n  let image;\n  const imageLayer = /** @type {module:ol/layer/Image} */ (this.getLayer());\n  const imageSource = imageLayer.getSource();\n\n  const hints = frameState.viewHints;\n\n  const vectorRenderer = this.vectorRenderer_;\n  let renderedExtent = frameState.extent;\n  if (!vectorRenderer && layerState.extent !== undefined) {\n    renderedExtent = getIntersection(renderedExtent, layerState.extent);\n  }\n\n  if (!hints[ViewHint.ANIMATING] && !hints[ViewHint.INTERACTING] &&\n      !isEmpty(renderedExtent)) {\n    let projection = viewState.projection;\n    if (!ENABLE_RASTER_REPROJECTION) {\n      const sourceProjection = imageSource.getProjection();\n      if (sourceProjection) {\n        projection = sourceProjection;\n      }\n    }\n    let skippedFeatures = this.skippedFeatures_;\n    if (vectorRenderer) {\n      const context = vectorRenderer.context;\n      const imageFrameState = /** @type {module:ol/PluggableMap~FrameState} */ (assign({}, frameState, {\n        size: [\n          getWidth(renderedExtent) / viewResolution,\n          getHeight(renderedExtent) / viewResolution\n        ],\n        viewState: /** @type {module:ol/View~State} */ (assign({}, frameState.viewState, {\n          rotation: 0\n        }))\n      }));\n      const newSkippedFeatures = Object.keys(imageFrameState.skippedFeatureUids).sort();\n      image = new ImageCanvas(renderedExtent, viewResolution, pixelRatio, context.canvas, function(callback) {\n        if (vectorRenderer.prepareFrame(imageFrameState, layerState) &&\n            (vectorRenderer.replayGroupChanged ||\n            !equals(skippedFeatures, newSkippedFeatures))) {\n          context.canvas.width = imageFrameState.size[0] * pixelRatio;\n          context.canvas.height = imageFrameState.size[1] * pixelRatio;\n          vectorRenderer.compose(context, imageFrameState, layerState);\n          skippedFeatures = newSkippedFeatures;\n          callback();\n        }\n      });\n    } else {\n      image = imageSource.getImage(\n        renderedExtent, viewResolution, pixelRatio, projection);\n    }\n    if (image && this.loadImage(image)) {\n      this.image_ = image;\n      this.skippedFeatures_ = skippedFeatures;\n    }\n  }\n\n  if (this.image_) {\n    image = this.image_;\n    const imageExtent = image.getExtent();\n    const imageResolution = image.getResolution();\n    const imagePixelRatio = image.getPixelRatio();\n    const scale = pixelRatio * imageResolution /\n        (viewResolution * imagePixelRatio);\n    const transform = composeTransform(this.imageTransform_,\n      pixelRatio * size[0] / 2, pixelRatio * size[1] / 2,\n      scale, scale,\n      0,\n      imagePixelRatio * (imageExtent[0] - viewCenter[0]) / imageResolution,\n      imagePixelRatio * (viewCenter[1] - imageExtent[3]) / imageResolution);\n    composeTransform(this.coordinateToCanvasPixelTransform,\n      pixelRatio * size[0] / 2 - transform[4], pixelRatio * size[1] / 2 - transform[5],\n      pixelRatio / viewResolution, -pixelRatio / viewResolution,\n      0,\n      -viewCenter[0], -viewCenter[1]);\n\n    this.renderedResolution = imageResolution * pixelRatio / imagePixelRatio;\n  }\n\n  return !!this.image_;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageLayerRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  if (this.vectorRenderer_) {\n    return this.vectorRenderer_.forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, callback, thisArg);\n  } else {\n    return IntermediateCanvasRenderer.prototype.forEachFeatureAtCoordinate.call(this, coordinate, frameState, hitTolerance, callback, thisArg);\n  }\n};\n\n\nexport default CanvasImageLayerRenderer;\n","/**\n * @module ol/TileRange\n */\n/**\n * A representation of a contiguous block of tiles.  A tile range is specified\n * by its min/max tile coordinates and is inclusive of coordinates.\n *\n * @constructor\n * @param {number} minX Minimum X.\n * @param {number} maxX Maximum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxY Maximum Y.\n * @struct\n */\nconst TileRange = function(minX, maxX, minY, maxY) {\n\n  /**\n   * @type {number}\n   */\n  this.minX = minX;\n\n  /**\n   * @type {number}\n   */\n  this.maxX = maxX;\n\n  /**\n   * @type {number}\n   */\n  this.minY = minY;\n\n  /**\n   * @type {number}\n   */\n  this.maxY = maxY;\n\n};\n\n\n/**\n * @param {number} minX Minimum X.\n * @param {number} maxX Maximum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxY Maximum Y.\n * @param {module:ol/TileRange=} tileRange TileRange.\n * @return {module:ol/TileRange} Tile range.\n */\nexport function createOrUpdate(minX, maxX, minY, maxY, tileRange) {\n  if (tileRange !== undefined) {\n    tileRange.minX = minX;\n    tileRange.maxX = maxX;\n    tileRange.minY = minY;\n    tileRange.maxY = maxY;\n    return tileRange;\n  } else {\n    return new TileRange(minX, maxX, minY, maxY);\n  }\n}\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @return {boolean} Contains tile coordinate.\n */\nTileRange.prototype.contains = function(tileCoord) {\n  return this.containsXY(tileCoord[1], tileCoord[2]);\n};\n\n\n/**\n * @param {module:ol/TileRange} tileRange Tile range.\n * @return {boolean} Contains.\n */\nTileRange.prototype.containsTileRange = function(tileRange) {\n  return this.minX <= tileRange.minX && tileRange.maxX <= this.maxX &&\n      this.minY <= tileRange.minY && tileRange.maxY <= this.maxY;\n};\n\n\n/**\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @return {boolean} Contains coordinate.\n */\nTileRange.prototype.containsXY = function(x, y) {\n  return this.minX <= x && x <= this.maxX && this.minY <= y && y <= this.maxY;\n};\n\n\n/**\n * @param {module:ol/TileRange} tileRange Tile range.\n * @return {boolean} Equals.\n */\nTileRange.prototype.equals = function(tileRange) {\n  return this.minX == tileRange.minX && this.minY == tileRange.minY &&\n      this.maxX == tileRange.maxX && this.maxY == tileRange.maxY;\n};\n\n\n/**\n * @param {module:ol/TileRange} tileRange Tile range.\n */\nTileRange.prototype.extend = function(tileRange) {\n  if (tileRange.minX < this.minX) {\n    this.minX = tileRange.minX;\n  }\n  if (tileRange.maxX > this.maxX) {\n    this.maxX = tileRange.maxX;\n  }\n  if (tileRange.minY < this.minY) {\n    this.minY = tileRange.minY;\n  }\n  if (tileRange.maxY > this.maxY) {\n    this.maxY = tileRange.maxY;\n  }\n};\n\n\n/**\n * @return {number} Height.\n */\nTileRange.prototype.getHeight = function() {\n  return this.maxY - this.minY + 1;\n};\n\n\n/**\n * @return {module:ol/size~Size} Size.\n */\nTileRange.prototype.getSize = function() {\n  return [this.getWidth(), this.getHeight()];\n};\n\n\n/**\n * @return {number} Width.\n */\nTileRange.prototype.getWidth = function() {\n  return this.maxX - this.minX + 1;\n};\n\n\n/**\n * @param {module:ol/TileRange} tileRange Tile range.\n * @return {boolean} Intersects.\n */\nTileRange.prototype.intersects = function(tileRange) {\n  return this.minX <= tileRange.maxX &&\n      this.maxX >= tileRange.minX &&\n      this.minY <= tileRange.maxY &&\n      this.maxY >= tileRange.minY;\n};\nexport default TileRange;\n","/**\n * @module ol/renderer/canvas/TileLayer\n */\nimport {getUid, inherits} from '../../util.js';\nimport LayerType from '../../LayerType.js';\nimport TileRange from '../../TileRange.js';\nimport TileState from '../../TileState.js';\nimport ViewHint from '../../ViewHint.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {containsExtent, createEmpty, equals, getIntersection, isEmpty} from '../../extent.js';\nimport IntermediateCanvasRenderer from '../canvas/IntermediateCanvas.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @constructor\n * @extends {module:ol/renderer/canvas/IntermediateCanvas}\n * @param {module:ol/layer/Tile|module:ol/layer/VectorTile} tileLayer Tile layer.\n * @api\n */\nconst CanvasTileLayerRenderer = function(tileLayer) {\n\n  IntermediateCanvasRenderer.call(this, tileLayer);\n\n  /**\n   * @protected\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context = this.context === null ? null : createCanvasContext2D();\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.oversampling_;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.renderedExtent_ = null;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.renderedRevision;\n\n  /**\n   * @protected\n   * @type {!Array.<module:ol/Tile>}\n   */\n  this.renderedTiles = [];\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.newTiles_ = false;\n\n  /**\n   * @protected\n   * @type {module:ol/extent~Extent}\n   */\n  this.tmpExtent = createEmpty();\n\n  /**\n   * @private\n   * @type {module:ol/TileRange}\n   */\n  this.tmpTileRange_ = new TileRange(0, 0, 0, 0);\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.imageTransform_ = createTransform();\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.zDirection = 0;\n\n};\n\ninherits(CanvasTileLayerRenderer, IntermediateCanvasRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasTileLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.TILE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/canvas/TileLayer} The layer renderer.\n */\nCanvasTileLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasTileLayerRenderer(/** @type {module:ol/layer/Tile} */ (layer));\n};\n\n\n/**\n * @private\n * @param {module:ol/Tile} tile Tile.\n * @return {boolean} Tile is drawable.\n */\nCanvasTileLayerRenderer.prototype.isDrawableTile_ = function(tile) {\n  const tileState = tile.getState();\n  const useInterimTilesOnError = this.getLayer().getUseInterimTilesOnError();\n  return tileState == TileState.LOADED ||\n      tileState == TileState.EMPTY ||\n      tileState == TileState.ERROR && !useInterimTilesOnError;\n};\n\n\n/**\n * @param {number} z Tile coordinate z.\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {!module:ol/Tile} Tile.\n */\nCanvasTileLayerRenderer.prototype.getTile = function(z, x, y, pixelRatio, projection) {\n  const layer = this.getLayer();\n  const source = /** @type {module:ol/source/Tile} */ (layer.getSource());\n  let tile = source.getTile(z, x, y, pixelRatio, projection);\n  if (tile.getState() == TileState.ERROR) {\n    if (!layer.getUseInterimTilesOnError()) {\n      // When useInterimTilesOnError is false, we consider the error tile as loaded.\n      tile.setState(TileState.LOADED);\n    } else if (layer.getPreload() > 0) {\n      // Preloaded tiles for lower resolutions might have finished loading.\n      this.newTiles_ = true;\n    }\n  }\n  if (!this.isDrawableTile_(tile)) {\n    tile = tile.getInterimTile();\n  }\n  return tile;\n};\n\n/**\n * @inheritDoc\n */\nCanvasTileLayerRenderer.prototype.prepareFrame = function(frameState, layerState) {\n\n  const pixelRatio = frameState.pixelRatio;\n  const size = frameState.size;\n  const viewState = frameState.viewState;\n  const projection = viewState.projection;\n  const viewResolution = viewState.resolution;\n  const viewCenter = viewState.center;\n\n  const tileLayer = this.getLayer();\n  const tileSource = /** @type {module:ol/source/Tile} */ (tileLayer.getSource());\n  const sourceRevision = tileSource.getRevision();\n  const tileGrid = tileSource.getTileGridForProjection(projection);\n  const z = tileGrid.getZForResolution(viewResolution, this.zDirection);\n  const tileResolution = tileGrid.getResolution(z);\n  let oversampling = Math.round(viewResolution / tileResolution) || 1;\n  let extent = frameState.extent;\n\n  if (layerState.extent !== undefined) {\n    extent = getIntersection(extent, layerState.extent);\n  }\n  if (isEmpty(extent)) {\n    // Return false to prevent the rendering of the layer.\n    return false;\n  }\n\n  const tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);\n  const imageExtent = tileGrid.getTileRangeExtent(z, tileRange);\n\n  const tilePixelRatio = tileSource.getTilePixelRatio(pixelRatio);\n\n  /**\n   * @type {Object.<number, Object.<string, module:ol/Tile>>}\n   */\n  const tilesToDrawByZ = {};\n  tilesToDrawByZ[z] = {};\n\n  const findLoadedTiles = this.createLoadedTileFinder(\n    tileSource, projection, tilesToDrawByZ);\n\n  const hints = frameState.viewHints;\n  const animatingOrInteracting = hints[ViewHint.ANIMATING] || hints[ViewHint.INTERACTING];\n\n  const tmpExtent = this.tmpExtent;\n  const tmpTileRange = this.tmpTileRange_;\n  this.newTiles_ = false;\n  let tile, x, y;\n  for (x = tileRange.minX; x <= tileRange.maxX; ++x) {\n    for (y = tileRange.minY; y <= tileRange.maxY; ++y) {\n      if (Date.now() - frameState.time > 16 && animatingOrInteracting) {\n        continue;\n      }\n      tile = this.getTile(z, x, y, pixelRatio, projection);\n      if (this.isDrawableTile_(tile)) {\n        const uid = getUid(this);\n        if (tile.getState() == TileState.LOADED) {\n          tilesToDrawByZ[z][tile.tileCoord.toString()] = tile;\n          const inTransition = tile.inTransition(uid);\n          if (!this.newTiles_ && (inTransition || this.renderedTiles.indexOf(tile) === -1)) {\n            this.newTiles_ = true;\n          }\n        }\n        if (tile.getAlpha(uid, frameState.time) === 1) {\n          // don't look for alt tiles if alpha is 1\n          continue;\n        }\n      }\n\n      const childTileRange = tileGrid.getTileCoordChildTileRange(\n        tile.tileCoord, tmpTileRange, tmpExtent);\n      let covered = false;\n      if (childTileRange) {\n        covered = findLoadedTiles(z + 1, childTileRange);\n      }\n      if (!covered) {\n        tileGrid.forEachTileCoordParentTileRange(\n          tile.tileCoord, findLoadedTiles, null, tmpTileRange, tmpExtent);\n      }\n\n    }\n  }\n\n  const renderedResolution = tileResolution * pixelRatio / tilePixelRatio * oversampling;\n  if (!(this.renderedResolution && Date.now() - frameState.time > 16 && animatingOrInteracting) && (\n    this.newTiles_ ||\n        !(this.renderedExtent_ && containsExtent(this.renderedExtent_, extent)) ||\n        this.renderedRevision != sourceRevision ||\n        oversampling != this.oversampling_ ||\n        !animatingOrInteracting && renderedResolution != this.renderedResolution\n  )) {\n\n    const context = this.context;\n    if (context) {\n      const tilePixelSize = tileSource.getTilePixelSize(z, pixelRatio, projection);\n      const width = Math.round(tileRange.getWidth() * tilePixelSize[0] / oversampling);\n      const height = Math.round(tileRange.getHeight() * tilePixelSize[1] / oversampling);\n      const canvas = context.canvas;\n      if (canvas.width != width || canvas.height != height) {\n        this.oversampling_ = oversampling;\n        canvas.width = width;\n        canvas.height = height;\n      } else {\n        if (this.renderedExtent_ && !equals(imageExtent, this.renderedExtent_)) {\n          context.clearRect(0, 0, width, height);\n        }\n        oversampling = this.oversampling_;\n      }\n    }\n\n    this.renderedTiles.length = 0;\n    /** @type {Array.<number>} */\n    const zs = Object.keys(tilesToDrawByZ).map(Number);\n    zs.sort(function(a, b) {\n      if (a === z) {\n        return 1;\n      } else if (b === z) {\n        return -1;\n      } else {\n        return a > b ? 1 : a < b ? -1 : 0;\n      }\n    });\n    let currentResolution, currentScale, currentTilePixelSize, currentZ, i, ii;\n    let tileExtent, tileGutter, tilesToDraw, w, h;\n    for (i = 0, ii = zs.length; i < ii; ++i) {\n      currentZ = zs[i];\n      currentTilePixelSize = tileSource.getTilePixelSize(currentZ, pixelRatio, projection);\n      currentResolution = tileGrid.getResolution(currentZ);\n      currentScale = currentResolution / tileResolution;\n      tileGutter = tilePixelRatio * tileSource.getGutter(projection);\n      tilesToDraw = tilesToDrawByZ[currentZ];\n      for (const tileCoordKey in tilesToDraw) {\n        tile = tilesToDraw[tileCoordKey];\n        tileExtent = tileGrid.getTileCoordExtent(tile.getTileCoord(), tmpExtent);\n        x = (tileExtent[0] - imageExtent[0]) / tileResolution * tilePixelRatio / oversampling;\n        y = (imageExtent[3] - tileExtent[3]) / tileResolution * tilePixelRatio / oversampling;\n        w = currentTilePixelSize[0] * currentScale / oversampling;\n        h = currentTilePixelSize[1] * currentScale / oversampling;\n        this.drawTileImage(tile, frameState, layerState, x, y, w, h, tileGutter, z === currentZ);\n        this.renderedTiles.push(tile);\n      }\n    }\n\n    this.renderedRevision = sourceRevision;\n    this.renderedResolution = tileResolution * pixelRatio / tilePixelRatio * oversampling;\n    this.renderedExtent_ = imageExtent;\n  }\n\n  const scale = this.renderedResolution / viewResolution;\n  const transform = composeTransform(this.imageTransform_,\n    pixelRatio * size[0] / 2, pixelRatio * size[1] / 2,\n    scale, scale,\n    0,\n    (this.renderedExtent_[0] - viewCenter[0]) / this.renderedResolution * pixelRatio,\n    (viewCenter[1] - this.renderedExtent_[3]) / this.renderedResolution * pixelRatio);\n  composeTransform(this.coordinateToCanvasPixelTransform,\n    pixelRatio * size[0] / 2 - transform[4], pixelRatio * size[1] / 2 - transform[5],\n    pixelRatio / viewResolution, -pixelRatio / viewResolution,\n    0,\n    -viewCenter[0], -viewCenter[1]);\n\n\n  this.updateUsedTiles(frameState.usedTiles, tileSource, z, tileRange);\n  this.manageTilePyramid(frameState, tileSource, tileGrid, pixelRatio,\n    projection, extent, z, tileLayer.getPreload());\n  this.scheduleExpireCache(frameState, tileSource);\n\n  return this.renderedTiles.length > 0;\n};\n\n\n/**\n * @param {module:ol/Tile} tile Tile.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {number} x Left of the tile.\n * @param {number} y Top of the tile.\n * @param {number} w Width of the tile.\n * @param {number} h Height of the tile.\n * @param {number} gutter Tile gutter.\n * @param {boolean} transition Apply an alpha transition.\n */\nCanvasTileLayerRenderer.prototype.drawTileImage = function(tile, frameState, layerState, x, y, w, h, gutter, transition) {\n  const image = tile.getImage(this.getLayer());\n  if (!image) {\n    return;\n  }\n  const uid = getUid(this);\n  const alpha = transition ? tile.getAlpha(uid, frameState.time) : 1;\n  if (alpha === 1 && !this.getLayer().getSource().getOpaque(frameState.viewState.projection)) {\n    this.context.clearRect(x, y, w, h);\n  }\n  const alphaChanged = alpha !== this.context.globalAlpha;\n  if (alphaChanged) {\n    this.context.save();\n    this.context.globalAlpha = alpha;\n  }\n  this.context.drawImage(image, gutter, gutter,\n    image.width - 2 * gutter, image.height - 2 * gutter, x, y, w, h);\n\n  if (alphaChanged) {\n    this.context.restore();\n  }\n  if (alpha !== 1) {\n    frameState.animate = true;\n  } else if (transition) {\n    tile.endTransition(uid);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasTileLayerRenderer.prototype.getImage = function() {\n  const context = this.context;\n  return context ? context.canvas : null;\n};\n\n\n/**\n * @function\n * @return {module:ol/layer/Tile|module:ol/layer/VectorTile}\n */\nCanvasTileLayerRenderer.prototype.getLayer;\n\n\n/**\n * @inheritDoc\n */\nCanvasTileLayerRenderer.prototype.getImageTransform = function() {\n  return this.imageTransform_;\n};\nexport default CanvasTileLayerRenderer;\n","/**\n * @module ol/render/ReplayGroup\n */\n/**\n * Base class for replay groups.\n * @constructor\n * @abstract\n */\nconst ReplayGroup = function() {};\n\n\n/**\n * @abstract\n * @param {number|undefined} zIndex Z index.\n * @param {module:ol/render/ReplayType} replayType Replay type.\n * @return {module:ol/render/VectorContext} Replay.\n */\nReplayGroup.prototype.getReplay = function(zIndex, replayType) {};\n\n\n/**\n * @abstract\n * @return {boolean} Is empty.\n */\nReplayGroup.prototype.isEmpty = function() {};\nexport default ReplayGroup;\n","/**\n * @module ol/render/ReplayType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  CIRCLE: 'Circle',\n  DEFAULT: 'Default',\n  IMAGE: 'Image',\n  LINE_STRING: 'LineString',\n  POLYGON: 'Polygon',\n  TEXT: 'Text'\n};\n","/**\n * @module ol/geom/flat/textpath\n */\nimport {lerp} from '../../math.js';\n\n\n/**\n * @param {Array.<number>} flatCoordinates Path to put text on.\n * @param {number} offset Start offset of the `flatCoordinates`.\n * @param {number} end End offset of the `flatCoordinates`.\n * @param {number} stride Stride.\n * @param {string} text Text to place on the path.\n * @param {function(string):number} measure Measure function returning the\n * width of the character passed as 1st argument.\n * @param {number} startM m along the path where the text starts.\n * @param {number} maxAngle Max angle between adjacent chars in radians.\n * @return {Array.<Array.<*>>} The result array of null if `maxAngle` was\n * exceeded. Entries of the array are x, y, anchorX, angle, chunk.\n */\nexport function drawTextOnPath(\n  flatCoordinates, offset, end, stride, text, measure, startM, maxAngle) {\n  const result = [];\n\n  // Keep text upright\n  const reverse = flatCoordinates[offset] > flatCoordinates[end - stride];\n\n  const numChars = text.length;\n\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  offset += stride;\n  let x2 = flatCoordinates[offset];\n  let y2 = flatCoordinates[offset + 1];\n  let segmentM = 0;\n  let segmentLength = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n\n  let chunk = '';\n  let chunkLength = 0;\n  let data, index, previousAngle;\n  for (let i = 0; i < numChars; ++i) {\n    index = reverse ? numChars - i - 1 : i;\n    const char = text.charAt(index);\n    chunk = reverse ? char + chunk : chunk + char;\n    const charLength = measure(chunk) - chunkLength;\n    chunkLength += charLength;\n    const charM = startM + charLength / 2;\n    while (offset < end - stride && segmentM + segmentLength < charM) {\n      x1 = x2;\n      y1 = y2;\n      offset += stride;\n      x2 = flatCoordinates[offset];\n      y2 = flatCoordinates[offset + 1];\n      segmentM += segmentLength;\n      segmentLength = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n    }\n    const segmentPos = charM - segmentM;\n    let angle = Math.atan2(y2 - y1, x2 - x1);\n    if (reverse) {\n      angle += angle > 0 ? -Math.PI : Math.PI;\n    }\n    if (previousAngle !== undefined) {\n      let delta = angle - previousAngle;\n      delta += (delta > Math.PI) ? -2 * Math.PI : (delta < -Math.PI) ? 2 * Math.PI : 0;\n      if (Math.abs(delta) > maxAngle) {\n        return null;\n      }\n    }\n    const interpolate = segmentPos / segmentLength;\n    const x = lerp(x1, x2, interpolate);\n    const y = lerp(y1, y2, interpolate);\n    if (previousAngle == angle) {\n      if (reverse) {\n        data[0] = x;\n        data[1] = y;\n        data[2] = charLength / 2;\n      }\n      data[4] = chunk;\n    } else {\n      chunk = char;\n      chunkLength = charLength;\n      data = [x, y, charLength / 2, angle, chunk];\n      if (reverse) {\n        result.unshift(data);\n      } else {\n        result.push(data);\n      }\n      previousAngle = angle;\n    }\n    startM += charLength;\n  }\n  return result;\n}\n","/**\n * @module ol/render/canvas/Instruction\n */\n\n/**\n * @enum {number}\n */\nconst Instruction = {\n  BEGIN_GEOMETRY: 0,\n  BEGIN_PATH: 1,\n  CIRCLE: 2,\n  CLOSE_PATH: 3,\n  CUSTOM: 4,\n  DRAW_CHARS: 5,\n  DRAW_IMAGE: 6,\n  END_GEOMETRY: 7,\n  FILL: 8,\n  MOVE_TO_LINE_TO: 9,\n  SET_FILL_STYLE: 10,\n  SET_STROKE_STYLE: 11,\n  STROKE: 12\n};\n\n\n/**\n * @type {Array.<Instruction>}\n */\nexport const fillInstruction = [Instruction.FILL];\n\n\n/**\n * @type {Array.<Instruction>}\n */\nexport const strokeInstruction = [Instruction.STROKE];\n\n\n/**\n * @type {Array.<Instruction>}\n */\nexport const beginPathInstruction = [Instruction.BEGIN_PATH];\n\n\n/**\n * @type {Array.<Instruction>}\n */\nexport const closePathInstruction = [Instruction.CLOSE_PATH];\n\n\nexport default Instruction;\n","/**\n * @module ol/render/replay\n */\nimport ReplayType from '../render/ReplayType.js';\n\n\n/**\n * @const\n * @type {Array.<module:ol/render/ReplayType>}\n */\nexport const ORDER = [\n  ReplayType.POLYGON,\n  ReplayType.CIRCLE,\n  ReplayType.LINE_STRING,\n  ReplayType.IMAGE,\n  ReplayType.TEXT,\n  ReplayType.DEFAULT\n];\n\n/**\n * @const\n * @enum {number}\n */\nexport const TEXT_ALIGN = {};\nTEXT_ALIGN['left'] = 0;\nTEXT_ALIGN['end'] = 0;\nTEXT_ALIGN['center'] = 0.5;\nTEXT_ALIGN['right'] = 1;\nTEXT_ALIGN['start'] = 1;\nTEXT_ALIGN['top'] = 0;\nTEXT_ALIGN['middle'] = 0.5;\nTEXT_ALIGN['hanging'] = 0.2;\nTEXT_ALIGN['alphabetic'] = 0.8;\nTEXT_ALIGN['ideographic'] = 0.8;\nTEXT_ALIGN['bottom'] = 1;\n","/**\n * @module ol/render/canvas/Replay\n */\nimport {getUid, inherits} from '../../util.js';\nimport {UNDEFINED} from '../../functions.js';\nimport {equals, reverseSubArray} from '../../array.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {buffer, clone, coordinateRelationship, createEmpty, createOrUpdate,\n  createOrUpdateEmpty, extend, extendCoordinate, intersects} from '../../extent.js';\nimport Relationship from '../../extent/Relationship.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {inflateCoordinates, inflateCoordinatesArray, inflateMultiCoordinatesArray} from '../../geom/flat/inflate.js';\nimport {lineStringLength} from '../../geom/flat/length.js';\nimport {drawTextOnPath} from '../../geom/flat/textpath.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {CANVAS_LINE_DASH} from '../../has.js';\nimport {isEmpty} from '../../obj.js';\nimport VectorContext from '../VectorContext.js';\nimport {drawImage, resetTransform, defaultPadding, defaultFillStyle, defaultStrokeStyle,\n  defaultMiterLimit, defaultLineWidth, defaultLineJoin, defaultLineDashOffset,\n  defaultLineDash, defaultLineCap} from '../canvas.js';\nimport CanvasInstruction from '../canvas/Instruction.js';\nimport {TEXT_ALIGN} from '../replay.js';\nimport {\n  create as createTransform,\n  compose as composeTransform,\n  apply as applyTransform,\n  setFromArray as transformSetFromArray\n} from '../../transform.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/VectorContext}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Maximum extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay can have overlapping geometries.\n * @param {?} declutterTree Declutter tree.\n * @struct\n */\nconst CanvasReplay = function(tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n  VectorContext.call(this);\n\n  /**\n   * @type {?}\n   */\n  this.declutterTree = declutterTree;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.tolerance = tolerance;\n\n  /**\n   * @protected\n   * @const\n   * @type {module:ol/extent~Extent}\n   */\n  this.maxExtent = maxExtent;\n\n  /**\n   * @protected\n   * @type {boolean}\n   */\n  this.overlaps = overlaps;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.pixelRatio = pixelRatio;\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.maxLineWidth = 0;\n\n  /**\n   * @protected\n   * @const\n   * @type {number}\n   */\n  this.resolution = resolution;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.alignFill_;\n\n  /**\n   * @private\n   * @type {Array.<*>}\n   */\n  this.beginGeometryInstruction1_ = null;\n\n  /**\n   * @private\n   * @type {Array.<*>}\n   */\n  this.beginGeometryInstruction2_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.bufferedMaxExtent_ = null;\n\n  /**\n   * @protected\n   * @type {Array.<*>}\n   */\n  this.instructions = [];\n\n  /**\n   * @protected\n   * @type {Array.<number>}\n   */\n  this.coordinates = [];\n\n  /**\n   * @private\n   * @type {!Object.<number,module:ol/coordinate~Coordinate|Array.<module:ol/coordinate~Coordinate>|Array.<Array.<module:ol/coordinate~Coordinate>>>}\n   */\n  this.coordinateCache_ = {};\n\n  /**\n   * @private\n   * @type {!module:ol/transform~Transform}\n   */\n  this.renderedTransform_ = createTransform();\n\n  /**\n   * @protected\n   * @type {Array.<*>}\n   */\n  this.hitDetectionInstructions = [];\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.pixelCoordinates_ = null;\n\n  /**\n   * @protected\n   * @type {module:ol/render/canvas~FillStrokeState}\n   */\n  this.state = /** @type {module:ol/render/canvas~FillStrokeState} */ ({});\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.viewRotation_ = 0;\n\n};\n\ninherits(CanvasReplay, VectorContext);\n\n\n/**\n * @type {module:ol/extent~Extent}\n */\nconst tmpExtent = createEmpty();\n\n\n/**\n * @type {!module:ol/transform~Transform}\n */\nconst tmpTransform = createTransform();\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/coordinate~Coordinate} p1 1st point of the background box.\n * @param {module:ol/coordinate~Coordinate} p2 2nd point of the background box.\n * @param {module:ol/coordinate~Coordinate} p3 3rd point of the background box.\n * @param {module:ol/coordinate~Coordinate} p4 4th point of the background box.\n * @param {Array.<*>} fillInstruction Fill instruction.\n * @param {Array.<*>} strokeInstruction Stroke instruction.\n */\nCanvasReplay.prototype.replayTextBackground_ = function(context, p1, p2, p3, p4,\n  fillInstruction, strokeInstruction) {\n  context.beginPath();\n  context.moveTo.apply(context, p1);\n  context.lineTo.apply(context, p2);\n  context.lineTo.apply(context, p3);\n  context.lineTo.apply(context, p4);\n  context.lineTo.apply(context, p1);\n  if (fillInstruction) {\n    this.alignFill_ = /** @type {boolean} */ (fillInstruction[2]);\n    this.fill_(context);\n  }\n  if (strokeInstruction) {\n    this.setStrokeStyle_(context, /** @type {Array.<*>} */ (strokeInstruction));\n    context.stroke();\n  }\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {HTMLImageElement|HTMLCanvasElement|HTMLVideoElement} image Image.\n * @param {number} anchorX Anchor X.\n * @param {number} anchorY Anchor Y.\n * @param {module:ol/render/canvas~DeclutterGroup} declutterGroup Declutter group.\n * @param {number} height Height.\n * @param {number} opacity Opacity.\n * @param {number} originX Origin X.\n * @param {number} originY Origin Y.\n * @param {number} rotation Rotation.\n * @param {number} scale Scale.\n * @param {boolean} snapToPixel Snap to pixel.\n * @param {number} width Width.\n * @param {Array.<number>} padding Padding.\n * @param {Array.<*>} fillInstruction Fill instruction.\n * @param {Array.<*>} strokeInstruction Stroke instruction.\n */\nCanvasReplay.prototype.replayImage_ = function(context, x, y, image,\n  anchorX, anchorY, declutterGroup, height, opacity, originX, originY,\n  rotation, scale, snapToPixel, width, padding, fillInstruction, strokeInstruction) {\n  const fillStroke = fillInstruction || strokeInstruction;\n  anchorX *= scale;\n  anchorY *= scale;\n  x -= anchorX;\n  y -= anchorY;\n\n  const w = (width + originX > image.width) ? image.width - originX : width;\n  const h = (height + originY > image.height) ? image.height - originY : height;\n  const boxW = padding[3] + w * scale + padding[1];\n  const boxH = padding[0] + h * scale + padding[2];\n  const boxX = x - padding[3];\n  const boxY = y - padding[0];\n\n  /** @type {module:ol/coordinate~Coordinate} */\n  let p1;\n  /** @type {module:ol/coordinate~Coordinate} */\n  let p2;\n  /** @type {module:ol/coordinate~Coordinate} */\n  let p3;\n  /** @type {module:ol/coordinate~Coordinate} */\n  let p4;\n  if (fillStroke || rotation !== 0) {\n    p1 = [boxX, boxY];\n    p2 = [boxX + boxW, boxY];\n    p3 = [boxX + boxW, boxY + boxH];\n    p4 = [boxX, boxY + boxH];\n  }\n\n  let transform = null;\n  if (rotation !== 0) {\n    const centerX = x + anchorX;\n    const centerY = y + anchorY;\n    transform = composeTransform(tmpTransform, centerX, centerY, 1, 1, rotation, -centerX, -centerY);\n\n    createOrUpdateEmpty(tmpExtent);\n    extendCoordinate(tmpExtent, applyTransform(tmpTransform, p1));\n    extendCoordinate(tmpExtent, applyTransform(tmpTransform, p2));\n    extendCoordinate(tmpExtent, applyTransform(tmpTransform, p3));\n    extendCoordinate(tmpExtent, applyTransform(tmpTransform, p4));\n  } else {\n    createOrUpdate(boxX, boxY, boxX + boxW, boxY + boxH, tmpExtent);\n  }\n  const canvas = context.canvas;\n  const strokePadding = strokeInstruction ? (strokeInstruction[2] * scale / 2) : 0;\n  const intersects =\n      tmpExtent[0] - strokePadding <= canvas.width && tmpExtent[2] + strokePadding >= 0 &&\n      tmpExtent[1] - strokePadding <= canvas.height && tmpExtent[3] + strokePadding >= 0;\n\n  if (snapToPixel) {\n    x = Math.round(x);\n    y = Math.round(y);\n  }\n\n  if (declutterGroup) {\n    if (!intersects && declutterGroup[4] == 1) {\n      return;\n    }\n    extend(declutterGroup, tmpExtent);\n    const declutterArgs = intersects ?\n      [context, transform ? transform.slice(0) : null, opacity, image, originX, originY, w, h, x, y, scale] :\n      null;\n    if (declutterArgs && fillStroke) {\n      declutterArgs.push(fillInstruction, strokeInstruction, p1, p2, p3, p4);\n    }\n    declutterGroup.push(declutterArgs);\n  } else if (intersects) {\n    if (fillStroke) {\n      this.replayTextBackground_(context, p1, p2, p3, p4,\n        /** @type {Array.<*>} */ (fillInstruction),\n        /** @type {Array.<*>} */ (strokeInstruction));\n    }\n    drawImage(context, transform, opacity, image, originX, originY, w, h, x, y, scale);\n  }\n};\n\n\n/**\n * @protected\n * @param {Array.<number>} dashArray Dash array.\n * @return {Array.<number>} Dash array with pixel ratio applied\n */\nCanvasReplay.prototype.applyPixelRatio = function(dashArray) {\n  const pixelRatio = this.pixelRatio;\n  return pixelRatio == 1 ? dashArray : dashArray.map(function(dash) {\n    return dash * pixelRatio;\n  });\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {boolean} closed Last input coordinate equals first.\n * @param {boolean} skipFirst Skip first coordinate.\n * @protected\n * @return {number} My end.\n */\nCanvasReplay.prototype.appendFlatCoordinates = function(flatCoordinates, offset, end, stride, closed, skipFirst) {\n\n  let myEnd = this.coordinates.length;\n  const extent = this.getBufferedMaxExtent();\n  if (skipFirst) {\n    offset += stride;\n  }\n  const lastCoord = [flatCoordinates[offset], flatCoordinates[offset + 1]];\n  const nextCoord = [NaN, NaN];\n  let skipped = true;\n\n  let i, lastRel, nextRel;\n  for (i = offset + stride; i < end; i += stride) {\n    nextCoord[0] = flatCoordinates[i];\n    nextCoord[1] = flatCoordinates[i + 1];\n    nextRel = coordinateRelationship(extent, nextCoord);\n    if (nextRel !== lastRel) {\n      if (skipped) {\n        this.coordinates[myEnd++] = lastCoord[0];\n        this.coordinates[myEnd++] = lastCoord[1];\n      }\n      this.coordinates[myEnd++] = nextCoord[0];\n      this.coordinates[myEnd++] = nextCoord[1];\n      skipped = false;\n    } else if (nextRel === Relationship.INTERSECTING) {\n      this.coordinates[myEnd++] = nextCoord[0];\n      this.coordinates[myEnd++] = nextCoord[1];\n      skipped = false;\n    } else {\n      skipped = true;\n    }\n    lastCoord[0] = nextCoord[0];\n    lastCoord[1] = nextCoord[1];\n    lastRel = nextRel;\n  }\n\n  // Last coordinate equals first or only one point to append:\n  if ((closed && skipped) || i === offset + stride) {\n    this.coordinates[myEnd++] = lastCoord[0];\n    this.coordinates[myEnd++] = lastCoord[1];\n  }\n  return myEnd;\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {Array.<number>} replayEnds Replay ends.\n * @return {number} Offset.\n */\nCanvasReplay.prototype.drawCustomCoordinates_ = function(flatCoordinates, offset, ends, stride, replayEnds) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const replayEnd = this.appendFlatCoordinates(flatCoordinates, offset, end, stride, false, false);\n    replayEnds.push(replayEnd);\n    offset = end;\n  }\n  return offset;\n};\n\n\n/**\n * @inheritDoc.\n */\nCanvasReplay.prototype.drawCustom = function(geometry, feature, renderer) {\n  this.beginGeometry(geometry, feature);\n  const type = geometry.getType();\n  const stride = geometry.getStride();\n  const replayBegin = this.coordinates.length;\n  let flatCoordinates, replayEnd, replayEnds, replayEndss;\n  let offset;\n  if (type == GeometryType.MULTI_POLYGON) {\n    geometry = /** @type {module:ol/geom/MultiPolygon} */ (geometry);\n    flatCoordinates = geometry.getOrientedFlatCoordinates();\n    replayEndss = [];\n    const endss = geometry.getEndss();\n    offset = 0;\n    for (let i = 0, ii = endss.length; i < ii; ++i) {\n      const myEnds = [];\n      offset = this.drawCustomCoordinates_(flatCoordinates, offset, endss[i], stride, myEnds);\n      replayEndss.push(myEnds);\n    }\n    this.instructions.push([CanvasInstruction.CUSTOM,\n      replayBegin, replayEndss, geometry, renderer, inflateMultiCoordinatesArray]);\n  } else if (type == GeometryType.POLYGON || type == GeometryType.MULTI_LINE_STRING) {\n    replayEnds = [];\n    flatCoordinates = (type == GeometryType.POLYGON) ?\n      /** @type {module:ol/geom/Polygon} */ (geometry).getOrientedFlatCoordinates() :\n      geometry.getFlatCoordinates();\n    offset = this.drawCustomCoordinates_(flatCoordinates, 0,\n      /** @type {module:ol/geom/Polygon|module:ol/geom/MultiLineString} */ (geometry).getEnds(),\n      stride, replayEnds);\n    this.instructions.push([CanvasInstruction.CUSTOM,\n      replayBegin, replayEnds, geometry, renderer, inflateCoordinatesArray]);\n  } else if (type == GeometryType.LINE_STRING || type == GeometryType.MULTI_POINT) {\n    flatCoordinates = geometry.getFlatCoordinates();\n    replayEnd = this.appendFlatCoordinates(\n      flatCoordinates, 0, flatCoordinates.length, stride, false, false);\n    this.instructions.push([CanvasInstruction.CUSTOM,\n      replayBegin, replayEnd, geometry, renderer, inflateCoordinates]);\n  } else if (type == GeometryType.POINT) {\n    flatCoordinates = geometry.getFlatCoordinates();\n    this.coordinates.push(flatCoordinates[0], flatCoordinates[1]);\n    replayEnd = this.coordinates.length;\n    this.instructions.push([CanvasInstruction.CUSTOM,\n      replayBegin, replayEnd, geometry, renderer]);\n  }\n  this.endGeometry(geometry, feature);\n};\n\n\n/**\n * @protected\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nCanvasReplay.prototype.beginGeometry = function(geometry, feature) {\n  this.beginGeometryInstruction1_ = [CanvasInstruction.BEGIN_GEOMETRY, feature, 0];\n  this.instructions.push(this.beginGeometryInstruction1_);\n  this.beginGeometryInstruction2_ = [CanvasInstruction.BEGIN_GEOMETRY, feature, 0];\n  this.hitDetectionInstructions.push(this.beginGeometryInstruction2_);\n};\n\n\n/**\n * @private\n * @param {CanvasRenderingContext2D} context Context.\n */\nCanvasReplay.prototype.fill_ = function(context) {\n  if (this.alignFill_) {\n    const origin = applyTransform(this.renderedTransform_, [0, 0]);\n    const repeatSize = 512 * this.pixelRatio;\n    context.translate(origin[0] % repeatSize, origin[1] % repeatSize);\n    context.rotate(this.viewRotation_);\n  }\n  context.fill();\n  if (this.alignFill_) {\n    context.setTransform.apply(context, resetTransform);\n  }\n};\n\n\n/**\n * @private\n * @param {CanvasRenderingContext2D} context Context.\n * @param {Array.<*>} instruction Instruction.\n */\nCanvasReplay.prototype.setStrokeStyle_ = function(context, instruction) {\n  context.strokeStyle = /** @type {module:ol/colorlike~ColorLike} */ (instruction[1]);\n  context.lineWidth = /** @type {number} */ (instruction[2]);\n  context.lineCap = /** @type {string} */ (instruction[3]);\n  context.lineJoin = /** @type {string} */ (instruction[4]);\n  context.miterLimit = /** @type {number} */ (instruction[5]);\n  if (CANVAS_LINE_DASH) {\n    context.lineDashOffset = /** @type {number} */ (instruction[7]);\n    context.setLineDash(/** @type {Array.<number>} */ (instruction[6]));\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~DeclutterGroup} declutterGroup Declutter group.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nCanvasReplay.prototype.renderDeclutter_ = function(declutterGroup, feature) {\n  if (declutterGroup && declutterGroup.length > 5) {\n    const groupCount = declutterGroup[4];\n    if (groupCount == 1 || groupCount == declutterGroup.length - 5) {\n      /** @type {module:ol/structs/RBush~Entry} */\n      const box = {\n        minX: /** @type {number} */ (declutterGroup[0]),\n        minY: /** @type {number} */ (declutterGroup[1]),\n        maxX: /** @type {number} */ (declutterGroup[2]),\n        maxY: /** @type {number} */ (declutterGroup[3]),\n        value: feature\n      };\n      if (!this.declutterTree.collides(box)) {\n        this.declutterTree.insert(box);\n        for (let j = 5, jj = declutterGroup.length; j < jj; ++j) {\n          const declutterData = /** @type {Array} */ (declutterGroup[j]);\n          if (declutterData) {\n            if (declutterData.length > 11) {\n              this.replayTextBackground_(declutterData[0],\n                declutterData[13], declutterData[14], declutterData[15], declutterData[16],\n                declutterData[11], declutterData[12]);\n            }\n            drawImage.apply(undefined, declutterData);\n          }\n        }\n      }\n      declutterGroup.length = 5;\n      createOrUpdateEmpty(declutterGroup);\n    }\n  }\n};\n\n\n/**\n * @private\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features\n *     to skip.\n * @param {Array.<*>} instructions Instructions array.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined}\n *     featureCallback Feature callback.\n * @param {module:ol/extent~Extent=} opt_hitExtent Only check features that intersect this\n *     extent.\n * @return {T|undefined} Callback result.\n * @template T\n */\nCanvasReplay.prototype.replay_ = function(\n  context, transform, skippedFeaturesHash,\n  instructions, featureCallback, opt_hitExtent) {\n  /** @type {Array.<number>} */\n  let pixelCoordinates;\n  if (this.pixelCoordinates_ && equals(transform, this.renderedTransform_)) {\n    pixelCoordinates = this.pixelCoordinates_;\n  } else {\n    if (!this.pixelCoordinates_) {\n      this.pixelCoordinates_ = [];\n    }\n    pixelCoordinates = transform2D(\n      this.coordinates, 0, this.coordinates.length, 2,\n      transform, this.pixelCoordinates_);\n    transformSetFromArray(this.renderedTransform_, transform);\n  }\n  const skipFeatures = !isEmpty(skippedFeaturesHash);\n  let i = 0; // instruction index\n  const ii = instructions.length; // end of instructions\n  let d = 0; // data index\n  let dd; // end of per-instruction data\n  let anchorX, anchorY, prevX, prevY, roundX, roundY, declutterGroup, image;\n  let pendingFill = 0;\n  let pendingStroke = 0;\n  let lastFillInstruction = null;\n  let lastStrokeInstruction = null;\n  const coordinateCache = this.coordinateCache_;\n  const viewRotation = this.viewRotation_;\n\n  const state = /** @type {module:ol/render~State} */ ({\n    context: context,\n    pixelRatio: this.pixelRatio,\n    resolution: this.resolution,\n    rotation: viewRotation\n  });\n\n  // When the batch size gets too big, performance decreases. 200 is a good\n  // balance between batch size and number of fill/stroke instructions.\n  const batchSize = this.instructions != instructions || this.overlaps ? 0 : 200;\n  let /** @type {module:ol/Feature|module:ol/render/Feature} */ feature;\n  let x, y;\n  while (i < ii) {\n    const instruction = instructions[i];\n    const type = /** @type {module:ol/render/canvas/Instruction} */ (instruction[0]);\n    switch (type) {\n      case CanvasInstruction.BEGIN_GEOMETRY:\n        feature = /** @type {module:ol/Feature|module:ol/render/Feature} */ (instruction[1]);\n        if ((skipFeatures &&\n            skippedFeaturesHash[getUid(feature).toString()]) ||\n            !feature.getGeometry()) {\n          i = /** @type {number} */ (instruction[2]);\n        } else if (opt_hitExtent !== undefined && !intersects(\n          opt_hitExtent, feature.getGeometry().getExtent())) {\n          i = /** @type {number} */ (instruction[2]) + 1;\n        } else {\n          ++i;\n        }\n        break;\n      case CanvasInstruction.BEGIN_PATH:\n        if (pendingFill > batchSize) {\n          this.fill_(context);\n          pendingFill = 0;\n        }\n        if (pendingStroke > batchSize) {\n          context.stroke();\n          pendingStroke = 0;\n        }\n        if (!pendingFill && !pendingStroke) {\n          context.beginPath();\n          prevX = prevY = NaN;\n        }\n        ++i;\n        break;\n      case CanvasInstruction.CIRCLE:\n        d = /** @type {number} */ (instruction[1]);\n        const x1 = pixelCoordinates[d];\n        const y1 = pixelCoordinates[d + 1];\n        const x2 = pixelCoordinates[d + 2];\n        const y2 = pixelCoordinates[d + 3];\n        const dx = x2 - x1;\n        const dy = y2 - y1;\n        const r = Math.sqrt(dx * dx + dy * dy);\n        context.moveTo(x1 + r, y1);\n        context.arc(x1, y1, r, 0, 2 * Math.PI, true);\n        ++i;\n        break;\n      case CanvasInstruction.CLOSE_PATH:\n        context.closePath();\n        ++i;\n        break;\n      case CanvasInstruction.CUSTOM:\n        d = /** @type {number} */ (instruction[1]);\n        dd = instruction[2];\n        const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (instruction[3]);\n        const renderer = instruction[4];\n        const fn = instruction.length == 6 ? instruction[5] : undefined;\n        state.geometry = geometry;\n        state.feature = feature;\n        if (!(i in coordinateCache)) {\n          coordinateCache[i] = [];\n        }\n        const coords = coordinateCache[i];\n        if (fn) {\n          fn(pixelCoordinates, d, dd, 2, coords);\n        } else {\n          coords[0] = pixelCoordinates[d];\n          coords[1] = pixelCoordinates[d + 1];\n          coords.length = 2;\n        }\n        renderer(coords, state);\n        ++i;\n        break;\n      case CanvasInstruction.DRAW_IMAGE:\n        d = /** @type {number} */ (instruction[1]);\n        dd = /** @type {number} */ (instruction[2]);\n        image =  /** @type {HTMLCanvasElement|HTMLVideoElement|Image} */\n            (instruction[3]);\n        // Remaining arguments in DRAW_IMAGE are in alphabetical order\n        anchorX = /** @type {number} */ (instruction[4]);\n        anchorY = /** @type {number} */ (instruction[5]);\n        declutterGroup = featureCallback ? null : /** @type {module:ol/render/canvas~DeclutterGroup} */ (instruction[6]);\n        const height = /** @type {number} */ (instruction[7]);\n        const opacity = /** @type {number} */ (instruction[8]);\n        const originX = /** @type {number} */ (instruction[9]);\n        const originY = /** @type {number} */ (instruction[10]);\n        const rotateWithView = /** @type {boolean} */ (instruction[11]);\n        let rotation = /** @type {number} */ (instruction[12]);\n        const scale = /** @type {number} */ (instruction[13]);\n        const snapToPixel = /** @type {boolean} */ (instruction[14]);\n        const width = /** @type {number} */ (instruction[15]);\n\n        let padding, backgroundFill, backgroundStroke;\n        if (instruction.length > 16) {\n          padding = /** @type {Array.<number>} */ (instruction[16]);\n          backgroundFill = /** @type {boolean} */ (instruction[17]);\n          backgroundStroke = /** @type {boolean} */ (instruction[18]);\n        } else {\n          padding = defaultPadding;\n          backgroundFill = backgroundStroke = false;\n        }\n\n        if (rotateWithView) {\n          rotation += viewRotation;\n        }\n        for (; d < dd; d += 2) {\n          this.replayImage_(context,\n            pixelCoordinates[d], pixelCoordinates[d + 1], image, anchorX, anchorY,\n            declutterGroup, height, opacity, originX, originY, rotation, scale,\n            snapToPixel, width, padding,\n            backgroundFill ? /** @type {Array.<*>} */ (lastFillInstruction) : null,\n            backgroundStroke ? /** @type {Array.<*>} */ (lastStrokeInstruction) : null);\n        }\n        this.renderDeclutter_(declutterGroup, feature);\n        ++i;\n        break;\n      case CanvasInstruction.DRAW_CHARS:\n        const begin = /** @type {number} */ (instruction[1]);\n        const end = /** @type {number} */ (instruction[2]);\n        const baseline = /** @type {number} */ (instruction[3]);\n        declutterGroup = featureCallback ? null : /** @type {module:ol/render/canvas~DeclutterGroup} */ (instruction[4]);\n        const overflow = /** @type {number} */ (instruction[5]);\n        const fillKey = /** @type {string} */ (instruction[6]);\n        const maxAngle = /** @type {number} */ (instruction[7]);\n        const measure = /** @type {function(string):number} */ (instruction[8]);\n        const offsetY = /** @type {number} */ (instruction[9]);\n        const strokeKey = /** @type {string} */ (instruction[10]);\n        const strokeWidth =  /** @type {number} */ (instruction[11]);\n        const text = /** @type {string} */ (instruction[12]);\n        const textKey = /** @type {string} */ (instruction[13]);\n        const textScale = /** @type {number} */ (instruction[14]);\n\n        const pathLength = lineStringLength(pixelCoordinates, begin, end, 2);\n        const textLength = measure(text);\n        if (overflow || textLength <= pathLength) {\n          const textAlign = /** @type {module:ol~render} */ (this).textStates[textKey].textAlign;\n          const startM = (pathLength - textLength) * TEXT_ALIGN[textAlign];\n          const parts = drawTextOnPath(\n            pixelCoordinates, begin, end, 2, text, measure, startM, maxAngle);\n          if (parts) {\n            let c, cc, chars, label, part;\n            if (strokeKey) {\n              for (c = 0, cc = parts.length; c < cc; ++c) {\n                part = parts[c]; // x, y, anchorX, rotation, chunk\n                chars = /** @type {string} */ (part[4]);\n                label = /** @type {module:ol~render} */ (this).getImage(chars, textKey, '', strokeKey);\n                anchorX = /** @type {number} */ (part[2]) + strokeWidth;\n                anchorY = baseline * label.height + (0.5 - baseline) * 2 * strokeWidth - offsetY;\n                this.replayImage_(context,\n                  /** @type {number} */ (part[0]), /** @type {number} */ (part[1]), label,\n                  anchorX, anchorY, declutterGroup, label.height, 1, 0, 0,\n                  /** @type {number} */ (part[3]), textScale, false, label.width,\n                  defaultPadding, null, null);\n              }\n            }\n            if (fillKey) {\n              for (c = 0, cc = parts.length; c < cc; ++c) {\n                part = parts[c]; // x, y, anchorX, rotation, chunk\n                chars = /** @type {string} */ (part[4]);\n                label = /** @type {module:ol~render} */ (this).getImage(chars, textKey, fillKey, '');\n                anchorX = /** @type {number} */ (part[2]);\n                anchorY = baseline * label.height - offsetY;\n                this.replayImage_(context,\n                  /** @type {number} */ (part[0]), /** @type {number} */ (part[1]), label,\n                  anchorX, anchorY, declutterGroup, label.height, 1, 0, 0,\n                  /** @type {number} */ (part[3]), textScale, false, label.width,\n                  defaultPadding, null, null);\n              }\n            }\n          }\n        }\n        this.renderDeclutter_(declutterGroup, feature);\n        ++i;\n        break;\n      case CanvasInstruction.END_GEOMETRY:\n        if (featureCallback !== undefined) {\n          feature = /** @type {module:ol/Feature|module:ol/render/Feature} */ (instruction[1]);\n          const result = featureCallback(feature);\n          if (result) {\n            return result;\n          }\n        }\n        ++i;\n        break;\n      case CanvasInstruction.FILL:\n        if (batchSize) {\n          pendingFill++;\n        } else {\n          this.fill_(context);\n        }\n        ++i;\n        break;\n      case CanvasInstruction.MOVE_TO_LINE_TO:\n        d = /** @type {number} */ (instruction[1]);\n        dd = /** @type {number} */ (instruction[2]);\n        x = pixelCoordinates[d];\n        y = pixelCoordinates[d + 1];\n        roundX = (x + 0.5) | 0;\n        roundY = (y + 0.5) | 0;\n        if (roundX !== prevX || roundY !== prevY) {\n          context.moveTo(x, y);\n          prevX = roundX;\n          prevY = roundY;\n        }\n        for (d += 2; d < dd; d += 2) {\n          x = pixelCoordinates[d];\n          y = pixelCoordinates[d + 1];\n          roundX = (x + 0.5) | 0;\n          roundY = (y + 0.5) | 0;\n          if (d == dd - 2 || roundX !== prevX || roundY !== prevY) {\n            context.lineTo(x, y);\n            prevX = roundX;\n            prevY = roundY;\n          }\n        }\n        ++i;\n        break;\n      case CanvasInstruction.SET_FILL_STYLE:\n        lastFillInstruction = instruction;\n        this.alignFill_ = instruction[2];\n\n        if (pendingFill) {\n          this.fill_(context);\n          pendingFill = 0;\n          if (pendingStroke) {\n            context.stroke();\n            pendingStroke = 0;\n          }\n        }\n\n        context.fillStyle = /** @type {module:ol/colorlike~ColorLike} */ (instruction[1]);\n        ++i;\n        break;\n      case CanvasInstruction.SET_STROKE_STYLE:\n        lastStrokeInstruction = instruction;\n        if (pendingStroke) {\n          context.stroke();\n          pendingStroke = 0;\n        }\n        this.setStrokeStyle_(context, /** @type {Array.<*>} */ (instruction));\n        ++i;\n        break;\n      case CanvasInstruction.STROKE:\n        if (batchSize) {\n          pendingStroke++;\n        } else {\n          context.stroke();\n        }\n        ++i;\n        break;\n      default:\n        ++i; // consume the instruction anyway, to avoid an infinite loop\n        break;\n    }\n  }\n  if (pendingFill) {\n    this.fill_(context);\n  }\n  if (pendingStroke) {\n    context.stroke();\n  }\n  return undefined;\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {number} viewRotation View rotation.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features\n *     to skip.\n */\nCanvasReplay.prototype.replay = function(\n  context, transform, viewRotation, skippedFeaturesHash) {\n  this.viewRotation_ = viewRotation;\n  this.replay_(context, transform,\n    skippedFeaturesHash, this.instructions, undefined, undefined);\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {number} viewRotation View rotation.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features\n *     to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T=} opt_featureCallback\n *     Feature callback.\n * @param {module:ol/extent~Extent=} opt_hitExtent Only check features that intersect this\n *     extent.\n * @return {T|undefined} Callback result.\n * @template T\n */\nCanvasReplay.prototype.replayHitDetection = function(\n  context, transform, viewRotation, skippedFeaturesHash,\n  opt_featureCallback, opt_hitExtent) {\n  this.viewRotation_ = viewRotation;\n  return this.replay_(context, transform, skippedFeaturesHash,\n    this.hitDetectionInstructions, opt_featureCallback, opt_hitExtent);\n};\n\n\n/**\n * Reverse the hit detection instructions.\n */\nCanvasReplay.prototype.reverseHitDetectionInstructions = function() {\n  const hitDetectionInstructions = this.hitDetectionInstructions;\n  // step 1 - reverse array\n  hitDetectionInstructions.reverse();\n  // step 2 - reverse instructions within geometry blocks\n  let i;\n  const n = hitDetectionInstructions.length;\n  let instruction;\n  let type;\n  let begin = -1;\n  for (i = 0; i < n; ++i) {\n    instruction = hitDetectionInstructions[i];\n    type = /** @type {module:ol/render/canvas/Instruction} */ (instruction[0]);\n    if (type == CanvasInstruction.END_GEOMETRY) {\n      begin = i;\n    } else if (type == CanvasInstruction.BEGIN_GEOMETRY) {\n      instruction[2] = i;\n      reverseSubArray(this.hitDetectionInstructions, begin, i);\n      begin = -1;\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasReplay.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {\n  const state = this.state;\n  if (fillStyle) {\n    const fillStyleColor = fillStyle.getColor();\n    state.fillStyle = asColorLike(fillStyleColor ?\n      fillStyleColor : defaultFillStyle);\n  } else {\n    state.fillStyle = undefined;\n  }\n  if (strokeStyle) {\n    const strokeStyleColor = strokeStyle.getColor();\n    state.strokeStyle = asColorLike(strokeStyleColor ?\n      strokeStyleColor : defaultStrokeStyle);\n    const strokeStyleLineCap = strokeStyle.getLineCap();\n    state.lineCap = strokeStyleLineCap !== undefined ?\n      strokeStyleLineCap : defaultLineCap;\n    const strokeStyleLineDash = strokeStyle.getLineDash();\n    state.lineDash = strokeStyleLineDash ?\n      strokeStyleLineDash.slice() : defaultLineDash;\n    const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n    state.lineDashOffset = strokeStyleLineDashOffset ?\n      strokeStyleLineDashOffset : defaultLineDashOffset;\n    const strokeStyleLineJoin = strokeStyle.getLineJoin();\n    state.lineJoin = strokeStyleLineJoin !== undefined ?\n      strokeStyleLineJoin : defaultLineJoin;\n    const strokeStyleWidth = strokeStyle.getWidth();\n    state.lineWidth = strokeStyleWidth !== undefined ?\n      strokeStyleWidth : defaultLineWidth;\n    const strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n    state.miterLimit = strokeStyleMiterLimit !== undefined ?\n      strokeStyleMiterLimit : defaultMiterLimit;\n\n    if (state.lineWidth > this.maxLineWidth) {\n      this.maxLineWidth = state.lineWidth;\n      // invalidate the buffered max extent cache\n      this.bufferedMaxExtent_ = null;\n    }\n  } else {\n    state.strokeStyle = undefined;\n    state.lineCap = undefined;\n    state.lineDash = null;\n    state.lineDashOffset = undefined;\n    state.lineJoin = undefined;\n    state.lineWidth = undefined;\n    state.miterLimit = undefined;\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillStrokeState} state State.\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n * @return {Array.<*>} Fill instruction.\n */\nCanvasReplay.prototype.createFill = function(state, geometry) {\n  const fillStyle = state.fillStyle;\n  const fillInstruction = [CanvasInstruction.SET_FILL_STYLE, fillStyle];\n  if (typeof fillStyle !== 'string') {\n    // Fill is a pattern or gradient - align it!\n    fillInstruction.push(true);\n  }\n  return fillInstruction;\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillStrokeState} state State.\n */\nCanvasReplay.prototype.applyStroke = function(state) {\n  this.instructions.push(this.createStroke(state));\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillStrokeState} state State.\n * @return {Array.<*>} Stroke instruction.\n */\nCanvasReplay.prototype.createStroke = function(state) {\n  return [\n    CanvasInstruction.SET_STROKE_STYLE,\n    state.strokeStyle, state.lineWidth * this.pixelRatio, state.lineCap,\n    state.lineJoin, state.miterLimit,\n    this.applyPixelRatio(state.lineDash), state.lineDashOffset * this.pixelRatio\n  ];\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillStrokeState} state State.\n * @param {function(this:module:ol/render/canvas/Replay, module:ol/render/canvas~FillStrokeState, (module:ol/geom/Geometry|module:ol/render/Feature)):Array.<*>} createFill Create fill.\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n */\nCanvasReplay.prototype.updateFillStyle = function(state, createFill, geometry) {\n  const fillStyle = state.fillStyle;\n  if (typeof fillStyle !== 'string' || state.currentFillStyle != fillStyle) {\n    if (fillStyle !== undefined) {\n      this.instructions.push(createFill.call(this, state, geometry));\n    }\n    state.currentFillStyle = fillStyle;\n  }\n};\n\n\n/**\n * @param {module:ol/render/canvas~FillStrokeState} state State.\n * @param {function(this:module:ol/render/canvas/Replay, module:ol/render/canvas~FillStrokeState)} applyStroke Apply stroke.\n */\nCanvasReplay.prototype.updateStrokeStyle = function(state, applyStroke) {\n  const strokeStyle = state.strokeStyle;\n  const lineCap = state.lineCap;\n  const lineDash = state.lineDash;\n  const lineDashOffset = state.lineDashOffset;\n  const lineJoin = state.lineJoin;\n  const lineWidth = state.lineWidth;\n  const miterLimit = state.miterLimit;\n  if (state.currentStrokeStyle != strokeStyle ||\n      state.currentLineCap != lineCap ||\n      (lineDash != state.currentLineDash && !equals(state.currentLineDash, lineDash)) ||\n      state.currentLineDashOffset != lineDashOffset ||\n      state.currentLineJoin != lineJoin ||\n      state.currentLineWidth != lineWidth ||\n      state.currentMiterLimit != miterLimit) {\n    if (strokeStyle !== undefined) {\n      applyStroke.call(this, state);\n    }\n    state.currentStrokeStyle = strokeStyle;\n    state.currentLineCap = lineCap;\n    state.currentLineDash = lineDash;\n    state.currentLineDashOffset = lineDashOffset;\n    state.currentLineJoin = lineJoin;\n    state.currentLineWidth = lineWidth;\n    state.currentMiterLimit = miterLimit;\n  }\n};\n\n\n/**\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nCanvasReplay.prototype.endGeometry = function(geometry, feature) {\n  this.beginGeometryInstruction1_[2] = this.instructions.length;\n  this.beginGeometryInstruction1_ = null;\n  this.beginGeometryInstruction2_[2] = this.hitDetectionInstructions.length;\n  this.beginGeometryInstruction2_ = null;\n  const endGeometryInstruction = [CanvasInstruction.END_GEOMETRY, feature];\n  this.instructions.push(endGeometryInstruction);\n  this.hitDetectionInstructions.push(endGeometryInstruction);\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nCanvasReplay.prototype.finish = UNDEFINED;\n\n\n/**\n * Get the buffered rendering extent.  Rendering will be clipped to the extent\n * provided to the constructor.  To account for symbolizers that may intersect\n * this extent, we calculate a buffered extent (e.g. based on stroke width).\n * @return {module:ol/extent~Extent} The buffered rendering extent.\n * @protected\n */\nCanvasReplay.prototype.getBufferedMaxExtent = function() {\n  if (!this.bufferedMaxExtent_) {\n    this.bufferedMaxExtent_ = clone(this.maxExtent);\n    if (this.maxLineWidth > 0) {\n      const width = this.resolution * (this.maxLineWidth + 1) / 2;\n      buffer(this.bufferedMaxExtent_, width, this.bufferedMaxExtent_);\n    }\n  }\n  return this.bufferedMaxExtent_;\n};\nexport default CanvasReplay;\n","/**\n * @module ol/render/canvas/ImageReplay\n */\nimport {inherits} from '../../util.js';\nimport CanvasInstruction from '../canvas/Instruction.js';\nimport CanvasReplay from '../canvas/Replay.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/canvas/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Maximum extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay can have overlapping geometries.\n * @param {?} declutterTree Declutter tree.\n * @struct\n */\nconst CanvasImageReplay = function(\n  tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n  CanvasReplay.call(this,\n    tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n\n  /**\n   * @private\n   * @type {module:ol/render/canvas~DeclutterGroup}\n   */\n  this.declutterGroup_ = null;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement|HTMLVideoElement|Image}\n   */\n  this.hitDetectionImage_ = null;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement|HTMLVideoElement|Image}\n   */\n  this.image_ = null;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.anchorX_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.anchorY_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.height_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.opacity_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.originX_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.originY_ = undefined;\n\n  /**\n   * @private\n   * @type {boolean|undefined}\n   */\n  this.rotateWithView_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.rotation_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.scale_ = undefined;\n\n  /**\n   * @private\n   * @type {boolean|undefined}\n   */\n  this.snapToPixel_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.width_ = undefined;\n\n};\n\ninherits(CanvasImageReplay, CanvasReplay);\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @private\n * @return {number} My end.\n */\nCanvasImageReplay.prototype.drawCoordinates_ = function(flatCoordinates, offset, end, stride) {\n  return this.appendFlatCoordinates(flatCoordinates, offset, end, stride, false, false);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageReplay.prototype.drawPoint = function(pointGeometry, feature) {\n  if (!this.image_) {\n    return;\n  }\n  this.beginGeometry(pointGeometry, feature);\n  const flatCoordinates = pointGeometry.getFlatCoordinates();\n  const stride = pointGeometry.getStride();\n  const myBegin = this.coordinates.length;\n  const myEnd = this.drawCoordinates_(flatCoordinates, 0, flatCoordinates.length, stride);\n  this.instructions.push([\n    CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.image_,\n    // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n    this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n    this.scale_ * this.pixelRatio, this.snapToPixel_, this.width_\n  ]);\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.hitDetectionImage_,\n    // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n    this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n    this.scale_, this.snapToPixel_, this.width_\n  ]);\n  this.endGeometry(pointGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageReplay.prototype.drawMultiPoint = function(multiPointGeometry, feature) {\n  if (!this.image_) {\n    return;\n  }\n  this.beginGeometry(multiPointGeometry, feature);\n  const flatCoordinates = multiPointGeometry.getFlatCoordinates();\n  const stride = multiPointGeometry.getStride();\n  const myBegin = this.coordinates.length;\n  const myEnd = this.drawCoordinates_(\n    flatCoordinates, 0, flatCoordinates.length, stride);\n  this.instructions.push([\n    CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.image_,\n    // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n    this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n    this.scale_ * this.pixelRatio, this.snapToPixel_, this.width_\n  ]);\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.hitDetectionImage_,\n    // Remaining arguments to DRAW_IMAGE are in alphabetical order\n    this.anchorX_, this.anchorY_, this.declutterGroup_, this.height_, this.opacity_,\n    this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n    this.scale_, this.snapToPixel_, this.width_\n  ]);\n  this.endGeometry(multiPointGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageReplay.prototype.finish = function() {\n  this.reverseHitDetectionInstructions();\n  // FIXME this doesn't really protect us against further calls to draw*Geometry\n  this.anchorX_ = undefined;\n  this.anchorY_ = undefined;\n  this.hitDetectionImage_ = null;\n  this.image_ = null;\n  this.height_ = undefined;\n  this.scale_ = undefined;\n  this.opacity_ = undefined;\n  this.originX_ = undefined;\n  this.originY_ = undefined;\n  this.rotateWithView_ = undefined;\n  this.rotation_ = undefined;\n  this.snapToPixel_ = undefined;\n  this.width_ = undefined;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasImageReplay.prototype.setImageStyle = function(imageStyle, declutterGroup) {\n  const anchor = imageStyle.getAnchor();\n  const size = imageStyle.getSize();\n  const hitDetectionImage = imageStyle.getHitDetectionImage(1);\n  const image = imageStyle.getImage(1);\n  const origin = imageStyle.getOrigin();\n  this.anchorX_ = anchor[0];\n  this.anchorY_ = anchor[1];\n  this.declutterGroup_ = /** @type {module:ol/render/canvas~DeclutterGroup} */ (declutterGroup);\n  this.hitDetectionImage_ = hitDetectionImage;\n  this.image_ = image;\n  this.height_ = size[1];\n  this.opacity_ = imageStyle.getOpacity();\n  this.originX_ = origin[0];\n  this.originY_ = origin[1];\n  this.rotateWithView_ = imageStyle.getRotateWithView();\n  this.rotation_ = imageStyle.getRotation();\n  this.scale_ = imageStyle.getScale();\n  this.snapToPixel_ = imageStyle.getSnapToPixel();\n  this.width_ = size[0];\n};\nexport default CanvasImageReplay;\n","/**\n * @module ol/render/canvas/LineStringReplay\n */\nimport {inherits} from '../../util.js';\nimport CanvasInstruction, {strokeInstruction, beginPathInstruction} from '../canvas/Instruction.js';\nimport CanvasReplay from '../canvas/Replay.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/canvas/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Maximum extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay can have overlapping geometries.\n * @param {?} declutterTree Declutter tree.\n * @struct\n */\nconst CanvasLineStringReplay = function(\n  tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n  CanvasReplay.call(this,\n    tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n};\n\ninherits(CanvasLineStringReplay, CanvasReplay);\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @private\n * @return {number} end.\n */\nCanvasLineStringReplay.prototype.drawFlatCoordinates_ = function(flatCoordinates, offset, end, stride) {\n  const myBegin = this.coordinates.length;\n  const myEnd = this.appendFlatCoordinates(\n    flatCoordinates, offset, end, stride, false, false);\n  const moveToLineToInstruction = [CanvasInstruction.MOVE_TO_LINE_TO, myBegin, myEnd];\n  this.instructions.push(moveToLineToInstruction);\n  this.hitDetectionInstructions.push(moveToLineToInstruction);\n  return end;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasLineStringReplay.prototype.drawLineString = function(lineStringGeometry, feature) {\n  const state = this.state;\n  const strokeStyle = state.strokeStyle;\n  const lineWidth = state.lineWidth;\n  if (strokeStyle === undefined || lineWidth === undefined) {\n    return;\n  }\n  this.updateStrokeStyle(state, this.applyStroke);\n  this.beginGeometry(lineStringGeometry, feature);\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.SET_STROKE_STYLE,\n    state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n    state.miterLimit, state.lineDash, state.lineDashOffset\n  ], beginPathInstruction);\n  const flatCoordinates = lineStringGeometry.getFlatCoordinates();\n  const stride = lineStringGeometry.getStride();\n  this.drawFlatCoordinates_(flatCoordinates, 0, flatCoordinates.length, stride);\n  this.hitDetectionInstructions.push(strokeInstruction);\n  this.endGeometry(lineStringGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasLineStringReplay.prototype.drawMultiLineString = function(multiLineStringGeometry, feature) {\n  const state = this.state;\n  const strokeStyle = state.strokeStyle;\n  const lineWidth = state.lineWidth;\n  if (strokeStyle === undefined || lineWidth === undefined) {\n    return;\n  }\n  this.updateStrokeStyle(state, this.applyStroke);\n  this.beginGeometry(multiLineStringGeometry, feature);\n  this.hitDetectionInstructions.push([\n    CanvasInstruction.SET_STROKE_STYLE,\n    state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n    state.miterLimit, state.lineDash, state.lineDashOffset\n  ], beginPathInstruction);\n  const ends = multiLineStringGeometry.getEnds();\n  const flatCoordinates = multiLineStringGeometry.getFlatCoordinates();\n  const stride = multiLineStringGeometry.getStride();\n  let offset = 0;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    offset = this.drawFlatCoordinates_(flatCoordinates, offset, ends[i], stride);\n  }\n  this.hitDetectionInstructions.push(strokeInstruction);\n  this.endGeometry(multiLineStringGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasLineStringReplay.prototype.finish = function() {\n  const state = this.state;\n  if (state.lastStroke != undefined && state.lastStroke != this.coordinates.length) {\n    this.instructions.push(strokeInstruction);\n  }\n  this.reverseHitDetectionInstructions();\n  this.state = null;\n};\n\n\n/**\n * @inheritDoc.\n */\nCanvasLineStringReplay.prototype.applyStroke = function(state) {\n  if (state.lastStroke != undefined && state.lastStroke != this.coordinates.length) {\n    this.instructions.push(strokeInstruction);\n    state.lastStroke = this.coordinates.length;\n  }\n  state.lastStroke = 0;\n  CanvasReplay.prototype.applyStroke.call(this, state);\n  this.instructions.push(beginPathInstruction);\n};\nexport default CanvasLineStringReplay;\n","/**\n * @module ol/render/canvas/PolygonReplay\n */\nimport {inherits} from '../../util.js';\nimport {asString} from '../../color.js';\nimport {snap} from '../../geom/flat/simplify.js';\nimport {defaultFillStyle} from '../canvas.js';\nimport CanvasInstruction, {\n  fillInstruction, strokeInstruction, beginPathInstruction, closePathInstruction\n} from '../canvas/Instruction.js';\nimport CanvasReplay from '../canvas/Replay.js';\n\n\n/**\n * @constructor\n * @extends {module:ol/render/canvas/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Maximum extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay can have overlapping geometries.\n * @param {?} declutterTree Declutter tree.\n * @struct\n */\nconst CanvasPolygonReplay = function(\n  tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n  CanvasReplay.call(this,\n    tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n};\n\ninherits(CanvasPolygonReplay, CanvasReplay);\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array.<number>} ends Ends.\n * @param {number} stride Stride.\n * @private\n * @return {number} End.\n */\nCanvasPolygonReplay.prototype.drawFlatCoordinatess_ = function(flatCoordinates, offset, ends, stride) {\n  const state = this.state;\n  const fill = state.fillStyle !== undefined;\n  const stroke = state.strokeStyle != undefined;\n  const numEnds = ends.length;\n  this.instructions.push(beginPathInstruction);\n  this.hitDetectionInstructions.push(beginPathInstruction);\n  for (let i = 0; i < numEnds; ++i) {\n    const end = ends[i];\n    const myBegin = this.coordinates.length;\n    const myEnd = this.appendFlatCoordinates(flatCoordinates, offset, end, stride, true, !stroke);\n    const moveToLineToInstruction = [CanvasInstruction.MOVE_TO_LINE_TO, myBegin, myEnd];\n    this.instructions.push(moveToLineToInstruction);\n    this.hitDetectionInstructions.push(moveToLineToInstruction);\n    if (stroke) {\n      // Performance optimization: only call closePath() when we have a stroke.\n      // Otherwise the ring is closed already (see appendFlatCoordinates above).\n      this.instructions.push(closePathInstruction);\n      this.hitDetectionInstructions.push(closePathInstruction);\n    }\n    offset = end;\n  }\n  if (fill) {\n    this.instructions.push(fillInstruction);\n    this.hitDetectionInstructions.push(fillInstruction);\n  }\n  if (stroke) {\n    this.instructions.push(strokeInstruction);\n    this.hitDetectionInstructions.push(strokeInstruction);\n  }\n  return offset;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasPolygonReplay.prototype.drawCircle = function(circleGeometry, feature) {\n  const state = this.state;\n  const fillStyle = state.fillStyle;\n  const strokeStyle = state.strokeStyle;\n  if (fillStyle === undefined && strokeStyle === undefined) {\n    return;\n  }\n  this.setFillStrokeStyles_(circleGeometry);\n  this.beginGeometry(circleGeometry, feature);\n  if (state.fillStyle !== undefined) {\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_FILL_STYLE,\n      asString(defaultFillStyle)\n    ]);\n  }\n  if (state.strokeStyle !== undefined) {\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_STROKE_STYLE,\n      state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n      state.miterLimit, state.lineDash, state.lineDashOffset\n    ]);\n  }\n  const flatCoordinates = circleGeometry.getFlatCoordinates();\n  const stride = circleGeometry.getStride();\n  const myBegin = this.coordinates.length;\n  this.appendFlatCoordinates(\n    flatCoordinates, 0, flatCoordinates.length, stride, false, false);\n  const circleInstruction = [CanvasInstruction.CIRCLE, myBegin];\n  this.instructions.push(beginPathInstruction, circleInstruction);\n  this.hitDetectionInstructions.push(beginPathInstruction, circleInstruction);\n  this.hitDetectionInstructions.push(fillInstruction);\n  if (state.fillStyle !== undefined) {\n    this.instructions.push(fillInstruction);\n  }\n  if (state.strokeStyle !== undefined) {\n    this.instructions.push(strokeInstruction);\n    this.hitDetectionInstructions.push(strokeInstruction);\n  }\n  this.endGeometry(circleGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasPolygonReplay.prototype.drawPolygon = function(polygonGeometry, feature) {\n  const state = this.state;\n  const fillStyle = state.fillStyle;\n  const strokeStyle = state.strokeStyle;\n  if (fillStyle === undefined && strokeStyle === undefined) {\n    return;\n  }\n  this.setFillStrokeStyles_(polygonGeometry);\n  this.beginGeometry(polygonGeometry, feature);\n  if (state.fillStyle !== undefined) {\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_FILL_STYLE,\n      asString(defaultFillStyle)\n    ]);\n  }\n  if (state.strokeStyle !== undefined) {\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_STROKE_STYLE,\n      state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n      state.miterLimit, state.lineDash, state.lineDashOffset\n    ]);\n  }\n  const ends = polygonGeometry.getEnds();\n  const flatCoordinates = polygonGeometry.getOrientedFlatCoordinates();\n  const stride = polygonGeometry.getStride();\n  this.drawFlatCoordinatess_(flatCoordinates, 0, ends, stride);\n  this.endGeometry(polygonGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasPolygonReplay.prototype.drawMultiPolygon = function(multiPolygonGeometry, feature) {\n  const state = this.state;\n  const fillStyle = state.fillStyle;\n  const strokeStyle = state.strokeStyle;\n  if (fillStyle === undefined && strokeStyle === undefined) {\n    return;\n  }\n  this.setFillStrokeStyles_(multiPolygonGeometry);\n  this.beginGeometry(multiPolygonGeometry, feature);\n  if (state.fillStyle !== undefined) {\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_FILL_STYLE,\n      asString(defaultFillStyle)\n    ]);\n  }\n  if (state.strokeStyle !== undefined) {\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_STROKE_STYLE,\n      state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n      state.miterLimit, state.lineDash, state.lineDashOffset\n    ]);\n  }\n  const endss = multiPolygonGeometry.getEndss();\n  const flatCoordinates = multiPolygonGeometry.getOrientedFlatCoordinates();\n  const stride = multiPolygonGeometry.getStride();\n  let offset = 0;\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    offset = this.drawFlatCoordinatess_(flatCoordinates, offset, endss[i], stride);\n  }\n  this.endGeometry(multiPolygonGeometry, feature);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasPolygonReplay.prototype.finish = function() {\n  this.reverseHitDetectionInstructions();\n  this.state = null;\n  // We want to preserve topology when drawing polygons.  Polygons are\n  // simplified using quantization and point elimination. However, we might\n  // have received a mix of quantized and non-quantized geometries, so ensure\n  // that all are quantized by quantizing all coordinates in the batch.\n  const tolerance = this.tolerance;\n  if (tolerance !== 0) {\n    const coordinates = this.coordinates;\n    for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n      coordinates[i] = snap(coordinates[i], tolerance);\n    }\n  }\n};\n\n\n/**\n * @private\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n */\nCanvasPolygonReplay.prototype.setFillStrokeStyles_ = function(geometry) {\n  const state = this.state;\n  const fillStyle = state.fillStyle;\n  if (fillStyle !== undefined) {\n    this.updateFillStyle(state, this.createFill, geometry);\n  }\n  if (state.strokeStyle !== undefined) {\n    this.updateStrokeStyle(state, this.applyStroke);\n  }\n};\nexport default CanvasPolygonReplay;\n","/**\n * @module ol/geom/flat/straightchunk\n */\n\n\n/**\n * @param {number} maxAngle Maximum acceptable angle delta between segments.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {Array.<number>} Start and end of the first suitable chunk of the\n * given `flatCoordinates`.\n */\nexport function matchingChunk(maxAngle, flatCoordinates, offset, end, stride) {\n  let chunkStart = offset;\n  let chunkEnd = offset;\n  let chunkM = 0;\n  let m = 0;\n  let start = offset;\n  let acos, i, m12, m23, x1, y1, x12, y12, x23, y23;\n  for (i = offset; i < end; i += stride) {\n    const x2 = flatCoordinates[i];\n    const y2 = flatCoordinates[i + 1];\n    if (x1 !== undefined) {\n      x23 = x2 - x1;\n      y23 = y2 - y1;\n      m23 = Math.sqrt(x23 * x23 + y23 * y23);\n      if (x12 !== undefined) {\n        m += m12;\n        acos = Math.acos((x12 * x23 + y12 * y23) / (m12 * m23));\n        if (acos > maxAngle) {\n          if (m > chunkM) {\n            chunkM = m;\n            chunkStart = start;\n            chunkEnd = i;\n          }\n          m = 0;\n          start = i - stride;\n        }\n      }\n      m12 = m23;\n      x12 = x23;\n      y12 = y23;\n    }\n    x1 = x2;\n    y1 = y2;\n  }\n  m += m23;\n  return m > chunkM ? [start, i] : [chunkStart, chunkEnd];\n}\n","/**\n * @module ol/render/canvas/TextReplay\n */\nimport {getUid, inherits} from '../../util.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {intersects} from '../../extent.js';\nimport {matchingChunk} from '../../geom/flat/straightchunk.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {CANVAS_LINE_DASH} from '../../has.js';\nimport {labelCache, measureTextWidth, defaultTextAlign, measureTextHeight, defaultPadding, defaultLineCap, defaultLineDashOffset, defaultLineDash, defaultLineJoin, defaultFillStyle, checkFont, defaultFont, defaultLineWidth, defaultMiterLimit, defaultStrokeStyle, defaultTextBaseline} from '../canvas.js';\nimport CanvasInstruction from '../canvas/Instruction.js';\nimport CanvasReplay from '../canvas/Replay.js';\nimport {TEXT_ALIGN} from '../replay.js';\nimport TextPlacement from '../../style/TextPlacement.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/canvas/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Maximum extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay can have overlapping geometries.\n * @param {?} declutterTree Declutter tree.\n * @struct\n */\nconst CanvasTextReplay = function(\n  tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\n  CanvasReplay.call(this,\n    tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree);\n\n  /**\n   * @private\n   * @type {module:ol/render/canvas~DeclutterGroup}\n   */\n  this.declutterGroup_;\n\n  /**\n   * @private\n   * @type {Array.<HTMLCanvasElement>}\n   */\n  this.labels_ = null;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.text_ = '';\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textOffsetX_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textOffsetY_ = 0;\n\n  /**\n   * @private\n   * @type {boolean|undefined}\n   */\n  this.textRotateWithView_ = undefined;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textRotation_ = 0;\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~FillState}\n   */\n  this.textFillState_ = null;\n\n  /**\n   * @type {!Object.<string, module:ol/render/canvas~FillState>}\n   */\n  this.fillStates = {};\n\n  /**\n   * @private\n   * @type {?module:ol/render/canvas~StrokeState}\n   */\n  this.textStrokeState_ = null;\n\n  /**\n   * @type {!Object.<string, module:ol/render/canvas~StrokeState>}\n   */\n  this.strokeStates = {};\n\n  /**\n   * @private\n   * @type {module:ol/render/canvas~TextState}\n   */\n  this.textState_ = /** @type {module:ol/render/canvas~TextState} */ ({});\n\n  /**\n   * @type {!Object.<string, module:ol/render/canvas~TextState>}\n   */\n  this.textStates = {};\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.textKey_ = '';\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.fillKey_ = '';\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.strokeKey_ = '';\n\n  /**\n   * @private\n   * @type {Object.<string, Object.<string, number>>}\n   */\n  this.widths_ = {};\n\n  labelCache.prune();\n\n};\n\ninherits(CanvasTextReplay, CanvasReplay);\n\n\n/**\n * @param {string} font Font to use for measuring.\n * @param {Array.<string>} lines Lines to measure.\n * @param {Array.<number>} widths Array will be populated with the widths of\n * each line.\n * @return {number} Width of the whole text.\n */\nexport function measureTextWidths(font, lines, widths) {\n  const numLines = lines.length;\n  let width = 0;\n  for (let i = 0; i < numLines; ++i) {\n    const currentWidth = measureTextWidth(font, lines[i]);\n    width = Math.max(width, currentWidth);\n    widths.push(currentWidth);\n  }\n  return width;\n}\n\n\n/**\n * @inheritDoc\n */\nCanvasTextReplay.prototype.drawText = function(geometry, feature) {\n  const fillState = this.textFillState_;\n  const strokeState = this.textStrokeState_;\n  const textState = this.textState_;\n  if (this.text_ === '' || !textState || (!fillState && !strokeState)) {\n    return;\n  }\n\n  let begin = this.coordinates.length;\n\n  const geometryType = geometry.getType();\n  let flatCoordinates = null;\n  let end = 2;\n  let stride = 2;\n  let i, ii;\n\n  if (textState.placement === TextPlacement.LINE) {\n    if (!intersects(this.getBufferedMaxExtent(), geometry.getExtent())) {\n      return;\n    }\n    let ends;\n    flatCoordinates = geometry.getFlatCoordinates();\n    stride = geometry.getStride();\n    if (geometryType == GeometryType.LINE_STRING) {\n      ends = [flatCoordinates.length];\n    } else if (geometryType == GeometryType.MULTI_LINE_STRING) {\n      ends = geometry.getEnds();\n    } else if (geometryType == GeometryType.POLYGON) {\n      ends = geometry.getEnds().slice(0, 1);\n    } else if (geometryType == GeometryType.MULTI_POLYGON) {\n      const endss = geometry.getEndss();\n      ends = [];\n      for (i = 0, ii = endss.length; i < ii; ++i) {\n        ends.push(endss[i][0]);\n      }\n    }\n    this.beginGeometry(geometry, feature);\n    const textAlign = textState.textAlign;\n    let flatOffset = 0;\n    let flatEnd;\n    for (let o = 0, oo = ends.length; o < oo; ++o) {\n      if (textAlign == undefined) {\n        const range = matchingChunk(textState.maxAngle, flatCoordinates, flatOffset, ends[o], stride);\n        flatOffset = range[0];\n        flatEnd = range[1];\n      } else {\n        flatEnd = ends[o];\n      }\n      for (i = flatOffset; i < flatEnd; i += stride) {\n        this.coordinates.push(flatCoordinates[i], flatCoordinates[i + 1]);\n      }\n      end = this.coordinates.length;\n      flatOffset = ends[o];\n      this.drawChars_(begin, end, this.declutterGroup_);\n      begin = end;\n    }\n    this.endGeometry(geometry, feature);\n\n  } else {\n    const label = this.getImage(this.text_, this.textKey_, this.fillKey_, this.strokeKey_);\n    const width = label.width / this.pixelRatio;\n    switch (geometryType) {\n      case GeometryType.POINT:\n      case GeometryType.MULTI_POINT:\n        flatCoordinates = geometry.getFlatCoordinates();\n        end = flatCoordinates.length;\n        break;\n      case GeometryType.LINE_STRING:\n        flatCoordinates = /** @type {module:ol/geom/LineString} */ (geometry).getFlatMidpoint();\n        break;\n      case GeometryType.CIRCLE:\n        flatCoordinates = /** @type {module:ol/geom/Circle} */ (geometry).getCenter();\n        break;\n      case GeometryType.MULTI_LINE_STRING:\n        flatCoordinates = /** @type {module:ol/geom/MultiLineString} */ (geometry).getFlatMidpoints();\n        end = flatCoordinates.length;\n        break;\n      case GeometryType.POLYGON:\n        flatCoordinates = /** @type {module:ol/geom/Polygon} */ (geometry).getFlatInteriorPoint();\n        if (!textState.overflow && flatCoordinates[2] / this.resolution < width) {\n          return;\n        }\n        stride = 3;\n        break;\n      case GeometryType.MULTI_POLYGON:\n        const interiorPoints = /** @type {module:ol/geom/MultiPolygon} */ (geometry).getFlatInteriorPoints();\n        flatCoordinates = [];\n        for (i = 0, ii = interiorPoints.length; i < ii; i += 3) {\n          if (textState.overflow || interiorPoints[i + 2] / this.resolution >= width) {\n            flatCoordinates.push(interiorPoints[i], interiorPoints[i + 1]);\n          }\n        }\n        end = flatCoordinates.length;\n        if (end == 0) {\n          return;\n        }\n        break;\n      default:\n    }\n    end = this.appendFlatCoordinates(flatCoordinates, 0, end, stride, false, false);\n    if (textState.backgroundFill || textState.backgroundStroke) {\n      this.setFillStrokeStyle(textState.backgroundFill, textState.backgroundStroke);\n      if (textState.backgroundFill) {\n        this.updateFillStyle(this.state, this.createFill, geometry);\n        this.hitDetectionInstructions.push(this.createFill(this.state, geometry));\n      }\n      if (textState.backgroundStroke) {\n        this.updateStrokeStyle(this.state, this.applyStroke);\n        this.hitDetectionInstructions.push(this.createStroke(this.state));\n      }\n    }\n    this.beginGeometry(geometry, feature);\n    this.drawTextImage_(label, begin, end);\n    this.endGeometry(geometry, feature);\n  }\n};\n\n\n/**\n * @param {string} text Text.\n * @param {string} textKey Text style key.\n * @param {string} fillKey Fill style key.\n * @param {string} strokeKey Stroke style key.\n * @return {HTMLCanvasElement} Image.\n */\nCanvasTextReplay.prototype.getImage = function(text, textKey, fillKey, strokeKey) {\n  let label;\n  const key = strokeKey + textKey + text + fillKey + this.pixelRatio;\n\n  if (!labelCache.containsKey(key)) {\n    const strokeState = strokeKey ? this.strokeStates[strokeKey] || this.textStrokeState_ : null;\n    const fillState = fillKey ? this.fillStates[fillKey] || this.textFillState_ : null;\n    const textState = this.textStates[textKey] || this.textState_;\n    const pixelRatio = this.pixelRatio;\n    const scale = textState.scale * pixelRatio;\n    const align =  TEXT_ALIGN[textState.textAlign || defaultTextAlign];\n    const strokeWidth = strokeKey && strokeState.lineWidth ? strokeState.lineWidth : 0;\n\n    const lines = text.split('\\n');\n    const numLines = lines.length;\n    const widths = [];\n    const width = measureTextWidths(textState.font, lines, widths);\n    const lineHeight = measureTextHeight(textState.font);\n    const height = lineHeight * numLines;\n    const renderWidth = (width + strokeWidth);\n    const context = createCanvasContext2D(\n      Math.ceil(renderWidth * scale),\n      Math.ceil((height + strokeWidth) * scale));\n    label = context.canvas;\n    labelCache.set(key, label);\n    if (scale != 1) {\n      context.scale(scale, scale);\n    }\n    context.font = textState.font;\n    if (strokeKey) {\n      context.strokeStyle = strokeState.strokeStyle;\n      context.lineWidth = strokeWidth;\n      context.lineCap = strokeState.lineCap;\n      context.lineJoin = strokeState.lineJoin;\n      context.miterLimit = strokeState.miterLimit;\n      if (CANVAS_LINE_DASH && strokeState.lineDash.length) {\n        context.setLineDash(strokeState.lineDash);\n        context.lineDashOffset = strokeState.lineDashOffset;\n      }\n    }\n    if (fillKey) {\n      context.fillStyle = fillState.fillStyle;\n    }\n    context.textBaseline = 'middle';\n    context.textAlign = 'center';\n    const leftRight = (0.5 - align);\n    const x = align * label.width / scale + leftRight * strokeWidth;\n    let i;\n    if (strokeKey) {\n      for (i = 0; i < numLines; ++i) {\n        context.strokeText(lines[i], x + leftRight * widths[i], 0.5 * (strokeWidth + lineHeight) + i * lineHeight);\n      }\n    }\n    if (fillKey) {\n      for (i = 0; i < numLines; ++i) {\n        context.fillText(lines[i], x + leftRight * widths[i], 0.5 * (strokeWidth + lineHeight) + i * lineHeight);\n      }\n    }\n  }\n  return labelCache.get(key);\n};\n\n\n/**\n * @private\n * @param {HTMLCanvasElement} label Label.\n * @param {number} begin Begin.\n * @param {number} end End.\n */\nCanvasTextReplay.prototype.drawTextImage_ = function(label, begin, end) {\n  const textState = this.textState_;\n  const strokeState = this.textStrokeState_;\n  const pixelRatio = this.pixelRatio;\n  const align = TEXT_ALIGN[textState.textAlign || defaultTextAlign];\n  const baseline = TEXT_ALIGN[textState.textBaseline];\n  const strokeWidth = strokeState && strokeState.lineWidth ? strokeState.lineWidth : 0;\n\n  const anchorX = align * label.width / pixelRatio + 2 * (0.5 - align) * strokeWidth;\n  const anchorY = baseline * label.height / pixelRatio + 2 * (0.5 - baseline) * strokeWidth;\n  this.instructions.push([CanvasInstruction.DRAW_IMAGE, begin, end,\n    label, (anchorX - this.textOffsetX_) * pixelRatio, (anchorY - this.textOffsetY_) * pixelRatio,\n    this.declutterGroup_, label.height, 1, 0, 0, this.textRotateWithView_, this.textRotation_,\n    1, true, label.width,\n    textState.padding == defaultPadding ?\n      defaultPadding : textState.padding.map(function(p) {\n        return p * pixelRatio;\n      }),\n    !!textState.backgroundFill, !!textState.backgroundStroke\n  ]);\n  this.hitDetectionInstructions.push([CanvasInstruction.DRAW_IMAGE, begin, end,\n    label, (anchorX - this.textOffsetX_) * pixelRatio, (anchorY - this.textOffsetY_) * pixelRatio,\n    this.declutterGroup_, label.height, 1, 0, 0, this.textRotateWithView_, this.textRotation_,\n    1 / pixelRatio, true, label.width, textState.padding,\n    !!textState.backgroundFill, !!textState.backgroundStroke\n  ]);\n};\n\n\n/**\n * @private\n * @param {number} begin Begin.\n * @param {number} end End.\n * @param {module:ol/render/canvas~DeclutterGroup} declutterGroup Declutter group.\n */\nCanvasTextReplay.prototype.drawChars_ = function(begin, end, declutterGroup) {\n  const strokeState = this.textStrokeState_;\n  const textState = this.textState_;\n  const fillState = this.textFillState_;\n\n  const strokeKey = this.strokeKey_;\n  if (strokeState) {\n    if (!(strokeKey in this.strokeStates)) {\n      this.strokeStates[strokeKey] = /** @type {module:ol/render/canvas~StrokeState} */ ({\n        strokeStyle: strokeState.strokeStyle,\n        lineCap: strokeState.lineCap,\n        lineDashOffset: strokeState.lineDashOffset,\n        lineWidth: strokeState.lineWidth,\n        lineJoin: strokeState.lineJoin,\n        miterLimit: strokeState.miterLimit,\n        lineDash: strokeState.lineDash\n      });\n    }\n  }\n  const textKey = this.textKey_;\n  if (!(this.textKey_ in this.textStates)) {\n    this.textStates[this.textKey_] = /** @type {module:ol/render/canvas~TextState} */ ({\n      font: textState.font,\n      textAlign: textState.textAlign || defaultTextAlign,\n      scale: textState.scale\n    });\n  }\n  const fillKey = this.fillKey_;\n  if (fillState) {\n    if (!(fillKey in this.fillStates)) {\n      this.fillStates[fillKey] = /** @type {module:ol/render/canvas~FillState} */ ({\n        fillStyle: fillState.fillStyle\n      });\n    }\n  }\n\n  const pixelRatio = this.pixelRatio;\n  const baseline = TEXT_ALIGN[textState.textBaseline];\n\n  const offsetY = this.textOffsetY_ * pixelRatio;\n  const text = this.text_;\n  const font = textState.font;\n  const textScale = textState.scale;\n  const strokeWidth = strokeState ? strokeState.lineWidth * textScale / 2 : 0;\n  let widths = this.widths_[font];\n  if (!widths) {\n    this.widths_[font] = widths = {};\n  }\n  this.instructions.push([CanvasInstruction.DRAW_CHARS,\n    begin, end, baseline, declutterGroup,\n    textState.overflow, fillKey, textState.maxAngle,\n    function(text) {\n      let width = widths[text];\n      if (!width) {\n        width = widths[text] = measureTextWidth(font, text);\n      }\n      return width * textScale * pixelRatio;\n    },\n    offsetY, strokeKey, strokeWidth * pixelRatio, text, textKey, 1\n  ]);\n  this.hitDetectionInstructions.push([CanvasInstruction.DRAW_CHARS,\n    begin, end, baseline, declutterGroup,\n    textState.overflow, fillKey, textState.maxAngle,\n    function(text) {\n      let width = widths[text];\n      if (!width) {\n        width = widths[text] = measureTextWidth(font, text);\n      }\n      return width * textScale;\n    },\n    offsetY, strokeKey, strokeWidth, text, textKey, 1 / pixelRatio\n  ]);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasTextReplay.prototype.setTextStyle = function(textStyle, declutterGroup) {\n  let textState, fillState, strokeState;\n  if (!textStyle) {\n    this.text_ = '';\n  } else {\n    this.declutterGroup_ = /** @type {module:ol/render/canvas~DeclutterGroup} */ (declutterGroup);\n\n    const textFillStyle = textStyle.getFill();\n    if (!textFillStyle) {\n      fillState = this.textFillState_ = null;\n    } else {\n      fillState = this.textFillState_;\n      if (!fillState) {\n        fillState = this.textFillState_ = /** @type {module:ol/render/canvas~FillState} */ ({});\n      }\n      fillState.fillStyle = asColorLike(\n        textFillStyle.getColor() || defaultFillStyle);\n    }\n\n    const textStrokeStyle = textStyle.getStroke();\n    if (!textStrokeStyle) {\n      strokeState = this.textStrokeState_ = null;\n    } else {\n      strokeState = this.textStrokeState_;\n      if (!strokeState) {\n        strokeState = this.textStrokeState_ = /** @type {module:ol/render/canvas~StrokeState} */ ({});\n      }\n      const lineDash = textStrokeStyle.getLineDash();\n      const lineDashOffset = textStrokeStyle.getLineDashOffset();\n      const lineWidth = textStrokeStyle.getWidth();\n      const miterLimit = textStrokeStyle.getMiterLimit();\n      strokeState.lineCap = textStrokeStyle.getLineCap() || defaultLineCap;\n      strokeState.lineDash = lineDash ? lineDash.slice() : defaultLineDash;\n      strokeState.lineDashOffset =\n          lineDashOffset === undefined ? defaultLineDashOffset : lineDashOffset;\n      strokeState.lineJoin = textStrokeStyle.getLineJoin() || defaultLineJoin;\n      strokeState.lineWidth =\n          lineWidth === undefined ? defaultLineWidth : lineWidth;\n      strokeState.miterLimit =\n          miterLimit === undefined ? defaultMiterLimit : miterLimit;\n      strokeState.strokeStyle = asColorLike(\n        textStrokeStyle.getColor() || defaultStrokeStyle);\n    }\n\n    textState = this.textState_;\n    const font = textStyle.getFont() || defaultFont;\n    checkFont(font);\n    const textScale = textStyle.getScale();\n    textState.overflow = textStyle.getOverflow();\n    textState.font = font;\n    textState.maxAngle = textStyle.getMaxAngle();\n    textState.placement = textStyle.getPlacement();\n    textState.textAlign = textStyle.getTextAlign();\n    textState.textBaseline = textStyle.getTextBaseline() || defaultTextBaseline;\n    textState.backgroundFill = textStyle.getBackgroundFill();\n    textState.backgroundStroke = textStyle.getBackgroundStroke();\n    textState.padding = textStyle.getPadding() || defaultPadding;\n    textState.scale = textScale === undefined ? 1 : textScale;\n\n    const textOffsetX = textStyle.getOffsetX();\n    const textOffsetY = textStyle.getOffsetY();\n    const textRotateWithView = textStyle.getRotateWithView();\n    const textRotation = textStyle.getRotation();\n    this.text_ = textStyle.getText() || '';\n    this.textOffsetX_ = textOffsetX === undefined ? 0 : textOffsetX;\n    this.textOffsetY_ = textOffsetY === undefined ? 0 : textOffsetY;\n    this.textRotateWithView_ = textRotateWithView === undefined ? false : textRotateWithView;\n    this.textRotation_ = textRotation === undefined ? 0 : textRotation;\n\n    this.strokeKey_ = strokeState ?\n      (typeof strokeState.strokeStyle == 'string' ? strokeState.strokeStyle : getUid(strokeState.strokeStyle)) +\n      strokeState.lineCap + strokeState.lineDashOffset + '|' + strokeState.lineWidth +\n      strokeState.lineJoin + strokeState.miterLimit + '[' + strokeState.lineDash.join() + ']' :\n      '';\n    this.textKey_ = textState.font + textState.scale + (textState.textAlign || '?');\n    this.fillKey_ = fillState ?\n      (typeof fillState.fillStyle == 'string' ? fillState.fillStyle : ('|' + getUid(fillState.fillStyle))) :\n      '';\n  }\n};\nexport default CanvasTextReplay;\n","/**\n * @module ol/render/canvas/ReplayGroup\n */\nimport {inherits} from '../../util.js';\nimport {numberSafeCompareFunction} from '../../array.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {buffer, createEmpty, extendCoordinate} from '../../extent.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {isEmpty} from '../../obj.js';\nimport ReplayGroup from '../ReplayGroup.js';\nimport ReplayType from '../ReplayType.js';\nimport CanvasReplay from '../canvas/Replay.js';\nimport CanvasImageReplay from '../canvas/ImageReplay.js';\nimport CanvasLineStringReplay from '../canvas/LineStringReplay.js';\nimport CanvasPolygonReplay from '../canvas/PolygonReplay.js';\nimport CanvasTextReplay from '../canvas/TextReplay.js';\nimport {ORDER} from '../replay.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n\n/**\n * @type {Object.<module:ol/render/ReplayType,\n *                function(new: module:ol/render/canvas/Replay, number, module:ol/extent~Extent,\n *                number, number, boolean, Array.<module:ol/render/canvas~DeclutterGroup>)>}\n */\nconst BATCH_CONSTRUCTORS = {\n  'Circle': CanvasPolygonReplay,\n  'Default': CanvasReplay,\n  'Image': CanvasImageReplay,\n  'LineString': CanvasLineStringReplay,\n  'Polygon': CanvasPolygonReplay,\n  'Text': CanvasTextReplay\n};\n\n\n/**\n * @constructor\n * @extends {module:ol/render/ReplayGroup}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {boolean} overlaps The replay group can have overlapping geometries.\n * @param {?} declutterTree Declutter tree\n * for declutter processing in postrender.\n * @param {number=} opt_renderBuffer Optional rendering buffer.\n * @struct\n */\nconst CanvasReplayGroup = function(\n  tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree, opt_renderBuffer) {\n  ReplayGroup.call(this);\n\n  /**\n   * Declutter tree.\n   * @private\n   */\n  this.declutterTree_ = declutterTree;\n\n  /**\n   * @type {module:ol/render/canvas~DeclutterGroup}\n   * @private\n   */\n  this.declutterGroup_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.tolerance_ = tolerance;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.maxExtent_ = maxExtent;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.overlaps_ = overlaps;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelRatio_ = pixelRatio;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.resolution_ = resolution;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.renderBuffer_ = opt_renderBuffer;\n\n  /**\n   * @private\n   * @type {!Object.<string, !Object.<module:ol/render/ReplayType, module:ol/render/canvas/Replay>>}\n   */\n  this.replaysByZIndex_ = {};\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.hitDetectionContext_ = createCanvasContext2D(1, 1);\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.hitDetectionTransform_ = createTransform();\n};\n\ninherits(CanvasReplayGroup, ReplayGroup);\n\n\n/**\n * This cache is used for storing calculated pixel circles for increasing performance.\n * It is a static property to allow each Replaygroup to access it.\n * @type {Object.<number, Array.<Array.<(boolean|undefined)>>>}\n */\nconst circleArrayCache = {\n  0: [[true]]\n};\n\n\n/**\n * This method fills a row in the array from the given coordinate to the\n * middle with `true`.\n * @param {Array.<Array.<(boolean|undefined)>>} array The array that will be altered.\n * @param {number} x X coordinate.\n * @param {number} y Y coordinate.\n */\nfunction fillCircleArrayRowToMiddle(array, x, y) {\n  let i;\n  const radius = Math.floor(array.length / 2);\n  if (x >= radius) {\n    for (i = radius; i < x; i++) {\n      array[i][y] = true;\n    }\n  } else if (x < radius) {\n    for (i = x + 1; i < radius; i++) {\n      array[i][y] = true;\n    }\n  }\n}\n\n\n/**\n * This methods creates a circle inside a fitting array. Points inside the\n * circle are marked by true, points on the outside are undefined.\n * It uses the midpoint circle algorithm.\n * A cache is used to increase performance.\n * @param {number} radius Radius.\n * @returns {Array.<Array.<(boolean|undefined)>>} An array with marked circle points.\n */\nexport function getCircleArray(radius) {\n  if (circleArrayCache[radius] !== undefined) {\n    return circleArrayCache[radius];\n  }\n\n  const arraySize = radius * 2 + 1;\n  const arr = new Array(arraySize);\n  for (let i = 0; i < arraySize; i++) {\n    arr[i] = new Array(arraySize);\n  }\n\n  let x = radius;\n  let y = 0;\n  let error = 0;\n\n  while (x >= y) {\n    fillCircleArrayRowToMiddle(arr, radius + x, radius + y);\n    fillCircleArrayRowToMiddle(arr, radius + y, radius + x);\n    fillCircleArrayRowToMiddle(arr, radius - y, radius + x);\n    fillCircleArrayRowToMiddle(arr, radius - x, radius + y);\n    fillCircleArrayRowToMiddle(arr, radius - x, radius - y);\n    fillCircleArrayRowToMiddle(arr, radius - y, radius - x);\n    fillCircleArrayRowToMiddle(arr, radius + y, radius - x);\n    fillCircleArrayRowToMiddle(arr, radius + x, radius - y);\n\n    y++;\n    error += 1 + 2 * y;\n    if (2 * (error - x) + 1 > 0) {\n      x -= 1;\n      error += 1 - 2 * x;\n    }\n  }\n\n  circleArrayCache[radius] = arr;\n  return arr;\n}\n\n\n/**\n * @param {!Object.<string, Array.<*>>} declutterReplays Declutter replays.\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} rotation Rotation.\n */\nexport function replayDeclutter(declutterReplays, context, rotation) {\n  const zs = Object.keys(declutterReplays).map(Number).sort(numberSafeCompareFunction);\n  const skippedFeatureUids = {};\n  for (let z = 0, zz = zs.length; z < zz; ++z) {\n    const replayData = declutterReplays[zs[z].toString()];\n    for (let i = 0, ii = replayData.length; i < ii;) {\n      const replay = replayData[i++];\n      const transform = replayData[i++];\n      replay.replay(context, transform, rotation, skippedFeatureUids);\n    }\n  }\n}\n\n\n/**\n * @param {boolean} group Group with previous replay.\n * @return {module:ol/render/canvas~DeclutterGroup} Declutter instruction group.\n */\nCanvasReplayGroup.prototype.addDeclutter = function(group) {\n  let declutter = null;\n  if (this.declutterTree_) {\n    if (group) {\n      declutter = this.declutterGroup_;\n      /** @type {number} */ (declutter[4])++;\n    } else {\n      declutter = this.declutterGroup_ = createEmpty();\n      declutter.push(1);\n    }\n  }\n  return declutter;\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform} transform Transform.\n */\nCanvasReplayGroup.prototype.clip = function(context, transform) {\n  const flatClipCoords = this.getClipCoords(transform);\n  context.beginPath();\n  context.moveTo(flatClipCoords[0], flatClipCoords[1]);\n  context.lineTo(flatClipCoords[2], flatClipCoords[3]);\n  context.lineTo(flatClipCoords[4], flatClipCoords[5]);\n  context.lineTo(flatClipCoords[6], flatClipCoords[7]);\n  context.clip();\n};\n\n\n/**\n * @param {Array.<module:ol/render/ReplayType>} replays Replays.\n * @return {boolean} Has replays of the provided types.\n */\nCanvasReplayGroup.prototype.hasReplays = function(replays) {\n  for (const zIndex in this.replaysByZIndex_) {\n    const candidates = this.replaysByZIndex_[zIndex];\n    for (let i = 0, ii = replays.length; i < ii; ++i) {\n      if (replays[i] in candidates) {\n        return true;\n      }\n    }\n  }\n  return false;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nCanvasReplayGroup.prototype.finish = function() {\n  for (const zKey in this.replaysByZIndex_) {\n    const replays = this.replaysByZIndex_[zKey];\n    for (const replayKey in replays) {\n      replays[replayKey].finish();\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {number} hitTolerance Hit tolerance in pixels.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T} callback Feature callback.\n * @param {Object.<string, module:ol/render/canvas~DeclutterGroup>} declutterReplays Declutter replays.\n * @return {T|undefined} Callback result.\n * @template T\n */\nCanvasReplayGroup.prototype.forEachFeatureAtCoordinate = function(\n  coordinate, resolution, rotation, hitTolerance, skippedFeaturesHash, callback, declutterReplays) {\n\n  hitTolerance = Math.round(hitTolerance);\n  const contextSize = hitTolerance * 2 + 1;\n  const transform = composeTransform(this.hitDetectionTransform_,\n    hitTolerance + 0.5, hitTolerance + 0.5,\n    1 / resolution, -1 / resolution,\n    -rotation,\n    -coordinate[0], -coordinate[1]);\n  const context = this.hitDetectionContext_;\n\n  if (context.canvas.width !== contextSize || context.canvas.height !== contextSize) {\n    context.canvas.width = contextSize;\n    context.canvas.height = contextSize;\n  } else {\n    context.clearRect(0, 0, contextSize, contextSize);\n  }\n\n  /**\n   * @type {module:ol/extent~Extent}\n   */\n  let hitExtent;\n  if (this.renderBuffer_ !== undefined) {\n    hitExtent = createEmpty();\n    extendCoordinate(hitExtent, coordinate);\n    buffer(hitExtent, resolution * (this.renderBuffer_ + hitTolerance), hitExtent);\n  }\n\n  const mask = getCircleArray(hitTolerance);\n  let declutteredFeatures;\n  if (this.declutterTree_) {\n    declutteredFeatures = this.declutterTree_.all().map(function(entry) {\n      return entry.value;\n    });\n  }\n\n  let replayType;\n\n  /**\n   * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n   * @return {?} Callback result.\n   */\n  function featureCallback(feature) {\n    const imageData = context.getImageData(0, 0, contextSize, contextSize).data;\n    for (let i = 0; i < contextSize; i++) {\n      for (let j = 0; j < contextSize; j++) {\n        if (mask[i][j]) {\n          if (imageData[(j * contextSize + i) * 4 + 3] > 0) {\n            let result;\n            if (!(declutteredFeatures && (replayType == ReplayType.IMAGE || replayType == ReplayType.TEXT)) ||\n                declutteredFeatures.indexOf(feature) !== -1) {\n              result = callback(feature);\n            }\n            if (result) {\n              return result;\n            } else {\n              context.clearRect(0, 0, contextSize, contextSize);\n              return undefined;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  /** @type {Array.<number>} */\n  const zs = Object.keys(this.replaysByZIndex_).map(Number);\n  zs.sort(numberSafeCompareFunction);\n\n  let i, j, replays, replay, result;\n  for (i = zs.length - 1; i >= 0; --i) {\n    const zIndexKey = zs[i].toString();\n    replays = this.replaysByZIndex_[zIndexKey];\n    for (j = ORDER.length - 1; j >= 0; --j) {\n      replayType = ORDER[j];\n      replay = replays[replayType];\n      if (replay !== undefined) {\n        if (declutterReplays &&\n            (replayType == ReplayType.IMAGE || replayType == ReplayType.TEXT)) {\n          const declutter = declutterReplays[zIndexKey];\n          if (!declutter) {\n            declutterReplays[zIndexKey] = [replay, transform.slice(0)];\n          } else {\n            declutter.push(replay, transform.slice(0));\n          }\n        } else {\n          result = replay.replayHitDetection(context, transform, rotation,\n            skippedFeaturesHash, featureCallback, hitExtent);\n          if (result) {\n            return result;\n          }\n        }\n      }\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @param {module:ol/transform~Transform} transform Transform.\n * @return {Array.<number>} Clip coordinates.\n */\nCanvasReplayGroup.prototype.getClipCoords = function(transform) {\n  const maxExtent = this.maxExtent_;\n  const minX = maxExtent[0];\n  const minY = maxExtent[1];\n  const maxX = maxExtent[2];\n  const maxY = maxExtent[3];\n  const flatClipCoords = [minX, minY, minX, maxY, maxX, maxY, maxX, minY];\n  transform2D(\n    flatClipCoords, 0, 8, 2, transform, flatClipCoords);\n  return flatClipCoords;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasReplayGroup.prototype.getReplay = function(zIndex, replayType) {\n  const zIndexKey = zIndex !== undefined ? zIndex.toString() : '0';\n  let replays = this.replaysByZIndex_[zIndexKey];\n  if (replays === undefined) {\n    replays = {};\n    this.replaysByZIndex_[zIndexKey] = replays;\n  }\n  let replay = replays[replayType];\n  if (replay === undefined) {\n    const Constructor = BATCH_CONSTRUCTORS[replayType];\n    replay = new Constructor(this.tolerance_, this.maxExtent_,\n      this.resolution_, this.pixelRatio_, this.overlaps_, this.declutterTree_);\n    replays[replayType] = replay;\n  }\n  return replay;\n};\n\n\n/**\n * @return {Object.<string, Object.<module:ol/render/ReplayType, module:ol/render/canvas/Replay>>} Replays.\n */\nCanvasReplayGroup.prototype.getReplays = function() {\n  return this.replaysByZIndex_;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasReplayGroup.prototype.isEmpty = function() {\n  return isEmpty(this.replaysByZIndex_);\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/transform~Transform} transform Transform.\n * @param {number} viewRotation View rotation.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {Array.<module:ol/render/ReplayType>=} opt_replayTypes Ordered replay types to replay.\n *     Default is {@link module:ol/render/replay~ORDER}\n * @param {Object.<string, module:ol/render/canvas~DeclutterGroup>=} opt_declutterReplays Declutter replays.\n */\nCanvasReplayGroup.prototype.replay = function(context,\n  transform, viewRotation, skippedFeaturesHash, opt_replayTypes, opt_declutterReplays) {\n\n  /** @type {Array.<number>} */\n  const zs = Object.keys(this.replaysByZIndex_).map(Number);\n  zs.sort(numberSafeCompareFunction);\n\n  // setup clipping so that the parts of over-simplified geometries are not\n  // visible outside the current extent when panning\n  context.save();\n  this.clip(context, transform);\n\n  const replayTypes = opt_replayTypes ? opt_replayTypes : ORDER;\n  let i, ii, j, jj, replays, replay;\n  for (i = 0, ii = zs.length; i < ii; ++i) {\n    const zIndexKey = zs[i].toString();\n    replays = this.replaysByZIndex_[zIndexKey];\n    for (j = 0, jj = replayTypes.length; j < jj; ++j) {\n      const replayType = replayTypes[j];\n      replay = replays[replayType];\n      if (replay !== undefined) {\n        if (opt_declutterReplays &&\n            (replayType == ReplayType.IMAGE || replayType == ReplayType.TEXT)) {\n          const declutter = opt_declutterReplays[zIndexKey];\n          if (!declutter) {\n            opt_declutterReplays[zIndexKey] = [replay, transform.slice(0)];\n          } else {\n            declutter.push(replay, transform.slice(0));\n          }\n        } else {\n          replay.replay(context, transform, viewRotation, skippedFeaturesHash);\n        }\n      }\n    }\n  }\n\n  context.restore();\n};\n\nexport default CanvasReplayGroup;\n","/**\n * @module ol/renderer/vector\n */\nimport {getUid} from '../util.js';\nimport ImageState from '../ImageState.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport ReplayType from '../render/ReplayType.js';\n\n\n/**\n * Tolerance for geometry simplification in device pixels.\n * @type {number}\n */\nconst SIMPLIFY_TOLERANCE = 0.5;\n\n\n/**\n * @const\n * @type {Object.<module:ol/geom/GeometryType,\n *                function(module:ol/render/ReplayGroup, module:ol/geom/Geometry,\n *                         module:ol/style/Style, Object)>}\n */\nconst GEOMETRY_RENDERERS = {\n  'Point': renderPointGeometry,\n  'LineString': renderLineStringGeometry,\n  'Polygon': renderPolygonGeometry,\n  'MultiPoint': renderMultiPointGeometry,\n  'MultiLineString': renderMultiLineStringGeometry,\n  'MultiPolygon': renderMultiPolygonGeometry,\n  'GeometryCollection': renderGeometryCollectionGeometry,\n  'Circle': renderCircleGeometry\n};\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature1 Feature 1.\n * @param {module:ol/Feature|module:ol/render/Feature} feature2 Feature 2.\n * @return {number} Order.\n */\nexport function defaultOrder(feature1, feature2) {\n  return getUid(feature1) - getUid(feature2);\n}\n\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Squared pixel tolerance.\n */\nexport function getSquaredTolerance(resolution, pixelRatio) {\n  const tolerance = getTolerance(resolution, pixelRatio);\n  return tolerance * tolerance;\n}\n\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Pixel tolerance.\n */\nexport function getTolerance(resolution, pixelRatio) {\n  return SIMPLIFY_TOLERANCE * resolution / pixelRatio;\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/Circle} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature} feature Feature.\n */\nfunction renderCircleGeometry(replayGroup, geometry, style, feature) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    const circleReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.CIRCLE);\n    circleReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    circleReplay.drawCircle(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {module:ol/style/Style} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {function(this: T, module:ol/events/Event)} listener Listener function.\n * @param {T} thisArg Value to use as `this` when executing `listener`.\n * @return {boolean} `true` if style is loading.\n * @template T\n */\nexport function renderFeature(replayGroup, feature, style, squaredTolerance, listener, thisArg) {\n  let loading = false;\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    let imageState = imageStyle.getImageState();\n    if (imageState == ImageState.LOADED || imageState == ImageState.ERROR) {\n      imageStyle.unlistenImageChange(listener, thisArg);\n    } else {\n      if (imageState == ImageState.IDLE) {\n        imageStyle.load();\n      }\n      imageState = imageStyle.getImageState();\n      imageStyle.listenImageChange(listener, thisArg);\n      loading = true;\n    }\n  }\n  renderFeatureInternal(replayGroup, feature, style, squaredTolerance);\n\n  return loading;\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {module:ol/style/Style} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n */\nfunction renderFeatureInternal(replayGroup, feature, style, squaredTolerance) {\n  const geometry = style.getGeometryFunction()(feature);\n  if (!geometry) {\n    return;\n  }\n  const simplifiedGeometry = geometry.getSimplifiedGeometry(squaredTolerance);\n  const renderer = style.getRenderer();\n  if (renderer) {\n    renderGeometry(replayGroup, simplifiedGeometry, style, feature);\n  } else {\n    const geometryRenderer = GEOMETRY_RENDERERS[simplifiedGeometry.getType()];\n    geometryRenderer(replayGroup, simplifiedGeometry, style, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/Geometry} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderGeometry(replayGroup, geometry, style, feature) {\n  if (geometry.getType() == GeometryType.GEOMETRY_COLLECTION) {\n    const geometries = /** @type {module:ol/geom/GeometryCollection} */ (geometry).getGeometries();\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      renderGeometry(replayGroup, geometries[i], style, feature);\n    }\n    return;\n  }\n  const replay = replayGroup.getReplay(style.getZIndex(), ReplayType.DEFAULT);\n  replay.drawCustom(/** @type {module:ol/geom/SimpleGeometry} */ (geometry), feature, style.getRenderer());\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/GeometryCollection} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature} feature Feature.\n */\nfunction renderGeometryCollectionGeometry(replayGroup, geometry, style, feature) {\n  const geometries = geometry.getGeometriesArray();\n  let i, ii;\n  for (i = 0, ii = geometries.length; i < ii; ++i) {\n    const geometryRenderer =\n        GEOMETRY_RENDERERS[geometries[i].getType()];\n    geometryRenderer(replayGroup, geometries[i], style, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/LineString|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderLineStringGeometry(replayGroup, geometry, style, feature) {\n  const strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    const lineStringReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.LINE_STRING);\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawLineString(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/MultiLineString|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderMultiLineStringGeometry(replayGroup, geometry, style, feature) {\n  const strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    const lineStringReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.LINE_STRING);\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawMultiLineString(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/MultiPolygon} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature} feature Feature.\n */\nfunction renderMultiPolygonGeometry(replayGroup, geometry, style, feature) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (strokeStyle || fillStyle) {\n    const polygonReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.POLYGON);\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawMultiPolygon(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/Point|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderPointGeometry(replayGroup, geometry, style, feature) {\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    const imageReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.IMAGE);\n    imageReplay.setImageStyle(imageStyle, replayGroup.addDeclutter(false));\n    imageReplay.drawPoint(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(!!imageStyle));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/MultiPoint|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderMultiPointGeometry(replayGroup, geometry, style, feature) {\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    const imageReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.IMAGE);\n    imageReplay.setImageStyle(imageStyle, replayGroup.addDeclutter(false));\n    imageReplay.drawMultiPoint(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(!!imageStyle));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/Polygon|module:ol/render/Feature} geometry Geometry.\n * @param {module:ol/style/Style} style Style.\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n */\nfunction renderPolygonGeometry(replayGroup, geometry, style, feature) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    const polygonReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.POLYGON);\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawPolygon(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n","/**\n * @module ol/renderer/canvas/VectorLayer\n */\nimport {getUid, inherits} from '../../util.js';\nimport LayerType from '../../LayerType.js';\nimport ViewHint from '../../ViewHint.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {listen, unlisten} from '../../events.js';\nimport EventType from '../../events/EventType.js';\nimport rbush from 'rbush';\nimport {buffer, createEmpty, containsExtent, getWidth} from '../../extent.js';\nimport RenderEventType from '../../render/EventType.js';\nimport {labelCache, rotateAtOffset} from '../../render/canvas.js';\nimport CanvasReplayGroup from '../../render/canvas/ReplayGroup.js';\nimport CanvasLayerRenderer from '../canvas/Layer.js';\nimport {defaultOrder as defaultRenderOrder, getTolerance as getRenderTolerance, getSquaredTolerance as getSquaredRenderTolerance, renderFeature} from '../vector.js';\n\n/**\n * @constructor\n * @extends {module:ol/renderer/canvas/Layer}\n * @param {module:ol/layer/Vector} vectorLayer Vector layer.\n * @api\n */\nconst CanvasVectorLayerRenderer = function(vectorLayer) {\n\n  CanvasLayerRenderer.call(this, vectorLayer);\n\n  /**\n   * Declutter tree.\n   * @private\n   */\n  this.declutterTree_ = vectorLayer.getDeclutter() ? rbush(9, undefined) : null;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.dirty_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedRevision_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedResolution_ = NaN;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.renderedExtent_ = createEmpty();\n\n  /**\n   * @private\n   * @type {function(module:ol/Feature, module:ol/Feature): number|null}\n   */\n  this.renderedRenderOrder_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/render/canvas/ReplayGroup}\n   */\n  this.replayGroup_ = null;\n\n  /**\n   * A new replay group had to be created by `prepareFrame()`\n   * @type {boolean}\n   */\n  this.replayGroupChanged = true;\n\n  /**\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context = createCanvasContext2D();\n\n  listen(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n\n};\n\ninherits(CanvasVectorLayerRenderer, CanvasLayerRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasVectorLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.VECTOR;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/canvas/VectorLayer} The layer renderer.\n */\nCanvasVectorLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasVectorLayerRenderer(/** @type {module:ol/layer/Vector} */ (layer));\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorLayerRenderer.prototype.disposeInternal = function() {\n  unlisten(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n  CanvasLayerRenderer.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n */\nCanvasVectorLayerRenderer.prototype.compose = function(context, frameState, layerState) {\n  const extent = frameState.extent;\n  const pixelRatio = frameState.pixelRatio;\n  const skippedFeatureUids = layerState.managed ?\n    frameState.skippedFeatureUids : {};\n  const viewState = frameState.viewState;\n  const projection = viewState.projection;\n  const rotation = viewState.rotation;\n  const projectionExtent = projection.getExtent();\n  const vectorSource = /** @type {module:ol/source/Vector} */ (this.getLayer().getSource());\n\n  let transform = this.getTransform(frameState, 0);\n\n  // clipped rendering if layer extent is set\n  const clipExtent = layerState.extent;\n  const clipped = clipExtent !== undefined;\n  if (clipped) {\n    this.clip(context, frameState,  /** @type {module:ol/extent~Extent} */ (clipExtent));\n  }\n  const replayGroup = this.replayGroup_;\n  if (replayGroup && !replayGroup.isEmpty()) {\n    if (this.declutterTree_) {\n      this.declutterTree_.clear();\n    }\n    const layer = /** @type {module:ol/layer/Vector} */ (this.getLayer());\n    let drawOffsetX = 0;\n    let drawOffsetY = 0;\n    let replayContext;\n    const transparentLayer = layerState.opacity !== 1;\n    const hasRenderListeners = layer.hasListener(RenderEventType.RENDER);\n    if (transparentLayer || hasRenderListeners) {\n      let drawWidth = context.canvas.width;\n      let drawHeight = context.canvas.height;\n      if (rotation) {\n        const drawSize = Math.round(Math.sqrt(drawWidth * drawWidth + drawHeight * drawHeight));\n        drawOffsetX = (drawSize - drawWidth) / 2;\n        drawOffsetY = (drawSize - drawHeight) / 2;\n        drawWidth = drawHeight = drawSize;\n      }\n      // resize and clear\n      this.context.canvas.width = drawWidth;\n      this.context.canvas.height = drawHeight;\n      replayContext = this.context;\n    } else {\n      replayContext = context;\n    }\n\n    const alpha = replayContext.globalAlpha;\n    if (!transparentLayer) {\n      // for performance reasons, context.save / context.restore is not used\n      // to save and restore the transformation matrix and the opacity.\n      // see http://jsperf.com/context-save-restore-versus-variable\n      replayContext.globalAlpha = layerState.opacity;\n    }\n\n    if (replayContext != context) {\n      replayContext.translate(drawOffsetX, drawOffsetY);\n    }\n\n    const width = frameState.size[0] * pixelRatio;\n    const height = frameState.size[1] * pixelRatio;\n    rotateAtOffset(replayContext, -rotation,\n      width / 2, height / 2);\n    replayGroup.replay(replayContext, transform, rotation, skippedFeatureUids);\n    if (vectorSource.getWrapX() && projection.canWrapX() &&\n        !containsExtent(projectionExtent, extent)) {\n      let startX = extent[0];\n      const worldWidth = getWidth(projectionExtent);\n      let world = 0;\n      let offsetX;\n      while (startX < projectionExtent[0]) {\n        --world;\n        offsetX = worldWidth * world;\n        transform = this.getTransform(frameState, offsetX);\n        replayGroup.replay(replayContext, transform, rotation, skippedFeatureUids);\n        startX += worldWidth;\n      }\n      world = 0;\n      startX = extent[2];\n      while (startX > projectionExtent[2]) {\n        ++world;\n        offsetX = worldWidth * world;\n        transform = this.getTransform(frameState, offsetX);\n        replayGroup.replay(replayContext, transform, rotation, skippedFeatureUids);\n        startX -= worldWidth;\n      }\n    }\n    rotateAtOffset(replayContext, rotation,\n      width / 2, height / 2);\n\n    if (replayContext != context) {\n      if (hasRenderListeners) {\n        this.dispatchRenderEvent(replayContext, frameState, transform);\n      }\n      if (transparentLayer) {\n        const mainContextAlpha = context.globalAlpha;\n        context.globalAlpha = layerState.opacity;\n        context.drawImage(replayContext.canvas, -drawOffsetX, -drawOffsetY);\n        context.globalAlpha = mainContextAlpha;\n      } else {\n        context.drawImage(replayContext.canvas, -drawOffsetX, -drawOffsetY);\n      }\n      replayContext.translate(-drawOffsetX, -drawOffsetY);\n    }\n\n    if (!transparentLayer) {\n      replayContext.globalAlpha = alpha;\n    }\n  }\n\n  if (clipped) {\n    context.restore();\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorLayerRenderer.prototype.composeFrame = function(frameState, layerState, context) {\n  const transform = this.getTransform(frameState, 0);\n  this.preCompose(context, frameState, transform);\n  this.compose(context, frameState, layerState);\n  this.postCompose(context, frameState, layerState, transform);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorLayerRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  if (!this.replayGroup_) {\n    return undefined;\n  } else {\n    const resolution = frameState.viewState.resolution;\n    const rotation = frameState.viewState.rotation;\n    const layer = /** @type {module:ol/layer/Vector} */ (this.getLayer());\n    /** @type {!Object.<string, boolean>} */\n    const features = {};\n    const result = this.replayGroup_.forEachFeatureAtCoordinate(coordinate, resolution, rotation, hitTolerance, {},\n      /**\n       * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n       * @return {?} Callback result.\n       */\n      function(feature) {\n        const key = getUid(feature).toString();\n        if (!(key in features)) {\n          features[key] = true;\n          return callback.call(thisArg, feature, layer);\n        }\n      }, null);\n    return result;\n  }\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n */\nCanvasVectorLayerRenderer.prototype.handleFontsChanged_ = function(event) {\n  const layer = this.getLayer();\n  if (layer.getVisible() && this.replayGroup_) {\n    layer.changed();\n  }\n};\n\n\n/**\n * Handle changes in image style state.\n * @param {module:ol/events/Event} event Image style change event.\n * @private\n */\nCanvasVectorLayerRenderer.prototype.handleStyleImageChange_ = function(event) {\n  this.renderIfReadyAndVisible();\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorLayerRenderer.prototype.prepareFrame = function(frameState, layerState) {\n  const vectorLayer = /** @type {module:ol/layer/Vector} */ (this.getLayer());\n  const vectorSource = vectorLayer.getSource();\n\n  const animating = frameState.viewHints[ViewHint.ANIMATING];\n  const interacting = frameState.viewHints[ViewHint.INTERACTING];\n  const updateWhileAnimating = vectorLayer.getUpdateWhileAnimating();\n  const updateWhileInteracting = vectorLayer.getUpdateWhileInteracting();\n\n  if (!this.dirty_ && (!updateWhileAnimating && animating) ||\n      (!updateWhileInteracting && interacting)) {\n    return true;\n  }\n\n  const frameStateExtent = frameState.extent;\n  const viewState = frameState.viewState;\n  const projection = viewState.projection;\n  const resolution = viewState.resolution;\n  const pixelRatio = frameState.pixelRatio;\n  const vectorLayerRevision = vectorLayer.getRevision();\n  const vectorLayerRenderBuffer = vectorLayer.getRenderBuffer();\n  let vectorLayerRenderOrder = vectorLayer.getRenderOrder();\n\n  if (vectorLayerRenderOrder === undefined) {\n    vectorLayerRenderOrder = defaultRenderOrder;\n  }\n\n  const extent = buffer(frameStateExtent,\n    vectorLayerRenderBuffer * resolution);\n  const projectionExtent = viewState.projection.getExtent();\n\n  if (vectorSource.getWrapX() && viewState.projection.canWrapX() &&\n      !containsExtent(projectionExtent, frameState.extent)) {\n    // For the replay group, we need an extent that intersects the real world\n    // (-180° to +180°). To support geometries in a coordinate range from -540°\n    // to +540°, we add at least 1 world width on each side of the projection\n    // extent. If the viewport is wider than the world, we need to add half of\n    // the viewport width to make sure we cover the whole viewport.\n    const worldWidth = getWidth(projectionExtent);\n    const gutter = Math.max(getWidth(extent) / 2, worldWidth);\n    extent[0] = projectionExtent[0] - gutter;\n    extent[2] = projectionExtent[2] + gutter;\n  }\n\n  if (!this.dirty_ &&\n      this.renderedResolution_ == resolution &&\n      this.renderedRevision_ == vectorLayerRevision &&\n      this.renderedRenderOrder_ == vectorLayerRenderOrder &&\n      containsExtent(this.renderedExtent_, extent)) {\n    this.replayGroupChanged = false;\n    return true;\n  }\n\n  this.replayGroup_ = null;\n\n  this.dirty_ = false;\n\n  const replayGroup = new CanvasReplayGroup(\n    getRenderTolerance(resolution, pixelRatio), extent, resolution,\n    pixelRatio, vectorSource.getOverlaps(), this.declutterTree_, vectorLayer.getRenderBuffer());\n  vectorSource.loadFeatures(extent, resolution, projection);\n  /**\n   * @param {module:ol/Feature} feature Feature.\n   * @this {module:ol/renderer/canvas/VectorLayer}\n   */\n  const render = function(feature) {\n    let styles;\n    const styleFunction = feature.getStyleFunction() || vectorLayer.getStyleFunction();\n    if (styleFunction) {\n      styles = styleFunction(feature, resolution);\n    }\n    if (styles) {\n      const dirty = this.renderFeature(\n        feature, resolution, pixelRatio, styles, replayGroup);\n      this.dirty_ = this.dirty_ || dirty;\n    }\n  }.bind(this);\n  if (vectorLayerRenderOrder) {\n    /** @type {Array.<module:ol/Feature>} */\n    const features = [];\n    vectorSource.forEachFeatureInExtent(extent,\n      /**\n       * @param {module:ol/Feature} feature Feature.\n       */\n      function(feature) {\n        features.push(feature);\n      }, this);\n    features.sort(vectorLayerRenderOrder);\n    for (let i = 0, ii = features.length; i < ii; ++i) {\n      render(features[i]);\n    }\n  } else {\n    vectorSource.forEachFeatureInExtent(extent, render, this);\n  }\n  replayGroup.finish();\n\n  this.renderedResolution_ = resolution;\n  this.renderedRevision_ = vectorLayerRevision;\n  this.renderedRenderOrder_ = vectorLayerRenderOrder;\n  this.renderedExtent_ = extent;\n  this.replayGroup_ = replayGroup;\n\n  this.replayGroupChanged = true;\n  return true;\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {(module:ol/style/Style|Array.<module:ol/style/Style>)} styles The style or array of styles.\n * @param {module:ol/render/canvas/ReplayGroup} replayGroup Replay group.\n * @return {boolean} `true` if an image is loading.\n */\nCanvasVectorLayerRenderer.prototype.renderFeature = function(feature, resolution, pixelRatio, styles, replayGroup) {\n  if (!styles) {\n    return false;\n  }\n  let loading = false;\n  if (Array.isArray(styles)) {\n    for (let i = 0, ii = styles.length; i < ii; ++i) {\n      loading = renderFeature(\n        replayGroup, feature, styles[i],\n        getSquaredRenderTolerance(resolution, pixelRatio),\n        this.handleStyleImageChange_, this) || loading;\n    }\n  } else {\n    loading = renderFeature(\n      replayGroup, feature, styles,\n      getSquaredRenderTolerance(resolution, pixelRatio),\n      this.handleStyleImageChange_, this);\n  }\n  return loading;\n};\nexport default CanvasVectorLayerRenderer;\n","/**\n * @module ol/layer/VectorTileRenderType\n */\n\n/**\n * @enum {string}\n * Render mode for vector tiles:\n *  * `'image'`: Vector tiles are rendered as images. Great performance, but\n *    point symbols and texts are always rotated with the view and pixels are\n *    scaled during zoom animations.\n *  * `'hybrid'`: Polygon and line elements are rendered as images, so pixels\n *    are scaled during zoom animations. Point symbols and texts are accurately\n *    rendered as vectors and can stay upright on rotated views.\n *  * `'vector'`: Vector tiles are rendered as vectors. Most accurate rendering\n *    even during animations, but slower performance than the other options.\n * @api\n */\nexport default {\n  IMAGE: 'image',\n  HYBRID: 'hybrid',\n  VECTOR: 'vector'\n};\n","/**\n * @module ol/renderer/canvas/VectorTileLayer\n */\nimport {getUid, inherits} from '../../util.js';\nimport LayerType from '../../LayerType.js';\nimport TileState from '../../TileState.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {listen, unlisten} from '../../events.js';\nimport EventType from '../../events/EventType.js';\nimport rbush from 'rbush';\nimport {buffer, containsCoordinate, equals, getIntersection, getTopLeft, intersects} from '../../extent.js';\nimport VectorTileRenderType from '../../layer/VectorTileRenderType.js';\nimport {equivalent as equivalentProjection} from '../../proj.js';\nimport Units from '../../proj/Units.js';\nimport ReplayType from '../../render/ReplayType.js';\nimport {labelCache, rotateAtOffset} from '../../render/canvas.js';\nimport CanvasReplayGroup, {replayDeclutter} from '../../render/canvas/ReplayGroup.js';\nimport {ORDER} from '../../render/replay.js';\nimport CanvasTileLayerRenderer from '../canvas/TileLayer.js';\nimport {getSquaredTolerance as getSquaredRenderTolerance, renderFeature} from '../vector.js';\nimport {\n  create as createTransform,\n  compose as composeTransform,\n  reset as resetTransform,\n  scale as scaleTransform,\n  translate as translateTransform\n} from '../../transform.js';\n\n\n/**\n * @type {!Object.<string, Array.<module:ol/render/ReplayType>>}\n */\nconst IMAGE_REPLAYS = {\n  'image': [ReplayType.POLYGON, ReplayType.CIRCLE,\n    ReplayType.LINE_STRING, ReplayType.IMAGE, ReplayType.TEXT],\n  'hybrid': [ReplayType.POLYGON, ReplayType.LINE_STRING]\n};\n\n\n/**\n * @type {!Object.<string, Array.<module:ol/render/ReplayType>>}\n */\nconst VECTOR_REPLAYS = {\n  'image': [ReplayType.DEFAULT],\n  'hybrid': [ReplayType.IMAGE, ReplayType.TEXT, ReplayType.DEFAULT],\n  'vector': ORDER\n};\n\n\n/**\n * @constructor\n * @extends {module:ol/renderer/canvas/TileLayer}\n * @param {module:ol/layer/VectorTile} layer VectorTile layer.\n * @api\n */\nconst CanvasVectorTileLayerRenderer = function(layer) {\n\n  /**\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context = null;\n\n  CanvasTileLayerRenderer.call(this, layer);\n\n  /**\n   * Declutter tree.\n   * @private\n   */\n  this.declutterTree_ = layer.getDeclutter() ? rbush(9, undefined) : null;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.dirty_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedLayerRevision_;\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.tmpTransform_ = createTransform();\n\n  // Use lower resolution for pure vector rendering. Closest resolution otherwise.\n  this.zDirection = layer.getRenderMode() == VectorTileRenderType.VECTOR ? 1 : 0;\n\n  listen(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n\n};\n\ninherits(CanvasVectorTileLayerRenderer, CanvasTileLayerRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nCanvasVectorTileLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.VECTOR_TILE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/canvas/VectorTileLayer} The layer renderer.\n */\nCanvasVectorTileLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new CanvasVectorTileLayerRenderer(/** @type {module:ol/layer/VectorTile} */ (layer));\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorTileLayerRenderer.prototype.disposeInternal = function() {\n  unlisten(labelCache, EventType.CLEAR, this.handleFontsChanged_, this);\n  CanvasTileLayerRenderer.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorTileLayerRenderer.prototype.getTile = function(z, x, y, pixelRatio, projection) {\n  const tile = CanvasTileLayerRenderer.prototype.getTile.call(this, z, x, y, pixelRatio, projection);\n  if (tile.getState() === TileState.LOADED) {\n    this.createReplayGroup_(tile, pixelRatio, projection);\n    if (this.context) {\n      this.renderTileImage_(tile, pixelRatio, projection);\n    }\n  }\n  return tile;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorTileLayerRenderer.prototype.prepareFrame = function(frameState, layerState) {\n  const layer = this.getLayer();\n  const layerRevision = layer.getRevision();\n  if (this.renderedLayerRevision_ != layerRevision) {\n    this.renderedTiles.length = 0;\n    const renderMode = layer.getRenderMode();\n    if (!this.context && renderMode != VectorTileRenderType.VECTOR) {\n      this.context = createCanvasContext2D();\n    }\n    if (this.context && renderMode == VectorTileRenderType.VECTOR) {\n      this.context = null;\n    }\n  }\n  this.renderedLayerRevision_ = layerRevision;\n  return CanvasTileLayerRenderer.prototype.prepareFrame.apply(this, arguments);\n};\n\n\n/**\n * @param {module:ol/VectorImageTile} tile Tile.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @private\n */\nCanvasVectorTileLayerRenderer.prototype.createReplayGroup_ = function(tile, pixelRatio, projection) {\n  const layer = this.getLayer();\n  const revision = layer.getRevision();\n  const renderOrder = /** @type {module:ol/render~OrderFunction} */ (layer.getRenderOrder()) || null;\n\n  const replayState = tile.getReplayState(layer);\n  if (!replayState.dirty && replayState.renderedRevision == revision &&\n      replayState.renderedRenderOrder == renderOrder) {\n    return;\n  }\n\n  const source = /** @type {module:ol/source/VectorTile} */ (layer.getSource());\n  const sourceTileGrid = source.getTileGrid();\n  const tileGrid = source.getTileGridForProjection(projection);\n  const resolution = tileGrid.getResolution(tile.tileCoord[0]);\n  const tileExtent = tile.extent;\n\n  const zIndexKeys = {};\n  for (let t = 0, tt = tile.tileKeys.length; t < tt; ++t) {\n    const sourceTile = tile.getTile(tile.tileKeys[t]);\n    if (sourceTile.getState() != TileState.LOADED) {\n      continue;\n    }\n\n    const sourceTileCoord = sourceTile.tileCoord;\n    const sourceTileExtent = sourceTileGrid.getTileCoordExtent(sourceTileCoord);\n    const sharedExtent = getIntersection(tileExtent, sourceTileExtent);\n    const bufferedExtent = equals(sourceTileExtent, sharedExtent) ? null :\n      buffer(sharedExtent, layer.getRenderBuffer() * resolution, this.tmpExtent);\n    const tileProjection = sourceTile.getProjection();\n    let reproject = false;\n    if (!equivalentProjection(projection, tileProjection)) {\n      reproject = true;\n      sourceTile.setProjection(projection);\n    }\n    replayState.dirty = false;\n    const replayGroup = new CanvasReplayGroup(0, sharedExtent, resolution,\n      pixelRatio, source.getOverlaps(), this.declutterTree_, layer.getRenderBuffer());\n    const squaredTolerance = getSquaredRenderTolerance(resolution, pixelRatio);\n\n    /**\n     * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n     * @this {module:ol/renderer/canvas/VectorTileLayer}\n     */\n    const render = function(feature) {\n      let styles;\n      const styleFunction = feature.getStyleFunction() || layer.getStyleFunction();\n      if (styleFunction) {\n        styles = styleFunction(feature, resolution);\n      }\n      if (styles) {\n        const dirty = this.renderFeature(feature, squaredTolerance, styles, replayGroup);\n        this.dirty_ = this.dirty_ || dirty;\n        replayState.dirty = replayState.dirty || dirty;\n      }\n    };\n\n    const features = sourceTile.getFeatures();\n    if (renderOrder && renderOrder !== replayState.renderedRenderOrder) {\n      features.sort(renderOrder);\n    }\n    for (let i = 0, ii = features.length; i < ii; ++i) {\n      const feature = features[i];\n      if (reproject) {\n        if (tileProjection.getUnits() == Units.TILE_PIXELS) {\n          // projected tile extent\n          tileProjection.setWorldExtent(sourceTileExtent);\n          // tile extent in tile pixel space\n          tileProjection.setExtent(sourceTile.getExtent());\n        }\n        feature.getGeometry().transform(tileProjection, projection);\n      }\n      if (!bufferedExtent || intersects(bufferedExtent, feature.getGeometry().getExtent())) {\n        render.call(this, feature);\n      }\n    }\n    replayGroup.finish();\n    for (const r in replayGroup.getReplays()) {\n      zIndexKeys[r] = true;\n    }\n    sourceTile.setReplayGroup(layer, tile.tileCoord.toString(), replayGroup);\n  }\n  replayState.renderedRevision = revision;\n  replayState.renderedRenderOrder = renderOrder;\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorTileLayerRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  const resolution = frameState.viewState.resolution;\n  const rotation = frameState.viewState.rotation;\n  hitTolerance = hitTolerance == undefined ? 0 : hitTolerance;\n  const layer = this.getLayer();\n  /** @type {!Object.<string, boolean>} */\n  const features = {};\n\n  /** @type {Array.<module:ol/VectorImageTile>} */\n  const renderedTiles = this.renderedTiles;\n\n  let bufferedExtent, found;\n  let i, ii, replayGroup;\n  for (i = 0, ii = renderedTiles.length; i < ii; ++i) {\n    const tile = renderedTiles[i];\n    bufferedExtent = buffer(tile.extent, hitTolerance * resolution, bufferedExtent);\n    if (!containsCoordinate(bufferedExtent, coordinate)) {\n      continue;\n    }\n    for (let t = 0, tt = tile.tileKeys.length; t < tt; ++t) {\n      const sourceTile = tile.getTile(tile.tileKeys[t]);\n      if (sourceTile.getState() != TileState.LOADED) {\n        continue;\n      }\n      replayGroup = sourceTile.getReplayGroup(layer, tile.tileCoord.toString());\n      found = found || replayGroup.forEachFeatureAtCoordinate(coordinate, resolution, rotation, hitTolerance, {},\n        /**\n         * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n         * @return {?} Callback result.\n         */\n        function(feature) {\n          const key = getUid(feature).toString();\n          if (!(key in features)) {\n            features[key] = true;\n            return callback.call(thisArg, feature, layer);\n          }\n        }, null);\n    }\n  }\n  return found;\n};\n\n\n/**\n * @param {module:ol/VectorTile} tile Tile.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @return {module:ol/transform~Transform} transform Transform.\n * @private\n */\nCanvasVectorTileLayerRenderer.prototype.getReplayTransform_ = function(tile, frameState) {\n  const layer = this.getLayer();\n  const source = /** @type {module:ol/source/VectorTile} */ (layer.getSource());\n  const tileGrid = source.getTileGrid();\n  const tileCoord = tile.tileCoord;\n  const tileResolution = tileGrid.getResolution(tileCoord[0]);\n  const viewState = frameState.viewState;\n  const pixelRatio = frameState.pixelRatio;\n  const renderResolution = viewState.resolution / pixelRatio;\n  const tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent);\n  const center = viewState.center;\n  const origin = getTopLeft(tileExtent);\n  const size = frameState.size;\n  const offsetX = Math.round(pixelRatio * size[0] / 2);\n  const offsetY = Math.round(pixelRatio * size[1] / 2);\n  return composeTransform(this.tmpTransform_,\n    offsetX, offsetY,\n    tileResolution / renderResolution, tileResolution / renderResolution,\n    viewState.rotation,\n    (origin[0] - center[0]) / tileResolution,\n    (center[1] - origin[1]) / tileResolution);\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n */\nCanvasVectorTileLayerRenderer.prototype.handleFontsChanged_ = function(event) {\n  const layer = this.getLayer();\n  if (layer.getVisible() && this.renderedLayerRevision_ !== undefined) {\n    layer.changed();\n  }\n};\n\n\n/**\n * Handle changes in image style state.\n * @param {module:ol/events/Event} event Image style change event.\n * @private\n */\nCanvasVectorTileLayerRenderer.prototype.handleStyleImageChange_ = function(event) {\n  this.renderIfReadyAndVisible();\n};\n\n\n/**\n * @inheritDoc\n */\nCanvasVectorTileLayerRenderer.prototype.postCompose = function(context, frameState, layerState) {\n  const layer = this.getLayer();\n  const renderMode = layer.getRenderMode();\n  if (renderMode != VectorTileRenderType.IMAGE) {\n    const declutterReplays = layer.getDeclutter() ? {} : null;\n    const source = /** @type {module:ol/source/VectorTile} */ (layer.getSource());\n    const replayTypes = VECTOR_REPLAYS[renderMode];\n    const pixelRatio = frameState.pixelRatio;\n    const rotation = frameState.viewState.rotation;\n    const size = frameState.size;\n    let offsetX, offsetY;\n    if (rotation) {\n      offsetX = Math.round(pixelRatio * size[0] / 2);\n      offsetY = Math.round(pixelRatio * size[1] / 2);\n      rotateAtOffset(context, -rotation, offsetX, offsetY);\n    }\n    if (declutterReplays) {\n      this.declutterTree_.clear();\n    }\n    const tiles = this.renderedTiles;\n    const tileGrid = source.getTileGridForProjection(frameState.viewState.projection);\n    const clips = [];\n    const zs = [];\n    for (let i = tiles.length - 1; i >= 0; --i) {\n      const tile = /** @type {module:ol/VectorImageTile} */ (tiles[i]);\n      if (tile.getState() == TileState.ABORT) {\n        continue;\n      }\n      const tileCoord = tile.tileCoord;\n      const worldOffset = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent)[0] - tile.extent[0];\n      let transform = undefined;\n      for (let t = 0, tt = tile.tileKeys.length; t < tt; ++t) {\n        const sourceTile = tile.getTile(tile.tileKeys[t]);\n        if (sourceTile.getState() != TileState.LOADED) {\n          continue;\n        }\n        const replayGroup = sourceTile.getReplayGroup(layer, tileCoord.toString());\n        if (!replayGroup || !replayGroup.hasReplays(replayTypes)) {\n          // sourceTile was not yet loaded when this.createReplayGroup_() was\n          // called, or it has no replays of the types we want to render\n          continue;\n        }\n        if (!transform) {\n          transform = this.getTransform(frameState, worldOffset);\n        }\n        const currentZ = sourceTile.tileCoord[0];\n        const currentClip = replayGroup.getClipCoords(transform);\n        context.save();\n        context.globalAlpha = layerState.opacity;\n        // Create a clip mask for regions in this low resolution tile that are\n        // already filled by a higher resolution tile\n        for (let j = 0, jj = clips.length; j < jj; ++j) {\n          const clip = clips[j];\n          if (currentZ < zs[j]) {\n            context.beginPath();\n            // counter-clockwise (outer ring) for current tile\n            context.moveTo(currentClip[0], currentClip[1]);\n            context.lineTo(currentClip[2], currentClip[3]);\n            context.lineTo(currentClip[4], currentClip[5]);\n            context.lineTo(currentClip[6], currentClip[7]);\n            // clockwise (inner ring) for higher resolution tile\n            context.moveTo(clip[6], clip[7]);\n            context.lineTo(clip[4], clip[5]);\n            context.lineTo(clip[2], clip[3]);\n            context.lineTo(clip[0], clip[1]);\n            context.clip();\n          }\n        }\n        replayGroup.replay(context, transform, rotation, {}, replayTypes, declutterReplays);\n        context.restore();\n        clips.push(currentClip);\n        zs.push(currentZ);\n      }\n    }\n    if (declutterReplays) {\n      replayDeclutter(declutterReplays, context, rotation);\n    }\n    if (rotation) {\n      rotateAtOffset(context, rotation,\n        /** @type {number} */ (offsetX), /** @type {number} */ (offsetY));\n    }\n  }\n  CanvasTileLayerRenderer.prototype.postCompose.apply(this, arguments);\n};\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {(module:ol/style/Style|Array.<module:ol/style/Style>)} styles The style or array of styles.\n * @param {module:ol/render/canvas/ReplayGroup} replayGroup Replay group.\n * @return {boolean} `true` if an image is loading.\n */\nCanvasVectorTileLayerRenderer.prototype.renderFeature = function(feature, squaredTolerance, styles, replayGroup) {\n  if (!styles) {\n    return false;\n  }\n  let loading = false;\n  if (Array.isArray(styles)) {\n    for (let i = 0, ii = styles.length; i < ii; ++i) {\n      loading = renderFeature(\n        replayGroup, feature, styles[i], squaredTolerance,\n        this.handleStyleImageChange_, this) || loading;\n    }\n  } else {\n    loading = renderFeature(\n      replayGroup, feature, styles, squaredTolerance,\n      this.handleStyleImageChange_, this);\n  }\n  return loading;\n};\n\n\n/**\n * @param {module:ol/VectorImageTile} tile Tile.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @private\n */\nCanvasVectorTileLayerRenderer.prototype.renderTileImage_ = function(\n  tile, pixelRatio, projection) {\n  const layer = this.getLayer();\n  const replayState = tile.getReplayState(layer);\n  const revision = layer.getRevision();\n  const replays = IMAGE_REPLAYS[layer.getRenderMode()];\n  if (replays && replayState.renderedTileRevision !== revision) {\n    replayState.renderedTileRevision = revision;\n    const tileCoord = tile.wrappedTileCoord;\n    const z = tileCoord[0];\n    const source = /** @type {module:ol/source/VectorTile} */ (layer.getSource());\n    const tileGrid = source.getTileGridForProjection(projection);\n    const resolution = tileGrid.getResolution(z);\n    const context = tile.getContext(layer);\n    const size = source.getTilePixelSize(z, pixelRatio, projection);\n    context.canvas.width = size[0];\n    context.canvas.height = size[1];\n    const tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent);\n    for (let i = 0, ii = tile.tileKeys.length; i < ii; ++i) {\n      const sourceTile = tile.getTile(tile.tileKeys[i]);\n      if (sourceTile.getState() != TileState.LOADED) {\n        continue;\n      }\n      const pixelScale = pixelRatio / resolution;\n      const transform = resetTransform(this.tmpTransform_);\n      scaleTransform(transform, pixelScale, -pixelScale);\n      translateTransform(transform, -tileExtent[0], -tileExtent[3]);\n      const replayGroup = sourceTile.getReplayGroup(layer, tile.tileCoord.toString());\n      replayGroup.replay(context, transform, 0, {}, replays);\n    }\n  }\n};\n\nexport default CanvasVectorTileLayerRenderer;\n","/**\n * @module ol/Map\n */\nimport {inherits} from './util.js';\nimport PluggableMap from './PluggableMap.js';\nimport {defaults as defaultControls} from './control/util.js';\nimport {defaults as defaultInteractions} from './interaction.js';\nimport {assign} from './obj.js';\nimport CanvasImageLayerRenderer from './renderer/canvas/ImageLayer.js';\nimport CanvasMapRenderer from './renderer/canvas/Map.js';\nimport CanvasTileLayerRenderer from './renderer/canvas/TileLayer.js';\nimport CanvasVectorLayerRenderer from './renderer/canvas/VectorLayer.js';\nimport CanvasVectorTileLayerRenderer from './renderer/canvas/VectorTileLayer.js';\n\n/**\n * @classdesc\n * The map is the core component of OpenLayers. For a map to render, a view,\n * one or more layers, and a target container are needed:\n *\n *     import Map from 'ol/Map';\n *     import View from 'ol/View';\n *     import TileLayer from 'ol/layer/Tile';\n *     import OSM from 'ol/source/OSM';\n *\n *     var map = new Map({\n *       view: new View({\n *         center: [0, 0],\n *         zoom: 1\n *       }),\n *       layers: [\n *         new TileLayer({\n *           source: new OSM()\n *         })\n *       ],\n *       target: 'map'\n *     });\n *\n * The above snippet creates a map using a {@link module:ol/layer/Tile} to\n * display {@link module:ol/source/OSM~OSM} OSM data and render it to a DOM\n * element with the id `map`.\n *\n * The constructor places a viewport container (with CSS class name\n * `ol-viewport`) in the target element (see `getViewport()`), and then two\n * further elements within the viewport: one with CSS class name\n * `ol-overlaycontainer-stopevent` for controls and some overlays, and one with\n * CSS class name `ol-overlaycontainer` for other overlays (see the `stopEvent`\n * option of {@link module:ol/Overlay~Overlay} for the difference). The map\n * itself is placed in a further element within the viewport.\n *\n * Layers are stored as a {@link module:ol/Collection~Collection} in\n * layerGroups. A top-level group is provided by the library. This is what is\n * accessed by `getLayerGroup` and `setLayerGroup`. Layers entered in the\n * options are added to this group, and `addLayer` and `removeLayer` change the\n * layer collection in the group. `getLayers` is a convenience function for\n * `getLayerGroup().getLayers()`. Note that {@link module:ol/layer/Group~Group}\n * is a subclass of {@link module:ol/layer/Base}, so layers entered in the\n * options or added with `addLayer` can be groups, which can contain further\n * groups, and so on.\n *\n * @constructor\n * @extends {module:ol/PluggableMap}\n * @param {module:ol/PluggableMap~MapOptions} options Map options.\n * @fires module:ol/MapBrowserEvent~MapBrowserEvent\n * @fires module:ol/MapEvent~MapEvent\n * @fires module:ol/render/Event~RenderEvent#postcompose\n * @fires module:ol/render/Event~RenderEvent#precompose\n * @api\n */\nconst Map = function(options) {\n  options = assign({}, options);\n  if (!options.controls) {\n    options.controls = defaultControls();\n  }\n  if (!options.interactions) {\n    options.interactions = defaultInteractions();\n  }\n\n  PluggableMap.call(this, options);\n};\n\ninherits(Map, PluggableMap);\n\nMap.prototype.createRenderer = function() {\n  const renderer = new CanvasMapRenderer(this);\n  renderer.registerLayerRenderers([\n    CanvasImageLayerRenderer,\n    CanvasTileLayerRenderer,\n    CanvasVectorLayerRenderer,\n    CanvasVectorTileLayerRenderer\n  ]);\n  return renderer;\n};\n\nexport default Map;\n","/**\n * @module ol/OverlayPositioning\n */\n\n/**\n * Overlay position: `'bottom-left'`, `'bottom-center'`,  `'bottom-right'`,\n * `'center-left'`, `'center-center'`, `'center-right'`, `'top-left'`,\n * `'top-center'`, `'top-right'`\n * @enum {string}\n */\nexport default {\n  BOTTOM_LEFT: 'bottom-left',\n  BOTTOM_CENTER: 'bottom-center',\n  BOTTOM_RIGHT: 'bottom-right',\n  CENTER_LEFT: 'center-left',\n  CENTER_CENTER: 'center-center',\n  CENTER_RIGHT: 'center-right',\n  TOP_LEFT: 'top-left',\n  TOP_CENTER: 'top-center',\n  TOP_RIGHT: 'top-right'\n};\n","/**\n * @module ol/Overlay\n */\nimport {inherits} from './util.js';\nimport MapEventType from './MapEventType.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport OverlayPositioning from './OverlayPositioning.js';\nimport {CLASS_SELECTABLE} from './css.js';\nimport {removeNode, removeChildren, outerWidth, outerHeight} from './dom.js';\nimport {listen, unlistenByKey} from './events.js';\nimport {containsExtent} from './extent.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number|string} [id] Set the overlay id. The overlay id can be used\n * with the {@link module:ol/Map~Map#getOverlayById} method.\n * @property {Element} [element] The overlay element.\n * @property {Array.<number>} [offset=[0, 0]] Offsets in pixels used when positioning\n * the overlay. The first element in the\n * array is the horizontal offset. A positive value shifts the overlay right.\n * The second element in the array is the vertical offset. A positive value\n * shifts the overlay down.\n * @property {module:ol/coordinate~Coordinate} [position] The overlay position\n * in map projection.\n * @property {module:ol/OverlayPositioning} [positioning='top-left'] Defines how\n * the overlay is actually positioned with respect to its `position` property.\n * Possible values are `'bottom-left'`, `'bottom-center'`, `'bottom-right'`,\n * `'center-left'`, `'center-center'`, `'center-right'`, `'top-left'`,\n * `'top-center'`, and `'top-right'`.\n * @property {boolean} [stopEvent=true] Whether event propagation to the map\n * viewport should be stopped. If `true` the overlay is placed in the same\n * container as that of the controls (CSS class name\n * `ol-overlaycontainer-stopevent`); if `false` it is placed in the container\n * with CSS class name specified by the `className` property.\n * @property {boolean} [insertFirst=true] Whether the overlay is inserted first\n * in the overlay container, or appended. If the overlay is placed in the same\n * container as that of the controls (see the `stopEvent` option) you will\n * probably set `insertFirst` to `true` so the overlay is displayed below the\n * controls.\n * @property {boolean} [autoPan=false] If set to `true` the map is panned when\n * calling `setPosition`, so that the overlay is entirely visible in the current\n * viewport.\n * @property {module:ol/Overlay~PanOptions} [autoPanAnimation] The\n * animation options used to pan the overlay into view. This animation is only\n * used when `autoPan` is enabled. A `duration` and `easing` may be provided to\n * customize the animation.\n * @property {number} [autoPanMargin=20] The margin (in pixels) between the\n * overlay and the borders of the map when autopanning.\n * @property {string} [className='ol-overlay-container ol-selectable'] CSS class\n * name.\n */\n\n\n/**\n * @typedef {Object} PanOptions\n * @property {number} [duration=1000] The duration of the animation in\n * milliseconds.\n * @property {function(number):number} [easing] The easing function to use. Can\n * be one from {@link module:ol/easing} or a custom function.\n * Default is {@link module:ol/easing~inAndOut}.\n */\n\n\n/**\n * @enum {string}\n * @protected\n */\nconst Property = {\n  ELEMENT: 'element',\n  MAP: 'map',\n  OFFSET: 'offset',\n  POSITION: 'position',\n  POSITIONING: 'positioning'\n};\n\n\n/**\n * @classdesc\n * An element to be displayed over the map and attached to a single map\n * location.  Like {@link module:ol/control/Control~Control}, Overlays are\n * visible widgets. Unlike Controls, they are not in a fixed position on the\n * screen, but are tied to a geographical coordinate, so panning the map will\n * move an Overlay but not a Control.\n *\n * Example:\n *\n *     import Overlay from 'ol/Overlay';\n *\n *     var popup = new Overlay({\n *       element: document.getElementById('popup')\n *     });\n *     popup.setPosition(coordinate);\n *     map.addOverlay(popup);\n *\n * @constructor\n * @extends {module:ol/Object}\n * @param {module:ol/Overlay~Options} options Overlay options.\n * @api\n */\nconst Overlay = function(options) {\n\n  BaseObject.call(this);\n\n  /**\n   * @protected\n   * @type {module:ol/Overlay~Options}\n   */\n  this.options = options;\n\n  /**\n   * @protected\n   * @type {number|string|undefined}\n   */\n  this.id = options.id;\n\n  /**\n   * @protected\n   * @type {boolean}\n   */\n  this.insertFirst = options.insertFirst !== undefined ?\n    options.insertFirst : true;\n\n  /**\n   * @protected\n   * @type {boolean}\n   */\n  this.stopEvent = options.stopEvent !== undefined ? options.stopEvent : true;\n\n  /**\n   * @protected\n   * @type {Element}\n   */\n  this.element = document.createElement('DIV');\n  this.element.className = options.className !== undefined ?\n    options.className : 'ol-overlay-container ' + CLASS_SELECTABLE;\n  this.element.style.position = 'absolute';\n\n  /**\n   * @protected\n   * @type {boolean}\n   */\n  this.autoPan = options.autoPan !== undefined ? options.autoPan : false;\n\n  /**\n   * @protected\n   * @type {module:ol/Overlay~PanOptions}\n   */\n  this.autoPanAnimation = options.autoPanAnimation || /** @type {module:ol/Overlay~PanOptions} */ ({});\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.autoPanMargin = options.autoPanMargin !== undefined ?\n    options.autoPanMargin : 20;\n\n  /**\n   * @protected\n   * @type {{bottom_: string,\n   *         left_: string,\n   *         right_: string,\n   *         top_: string,\n   *         visible: boolean}}\n   */\n  this.rendered = {\n    bottom_: '',\n    left_: '',\n    right_: '',\n    top_: '',\n    visible: true\n  };\n\n  /**\n   * @protected\n   * @type {?module:ol/events~EventsKey}\n   */\n  this.mapPostrenderListenerKey = null;\n\n  listen(\n    this, getChangeEventType(Property.ELEMENT),\n    this.handleElementChanged, this);\n\n  listen(\n    this, getChangeEventType(Property.MAP),\n    this.handleMapChanged, this);\n\n  listen(\n    this, getChangeEventType(Property.OFFSET),\n    this.handleOffsetChanged, this);\n\n  listen(\n    this, getChangeEventType(Property.POSITION),\n    this.handlePositionChanged, this);\n\n  listen(\n    this, getChangeEventType(Property.POSITIONING),\n    this.handlePositioningChanged, this);\n\n  if (options.element !== undefined) {\n    this.setElement(options.element);\n  }\n\n  this.setOffset(options.offset !== undefined ? options.offset : [0, 0]);\n\n  this.setPositioning(options.positioning !== undefined ?\n    /** @type {module:ol/OverlayPositioning} */ (options.positioning) :\n    OverlayPositioning.TOP_LEFT);\n\n  if (options.position !== undefined) {\n    this.setPosition(options.position);\n  }\n\n};\n\ninherits(Overlay, BaseObject);\n\n\n/**\n * Get the DOM element of this overlay.\n * @return {Element|undefined} The Element containing the overlay.\n * @observable\n * @api\n */\nOverlay.prototype.getElement = function() {\n  return /** @type {Element|undefined} */ (this.get(Property.ELEMENT));\n};\n\n\n/**\n * Get the overlay identifier which is set on constructor.\n * @return {number|string|undefined} Id.\n * @api\n */\nOverlay.prototype.getId = function() {\n  return this.id;\n};\n\n\n/**\n * Get the map associated with this overlay.\n * @return {module:ol/PluggableMap|undefined} The map that the\n * overlay is part of.\n * @observable\n * @api\n */\nOverlay.prototype.getMap = function() {\n  return (\n    /** @type {module:ol/PluggableMap|undefined} */ (this.get(Property.MAP))\n  );\n};\n\n\n/**\n * Get the offset of this overlay.\n * @return {Array.<number>} The offset.\n * @observable\n * @api\n */\nOverlay.prototype.getOffset = function() {\n  return /** @type {Array.<number>} */ (this.get(Property.OFFSET));\n};\n\n\n/**\n * Get the current position of this overlay.\n * @return {module:ol/coordinate~Coordinate|undefined} The spatial point that the overlay is\n *     anchored at.\n * @observable\n * @api\n */\nOverlay.prototype.getPosition = function() {\n  return (\n    /** @type {module:ol/coordinate~Coordinate|undefined} */ (this.get(Property.POSITION))\n  );\n};\n\n\n/**\n * Get the current positioning of this overlay.\n * @return {module:ol/OverlayPositioning} How the overlay is positioned\n *     relative to its point on the map.\n * @observable\n * @api\n */\nOverlay.prototype.getPositioning = function() {\n  return (\n    /** @type {module:ol/OverlayPositioning} */ (this.get(Property.POSITIONING))\n  );\n};\n\n\n/**\n * @protected\n */\nOverlay.prototype.handleElementChanged = function() {\n  removeChildren(this.element);\n  const element = this.getElement();\n  if (element) {\n    this.element.appendChild(element);\n  }\n};\n\n\n/**\n * @protected\n */\nOverlay.prototype.handleMapChanged = function() {\n  if (this.mapPostrenderListenerKey) {\n    removeNode(this.element);\n    unlistenByKey(this.mapPostrenderListenerKey);\n    this.mapPostrenderListenerKey = null;\n  }\n  const map = this.getMap();\n  if (map) {\n    this.mapPostrenderListenerKey = listen(map,\n      MapEventType.POSTRENDER, this.render, this);\n    this.updatePixelPosition();\n    const container = this.stopEvent ?\n      map.getOverlayContainerStopEvent() : map.getOverlayContainer();\n    if (this.insertFirst) {\n      container.insertBefore(this.element, container.childNodes[0] || null);\n    } else {\n      container.appendChild(this.element);\n    }\n  }\n};\n\n\n/**\n * @protected\n */\nOverlay.prototype.render = function() {\n  this.updatePixelPosition();\n};\n\n\n/**\n * @protected\n */\nOverlay.prototype.handleOffsetChanged = function() {\n  this.updatePixelPosition();\n};\n\n\n/**\n * @protected\n */\nOverlay.prototype.handlePositionChanged = function() {\n  this.updatePixelPosition();\n  if (this.get(Property.POSITION) && this.autoPan) {\n    this.panIntoView();\n  }\n};\n\n\n/**\n * @protected\n */\nOverlay.prototype.handlePositioningChanged = function() {\n  this.updatePixelPosition();\n};\n\n\n/**\n * Set the DOM element to be associated with this overlay.\n * @param {Element|undefined} element The Element containing the overlay.\n * @observable\n * @api\n */\nOverlay.prototype.setElement = function(element) {\n  this.set(Property.ELEMENT, element);\n};\n\n\n/**\n * Set the map to be associated with this overlay.\n * @param {module:ol/PluggableMap|undefined} map The map that the\n * overlay is part of.\n * @observable\n * @api\n */\nOverlay.prototype.setMap = function(map) {\n  this.set(Property.MAP, map);\n};\n\n\n/**\n * Set the offset for this overlay.\n * @param {Array.<number>} offset Offset.\n * @observable\n * @api\n */\nOverlay.prototype.setOffset = function(offset) {\n  this.set(Property.OFFSET, offset);\n};\n\n\n/**\n * Set the position for this overlay. If the position is `undefined` the\n * overlay is hidden.\n * @param {module:ol/coordinate~Coordinate|undefined} position The spatial point that the overlay\n *     is anchored at.\n * @observable\n * @api\n */\nOverlay.prototype.setPosition = function(position) {\n  this.set(Property.POSITION, position);\n};\n\n\n/**\n * Pan the map so that the overlay is entirely visible in the current viewport\n * (if necessary).\n * @protected\n */\nOverlay.prototype.panIntoView = function() {\n  const map = this.getMap();\n\n  if (!map || !map.getTargetElement()) {\n    return;\n  }\n\n  const mapRect = this.getRect(map.getTargetElement(), map.getSize());\n  const element = /** @type {!Element} */ (this.getElement());\n  const overlayRect = this.getRect(element, [outerWidth(element), outerHeight(element)]);\n\n  const margin = this.autoPanMargin;\n  if (!containsExtent(mapRect, overlayRect)) {\n    // the overlay is not completely inside the viewport, so pan the map\n    const offsetLeft = overlayRect[0] - mapRect[0];\n    const offsetRight = mapRect[2] - overlayRect[2];\n    const offsetTop = overlayRect[1] - mapRect[1];\n    const offsetBottom = mapRect[3] - overlayRect[3];\n\n    const delta = [0, 0];\n    if (offsetLeft < 0) {\n      // move map to the left\n      delta[0] = offsetLeft - margin;\n    } else if (offsetRight < 0) {\n      // move map to the right\n      delta[0] = Math.abs(offsetRight) + margin;\n    }\n    if (offsetTop < 0) {\n      // move map up\n      delta[1] = offsetTop - margin;\n    } else if (offsetBottom < 0) {\n      // move map down\n      delta[1] = Math.abs(offsetBottom) + margin;\n    }\n\n    if (delta[0] !== 0 || delta[1] !== 0) {\n      const center = /** @type {module:ol/coordinate~Coordinate} */ (map.getView().getCenter());\n      const centerPx = map.getPixelFromCoordinate(center);\n      const newCenterPx = [\n        centerPx[0] + delta[0],\n        centerPx[1] + delta[1]\n      ];\n\n      map.getView().animate({\n        center: map.getCoordinateFromPixel(newCenterPx),\n        duration: this.autoPanAnimation.duration,\n        easing: this.autoPanAnimation.easing\n      });\n    }\n  }\n};\n\n\n/**\n * Get the extent of an element relative to the document\n * @param {Element|undefined} element The element.\n * @param {module:ol/size~Size|undefined} size The size of the element.\n * @return {module:ol/extent~Extent} The extent.\n * @protected\n */\nOverlay.prototype.getRect = function(element, size) {\n  const box = element.getBoundingClientRect();\n  const offsetX = box.left + window.pageXOffset;\n  const offsetY = box.top + window.pageYOffset;\n  return [\n    offsetX,\n    offsetY,\n    offsetX + size[0],\n    offsetY + size[1]\n  ];\n};\n\n\n/**\n * Set the positioning for this overlay.\n * @param {module:ol/OverlayPositioning} positioning how the overlay is\n *     positioned relative to its point on the map.\n * @observable\n * @api\n */\nOverlay.prototype.setPositioning = function(positioning) {\n  this.set(Property.POSITIONING, positioning);\n};\n\n\n/**\n * Modify the visibility of the element.\n * @param {boolean} visible Element visibility.\n * @protected\n */\nOverlay.prototype.setVisible = function(visible) {\n  if (this.rendered.visible !== visible) {\n    this.element.style.display = visible ? '' : 'none';\n    this.rendered.visible = visible;\n  }\n};\n\n\n/**\n * Update pixel position.\n * @protected\n */\nOverlay.prototype.updatePixelPosition = function() {\n  const map = this.getMap();\n  const position = this.getPosition();\n  if (!map || !map.isRendered() || !position) {\n    this.setVisible(false);\n    return;\n  }\n\n  const pixel = map.getPixelFromCoordinate(position);\n  const mapSize = map.getSize();\n  this.updateRenderedPosition(pixel, mapSize);\n};\n\n\n/**\n * @param {module:ol~Pixel} pixel The pixel location.\n * @param {module:ol/size~Size|undefined} mapSize The map size.\n * @protected\n */\nOverlay.prototype.updateRenderedPosition = function(pixel, mapSize) {\n  const style = this.element.style;\n  const offset = this.getOffset();\n\n  const positioning = this.getPositioning();\n\n  this.setVisible(true);\n\n  let offsetX = offset[0];\n  let offsetY = offset[1];\n  if (positioning == OverlayPositioning.BOTTOM_RIGHT ||\n      positioning == OverlayPositioning.CENTER_RIGHT ||\n      positioning == OverlayPositioning.TOP_RIGHT) {\n    if (this.rendered.left_ !== '') {\n      this.rendered.left_ = style.left = '';\n    }\n    const right = Math.round(mapSize[0] - pixel[0] - offsetX) + 'px';\n    if (this.rendered.right_ != right) {\n      this.rendered.right_ = style.right = right;\n    }\n  } else {\n    if (this.rendered.right_ !== '') {\n      this.rendered.right_ = style.right = '';\n    }\n    if (positioning == OverlayPositioning.BOTTOM_CENTER ||\n        positioning == OverlayPositioning.CENTER_CENTER ||\n        positioning == OverlayPositioning.TOP_CENTER) {\n      offsetX -= this.element.offsetWidth / 2;\n    }\n    const left = Math.round(pixel[0] + offsetX) + 'px';\n    if (this.rendered.left_ != left) {\n      this.rendered.left_ = style.left = left;\n    }\n  }\n  if (positioning == OverlayPositioning.BOTTOM_LEFT ||\n      positioning == OverlayPositioning.BOTTOM_CENTER ||\n      positioning == OverlayPositioning.BOTTOM_RIGHT) {\n    if (this.rendered.top_ !== '') {\n      this.rendered.top_ = style.top = '';\n    }\n    const bottom = Math.round(mapSize[1] - pixel[1] - offsetY) + 'px';\n    if (this.rendered.bottom_ != bottom) {\n      this.rendered.bottom_ = style.bottom = bottom;\n    }\n  } else {\n    if (this.rendered.bottom_ !== '') {\n      this.rendered.bottom_ = style.bottom = '';\n    }\n    if (positioning == OverlayPositioning.CENTER_LEFT ||\n        positioning == OverlayPositioning.CENTER_CENTER ||\n        positioning == OverlayPositioning.CENTER_RIGHT) {\n      offsetY -= this.element.offsetHeight / 2;\n    }\n    const top = Math.round(pixel[1] + offsetY) + 'px';\n    if (this.rendered.top_ != top) {\n      this.rendered.top_ = style.top = top;\n    }\n  }\n};\n\n\n/**\n * returns the options this Overlay has been created with\n * @return {module:ol/Overlay~Options} overlay options\n */\nOverlay.prototype.getOptions = function() {\n  return this.options;\n};\n\nexport default Overlay;\n","/**\n * @module ol/tilecoord\n */\n\n\n/**\n * An array of three numbers representing the location of a tile in a tile\n * grid. The order is `z`, `x`, and `y`. `z` is the zoom level.\n * @typedef {Array.<number>} TileCoord\n * @api\n */\n\n\n/**\n * @param {number} z Z.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {module:ol/tilecoord~TileCoord=} opt_tileCoord Tile coordinate.\n * @return {module:ol/tilecoord~TileCoord} Tile coordinate.\n */\nexport function createOrUpdate(z, x, y, opt_tileCoord) {\n  if (opt_tileCoord !== undefined) {\n    opt_tileCoord[0] = z;\n    opt_tileCoord[1] = x;\n    opt_tileCoord[2] = y;\n    return opt_tileCoord;\n  } else {\n    return [z, x, y];\n  }\n}\n\n\n/**\n * @param {number} z Z.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {string} Key.\n */\nexport function getKeyZXY(z, x, y) {\n  return z + '/' + x + '/' + y;\n}\n\n\n/**\n * Get the key for a tile coord.\n * @param {module:ol/tilecoord~TileCoord} tileCoord The tile coord.\n * @return {string} Key.\n */\nexport function getKey(tileCoord) {\n  return getKeyZXY(tileCoord[0], tileCoord[1], tileCoord[2]);\n}\n\n\n/**\n * Get a tile coord given a key.\n * @param {string} key The tile coord key.\n * @return {module:ol/tilecoord~TileCoord} The tile coord.\n */\nexport function fromKey(key) {\n  return key.split('/').map(Number);\n}\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coord.\n * @return {number} Hash.\n */\nexport function hash(tileCoord) {\n  return (tileCoord[1] << tileCoord[0]) + tileCoord[2];\n}\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coord.\n * @return {string} Quad key.\n */\nexport function quadKey(tileCoord) {\n  const z = tileCoord[0];\n  const digits = new Array(z);\n  let mask = 1 << (z - 1);\n  let i, charCode;\n  for (i = 0; i < z; ++i) {\n    // 48 is charCode for 0 - '0'.charCodeAt(0)\n    charCode = 48;\n    if (tileCoord[1] & mask) {\n      charCode += 1;\n    }\n    if (tileCoord[2] & mask) {\n      charCode += 2;\n    }\n    digits[i] = String.fromCharCode(charCode);\n    mask >>= 1;\n  }\n  return digits.join('');\n}\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {!module:ol/tilegrid/TileGrid} tileGrid Tile grid.\n * @return {boolean} Tile coordinate is within extent and zoom level range.\n */\nexport function withinExtentAndZ(tileCoord, tileGrid) {\n  const z = tileCoord[0];\n  const x = tileCoord[1];\n  const y = tileCoord[2];\n\n  if (tileGrid.getMinZoom() > z || z > tileGrid.getMaxZoom()) {\n    return false;\n  }\n  const extent = tileGrid.getExtent();\n  let tileRange;\n  if (!extent) {\n    tileRange = tileGrid.getFullTileRange(z);\n  } else {\n    tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);\n  }\n  if (!tileRange) {\n    return true;\n  } else {\n    return tileRange.containsXY(x, y);\n  }\n}\n","/**\n * @module ol/TileCache\n */\nimport {inherits} from './util.js';\nimport LRUCache from './structs/LRUCache.js';\nimport {fromKey, getKey} from './tilecoord.js';\n\n/**\n * @constructor\n * @extends {module:ol/structs/LRUCache.<module:ol/Tile>}\n * @param {number=} opt_highWaterMark High water mark.\n * @struct\n */\nconst TileCache = function(opt_highWaterMark) {\n\n  LRUCache.call(this, opt_highWaterMark);\n\n};\n\ninherits(TileCache, LRUCache);\n\n\n/**\n * @param {!Object.<string, module:ol/TileRange>} usedTiles Used tiles.\n */\nTileCache.prototype.expireCache = function(usedTiles) {\n  while (this.canExpireCache()) {\n    const tile = this.peekLast();\n    const zKey = tile.tileCoord[0].toString();\n    if (zKey in usedTiles && usedTiles[zKey].contains(tile.tileCoord)) {\n      break;\n    } else {\n      this.pop().dispose();\n    }\n  }\n};\n\n\n/**\n * Prune all tiles from the cache that don't have the same z as the newest tile.\n */\nTileCache.prototype.pruneExceptNewestZ = function() {\n  if (this.getCount() === 0) {\n    return;\n  }\n  const key = this.peekFirstKey();\n  const tileCoord = fromKey(key);\n  const z = tileCoord[0];\n  this.forEach(function(tile) {\n    if (tile.tileCoord[0] !== z) {\n      this.remove(getKey(tile.tileCoord));\n      tile.dispose();\n    }\n  }, this);\n};\nexport default TileCache;\n","/**\n * @module ol/VectorImageTile\n */\nimport {getUid, inherits} from './util.js';\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\nimport {createCanvasContext2D} from './dom.js';\nimport {listen, unlistenByKey} from './events.js';\nimport {getHeight, getIntersection, getWidth} from './extent.js';\nimport EventType from './events/EventType.js';\nimport {loadFeaturesXhr} from './featureloader.js';\nimport {UNDEFINED} from './functions.js';\n\n\n/**\n * @typedef {Object} ReplayState\n * @property {boolean} dirty\n * @property {null|module:ol/render~OrderFunction} renderedRenderOrder\n * @property {number} renderedTileRevision\n * @property {number} renderedRevision\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/Tile}\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/TileState} state State.\n * @param {number} sourceRevision Source revision.\n * @param {module:ol/format/Feature} format Feature format.\n * @param {module:ol/Tile~LoadFunction} tileLoadFunction Tile load function.\n * @param {module:ol/tilecoord~TileCoord} urlTileCoord Wrapped tile coordinate for source urls.\n * @param {module:ol/Tile~UrlFunction} tileUrlFunction Tile url function.\n * @param {module:ol/tilegrid/TileGrid} sourceTileGrid Tile grid of the source.\n * @param {module:ol/tilegrid/TileGrid} tileGrid Tile grid of the renderer.\n * @param {Object.<string, module:ol/VectorTile>} sourceTiles Source tiles.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {function(new: module:ol/VectorTile, module:ol/tilecoord~TileCoord, module:ol/TileState, string,\n *     module:ol/format/Feature, module:ol/Tile~LoadFunction)} tileClass Class to\n *     instantiate for source tiles.\n * @param {function(this: module:ol/source/VectorTile, module:ol/events/Event)} handleTileChange\n *     Function to call when a source tile's state changes.\n * @param {number} zoom Integer zoom to render the tile for.\n */\nconst VectorImageTile = function(tileCoord, state, sourceRevision, format,\n  tileLoadFunction, urlTileCoord, tileUrlFunction, sourceTileGrid, tileGrid,\n  sourceTiles, pixelRatio, projection, tileClass, handleTileChange, zoom) {\n\n  Tile.call(this, tileCoord, state, {transition: 0});\n\n  /**\n   * @private\n   * @type {!Object.<string, CanvasRenderingContext2D>}\n   */\n  this.context_ = {};\n\n  /**\n   * @private\n   * @type {module:ol/featureloader~FeatureLoader}\n   */\n  this.loader_;\n\n  /**\n   * @private\n   * @type {!Object.<string, module:ol/VectorImageTile~ReplayState>}\n   */\n  this.replayState_ = {};\n\n  /**\n   * @private\n   * @type {Object.<string, module:ol/VectorTile>}\n   */\n  this.sourceTiles_ = sourceTiles;\n\n  /**\n   * Keys of source tiles used by this tile. Use with {@link #getTile}.\n   * @type {Array.<string>}\n   */\n  this.tileKeys = [];\n\n  /**\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent = null;\n\n  /**\n   * @type {number}\n   */\n  this.sourceRevision_ = sourceRevision;\n\n  /**\n   * @type {module:ol/tilecoord~TileCoord}\n   */\n  this.wrappedTileCoord = urlTileCoord;\n\n  /**\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.loadListenerKeys_ = [];\n\n  /**\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.sourceTileListenerKeys_ = [];\n\n  if (urlTileCoord) {\n    const extent = this.extent = tileGrid.getTileCoordExtent(urlTileCoord);\n    const resolution = tileGrid.getResolution(zoom);\n    const sourceZ = sourceTileGrid.getZForResolution(resolution);\n    const useLoadedOnly = zoom != tileCoord[0];\n    let loadCount = 0;\n    sourceTileGrid.forEachTileCoord(extent, sourceZ, function(sourceTileCoord) {\n      let sharedExtent = getIntersection(extent,\n        sourceTileGrid.getTileCoordExtent(sourceTileCoord));\n      const sourceExtent = sourceTileGrid.getExtent();\n      if (sourceExtent) {\n        sharedExtent = getIntersection(sharedExtent, sourceExtent, sharedExtent);\n      }\n      if (getWidth(sharedExtent) / resolution >= 0.5 &&\n          getHeight(sharedExtent) / resolution >= 0.5) {\n        // only include source tile if overlap is at least 1 pixel\n        ++loadCount;\n        const sourceTileKey = sourceTileCoord.toString();\n        let sourceTile = sourceTiles[sourceTileKey];\n        if (!sourceTile && !useLoadedOnly) {\n          const tileUrl = tileUrlFunction(sourceTileCoord, pixelRatio, projection);\n          sourceTile = sourceTiles[sourceTileKey] = new tileClass(sourceTileCoord,\n            tileUrl == undefined ? TileState.EMPTY : TileState.IDLE,\n            tileUrl == undefined ? '' : tileUrl,\n            format, tileLoadFunction);\n          this.sourceTileListenerKeys_.push(\n            listen(sourceTile, EventType.CHANGE, handleTileChange));\n        }\n        if (sourceTile && (!useLoadedOnly || sourceTile.getState() == TileState.LOADED)) {\n          sourceTile.consumers++;\n          this.tileKeys.push(sourceTileKey);\n        }\n      }\n    }.bind(this));\n\n    if (useLoadedOnly && loadCount == this.tileKeys.length) {\n      this.finishLoading_();\n    }\n\n    if (zoom <= tileCoord[0] && this.state != TileState.LOADED) {\n      while (zoom > tileGrid.getMinZoom()) {\n        const tile = new VectorImageTile(tileCoord, state, sourceRevision,\n          format, tileLoadFunction, urlTileCoord, tileUrlFunction,\n          sourceTileGrid, tileGrid, sourceTiles, pixelRatio, projection,\n          tileClass, UNDEFINED, --zoom);\n        if (tile.state == TileState.LOADED) {\n          this.interimTile = tile;\n          break;\n        }\n      }\n    }\n  }\n\n};\n\ninherits(VectorImageTile, Tile);\n\n\n/**\n * @inheritDoc\n */\nVectorImageTile.prototype.disposeInternal = function() {\n  this.state = TileState.ABORT;\n  this.changed();\n  if (this.interimTile) {\n    this.interimTile.dispose();\n  }\n\n  for (let i = 0, ii = this.tileKeys.length; i < ii; ++i) {\n    const sourceTileKey = this.tileKeys[i];\n    const sourceTile = this.getTile(sourceTileKey);\n    sourceTile.consumers--;\n    if (sourceTile.consumers == 0) {\n      delete this.sourceTiles_[sourceTileKey];\n      sourceTile.dispose();\n    }\n  }\n  this.tileKeys.length = 0;\n  this.sourceTiles_ = null;\n  this.loadListenerKeys_.forEach(unlistenByKey);\n  this.loadListenerKeys_.length = 0;\n  this.sourceTileListenerKeys_.forEach(unlistenByKey);\n  this.sourceTileListenerKeys_.length = 0;\n  Tile.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @param {module:ol/layer/Layer} layer Layer.\n * @return {CanvasRenderingContext2D} The rendering context.\n */\nVectorImageTile.prototype.getContext = function(layer) {\n  const key = getUid(layer).toString();\n  if (!(key in this.context_)) {\n    this.context_[key] = createCanvasContext2D();\n  }\n  return this.context_[key];\n};\n\n\n/**\n * Get the Canvas for this tile.\n * @param {module:ol/layer/Layer} layer Layer.\n * @return {HTMLCanvasElement} Canvas.\n */\nVectorImageTile.prototype.getImage = function(layer) {\n  return this.getReplayState(layer).renderedTileRevision == -1 ?\n    null : this.getContext(layer).canvas;\n};\n\n\n/**\n * @param {module:ol/layer/Layer} layer Layer.\n * @return {module:ol/VectorImageTile~ReplayState} The replay state.\n */\nVectorImageTile.prototype.getReplayState = function(layer) {\n  const key = getUid(layer).toString();\n  if (!(key in this.replayState_)) {\n    this.replayState_[key] = {\n      dirty: false,\n      renderedRenderOrder: null,\n      renderedRevision: -1,\n      renderedTileRevision: -1\n    };\n  }\n  return this.replayState_[key];\n};\n\n\n/**\n * @inheritDoc\n */\nVectorImageTile.prototype.getKey = function() {\n  return this.tileKeys.join('/') + '-' + this.sourceRevision_;\n};\n\n\n/**\n * @param {string} tileKey Key (tileCoord) of the source tile.\n * @return {module:ol/VectorTile} Source tile.\n */\nVectorImageTile.prototype.getTile = function(tileKey) {\n  return this.sourceTiles_[tileKey];\n};\n\n\n/**\n * @inheritDoc\n */\nVectorImageTile.prototype.load = function() {\n  // Source tiles with LOADED state - we just count them because once they are\n  // loaded, we're no longer listening to state changes.\n  let leftToLoad = 0;\n  // Source tiles with ERROR state - we track them because they can still have\n  // an ERROR state after another load attempt.\n  const errorSourceTiles = {};\n\n  if (this.state == TileState.IDLE) {\n    this.setState(TileState.LOADING);\n  }\n  if (this.state == TileState.LOADING) {\n    this.tileKeys.forEach(function(sourceTileKey) {\n      const sourceTile = this.getTile(sourceTileKey);\n      if (sourceTile.state == TileState.IDLE) {\n        sourceTile.setLoader(this.loader_);\n        sourceTile.load();\n      }\n      if (sourceTile.state == TileState.LOADING) {\n        const key = listen(sourceTile, EventType.CHANGE, function(e) {\n          const state = sourceTile.getState();\n          if (state == TileState.LOADED ||\n              state == TileState.ERROR) {\n            const uid = getUid(sourceTile);\n            if (state == TileState.ERROR) {\n              errorSourceTiles[uid] = true;\n            } else {\n              --leftToLoad;\n              delete errorSourceTiles[uid];\n            }\n            if (leftToLoad - Object.keys(errorSourceTiles).length == 0) {\n              this.finishLoading_();\n            }\n          }\n        }.bind(this));\n        this.loadListenerKeys_.push(key);\n        ++leftToLoad;\n      }\n    }.bind(this));\n  }\n  if (leftToLoad - Object.keys(errorSourceTiles).length == 0) {\n    setTimeout(this.finishLoading_.bind(this), 0);\n  }\n};\n\n\n/**\n * @private\n */\nVectorImageTile.prototype.finishLoading_ = function() {\n  let loaded = this.tileKeys.length;\n  let empty = 0;\n  for (let i = loaded - 1; i >= 0; --i) {\n    const state = this.getTile(this.tileKeys[i]).getState();\n    if (state != TileState.LOADED) {\n      --loaded;\n    }\n    if (state == TileState.EMPTY) {\n      ++empty;\n    }\n  }\n  if (loaded == this.tileKeys.length) {\n    this.loadListenerKeys_.forEach(unlistenByKey);\n    this.loadListenerKeys_.length = 0;\n    this.setState(TileState.LOADED);\n  } else {\n    this.setState(empty == this.tileKeys.length ? TileState.EMPTY : TileState.ERROR);\n  }\n};\n\nexport default VectorImageTile;\n\n/**\n * Sets the loader for a tile.\n * @param {module:ol/VectorTile} tile Vector tile.\n * @param {string} url URL.\n */\nexport function defaultLoadFunction(tile, url) {\n  const loader = loadFeaturesXhr(url, tile.getFormat(), tile.onLoad.bind(tile), tile.onError.bind(tile));\n  tile.setLoader(loader);\n}\n","/**\n * @module ol/VectorTile\n */\nimport {getUid, inherits} from './util.js';\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\n\n/**\n * @typedef {function(new: module:ol/VectorTile, module:ol/tilecoord~TileCoord,\n * module:ol/TileState, string, ?string, module:ol/Tile~LoadFunction)} TileClass\n * @api\n */\n\n/**\n * @constructor\n * @extends {module:ol/Tile}\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/TileState} state State.\n * @param {string} src Data source url.\n * @param {module:ol/format/Feature} format Feature format.\n * @param {module:ol/Tile~LoadFunction} tileLoadFunction Tile load function.\n * @param {module:ol/Tile~Options=} opt_options Tile options.\n */\nconst VectorTile = function(tileCoord, state, src, format, tileLoadFunction, opt_options) {\n\n  Tile.call(this, tileCoord, state, opt_options);\n\n  /**\n   * @type {number}\n   */\n  this.consumers = 0;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/format/Feature}\n   */\n  this.format_ = format;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/Feature>}\n   */\n  this.features_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/featureloader~FeatureLoader}\n   */\n  this.loader_;\n\n  /**\n   * Data projection\n   * @private\n   * @type {module:ol/proj/Projection}\n   */\n  this.projection_ = null;\n\n  /**\n   * @private\n   * @type {Object.<string, module:ol/render/ReplayGroup>}\n   */\n  this.replayGroups_ = {};\n\n  /**\n   * @private\n   * @type {module:ol/Tile~LoadFunction}\n   */\n  this.tileLoadFunction_ = tileLoadFunction;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.url_ = src;\n\n};\n\ninherits(VectorTile, Tile);\n\n/**\n * @const\n * @type {module:ol/extent~Extent}\n */\nconst DEFAULT_EXTENT = [0, 0, 4096, 4096];\n\n\n/**\n * @inheritDoc\n */\nVectorTile.prototype.disposeInternal = function() {\n  this.features_ = null;\n  this.replayGroups_ = {};\n  this.state = TileState.ABORT;\n  this.changed();\n  Tile.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * Gets the extent of the vector tile.\n * @return {module:ol/extent~Extent} The extent.\n * @api\n */\nVectorTile.prototype.getExtent = function() {\n  return this.extent_ || DEFAULT_EXTENT;\n};\n\n\n/**\n * Get the feature format assigned for reading this tile's features.\n * @return {module:ol/format/Feature} Feature format.\n * @api\n */\nVectorTile.prototype.getFormat = function() {\n  return this.format_;\n};\n\n\n/**\n * Get the features for this tile. Geometries will be in the projection returned\n * by {@link module:ol/VectorTile~VectorTile#getProjection}.\n * @return {Array.<module:ol/Feature|module:ol/render/Feature>} Features.\n * @api\n */\nVectorTile.prototype.getFeatures = function() {\n  return this.features_;\n};\n\n\n/**\n * @inheritDoc\n */\nVectorTile.prototype.getKey = function() {\n  return this.url_;\n};\n\n\n/**\n * Get the feature projection of features returned by\n * {@link module:ol/VectorTile~VectorTile#getFeatures}.\n * @return {module:ol/proj/Projection} Feature projection.\n * @api\n */\nVectorTile.prototype.getProjection = function() {\n  return this.projection_;\n};\n\n\n/**\n * @param {module:ol/layer/Layer} layer Layer.\n * @param {string} key Key.\n * @return {module:ol/render/ReplayGroup} Replay group.\n */\nVectorTile.prototype.getReplayGroup = function(layer, key) {\n  return this.replayGroups_[getUid(layer) + ',' + key];\n};\n\n\n/**\n * @inheritDoc\n */\nVectorTile.prototype.load = function() {\n  if (this.state == TileState.IDLE) {\n    this.setState(TileState.LOADING);\n    this.tileLoadFunction_(this, this.url_);\n    this.loader_(null, NaN, null);\n  }\n};\n\n\n/**\n * Handler for successful tile load.\n * @param {Array.<module:ol/Feature>} features The loaded features.\n * @param {module:ol/proj/Projection} dataProjection Data projection.\n * @param {module:ol/extent~Extent} extent Extent.\n */\nVectorTile.prototype.onLoad = function(features, dataProjection, extent) {\n  this.setProjection(dataProjection);\n  this.setFeatures(features);\n  this.setExtent(extent);\n};\n\n\n/**\n * Handler for tile load errors.\n */\nVectorTile.prototype.onError = function() {\n  this.setState(TileState.ERROR);\n};\n\n\n/**\n * Function for use in an {@link module:ol/source/VectorTile~VectorTile}'s\n * `tileLoadFunction`. Sets the extent of the vector tile. This is only required\n * for tiles in projections with `tile-pixels` as units. The extent should be\n * set to `[0, 0, tilePixelSize, tilePixelSize]`, where `tilePixelSize` is\n * calculated by multiplying the tile size with the tile pixel ratio. For\n * sources using {@link module:ol/format/MVT~MVT} as feature format, the\n * {@link module:ol/format/MVT~MVT#getLastExtent} method will return the correct\n * extent. The default is `[0, 0, 4096, 4096]`.\n * @param {module:ol/extent~Extent} extent The extent.\n * @api\n */\nVectorTile.prototype.setExtent = function(extent) {\n  this.extent_ = extent;\n};\n\n\n/**\n * Function for use in an {@link module:ol/source/VectorTile~VectorTile}'s `tileLoadFunction`.\n * Sets the features for the tile.\n * @param {Array.<module:ol/Feature>} features Features.\n * @api\n */\nVectorTile.prototype.setFeatures = function(features) {\n  this.features_ = features;\n  this.setState(TileState.LOADED);\n};\n\n\n/**\n * Function for use in an {@link module:ol/source/VectorTile~VectorTile}'s `tileLoadFunction`.\n * Sets the projection of the features that were added with\n * {@link module:ol/VectorTile~VectorTile#setFeatures}.\n * @param {module:ol/proj/Projection} projection Feature projection.\n * @api\n */\nVectorTile.prototype.setProjection = function(projection) {\n  this.projection_ = projection;\n};\n\n\n/**\n * @param {module:ol/layer/Layer} layer Layer.\n * @param {string} key Key.\n * @param {module:ol/render/ReplayGroup} replayGroup Replay group.\n */\nVectorTile.prototype.setReplayGroup = function(layer, key, replayGroup) {\n  this.replayGroups_[getUid(layer) + ',' + key] = replayGroup;\n};\n\n\n/**\n * Set the feature loader for reading this tile's features.\n * @param {module:ol/featureloader~FeatureLoader} loader Feature loader.\n * @api\n */\nVectorTile.prototype.setLoader = function(loader) {\n  this.loader_ = loader;\n};\n\nexport default VectorTile;\n","/**\n * @module ol/control/FullScreen\n */\nimport {inherits} from '../util.js';\nimport Control from '../control/Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE, CLASS_UNSUPPORTED} from '../css.js';\nimport {replaceNode} from '../dom.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\n\n\n/**\n * @return {string} Change type.\n */\nconst getChangeType = (function() {\n  let changeType;\n  return function() {\n    if (!changeType) {\n      const body = document.body;\n      if (body.webkitRequestFullscreen) {\n        changeType = 'webkitfullscreenchange';\n      } else if (body.mozRequestFullScreen) {\n        changeType = 'mozfullscreenchange';\n      } else if (body.msRequestFullscreen) {\n        changeType = 'MSFullscreenChange';\n      } else if (body.requestFullscreen) {\n        changeType = 'fullscreenchange';\n      }\n    }\n    return changeType;\n  };\n})();\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-full-screen'] CSS class name.\n * @property {string|Element} [label='\\u2922'] Text label to use for the button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string|Element} [labelActive='\\u00d7'] Text label to use for the\n * button when full-screen is active.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string} [tipLabel='Toggle full-screen'] Text label to use for the button tip.\n * @property {boolean} [keys=false] Full keyboard access.\n * @property {Element|string} [target] Specify a target if you want the\n * control to be rendered outside of the map's viewport.\n * @property {Element|string} [source] The element to be displayed\n * fullscreen. When not provided, the element containing the map viewport will\n * be displayed fullscreen.\n */\n\n\n/**\n * @classdesc\n * Provides a button that when clicked fills up the full screen with the map.\n * The full screen source element is by default the element containing the map viewport unless\n * overridden by providing the `source` option. In which case, the dom\n * element introduced using this parameter will be displayed in full screen.\n *\n * When in full screen mode, a close button is shown to exit full screen mode.\n * The [Fullscreen API](http://www.w3.org/TR/fullscreen/) is used to\n * toggle the map in full screen mode.\n *\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/FullScreen~Options=} opt_options Options.\n * @api\n */\nconst FullScreen = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.cssClassName_ = options.className !== undefined ? options.className :\n    'ol-full-screen';\n\n  const label = options.label !== undefined ? options.label : '\\u2922';\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.labelNode_ = typeof label === 'string' ?\n    document.createTextNode(label) : label;\n\n  const labelActive = options.labelActive !== undefined ? options.labelActive : '\\u00d7';\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.labelActiveNode_ = typeof labelActive === 'string' ?\n    document.createTextNode(labelActive) : labelActive;\n\n  const tipLabel = options.tipLabel ? options.tipLabel : 'Toggle full-screen';\n  const button = document.createElement('button');\n  button.className = this.cssClassName_ + '-' + isFullScreen();\n  button.setAttribute('type', 'button');\n  button.title = tipLabel;\n  button.appendChild(this.labelNode_);\n\n  listen(button, EventType.CLICK,\n    this.handleClick_, this);\n\n  const cssClasses = this.cssClassName_ + ' ' + CLASS_UNSELECTABLE +\n      ' ' + CLASS_CONTROL + ' ' +\n      (!isFullScreenSupported() ? CLASS_UNSUPPORTED : '');\n  const element = document.createElement('div');\n  element.className = cssClasses;\n  element.appendChild(button);\n\n  Control.call(this, {\n    element: element,\n    target: options.target\n  });\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.keys_ = options.keys !== undefined ? options.keys : false;\n\n  /**\n   * @private\n   * @type {Element|string|undefined}\n   */\n  this.source_ = options.source;\n\n};\n\ninherits(FullScreen, Control);\n\n\n/**\n * @param {Event} event The event to handle\n * @private\n */\nFullScreen.prototype.handleClick_ = function(event) {\n  event.preventDefault();\n  this.handleFullScreen_();\n};\n\n\n/**\n * @private\n */\nFullScreen.prototype.handleFullScreen_ = function() {\n  if (!isFullScreenSupported()) {\n    return;\n  }\n  const map = this.getMap();\n  if (!map) {\n    return;\n  }\n  if (isFullScreen()) {\n    exitFullScreen();\n  } else {\n    let element;\n    if (this.source_) {\n      element = typeof this.source_ === 'string' ?\n        document.getElementById(this.source_) :\n        this.source_;\n    } else {\n      element = map.getTargetElement();\n    }\n    if (this.keys_) {\n      requestFullScreenWithKeys(element);\n\n    } else {\n      requestFullScreen(element);\n    }\n  }\n};\n\n\n/**\n * @private\n */\nFullScreen.prototype.handleFullScreenChange_ = function() {\n  const button = this.element.firstElementChild;\n  const map = this.getMap();\n  if (isFullScreen()) {\n    button.className = this.cssClassName_ + '-true';\n    replaceNode(this.labelActiveNode_, this.labelNode_);\n  } else {\n    button.className = this.cssClassName_ + '-false';\n    replaceNode(this.labelNode_, this.labelActiveNode_);\n  }\n  if (map) {\n    map.updateSize();\n  }\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nFullScreen.prototype.setMap = function(map) {\n  Control.prototype.setMap.call(this, map);\n  if (map) {\n    this.listenerKeys.push(listen(document,\n      getChangeType(),\n      this.handleFullScreenChange_, this)\n    );\n  }\n};\n\n/**\n * @return {boolean} Fullscreen is supported by the current platform.\n */\nfunction isFullScreenSupported() {\n  const body = document.body;\n  return !!(\n    body.webkitRequestFullscreen ||\n    (body.mozRequestFullScreen && document.mozFullScreenEnabled) ||\n    (body.msRequestFullscreen && document.msFullscreenEnabled) ||\n    (body.requestFullscreen && document.fullscreenEnabled)\n  );\n}\n\n/**\n * @return {boolean} Element is currently in fullscreen.\n */\nfunction isFullScreen() {\n  return !!(\n    document.webkitIsFullScreen || document.mozFullScreen ||\n    document.msFullscreenElement || document.fullscreenElement\n  );\n}\n\n/**\n * Request to fullscreen an element.\n * @param {Element} element Element to request fullscreen\n */\nfunction requestFullScreen(element) {\n  if (element.requestFullscreen) {\n    element.requestFullscreen();\n  } else if (element.msRequestFullscreen) {\n    element.msRequestFullscreen();\n  } else if (element.mozRequestFullScreen) {\n    element.mozRequestFullScreen();\n  } else if (element.webkitRequestFullscreen) {\n    element.webkitRequestFullscreen();\n  }\n}\n\n/**\n * Request to fullscreen an element with keyboard input.\n * @param {Element} element Element to request fullscreen\n */\nfunction requestFullScreenWithKeys(element) {\n  if (element.mozRequestFullScreenWithKeys) {\n    element.mozRequestFullScreenWithKeys();\n  } else if (element.webkitRequestFullscreen) {\n    element.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n  } else {\n    requestFullScreen(element);\n  }\n}\n\n/**\n * Exit fullscreen.\n */\nfunction exitFullScreen() {\n  if (document.exitFullscreen) {\n    document.exitFullscreen();\n  } else if (document.msExitFullscreen) {\n    document.msExitFullscreen();\n  } else if (document.mozCancelFullScreen) {\n    document.mozCancelFullScreen();\n  } else if (document.webkitExitFullscreen) {\n    document.webkitExitFullscreen();\n  }\n}\n\nexport default FullScreen;\n","/**\n * @module ol/control/OverviewMap\n */\nimport {inherits} from '../util.js';\nimport Collection from '../Collection.js';\nimport Map from '../Map.js';\nimport MapEventType from '../MapEventType.js';\nimport MapProperty from '../MapProperty.js';\nimport {getChangeEventType} from '../Object.js';\nimport ObjectEventType from '../ObjectEventType.js';\nimport Overlay from '../Overlay.js';\nimport OverlayPositioning from '../OverlayPositioning.js';\nimport ViewProperty from '../ViewProperty.js';\nimport Control from '../control/Control.js';\nimport {rotate as rotateCoordinate, add as addCoordinate} from '../coordinate.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE, CLASS_COLLAPSED} from '../css.js';\nimport {replaceNode} from '../dom.js';\nimport {listen, listenOnce, unlisten} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {containsExtent, getBottomLeft, getBottomRight, getTopLeft, getTopRight, scaleFromCenter} from '../extent.js';\n\n\n/**\n * Maximum width and/or height extent ratio that determines when the overview\n * map should be zoomed out.\n * @type {number}\n */\nconst MAX_RATIO = 0.75;\n\n\n/**\n * Minimum width and/or height extent ratio that determines when the overview\n * map should be zoomed in.\n * @type {number}\n */\nconst MIN_RATIO = 0.1;\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-overviewmap'] CSS class name.\n * @property {boolean} [collapsed=true] Whether the control should start collapsed or not (expanded).\n * @property {string|Element} [collapseLabel='«'] Text label to use for the\n * expanded overviewmap button. Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {boolean} [collapsible=true] Whether the control can be collapsed or not.\n * @property {string|Element} [label='»'] Text label to use for the collapsed\n * overviewmap button. Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {Array.<module:ol/layer/Layer>|module:ol/Collection.<module:ol/layer/Layer>} [layers]\n * Layers for the overview map. If not set, then all main map layers are used\n * instead.\n * @property {function(module:ol/MapEvent)} [render] Function called when the control\n * should be re-rendered. This is called in a `requestAnimationFrame` callback.\n * @property {Element|string} [target] Specify a target if you want the control\n * to be rendered outside of the map's viewport.\n * @property {string} [tipLabel='Overview map'] Text label to use for the button tip.\n * @property {module:ol/View} [view] Custom view for the overview map. If not provided,\n * a default view with an EPSG:3857 projection will be used.\n */\n\n\n/**\n * Create a new control with a map acting as an overview map for an other\n * defined map.\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/OverviewMap~Options=} opt_options OverviewMap options.\n * @api\n */\nconst OverviewMap = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.collapsed_ = options.collapsed !== undefined ? options.collapsed : true;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.collapsible_ = options.collapsible !== undefined ?\n    options.collapsible : true;\n\n  if (!this.collapsible_) {\n    this.collapsed_ = false;\n  }\n\n  const className = options.className !== undefined ? options.className : 'ol-overviewmap';\n\n  const tipLabel = options.tipLabel !== undefined ? options.tipLabel : 'Overview map';\n\n  const collapseLabel = options.collapseLabel !== undefined ? options.collapseLabel : '\\u00AB';\n\n  if (typeof collapseLabel === 'string') {\n    /**\n     * @private\n     * @type {Element}\n     */\n    this.collapseLabel_ = document.createElement('span');\n    this.collapseLabel_.textContent = collapseLabel;\n  } else {\n    this.collapseLabel_ = collapseLabel;\n  }\n\n  const label = options.label !== undefined ? options.label : '\\u00BB';\n\n\n  if (typeof label === 'string') {\n    /**\n     * @private\n     * @type {Element}\n     */\n    this.label_ = document.createElement('span');\n    this.label_.textContent = label;\n  } else {\n    this.label_ = label;\n  }\n\n  const activeLabel = (this.collapsible_ && !this.collapsed_) ?\n    this.collapseLabel_ : this.label_;\n  const button = document.createElement('button');\n  button.setAttribute('type', 'button');\n  button.title = tipLabel;\n  button.appendChild(activeLabel);\n\n  listen(button, EventType.CLICK,\n    this.handleClick_, this);\n\n  /**\n   * @type {Element}\n   * @private\n   */\n  this.ovmapDiv_ = document.createElement('DIV');\n  this.ovmapDiv_.className = 'ol-overviewmap-map';\n\n  /**\n   * @type {module:ol/Map}\n   * @private\n   */\n  this.ovmap_ = new Map({\n    controls: new Collection(),\n    interactions: new Collection(),\n    view: options.view\n  });\n  const ovmap = this.ovmap_;\n\n  if (options.layers) {\n    options.layers.forEach(\n      /**\n       * @param {module:ol/layer/Layer} layer Layer.\n       */\n      (function(layer) {\n        ovmap.addLayer(layer);\n      }).bind(this));\n  }\n\n  const box = document.createElement('DIV');\n  box.className = 'ol-overviewmap-box';\n  box.style.boxSizing = 'border-box';\n\n  /**\n   * @type {module:ol/Overlay}\n   * @private\n   */\n  this.boxOverlay_ = new Overlay({\n    position: [0, 0],\n    positioning: OverlayPositioning.BOTTOM_LEFT,\n    element: box\n  });\n  this.ovmap_.addOverlay(this.boxOverlay_);\n\n  const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL +\n      (this.collapsed_ && this.collapsible_ ? ' ' + CLASS_COLLAPSED : '') +\n      (this.collapsible_ ? '' : ' ol-uncollapsible');\n  const element = document.createElement('div');\n  element.className = cssClasses;\n  element.appendChild(this.ovmapDiv_);\n  element.appendChild(button);\n\n  Control.call(this, {\n    element: element,\n    render: options.render || render,\n    target: options.target\n  });\n\n  /* Interactive map */\n\n  const scope = this;\n\n  const overlay = this.boxOverlay_;\n  const overlayBox = this.boxOverlay_.getElement();\n\n  /* Functions definition */\n\n  const computeDesiredMousePosition = function(mousePosition) {\n    return {\n      clientX: mousePosition.clientX - (overlayBox.offsetWidth / 2),\n      clientY: mousePosition.clientY + (overlayBox.offsetHeight / 2)\n    };\n  };\n\n  const move = function(event) {\n    const coordinates = ovmap.getEventCoordinate(computeDesiredMousePosition(event));\n\n    overlay.setPosition(coordinates);\n  };\n\n  const endMoving = function(event) {\n    const coordinates = ovmap.getEventCoordinate(event);\n\n    scope.getMap().getView().setCenter(coordinates);\n\n    window.removeEventListener('mousemove', move);\n    window.removeEventListener('mouseup', endMoving);\n  };\n\n  /* Binding */\n\n  overlayBox.addEventListener('mousedown', function() {\n    window.addEventListener('mousemove', move);\n    window.addEventListener('mouseup', endMoving);\n  });\n};\n\ninherits(OverviewMap, Control);\n\n\n/**\n * @inheritDoc\n * @api\n */\nOverviewMap.prototype.setMap = function(map) {\n  const oldMap = this.getMap();\n  if (map === oldMap) {\n    return;\n  }\n  if (oldMap) {\n    const oldView = oldMap.getView();\n    if (oldView) {\n      this.unbindView_(oldView);\n    }\n    this.ovmap_.setTarget(null);\n  }\n  Control.prototype.setMap.call(this, map);\n\n  if (map) {\n    this.ovmap_.setTarget(this.ovmapDiv_);\n    this.listenerKeys.push(listen(\n      map, ObjectEventType.PROPERTYCHANGE,\n      this.handleMapPropertyChange_, this));\n\n    // TODO: to really support map switching, this would need to be reworked\n    if (this.ovmap_.getLayers().getLength() === 0) {\n      this.ovmap_.setLayerGroup(map.getLayerGroup());\n    }\n\n    const view = map.getView();\n    if (view) {\n      this.bindView_(view);\n      if (view.isDef()) {\n        this.ovmap_.updateSize();\n        this.resetExtent_();\n      }\n    }\n  }\n};\n\n\n/**\n * Handle map property changes.  This only deals with changes to the map's view.\n * @param {module:ol/Object~ObjectEvent} event The propertychange event.\n * @private\n */\nOverviewMap.prototype.handleMapPropertyChange_ = function(event) {\n  if (event.key === MapProperty.VIEW) {\n    const oldView = /** @type {module:ol/View} */ (event.oldValue);\n    if (oldView) {\n      this.unbindView_(oldView);\n    }\n    const newView = this.getMap().getView();\n    this.bindView_(newView);\n  }\n};\n\n\n/**\n * Register listeners for view property changes.\n * @param {module:ol/View} view The view.\n * @private\n */\nOverviewMap.prototype.bindView_ = function(view) {\n  listen(view,\n    getChangeEventType(ViewProperty.ROTATION),\n    this.handleRotationChanged_, this);\n};\n\n\n/**\n * Unregister listeners for view property changes.\n * @param {module:ol/View} view The view.\n * @private\n */\nOverviewMap.prototype.unbindView_ = function(view) {\n  unlisten(view,\n    getChangeEventType(ViewProperty.ROTATION),\n    this.handleRotationChanged_, this);\n};\n\n\n/**\n * Handle rotation changes to the main map.\n * TODO: This should rotate the extent rectrangle instead of the\n * overview map's view.\n * @private\n */\nOverviewMap.prototype.handleRotationChanged_ = function() {\n  this.ovmap_.getView().setRotation(this.getMap().getView().getRotation());\n};\n\n\n/**\n * Update the overview map element.\n * @param {module:ol/MapEvent} mapEvent Map event.\n * @this {module:ol/control/OverviewMap}\n * @api\n */\nexport function render(mapEvent) {\n  this.validateExtent_();\n  this.updateBox_();\n}\n\n\n/**\n * Reset the overview map extent if the box size (width or\n * height) is less than the size of the overview map size times minRatio\n * or is greater than the size of the overview size times maxRatio.\n *\n * If the map extent was not reset, the box size can fits in the defined\n * ratio sizes. This method then checks if is contained inside the overview\n * map current extent. If not, recenter the overview map to the current\n * main map center location.\n * @private\n */\nOverviewMap.prototype.validateExtent_ = function() {\n  const map = this.getMap();\n  const ovmap = this.ovmap_;\n\n  if (!map.isRendered() || !ovmap.isRendered()) {\n    return;\n  }\n\n  const mapSize = /** @type {module:ol/size~Size} */ (map.getSize());\n\n  const view = map.getView();\n  const extent = view.calculateExtent(mapSize);\n\n  const ovmapSize = /** @type {module:ol/size~Size} */ (ovmap.getSize());\n\n  const ovview = ovmap.getView();\n  const ovextent = ovview.calculateExtent(ovmapSize);\n\n  const topLeftPixel =\n      ovmap.getPixelFromCoordinate(getTopLeft(extent));\n  const bottomRightPixel =\n      ovmap.getPixelFromCoordinate(getBottomRight(extent));\n\n  const boxWidth = Math.abs(topLeftPixel[0] - bottomRightPixel[0]);\n  const boxHeight = Math.abs(topLeftPixel[1] - bottomRightPixel[1]);\n\n  const ovmapWidth = ovmapSize[0];\n  const ovmapHeight = ovmapSize[1];\n\n  if (boxWidth < ovmapWidth * MIN_RATIO ||\n      boxHeight < ovmapHeight * MIN_RATIO ||\n      boxWidth > ovmapWidth * MAX_RATIO ||\n      boxHeight > ovmapHeight * MAX_RATIO) {\n    this.resetExtent_();\n  } else if (!containsExtent(ovextent, extent)) {\n    this.recenter_();\n  }\n};\n\n\n/**\n * Reset the overview map extent to half calculated min and max ratio times\n * the extent of the main map.\n * @private\n */\nOverviewMap.prototype.resetExtent_ = function() {\n  if (MAX_RATIO === 0 || MIN_RATIO === 0) {\n    return;\n  }\n\n  const map = this.getMap();\n  const ovmap = this.ovmap_;\n\n  const mapSize = /** @type {module:ol/size~Size} */ (map.getSize());\n\n  const view = map.getView();\n  const extent = view.calculateExtent(mapSize);\n\n  const ovview = ovmap.getView();\n\n  // get how many times the current map overview could hold different\n  // box sizes using the min and max ratio, pick the step in the middle used\n  // to calculate the extent from the main map to set it to the overview map,\n  const steps = Math.log(\n    MAX_RATIO / MIN_RATIO) / Math.LN2;\n  const ratio = 1 / (Math.pow(2, steps / 2) * MIN_RATIO);\n  scaleFromCenter(extent, ratio);\n  ovview.fit(extent);\n};\n\n\n/**\n * Set the center of the overview map to the map center without changing its\n * resolution.\n * @private\n */\nOverviewMap.prototype.recenter_ = function() {\n  const map = this.getMap();\n  const ovmap = this.ovmap_;\n\n  const view = map.getView();\n\n  const ovview = ovmap.getView();\n\n  ovview.setCenter(view.getCenter());\n};\n\n\n/**\n * Update the box using the main map extent\n * @private\n */\nOverviewMap.prototype.updateBox_ = function() {\n  const map = this.getMap();\n  const ovmap = this.ovmap_;\n\n  if (!map.isRendered() || !ovmap.isRendered()) {\n    return;\n  }\n\n  const mapSize = /** @type {module:ol/size~Size} */ (map.getSize());\n\n  const view = map.getView();\n\n  const ovview = ovmap.getView();\n\n  const rotation = view.getRotation();\n\n  const overlay = this.boxOverlay_;\n  const box = this.boxOverlay_.getElement();\n  const extent = view.calculateExtent(mapSize);\n  const ovresolution = ovview.getResolution();\n  const bottomLeft = getBottomLeft(extent);\n  const topRight = getTopRight(extent);\n\n  // set position using bottom left coordinates\n  const rotateBottomLeft = this.calculateCoordinateRotate_(rotation, bottomLeft);\n  overlay.setPosition(rotateBottomLeft);\n\n  // set box size calculated from map extent size and overview map resolution\n  if (box) {\n    box.style.width = Math.abs((bottomLeft[0] - topRight[0]) / ovresolution) + 'px';\n    box.style.height = Math.abs((topRight[1] - bottomLeft[1]) / ovresolution) + 'px';\n  }\n};\n\n\n/**\n * @param {number} rotation Target rotation.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @return {module:ol/coordinate~Coordinate|undefined} Coordinate for rotation and center anchor.\n * @private\n */\nOverviewMap.prototype.calculateCoordinateRotate_ = function(\n  rotation, coordinate) {\n  let coordinateRotate;\n\n  const map = this.getMap();\n  const view = map.getView();\n\n  const currentCenter = view.getCenter();\n\n  if (currentCenter) {\n    coordinateRotate = [\n      coordinate[0] - currentCenter[0],\n      coordinate[1] - currentCenter[1]\n    ];\n    rotateCoordinate(coordinateRotate, rotation);\n    addCoordinate(coordinateRotate, currentCenter);\n  }\n  return coordinateRotate;\n};\n\n\n/**\n * @param {Event} event The event to handle\n * @private\n */\nOverviewMap.prototype.handleClick_ = function(event) {\n  event.preventDefault();\n  this.handleToggle_();\n};\n\n\n/**\n * @private\n */\nOverviewMap.prototype.handleToggle_ = function() {\n  this.element.classList.toggle(CLASS_COLLAPSED);\n  if (this.collapsed_) {\n    replaceNode(this.collapseLabel_, this.label_);\n  } else {\n    replaceNode(this.label_, this.collapseLabel_);\n  }\n  this.collapsed_ = !this.collapsed_;\n\n  // manage overview map if it had not been rendered before and control\n  // is expanded\n  const ovmap = this.ovmap_;\n  if (!this.collapsed_ && !ovmap.isRendered()) {\n    ovmap.updateSize();\n    this.resetExtent_();\n    listenOnce(ovmap, MapEventType.POSTRENDER,\n      function(event) {\n        this.updateBox_();\n      },\n      this);\n  }\n};\n\n\n/**\n * Return `true` if the overview map is collapsible, `false` otherwise.\n * @return {boolean} True if the widget is collapsible.\n * @api\n */\nOverviewMap.prototype.getCollapsible = function() {\n  return this.collapsible_;\n};\n\n\n/**\n * Set whether the overview map should be collapsible.\n * @param {boolean} collapsible True if the widget is collapsible.\n * @api\n */\nOverviewMap.prototype.setCollapsible = function(collapsible) {\n  if (this.collapsible_ === collapsible) {\n    return;\n  }\n  this.collapsible_ = collapsible;\n  this.element.classList.toggle('ol-uncollapsible');\n  if (!collapsible && this.collapsed_) {\n    this.handleToggle_();\n  }\n};\n\n\n/**\n * Collapse or expand the overview map according to the passed parameter. Will\n * not do anything if the overview map isn't collapsible or if the current\n * collapsed state is already the one requested.\n * @param {boolean} collapsed True if the widget is collapsed.\n * @api\n */\nOverviewMap.prototype.setCollapsed = function(collapsed) {\n  if (!this.collapsible_ || this.collapsed_ === collapsed) {\n    return;\n  }\n  this.handleToggle_();\n};\n\n\n/**\n * Determine if the overview map is collapsed.\n * @return {boolean} The overview map is collapsed.\n * @api\n */\nOverviewMap.prototype.getCollapsed = function() {\n  return this.collapsed_;\n};\n\n\n/**\n * Return the overview map.\n * @return {module:ol/PluggableMap} Overview map.\n * @api\n */\nOverviewMap.prototype.getOverviewMap = function() {\n  return this.ovmap_;\n};\nexport default OverviewMap;\n","/**\n * @module ol/control/ScaleLine\n */\nimport {inherits} from '../util.js';\nimport {getChangeEventType} from '../Object.js';\nimport {assert} from '../asserts.js';\nimport Control from '../control/Control.js';\nimport {CLASS_UNSELECTABLE} from '../css.js';\nimport {listen} from '../events.js';\nimport {getPointResolution, METERS_PER_UNIT} from '../proj.js';\nimport ProjUnits from '../proj/Units.js';\n\n\n/**\n * @type {string}\n */\nconst UNITS_PROP = 'units';\n\n/**\n * Units for the scale line. Supported values are `'degrees'`, `'imperial'`,\n * `'nautical'`, `'metric'`, `'us'`.\n * @enum {string}\n */\nexport const Units = {\n  DEGREES: 'degrees',\n  IMPERIAL: 'imperial',\n  NAUTICAL: 'nautical',\n  METRIC: 'metric',\n  US: 'us'\n};\n\n\n/**\n * @const\n * @type {Array.<number>}\n */\nconst LEADING_DIGITS = [1, 2, 5];\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-scale-line'] CSS Class name.\n * @property {number} [minWidth=64] Minimum width in pixels.\n * @property {function(module:ol/MapEvent)} [render] Function called when the control\n * should be re-rendered. This is called in a `requestAnimationFrame` callback.\n * @property {Element|string} [target] Specify a target if you want the control\n * to be rendered outside of the map's viewport.\n * @property {module:ol/control/ScaleLine~Units|string} [units='metric'] Units.\n */\n\n\n/**\n * @classdesc\n * A control displaying rough y-axis distances, calculated for the center of the\n * viewport. For conformal projections (e.g. EPSG:3857, the default view\n * projection in OpenLayers), the scale is valid for all directions.\n * No scale line will be shown when the y-axis distance of a pixel at the\n * viewport center cannot be calculated in the view projection.\n * By default the scale line will show in the bottom left portion of the map,\n * but this can be changed by using the css selector `.ol-scale-line`.\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/ScaleLine~Options=} opt_options Scale line options.\n * @api\n */\nconst ScaleLine = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const className = options.className !== undefined ? options.className : 'ol-scale-line';\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.innerElement_ = document.createElement('DIV');\n  this.innerElement_.className = className + '-inner';\n\n  /**\n   * @private\n   * @type {Element}\n   */\n  this.element_ = document.createElement('DIV');\n  this.element_.className = className + ' ' + CLASS_UNSELECTABLE;\n  this.element_.appendChild(this.innerElement_);\n\n  /**\n   * @private\n   * @type {?module:ol/View~State}\n   */\n  this.viewState_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.minWidth_ = options.minWidth !== undefined ? options.minWidth : 64;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.renderedVisible_ = false;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.renderedWidth_ = undefined;\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.renderedHTML_ = '';\n\n  Control.call(this, {\n    element: this.element_,\n    render: options.render || render,\n    target: options.target\n  });\n\n  listen(\n    this, getChangeEventType(UNITS_PROP),\n    this.handleUnitsChanged_, this);\n\n  this.setUnits(/** @type {module:ol/control/ScaleLine~Units} */ (options.units) ||\n      Units.METRIC);\n\n};\n\ninherits(ScaleLine, Control);\n\n\n/**\n * Return the units to use in the scale line.\n * @return {module:ol/control/ScaleLine~Units|undefined} The units\n * to use in the scale line.\n * @observable\n * @api\n */\nScaleLine.prototype.getUnits = function() {\n  return (\n    /** @type {module:ol/control/ScaleLine~Units|undefined} */ (this.get(UNITS_PROP))\n  );\n};\n\n\n/**\n * Update the scale line element.\n * @param {module:ol/MapEvent} mapEvent Map event.\n * @this {module:ol/control/ScaleLine}\n * @api\n */\nexport function render(mapEvent) {\n  const frameState = mapEvent.frameState;\n  if (!frameState) {\n    this.viewState_ = null;\n  } else {\n    this.viewState_ = frameState.viewState;\n  }\n  this.updateElement_();\n}\n\n\n/**\n * @private\n */\nScaleLine.prototype.handleUnitsChanged_ = function() {\n  this.updateElement_();\n};\n\n\n/**\n * Set the units to use in the scale line.\n * @param {module:ol/control/ScaleLine~Units} units The units to use in the scale line.\n * @observable\n * @api\n */\nScaleLine.prototype.setUnits = function(units) {\n  this.set(UNITS_PROP, units);\n};\n\n\n/**\n * @private\n */\nScaleLine.prototype.updateElement_ = function() {\n  const viewState = this.viewState_;\n\n  if (!viewState) {\n    if (this.renderedVisible_) {\n      this.element_.style.display = 'none';\n      this.renderedVisible_ = false;\n    }\n    return;\n  }\n\n  const center = viewState.center;\n  const projection = viewState.projection;\n  const units = this.getUnits();\n  const pointResolutionUnits = units == Units.DEGREES ?\n    ProjUnits.DEGREES :\n    ProjUnits.METERS;\n  let pointResolution =\n      getPointResolution(projection, viewState.resolution, center, pointResolutionUnits);\n  if (projection.getUnits() != ProjUnits.DEGREES && projection.getMetersPerUnit()\n    && pointResolutionUnits == ProjUnits.METERS) {\n    pointResolution *= projection.getMetersPerUnit();\n  }\n\n  let nominalCount = this.minWidth_ * pointResolution;\n  let suffix = '';\n  if (units == Units.DEGREES) {\n    const metersPerDegree = METERS_PER_UNIT[ProjUnits.DEGREES];\n    if (projection.getUnits() == ProjUnits.DEGREES) {\n      nominalCount *= metersPerDegree;\n    } else {\n      pointResolution /= metersPerDegree;\n    }\n    if (nominalCount < metersPerDegree / 60) {\n      suffix = '\\u2033'; // seconds\n      pointResolution *= 3600;\n    } else if (nominalCount < metersPerDegree) {\n      suffix = '\\u2032'; // minutes\n      pointResolution *= 60;\n    } else {\n      suffix = '\\u00b0'; // degrees\n    }\n  } else if (units == Units.IMPERIAL) {\n    if (nominalCount < 0.9144) {\n      suffix = 'in';\n      pointResolution /= 0.0254;\n    } else if (nominalCount < 1609.344) {\n      suffix = 'ft';\n      pointResolution /= 0.3048;\n    } else {\n      suffix = 'mi';\n      pointResolution /= 1609.344;\n    }\n  } else if (units == Units.NAUTICAL) {\n    pointResolution /= 1852;\n    suffix = 'nm';\n  } else if (units == Units.METRIC) {\n    if (nominalCount < 0.001) {\n      suffix = 'μm';\n      pointResolution *= 1000000;\n    } else if (nominalCount < 1) {\n      suffix = 'mm';\n      pointResolution *= 1000;\n    } else if (nominalCount < 1000) {\n      suffix = 'm';\n    } else {\n      suffix = 'km';\n      pointResolution /= 1000;\n    }\n  } else if (units == Units.US) {\n    if (nominalCount < 0.9144) {\n      suffix = 'in';\n      pointResolution *= 39.37;\n    } else if (nominalCount < 1609.344) {\n      suffix = 'ft';\n      pointResolution /= 0.30480061;\n    } else {\n      suffix = 'mi';\n      pointResolution /= 1609.3472;\n    }\n  } else {\n    assert(false, 33); // Invalid units\n  }\n\n  let i = 3 * Math.floor(\n    Math.log(this.minWidth_ * pointResolution) / Math.log(10));\n  let count, width;\n  while (true) {\n    count = LEADING_DIGITS[((i % 3) + 3) % 3] *\n        Math.pow(10, Math.floor(i / 3));\n    width = Math.round(count / pointResolution);\n    if (isNaN(width)) {\n      this.element_.style.display = 'none';\n      this.renderedVisible_ = false;\n      return;\n    } else if (width >= this.minWidth_) {\n      break;\n    }\n    ++i;\n  }\n\n  const html = count + ' ' + suffix;\n  if (this.renderedHTML_ != html) {\n    this.innerElement_.innerHTML = html;\n    this.renderedHTML_ = html;\n  }\n\n  if (this.renderedWidth_ != width) {\n    this.innerElement_.style.width = width + 'px';\n    this.renderedWidth_ = width;\n  }\n\n  if (!this.renderedVisible_) {\n    this.element_.style.display = '';\n    this.renderedVisible_ = true;\n  }\n\n};\n\nexport default ScaleLine;\n","/**\n * @module ol/control/ZoomSlider\n */\nimport {inherits} from '../util.js';\nimport ViewHint from '../ViewHint.js';\nimport Control from '../control/Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE} from '../css.js';\nimport {easeOut} from '../easing.js';\nimport {listen} from '../events.js';\nimport {stopPropagation} from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport {clamp} from '../math.js';\nimport PointerEventType from '../pointer/EventType.js';\nimport PointerEventHandler from '../pointer/PointerEventHandler.js';\n\n\n/**\n * The enum for available directions.\n *\n * @enum {number}\n */\nconst Direction = {\n  VERTICAL: 0,\n  HORIZONTAL: 1\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-zoomslider'] CSS class name.\n * @property {number} [duration=200] Animation duration in milliseconds.\n * @property {function(module:ol/MapEvent)} [render] Function called when the control\n * should be re-rendered. This is called in a `requestAnimationFrame` callback.\n */\n\n\n/**\n * @classdesc\n * A slider type of control for zooming.\n *\n * Example:\n *\n *     map.addControl(new ZoomSlider());\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/ZoomSlider~Options=} opt_options Zoom slider options.\n * @api\n */\nconst ZoomSlider = function(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * Will hold the current resolution of the view.\n   *\n   * @type {number|undefined}\n   * @private\n   */\n  this.currentResolution_ = undefined;\n\n  /**\n   * The direction of the slider. Will be determined from actual display of the\n   * container and defaults to Direction.VERTICAL.\n   *\n   * @type {Direction}\n   * @private\n   */\n  this.direction_ = Direction.VERTICAL;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.dragging_;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.heightLimit_ = 0;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.widthLimit_ = 0;\n\n  /**\n   * @type {number|undefined}\n   * @private\n   */\n  this.previousX_;\n\n  /**\n   * @type {number|undefined}\n   * @private\n   */\n  this.previousY_;\n\n  /**\n   * The calculated thumb size (border box plus margins).  Set when initSlider_\n   * is called.\n   * @type {module:ol/size~Size}\n   * @private\n   */\n  this.thumbSize_ = null;\n\n  /**\n   * Whether the slider is initialized.\n   * @type {boolean}\n   * @private\n   */\n  this.sliderInitialized_ = false;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.duration_ = options.duration !== undefined ? options.duration : 200;\n\n  const className = options.className !== undefined ? options.className : 'ol-zoomslider';\n  const thumbElement = document.createElement('button');\n  thumbElement.setAttribute('type', 'button');\n  thumbElement.className = className + '-thumb ' + CLASS_UNSELECTABLE;\n  const containerElement = document.createElement('div');\n  containerElement.className = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL;\n  containerElement.appendChild(thumbElement);\n  /**\n   * @type {module:ol/pointer/PointerEventHandler}\n   * @private\n   */\n  this.dragger_ = new PointerEventHandler(containerElement);\n\n  listen(this.dragger_, PointerEventType.POINTERDOWN,\n    this.handleDraggerStart_, this);\n  listen(this.dragger_, PointerEventType.POINTERMOVE,\n    this.handleDraggerDrag_, this);\n  listen(this.dragger_, PointerEventType.POINTERUP,\n    this.handleDraggerEnd_, this);\n\n  listen(containerElement, EventType.CLICK, this.handleContainerClick_, this);\n  listen(thumbElement, EventType.CLICK, stopPropagation);\n\n  Control.call(this, {\n    element: containerElement,\n    render: options.render || render\n  });\n};\n\ninherits(ZoomSlider, Control);\n\n\n/**\n * @inheritDoc\n */\nZoomSlider.prototype.disposeInternal = function() {\n  this.dragger_.dispose();\n  Control.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @inheritDoc\n */\nZoomSlider.prototype.setMap = function(map) {\n  Control.prototype.setMap.call(this, map);\n  if (map) {\n    map.render();\n  }\n};\n\n\n/**\n * Initializes the slider element. This will determine and set this controls\n * direction_ and also constrain the dragging of the thumb to always be within\n * the bounds of the container.\n *\n * @private\n */\nZoomSlider.prototype.initSlider_ = function() {\n  const container = this.element;\n  const containerSize = {\n    width: container.offsetWidth, height: container.offsetHeight\n  };\n\n  const thumb = container.firstElementChild;\n  const computedStyle = getComputedStyle(thumb);\n  const thumbWidth = thumb.offsetWidth +\n      parseFloat(computedStyle['marginRight']) +\n      parseFloat(computedStyle['marginLeft']);\n  const thumbHeight = thumb.offsetHeight +\n      parseFloat(computedStyle['marginTop']) +\n      parseFloat(computedStyle['marginBottom']);\n  this.thumbSize_ = [thumbWidth, thumbHeight];\n\n  if (containerSize.width > containerSize.height) {\n    this.direction_ = Direction.HORIZONTAL;\n    this.widthLimit_ = containerSize.width - thumbWidth;\n  } else {\n    this.direction_ = Direction.VERTICAL;\n    this.heightLimit_ = containerSize.height - thumbHeight;\n  }\n  this.sliderInitialized_ = true;\n};\n\n\n/**\n * Update the zoomslider element.\n * @param {module:ol/MapEvent} mapEvent Map event.\n * @this {module:ol/control/ZoomSlider}\n * @api\n */\nexport function render(mapEvent) {\n  if (!mapEvent.frameState) {\n    return;\n  }\n  if (!this.sliderInitialized_) {\n    this.initSlider_();\n  }\n  const res = mapEvent.frameState.viewState.resolution;\n  if (res !== this.currentResolution_) {\n    this.currentResolution_ = res;\n    this.setThumbPosition_(res);\n  }\n}\n\n\n/**\n * @param {Event} event The browser event to handle.\n * @private\n */\nZoomSlider.prototype.handleContainerClick_ = function(event) {\n  const view = this.getMap().getView();\n\n  const relativePosition = this.getRelativePosition_(\n    event.offsetX - this.thumbSize_[0] / 2,\n    event.offsetY - this.thumbSize_[1] / 2);\n\n  const resolution = this.getResolutionForPosition_(relativePosition);\n\n  view.animate({\n    resolution: view.constrainResolution(resolution),\n    duration: this.duration_,\n    easing: easeOut\n  });\n};\n\n\n/**\n * Handle dragger start events.\n * @param {module:ol/pointer/PointerEvent} event The drag event.\n * @private\n */\nZoomSlider.prototype.handleDraggerStart_ = function(event) {\n  if (!this.dragging_ && event.originalEvent.target === this.element.firstElementChild) {\n    this.getMap().getView().setHint(ViewHint.INTERACTING, 1);\n    this.previousX_ = event.clientX;\n    this.previousY_ = event.clientY;\n    this.dragging_ = true;\n  }\n};\n\n\n/**\n * Handle dragger drag events.\n *\n * @param {module:ol/pointer/PointerEvent|Event} event The drag event.\n * @private\n */\nZoomSlider.prototype.handleDraggerDrag_ = function(event) {\n  if (this.dragging_) {\n    const element = this.element.firstElementChild;\n    const deltaX = event.clientX - this.previousX_ + parseInt(element.style.left, 10);\n    const deltaY = event.clientY - this.previousY_ + parseInt(element.style.top, 10);\n    const relativePosition = this.getRelativePosition_(deltaX, deltaY);\n    this.currentResolution_ = this.getResolutionForPosition_(relativePosition);\n    this.getMap().getView().setResolution(this.currentResolution_);\n    this.setThumbPosition_(this.currentResolution_);\n    this.previousX_ = event.clientX;\n    this.previousY_ = event.clientY;\n  }\n};\n\n\n/**\n * Handle dragger end events.\n * @param {module:ol/pointer/PointerEvent|Event} event The drag event.\n * @private\n */\nZoomSlider.prototype.handleDraggerEnd_ = function(event) {\n  if (this.dragging_) {\n    const view = this.getMap().getView();\n    view.setHint(ViewHint.INTERACTING, -1);\n\n    view.animate({\n      resolution: view.constrainResolution(this.currentResolution_),\n      duration: this.duration_,\n      easing: easeOut\n    });\n\n    this.dragging_ = false;\n    this.previousX_ = undefined;\n    this.previousY_ = undefined;\n  }\n};\n\n\n/**\n * Positions the thumb inside its container according to the given resolution.\n *\n * @param {number} res The res.\n * @private\n */\nZoomSlider.prototype.setThumbPosition_ = function(res) {\n  const position = this.getPositionForResolution_(res);\n  const thumb = this.element.firstElementChild;\n\n  if (this.direction_ == Direction.HORIZONTAL) {\n    thumb.style.left = this.widthLimit_ * position + 'px';\n  } else {\n    thumb.style.top = this.heightLimit_ * position + 'px';\n  }\n};\n\n\n/**\n * Calculates the relative position of the thumb given x and y offsets.  The\n * relative position scales from 0 to 1.  The x and y offsets are assumed to be\n * in pixel units within the dragger limits.\n *\n * @param {number} x Pixel position relative to the left of the slider.\n * @param {number} y Pixel position relative to the top of the slider.\n * @return {number} The relative position of the thumb.\n * @private\n */\nZoomSlider.prototype.getRelativePosition_ = function(x, y) {\n  let amount;\n  if (this.direction_ === Direction.HORIZONTAL) {\n    amount = x / this.widthLimit_;\n  } else {\n    amount = y / this.heightLimit_;\n  }\n  return clamp(amount, 0, 1);\n};\n\n\n/**\n * Calculates the corresponding resolution of the thumb given its relative\n * position (where 0 is the minimum and 1 is the maximum).\n *\n * @param {number} position The relative position of the thumb.\n * @return {number} The corresponding resolution.\n * @private\n */\nZoomSlider.prototype.getResolutionForPosition_ = function(position) {\n  const fn = this.getMap().getView().getResolutionForValueFunction();\n  return fn(1 - position);\n};\n\n\n/**\n * Determines the relative position of the slider for the given resolution.  A\n * relative position of 0 corresponds to the minimum view resolution.  A\n * relative position of 1 corresponds to the maximum view resolution.\n *\n * @param {number} res The resolution.\n * @return {number} The relative position value (between 0 and 1).\n * @private\n */\nZoomSlider.prototype.getPositionForResolution_ = function(res) {\n  const fn = this.getMap().getView().getValueForResolutionFunction();\n  return 1 - fn(res);\n};\n\nexport default ZoomSlider;\n","/**\n * @module ol/control/ZoomToExtent\n */\nimport {inherits} from '../util.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport Control from '../control/Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE} from '../css.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-zoom-extent'] Class name.\n * @property {Element|string} [target] Specify a target if you want the control\n * to be rendered outside of the map's viewport.\n * @property {string|Element} [label='E'] Text label to use for the button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string} [tipLabel='Fit to extent'] Text label to use for the button tip.\n * @property {module:ol/extent~Extent} [extent] The extent to zoom to. If undefined the validity\n * extent of the view projection is used.\n */\n\n\n/**\n * @classdesc\n * A button control which, when pressed, changes the map view to a specific\n * extent. To style this control use the css selector `.ol-zoom-extent`.\n *\n * @constructor\n * @extends {module:ol/control/Control}\n * @param {module:ol/control/ZoomToExtent~Options=} opt_options Options.\n * @api\n */\nconst ZoomToExtent = function(opt_options) {\n  const options = opt_options ? opt_options : {};\n\n  /**\n   * @type {module:ol/extent~Extent}\n   * @protected\n   */\n  this.extent = options.extent ? options.extent : null;\n\n  const className = options.className !== undefined ? options.className : 'ol-zoom-extent';\n\n  const label = options.label !== undefined ? options.label : 'E';\n  const tipLabel = options.tipLabel !== undefined ? options.tipLabel : 'Fit to extent';\n  const button = document.createElement('button');\n  button.setAttribute('type', 'button');\n  button.title = tipLabel;\n  button.appendChild(\n    typeof label === 'string' ? document.createTextNode(label) : label\n  );\n\n  listen(button, EventType.CLICK, this.handleClick_, this);\n\n  const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL;\n  const element = document.createElement('div');\n  element.className = cssClasses;\n  element.appendChild(button);\n\n  Control.call(this, {\n    element: element,\n    target: options.target\n  });\n};\n\ninherits(ZoomToExtent, Control);\n\n\n/**\n * @param {Event} event The event to handle\n * @private\n */\nZoomToExtent.prototype.handleClick_ = function(event) {\n  event.preventDefault();\n  this.handleZoomToExtent();\n};\n\n\n/**\n * @protected\n */\nZoomToExtent.prototype.handleZoomToExtent = function() {\n  const map = this.getMap();\n  const view = map.getView();\n  const extent = !this.extent ? view.getProjection().getExtent() : this.extent;\n  view.fit(extent);\n};\nexport default ZoomToExtent;\n","/**\n * @module ol/control\n */\n\nexport {default as Attribution} from './control/Attribution.js';\nexport {default as Control} from './control/Control.js';\nexport {default as FullScreen} from './control/FullScreen.js';\nexport {default as OverviewMap} from './control/OverviewMap.js';\nexport {default as Rotate} from './control/Rotate.js';\nexport {default as ScaleLine} from './control/ScaleLine.js';\nexport {default as Zoom} from './control/Zoom.js';\nexport {default as ZoomSlider} from './control/ZoomSlider.js';\nexport {default as ZoomToExtent} from './control/ZoomToExtent.js';\nexport {defaults} from './control/util.js';\n","/**\n * @module ol/webgl/Shader\n */\nimport {FALSE} from '../functions.js';\n\n/**\n * @constructor\n * @abstract\n * @param {string} source Source.\n * @struct\n */\nconst WebGLShader = function(source) {\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.source_ = source;\n\n};\n\n\n/**\n * @abstract\n * @return {number} Type.\n */\nWebGLShader.prototype.getType = function() {};\n\n\n/**\n * @return {string} Source.\n */\nWebGLShader.prototype.getSource = function() {\n  return this.source_;\n};\n\n\n/**\n * @return {boolean} Is animated?\n */\nWebGLShader.prototype.isAnimated = FALSE;\nexport default WebGLShader;\n","/**\n * @module ol/webgl/Fragment\n */\nimport {inherits} from '../util.js';\nimport {FRAGMENT_SHADER} from '../webgl.js';\nimport WebGLShader from '../webgl/Shader.js';\n\n/**\n * @constructor\n * @extends {module:ol/webgl/Shader}\n * @param {string} source Source.\n * @struct\n */\nconst WebGLFragment = function(source) {\n  WebGLShader.call(this, source);\n};\n\ninherits(WebGLFragment, WebGLShader);\n\n\n/**\n * @inheritDoc\n */\nWebGLFragment.prototype.getType = function() {\n  return FRAGMENT_SHADER;\n};\nexport default WebGLFragment;\n","/**\n * @module ol/webgl/Vertex\n */\nimport {inherits} from '../util.js';\nimport {VERTEX_SHADER} from '../webgl.js';\nimport WebGLShader from '../webgl/Shader.js';\n\n/**\n * @constructor\n * @extends {module:ol/webgl/Shader}\n * @param {string} source Source.\n * @struct\n */\nconst WebGLVertex = function(source) {\n  WebGLShader.call(this, source);\n};\n\ninherits(WebGLVertex, WebGLShader);\n\n\n/**\n * @inheritDoc\n */\nWebGLVertex.prototype.getType = function() {\n  return VERTEX_SHADER;\n};\nexport default WebGLVertex;\n","/**\n * @module ol/render/webgl/circlereplay/defaultshader\n */\n// This file is automatically generated, do not edit.\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG as DEBUG_WEBGL} from '../../../webgl.js';\nimport WebGLFragment from '../../../webgl/Fragment.js';\nimport WebGLVertex from '../../../webgl/Vertex.js';\n\nexport const fragment = new WebGLFragment(DEBUG_WEBGL ?\n  'precision mediump float;\\nvarying vec2 v_center;\\nvarying vec2 v_offset;\\nvarying float v_halfWidth;\\nvarying float v_pixelRatio;\\n\\n\\n\\nuniform float u_opacity;\\nuniform vec4 u_fillColor;\\nuniform vec4 u_strokeColor;\\nuniform vec2 u_size;\\n\\nvoid main(void) {\\n  vec2 windowCenter = vec2((v_center.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\\n      (v_center.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\\n  vec2 windowOffset = vec2((v_offset.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\\n      (v_offset.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\\n  float radius = length(windowCenter - windowOffset);\\n  float dist = length(windowCenter - gl_FragCoord.xy);\\n  if (dist > radius + v_halfWidth) {\\n    if (u_strokeColor.a == 0.0) {\\n      gl_FragColor = u_fillColor;\\n    } else {\\n      gl_FragColor = u_strokeColor;\\n    }\\n    gl_FragColor.a = gl_FragColor.a - (dist - (radius + v_halfWidth));\\n  } else if (u_fillColor.a == 0.0) {\\n    // Hooray, no fill, just stroke. We can use real antialiasing.\\n    gl_FragColor = u_strokeColor;\\n    if (dist < radius - v_halfWidth) {\\n      gl_FragColor.a = gl_FragColor.a - (radius - v_halfWidth - dist);\\n    }\\n  } else {\\n    gl_FragColor = u_fillColor;\\n    float strokeDist = radius - v_halfWidth;\\n    float antialias = 2.0 * v_pixelRatio;\\n    if (dist > strokeDist) {\\n      gl_FragColor = u_strokeColor;\\n    } else if (dist >= strokeDist - antialias) {\\n      float step = smoothstep(strokeDist - antialias, strokeDist, dist);\\n      gl_FragColor = mix(u_fillColor, u_strokeColor, step);\\n    }\\n  }\\n  gl_FragColor.a = gl_FragColor.a * u_opacity;\\n  if (gl_FragColor.a <= 0.0) {\\n    discard;\\n  }\\n}\\n' :\n  'precision mediump float;varying vec2 a;varying vec2 b;varying float c;varying float d;uniform float m;uniform vec4 n;uniform vec4 o;uniform vec2 p;void main(void){vec2 windowCenter=vec2((a.x+1.0)/2.0*p.x*d,(a.y+1.0)/2.0*p.y*d);vec2 windowOffset=vec2((b.x+1.0)/2.0*p.x*d,(b.y+1.0)/2.0*p.y*d);float radius=length(windowCenter-windowOffset);float dist=length(windowCenter-gl_FragCoord.xy);if(dist>radius+c){if(o.a==0.0){gl_FragColor=n;}else{gl_FragColor=o;}gl_FragColor.a=gl_FragColor.a-(dist-(radius+c));}else if(n.a==0.0){gl_FragColor=o;if(dist<radius-c){gl_FragColor.a=gl_FragColor.a-(radius-c-dist);}} else{gl_FragColor=n;float strokeDist=radius-c;float antialias=2.0*d;if(dist>strokeDist){gl_FragColor=o;}else if(dist>=strokeDist-antialias){float step=smoothstep(strokeDist-antialias,strokeDist,dist);gl_FragColor=mix(n,o,step);}} gl_FragColor.a=gl_FragColor.a*m;if(gl_FragColor.a<=0.0){discard;}}');\n\nexport const vertex = new WebGLVertex(DEBUG_WEBGL ?\n  'varying vec2 v_center;\\nvarying vec2 v_offset;\\nvarying float v_halfWidth;\\nvarying float v_pixelRatio;\\n\\n\\nattribute vec2 a_position;\\nattribute float a_instruction;\\nattribute float a_radius;\\n\\nuniform mat4 u_projectionMatrix;\\nuniform mat4 u_offsetScaleMatrix;\\nuniform mat4 u_offsetRotateMatrix;\\nuniform float u_lineWidth;\\nuniform float u_pixelRatio;\\n\\nvoid main(void) {\\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\\n  v_center = vec4(u_projectionMatrix * vec4(a_position, 0.0, 1.0)).xy;\\n  v_pixelRatio = u_pixelRatio;\\n  float lineWidth = u_lineWidth * u_pixelRatio;\\n  v_halfWidth = lineWidth / 2.0;\\n  if (lineWidth == 0.0) {\\n    lineWidth = 2.0 * u_pixelRatio;\\n  }\\n  vec2 offset;\\n  // Radius with anitaliasing (roughly).\\n  float radius = a_radius + 3.0 * u_pixelRatio;\\n  // Until we get gl_VertexID in WebGL, we store an instruction.\\n  if (a_instruction == 0.0) {\\n    // Offsetting the edges of the triangle by lineWidth / 2 is necessary, however\\n    // we should also leave some space for the antialiasing, thus we offset by lineWidth.\\n    offset = vec2(-1.0, 1.0);\\n  } else if (a_instruction == 1.0) {\\n    offset = vec2(-1.0, -1.0);\\n  } else if (a_instruction == 2.0) {\\n    offset = vec2(1.0, -1.0);\\n  } else {\\n    offset = vec2(1.0, 1.0);\\n  }\\n\\n  gl_Position = u_projectionMatrix * vec4(a_position + offset * radius, 0.0, 1.0) +\\n      offsetMatrix * vec4(offset * lineWidth, 0.0, 0.0);\\n  v_offset = vec4(u_projectionMatrix * vec4(a_position.x + a_radius, a_position.y,\\n      0.0, 1.0)).xy;\\n\\n  if (distance(v_center, v_offset) > 20000.0) {\\n    gl_Position = vec4(v_center, 0.0, 1.0);\\n  }\\n}\\n\\n\\n' :\n  'varying vec2 a;varying vec2 b;varying float c;varying float d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;void main(void){mat4 offsetMatrix=i*j;a=vec4(h*vec4(e,0.0,1.0)).xy;d=l;float lineWidth=k*l;c=lineWidth/2.0;if(lineWidth==0.0){lineWidth=2.0*l;}vec2 offset;float radius=g+3.0*l;if(f==0.0){offset=vec2(-1.0,1.0);}else if(f==1.0){offset=vec2(-1.0,-1.0);}else if(f==2.0){offset=vec2(1.0,-1.0);}else{offset=vec2(1.0,1.0);}gl_Position=h*vec4(e+offset*radius,0.0,1.0)+offsetMatrix*vec4(offset*lineWidth,0.0,0.0);b=vec4(h*vec4(e.x+g,e.y,0.0,1.0)).xy;if(distance(a,b)>20000.0){gl_Position=vec4(a,0.0,1.0);}}');\n","/**\n * @module ol/render/webgl/circlereplay/defaultshader/Locations\n */\n// This file is automatically generated, do not edit\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG as DEBUG_WEBGL} from '../../../../webgl.js';\n\n/**\n * @constructor\n * @param {WebGLRenderingContext} gl GL.\n * @param {WebGLProgram} program Program.\n * @struct\n */\nconst Locations = function(gl, program) {\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_projectionMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_projectionMatrix' : 'h');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetScaleMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetScaleMatrix' : 'i');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetRotateMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetRotateMatrix' : 'j');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_lineWidth = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_lineWidth' : 'k');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_pixelRatio = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_pixelRatio' : 'l');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_opacity = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_opacity' : 'm');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_fillColor = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_fillColor' : 'n');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_strokeColor = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_strokeColor' : 'o');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_size = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_size' : 'p');\n\n  /**\n   * @type {number}\n   */\n  this.a_position = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_position' : 'e');\n\n  /**\n   * @type {number}\n   */\n  this.a_instruction = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_instruction' : 'f');\n\n  /**\n   * @type {number}\n   */\n  this.a_radius = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_radius' : 'g');\n};\n\nexport default Locations;\n","/**\n * @module ol/vec/mat4\n */\n\n\n/**\n * @return {Array.<number>} 4x4 matrix representing a 3D identity transform.\n */\nexport function create() {\n  return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n}\n\n\n/**\n * @param {Array.<number>} mat4 Flattened 4x4 matrix receiving the result.\n * @param {module:ol/transform~Transform} transform Transformation matrix.\n * @return {Array.<number>} 2D transformation matrix as flattened 4x4 matrix.\n */\nexport function fromTransform(mat4, transform) {\n  mat4[0] = transform[0];\n  mat4[1] = transform[1];\n  mat4[4] = transform[2];\n  mat4[5] = transform[3];\n  mat4[12] = transform[4];\n  mat4[13] = transform[5];\n  return mat4;\n}\n","/**\n * @module ol/render/webgl/Replay\n */\nimport {inherits} from '../../util.js';\nimport {getCenter} from '../../extent.js';\nimport VectorContext from '../VectorContext.js';\nimport {\n  create as createTransform,\n  reset as resetTransform,\n  rotate as rotateTransform,\n  scale as scaleTransform,\n  translate as translateTransform\n} from '../../transform.js';\nimport {create, fromTransform} from '../../vec/mat4.js';\nimport {ARRAY_BUFFER, ELEMENT_ARRAY_BUFFER, TRIANGLES,\n  UNSIGNED_INT, UNSIGNED_SHORT} from '../../webgl.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/render/VectorContext}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @struct\n */\nconst WebGLReplay = function(tolerance, maxExtent) {\n  VectorContext.call(this);\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.tolerance = tolerance;\n\n  /**\n   * @protected\n   * @const\n   * @type {module:ol/extent~Extent}\n   */\n  this.maxExtent = maxExtent;\n\n  /**\n   * The origin of the coordinate system for the point coordinates sent to\n   * the GPU. To eliminate jitter caused by precision problems in the GPU\n   * we use the \"Rendering Relative to Eye\" technique described in the \"3D\n   * Engine Design for Virtual Globes\" book.\n   * @protected\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.origin = getCenter(maxExtent);\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.projectionMatrix_ = createTransform();\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.offsetRotateMatrix_ = createTransform();\n\n  /**\n   * @private\n   * @type {module:ol/transform~Transform}\n   */\n  this.offsetScaleMatrix_ = createTransform();\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.tmpMat4_ = create();\n\n  /**\n   * @protected\n   * @type {Array.<number>}\n   */\n  this.indices = [];\n\n  /**\n   * @protected\n   * @type {?module:ol/webgl/Buffer}\n   */\n  this.indicesBuffer = null;\n\n  /**\n   * Start index per feature (the index).\n   * @protected\n   * @type {Array.<number>}\n   */\n  this.startIndices = [];\n\n  /**\n   * Start index per feature (the feature).\n   * @protected\n   * @type {Array.<module:ol/Feature|module:ol/render/Feature>}\n   */\n  this.startIndicesFeature = [];\n\n  /**\n   * @protected\n   * @type {Array.<number>}\n   */\n  this.vertices = [];\n\n  /**\n   * @protected\n   * @type {?module:ol/webgl/Buffer}\n   */\n  this.verticesBuffer = null;\n\n  /**\n   * Optional parameter for PolygonReplay instances.\n   * @protected\n   * @type {module:ol/render/webgl/LineStringReplay|undefined}\n   */\n  this.lineStringReplay = undefined;\n\n};\n\ninherits(WebGLReplay, VectorContext);\n\n\n/**\n * @abstract\n * @param {module:ol/webgl/Context} context WebGL context.\n * @return {function()} Delete resources function.\n */\nWebGLReplay.prototype.getDeleteResourcesFunction = function(context) {};\n\n\n/**\n * @abstract\n * @param {module:ol/webgl/Context} context Context.\n */\nWebGLReplay.prototype.finish = function(context) {};\n\n\n/**\n * @abstract\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {module:ol/size~Size} size Size.\n * @param {number} pixelRatio Pixel ratio.\n * @return {module:ol/render/webgl/circlereplay/defaultshader/Locations|\n            module:ol/render/webgl/linestringreplay/defaultshader/Locations|\n            module:ol/render/webgl/polygonreplay/defaultshader/Locations|\n            module:ol/render/webgl/texturereplay/defaultshader/Locations} Locations.\n */\nWebGLReplay.prototype.setUpProgram = function(gl, context, size, pixelRatio) {};\n\n\n/**\n * @abstract\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/render/webgl/circlereplay/defaultshader/Locations|\n           module:ol/render/webgl/linestringreplay/defaultshader/Locations|\n           module:ol/render/webgl/polygonreplay/defaultshader/Locations|\n           module:ol/render/webgl/texturereplay/defaultshader/Locations} locations Locations.\n */\nWebGLReplay.prototype.shutDownProgram = function(gl, locations) {};\n\n\n/**\n * @abstract\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {boolean} hitDetection Hit detection mode.\n */\nWebGLReplay.prototype.drawReplay = function(gl, context, skippedFeaturesHash, hitDetection) {};\n\n\n/**\n * @abstract\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined} featureCallback Feature callback.\n * @param {module:ol/extent~Extent=} opt_hitExtent Hit extent: Only features intersecting this extent are checked.\n * @return {T|undefined} Callback result.\n * @template T\n */\nWebGLReplay.prototype.drawHitDetectionReplayOneByOne = function(gl, context, skippedFeaturesHash, featureCallback, opt_hitExtent) {};\n\n\n/**\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined} featureCallback Feature callback.\n * @param {boolean} oneByOne Draw features one-by-one for the hit-detecion.\n * @param {module:ol/extent~Extent=} opt_hitExtent Hit extent: Only features intersecting\n *  this extent are checked.\n * @return {T|undefined} Callback result.\n * @template T\n */\nWebGLReplay.prototype.drawHitDetectionReplay = function(gl, context, skippedFeaturesHash,\n  featureCallback, oneByOne, opt_hitExtent) {\n  if (!oneByOne) {\n    // draw all hit-detection features in \"once\" (by texture group)\n    return this.drawHitDetectionReplayAll(gl, context,\n      skippedFeaturesHash, featureCallback);\n  } else {\n    // draw hit-detection features one by one\n    return this.drawHitDetectionReplayOneByOne(gl, context,\n      skippedFeaturesHash, featureCallback, opt_hitExtent);\n  }\n};\n\n\n/**\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined} featureCallback Feature callback.\n * @return {T|undefined} Callback result.\n * @template T\n */\nWebGLReplay.prototype.drawHitDetectionReplayAll = function(gl, context, skippedFeaturesHash,\n  featureCallback) {\n  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n  this.drawReplay(gl, context, skippedFeaturesHash, true);\n\n  const result = featureCallback(null);\n  if (result) {\n    return result;\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * @param {module:ol/webgl/Context} context Context.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {module:ol/size~Size} size Size.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} opacity Global opacity.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined} featureCallback Feature callback.\n * @param {boolean} oneByOne Draw features one-by-one for the hit-detecion.\n * @param {module:ol/extent~Extent=} opt_hitExtent Hit extent: Only features intersecting\n *  this extent are checked.\n * @return {T|undefined} Callback result.\n * @template T\n */\nWebGLReplay.prototype.replay = function(context,\n  center, resolution, rotation, size, pixelRatio,\n  opacity, skippedFeaturesHash,\n  featureCallback, oneByOne, opt_hitExtent) {\n  const gl = context.getGL();\n  let tmpStencil, tmpStencilFunc, tmpStencilMaskVal, tmpStencilRef, tmpStencilMask,\n      tmpStencilOpFail, tmpStencilOpPass, tmpStencilOpZFail;\n\n  if (this.lineStringReplay) {\n    tmpStencil = gl.isEnabled(gl.STENCIL_TEST);\n    tmpStencilFunc = gl.getParameter(gl.STENCIL_FUNC);\n    tmpStencilMaskVal = gl.getParameter(gl.STENCIL_VALUE_MASK);\n    tmpStencilRef = gl.getParameter(gl.STENCIL_REF);\n    tmpStencilMask = gl.getParameter(gl.STENCIL_WRITEMASK);\n    tmpStencilOpFail = gl.getParameter(gl.STENCIL_FAIL);\n    tmpStencilOpPass = gl.getParameter(gl.STENCIL_PASS_DEPTH_PASS);\n    tmpStencilOpZFail = gl.getParameter(gl.STENCIL_PASS_DEPTH_FAIL);\n\n    gl.enable(gl.STENCIL_TEST);\n    gl.clear(gl.STENCIL_BUFFER_BIT);\n    gl.stencilMask(255);\n    gl.stencilFunc(gl.ALWAYS, 1, 255);\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.REPLACE);\n\n    this.lineStringReplay.replay(context,\n      center, resolution, rotation, size, pixelRatio,\n      opacity, skippedFeaturesHash,\n      featureCallback, oneByOne, opt_hitExtent);\n\n    gl.stencilMask(0);\n    gl.stencilFunc(gl.NOTEQUAL, 1, 255);\n  }\n\n  context.bindBuffer(ARRAY_BUFFER, this.verticesBuffer);\n\n  context.bindBuffer(ELEMENT_ARRAY_BUFFER, this.indicesBuffer);\n\n  const locations = this.setUpProgram(gl, context, size, pixelRatio);\n\n  // set the \"uniform\" values\n  const projectionMatrix = resetTransform(this.projectionMatrix_);\n  scaleTransform(projectionMatrix, 2 / (resolution * size[0]), 2 / (resolution * size[1]));\n  rotateTransform(projectionMatrix, -rotation);\n  translateTransform(projectionMatrix, -(center[0] - this.origin[0]), -(center[1] - this.origin[1]));\n\n  const offsetScaleMatrix = resetTransform(this.offsetScaleMatrix_);\n  scaleTransform(offsetScaleMatrix, 2 / size[0], 2 / size[1]);\n\n  const offsetRotateMatrix = resetTransform(this.offsetRotateMatrix_);\n  if (rotation !== 0) {\n    rotateTransform(offsetRotateMatrix, -rotation);\n  }\n\n  gl.uniformMatrix4fv(locations.u_projectionMatrix, false,\n    fromTransform(this.tmpMat4_, projectionMatrix));\n  gl.uniformMatrix4fv(locations.u_offsetScaleMatrix, false,\n    fromTransform(this.tmpMat4_, offsetScaleMatrix));\n  gl.uniformMatrix4fv(locations.u_offsetRotateMatrix, false,\n    fromTransform(this.tmpMat4_, offsetRotateMatrix));\n  gl.uniform1f(locations.u_opacity, opacity);\n\n  // draw!\n  let result;\n  if (featureCallback === undefined) {\n    this.drawReplay(gl, context, skippedFeaturesHash, false);\n  } else {\n    // draw feature by feature for the hit-detection\n    result = this.drawHitDetectionReplay(gl, context, skippedFeaturesHash,\n      featureCallback, oneByOne, opt_hitExtent);\n  }\n\n  // disable the vertex attrib arrays\n  this.shutDownProgram(gl, locations);\n\n  if (this.lineStringReplay) {\n    if (!tmpStencil) {\n      gl.disable(gl.STENCIL_TEST);\n    }\n    gl.clear(gl.STENCIL_BUFFER_BIT);\n    gl.stencilFunc(/** @type {number} */ (tmpStencilFunc),\n      /** @type {number} */ (tmpStencilRef), /** @type {number} */ (tmpStencilMaskVal));\n    gl.stencilMask(/** @type {number} */ (tmpStencilMask));\n    gl.stencilOp(/** @type {number} */ (tmpStencilOpFail),\n      /** @type {number} */ (tmpStencilOpZFail), /** @type {number} */ (tmpStencilOpPass));\n  }\n\n  return result;\n};\n\n/**\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {number} start Start index.\n * @param {number} end End index.\n */\nWebGLReplay.prototype.drawElements = function(\n  gl, context, start, end) {\n  const elementType = context.hasOESElementIndexUint ?\n    UNSIGNED_INT : UNSIGNED_SHORT;\n  const elementSize = context.hasOESElementIndexUint ? 4 : 2;\n\n  const numItems = end - start;\n  const offsetInBytes = start * elementSize;\n  gl.drawElements(TRIANGLES, numItems, elementType, offsetInBytes);\n};\nexport default WebGLReplay;\n","/**\n * @module ol/render/webgl\n */\n\n\n/**\n * @const\n * @type {string}\n */\nexport const DEFAULT_FONT = '10px sans-serif';\n\n\n/**\n * @const\n * @type {module:ol/color~Color}\n */\nexport const DEFAULT_FILLSTYLE = [0.0, 0.0, 0.0, 1.0];\n\n\n/**\n * @const\n * @type {string}\n */\nexport const DEFAULT_LINECAP = 'round';\n\n\n/**\n * @const\n * @type {Array.<number>}\n */\nexport const DEFAULT_LINEDASH = [];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DEFAULT_LINEDASHOFFSET = 0;\n\n\n/**\n * @const\n * @type {string}\n */\nexport const DEFAULT_LINEJOIN = 'round';\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DEFAULT_MITERLIMIT = 10;\n\n/**\n * @const\n * @type {module:ol/color~Color}\n */\nexport const DEFAULT_STROKESTYLE = [0.0, 0.0, 0.0, 1.0];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DEFAULT_TEXTALIGN = 0.5;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DEFAULT_TEXTBASELINE = 0.5;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const DEFAULT_LINEWIDTH = 1;\n\n/**\n * @const\n * @type {number}\n */\nexport const EPSILON = Number.EPSILON || 2.220446049250313e-16;\n\n/**\n * Calculates the orientation of a triangle based on the determinant method.\n * @param {number} x1 First X coordinate.\n * @param {number} y1 First Y coordinate.\n * @param {number} x2 Second X coordinate.\n * @param {number} y2 Second Y coordinate.\n * @param {number} x3 Third X coordinate.\n * @param {number} y3 Third Y coordinate.\n * @return {boolean|undefined} Triangle is clockwise.\n */\nexport const triangleIsCounterClockwise = function(x1, y1, x2, y2, x3, y3) {\n  const area = (x2 - x1) * (y3 - y1) - (x3 - x1) * (y2 - y1);\n  return (area <= EPSILON && area >= -EPSILON) ?\n    undefined : area > 0;\n};\n\n","/**\n * @module ol/webgl/Buffer\n */\nimport {STATIC_DRAW, STREAM_DRAW, DYNAMIC_DRAW} from '../webgl.js';\n\n/**\n * @enum {number}\n */\nconst BufferUsage = {\n  STATIC_DRAW: STATIC_DRAW,\n  STREAM_DRAW: STREAM_DRAW,\n  DYNAMIC_DRAW: DYNAMIC_DRAW\n};\n\n/**\n * @constructor\n * @param {Array.<number>=} opt_arr Array.\n * @param {number=} opt_usage Usage.\n * @struct\n */\nconst WebGLBuffer = function(opt_arr, opt_usage) {\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.arr_ = opt_arr !== undefined ? opt_arr : [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.usage_ = opt_usage !== undefined ? opt_usage : BufferUsage.STATIC_DRAW;\n\n};\n\n\n/**\n * @return {Array.<number>} Array.\n */\nWebGLBuffer.prototype.getArray = function() {\n  return this.arr_;\n};\n\n\n/**\n * @return {number} Usage.\n */\nWebGLBuffer.prototype.getUsage = function() {\n  return this.usage_;\n};\n\nexport default WebGLBuffer;\n","/**\n * @module ol/render/webgl/CircleReplay\n */\nimport {getUid, inherits} from '../../util.js';\nimport {equals} from '../../array.js';\nimport {asArray} from '../../color.js';\nimport {intersects} from '../../extent.js';\nimport {isEmpty} from '../../obj.js';\nimport {translate} from '../../geom/flat/transform.js';\nimport {fragment, vertex} from '../webgl/circlereplay/defaultshader.js';\nimport Locations from '../webgl/circlereplay/defaultshader/Locations.js';\nimport WebGLReplay from '../webgl/Replay.js';\nimport {DEFAULT_LINEDASH, DEFAULT_LINEDASHOFFSET, DEFAULT_STROKESTYLE,\n  DEFAULT_FILLSTYLE, DEFAULT_LINEWIDTH} from '../webgl.js';\nimport {FLOAT} from '../../webgl.js';\nimport WebGLBuffer from '../../webgl/Buffer.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/webgl/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @struct\n */\nconst WebGLCircleReplay = function(tolerance, maxExtent) {\n  WebGLReplay.call(this, tolerance, maxExtent);\n\n  /**\n   * @private\n   * @type {module:ol/render/webgl/circlereplay/defaultshader/Locations}\n   */\n  this.defaultLocations_ = null;\n\n  /**\n   * @private\n   * @type {Array.<Array.<Array.<number>|number>>}\n   */\n  this.styles_ = [];\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.styleIndices_ = [];\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.radius_ = 0;\n\n  /**\n   * @private\n   * @type {{fillColor: (Array.<number>|null),\n   *         strokeColor: (Array.<number>|null),\n   *         lineDash: Array.<number>,\n   *         lineDashOffset: (number|undefined),\n   *         lineWidth: (number|undefined),\n   *         changed: boolean}|null}\n   */\n  this.state_ = {\n    fillColor: null,\n    strokeColor: null,\n    lineDash: null,\n    lineDashOffset: undefined,\n    lineWidth: undefined,\n    changed: false\n  };\n\n};\n\ninherits(WebGLCircleReplay, WebGLReplay);\n\n\n/**\n * @private\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n */\nWebGLCircleReplay.prototype.drawCoordinates_ = function(\n  flatCoordinates, offset, end, stride) {\n  let numVertices = this.vertices.length;\n  let numIndices = this.indices.length;\n  let n = numVertices / 4;\n  let i, ii;\n  for (i = offset, ii = end; i < ii; i += stride) {\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 0;\n    this.vertices[numVertices++] = this.radius_;\n\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 1;\n    this.vertices[numVertices++] = this.radius_;\n\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 2;\n    this.vertices[numVertices++] = this.radius_;\n\n    this.vertices[numVertices++] = flatCoordinates[i];\n    this.vertices[numVertices++] = flatCoordinates[i + 1];\n    this.vertices[numVertices++] = 3;\n    this.vertices[numVertices++] = this.radius_;\n\n    this.indices[numIndices++] = n;\n    this.indices[numIndices++] = n + 1;\n    this.indices[numIndices++] = n + 2;\n\n    this.indices[numIndices++] = n + 2;\n    this.indices[numIndices++] = n + 3;\n    this.indices[numIndices++] = n;\n\n    n += 4;\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLCircleReplay.prototype.drawCircle = function(circleGeometry, feature) {\n  const radius = circleGeometry.getRadius();\n  const stride = circleGeometry.getStride();\n  if (radius) {\n    this.startIndices.push(this.indices.length);\n    this.startIndicesFeature.push(feature);\n    if (this.state_.changed) {\n      this.styleIndices_.push(this.indices.length);\n      this.state_.changed = false;\n    }\n\n    this.radius_ = radius;\n    let flatCoordinates = circleGeometry.getFlatCoordinates();\n    flatCoordinates = translate(flatCoordinates, 0, 2,\n      stride, -this.origin[0], -this.origin[1]);\n    this.drawCoordinates_(flatCoordinates, 0, 2, stride);\n  } else {\n    if (this.state_.changed) {\n      this.styles_.pop();\n      if (this.styles_.length) {\n        const lastState = this.styles_[this.styles_.length - 1];\n        this.state_.fillColor =  /** @type {Array.<number>} */ (lastState[0]);\n        this.state_.strokeColor = /** @type {Array.<number>} */ (lastState[1]);\n        this.state_.lineWidth = /** @type {number} */ (lastState[2]);\n        this.state_.changed = false;\n      }\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n **/\nWebGLCircleReplay.prototype.finish = function(context) {\n  // create, bind, and populate the vertices buffer\n  this.verticesBuffer = new WebGLBuffer(this.vertices);\n\n  // create, bind, and populate the indices buffer\n  this.indicesBuffer = new WebGLBuffer(this.indices);\n\n  this.startIndices.push(this.indices.length);\n\n  //Clean up, if there is nothing to draw\n  if (this.styleIndices_.length === 0 && this.styles_.length > 0) {\n    this.styles_ = [];\n  }\n\n  this.vertices = null;\n  this.indices = null;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLCircleReplay.prototype.getDeleteResourcesFunction = function(context) {\n  // We only delete our stuff here. The shaders and the program may\n  // be used by other CircleReplay instances (for other layers). And\n  // they will be deleted when disposing of the module:ol/webgl/Context~WebGLContext\n  // object.\n  const verticesBuffer = this.verticesBuffer;\n  const indicesBuffer = this.indicesBuffer;\n  return function() {\n    context.deleteBuffer(verticesBuffer);\n    context.deleteBuffer(indicesBuffer);\n  };\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLCircleReplay.prototype.setUpProgram = function(gl, context, size, pixelRatio) {\n  // get the program\n  const program = context.getProgram(fragment, vertex);\n\n  // get the locations\n  let locations;\n  if (!this.defaultLocations_) {\n    locations = new Locations(gl, program);\n    this.defaultLocations_ = locations;\n  } else {\n    locations = this.defaultLocations_;\n  }\n\n  context.useProgram(program);\n\n  // enable the vertex attrib arrays\n  gl.enableVertexAttribArray(locations.a_position);\n  gl.vertexAttribPointer(locations.a_position, 2, FLOAT,\n    false, 16, 0);\n\n  gl.enableVertexAttribArray(locations.a_instruction);\n  gl.vertexAttribPointer(locations.a_instruction, 1, FLOAT,\n    false, 16, 8);\n\n  gl.enableVertexAttribArray(locations.a_radius);\n  gl.vertexAttribPointer(locations.a_radius, 1, FLOAT,\n    false, 16, 12);\n\n  // Enable renderer specific uniforms.\n  gl.uniform2fv(locations.u_size, size);\n  gl.uniform1f(locations.u_pixelRatio, pixelRatio);\n\n  return locations;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLCircleReplay.prototype.shutDownProgram = function(gl, locations) {\n  gl.disableVertexAttribArray(locations.a_position);\n  gl.disableVertexAttribArray(locations.a_instruction);\n  gl.disableVertexAttribArray(locations.a_radius);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLCircleReplay.prototype.drawReplay = function(gl, context, skippedFeaturesHash, hitDetection) {\n  if (!isEmpty(skippedFeaturesHash)) {\n    this.drawReplaySkipping_(gl, context, skippedFeaturesHash);\n  } else {\n    //Draw by style groups to minimize drawElements() calls.\n    let i, start, end, nextStyle;\n    end = this.startIndices[this.startIndices.length - 1];\n    for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n      start = this.styleIndices_[i];\n      nextStyle = this.styles_[i];\n      this.setFillStyle_(gl, /** @type {Array.<number>} */ (nextStyle[0]));\n      this.setStrokeStyle_(gl, /** @type {Array.<number>} */ (nextStyle[1]),\n        /** @type {number} */ (nextStyle[2]));\n      this.drawElements(gl, context, start, end);\n      end = start;\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLCircleReplay.prototype.drawHitDetectionReplayOneByOne = function(gl, context, skippedFeaturesHash,\n  featureCallback, opt_hitExtent) {\n  let i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex;\n  featureIndex = this.startIndices.length - 2;\n  end = this.startIndices[featureIndex + 1];\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setFillStyle_(gl, /** @type {Array.<number>} */ (nextStyle[0]));\n    this.setStrokeStyle_(gl, /** @type {Array.<number>} */ (nextStyle[1]),\n      /** @type {number} */ (nextStyle[2]));\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      start = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid] === undefined &&\n          feature.getGeometry() &&\n          (opt_hitExtent === undefined || intersects(\n            /** @type {Array<number>} */ (opt_hitExtent),\n            feature.getGeometry().getExtent()))) {\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n        this.drawElements(gl, context, start, end);\n\n        const result = featureCallback(feature);\n\n        if (result) {\n          return result;\n        }\n\n      }\n      featureIndex--;\n      end = start;\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object} skippedFeaturesHash Ids of features to skip.\n */\nWebGLCircleReplay.prototype.drawReplaySkipping_ = function(gl, context, skippedFeaturesHash) {\n  let i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex, featureStart;\n  featureIndex = this.startIndices.length - 2;\n  end = start = this.startIndices[featureIndex + 1];\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setFillStyle_(gl, /** @type {Array.<number>} */ (nextStyle[0]));\n    this.setStrokeStyle_(gl, /** @type {Array.<number>} */ (nextStyle[1]),\n      /** @type {number} */ (nextStyle[2]));\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      featureStart = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid]) {\n        if (start !== end) {\n          this.drawElements(gl, context, start, end);\n        }\n        end = featureStart;\n      }\n      featureIndex--;\n      start = featureStart;\n    }\n    if (start !== end) {\n      this.drawElements(gl, context, start, end);\n    }\n    start = end = groupStart;\n  }\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {Array.<number>} color Color.\n */\nWebGLCircleReplay.prototype.setFillStyle_ = function(gl, color) {\n  gl.uniform4fv(this.defaultLocations_.u_fillColor, color);\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {Array.<number>} color Color.\n * @param {number} lineWidth Line width.\n */\nWebGLCircleReplay.prototype.setStrokeStyle_ = function(gl, color, lineWidth) {\n  gl.uniform4fv(this.defaultLocations_.u_strokeColor, color);\n  gl.uniform1f(this.defaultLocations_.u_lineWidth, lineWidth);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLCircleReplay.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {\n  let strokeStyleColor, strokeStyleWidth;\n  if (strokeStyle) {\n    const strokeStyleLineDash = strokeStyle.getLineDash();\n    this.state_.lineDash = strokeStyleLineDash ?\n      strokeStyleLineDash : DEFAULT_LINEDASH;\n    const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n    this.state_.lineDashOffset = strokeStyleLineDashOffset ?\n      strokeStyleLineDashOffset : DEFAULT_LINEDASHOFFSET;\n    strokeStyleColor = strokeStyle.getColor();\n    if (!(strokeStyleColor instanceof CanvasGradient) &&\n        !(strokeStyleColor instanceof CanvasPattern)) {\n      strokeStyleColor = asArray(strokeStyleColor).map(function(c, i) {\n        return i != 3 ? c / 255 : c;\n      }) || DEFAULT_STROKESTYLE;\n    } else {\n      strokeStyleColor = DEFAULT_STROKESTYLE;\n    }\n    strokeStyleWidth = strokeStyle.getWidth();\n    strokeStyleWidth = strokeStyleWidth !== undefined ?\n      strokeStyleWidth : DEFAULT_LINEWIDTH;\n  } else {\n    strokeStyleColor = [0, 0, 0, 0];\n    strokeStyleWidth = 0;\n  }\n  let fillStyleColor = fillStyle ? fillStyle.getColor() : [0, 0, 0, 0];\n  if (!(fillStyleColor instanceof CanvasGradient) &&\n      !(fillStyleColor instanceof CanvasPattern)) {\n    fillStyleColor = asArray(fillStyleColor).map(function(c, i) {\n      return i != 3 ? c / 255 : c;\n    }) || DEFAULT_FILLSTYLE;\n  } else {\n    fillStyleColor = DEFAULT_FILLSTYLE;\n  }\n  if (!this.state_.strokeColor || !equals(this.state_.strokeColor, strokeStyleColor) ||\n      !this.state_.fillColor || !equals(this.state_.fillColor, fillStyleColor) ||\n      this.state_.lineWidth !== strokeStyleWidth) {\n    this.state_.changed = true;\n    this.state_.fillColor = fillStyleColor;\n    this.state_.strokeColor = strokeStyleColor;\n    this.state_.lineWidth = strokeStyleWidth;\n    this.styles_.push([fillStyleColor, strokeStyleColor, strokeStyleWidth]);\n  }\n};\nexport default WebGLCircleReplay;\n","/**\n * @module ol/render/webgl/texturereplay/defaultshader\n */\n// This file is automatically generated, do not edit.\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG as DEBUG_WEBGL} from '../../../webgl.js';\nimport WebGLFragment from '../../../webgl/Fragment.js';\nimport WebGLVertex from '../../../webgl/Vertex.js';\n\nexport const fragment = new WebGLFragment(DEBUG_WEBGL ?\n  'precision mediump float;\\nvarying vec2 v_texCoord;\\nvarying float v_opacity;\\n\\nuniform float u_opacity;\\nuniform sampler2D u_image;\\n\\nvoid main(void) {\\n  vec4 texColor = texture2D(u_image, v_texCoord);\\n  gl_FragColor.rgb = texColor.rgb;\\n  float alpha = texColor.a * v_opacity * u_opacity;\\n  if (alpha == 0.0) {\\n    discard;\\n  }\\n  gl_FragColor.a = alpha;\\n}\\n' :\n  'precision mediump float;varying vec2 a;varying float b;uniform float k;uniform sampler2D l;void main(void){vec4 texColor=texture2D(l,a);gl_FragColor.rgb=texColor.rgb;float alpha=texColor.a*b*k;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}');\n\nexport const vertex = new WebGLVertex(DEBUG_WEBGL ?\n  'varying vec2 v_texCoord;\\nvarying float v_opacity;\\n\\nattribute vec2 a_position;\\nattribute vec2 a_texCoord;\\nattribute vec2 a_offsets;\\nattribute float a_opacity;\\nattribute float a_rotateWithView;\\n\\nuniform mat4 u_projectionMatrix;\\nuniform mat4 u_offsetScaleMatrix;\\nuniform mat4 u_offsetRotateMatrix;\\n\\nvoid main(void) {\\n  mat4 offsetMatrix = u_offsetScaleMatrix;\\n  if (a_rotateWithView == 1.0) {\\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\\n  }\\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0.0, 0.0);\\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\\n  v_texCoord = a_texCoord;\\n  v_opacity = a_opacity;\\n}\\n\\n\\n' :\n  'varying vec2 a;varying float b;attribute vec2 c;attribute vec2 d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;void main(void){mat4 offsetMatrix=i;if(g==1.0){offsetMatrix=i*j;}vec4 offsets=offsetMatrix*vec4(e,0.0,0.0);gl_Position=h*vec4(c,0.0,1.0)+offsets;a=d;b=f;}');\n","/**\n * @module ol/render/webgl/texturereplay/defaultshader/Locations\n */\n// This file is automatically generated, do not edit\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG as DEBUG_WEBGL} from '../../../../webgl.js';\n\n/**\n * @constructor\n * @param {WebGLRenderingContext} gl GL.\n * @param {WebGLProgram} program Program.\n * @struct\n */\nconst Locations = function(gl, program) {\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_projectionMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_projectionMatrix' : 'h');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetScaleMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetScaleMatrix' : 'i');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetRotateMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetRotateMatrix' : 'j');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_opacity = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_opacity' : 'k');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_image = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_image' : 'l');\n\n  /**\n   * @type {number}\n   */\n  this.a_position = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_position' : 'c');\n\n  /**\n   * @type {number}\n   */\n  this.a_texCoord = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_texCoord' : 'd');\n\n  /**\n   * @type {number}\n   */\n  this.a_offsets = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_offsets' : 'e');\n\n  /**\n   * @type {number}\n   */\n  this.a_opacity = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_opacity' : 'f');\n\n  /**\n   * @type {number}\n   */\n  this.a_rotateWithView = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_rotateWithView' : 'g');\n};\n\nexport default Locations;\n","/**\n * @module ol/webgl/ContextEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  LOST: 'webglcontextlost',\n  RESTORED: 'webglcontextrestored'\n};\n","/**\n * @module ol/webgl/Context\n */\nimport {getUid, inherits} from '../util.js';\nimport {EXTENSIONS as WEBGL_EXTENSIONS} from '../webgl.js';\nimport Disposable from '../Disposable.js';\nimport {includes} from '../array.js';\nimport {listen, unlistenAll} from '../events.js';\nimport {clear} from '../obj.js';\nimport {ARRAY_BUFFER, ELEMENT_ARRAY_BUFFER, TEXTURE_2D, TEXTURE_WRAP_S, TEXTURE_WRAP_T} from '../webgl.js';\nimport ContextEventType from '../webgl/ContextEventType.js';\n\n\n/**\n * @typedef {Object} BufferCacheEntry\n * @property {module:ol/webgl/Buffer} buf\n * @property {WebGLBuffer} buffer\n */\n\n\n/**\n * @classdesc\n * A WebGL context for accessing low-level WebGL capabilities.\n *\n * @constructor\n * @extends {module:ol/Disposable}\n * @param {HTMLCanvasElement} canvas Canvas.\n * @param {WebGLRenderingContext} gl GL.\n */\nconst WebGLContext = function(canvas, gl) {\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = canvas;\n\n  /**\n   * @private\n   * @type {WebGLRenderingContext}\n   */\n  this.gl_ = gl;\n\n  /**\n   * @private\n   * @type {!Object.<string, module:ol/webgl/Context~BufferCacheEntry>}\n   */\n  this.bufferCache_ = {};\n\n  /**\n   * @private\n   * @type {!Object.<string, WebGLShader>}\n   */\n  this.shaderCache_ = {};\n\n  /**\n   * @private\n   * @type {!Object.<string, WebGLProgram>}\n   */\n  this.programCache_ = {};\n\n  /**\n   * @private\n   * @type {WebGLProgram}\n   */\n  this.currentProgram_ = null;\n\n  /**\n   * @private\n   * @type {WebGLFramebuffer}\n   */\n  this.hitDetectionFramebuffer_ = null;\n\n  /**\n   * @private\n   * @type {WebGLTexture}\n   */\n  this.hitDetectionTexture_ = null;\n\n  /**\n   * @private\n   * @type {WebGLRenderbuffer}\n   */\n  this.hitDetectionRenderbuffer_ = null;\n\n  /**\n   * @type {boolean}\n   */\n  this.hasOESElementIndexUint = includes(WEBGL_EXTENSIONS, 'OES_element_index_uint');\n\n  // use the OES_element_index_uint extension if available\n  if (this.hasOESElementIndexUint) {\n    gl.getExtension('OES_element_index_uint');\n  }\n\n  listen(this.canvas_, ContextEventType.LOST,\n    this.handleWebGLContextLost, this);\n  listen(this.canvas_, ContextEventType.RESTORED,\n    this.handleWebGLContextRestored, this);\n\n};\n\ninherits(WebGLContext, Disposable);\n\n\n/**\n * Just bind the buffer if it's in the cache. Otherwise create\n * the WebGL buffer, bind it, populate it, and add an entry to\n * the cache.\n * @param {number} target Target.\n * @param {module:ol/webgl/Buffer} buf Buffer.\n */\nWebGLContext.prototype.bindBuffer = function(target, buf) {\n  const gl = this.getGL();\n  const arr = buf.getArray();\n  const bufferKey = String(getUid(buf));\n  if (bufferKey in this.bufferCache_) {\n    const bufferCacheEntry = this.bufferCache_[bufferKey];\n    gl.bindBuffer(target, bufferCacheEntry.buffer);\n  } else {\n    const buffer = gl.createBuffer();\n    gl.bindBuffer(target, buffer);\n    let /** @type {ArrayBufferView} */ arrayBuffer;\n    if (target == ARRAY_BUFFER) {\n      arrayBuffer = new Float32Array(arr);\n    } else if (target == ELEMENT_ARRAY_BUFFER) {\n      arrayBuffer = this.hasOESElementIndexUint ?\n        new Uint32Array(arr) : new Uint16Array(arr);\n    }\n    gl.bufferData(target, arrayBuffer, buf.getUsage());\n    this.bufferCache_[bufferKey] = {\n      buf: buf,\n      buffer: buffer\n    };\n  }\n};\n\n\n/**\n * @param {module:ol/webgl/Buffer} buf Buffer.\n */\nWebGLContext.prototype.deleteBuffer = function(buf) {\n  const gl = this.getGL();\n  const bufferKey = String(getUid(buf));\n  const bufferCacheEntry = this.bufferCache_[bufferKey];\n  if (!gl.isContextLost()) {\n    gl.deleteBuffer(bufferCacheEntry.buffer);\n  }\n  delete this.bufferCache_[bufferKey];\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLContext.prototype.disposeInternal = function() {\n  unlistenAll(this.canvas_);\n  const gl = this.getGL();\n  if (!gl.isContextLost()) {\n    for (const key in this.bufferCache_) {\n      gl.deleteBuffer(this.bufferCache_[key].buffer);\n    }\n    for (const key in this.programCache_) {\n      gl.deleteProgram(this.programCache_[key]);\n    }\n    for (const key in this.shaderCache_) {\n      gl.deleteShader(this.shaderCache_[key]);\n    }\n    // delete objects for hit-detection\n    gl.deleteFramebuffer(this.hitDetectionFramebuffer_);\n    gl.deleteRenderbuffer(this.hitDetectionRenderbuffer_);\n    gl.deleteTexture(this.hitDetectionTexture_);\n  }\n};\n\n\n/**\n * @return {HTMLCanvasElement} Canvas.\n */\nWebGLContext.prototype.getCanvas = function() {\n  return this.canvas_;\n};\n\n\n/**\n * Get the WebGL rendering context\n * @return {WebGLRenderingContext} The rendering context.\n * @api\n */\nWebGLContext.prototype.getGL = function() {\n  return this.gl_;\n};\n\n\n/**\n * Get the frame buffer for hit detection.\n * @return {WebGLFramebuffer} The hit detection frame buffer.\n */\nWebGLContext.prototype.getHitDetectionFramebuffer = function() {\n  if (!this.hitDetectionFramebuffer_) {\n    this.initHitDetectionFramebuffer_();\n  }\n  return this.hitDetectionFramebuffer_;\n};\n\n\n/**\n * Get shader from the cache if it's in the cache. Otherwise, create\n * the WebGL shader, compile it, and add entry to cache.\n * @param {module:ol/webgl/Shader} shaderObject Shader object.\n * @return {WebGLShader} Shader.\n */\nWebGLContext.prototype.getShader = function(shaderObject) {\n  const shaderKey = String(getUid(shaderObject));\n  if (shaderKey in this.shaderCache_) {\n    return this.shaderCache_[shaderKey];\n  } else {\n    const gl = this.getGL();\n    const shader = gl.createShader(shaderObject.getType());\n    gl.shaderSource(shader, shaderObject.getSource());\n    gl.compileShader(shader);\n    this.shaderCache_[shaderKey] = shader;\n    return shader;\n  }\n};\n\n\n/**\n * Get the program from the cache if it's in the cache. Otherwise create\n * the WebGL program, attach the shaders to it, and add an entry to the\n * cache.\n * @param {module:ol/webgl/Fragment} fragmentShaderObject Fragment shader.\n * @param {module:ol/webgl/Vertex} vertexShaderObject Vertex shader.\n * @return {WebGLProgram} Program.\n */\nWebGLContext.prototype.getProgram = function(fragmentShaderObject, vertexShaderObject) {\n  const programKey = getUid(fragmentShaderObject) + '/' + getUid(vertexShaderObject);\n  if (programKey in this.programCache_) {\n    return this.programCache_[programKey];\n  } else {\n    const gl = this.getGL();\n    const program = gl.createProgram();\n    gl.attachShader(program, this.getShader(fragmentShaderObject));\n    gl.attachShader(program, this.getShader(vertexShaderObject));\n    gl.linkProgram(program);\n    this.programCache_[programKey] = program;\n    return program;\n  }\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nWebGLContext.prototype.handleWebGLContextLost = function() {\n  clear(this.bufferCache_);\n  clear(this.shaderCache_);\n  clear(this.programCache_);\n  this.currentProgram_ = null;\n  this.hitDetectionFramebuffer_ = null;\n  this.hitDetectionTexture_ = null;\n  this.hitDetectionRenderbuffer_ = null;\n};\n\n\n/**\n * FIXME empty description for jsdoc\n */\nWebGLContext.prototype.handleWebGLContextRestored = function() {\n};\n\n\n/**\n * Creates a 1x1 pixel framebuffer for the hit-detection.\n * @private\n */\nWebGLContext.prototype.initHitDetectionFramebuffer_ = function() {\n  const gl = this.gl_;\n  const framebuffer = gl.createFramebuffer();\n  gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n\n  const texture = createEmptyTexture(gl, 1, 1);\n  const renderbuffer = gl.createRenderbuffer();\n  gl.bindRenderbuffer(gl.RENDERBUFFER, renderbuffer);\n  gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, 1, 1);\n  gl.framebufferTexture2D(\n    gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\n  gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT,\n    gl.RENDERBUFFER, renderbuffer);\n\n  gl.bindTexture(gl.TEXTURE_2D, null);\n  gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n  gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\n  this.hitDetectionFramebuffer_ = framebuffer;\n  this.hitDetectionTexture_ = texture;\n  this.hitDetectionRenderbuffer_ = renderbuffer;\n};\n\n\n/**\n * Use a program.  If the program is already in use, this will return `false`.\n * @param {WebGLProgram} program Program.\n * @return {boolean} Changed.\n * @api\n */\nWebGLContext.prototype.useProgram = function(program) {\n  if (program == this.currentProgram_) {\n    return false;\n  } else {\n    const gl = this.getGL();\n    gl.useProgram(program);\n    this.currentProgram_ = program;\n    return true;\n  }\n};\n\n\n/**\n * @param {WebGLRenderingContext} gl WebGL rendering context.\n * @param {number=} opt_wrapS wrapS.\n * @param {number=} opt_wrapT wrapT.\n * @return {WebGLTexture} The texture.\n */\nfunction createTextureInternal(gl, opt_wrapS, opt_wrapT) {\n  const texture = gl.createTexture();\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\n  if (opt_wrapS !== undefined) {\n    gl.texParameteri(\n      TEXTURE_2D, TEXTURE_WRAP_S, opt_wrapS);\n  }\n  if (opt_wrapT !== undefined) {\n    gl.texParameteri(\n      TEXTURE_2D, TEXTURE_WRAP_T, opt_wrapT);\n  }\n\n  return texture;\n}\n\n\n/**\n * @param {WebGLRenderingContext} gl WebGL rendering context.\n * @param {number} width Width.\n * @param {number} height Height.\n * @param {number=} opt_wrapS wrapS.\n * @param {number=} opt_wrapT wrapT.\n * @return {WebGLTexture} The texture.\n */\nexport function createEmptyTexture(gl, width, height, opt_wrapS, opt_wrapT) {\n  const texture = createTextureInternal(gl, opt_wrapS, opt_wrapT);\n  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n  return texture;\n}\n\n\n/**\n * @param {WebGLRenderingContext} gl WebGL rendering context.\n * @param {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} image Image.\n * @param {number=} opt_wrapS wrapS.\n * @param {number=} opt_wrapT wrapT.\n * @return {WebGLTexture} The texture.\n */\nexport function createTexture(gl, image, opt_wrapS, opt_wrapT) {\n  const texture = createTextureInternal(gl, opt_wrapS, opt_wrapT);\n  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n  return texture;\n}\n\nexport default WebGLContext;\n","/**\n * @module ol/render/webgl/TextureReplay\n */\nimport {getUid, inherits} from '../../util.js';\nimport {intersects} from '../../extent.js';\nimport {isEmpty} from '../../obj.js';\nimport {fragment, vertex} from '../webgl/texturereplay/defaultshader.js';\nimport Locations from '../webgl/texturereplay/defaultshader/Locations.js';\nimport WebGLReplay from '../webgl/Replay.js';\nimport {CLAMP_TO_EDGE, FLOAT, TEXTURE_2D} from '../../webgl.js';\nimport {createTexture} from '../../webgl/Context.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/render/webgl/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @struct\n */\nconst WebGLTextureReplay = function(tolerance, maxExtent) {\n  WebGLReplay.call(this, tolerance, maxExtent);\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.anchorX = undefined;\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.anchorY = undefined;\n\n  /**\n   * @type {Array.<number>}\n   * @protected\n   */\n  this.groupIndices = [];\n\n  /**\n   * @type {Array.<number>}\n   * @protected\n   */\n  this.hitDetectionGroupIndices = [];\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.height = undefined;\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.imageHeight = undefined;\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.imageWidth = undefined;\n\n  /**\n   * @protected\n   * @type {module:ol/render/webgl/texturereplay/defaultshader/Locations}\n   */\n  this.defaultLocations = null;\n\n  /**\n   * @protected\n   * @type {number|undefined}\n   */\n  this.opacity = undefined;\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.originX = undefined;\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.originY = undefined;\n\n  /**\n   * @protected\n   * @type {boolean|undefined}\n   */\n  this.rotateWithView = undefined;\n\n  /**\n   * @protected\n   * @type {number|undefined}\n   */\n  this.rotation = undefined;\n\n  /**\n   * @protected\n   * @type {number|undefined}\n   */\n  this.scale = undefined;\n\n  /**\n   * @type {number|undefined}\n   * @protected\n   */\n  this.width = undefined;\n};\n\ninherits(WebGLTextureReplay, WebGLReplay);\n\n\n/**\n * @inheritDoc\n */\nWebGLTextureReplay.prototype.getDeleteResourcesFunction = function(context) {\n  const verticesBuffer = this.verticesBuffer;\n  const indicesBuffer = this.indicesBuffer;\n  const textures = this.getTextures(true);\n  const gl = context.getGL();\n  return function() {\n    if (!gl.isContextLost()) {\n      let i, ii;\n      for (i = 0, ii = textures.length; i < ii; ++i) {\n        gl.deleteTexture(textures[i]);\n      }\n    }\n    context.deleteBuffer(verticesBuffer);\n    context.deleteBuffer(indicesBuffer);\n  };\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {number} My end.\n * @protected\n */\nWebGLTextureReplay.prototype.drawCoordinates = function(flatCoordinates, offset, end, stride) {\n  const anchorX = /** @type {number} */ (this.anchorX);\n  const anchorY = /** @type {number} */ (this.anchorY);\n  const height = /** @type {number} */ (this.height);\n  const imageHeight = /** @type {number} */ (this.imageHeight);\n  const imageWidth = /** @type {number} */ (this.imageWidth);\n  const opacity = /** @type {number} */ (this.opacity);\n  const originX = /** @type {number} */ (this.originX);\n  const originY = /** @type {number} */ (this.originY);\n  const rotateWithView = this.rotateWithView ? 1.0 : 0.0;\n  // this.rotation_ is anti-clockwise, but rotation is clockwise\n  const rotation = /** @type {number} */ (-this.rotation);\n  const scale = /** @type {number} */ (this.scale);\n  const width = /** @type {number} */ (this.width);\n  const cos = Math.cos(rotation);\n  const sin = Math.sin(rotation);\n  let numIndices = this.indices.length;\n  let numVertices = this.vertices.length;\n  let i, n, offsetX, offsetY, x, y;\n  for (i = offset; i < end; i += stride) {\n    x = flatCoordinates[i] - this.origin[0];\n    y = flatCoordinates[i + 1] - this.origin[1];\n\n    // There are 4 vertices per [x, y] point, one for each corner of the\n    // rectangle we're going to draw. We'd use 1 vertex per [x, y] point if\n    // WebGL supported Geometry Shaders (which can emit new vertices), but that\n    // is not currently the case.\n    //\n    // And each vertex includes 8 values: the x and y coordinates, the x and\n    // y offsets used to calculate the position of the corner, the u and\n    // v texture coordinates for the corner, the opacity, and whether the\n    // the image should be rotated with the view (rotateWithView).\n\n    n = numVertices / 8;\n\n    // bottom-left corner\n    offsetX = -scale * anchorX;\n    offsetY = -scale * (height - anchorY);\n    this.vertices[numVertices++] = x;\n    this.vertices[numVertices++] = y;\n    this.vertices[numVertices++] = offsetX * cos - offsetY * sin;\n    this.vertices[numVertices++] = offsetX * sin + offsetY * cos;\n    this.vertices[numVertices++] = originX / imageWidth;\n    this.vertices[numVertices++] = (originY + height) / imageHeight;\n    this.vertices[numVertices++] = opacity;\n    this.vertices[numVertices++] = rotateWithView;\n\n    // bottom-right corner\n    offsetX = scale * (width - anchorX);\n    offsetY = -scale * (height - anchorY);\n    this.vertices[numVertices++] = x;\n    this.vertices[numVertices++] = y;\n    this.vertices[numVertices++] = offsetX * cos - offsetY * sin;\n    this.vertices[numVertices++] = offsetX * sin + offsetY * cos;\n    this.vertices[numVertices++] = (originX + width) / imageWidth;\n    this.vertices[numVertices++] = (originY + height) / imageHeight;\n    this.vertices[numVertices++] = opacity;\n    this.vertices[numVertices++] = rotateWithView;\n\n    // top-right corner\n    offsetX = scale * (width - anchorX);\n    offsetY = scale * anchorY;\n    this.vertices[numVertices++] = x;\n    this.vertices[numVertices++] = y;\n    this.vertices[numVertices++] = offsetX * cos - offsetY * sin;\n    this.vertices[numVertices++] = offsetX * sin + offsetY * cos;\n    this.vertices[numVertices++] = (originX + width) / imageWidth;\n    this.vertices[numVertices++] = originY / imageHeight;\n    this.vertices[numVertices++] = opacity;\n    this.vertices[numVertices++] = rotateWithView;\n\n    // top-left corner\n    offsetX = -scale * anchorX;\n    offsetY = scale * anchorY;\n    this.vertices[numVertices++] = x;\n    this.vertices[numVertices++] = y;\n    this.vertices[numVertices++] = offsetX * cos - offsetY * sin;\n    this.vertices[numVertices++] = offsetX * sin + offsetY * cos;\n    this.vertices[numVertices++] = originX / imageWidth;\n    this.vertices[numVertices++] = originY / imageHeight;\n    this.vertices[numVertices++] = opacity;\n    this.vertices[numVertices++] = rotateWithView;\n\n    this.indices[numIndices++] = n;\n    this.indices[numIndices++] = n + 1;\n    this.indices[numIndices++] = n + 2;\n    this.indices[numIndices++] = n;\n    this.indices[numIndices++] = n + 2;\n    this.indices[numIndices++] = n + 3;\n  }\n\n  return numVertices;\n};\n\n\n/**\n * @protected\n * @param {Array.<WebGLTexture>} textures Textures.\n * @param {Array.<HTMLCanvasElement|HTMLImageElement|HTMLVideoElement>} images Images.\n * @param {!Object.<string, WebGLTexture>} texturePerImage Texture cache.\n * @param {WebGLRenderingContext} gl Gl.\n */\nWebGLTextureReplay.prototype.createTextures = function(textures, images, texturePerImage, gl) {\n  let texture, image, uid, i;\n  const ii = images.length;\n  for (i = 0; i < ii; ++i) {\n    image = images[i];\n\n    uid = getUid(image).toString();\n    if (uid in texturePerImage) {\n      texture = texturePerImage[uid];\n    } else {\n      texture = createTexture(\n        gl, image, CLAMP_TO_EDGE, CLAMP_TO_EDGE);\n      texturePerImage[uid] = texture;\n    }\n    textures[i] = texture;\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextureReplay.prototype.setUpProgram = function(gl, context, size, pixelRatio) {\n  // get the program\n  const program = context.getProgram(fragment, vertex);\n\n  // get the locations\n  let locations;\n  if (!this.defaultLocations) {\n    locations = new Locations(gl, program);\n    this.defaultLocations = locations;\n  } else {\n    locations = this.defaultLocations;\n  }\n\n  // use the program (FIXME: use the return value)\n  context.useProgram(program);\n\n  // enable the vertex attrib arrays\n  gl.enableVertexAttribArray(locations.a_position);\n  gl.vertexAttribPointer(locations.a_position, 2, FLOAT,\n    false, 32, 0);\n\n  gl.enableVertexAttribArray(locations.a_offsets);\n  gl.vertexAttribPointer(locations.a_offsets, 2, FLOAT,\n    false, 32, 8);\n\n  gl.enableVertexAttribArray(locations.a_texCoord);\n  gl.vertexAttribPointer(locations.a_texCoord, 2, FLOAT,\n    false, 32, 16);\n\n  gl.enableVertexAttribArray(locations.a_opacity);\n  gl.vertexAttribPointer(locations.a_opacity, 1, FLOAT,\n    false, 32, 24);\n\n  gl.enableVertexAttribArray(locations.a_rotateWithView);\n  gl.vertexAttribPointer(locations.a_rotateWithView, 1, FLOAT,\n    false, 32, 28);\n\n  return locations;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextureReplay.prototype.shutDownProgram = function(gl, locations) {\n  gl.disableVertexAttribArray(locations.a_position);\n  gl.disableVertexAttribArray(locations.a_offsets);\n  gl.disableVertexAttribArray(locations.a_texCoord);\n  gl.disableVertexAttribArray(locations.a_opacity);\n  gl.disableVertexAttribArray(locations.a_rotateWithView);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextureReplay.prototype.drawReplay = function(gl, context, skippedFeaturesHash, hitDetection) {\n  const textures = hitDetection ? this.getHitDetectionTextures() : this.getTextures();\n  const groupIndices = hitDetection ? this.hitDetectionGroupIndices : this.groupIndices;\n\n  if (!isEmpty(skippedFeaturesHash)) {\n    this.drawReplaySkipping(gl, context, skippedFeaturesHash, textures, groupIndices);\n  } else {\n    let i, ii, start;\n    for (i = 0, ii = textures.length, start = 0; i < ii; ++i) {\n      gl.bindTexture(TEXTURE_2D, textures[i]);\n      const end = groupIndices[i];\n      this.drawElements(gl, context, start, end);\n      start = end;\n    }\n  }\n};\n\n\n/**\n * Draw the replay while paying attention to skipped features.\n *\n * This functions creates groups of features that can be drawn to together,\n * so that the number of `drawElements` calls is minimized.\n *\n * For example given the following texture groups:\n *\n *    Group 1: A B C\n *    Group 2: D [E] F G\n *\n * If feature E should be skipped, the following `drawElements` calls will be\n * made:\n *\n *    drawElements with feature A, B and C\n *    drawElements with feature D\n *    drawElements with feature F and G\n *\n * @protected\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features\n *  to skip.\n * @param {Array.<WebGLTexture>} textures Textures.\n * @param {Array.<number>} groupIndices Texture group indices.\n */\nWebGLTextureReplay.prototype.drawReplaySkipping = function(gl, context, skippedFeaturesHash, textures,\n  groupIndices) {\n  let featureIndex = 0;\n\n  let i, ii;\n  for (i = 0, ii = textures.length; i < ii; ++i) {\n    gl.bindTexture(TEXTURE_2D, textures[i]);\n    const groupStart = (i > 0) ? groupIndices[i - 1] : 0;\n    const groupEnd = groupIndices[i];\n\n    let start = groupStart;\n    let end = groupStart;\n    while (featureIndex < this.startIndices.length &&\n        this.startIndices[featureIndex] <= groupEnd) {\n      const feature = this.startIndicesFeature[featureIndex];\n\n      const featureUid = getUid(feature).toString();\n      if (skippedFeaturesHash[featureUid] !== undefined) {\n        // feature should be skipped\n        if (start !== end) {\n          // draw the features so far\n          this.drawElements(gl, context, start, end);\n        }\n        // continue with the next feature\n        start = (featureIndex === this.startIndices.length - 1) ?\n          groupEnd : this.startIndices[featureIndex + 1];\n        end = start;\n      } else {\n        // the feature is not skipped, augment the end index\n        end = (featureIndex === this.startIndices.length - 1) ?\n          groupEnd : this.startIndices[featureIndex + 1];\n      }\n      featureIndex++;\n    }\n\n    if (start !== end) {\n      // draw the remaining features (in case there was no skipped feature\n      // in this texture group, all features of a group are drawn together)\n      this.drawElements(gl, context, start, end);\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextureReplay.prototype.drawHitDetectionReplayOneByOne = function(gl, context, skippedFeaturesHash,\n  featureCallback, opt_hitExtent) {\n  let i, groupStart, start, end, feature, featureUid;\n  let featureIndex = this.startIndices.length - 1;\n  const hitDetectionTextures = this.getHitDetectionTextures();\n  for (i = hitDetectionTextures.length - 1; i >= 0; --i) {\n    gl.bindTexture(TEXTURE_2D, hitDetectionTextures[i]);\n    groupStart = (i > 0) ? this.hitDetectionGroupIndices[i - 1] : 0;\n    end = this.hitDetectionGroupIndices[i];\n\n    // draw all features for this texture group\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      start = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid] === undefined &&\n          feature.getGeometry() &&\n          (opt_hitExtent === undefined || intersects(\n            /** @type {Array<number>} */ (opt_hitExtent),\n            feature.getGeometry().getExtent()))) {\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n        this.drawElements(gl, context, start, end);\n\n        const result = featureCallback(feature);\n        if (result) {\n          return result;\n        }\n      }\n\n      end = start;\n      featureIndex--;\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextureReplay.prototype.finish = function(context) {\n  this.anchorX = undefined;\n  this.anchorY = undefined;\n  this.height = undefined;\n  this.imageHeight = undefined;\n  this.imageWidth = undefined;\n  this.indices = null;\n  this.opacity = undefined;\n  this.originX = undefined;\n  this.originY = undefined;\n  this.rotateWithView = undefined;\n  this.rotation = undefined;\n  this.scale = undefined;\n  this.vertices = null;\n  this.width = undefined;\n};\n\n\n/**\n * @abstract\n * @protected\n * @param {boolean=} opt_all Return hit detection textures with regular ones.\n * @returns {Array.<WebGLTexture>} Textures.\n */\nWebGLTextureReplay.prototype.getTextures = function(opt_all) {};\n\n\n/**\n * @abstract\n * @protected\n * @returns {Array.<WebGLTexture>} Textures.\n */\nWebGLTextureReplay.prototype.getHitDetectionTextures = function() {};\nexport default WebGLTextureReplay;\n","/**\n * @module ol/render/webgl/ImageReplay\n */\nimport {getUid, inherits} from '../../util.js';\nimport WebGLTextureReplay from '../webgl/TextureReplay.js';\nimport WebGLBuffer from '../../webgl/Buffer.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/webgl/TextureReplay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @struct\n */\nconst WebGLImageReplay = function(tolerance, maxExtent) {\n  WebGLTextureReplay.call(this, tolerance, maxExtent);\n\n  /**\n   * @type {Array.<HTMLCanvasElement|HTMLImageElement|HTMLVideoElement>}\n   * @protected\n   */\n  this.images_ = [];\n\n  /**\n   * @type {Array.<HTMLCanvasElement|HTMLImageElement|HTMLVideoElement>}\n   * @protected\n   */\n  this.hitDetectionImages_ = [];\n\n  /**\n   * @type {Array.<WebGLTexture>}\n   * @private\n   */\n  this.textures_ = [];\n\n  /**\n   * @type {Array.<WebGLTexture>}\n   * @private\n   */\n  this.hitDetectionTextures_ = [];\n\n};\n\ninherits(WebGLImageReplay, WebGLTextureReplay);\n\n\n/**\n * @inheritDoc\n */\nWebGLImageReplay.prototype.drawMultiPoint = function(multiPointGeometry, feature) {\n  this.startIndices.push(this.indices.length);\n  this.startIndicesFeature.push(feature);\n  const flatCoordinates = multiPointGeometry.getFlatCoordinates();\n  const stride = multiPointGeometry.getStride();\n  this.drawCoordinates(\n    flatCoordinates, 0, flatCoordinates.length, stride);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageReplay.prototype.drawPoint = function(pointGeometry, feature) {\n  this.startIndices.push(this.indices.length);\n  this.startIndicesFeature.push(feature);\n  const flatCoordinates = pointGeometry.getFlatCoordinates();\n  const stride = pointGeometry.getStride();\n  this.drawCoordinates(\n    flatCoordinates, 0, flatCoordinates.length, stride);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageReplay.prototype.finish = function(context) {\n  const gl = context.getGL();\n\n  this.groupIndices.push(this.indices.length);\n  this.hitDetectionGroupIndices.push(this.indices.length);\n\n  // create, bind, and populate the vertices buffer\n  this.verticesBuffer = new WebGLBuffer(this.vertices);\n\n  const indices = this.indices;\n\n  // create, bind, and populate the indices buffer\n  this.indicesBuffer = new WebGLBuffer(indices);\n\n  // create textures\n  /** @type {Object.<string, WebGLTexture>} */\n  const texturePerImage = {};\n\n  this.createTextures(this.textures_, this.images_, texturePerImage, gl);\n\n  this.createTextures(this.hitDetectionTextures_, this.hitDetectionImages_,\n    texturePerImage, gl);\n\n  this.images_ = null;\n  this.hitDetectionImages_ = null;\n  WebGLTextureReplay.prototype.finish.call(this, context);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageReplay.prototype.setImageStyle = function(imageStyle) {\n  const anchor = imageStyle.getAnchor();\n  const image = imageStyle.getImage(1);\n  const imageSize = imageStyle.getImageSize();\n  const hitDetectionImage = imageStyle.getHitDetectionImage(1);\n  const opacity = imageStyle.getOpacity();\n  const origin = imageStyle.getOrigin();\n  const rotateWithView = imageStyle.getRotateWithView();\n  const rotation = imageStyle.getRotation();\n  const size = imageStyle.getSize();\n  const scale = imageStyle.getScale();\n\n  let currentImage;\n  if (this.images_.length === 0) {\n    this.images_.push(image);\n  } else {\n    currentImage = this.images_[this.images_.length - 1];\n    if (getUid(currentImage) != getUid(image)) {\n      this.groupIndices.push(this.indices.length);\n      this.images_.push(image);\n    }\n  }\n\n  if (this.hitDetectionImages_.length === 0) {\n    this.hitDetectionImages_.push(hitDetectionImage);\n  } else {\n    currentImage =\n        this.hitDetectionImages_[this.hitDetectionImages_.length - 1];\n    if (getUid(currentImage) != getUid(hitDetectionImage)) {\n      this.hitDetectionGroupIndices.push(this.indices.length);\n      this.hitDetectionImages_.push(hitDetectionImage);\n    }\n  }\n\n  this.anchorX = anchor[0];\n  this.anchorY = anchor[1];\n  this.height = size[1];\n  this.imageHeight = imageSize[1];\n  this.imageWidth = imageSize[0];\n  this.opacity = opacity;\n  this.originX = origin[0];\n  this.originY = origin[1];\n  this.rotation = rotation;\n  this.rotateWithView = rotateWithView;\n  this.scale = scale;\n  this.width = size[0];\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageReplay.prototype.getTextures = function(opt_all) {\n  return opt_all ? this.textures_.concat(this.hitDetectionTextures_) : this.textures_;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageReplay.prototype.getHitDetectionTextures = function() {\n  return this.hitDetectionTextures_;\n};\nexport default WebGLImageReplay;\n","/**\n * @module ol/geom/flat/topology\n */\nimport {linearRing as linearRingArea} from '../flat/area.js';\n\n/**\n * Check if the linestring is a boundary.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {boolean} The linestring is a boundary.\n */\nexport function lineStringIsClosed(flatCoordinates, offset, end, stride) {\n  const lastCoord = end - stride;\n  if (flatCoordinates[offset] === flatCoordinates[lastCoord] &&\n      flatCoordinates[offset + 1] === flatCoordinates[lastCoord + 1] && (end - offset) / stride > 3) {\n    return !!linearRingArea(flatCoordinates, offset, end, stride);\n  }\n  return false;\n}\n","/**\n * @module ol/render/webgl/linestringreplay/defaultshader\n */\n// This file is automatically generated, do not edit.\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG as DEBUG_WEBGL} from '../../../webgl.js';\nimport WebGLFragment from '../../../webgl/Fragment.js';\nimport WebGLVertex from '../../../webgl/Vertex.js';\n\nexport const fragment = new WebGLFragment(DEBUG_WEBGL ?\n  'precision mediump float;\\nvarying float v_round;\\nvarying vec2 v_roundVertex;\\nvarying float v_halfWidth;\\n\\n\\n\\nuniform float u_opacity;\\nuniform vec4 u_color;\\nuniform vec2 u_size;\\nuniform float u_pixelRatio;\\n\\nvoid main(void) {\\n  if (v_round > 0.0) {\\n    vec2 windowCoords = vec2((v_roundVertex.x + 1.0) / 2.0 * u_size.x * u_pixelRatio,\\n        (v_roundVertex.y + 1.0) / 2.0 * u_size.y * u_pixelRatio);\\n    if (length(windowCoords - gl_FragCoord.xy) > v_halfWidth * u_pixelRatio) {\\n      discard;\\n    }\\n  }\\n  gl_FragColor = u_color;\\n  float alpha = u_color.a * u_opacity;\\n  if (alpha == 0.0) {\\n    discard;\\n  }\\n  gl_FragColor.a = alpha;\\n}\\n' :\n  'precision mediump float;varying float a;varying vec2 aVertex;varying float c;uniform float m;uniform vec4 n;uniform vec2 o;uniform float p;void main(void){if(a>0.0){vec2 windowCoords=vec2((aVertex.x+1.0)/2.0*o.x*p,(aVertex.y+1.0)/2.0*o.y*p);if(length(windowCoords-gl_FragCoord.xy)>c*p){discard;}} gl_FragColor=n;float alpha=n.a*m;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}');\n\nexport const vertex = new WebGLVertex(DEBUG_WEBGL ?\n  'varying float v_round;\\nvarying vec2 v_roundVertex;\\nvarying float v_halfWidth;\\n\\n\\nattribute vec2 a_lastPos;\\nattribute vec2 a_position;\\nattribute vec2 a_nextPos;\\nattribute float a_direction;\\n\\nuniform mat4 u_projectionMatrix;\\nuniform mat4 u_offsetScaleMatrix;\\nuniform mat4 u_offsetRotateMatrix;\\nuniform float u_lineWidth;\\nuniform float u_miterLimit;\\n\\nbool nearlyEquals(in float value, in float ref) {\\n  float epsilon = 0.000000000001;\\n  return value >= ref - epsilon && value <= ref + epsilon;\\n}\\n\\nvoid alongNormal(out vec2 offset, in vec2 nextP, in float turnDir, in float direction) {\\n  vec2 dirVect = nextP - a_position;\\n  vec2 normal = normalize(vec2(-turnDir * dirVect.y, turnDir * dirVect.x));\\n  offset = u_lineWidth / 2.0 * normal * direction;\\n}\\n\\nvoid miterUp(out vec2 offset, out float round, in bool isRound, in float direction) {\\n  float halfWidth = u_lineWidth / 2.0;\\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\\n  vec2 normal = vec2(-tangent.y, tangent.x);\\n  vec2 dirVect = a_nextPos - a_position;\\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\\n  float miterLength = abs(halfWidth / dot(normal, tmpNormal));\\n  offset = normal * direction * miterLength;\\n  round = 0.0;\\n  if (isRound) {\\n    round = 1.0;\\n  } else if (miterLength > u_miterLimit + u_lineWidth) {\\n    offset = halfWidth * tmpNormal * direction;\\n  }\\n}\\n\\nbool miterDown(out vec2 offset, in vec4 projPos, in mat4 offsetMatrix, in float direction) {\\n  bool degenerate = false;\\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\\n  vec2 normal = vec2(-tangent.y, tangent.x);\\n  vec2 dirVect = a_lastPos - a_position;\\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\\n  vec2 longOffset, shortOffset, longVertex;\\n  vec4 shortProjVertex;\\n  float halfWidth = u_lineWidth / 2.0;\\n  if (length(a_nextPos - a_position) > length(a_lastPos - a_position)) {\\n    longOffset = tmpNormal * direction * halfWidth;\\n    shortOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\\n    longVertex = a_nextPos;\\n    shortProjVertex = u_projectionMatrix * vec4(a_lastPos, 0.0, 1.0);\\n  } else {\\n    shortOffset = tmpNormal * direction * halfWidth;\\n    longOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\\n    longVertex = a_lastPos;\\n    shortProjVertex = u_projectionMatrix * vec4(a_nextPos, 0.0, 1.0);\\n  }\\n  //Intersection algorithm based on theory by Paul Bourke (http://paulbourke.net/geometry/pointlineplane/).\\n  vec4 p1 = u_projectionMatrix * vec4(longVertex, 0.0, 1.0) + offsetMatrix * vec4(longOffset, 0.0, 0.0);\\n  vec4 p2 = projPos + offsetMatrix * vec4(longOffset, 0.0, 0.0);\\n  vec4 p3 = shortProjVertex + offsetMatrix * vec4(-shortOffset, 0.0, 0.0);\\n  vec4 p4 = shortProjVertex + offsetMatrix * vec4(shortOffset, 0.0, 0.0);\\n  float denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\\n  float firstU = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\\n  float secondU = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denom;\\n  float epsilon = 0.000000000001;\\n  if (firstU > epsilon && firstU < 1.0 - epsilon && secondU > epsilon && secondU < 1.0 - epsilon) {\\n    shortProjVertex.x = p1.x + firstU * (p2.x - p1.x);\\n    shortProjVertex.y = p1.y + firstU * (p2.y - p1.y);\\n    offset = shortProjVertex.xy;\\n    degenerate = true;\\n  } else {\\n    float miterLength = abs(halfWidth / dot(normal, tmpNormal));\\n    offset = normal * direction * miterLength;\\n  }\\n  return degenerate;\\n}\\n\\nvoid squareCap(out vec2 offset, out float round, in bool isRound, in vec2 nextP,\\n    in float turnDir, in float direction) {\\n  round = 0.0;\\n  vec2 dirVect = a_position - nextP;\\n  vec2 firstNormal = normalize(dirVect);\\n  vec2 secondNormal = vec2(turnDir * firstNormal.y * direction, -turnDir * firstNormal.x * direction);\\n  vec2 hypotenuse = normalize(firstNormal - secondNormal);\\n  vec2 normal = vec2(turnDir * hypotenuse.y * direction, -turnDir * hypotenuse.x * direction);\\n  float length = sqrt(v_halfWidth * v_halfWidth * 2.0);\\n  offset = normal * length;\\n  if (isRound) {\\n    round = 1.0;\\n  }\\n}\\n\\nvoid main(void) {\\n  bool degenerate = false;\\n  float direction = float(sign(a_direction));\\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\\n  vec2 offset;\\n  vec4 projPos = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\\n  bool round = nearlyEquals(mod(a_direction, 2.0), 0.0);\\n\\n  v_round = 0.0;\\n  v_halfWidth = u_lineWidth / 2.0;\\n  v_roundVertex = projPos.xy;\\n\\n  if (nearlyEquals(mod(a_direction, 3.0), 0.0) || nearlyEquals(mod(a_direction, 17.0), 0.0)) {\\n    alongNormal(offset, a_nextPos, 1.0, direction);\\n  } else if (nearlyEquals(mod(a_direction, 5.0), 0.0) || nearlyEquals(mod(a_direction, 13.0), 0.0)) {\\n    alongNormal(offset, a_lastPos, -1.0, direction);\\n  } else if (nearlyEquals(mod(a_direction, 23.0), 0.0)) {\\n    miterUp(offset, v_round, round, direction);\\n  } else if (nearlyEquals(mod(a_direction, 19.0), 0.0)) {\\n    degenerate = miterDown(offset, projPos, offsetMatrix, direction);\\n  } else if (nearlyEquals(mod(a_direction, 7.0), 0.0)) {\\n    squareCap(offset, v_round, round, a_nextPos, 1.0, direction);\\n  } else if (nearlyEquals(mod(a_direction, 11.0), 0.0)) {\\n    squareCap(offset, v_round, round, a_lastPos, -1.0, direction);\\n  }\\n  if (!degenerate) {\\n    vec4 offsets = offsetMatrix * vec4(offset, 0.0, 0.0);\\n    gl_Position = projPos + offsets;\\n  } else {\\n    gl_Position = vec4(offset, 0.0, 1.0);\\n  }\\n}\\n\\n\\n' :\n  'varying float a;varying vec2 aVertex;varying float c;attribute vec2 d;attribute vec2 e;attribute vec2 f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;bool nearlyEquals(in float value,in float ref){float epsilon=0.000000000001;return value>=ref-epsilon&&value<=ref+epsilon;}void alongNormal(out vec2 offset,in vec2 nextP,in float turnDir,in float direction){vec2 dirVect=nextP-e;vec2 normal=normalize(vec2(-turnDir*dirVect.y,turnDir*dirVect.x));offset=k/2.0*normal*direction;}void miterUp(out vec2 offset,out float round,in bool isRound,in float direction){float halfWidth=k/2.0;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=f-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;round=0.0;if(isRound){round=1.0;}else if(miterLength>l+k){offset=halfWidth*tmpNormal*direction;}} bool miterDown(out vec2 offset,in vec4 projPos,in mat4 offsetMatrix,in float direction){bool degenerate=false;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=d-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));vec2 longOffset,shortOffset,longVertex;vec4 shortProjVertex;float halfWidth=k/2.0;if(length(f-e)>length(d-e)){longOffset=tmpNormal*direction*halfWidth;shortOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=f;shortProjVertex=h*vec4(d,0.0,1.0);}else{shortOffset=tmpNormal*direction*halfWidth;longOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=d;shortProjVertex=h*vec4(f,0.0,1.0);}vec4 p1=h*vec4(longVertex,0.0,1.0)+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p2=projPos+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p3=shortProjVertex+offsetMatrix*vec4(-shortOffset,0.0,0.0);vec4 p4=shortProjVertex+offsetMatrix*vec4(shortOffset,0.0,0.0);float denom=(p4.y-p3.y)*(p2.x-p1.x)-(p4.x-p3.x)*(p2.y-p1.y);float firstU=((p4.x-p3.x)*(p1.y-p3.y)-(p4.y-p3.y)*(p1.x-p3.x))/denom;float secondU=((p2.x-p1.x)*(p1.y-p3.y)-(p2.y-p1.y)*(p1.x-p3.x))/denom;float epsilon=0.000000000001;if(firstU>epsilon&&firstU<1.0-epsilon&&secondU>epsilon&&secondU<1.0-epsilon){shortProjVertex.x=p1.x+firstU*(p2.x-p1.x);shortProjVertex.y=p1.y+firstU*(p2.y-p1.y);offset=shortProjVertex.xy;degenerate=true;}else{float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;}return degenerate;}void squareCap(out vec2 offset,out float round,in bool isRound,in vec2 nextP,in float turnDir,in float direction){round=0.0;vec2 dirVect=e-nextP;vec2 firstNormal=normalize(dirVect);vec2 secondNormal=vec2(turnDir*firstNormal.y*direction,-turnDir*firstNormal.x*direction);vec2 hypotenuse=normalize(firstNormal-secondNormal);vec2 normal=vec2(turnDir*hypotenuse.y*direction,-turnDir*hypotenuse.x*direction);float length=sqrt(c*c*2.0);offset=normal*length;if(isRound){round=1.0;}} void main(void){bool degenerate=false;float direction=float(sign(g));mat4 offsetMatrix=i*j;vec2 offset;vec4 projPos=h*vec4(e,0.0,1.0);bool round=nearlyEquals(mod(g,2.0),0.0);a=0.0;c=k/2.0;aVertex=projPos.xy;if(nearlyEquals(mod(g,3.0),0.0)||nearlyEquals(mod(g,17.0),0.0)){alongNormal(offset,f,1.0,direction);}else if(nearlyEquals(mod(g,5.0),0.0)||nearlyEquals(mod(g,13.0),0.0)){alongNormal(offset,d,-1.0,direction);}else if(nearlyEquals(mod(g,23.0),0.0)){miterUp(offset,a,round,direction);}else if(nearlyEquals(mod(g,19.0),0.0)){degenerate=miterDown(offset,projPos,offsetMatrix,direction);}else if(nearlyEquals(mod(g,7.0),0.0)){squareCap(offset,a,round,f,1.0,direction);}else if(nearlyEquals(mod(g,11.0),0.0)){squareCap(offset,a,round,d,-1.0,direction);}if(!degenerate){vec4 offsets=offsetMatrix*vec4(offset,0.0,0.0);gl_Position=projPos+offsets;}else{gl_Position=vec4(offset,0.0,1.0);}}');\n","/**\n * @module ol/render/webgl/linestringreplay/defaultshader/Locations\n */\n// This file is automatically generated, do not edit\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG as DEBUG_WEBGL} from '../../../../webgl.js';\n\n/**\n * @constructor\n * @param {WebGLRenderingContext} gl GL.\n * @param {WebGLProgram} program Program.\n * @struct\n */\nconst Locations = function(gl, program) {\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_projectionMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_projectionMatrix' : 'h');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetScaleMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetScaleMatrix' : 'i');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetRotateMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetRotateMatrix' : 'j');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_lineWidth = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_lineWidth' : 'k');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_miterLimit = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_miterLimit' : 'l');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_opacity = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_opacity' : 'm');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_color = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_color' : 'n');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_size = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_size' : 'o');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_pixelRatio = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_pixelRatio' : 'p');\n\n  /**\n   * @type {number}\n   */\n  this.a_lastPos = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_lastPos' : 'd');\n\n  /**\n   * @type {number}\n   */\n  this.a_position = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_position' : 'e');\n\n  /**\n   * @type {number}\n   */\n  this.a_nextPos = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_nextPos' : 'f');\n\n  /**\n   * @type {number}\n   */\n  this.a_direction = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_direction' : 'g');\n};\n\nexport default Locations;\n","/**\n * @module ol/render/webgl/LineStringReplay\n */\nimport {getUid, inherits} from '../../util.js';\nimport {equals} from '../../array.js';\nimport {asArray} from '../../color.js';\nimport {intersects} from '../../extent.js';\nimport {linearRingIsClockwise} from '../../geom/flat/orient.js';\nimport {translate} from '../../geom/flat/transform.js';\nimport {lineStringIsClosed} from '../../geom/flat/topology.js';\nimport {isEmpty} from '../../obj.js';\nimport {DEFAULT_LINECAP, DEFAULT_LINEDASH, DEFAULT_LINEDASHOFFSET,\n  DEFAULT_LINEJOIN, DEFAULT_LINEWIDTH, DEFAULT_MITERLIMIT, DEFAULT_STROKESTYLE,\n  triangleIsCounterClockwise} from '../webgl.js';\nimport WebGLReplay from '../webgl/Replay.js';\nimport {fragment, vertex} from '../webgl/linestringreplay/defaultshader.js';\nimport Locations from '../webgl/linestringreplay/defaultshader/Locations.js';\nimport {FLOAT} from '../../webgl.js';\nimport WebGLBuffer from '../../webgl/Buffer.js';\n\n\n/**\n * @enum {number}\n */\nconst Instruction = {\n  ROUND: 2,\n  BEGIN_LINE: 3,\n  END_LINE: 5,\n  BEGIN_LINE_CAP: 7,\n  END_LINE_CAP: 11,\n  BEVEL_FIRST: 13,\n  BEVEL_SECOND: 17,\n  MITER_BOTTOM: 19,\n  MITER_TOP: 23\n};\n\n\n/**\n * @constructor\n * @extends {module:ol/render/webgl/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @struct\n */\nconst WebGLLineStringReplay = function(tolerance, maxExtent) {\n  WebGLReplay.call(this, tolerance, maxExtent);\n\n  /**\n   * @private\n   * @type {module:ol/render/webgl/linestringreplay/defaultshader/Locations}\n   */\n  this.defaultLocations_ = null;\n\n  /**\n   * @private\n   * @type {Array.<Array.<?>>}\n   */\n  this.styles_ = [];\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.styleIndices_ = [];\n\n  /**\n   * @private\n   * @type {{strokeColor: (Array.<number>|null),\n   *         lineCap: (string|undefined),\n   *         lineDash: Array.<number>,\n   *         lineDashOffset: (number|undefined),\n   *         lineJoin: (string|undefined),\n   *         lineWidth: (number|undefined),\n   *         miterLimit: (number|undefined),\n   *         changed: boolean}|null}\n   */\n  this.state_ = {\n    strokeColor: null,\n    lineCap: undefined,\n    lineDash: null,\n    lineDashOffset: undefined,\n    lineJoin: undefined,\n    lineWidth: undefined,\n    miterLimit: undefined,\n    changed: false\n  };\n\n};\n\ninherits(WebGLLineStringReplay, WebGLReplay);\n\n\n/**\n * Draw one segment.\n * @private\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n */\nWebGLLineStringReplay.prototype.drawCoordinates_ = function(flatCoordinates, offset, end, stride) {\n\n  let i, ii;\n  let numVertices = this.vertices.length;\n  let numIndices = this.indices.length;\n  //To save a vertex, the direction of a point is a product of the sign (1 or -1), a prime from\n  //Instruction, and a rounding factor (1 or 2). If the product is even,\n  //we round it. If it is odd, we don't.\n  const lineJoin = this.state_.lineJoin === 'bevel' ? 0 :\n    this.state_.lineJoin === 'miter' ? 1 : 2;\n  const lineCap = this.state_.lineCap === 'butt' ? 0 :\n    this.state_.lineCap === 'square' ? 1 : 2;\n  const closed = lineStringIsClosed(flatCoordinates, offset, end, stride);\n  let startCoords, sign, n;\n  let lastIndex = numIndices;\n  let lastSign = 1;\n  //We need the adjacent vertices to define normals in joins. p0 = last, p1 = current, p2 = next.\n  let p0, p1, p2;\n\n  for (i = offset, ii = end; i < ii; i += stride) {\n\n    n = numVertices / 7;\n\n    p0 = p1;\n    p1 = p2 || [flatCoordinates[i], flatCoordinates[i + 1]];\n    //First vertex.\n    if (i === offset) {\n      p2 = [flatCoordinates[i + stride], flatCoordinates[i + stride + 1]];\n      if (end - offset === stride * 2 && equals(p1, p2)) {\n        break;\n      }\n      if (closed) {\n        //A closed line! Complete the circle.\n        p0 = [flatCoordinates[end - stride * 2],\n          flatCoordinates[end - stride * 2 + 1]];\n\n        startCoords = p2;\n      } else {\n        //Add the first two/four vertices.\n\n        if (lineCap) {\n          numVertices = this.addVertices_([0, 0], p1, p2,\n            lastSign * Instruction.BEGIN_LINE_CAP * lineCap, numVertices);\n\n          numVertices = this.addVertices_([0, 0], p1, p2,\n            -lastSign * Instruction.BEGIN_LINE_CAP * lineCap, numVertices);\n\n          this.indices[numIndices++] = n + 2;\n          this.indices[numIndices++] = n;\n          this.indices[numIndices++] = n + 1;\n\n          this.indices[numIndices++] = n + 1;\n          this.indices[numIndices++] = n + 3;\n          this.indices[numIndices++] = n + 2;\n\n        }\n\n        numVertices = this.addVertices_([0, 0], p1, p2,\n          lastSign * Instruction.BEGIN_LINE * (lineCap || 1), numVertices);\n\n        numVertices = this.addVertices_([0, 0], p1, p2,\n          -lastSign * Instruction.BEGIN_LINE * (lineCap || 1), numVertices);\n\n        lastIndex = numVertices / 7 - 1;\n\n        continue;\n      }\n    } else if (i === end - stride) {\n      //Last vertex.\n      if (closed) {\n        //Same as the first vertex.\n        p2 = startCoords;\n        break;\n      } else {\n        p0 = p0 || [0, 0];\n\n        numVertices = this.addVertices_(p0, p1, [0, 0],\n          lastSign * Instruction.END_LINE * (lineCap || 1), numVertices);\n\n        numVertices = this.addVertices_(p0, p1, [0, 0],\n          -lastSign * Instruction.END_LINE * (lineCap || 1), numVertices);\n\n        this.indices[numIndices++] = n;\n        this.indices[numIndices++] = lastIndex - 1;\n        this.indices[numIndices++] = lastIndex;\n\n        this.indices[numIndices++] = lastIndex;\n        this.indices[numIndices++] = n + 1;\n        this.indices[numIndices++] = n;\n\n        if (lineCap) {\n          numVertices = this.addVertices_(p0, p1, [0, 0],\n            lastSign * Instruction.END_LINE_CAP * lineCap, numVertices);\n\n          numVertices = this.addVertices_(p0, p1, [0, 0],\n            -lastSign * Instruction.END_LINE_CAP * lineCap, numVertices);\n\n          this.indices[numIndices++] = n + 2;\n          this.indices[numIndices++] = n;\n          this.indices[numIndices++] = n + 1;\n\n          this.indices[numIndices++] = n + 1;\n          this.indices[numIndices++] = n + 3;\n          this.indices[numIndices++] = n + 2;\n\n        }\n\n        break;\n      }\n    } else {\n      p2 = [flatCoordinates[i + stride], flatCoordinates[i + stride + 1]];\n    }\n\n    // We group CW and straight lines, thus the not so inituitive CCW checking function.\n    sign = triangleIsCounterClockwise(p0[0], p0[1], p1[0], p1[1], p2[0], p2[1])\n      ? -1 : 1;\n\n    numVertices = this.addVertices_(p0, p1, p2,\n      sign * Instruction.BEVEL_FIRST * (lineJoin || 1), numVertices);\n\n    numVertices = this.addVertices_(p0, p1, p2,\n      sign * Instruction.BEVEL_SECOND * (lineJoin || 1), numVertices);\n\n    numVertices = this.addVertices_(p0, p1, p2,\n      -sign * Instruction.MITER_BOTTOM * (lineJoin || 1), numVertices);\n\n    if (i > offset) {\n      this.indices[numIndices++] = n;\n      this.indices[numIndices++] = lastIndex - 1;\n      this.indices[numIndices++] = lastIndex;\n\n      this.indices[numIndices++] = n + 2;\n      this.indices[numIndices++] = n;\n      this.indices[numIndices++] = lastSign * sign > 0 ? lastIndex : lastIndex - 1;\n    }\n\n    this.indices[numIndices++] = n;\n    this.indices[numIndices++] = n + 2;\n    this.indices[numIndices++] = n + 1;\n\n    lastIndex = n + 2;\n    lastSign = sign;\n\n    //Add miter\n    if (lineJoin) {\n      numVertices = this.addVertices_(p0, p1, p2,\n        sign * Instruction.MITER_TOP * lineJoin, numVertices);\n\n      this.indices[numIndices++] = n + 1;\n      this.indices[numIndices++] = n + 3;\n      this.indices[numIndices++] = n;\n    }\n  }\n\n  if (closed) {\n    n = n || numVertices / 7;\n    sign = linearRingIsClockwise([p0[0], p0[1], p1[0], p1[1], p2[0], p2[1]], 0, 6, 2)\n      ? 1 : -1;\n\n    numVertices = this.addVertices_(p0, p1, p2,\n      sign * Instruction.BEVEL_FIRST * (lineJoin || 1), numVertices);\n\n    numVertices = this.addVertices_(p0, p1, p2,\n      -sign * Instruction.MITER_BOTTOM * (lineJoin || 1), numVertices);\n\n    this.indices[numIndices++] = n;\n    this.indices[numIndices++] = lastIndex - 1;\n    this.indices[numIndices++] = lastIndex;\n\n    this.indices[numIndices++] = n + 1;\n    this.indices[numIndices++] = n;\n    this.indices[numIndices++] = lastSign * sign > 0 ? lastIndex : lastIndex - 1;\n  }\n};\n\n/**\n * @param {Array.<number>} p0 Last coordinates.\n * @param {Array.<number>} p1 Current coordinates.\n * @param {Array.<number>} p2 Next coordinates.\n * @param {number} product Sign, instruction, and rounding product.\n * @param {number} numVertices Vertex counter.\n * @return {number} Vertex counter.\n * @private\n */\nWebGLLineStringReplay.prototype.addVertices_ = function(p0, p1, p2, product, numVertices) {\n  this.vertices[numVertices++] = p0[0];\n  this.vertices[numVertices++] = p0[1];\n  this.vertices[numVertices++] = p1[0];\n  this.vertices[numVertices++] = p1[1];\n  this.vertices[numVertices++] = p2[0];\n  this.vertices[numVertices++] = p2[1];\n  this.vertices[numVertices++] = product;\n\n  return numVertices;\n};\n\n/**\n * Check if the linestring can be drawn (i. e. valid).\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {boolean} The linestring can be drawn.\n * @private\n */\nWebGLLineStringReplay.prototype.isValid_ = function(flatCoordinates, offset, end, stride) {\n  const range = end - offset;\n  if (range < stride * 2) {\n    return false;\n  } else if (range === stride * 2) {\n    const firstP = [flatCoordinates[offset], flatCoordinates[offset + 1]];\n    const lastP = [flatCoordinates[offset + stride], flatCoordinates[offset + stride + 1]];\n    return !equals(firstP, lastP);\n  }\n\n  return true;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.drawLineString = function(lineStringGeometry, feature) {\n  let flatCoordinates = lineStringGeometry.getFlatCoordinates();\n  const stride = lineStringGeometry.getStride();\n  if (this.isValid_(flatCoordinates, 0, flatCoordinates.length, stride)) {\n    flatCoordinates = translate(flatCoordinates, 0, flatCoordinates.length,\n      stride, -this.origin[0], -this.origin[1]);\n    if (this.state_.changed) {\n      this.styleIndices_.push(this.indices.length);\n      this.state_.changed = false;\n    }\n    this.startIndices.push(this.indices.length);\n    this.startIndicesFeature.push(feature);\n    this.drawCoordinates_(\n      flatCoordinates, 0, flatCoordinates.length, stride);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.drawMultiLineString = function(multiLineStringGeometry, feature) {\n  const indexCount = this.indices.length;\n  const ends = multiLineStringGeometry.getEnds();\n  ends.unshift(0);\n  const flatCoordinates = multiLineStringGeometry.getFlatCoordinates();\n  const stride = multiLineStringGeometry.getStride();\n  let i, ii;\n  if (ends.length > 1) {\n    for (i = 1, ii = ends.length; i < ii; ++i) {\n      if (this.isValid_(flatCoordinates, ends[i - 1], ends[i], stride)) {\n        const lineString = translate(flatCoordinates, ends[i - 1], ends[i],\n          stride, -this.origin[0], -this.origin[1]);\n        this.drawCoordinates_(\n          lineString, 0, lineString.length, stride);\n      }\n    }\n  }\n  if (this.indices.length > indexCount) {\n    this.startIndices.push(indexCount);\n    this.startIndicesFeature.push(feature);\n    if (this.state_.changed) {\n      this.styleIndices_.push(indexCount);\n      this.state_.changed = false;\n    }\n  }\n};\n\n\n/**\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {Array.<Array.<number>>} holeFlatCoordinates Hole flat coordinates.\n * @param {number} stride Stride.\n */\nWebGLLineStringReplay.prototype.drawPolygonCoordinates = function(\n  flatCoordinates, holeFlatCoordinates, stride) {\n  if (!lineStringIsClosed(flatCoordinates, 0, flatCoordinates.length, stride)) {\n    flatCoordinates.push(flatCoordinates[0]);\n    flatCoordinates.push(flatCoordinates[1]);\n  }\n  this.drawCoordinates_(flatCoordinates, 0, flatCoordinates.length, stride);\n  if (holeFlatCoordinates.length) {\n    let i, ii;\n    for (i = 0, ii = holeFlatCoordinates.length; i < ii; ++i) {\n      if (!lineStringIsClosed(holeFlatCoordinates[i], 0, holeFlatCoordinates[i].length, stride)) {\n        holeFlatCoordinates[i].push(holeFlatCoordinates[i][0]);\n        holeFlatCoordinates[i].push(holeFlatCoordinates[i][1]);\n      }\n      this.drawCoordinates_(holeFlatCoordinates[i], 0,\n        holeFlatCoordinates[i].length, stride);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n * @param {number=} opt_index Index count.\n */\nWebGLLineStringReplay.prototype.setPolygonStyle = function(feature, opt_index) {\n  const index = opt_index === undefined ? this.indices.length : opt_index;\n  this.startIndices.push(index);\n  this.startIndicesFeature.push(feature);\n  if (this.state_.changed) {\n    this.styleIndices_.push(index);\n    this.state_.changed = false;\n  }\n};\n\n\n/**\n * @return {number} Current index.\n */\nWebGLLineStringReplay.prototype.getCurrentIndex = function() {\n  return this.indices.length;\n};\n\n\n/**\n * @inheritDoc\n **/\nWebGLLineStringReplay.prototype.finish = function(context) {\n  // create, bind, and populate the vertices buffer\n  this.verticesBuffer = new WebGLBuffer(this.vertices);\n\n  // create, bind, and populate the indices buffer\n  this.indicesBuffer = new WebGLBuffer(this.indices);\n\n  this.startIndices.push(this.indices.length);\n\n  //Clean up, if there is nothing to draw\n  if (this.styleIndices_.length === 0 && this.styles_.length > 0) {\n    this.styles_ = [];\n  }\n\n  this.vertices = null;\n  this.indices = null;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.getDeleteResourcesFunction = function(context) {\n  const verticesBuffer = this.verticesBuffer;\n  const indicesBuffer = this.indicesBuffer;\n  return function() {\n    context.deleteBuffer(verticesBuffer);\n    context.deleteBuffer(indicesBuffer);\n  };\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.setUpProgram = function(gl, context, size, pixelRatio) {\n  // get the program\n  const program = context.getProgram(fragment, vertex);\n\n  // get the locations\n  let locations;\n  if (!this.defaultLocations_) {\n    locations = new Locations(gl, program);\n    this.defaultLocations_ = locations;\n  } else {\n    locations = this.defaultLocations_;\n  }\n\n  context.useProgram(program);\n\n  // enable the vertex attrib arrays\n  gl.enableVertexAttribArray(locations.a_lastPos);\n  gl.vertexAttribPointer(locations.a_lastPos, 2, FLOAT,\n    false, 28, 0);\n\n  gl.enableVertexAttribArray(locations.a_position);\n  gl.vertexAttribPointer(locations.a_position, 2, FLOAT,\n    false, 28, 8);\n\n  gl.enableVertexAttribArray(locations.a_nextPos);\n  gl.vertexAttribPointer(locations.a_nextPos, 2, FLOAT,\n    false, 28, 16);\n\n  gl.enableVertexAttribArray(locations.a_direction);\n  gl.vertexAttribPointer(locations.a_direction, 1, FLOAT,\n    false, 28, 24);\n\n  // Enable renderer specific uniforms.\n  gl.uniform2fv(locations.u_size, size);\n  gl.uniform1f(locations.u_pixelRatio, pixelRatio);\n\n  return locations;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.shutDownProgram = function(gl, locations) {\n  gl.disableVertexAttribArray(locations.a_lastPos);\n  gl.disableVertexAttribArray(locations.a_position);\n  gl.disableVertexAttribArray(locations.a_nextPos);\n  gl.disableVertexAttribArray(locations.a_direction);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.drawReplay = function(gl, context, skippedFeaturesHash, hitDetection) {\n  //Save GL parameters.\n  const tmpDepthFunc = /** @type {number} */ (gl.getParameter(gl.DEPTH_FUNC));\n  const tmpDepthMask = /** @type {boolean} */ (gl.getParameter(gl.DEPTH_WRITEMASK));\n\n  if (!hitDetection) {\n    gl.enable(gl.DEPTH_TEST);\n    gl.depthMask(true);\n    gl.depthFunc(gl.NOTEQUAL);\n  }\n\n  if (!isEmpty(skippedFeaturesHash)) {\n    this.drawReplaySkipping_(gl, context, skippedFeaturesHash);\n  } else {\n    //Draw by style groups to minimize drawElements() calls.\n    let i, start, end, nextStyle;\n    end = this.startIndices[this.startIndices.length - 1];\n    for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n      start = this.styleIndices_[i];\n      nextStyle = this.styles_[i];\n      this.setStrokeStyle_(gl, nextStyle[0], nextStyle[1], nextStyle[2]);\n      this.drawElements(gl, context, start, end);\n      gl.clear(gl.DEPTH_BUFFER_BIT);\n      end = start;\n    }\n  }\n  if (!hitDetection) {\n    gl.disable(gl.DEPTH_TEST);\n    gl.clear(gl.DEPTH_BUFFER_BIT);\n    //Restore GL parameters.\n    gl.depthMask(tmpDepthMask);\n    gl.depthFunc(tmpDepthFunc);\n  }\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object} skippedFeaturesHash Ids of features to skip.\n */\nWebGLLineStringReplay.prototype.drawReplaySkipping_ = function(gl, context, skippedFeaturesHash) {\n  let i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex, featureStart;\n  featureIndex = this.startIndices.length - 2;\n  end = start = this.startIndices[featureIndex + 1];\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setStrokeStyle_(gl, nextStyle[0], nextStyle[1], nextStyle[2]);\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      featureStart = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid]) {\n        if (start !== end) {\n          this.drawElements(gl, context, start, end);\n          gl.clear(gl.DEPTH_BUFFER_BIT);\n        }\n        end = featureStart;\n      }\n      featureIndex--;\n      start = featureStart;\n    }\n    if (start !== end) {\n      this.drawElements(gl, context, start, end);\n      gl.clear(gl.DEPTH_BUFFER_BIT);\n    }\n    start = end = groupStart;\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.drawHitDetectionReplayOneByOne = function(gl, context, skippedFeaturesHash,\n  featureCallback, opt_hitExtent) {\n  let i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex;\n  featureIndex = this.startIndices.length - 2;\n  end = this.startIndices[featureIndex + 1];\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setStrokeStyle_(gl, nextStyle[0], nextStyle[1], nextStyle[2]);\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      start = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid] === undefined &&\n          feature.getGeometry() &&\n          (opt_hitExtent === undefined || intersects(\n            /** @type {Array<number>} */ (opt_hitExtent),\n            feature.getGeometry().getExtent()))) {\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n        this.drawElements(gl, context, start, end);\n\n        const result = featureCallback(feature);\n\n        if (result) {\n          return result;\n        }\n\n      }\n      featureIndex--;\n      end = start;\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {Array.<number>} color Color.\n * @param {number} lineWidth Line width.\n * @param {number} miterLimit Miter limit.\n */\nWebGLLineStringReplay.prototype.setStrokeStyle_ = function(gl, color, lineWidth, miterLimit) {\n  gl.uniform4fv(this.defaultLocations_.u_color, color);\n  gl.uniform1f(this.defaultLocations_.u_lineWidth, lineWidth);\n  gl.uniform1f(this.defaultLocations_.u_miterLimit, miterLimit);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLLineStringReplay.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {\n  const strokeStyleLineCap = strokeStyle.getLineCap();\n  this.state_.lineCap = strokeStyleLineCap !== undefined ?\n    strokeStyleLineCap : DEFAULT_LINECAP;\n  const strokeStyleLineDash = strokeStyle.getLineDash();\n  this.state_.lineDash = strokeStyleLineDash ?\n    strokeStyleLineDash : DEFAULT_LINEDASH;\n  const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n  this.state_.lineDashOffset = strokeStyleLineDashOffset ?\n    strokeStyleLineDashOffset : DEFAULT_LINEDASHOFFSET;\n  const strokeStyleLineJoin = strokeStyle.getLineJoin();\n  this.state_.lineJoin = strokeStyleLineJoin !== undefined ?\n    strokeStyleLineJoin : DEFAULT_LINEJOIN;\n  let strokeStyleColor = strokeStyle.getColor();\n  if (!(strokeStyleColor instanceof CanvasGradient) &&\n      !(strokeStyleColor instanceof CanvasPattern)) {\n    strokeStyleColor = asArray(strokeStyleColor).map(function(c, i) {\n      return i != 3 ? c / 255 : c;\n    }) || DEFAULT_STROKESTYLE;\n  } else {\n    strokeStyleColor = DEFAULT_STROKESTYLE;\n  }\n  let strokeStyleWidth = strokeStyle.getWidth();\n  strokeStyleWidth = strokeStyleWidth !== undefined ?\n    strokeStyleWidth : DEFAULT_LINEWIDTH;\n  let strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n  strokeStyleMiterLimit = strokeStyleMiterLimit !== undefined ?\n    strokeStyleMiterLimit : DEFAULT_MITERLIMIT;\n  if (!this.state_.strokeColor || !equals(this.state_.strokeColor, strokeStyleColor) ||\n      this.state_.lineWidth !== strokeStyleWidth || this.state_.miterLimit !== strokeStyleMiterLimit) {\n    this.state_.changed = true;\n    this.state_.strokeColor = strokeStyleColor;\n    this.state_.lineWidth = strokeStyleWidth;\n    this.state_.miterLimit = strokeStyleMiterLimit;\n    this.styles_.push([strokeStyleColor, strokeStyleWidth, strokeStyleMiterLimit]);\n  }\n};\n\nexport default WebGLLineStringReplay;\n","/**\n * @module ol/render/webgl/polygonreplay/defaultshader\n */\n// This file is automatically generated, do not edit.\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG as DEBUG_WEBGL} from '../../../webgl.js';\nimport WebGLFragment from '../../../webgl/Fragment.js';\nimport WebGLVertex from '../../../webgl/Vertex.js';\n\nexport const fragment = new WebGLFragment(DEBUG_WEBGL ?\n  'precision mediump float;\\n\\n\\n\\nuniform vec4 u_color;\\nuniform float u_opacity;\\n\\nvoid main(void) {\\n  gl_FragColor = u_color;\\n  float alpha = u_color.a * u_opacity;\\n  if (alpha == 0.0) {\\n    discard;\\n  }\\n  gl_FragColor.a = alpha;\\n}\\n' :\n  'precision mediump float;uniform vec4 e;uniform float f;void main(void){gl_FragColor=e;float alpha=e.a*f;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}');\n\nexport const vertex = new WebGLVertex(DEBUG_WEBGL ?\n  '\\n\\nattribute vec2 a_position;\\n\\nuniform mat4 u_projectionMatrix;\\nuniform mat4 u_offsetScaleMatrix;\\nuniform mat4 u_offsetRotateMatrix;\\n\\nvoid main(void) {\\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\\n}\\n\\n\\n' :\n  'attribute vec2 a;uniform mat4 b;uniform mat4 c;uniform mat4 d;void main(void){gl_Position=b*vec4(a,0.0,1.0);}');\n","/**\n * @module ol/render/webgl/polygonreplay/defaultshader/Locations\n */\n// This file is automatically generated, do not edit\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG as DEBUG_WEBGL} from '../../../../webgl.js';\n\n/**\n * @constructor\n * @param {WebGLRenderingContext} gl GL.\n * @param {WebGLProgram} program Program.\n * @struct\n */\nconst Locations = function(gl, program) {\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_projectionMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_projectionMatrix' : 'b');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetScaleMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetScaleMatrix' : 'c');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_offsetRotateMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_offsetRotateMatrix' : 'd');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_color = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_color' : 'e');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_opacity = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_opacity' : 'f');\n\n  /**\n   * @type {number}\n   */\n  this.a_position = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_position' : 'a');\n};\n\nexport default Locations;\n","/**\n * @module ol/structs/LinkedList\n */\n\n\n/**\n * @typedef {Object} Item\n * @property {module:ol/structs/LinkedList~Item} [prev]\n * @property {module:ol/structs/LinkedList~Item} [next]\n * @property {?} data\n */\n\n\n/**\n * Creates an empty linked list structure.\n *\n * @constructor\n * @struct\n * @param {boolean=} opt_circular The last item is connected to the first one,\n * and the first item to the last one. Default is true.\n */\nconst LinkedList = function(opt_circular) {\n\n  /**\n   * @private\n   * @type {module:ol/structs/LinkedList~Item|undefined}\n   */\n  this.first_;\n\n  /**\n   * @private\n   * @type {module:ol/structs/LinkedList~Item|undefined}\n   */\n  this.last_;\n\n  /**\n   * @private\n   * @type {module:ol/structs/LinkedList~Item|undefined}\n   */\n  this.head_;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.circular_ = opt_circular === undefined ? true : opt_circular;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.length_ = 0;\n};\n\n/**\n * Inserts an item into the linked list right after the current one.\n *\n * @param {?} data Item data.\n */\nLinkedList.prototype.insertItem = function(data) {\n\n  /** @type {module:ol/structs/LinkedList~Item} */\n  const item = {\n    prev: undefined,\n    next: undefined,\n    data: data\n  };\n\n  const head = this.head_;\n\n  //Initialize the list.\n  if (!head) {\n    this.first_ = item;\n    this.last_ = item;\n    if (this.circular_) {\n      item.next = item;\n      item.prev = item;\n    }\n  } else {\n    //Link the new item to the adjacent ones.\n    const next = head.next;\n    item.prev = head;\n    item.next = next;\n    head.next = item;\n    if (next) {\n      next.prev = item;\n    }\n\n    if (head === this.last_) {\n      this.last_ = item;\n    }\n  }\n  this.head_ = item;\n  this.length_++;\n};\n\n/**\n * Removes the current item from the list. Sets the cursor to the next item,\n * if possible.\n */\nLinkedList.prototype.removeItem = function() {\n  const head = this.head_;\n  if (head) {\n    const next = head.next;\n    const prev = head.prev;\n    if (next) {\n      next.prev = prev;\n    }\n    if (prev) {\n      prev.next = next;\n    }\n    this.head_ = next || prev;\n\n    if (this.first_ === this.last_) {\n      this.head_ = undefined;\n      this.first_ = undefined;\n      this.last_ = undefined;\n    } else if (this.first_ === head) {\n      this.first_ = this.head_;\n    } else if (this.last_ === head) {\n      this.last_ = prev ? this.head_.prev : this.head_;\n    }\n    this.length_--;\n  }\n};\n\n/**\n * Sets the cursor to the first item, and returns the associated data.\n *\n * @return {?} Item data.\n */\nLinkedList.prototype.firstItem = function() {\n  this.head_ = this.first_;\n  if (this.head_) {\n    return this.head_.data;\n  }\n  return undefined;\n};\n\n/**\n* Sets the cursor to the last item, and returns the associated data.\n*\n* @return {?} Item data.\n*/\nLinkedList.prototype.lastItem = function() {\n  this.head_ = this.last_;\n  if (this.head_) {\n    return this.head_.data;\n  }\n  return undefined;\n};\n\n/**\n * Sets the cursor to the next item, and returns the associated data.\n *\n * @return {?} Item data.\n */\nLinkedList.prototype.nextItem = function() {\n  if (this.head_ && this.head_.next) {\n    this.head_ = this.head_.next;\n    return this.head_.data;\n  }\n  return undefined;\n};\n\n/**\n * Returns the next item's data without moving the cursor.\n *\n * @return {?} Item data.\n */\nLinkedList.prototype.getNextItem = function() {\n  if (this.head_ && this.head_.next) {\n    return this.head_.next.data;\n  }\n  return undefined;\n};\n\n/**\n * Sets the cursor to the previous item, and returns the associated data.\n *\n * @return {?} Item data.\n */\nLinkedList.prototype.prevItem = function() {\n  if (this.head_ && this.head_.prev) {\n    this.head_ = this.head_.prev;\n    return this.head_.data;\n  }\n  return undefined;\n};\n\n/**\n * Returns the previous item's data without moving the cursor.\n *\n * @return {?} Item data.\n */\nLinkedList.prototype.getPrevItem = function() {\n  if (this.head_ && this.head_.prev) {\n    return this.head_.prev.data;\n  }\n  return undefined;\n};\n\n/**\n * Returns the current item's data.\n *\n * @return {?} Item data.\n */\nLinkedList.prototype.getCurrItem = function() {\n  if (this.head_) {\n    return this.head_.data;\n  }\n  return undefined;\n};\n\n/**\n * Sets the first item of the list. This only works for circular lists, and sets\n * the last item accordingly.\n */\nLinkedList.prototype.setFirstItem = function() {\n  if (this.circular_ && this.head_) {\n    this.first_ = this.head_;\n    this.last_ = this.head_.prev;\n  }\n};\n\n/**\n * Concatenates two lists.\n * @param {module:ol/structs/LinkedList} list List to merge into the current list.\n */\nLinkedList.prototype.concat = function(list) {\n  if (list.head_) {\n    if (this.head_) {\n      const end = this.head_.next;\n      this.head_.next = list.first_;\n      list.first_.prev = this.head_;\n      end.prev = list.last_;\n      list.last_.next = end;\n      this.length_ += list.length_;\n    } else {\n      this.head_ = list.head_;\n      this.first_ = list.first_;\n      this.last_ = list.last_;\n      this.length_ = list.length_;\n    }\n    list.head_ = undefined;\n    list.first_ = undefined;\n    list.last_ = undefined;\n    list.length_ = 0;\n  }\n};\n\n/**\n * Returns the current length of the list.\n *\n * @return {number} Length.\n */\nLinkedList.prototype.getLength = function() {\n  return this.length_;\n};\nexport default LinkedList;\n","/**\n * @module ol/render/webgl/PolygonReplay\n */\nimport {getUid, inherits} from '../../util.js';\nimport {equals} from '../../array.js';\nimport {asArray} from '../../color.js';\nimport {intersects} from '../../extent.js';\nimport {isEmpty} from '../../obj.js';\nimport {linearRingContainsXY} from '../../geom/flat/contains.js';\nimport {linearRingIsClockwise} from '../../geom/flat/orient.js';\nimport {translate} from '../../geom/flat/transform.js';\nimport {fragment, vertex} from '../webgl/polygonreplay/defaultshader.js';\nimport Locations from '../webgl/polygonreplay/defaultshader/Locations.js';\nimport WebGLLineStringReplay from '../webgl/LineStringReplay.js';\nimport WebGLReplay from '../webgl/Replay.js';\nimport {triangleIsCounterClockwise, EPSILON, DEFAULT_FILLSTYLE} from '../webgl.js';\nimport Stroke from '../../style/Stroke.js';\nimport LinkedList from '../../structs/LinkedList.js';\nimport RBush from '../../structs/RBush.js';\nimport {FLOAT} from '../../webgl.js';\nimport WebGLBuffer from '../../webgl/Buffer.js';\n\n\n/**\n * @typedef {Object} PolygonVertex\n * @property {number} x\n * @property {number} y\n * @property {number} i\n * @property {boolean} [reflex]\n */\n\n/**\n * @typedef {Object} PolygonSegment\n * @property {module:ol/render/webgl/PolygonReplay~PolygonVertex} p0\n * @property {module:ol/render/webgl/PolygonReplay~PolygonVertex} p1\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/render/webgl/Replay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @struct\n */\nconst WebGLPolygonReplay = function(tolerance, maxExtent) {\n  WebGLReplay.call(this, tolerance, maxExtent);\n\n  this.lineStringReplay = new WebGLLineStringReplay(\n    tolerance, maxExtent);\n\n  /**\n   * @private\n   * @type {module:ol/render/webgl/polygonreplay/defaultshader/Locations}\n   */\n  this.defaultLocations_ = null;\n\n  /**\n   * @private\n   * @type {Array.<Array.<number>>}\n   */\n  this.styles_ = [];\n\n  /**\n   * @private\n   * @type {Array.<number>}\n   */\n  this.styleIndices_ = [];\n\n  /**\n   * @private\n   * @type {{fillColor: (Array.<number>|null),\n   *         changed: boolean}|null}\n   */\n  this.state_ = {\n    fillColor: null,\n    changed: false\n  };\n\n};\n\ninherits(WebGLPolygonReplay, WebGLReplay);\n\n\n/**\n * Draw one polygon.\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {Array.<Array.<number>>} holeFlatCoordinates Hole flat coordinates.\n * @param {number} stride Stride.\n * @private\n */\nWebGLPolygonReplay.prototype.drawCoordinates_ = function(\n  flatCoordinates, holeFlatCoordinates, stride) {\n  // Triangulate the polygon\n  const outerRing = new LinkedList();\n  const rtree = new RBush();\n  // Initialize the outer ring\n  this.processFlatCoordinates_(flatCoordinates, stride, outerRing, rtree, true);\n  const maxCoords = this.getMaxCoords_(outerRing);\n\n  // Eliminate holes, if there are any\n  if (holeFlatCoordinates.length) {\n    let i, ii;\n    const holeLists = [];\n    for (i = 0, ii = holeFlatCoordinates.length; i < ii; ++i) {\n      const holeList = {\n        list: new LinkedList(),\n        maxCoords: undefined,\n        rtree: new RBush()\n      };\n      holeLists.push(holeList);\n      this.processFlatCoordinates_(holeFlatCoordinates[i],\n        stride, holeList.list, holeList.rtree, false);\n      this.classifyPoints_(holeList.list, holeList.rtree, true);\n      holeList.maxCoords = this.getMaxCoords_(holeList.list);\n    }\n    holeLists.sort(function(a, b) {\n      return b.maxCoords[0] === a.maxCoords[0] ?\n        a.maxCoords[1] - b.maxCoords[1] : b.maxCoords[0] - a.maxCoords[0];\n    });\n    for (i = 0; i < holeLists.length; ++i) {\n      const currList = holeLists[i].list;\n      const start = currList.firstItem();\n      let currItem = start;\n      let intersection;\n      do {\n        //TODO: Triangulate holes when they intersect the outer ring.\n        if (this.getIntersections_(currItem, rtree).length) {\n          intersection = true;\n          break;\n        }\n        currItem = currList.nextItem();\n      } while (start !== currItem);\n      if (!intersection) {\n        if (this.bridgeHole_(currList, holeLists[i].maxCoords[0], outerRing, maxCoords[0], rtree)) {\n          rtree.concat(holeLists[i].rtree);\n          this.classifyPoints_(outerRing, rtree, false);\n        }\n      }\n    }\n  } else {\n    this.classifyPoints_(outerRing, rtree, false);\n  }\n  this.triangulate_(outerRing, rtree);\n};\n\n\n/**\n * Inserts flat coordinates in a linked list and adds them to the vertex buffer.\n * @private\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} stride Stride.\n * @param {module:ol/structs/LinkedList} list Linked list.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @param {boolean} clockwise Coordinate order should be clockwise.\n */\nWebGLPolygonReplay.prototype.processFlatCoordinates_ = function(\n  flatCoordinates, stride, list, rtree, clockwise) {\n  const isClockwise = linearRingIsClockwise(flatCoordinates,\n    0, flatCoordinates.length, stride);\n  let i, ii;\n  let n = this.vertices.length / 2;\n  /** @type {module:ol/render/webgl/PolygonReplay~PolygonVertex} */\n  let start;\n  /** @type {module:ol/render/webgl/PolygonReplay~PolygonVertex} */\n  let p0;\n  /** @type {module:ol/render/webgl/PolygonReplay~PolygonVertex} */\n  let p1;\n  const extents = [];\n  const segments = [];\n  if (clockwise === isClockwise) {\n    start = this.createPoint_(flatCoordinates[0], flatCoordinates[1], n++);\n    p0 = start;\n    for (i = stride, ii = flatCoordinates.length; i < ii; i += stride) {\n      p1 = this.createPoint_(flatCoordinates[i], flatCoordinates[i + 1], n++);\n      segments.push(this.insertItem_(p0, p1, list));\n      extents.push([Math.min(p0.x, p1.x), Math.min(p0.y, p1.y), Math.max(p0.x, p1.x),\n        Math.max(p0.y, p1.y)]);\n      p0 = p1;\n    }\n    segments.push(this.insertItem_(p1, start, list));\n    extents.push([Math.min(p0.x, p1.x), Math.min(p0.y, p1.y), Math.max(p0.x, p1.x),\n      Math.max(p0.y, p1.y)]);\n  } else {\n    const end = flatCoordinates.length - stride;\n    start = this.createPoint_(flatCoordinates[end], flatCoordinates[end + 1], n++);\n    p0 = start;\n    for (i = end - stride, ii = 0; i >= ii; i -= stride) {\n      p1 = this.createPoint_(flatCoordinates[i], flatCoordinates[i + 1], n++);\n      segments.push(this.insertItem_(p0, p1, list));\n      extents.push([Math.min(p0.x, p1.x), Math.min(p0.y, p1.y), Math.max(p0.x, p1.x),\n        Math.max(p0.y, p1.y)]);\n      p0 = p1;\n    }\n    segments.push(this.insertItem_(p1, start, list));\n    extents.push([Math.min(p0.x, p1.x), Math.min(p0.y, p1.y), Math.max(p0.x, p1.x),\n      Math.max(p0.y, p1.y)]);\n  }\n  rtree.load(extents, segments);\n};\n\n\n/**\n * Returns the rightmost coordinates of a polygon on the X axis.\n * @private\n * @param {module:ol/structs/LinkedList} list Polygons ring.\n * @return {Array.<number>} Max X coordinates.\n */\nWebGLPolygonReplay.prototype.getMaxCoords_ = function(list) {\n  const start = list.firstItem();\n  let seg = start;\n  let maxCoords = [seg.p0.x, seg.p0.y];\n\n  do {\n    seg = list.nextItem();\n    if (seg.p0.x > maxCoords[0]) {\n      maxCoords = [seg.p0.x, seg.p0.y];\n    }\n  } while (seg !== start);\n\n  return maxCoords;\n};\n\n\n/**\n * Classifies the points of a polygon list as convex, reflex. Removes collinear vertices.\n * @private\n * @param {module:ol/structs/LinkedList} list Polygon ring.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @param {boolean} ccw The orientation of the polygon is counter-clockwise.\n * @return {boolean} There were reclassified points.\n */\nWebGLPolygonReplay.prototype.classifyPoints_ = function(list, rtree, ccw) {\n  let start = list.firstItem();\n  let s0 = start;\n  let s1 = list.nextItem();\n  let pointsReclassified = false;\n  do {\n    const reflex = ccw ? triangleIsCounterClockwise(s1.p1.x,\n      s1.p1.y, s0.p1.x, s0.p1.y, s0.p0.x, s0.p0.y) :\n      triangleIsCounterClockwise(s0.p0.x, s0.p0.y, s0.p1.x,\n        s0.p1.y, s1.p1.x, s1.p1.y);\n    if (reflex === undefined) {\n      this.removeItem_(s0, s1, list, rtree);\n      pointsReclassified = true;\n      if (s1 === start) {\n        start = list.getNextItem();\n      }\n      s1 = s0;\n      list.prevItem();\n    } else if (s0.p1.reflex !== reflex) {\n      s0.p1.reflex = reflex;\n      pointsReclassified = true;\n    }\n    s0 = s1;\n    s1 = list.nextItem();\n  } while (s0 !== start);\n  return pointsReclassified;\n};\n\n\n/**\n * @private\n * @param {module:ol/structs/LinkedList} hole Linked list of the hole.\n * @param {number} holeMaxX Maximum X value of the hole.\n * @param {module:ol/structs/LinkedList} list Linked list of the polygon.\n * @param {number} listMaxX Maximum X value of the polygon.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @return {boolean} Bridging was successful.\n */\nWebGLPolygonReplay.prototype.bridgeHole_ = function(hole, holeMaxX,\n  list, listMaxX, rtree) {\n  let seg = hole.firstItem();\n  while (seg.p1.x !== holeMaxX) {\n    seg = hole.nextItem();\n  }\n\n  const p1 = seg.p1;\n  /** @type {module:ol/render/webgl/PolygonReplay~PolygonVertex} */\n  const p2 = {x: listMaxX, y: p1.y, i: -1};\n  let minDist = Infinity;\n  let i, ii, bestPoint;\n  /** @type {module:ol/render/webgl/PolygonReplay~PolygonVertex} */\n  let p5;\n\n  const intersectingSegments = this.getIntersections_({p0: p1, p1: p2}, rtree, true);\n  for (i = 0, ii = intersectingSegments.length; i < ii; ++i) {\n    const currSeg = intersectingSegments[i];\n    const intersection = this.calculateIntersection_(p1, p2, currSeg.p0,\n      currSeg.p1, true);\n    const dist = Math.abs(p1.x - intersection[0]);\n    if (dist < minDist && triangleIsCounterClockwise(p1.x, p1.y,\n      currSeg.p0.x, currSeg.p0.y, currSeg.p1.x, currSeg.p1.y) !== undefined) {\n      minDist = dist;\n      p5 = {x: intersection[0], y: intersection[1], i: -1};\n      seg = currSeg;\n    }\n  }\n  if (minDist === Infinity) {\n    return false;\n  }\n  bestPoint = seg.p1;\n\n  if (minDist > 0) {\n    const pointsInTriangle = this.getPointsInTriangle_(p1, p5, seg.p1, rtree);\n    if (pointsInTriangle.length) {\n      let theta = Infinity;\n      for (i = 0, ii = pointsInTriangle.length; i < ii; ++i) {\n        const currPoint = pointsInTriangle[i];\n        const currTheta = Math.atan2(p1.y - currPoint.y, p2.x - currPoint.x);\n        if (currTheta < theta || (currTheta === theta && currPoint.x < bestPoint.x)) {\n          theta = currTheta;\n          bestPoint = currPoint;\n        }\n      }\n    }\n  }\n\n  seg = list.firstItem();\n  while (seg.p1.x !== bestPoint.x || seg.p1.y !== bestPoint.y) {\n    seg = list.nextItem();\n  }\n\n  //We clone the bridge points as they can have different convexity.\n  const p0Bridge = {x: p1.x, y: p1.y, i: p1.i, reflex: undefined};\n  const p1Bridge = {x: seg.p1.x, y: seg.p1.y, i: seg.p1.i, reflex: undefined};\n\n  hole.getNextItem().p0 = p0Bridge;\n  this.insertItem_(p1, seg.p1, hole, rtree);\n  this.insertItem_(p1Bridge, p0Bridge, hole, rtree);\n  seg.p1 = p1Bridge;\n  hole.setFirstItem();\n  list.concat(hole);\n\n  return true;\n};\n\n\n/**\n * @private\n * @param {module:ol/structs/LinkedList} list Linked list of the polygon.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n */\nWebGLPolygonReplay.prototype.triangulate_ = function(list, rtree) {\n  let ccw = false;\n  let simple = this.isSimple_(list, rtree);\n\n  // Start clipping ears\n  while (list.getLength() > 3) {\n    if (simple) {\n      if (!this.clipEars_(list, rtree, simple, ccw)) {\n        if (!this.classifyPoints_(list, rtree, ccw)) {\n          // Due to the behavior of OL's PIP algorithm, the ear clipping cannot\n          // introduce touching segments. However, the original data may have some.\n          if (!this.resolveSelfIntersections_(list, rtree, true)) {\n            break;\n          }\n        }\n      }\n    } else {\n      if (!this.clipEars_(list, rtree, simple, ccw)) {\n        // We ran out of ears, try to reclassify.\n        if (!this.classifyPoints_(list, rtree, ccw)) {\n          // We have a bad polygon, try to resolve local self-intersections.\n          if (!this.resolveSelfIntersections_(list, rtree)) {\n            simple = this.isSimple_(list, rtree);\n            if (!simple) {\n              // We have a really bad polygon, try more time consuming methods.\n              this.splitPolygon_(list, rtree);\n              break;\n            } else {\n              ccw = !this.isClockwise_(list);\n              this.classifyPoints_(list, rtree, ccw);\n            }\n          }\n        }\n      }\n    }\n  }\n  if (list.getLength() === 3) {\n    let numIndices = this.indices.length;\n    this.indices[numIndices++] = list.getPrevItem().p0.i;\n    this.indices[numIndices++] = list.getCurrItem().p0.i;\n    this.indices[numIndices++] = list.getNextItem().p0.i;\n  }\n};\n\n\n/**\n * @private\n * @param {module:ol/structs/LinkedList} list Linked list of the polygon.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @param {boolean} simple The polygon is simple.\n * @param {boolean} ccw Orientation of the polygon is counter-clockwise.\n * @return {boolean} There were processed ears.\n */\nWebGLPolygonReplay.prototype.clipEars_ = function(list, rtree, simple, ccw) {\n  let numIndices = this.indices.length;\n  let start = list.firstItem();\n  let s0 = list.getPrevItem();\n  let s1 = start;\n  let s2 = list.nextItem();\n  let s3 = list.getNextItem();\n  let p0, p1, p2;\n  let processedEars = false;\n  do {\n    p0 = s1.p0;\n    p1 = s1.p1;\n    p2 = s2.p1;\n    if (p1.reflex === false) {\n      // We might have a valid ear\n      let variableCriterion;\n      if (simple) {\n        variableCriterion = this.getPointsInTriangle_(p0, p1, p2, rtree, true).length === 0;\n      } else {\n        variableCriterion = ccw ? this.diagonalIsInside_(s3.p1, p2, p1, p0,\n          s0.p0) : this.diagonalIsInside_(s0.p0, p0, p1, p2, s3.p1);\n      }\n      if ((simple || this.getIntersections_({p0: p0, p1: p2}, rtree).length === 0) &&\n          variableCriterion) {\n        //The diagonal is completely inside the polygon\n        if (simple || p0.reflex === false || p2.reflex === false ||\n            linearRingIsClockwise([s0.p0.x, s0.p0.y, p0.x,\n              p0.y, p1.x, p1.y, p2.x, p2.y, s3.p1.x, s3.p1.y], 0, 10, 2) === !ccw) {\n          //The diagonal is persumably valid, we have an ear\n          this.indices[numIndices++] = p0.i;\n          this.indices[numIndices++] = p1.i;\n          this.indices[numIndices++] = p2.i;\n          this.removeItem_(s1, s2, list, rtree);\n          if (s2 === start) {\n            start = s3;\n          }\n          processedEars = true;\n        }\n      }\n    }\n    // Else we have a reflex point.\n    s0 = list.getPrevItem();\n    s1 = list.getCurrItem();\n    s2 = list.nextItem();\n    s3 = list.getNextItem();\n  } while (s1 !== start && list.getLength() > 3);\n\n  return processedEars;\n};\n\n\n/**\n * @private\n * @param {module:ol/structs/LinkedList} list Linked list of the polygon.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @param {boolean=} opt_touch Resolve touching segments.\n * @return {boolean} There were resolved intersections.\n*/\nWebGLPolygonReplay.prototype.resolveSelfIntersections_ = function(\n  list, rtree, opt_touch) {\n  const start = list.firstItem();\n  list.nextItem();\n  let s0 = start;\n  let s1 = list.nextItem();\n  let resolvedIntersections = false;\n\n  do {\n    const intersection = this.calculateIntersection_(s0.p0, s0.p1, s1.p0, s1.p1,\n      opt_touch);\n    if (intersection) {\n      let breakCond = false;\n      const numVertices = this.vertices.length;\n      let numIndices = this.indices.length;\n      const n = numVertices / 2;\n      const seg = list.prevItem();\n      list.removeItem();\n      rtree.remove(seg);\n      breakCond = (seg === start);\n      let p;\n      if (opt_touch) {\n        if (intersection[0] === s0.p0.x && intersection[1] === s0.p0.y) {\n          list.prevItem();\n          p = s0.p0;\n          s1.p0 = p;\n          rtree.remove(s0);\n          breakCond = breakCond || (s0 === start);\n        } else {\n          p = s1.p1;\n          s0.p1 = p;\n          rtree.remove(s1);\n          breakCond = breakCond || (s1 === start);\n        }\n        list.removeItem();\n      } else {\n        p = this.createPoint_(intersection[0], intersection[1], n);\n        s0.p1 = p;\n        s1.p0 = p;\n        rtree.update([Math.min(s0.p0.x, s0.p1.x), Math.min(s0.p0.y, s0.p1.y),\n          Math.max(s0.p0.x, s0.p1.x), Math.max(s0.p0.y, s0.p1.y)], s0);\n        rtree.update([Math.min(s1.p0.x, s1.p1.x), Math.min(s1.p0.y, s1.p1.y),\n          Math.max(s1.p0.x, s1.p1.x), Math.max(s1.p0.y, s1.p1.y)], s1);\n      }\n\n      this.indices[numIndices++] = seg.p0.i;\n      this.indices[numIndices++] = seg.p1.i;\n      this.indices[numIndices++] = p.i;\n\n      resolvedIntersections = true;\n      if (breakCond) {\n        break;\n      }\n    }\n\n    s0 = list.getPrevItem();\n    s1 = list.nextItem();\n  } while (s0 !== start);\n  return resolvedIntersections;\n};\n\n\n/**\n * @private\n * @param {module:ol/structs/LinkedList} list Linked list of the polygon.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @return {boolean} The polygon is simple.\n */\nWebGLPolygonReplay.prototype.isSimple_ = function(list, rtree) {\n  const start = list.firstItem();\n  let seg = start;\n  do {\n    if (this.getIntersections_(seg, rtree).length) {\n      return false;\n    }\n    seg = list.nextItem();\n  } while (seg !== start);\n  return true;\n};\n\n\n/**\n * @private\n * @param {module:ol/structs/LinkedList} list Linked list of the polygon.\n * @return {boolean} Orientation is clockwise.\n */\nWebGLPolygonReplay.prototype.isClockwise_ = function(list) {\n  const length = list.getLength() * 2;\n  const flatCoordinates = new Array(length);\n  const start = list.firstItem();\n  let seg = start;\n  let i = 0;\n  do {\n    flatCoordinates[i++] = seg.p0.x;\n    flatCoordinates[i++] = seg.p0.y;\n    seg = list.nextItem();\n  } while (seg !== start);\n  return linearRingIsClockwise(flatCoordinates, 0, length, 2);\n};\n\n\n/**\n * @private\n * @param {module:ol/structs/LinkedList} list Linked list of the polygon.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n */\nWebGLPolygonReplay.prototype.splitPolygon_ = function(list, rtree) {\n  const start = list.firstItem();\n  let s0 = start;\n  do {\n    const intersections = this.getIntersections_(s0, rtree);\n    if (intersections.length) {\n      const s1 = intersections[0];\n      const n = this.vertices.length / 2;\n      const intersection = this.calculateIntersection_(s0.p0,\n        s0.p1, s1.p0, s1.p1);\n      const p = this.createPoint_(intersection[0], intersection[1], n);\n      const newPolygon = new LinkedList();\n      const newRtree = new RBush();\n      this.insertItem_(p, s0.p1, newPolygon, newRtree);\n      s0.p1 = p;\n      rtree.update([Math.min(s0.p0.x, p.x), Math.min(s0.p0.y, p.y),\n        Math.max(s0.p0.x, p.x), Math.max(s0.p0.y, p.y)], s0);\n      let currItem = list.nextItem();\n      while (currItem !== s1) {\n        this.insertItem_(currItem.p0, currItem.p1, newPolygon, newRtree);\n        rtree.remove(currItem);\n        list.removeItem();\n        currItem = list.getCurrItem();\n      }\n      this.insertItem_(s1.p0, p, newPolygon, newRtree);\n      s1.p0 = p;\n      rtree.update([Math.min(s1.p1.x, p.x), Math.min(s1.p1.y, p.y),\n        Math.max(s1.p1.x, p.x), Math.max(s1.p1.y, p.y)], s1);\n      this.classifyPoints_(list, rtree, false);\n      this.triangulate_(list, rtree);\n      this.classifyPoints_(newPolygon, newRtree, false);\n      this.triangulate_(newPolygon, newRtree);\n      break;\n    }\n    s0 = list.nextItem();\n  } while (s0 !== start);\n};\n\n\n/**\n * @private\n * @param {number} x X coordinate.\n * @param {number} y Y coordinate.\n * @param {number} i Index.\n * @return {module:ol/render/webgl/PolygonReplay~PolygonVertex} List item.\n */\nWebGLPolygonReplay.prototype.createPoint_ = function(x, y, i) {\n  let numVertices = this.vertices.length;\n  this.vertices[numVertices++] = x;\n  this.vertices[numVertices++] = y;\n  /** @type {module:ol/render/webgl/PolygonReplay~PolygonVertex} */\n  const p = {\n    x: x,\n    y: y,\n    i: i,\n    reflex: undefined\n  };\n  return p;\n};\n\n\n/**\n * @private\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p0 First point of segment.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p1 Second point of segment.\n * @param {module:ol/structs/LinkedList} list Polygon ring.\n * @param {module:ol/structs/RBush=} opt_rtree Insert the segment into the R-Tree.\n * @return {module:ol/render/webgl/PolygonReplay~PolygonSegment} segment.\n */\nWebGLPolygonReplay.prototype.insertItem_ = function(p0, p1, list, opt_rtree) {\n  const seg = {\n    p0: p0,\n    p1: p1\n  };\n  list.insertItem(seg);\n  if (opt_rtree) {\n    opt_rtree.insert([Math.min(p0.x, p1.x), Math.min(p0.y, p1.y),\n      Math.max(p0.x, p1.x), Math.max(p0.y, p1.y)], seg);\n  }\n  return seg;\n};\n\n\n/**\n  * @private\n  * @param {module:ol/render/webgl/PolygonReplay~PolygonSegment} s0 Segment before the remove candidate.\n  * @param {module:ol/render/webgl/PolygonReplay~PolygonSegment} s1 Remove candidate segment.\n  * @param {module:ol/structs/LinkedList} list Polygon ring.\n  * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n  */\nWebGLPolygonReplay.prototype.removeItem_ = function(s0, s1, list, rtree) {\n  if (list.getCurrItem() === s1) {\n    list.removeItem();\n    s0.p1 = s1.p1;\n    rtree.remove(s1);\n    rtree.update([Math.min(s0.p0.x, s0.p1.x), Math.min(s0.p0.y, s0.p1.y),\n      Math.max(s0.p0.x, s0.p1.x), Math.max(s0.p0.y, s0.p1.y)], s0);\n  }\n};\n\n\n/**\n * @private\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p0 First point.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p1 Second point.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p2 Third point.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @param {boolean=} opt_reflex Only include reflex points.\n * @return {Array.<module:ol/render/webgl/PolygonReplay~PolygonVertex>} Points in the triangle.\n */\nWebGLPolygonReplay.prototype.getPointsInTriangle_ = function(p0, p1, p2, rtree, opt_reflex) {\n  const result = [];\n  const segmentsInExtent = rtree.getInExtent([Math.min(p0.x, p1.x, p2.x),\n    Math.min(p0.y, p1.y, p2.y), Math.max(p0.x, p1.x, p2.x), Math.max(p0.y,\n      p1.y, p2.y)]);\n  for (let i = 0, ii = segmentsInExtent.length; i < ii; ++i) {\n    for (const j in segmentsInExtent[i]) {\n      const p = segmentsInExtent[i][j];\n      if (typeof p === 'object' && (!opt_reflex || p.reflex)) {\n        if ((p.x !== p0.x || p.y !== p0.y) && (p.x !== p1.x || p.y !== p1.y) &&\n            (p.x !== p2.x || p.y !== p2.y) && result.indexOf(p) === -1 &&\n            linearRingContainsXY([p0.x, p0.y, p1.x, p1.y, p2.x, p2.y], 0, 6, 2, p.x, p.y)) {\n          result.push(p);\n        }\n      }\n    }\n  }\n  return result;\n};\n\n\n/**\n * @private\n * @param {module:ol/render/webgl/PolygonReplay~PolygonSegment} segment Segment.\n * @param {module:ol/structs/RBush} rtree R-Tree of the polygon.\n * @param {boolean=} opt_touch Touching segments should be considered an intersection.\n * @return {Array.<module:ol/render/webgl/PolygonReplay~PolygonSegment>} Intersecting segments.\n */\nWebGLPolygonReplay.prototype.getIntersections_ = function(segment, rtree, opt_touch) {\n  const p0 = segment.p0;\n  const p1 = segment.p1;\n  const segmentsInExtent = rtree.getInExtent([Math.min(p0.x, p1.x),\n    Math.min(p0.y, p1.y), Math.max(p0.x, p1.x), Math.max(p0.y, p1.y)]);\n  const result = [];\n  for (let i = 0, ii = segmentsInExtent.length; i < ii; ++i) {\n    const currSeg = segmentsInExtent[i];\n    if (segment !== currSeg && (opt_touch || currSeg.p0 !== p1 || currSeg.p1 !== p0) &&\n        this.calculateIntersection_(p0, p1, currSeg.p0, currSeg.p1, opt_touch)) {\n      result.push(currSeg);\n    }\n  }\n  return result;\n};\n\n\n/**\n * Line intersection algorithm by Paul Bourke.\n * @see http://paulbourke.net/geometry/pointlineplane/\n *\n * @private\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p0 First point.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p1 Second point.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p2 Third point.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p3 Fourth point.\n * @param {boolean=} opt_touch Touching segments should be considered an intersection.\n * @return {Array.<number>|undefined} Intersection coordinates.\n */\nWebGLPolygonReplay.prototype.calculateIntersection_ = function(p0, p1, p2, p3, opt_touch) {\n  const denom = (p3.y - p2.y) * (p1.x - p0.x) - (p3.x - p2.x) * (p1.y - p0.y);\n  if (denom !== 0) {\n    const ua = ((p3.x - p2.x) * (p0.y - p2.y) - (p3.y - p2.y) * (p0.x - p2.x)) / denom;\n    const ub = ((p1.x - p0.x) * (p0.y - p2.y) - (p1.y - p0.y) * (p0.x - p2.x)) / denom;\n    if ((!opt_touch && ua > EPSILON && ua < 1 - EPSILON &&\n        ub > EPSILON && ub < 1 - EPSILON) || (opt_touch &&\n        ua >= 0 && ua <= 1 && ub >= 0 && ub <= 1)) {\n      return [p0.x + ua * (p1.x - p0.x), p0.y + ua * (p1.y - p0.y)];\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @private\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p0 Point before the start of the diagonal.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p1 Start point of the diagonal.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p2 Ear candidate.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p3 End point of the diagonal.\n * @param {module:ol/render/webgl/PolygonReplay~PolygonVertex} p4 Point after the end of the diagonal.\n * @return {boolean} Diagonal is inside the polygon.\n */\nWebGLPolygonReplay.prototype.diagonalIsInside_ = function(p0, p1, p2, p3, p4) {\n  if (p1.reflex === undefined || p3.reflex === undefined) {\n    return false;\n  }\n  const p1IsLeftOf = (p2.x - p3.x) * (p1.y - p3.y) > (p2.y - p3.y) * (p1.x - p3.x);\n  const p1IsRightOf = (p4.x - p3.x) * (p1.y - p3.y) < (p4.y - p3.y) * (p1.x - p3.x);\n  const p3IsLeftOf = (p0.x - p1.x) * (p3.y - p1.y) > (p0.y - p1.y) * (p3.x - p1.x);\n  const p3IsRightOf = (p2.x - p1.x) * (p3.y - p1.y) < (p2.y - p1.y) * (p3.x - p1.x);\n  const p1InCone = p3.reflex ? p1IsRightOf || p1IsLeftOf : p1IsRightOf && p1IsLeftOf;\n  const p3InCone = p1.reflex ? p3IsRightOf || p3IsLeftOf : p3IsRightOf && p3IsLeftOf;\n  return p1InCone && p3InCone;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.drawMultiPolygon = function(multiPolygonGeometry, feature) {\n  const endss = multiPolygonGeometry.getEndss();\n  const stride = multiPolygonGeometry.getStride();\n  const currIndex = this.indices.length;\n  const currLineIndex = this.lineStringReplay.getCurrentIndex();\n  const flatCoordinates = multiPolygonGeometry.getFlatCoordinates();\n  let i, ii, j, jj;\n  let start = 0;\n  for (i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    if (ends.length > 0) {\n      const outerRing = translate(flatCoordinates, start, ends[0],\n        stride, -this.origin[0], -this.origin[1]);\n      if (outerRing.length) {\n        const holes = [];\n        let holeFlatCoords;\n        for (j = 1, jj = ends.length; j < jj; ++j) {\n          if (ends[j] !== ends[j - 1]) {\n            holeFlatCoords = translate(flatCoordinates, ends[j - 1],\n              ends[j], stride, -this.origin[0], -this.origin[1]);\n            holes.push(holeFlatCoords);\n          }\n        }\n        this.lineStringReplay.drawPolygonCoordinates(outerRing, holes, stride);\n        this.drawCoordinates_(outerRing, holes, stride);\n      }\n    }\n    start = ends[ends.length - 1];\n  }\n  if (this.indices.length > currIndex) {\n    this.startIndices.push(currIndex);\n    this.startIndicesFeature.push(feature);\n    if (this.state_.changed) {\n      this.styleIndices_.push(currIndex);\n      this.state_.changed = false;\n    }\n  }\n  if (this.lineStringReplay.getCurrentIndex() > currLineIndex) {\n    this.lineStringReplay.setPolygonStyle(feature, currLineIndex);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.drawPolygon = function(polygonGeometry, feature) {\n  const ends = polygonGeometry.getEnds();\n  const stride = polygonGeometry.getStride();\n  if (ends.length > 0) {\n    const flatCoordinates = polygonGeometry.getFlatCoordinates().map(Number);\n    const outerRing = translate(flatCoordinates, 0, ends[0],\n      stride, -this.origin[0], -this.origin[1]);\n    if (outerRing.length) {\n      const holes = [];\n      let i, ii, holeFlatCoords;\n      for (i = 1, ii = ends.length; i < ii; ++i) {\n        if (ends[i] !== ends[i - 1]) {\n          holeFlatCoords = translate(flatCoordinates, ends[i - 1],\n            ends[i], stride, -this.origin[0], -this.origin[1]);\n          holes.push(holeFlatCoords);\n        }\n      }\n\n      this.startIndices.push(this.indices.length);\n      this.startIndicesFeature.push(feature);\n      if (this.state_.changed) {\n        this.styleIndices_.push(this.indices.length);\n        this.state_.changed = false;\n      }\n      this.lineStringReplay.setPolygonStyle(feature);\n\n      this.lineStringReplay.drawPolygonCoordinates(outerRing, holes, stride);\n      this.drawCoordinates_(outerRing, holes, stride);\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n **/\nWebGLPolygonReplay.prototype.finish = function(context) {\n  // create, bind, and populate the vertices buffer\n  this.verticesBuffer = new WebGLBuffer(this.vertices);\n\n  // create, bind, and populate the indices buffer\n  this.indicesBuffer = new WebGLBuffer(this.indices);\n\n  this.startIndices.push(this.indices.length);\n\n  this.lineStringReplay.finish(context);\n\n  //Clean up, if there is nothing to draw\n  if (this.styleIndices_.length === 0 && this.styles_.length > 0) {\n    this.styles_ = [];\n  }\n\n  this.vertices = null;\n  this.indices = null;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.getDeleteResourcesFunction = function(context) {\n  const verticesBuffer = this.verticesBuffer;\n  const indicesBuffer = this.indicesBuffer;\n  const lineDeleter = this.lineStringReplay.getDeleteResourcesFunction(context);\n  return function() {\n    context.deleteBuffer(verticesBuffer);\n    context.deleteBuffer(indicesBuffer);\n    lineDeleter();\n  };\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.setUpProgram = function(gl, context, size, pixelRatio) {\n  // get the program\n  const program = context.getProgram(fragment, vertex);\n\n  // get the locations\n  let locations;\n  if (!this.defaultLocations_) {\n    locations = new Locations(gl, program);\n    this.defaultLocations_ = locations;\n  } else {\n    locations = this.defaultLocations_;\n  }\n\n  context.useProgram(program);\n\n  // enable the vertex attrib arrays\n  gl.enableVertexAttribArray(locations.a_position);\n  gl.vertexAttribPointer(locations.a_position, 2, FLOAT,\n    false, 8, 0);\n\n  return locations;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.shutDownProgram = function(gl, locations) {\n  gl.disableVertexAttribArray(locations.a_position);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.drawReplay = function(gl, context, skippedFeaturesHash, hitDetection) {\n  //Save GL parameters.\n  const tmpDepthFunc = /** @type {number} */ (gl.getParameter(gl.DEPTH_FUNC));\n  const tmpDepthMask = /** @type {boolean} */ (gl.getParameter(gl.DEPTH_WRITEMASK));\n\n  if (!hitDetection) {\n    gl.enable(gl.DEPTH_TEST);\n    gl.depthMask(true);\n    gl.depthFunc(gl.NOTEQUAL);\n  }\n\n  if (!isEmpty(skippedFeaturesHash)) {\n    this.drawReplaySkipping_(gl, context, skippedFeaturesHash);\n  } else {\n    //Draw by style groups to minimize drawElements() calls.\n    let i, start, end, nextStyle;\n    end = this.startIndices[this.startIndices.length - 1];\n    for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n      start = this.styleIndices_[i];\n      nextStyle = this.styles_[i];\n      this.setFillStyle_(gl, nextStyle);\n      this.drawElements(gl, context, start, end);\n      end = start;\n    }\n  }\n  if (!hitDetection) {\n    gl.disable(gl.DEPTH_TEST);\n    gl.clear(gl.DEPTH_BUFFER_BIT);\n    //Restore GL parameters.\n    gl.depthMask(tmpDepthMask);\n    gl.depthFunc(tmpDepthFunc);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.drawHitDetectionReplayOneByOne = function(gl, context, skippedFeaturesHash,\n  featureCallback, opt_hitExtent) {\n  let i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex;\n  featureIndex = this.startIndices.length - 2;\n  end = this.startIndices[featureIndex + 1];\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setFillStyle_(gl, nextStyle);\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      start = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid] === undefined &&\n          feature.getGeometry() &&\n          (opt_hitExtent === undefined || intersects(\n            /** @type {Array<number>} */ (opt_hitExtent),\n            feature.getGeometry().getExtent()))) {\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n        this.drawElements(gl, context, start, end);\n\n        const result = featureCallback(feature);\n\n        if (result) {\n          return result;\n        }\n\n      }\n      featureIndex--;\n      end = start;\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {module:ol/webgl/Context} context Context.\n * @param {Object} skippedFeaturesHash Ids of features to skip.\n */\nWebGLPolygonReplay.prototype.drawReplaySkipping_ = function(gl, context, skippedFeaturesHash) {\n  let i, start, end, nextStyle, groupStart, feature, featureUid, featureIndex, featureStart;\n  featureIndex = this.startIndices.length - 2;\n  end = start = this.startIndices[featureIndex + 1];\n  for (i = this.styleIndices_.length - 1; i >= 0; --i) {\n    nextStyle = this.styles_[i];\n    this.setFillStyle_(gl, nextStyle);\n    groupStart = this.styleIndices_[i];\n\n    while (featureIndex >= 0 &&\n        this.startIndices[featureIndex] >= groupStart) {\n      featureStart = this.startIndices[featureIndex];\n      feature = this.startIndicesFeature[featureIndex];\n      featureUid = getUid(feature).toString();\n\n      if (skippedFeaturesHash[featureUid]) {\n        if (start !== end) {\n          this.drawElements(gl, context, start, end);\n          gl.clear(gl.DEPTH_BUFFER_BIT);\n        }\n        end = featureStart;\n      }\n      featureIndex--;\n      start = featureStart;\n    }\n    if (start !== end) {\n      this.drawElements(gl, context, start, end);\n      gl.clear(gl.DEPTH_BUFFER_BIT);\n    }\n    start = end = groupStart;\n  }\n};\n\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl gl.\n * @param {Array.<number>} color Color.\n */\nWebGLPolygonReplay.prototype.setFillStyle_ = function(gl, color) {\n  gl.uniform4fv(this.defaultLocations_.u_color, color);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLPolygonReplay.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {\n  let fillStyleColor = fillStyle ? fillStyle.getColor() : [0, 0, 0, 0];\n  if (!(fillStyleColor instanceof CanvasGradient) &&\n      !(fillStyleColor instanceof CanvasPattern)) {\n    fillStyleColor = asArray(fillStyleColor).map(function(c, i) {\n      return i != 3 ? c / 255 : c;\n    }) || DEFAULT_FILLSTYLE;\n  } else {\n    fillStyleColor = DEFAULT_FILLSTYLE;\n  }\n  if (!this.state_.fillColor || !equals(fillStyleColor, this.state_.fillColor)) {\n    this.state_.fillColor = fillStyleColor;\n    this.state_.changed = true;\n    this.styles_.push(fillStyleColor);\n  }\n  //Provide a null stroke style, if no strokeStyle is provided. Required for the draw interaction to work.\n  if (strokeStyle) {\n    this.lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n  } else {\n    const nullStrokeStyle = new Stroke({\n      color: [0, 0, 0, 0],\n      lineWidth: 0\n    });\n    this.lineStringReplay.setFillStrokeStyle(null, nullStrokeStyle);\n  }\n};\nexport default WebGLPolygonReplay;\n","/**\n * @module ol/style/Atlas\n */\nimport {createCanvasContext2D} from '../dom.js';\n\n\n/**\n * @typedef {Object} AtlasBlock\n * @property {number} x\n * @property {number} y\n * @property {number} width\n * @property {number} height\n */\n\n/**\n * Provides information for an image inside an atlas.\n * `offsetX` and `offsetY` are the position of the image inside the atlas image `image`.\n * @typedef {Object} AtlasInfo\n * @property {number} offsetX\n * @property {number} offsetY\n * @property {HTMLCanvasElement} image\n */\n\n/**\n * This class facilitates the creation of image atlases.\n *\n * Images added to an atlas will be rendered onto a single\n * atlas canvas. The distribution of images on the canvas is\n * managed with the bin packing algorithm described in:\n * http://www.blackpawn.com/texts/lightmaps/\n *\n * @constructor\n * @struct\n * @param {number} size The size in pixels of the sprite image.\n * @param {number} space The space in pixels between images.\n *    Because texture coordinates are float values, the edges of\n *    images might not be completely correct (in a way that the\n *    edges overlap when being rendered). To avoid this we add a\n *    padding around each image.\n */\nconst Atlas = function(size, space) {\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.space_ = space;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/style/Atlas~AtlasBlock>}\n   */\n  this.emptyBlocks_ = [{x: 0, y: 0, width: size, height: size}];\n\n  /**\n   * @private\n   * @type {Object.<string, module:ol/style/Atlas~AtlasInfo>}\n   */\n  this.entries_ = {};\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.context_ = createCanvasContext2D(size, size);\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = this.context_.canvas;\n};\n\n\n/**\n * @param {string} id The identifier of the entry to check.\n * @return {?module:ol/style/Atlas~AtlasInfo} The atlas info.\n */\nAtlas.prototype.get = function(id) {\n  return this.entries_[id] || null;\n};\n\n\n/**\n * @param {string} id The identifier of the entry to add.\n * @param {number} width The width.\n * @param {number} height The height.\n * @param {function(CanvasRenderingContext2D, number, number)} renderCallback\n *    Called to render the new image onto an atlas image.\n * @param {Object=} opt_this Value to use as `this` when executing\n *    `renderCallback`.\n * @return {?module:ol/style/Atlas~AtlasInfo} The position and atlas image for the entry.\n */\nAtlas.prototype.add = function(id, width, height, renderCallback, opt_this) {\n  for (let i = 0, ii = this.emptyBlocks_.length; i < ii; ++i) {\n    const block = this.emptyBlocks_[i];\n    if (block.width >= width + this.space_ &&\n        block.height >= height + this.space_) {\n      // we found a block that is big enough for our entry\n      const entry = {\n        offsetX: block.x + this.space_,\n        offsetY: block.y + this.space_,\n        image: this.canvas_\n      };\n      this.entries_[id] = entry;\n\n      // render the image on the atlas image\n      renderCallback.call(opt_this, this.context_,\n        block.x + this.space_, block.y + this.space_);\n\n      // split the block after the insertion, either horizontally or vertically\n      this.split_(i, block, width + this.space_, height + this.space_);\n\n      return entry;\n    }\n  }\n\n  // there is no space for the new entry in this atlas\n  return null;\n};\n\n\n/**\n * @private\n * @param {number} index The index of the block.\n * @param {module:ol/style/Atlas~AtlasBlock} block The block to split.\n * @param {number} width The width of the entry to insert.\n * @param {number} height The height of the entry to insert.\n */\nAtlas.prototype.split_ = function(index, block, width, height) {\n  const deltaWidth = block.width - width;\n  const deltaHeight = block.height - height;\n\n  /** @type {module:ol/style/Atlas~AtlasBlock} */\n  let newBlock1;\n  /** @type {module:ol/style/Atlas~AtlasBlock} */\n  let newBlock2;\n\n  if (deltaWidth > deltaHeight) {\n    // split vertically\n    // block right of the inserted entry\n    newBlock1 = {\n      x: block.x + width,\n      y: block.y,\n      width: block.width - width,\n      height: block.height\n    };\n\n    // block below the inserted entry\n    newBlock2 = {\n      x: block.x,\n      y: block.y + height,\n      width: width,\n      height: block.height - height\n    };\n    this.updateBlocks_(index, newBlock1, newBlock2);\n  } else {\n    // split horizontally\n    // block right of the inserted entry\n    newBlock1 = {\n      x: block.x + width,\n      y: block.y,\n      width: block.width - width,\n      height: height\n    };\n\n    // block below the inserted entry\n    newBlock2 = {\n      x: block.x,\n      y: block.y + height,\n      width: block.width,\n      height: block.height - height\n    };\n    this.updateBlocks_(index, newBlock1, newBlock2);\n  }\n};\n\n\n/**\n * Remove the old block and insert new blocks at the same array position.\n * The new blocks are inserted at the same position, so that splitted\n * blocks (that are potentially smaller) are filled first.\n * @private\n * @param {number} index The index of the block to remove.\n * @param {module:ol/style/Atlas~AtlasBlock} newBlock1 The 1st block to add.\n * @param {module:ol/style/Atlas~AtlasBlock} newBlock2 The 2nd block to add.\n */\nAtlas.prototype.updateBlocks_ = function(index, newBlock1, newBlock2) {\n  const args = [index, 1];\n  if (newBlock1.width > 0 && newBlock1.height > 0) {\n    args.push(newBlock1);\n  }\n  if (newBlock2.width > 0 && newBlock2.height > 0) {\n    args.push(newBlock2);\n  }\n  this.emptyBlocks_.splice.apply(this.emptyBlocks_, args);\n};\nexport default Atlas;\n","/**\n * @module ol/style/AtlasManager\n */\nimport {MAX_TEXTURE_SIZE as WEBGL_MAX_TEXTURE_SIZE} from '../webgl.js';\nimport {UNDEFINED} from '../functions.js';\nimport Atlas from '../style/Atlas.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [initialSize=256] The size in pixels of the first atlas image.\n * @property {number} [maxSize] The maximum size in pixels of atlas images. Default is\n * `webgl/MAX_TEXTURE_SIZE` or 2048 if WebGL is not supported.\n * @property {number} [space=1] The space in pixels between images.\n */\n\n\n/**\n * Provides information for an image inside an atlas manager.\n * `offsetX` and `offsetY` is the position of the image inside\n * the atlas image `image` and the position of the hit-detection image\n * inside the hit-detection atlas image `hitImage`.\n * @typedef {Object} AtlasManagerInfo\n * @property {number} offsetX\n * @property {number} offsetY\n * @property {HTMLCanvasElement} image\n * @property {HTMLCanvasElement} hitImage\n */\n\n\n/**\n * The size in pixels of the first atlas image.\n * @type {number}\n */\nconst INITIAL_ATLAS_SIZE = 256;\n\n/**\n * The maximum size in pixels of atlas images.\n * @type {number}\n */\nconst MAX_ATLAS_SIZE = -1;\n\n\n/**\n * Manages the creation of image atlases.\n *\n * Images added to this manager will be inserted into an atlas, which\n * will be used for rendering.\n * The `size` given in the constructor is the size for the first\n * atlas. After that, when new atlases are created, they will have\n * twice the size as the latest atlas (until `maxSize` is reached).\n *\n * If an application uses many images or very large images, it is recommended\n * to set a higher `size` value to avoid the creation of too many atlases.\n *\n * @constructor\n * @struct\n * @api\n * @param {module:ol/style/AtlasManager~Options=} opt_options Options.\n */\nconst AtlasManager = function(opt_options) {\n\n  const options = opt_options || {};\n\n  /**\n   * The size in pixels of the latest atlas image.\n   * @private\n   * @type {number}\n   */\n  this.currentSize_ = options.initialSize !== undefined ?\n    options.initialSize : INITIAL_ATLAS_SIZE;\n\n  /**\n   * The maximum size in pixels of atlas images.\n   * @private\n   * @type {number}\n   */\n  this.maxSize_ = options.maxSize !== undefined ?\n    options.maxSize : MAX_ATLAS_SIZE != -1 ?\n      MAX_ATLAS_SIZE : WEBGL_MAX_TEXTURE_SIZE !== undefined ?\n        WEBGL_MAX_TEXTURE_SIZE : 2048;\n\n  /**\n   * The size in pixels between images.\n   * @private\n   * @type {number}\n   */\n  this.space_ = options.space !== undefined ? options.space : 1;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/style/Atlas>}\n   */\n  this.atlases_ = [new Atlas(this.currentSize_, this.space_)];\n\n  /**\n   * The size in pixels of the latest atlas image for hit-detection images.\n   * @private\n   * @type {number}\n   */\n  this.currentHitSize_ = this.currentSize_;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/style/Atlas>}\n   */\n  this.hitAtlases_ = [new Atlas(this.currentHitSize_, this.space_)];\n};\n\n\n/**\n * @param {string} id The identifier of the entry to check.\n * @return {?module:ol/style/AtlasManager~AtlasManagerInfo} The position and atlas image for the\n *    entry, or `null` if the entry is not part of the atlas manager.\n */\nAtlasManager.prototype.getInfo = function(id) {\n  /** @type {?module:ol/style/Atlas~AtlasInfo} */\n  const info = this.getInfo_(this.atlases_, id);\n\n  if (!info) {\n    return null;\n  }\n  const hitInfo = /** @type {module:ol/style/Atlas~AtlasInfo} */ (this.getInfo_(this.hitAtlases_, id));\n\n  return this.mergeInfos_(info, hitInfo);\n};\n\n\n/**\n * @private\n * @param {Array.<module:ol/style/Atlas>} atlases The atlases to search.\n * @param {string} id The identifier of the entry to check.\n * @return {?module:ol/style/Atlas~AtlasInfo} The position and atlas image for the entry,\n *    or `null` if the entry is not part of the atlases.\n */\nAtlasManager.prototype.getInfo_ = function(atlases, id) {\n  for (let i = 0, ii = atlases.length; i < ii; ++i) {\n    const atlas = atlases[i];\n    const info = atlas.get(id);\n    if (info) {\n      return info;\n    }\n  }\n  return null;\n};\n\n\n/**\n * @private\n * @param {module:ol/style/Atlas~AtlasInfo} info The info for the real image.\n * @param {module:ol/style/Atlas~AtlasInfo} hitInfo The info for the hit-detection\n *    image.\n * @return {?module:ol/style/AtlasManager~AtlasManagerInfo} The position and atlas image for the\n *    entry, or `null` if the entry is not part of the atlases.\n */\nAtlasManager.prototype.mergeInfos_ = function(info, hitInfo) {\n  return (\n    /** @type {module:ol/style/AtlasManager~AtlasManagerInfo} */ ({\n      offsetX: info.offsetX,\n      offsetY: info.offsetY,\n      image: info.image,\n      hitImage: hitInfo.image\n    })\n  );\n};\n\n\n/**\n * Add an image to the atlas manager.\n *\n * If an entry for the given id already exists, the entry will\n * be overridden (but the space on the atlas graphic will not be freed).\n *\n * If `renderHitCallback` is provided, the image (or the hit-detection version\n * of the image) will be rendered into a separate hit-detection atlas image.\n *\n * @param {string} id The identifier of the entry to add.\n * @param {number} width The width.\n * @param {number} height The height.\n * @param {function(CanvasRenderingContext2D, number, number)} renderCallback\n *    Called to render the new image onto an atlas image.\n * @param {function(CanvasRenderingContext2D, number, number)=}\n *    opt_renderHitCallback Called to render a hit-detection image onto a hit\n *    detection atlas image.\n * @param {Object=} opt_this Value to use as `this` when executing\n *    `renderCallback` and `renderHitCallback`.\n * @return {?module:ol/style/AtlasManager~AtlasManagerInfo}  The position and atlas image for the\n *    entry, or `null` if the image is too big.\n */\nAtlasManager.prototype.add = function(id, width, height,\n  renderCallback, opt_renderHitCallback, opt_this) {\n  if (width + this.space_ > this.maxSize_ ||\n      height + this.space_ > this.maxSize_) {\n    return null;\n  }\n\n  /** @type {?module:ol/style/Atlas~AtlasInfo} */\n  const info = this.add_(false, id, width, height, renderCallback, opt_this);\n  if (!info) {\n    return null;\n  }\n\n  // even if no hit-detection entry is requested, we insert a fake entry into\n  // the hit-detection atlas, to make sure that the offset is the same for\n  // the original image and the hit-detection image.\n  const renderHitCallback = opt_renderHitCallback !== undefined ?\n    opt_renderHitCallback : UNDEFINED;\n\n  const hitInfo = /** @type {module:ol/style/Atlas~AtlasInfo} */ (this.add_(true,\n    id, width, height, renderHitCallback, opt_this));\n\n  return this.mergeInfos_(info, hitInfo);\n};\n\n\n/**\n * @private\n * @param {boolean} isHitAtlas If the hit-detection atlases are used.\n * @param {string} id The identifier of the entry to add.\n * @param {number} width The width.\n * @param {number} height The height.\n * @param {function(CanvasRenderingContext2D, number, number)} renderCallback\n *    Called to render the new image onto an atlas image.\n * @param {Object=} opt_this Value to use as `this` when executing\n *    `renderCallback` and `renderHitCallback`.\n * @return {?module:ol/style/Atlas~AtlasInfo}  The position and atlas image for the entry,\n *    or `null` if the image is too big.\n */\nAtlasManager.prototype.add_ = function(isHitAtlas, id, width, height, renderCallback, opt_this) {\n  const atlases = (isHitAtlas) ? this.hitAtlases_ : this.atlases_;\n  let atlas, info, i, ii;\n  for (i = 0, ii = atlases.length; i < ii; ++i) {\n    atlas = atlases[i];\n    info = atlas.add(id, width, height, renderCallback, opt_this);\n    if (info) {\n      return info;\n    } else if (!info && i === ii - 1) {\n      // the entry could not be added to one of the existing atlases,\n      // create a new atlas that is twice as big and try to add to this one.\n      let size;\n      if (isHitAtlas) {\n        size = Math.min(this.currentHitSize_ * 2, this.maxSize_);\n        this.currentHitSize_ = size;\n      } else {\n        size = Math.min(this.currentSize_ * 2, this.maxSize_);\n        this.currentSize_ = size;\n      }\n      atlas = new Atlas(size, this.space_);\n      atlases.push(atlas);\n      // run the loop another time\n      ++ii;\n    }\n  }\n  return null;\n};\nexport default AtlasManager;\n","/**\n * @module ol/render/webgl/TextReplay\n */\nimport {getUid, inherits} from '../../util.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {CANVAS_LINE_DASH} from '../../has.js';\nimport {TEXT_ALIGN} from '../replay.js';\nimport {DEFAULT_FILLSTYLE, DEFAULT_FONT, DEFAULT_LINECAP, DEFAULT_LINEDASH,\n  DEFAULT_LINEDASHOFFSET, DEFAULT_LINEJOIN, DEFAULT_LINEWIDTH, DEFAULT_MITERLIMIT,\n  DEFAULT_STROKESTYLE, DEFAULT_TEXTALIGN, DEFAULT_TEXTBASELINE} from '../webgl.js';\nimport WebGLTextureReplay from '../webgl/TextureReplay.js';\nimport AtlasManager from '../../style/AtlasManager.js';\nimport WebGLBuffer from '../../webgl/Buffer.js';\n\n/**\n * @typedef {Object} GlyphAtlas\n * @property {module:ol/style/AtlasManager} atlas\n * @property {Object.<string, number>} width\n * @property {number} height\n */\n\n\n/**\n * @constructor\n * @extends {module:ol/render/webgl/TextureReplay}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @struct\n */\nconst WebGLTextReplay = function(tolerance, maxExtent) {\n  WebGLTextureReplay.call(this, tolerance, maxExtent);\n\n  /**\n   * @private\n   * @type {Array.<HTMLCanvasElement>}\n   */\n  this.images_ = [];\n\n  /**\n   * @private\n   * @type {Array.<WebGLTexture>}\n   */\n  this.textures_ = [];\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.measureCanvas_ = createCanvasContext2D(0, 0).canvas;\n\n  /**\n   * @private\n   * @type {{strokeColor: (module:ol/colorlike~ColorLike|null),\n   *         lineCap: (string|undefined),\n   *         lineDash: Array.<number>,\n   *         lineDashOffset: (number|undefined),\n   *         lineJoin: (string|undefined),\n   *         lineWidth: number,\n   *         miterLimit: (number|undefined),\n   *         fillColor: (module:ol/colorlike~ColorLike|null),\n   *         font: (string|undefined),\n   *         scale: (number|undefined)}}\n   */\n  this.state_ = {\n    strokeColor: null,\n    lineCap: undefined,\n    lineDash: null,\n    lineDashOffset: undefined,\n    lineJoin: undefined,\n    lineWidth: 0,\n    miterLimit: undefined,\n    fillColor: null,\n    font: undefined,\n    scale: undefined\n  };\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.text_ = '';\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.textAlign_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.textBaseline_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.offsetX_ = undefined;\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.offsetY_ = undefined;\n\n  /**\n   * @private\n   * @type {Object.<string, module:ol/render/webgl/TextReplay~GlyphAtlas>}\n   */\n  this.atlases_ = {};\n\n  /**\n   * @private\n   * @type {module:ol/render/webgl/TextReplay~GlyphAtlas|undefined}\n   */\n  this.currAtlas_ = undefined;\n\n  this.scale = 1;\n\n  this.opacity = 1;\n\n};\n\ninherits(WebGLTextReplay, WebGLTextureReplay);\n\n\n/**\n * @inheritDoc\n */\nWebGLTextReplay.prototype.drawText = function(geometry, feature) {\n  if (this.text_) {\n    let flatCoordinates = null;\n    const offset = 0;\n    let end = 2;\n    let stride = 2;\n    switch (geometry.getType()) {\n      case GeometryType.POINT:\n      case GeometryType.MULTI_POINT:\n        flatCoordinates = geometry.getFlatCoordinates();\n        end = flatCoordinates.length;\n        stride = geometry.getStride();\n        break;\n      case GeometryType.CIRCLE:\n        flatCoordinates = /** @type {module:ol/geom/Circle} */ (geometry).getCenter();\n        break;\n      case GeometryType.LINE_STRING:\n        flatCoordinates = /** @type {module:ol/geom/LineString} */ (geometry).getFlatMidpoint();\n        break;\n      case GeometryType.MULTI_LINE_STRING:\n        flatCoordinates = /** @type {module:ol/geom/MultiLineString} */ (geometry).getFlatMidpoints();\n        end = flatCoordinates.length;\n        break;\n      case GeometryType.POLYGON:\n        flatCoordinates = /** @type {module:ol/geom/Polygon} */ (geometry).getFlatInteriorPoint();\n        break;\n      case GeometryType.MULTI_POLYGON:\n        flatCoordinates = /** @type {module:ol/geom/MultiPolygon} */ (geometry).getFlatInteriorPoints();\n        end = flatCoordinates.length;\n        break;\n      default:\n    }\n    this.startIndices.push(this.indices.length);\n    this.startIndicesFeature.push(feature);\n\n    const glyphAtlas = this.currAtlas_;\n    const lines = this.text_.split('\\n');\n    const textSize = this.getTextSize_(lines);\n    let i, ii, j, jj, currX, currY, charArr, charInfo;\n    const anchorX = Math.round(textSize[0] * this.textAlign_ - this.offsetX_);\n    const anchorY = Math.round(textSize[1] * this.textBaseline_ - this.offsetY_);\n    const lineWidth = (this.state_.lineWidth / 2) * this.state_.scale;\n\n    for (i = 0, ii = lines.length; i < ii; ++i) {\n      currX = 0;\n      currY = glyphAtlas.height * i;\n      charArr = lines[i].split('');\n\n      for (j = 0, jj = charArr.length; j < jj; ++j) {\n        charInfo = glyphAtlas.atlas.getInfo(charArr[j]);\n\n        if (charInfo) {\n          const image = charInfo.image;\n\n          this.anchorX = anchorX - currX;\n          this.anchorY = anchorY - currY;\n          this.originX = j === 0 ? charInfo.offsetX - lineWidth : charInfo.offsetX;\n          this.originY = charInfo.offsetY;\n          this.height = glyphAtlas.height;\n          this.width = j === 0 || j === charArr.length - 1 ?\n            glyphAtlas.width[charArr[j]] + lineWidth : glyphAtlas.width[charArr[j]];\n          this.imageHeight = image.height;\n          this.imageWidth = image.width;\n\n          if (this.images_.length === 0) {\n            this.images_.push(image);\n          } else {\n            const currentImage = this.images_[this.images_.length - 1];\n            if (getUid(currentImage) != getUid(image)) {\n              this.groupIndices.push(this.indices.length);\n              this.images_.push(image);\n            }\n          }\n\n          this.drawText_(flatCoordinates, offset, end, stride);\n        }\n        currX += this.width;\n      }\n    }\n  }\n};\n\n\n/**\n * @private\n * @param {Array.<string>} lines Label to draw split to lines.\n * @return {Array.<number>} Size of the label in pixels.\n */\nWebGLTextReplay.prototype.getTextSize_ = function(lines) {\n  const self = this;\n  const glyphAtlas = this.currAtlas_;\n  const textHeight = lines.length * glyphAtlas.height;\n  //Split every line to an array of chars, sum up their width, and select the longest.\n  const textWidth = lines.map(function(str) {\n    let sum = 0;\n    for (let i = 0, ii = str.length; i < ii; ++i) {\n      const curr = str[i];\n      if (!glyphAtlas.width[curr]) {\n        self.addCharToAtlas_(curr);\n      }\n      sum += glyphAtlas.width[curr] ? glyphAtlas.width[curr] : 0;\n    }\n    return sum;\n  }).reduce(function(max, curr) {\n    return Math.max(max, curr);\n  });\n\n  return [textWidth, textHeight];\n};\n\n\n/**\n * @private\n * @param {Array.<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n */\nWebGLTextReplay.prototype.drawText_ = function(flatCoordinates, offset, end, stride) {\n  for (let i = offset, ii = end; i < ii; i += stride) {\n    this.drawCoordinates(flatCoordinates, offset, end, stride);\n  }\n};\n\n\n/**\n * @private\n * @param {string} char Character.\n */\nWebGLTextReplay.prototype.addCharToAtlas_ = function(char) {\n  if (char.length === 1) {\n    const glyphAtlas = this.currAtlas_;\n    const state = this.state_;\n    const mCtx = this.measureCanvas_.getContext('2d');\n    mCtx.font = state.font;\n    const width = Math.ceil(mCtx.measureText(char).width * state.scale);\n\n    const info = glyphAtlas.atlas.add(char, width, glyphAtlas.height,\n      function(ctx, x, y) {\n        //Parameterize the canvas\n        ctx.font = /** @type {string} */ (state.font);\n        ctx.fillStyle = state.fillColor;\n        ctx.strokeStyle = state.strokeColor;\n        ctx.lineWidth = state.lineWidth;\n        ctx.lineCap = /*** @type {string} */ (state.lineCap);\n        ctx.lineJoin = /** @type {string} */ (state.lineJoin);\n        ctx.miterLimit = /** @type {number} */ (state.miterLimit);\n        ctx.textAlign = 'left';\n        ctx.textBaseline = 'top';\n        if (CANVAS_LINE_DASH && state.lineDash) {\n          //FIXME: use pixelRatio\n          ctx.setLineDash(state.lineDash);\n          ctx.lineDashOffset = /** @type {number} */ (state.lineDashOffset);\n        }\n        if (state.scale !== 1) {\n          //FIXME: use pixelRatio\n          ctx.setTransform(/** @type {number} */ (state.scale), 0, 0,\n            /** @type {number} */ (state.scale), 0, 0);\n        }\n\n        //Draw the character on the canvas\n        if (state.strokeColor) {\n          ctx.strokeText(char, x, y);\n        }\n        if (state.fillColor) {\n          ctx.fillText(char, x, y);\n        }\n      });\n\n    if (info) {\n      glyphAtlas.width[char] = width;\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextReplay.prototype.finish = function(context) {\n  const gl = context.getGL();\n\n  this.groupIndices.push(this.indices.length);\n  this.hitDetectionGroupIndices = this.groupIndices;\n\n  // create, bind, and populate the vertices buffer\n  this.verticesBuffer = new WebGLBuffer(this.vertices);\n\n  // create, bind, and populate the indices buffer\n  this.indicesBuffer = new WebGLBuffer(this.indices);\n\n  // create textures\n  /** @type {Object.<string, WebGLTexture>} */\n  const texturePerImage = {};\n\n  this.createTextures(this.textures_, this.images_, texturePerImage, gl);\n\n  this.state_ = {\n    strokeColor: null,\n    lineCap: undefined,\n    lineDash: null,\n    lineDashOffset: undefined,\n    lineJoin: undefined,\n    lineWidth: 0,\n    miterLimit: undefined,\n    fillColor: null,\n    font: undefined,\n    scale: undefined\n  };\n  this.text_ = '';\n  this.textAlign_ = undefined;\n  this.textBaseline_ = undefined;\n  this.offsetX_ = undefined;\n  this.offsetY_ = undefined;\n  this.images_ = null;\n  this.atlases_ = {};\n  this.currAtlas_ = undefined;\n  WebGLTextureReplay.prototype.finish.call(this, context);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextReplay.prototype.setTextStyle = function(textStyle) {\n  const state = this.state_;\n  const textFillStyle = textStyle.getFill();\n  const textStrokeStyle = textStyle.getStroke();\n  if (!textStyle || !textStyle.getText() || (!textFillStyle && !textStrokeStyle)) {\n    this.text_ = '';\n  } else {\n    if (!textFillStyle) {\n      state.fillColor = null;\n    } else {\n      const textFillStyleColor = textFillStyle.getColor();\n      state.fillColor = asColorLike(textFillStyleColor ?\n        textFillStyleColor : DEFAULT_FILLSTYLE);\n    }\n    if (!textStrokeStyle) {\n      state.strokeColor = null;\n      state.lineWidth = 0;\n    } else {\n      const textStrokeStyleColor = textStrokeStyle.getColor();\n      state.strokeColor = asColorLike(textStrokeStyleColor ?\n        textStrokeStyleColor : DEFAULT_STROKESTYLE);\n      state.lineWidth = textStrokeStyle.getWidth() || DEFAULT_LINEWIDTH;\n      state.lineCap = textStrokeStyle.getLineCap() || DEFAULT_LINECAP;\n      state.lineDashOffset = textStrokeStyle.getLineDashOffset() || DEFAULT_LINEDASHOFFSET;\n      state.lineJoin = textStrokeStyle.getLineJoin() || DEFAULT_LINEJOIN;\n      state.miterLimit = textStrokeStyle.getMiterLimit() || DEFAULT_MITERLIMIT;\n      const lineDash = textStrokeStyle.getLineDash();\n      state.lineDash = lineDash ? lineDash.slice() : DEFAULT_LINEDASH;\n    }\n    state.font = textStyle.getFont() || DEFAULT_FONT;\n    state.scale = textStyle.getScale() || 1;\n    this.text_ = /** @type {string} */ (textStyle.getText());\n    const textAlign = TEXT_ALIGN[textStyle.getTextAlign()];\n    const textBaseline = TEXT_ALIGN[textStyle.getTextBaseline()];\n    this.textAlign_ = textAlign === undefined ?\n      DEFAULT_TEXTALIGN : textAlign;\n    this.textBaseline_ = textBaseline === undefined ?\n      DEFAULT_TEXTBASELINE : textBaseline;\n    this.offsetX_ = textStyle.getOffsetX() || 0;\n    this.offsetY_ = textStyle.getOffsetY() || 0;\n    this.rotateWithView = !!textStyle.getRotateWithView();\n    this.rotation = textStyle.getRotation() || 0;\n\n    this.currAtlas_ = this.getAtlas_(state);\n  }\n};\n\n\n/**\n * @private\n * @param {Object} state Font attributes.\n * @return {module:ol/render/webgl/TextReplay~GlyphAtlas} Glyph atlas.\n */\nWebGLTextReplay.prototype.getAtlas_ = function(state) {\n  let params = [];\n  for (const i in state) {\n    if (state[i] || state[i] === 0) {\n      if (Array.isArray(state[i])) {\n        params = params.concat(state[i]);\n      } else {\n        params.push(state[i]);\n      }\n    }\n  }\n  const hash = this.calculateHash_(params);\n  if (!this.atlases_[hash]) {\n    const mCtx = this.measureCanvas_.getContext('2d');\n    mCtx.font = state.font;\n    const height = Math.ceil((mCtx.measureText('M').width * 1.5 +\n        state.lineWidth / 2) * state.scale);\n\n    this.atlases_[hash] = {\n      atlas: new AtlasManager({\n        space: state.lineWidth + 1\n      }),\n      width: {},\n      height: height\n    };\n  }\n  return this.atlases_[hash];\n};\n\n\n/**\n * @private\n * @param {Array.<string|number>} params Array of parameters.\n * @return {string} Hash string.\n */\nWebGLTextReplay.prototype.calculateHash_ = function(params) {\n  //TODO: Create a more performant, reliable, general hash function.\n  let hash = '';\n  for (let i = 0, ii = params.length; i < ii; ++i) {\n    hash += params[i];\n  }\n  return hash;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextReplay.prototype.getTextures = function(opt_all) {\n  return this.textures_;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTextReplay.prototype.getHitDetectionTextures = function() {\n  return this.textures_;\n};\nexport default WebGLTextReplay;\n","/**\n * @module ol/render/webgl/ReplayGroup\n */\nimport {inherits} from '../../util.js';\nimport {numberSafeCompareFunction} from '../../array.js';\nimport {buffer, createOrUpdateFromCoordinate} from '../../extent.js';\nimport {isEmpty} from '../../obj.js';\nimport {ORDER} from '../replay.js';\nimport ReplayGroup from '../ReplayGroup.js';\nimport WebGLCircleReplay from '../webgl/CircleReplay.js';\nimport WebGLImageReplay from '../webgl/ImageReplay.js';\nimport WebGLLineStringReplay from '../webgl/LineStringReplay.js';\nimport WebGLPolygonReplay from '../webgl/PolygonReplay.js';\nimport WebGLTextReplay from '../webgl/TextReplay.js';\n\n/**\n * @type {Array.<number>}\n */\nconst HIT_DETECTION_SIZE = [1, 1];\n\n/**\n * @type {Object.<module:ol/render/ReplayType,\n *                function(new: module:ol/render/webgl/Replay, number,\n *                module:ol/extent~Extent)>}\n */\nconst BATCH_CONSTRUCTORS = {\n  'Circle': WebGLCircleReplay,\n  'Image': WebGLImageReplay,\n  'LineString': WebGLLineStringReplay,\n  'Polygon': WebGLPolygonReplay,\n  'Text': WebGLTextReplay\n};\n\n\n/**\n * @constructor\n * @extends {module:ol/render/ReplayGroup}\n * @param {number} tolerance Tolerance.\n * @param {module:ol/extent~Extent} maxExtent Max extent.\n * @param {number=} opt_renderBuffer Render buffer.\n * @struct\n */\nconst WebGLReplayGroup = function(tolerance, maxExtent, opt_renderBuffer) {\n  ReplayGroup.call(this);\n\n  /**\n   * @type {module:ol/extent~Extent}\n   * @private\n   */\n  this.maxExtent_ = maxExtent;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.tolerance_ = tolerance;\n\n  /**\n   * @type {number|undefined}\n   * @private\n   */\n  this.renderBuffer_ = opt_renderBuffer;\n\n  /**\n   * @private\n   * @type {!Object.<string,\n   *        Object.<module:ol/render/ReplayType, module:ol/render/webgl/Replay>>}\n   */\n  this.replaysByZIndex_ = {};\n\n};\n\ninherits(WebGLReplayGroup, ReplayGroup);\n\n\n/**\n * @param {module:ol/style/Style} style Style.\n * @param {boolean} group Group with previous replay.\n */\nWebGLReplayGroup.prototype.addDeclutter = function(style, group) {};\n\n\n/**\n * @param {module:ol/webgl/Context} context WebGL context.\n * @return {function()} Delete resources function.\n */\nWebGLReplayGroup.prototype.getDeleteResourcesFunction = function(context) {\n  const functions = [];\n  let zKey;\n  for (zKey in this.replaysByZIndex_) {\n    const replays = this.replaysByZIndex_[zKey];\n    for (const replayKey in replays) {\n      functions.push(\n        replays[replayKey].getDeleteResourcesFunction(context));\n    }\n  }\n  return function() {\n    const length = functions.length;\n    let result;\n    for (let i = 0; i < length; i++) {\n      result = functions[i].apply(this, arguments);\n    }\n    return result;\n  };\n};\n\n\n/**\n * @param {module:ol/webgl/Context} context Context.\n */\nWebGLReplayGroup.prototype.finish = function(context) {\n  let zKey;\n  for (zKey in this.replaysByZIndex_) {\n    const replays = this.replaysByZIndex_[zKey];\n    for (const replayKey in replays) {\n      replays[replayKey].finish(context);\n    }\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLReplayGroup.prototype.getReplay = function(zIndex, replayType) {\n  const zIndexKey = zIndex !== undefined ? zIndex.toString() : '0';\n  let replays = this.replaysByZIndex_[zIndexKey];\n  if (replays === undefined) {\n    replays = {};\n    this.replaysByZIndex_[zIndexKey] = replays;\n  }\n  let replay = replays[replayType];\n  if (replay === undefined) {\n    /**\n     * @type {Function}\n     */\n    const Constructor = BATCH_CONSTRUCTORS[replayType];\n    replay = new Constructor(this.tolerance_, this.maxExtent_);\n    replays[replayType] = replay;\n  }\n  return replay;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLReplayGroup.prototype.isEmpty = function() {\n  return isEmpty(this.replaysByZIndex_);\n};\n\n\n/**\n * @param {module:ol/webgl/Context} context Context.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {module:ol/size~Size} size Size.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} opacity Global opacity.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n */\nWebGLReplayGroup.prototype.replay = function(context,\n  center, resolution, rotation, size, pixelRatio,\n  opacity, skippedFeaturesHash) {\n  /** @type {Array.<number>} */\n  const zs = Object.keys(this.replaysByZIndex_).map(Number);\n  zs.sort(numberSafeCompareFunction);\n\n  let i, ii, j, jj, replays, replay;\n  for (i = 0, ii = zs.length; i < ii; ++i) {\n    replays = this.replaysByZIndex_[zs[i].toString()];\n    for (j = 0, jj = ORDER.length; j < jj; ++j) {\n      replay = replays[ORDER[j]];\n      if (replay !== undefined) {\n        replay.replay(context,\n          center, resolution, rotation, size, pixelRatio,\n          opacity, skippedFeaturesHash,\n          undefined, false);\n      }\n    }\n  }\n};\n\n\n/**\n * @private\n * @param {module:ol/webgl/Context} context Context.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {module:ol/size~Size} size Size.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} opacity Global opacity.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined} featureCallback Feature callback.\n * @param {boolean} oneByOne Draw features one-by-one for the hit-detecion.\n * @param {module:ol/extent~Extent=} opt_hitExtent Hit extent: Only features intersecting\n *  this extent are checked.\n * @return {T|undefined} Callback result.\n * @template T\n */\nWebGLReplayGroup.prototype.replayHitDetection_ = function(context,\n  center, resolution, rotation, size, pixelRatio, opacity,\n  skippedFeaturesHash, featureCallback, oneByOne, opt_hitExtent) {\n  /** @type {Array.<number>} */\n  const zs = Object.keys(this.replaysByZIndex_).map(Number);\n  zs.sort(function(a, b) {\n    return b - a;\n  });\n\n  let i, ii, j, replays, replay, result;\n  for (i = 0, ii = zs.length; i < ii; ++i) {\n    replays = this.replaysByZIndex_[zs[i].toString()];\n    for (j = ORDER.length - 1; j >= 0; --j) {\n      replay = replays[ORDER[j]];\n      if (replay !== undefined) {\n        result = replay.replay(context,\n          center, resolution, rotation, size, pixelRatio, opacity,\n          skippedFeaturesHash, featureCallback, oneByOne, opt_hitExtent);\n        if (result) {\n          return result;\n        }\n      }\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/webgl/Context} context Context.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {module:ol/size~Size} size Size.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} opacity Global opacity.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined} callback Feature callback.\n * @return {T|undefined} Callback result.\n * @template T\n */\nWebGLReplayGroup.prototype.forEachFeatureAtCoordinate = function(\n  coordinate, context, center, resolution, rotation, size, pixelRatio,\n  opacity, skippedFeaturesHash,\n  callback) {\n  const gl = context.getGL();\n  gl.bindFramebuffer(\n    gl.FRAMEBUFFER, context.getHitDetectionFramebuffer());\n\n\n  /**\n   * @type {module:ol/extent~Extent}\n   */\n  let hitExtent;\n  if (this.renderBuffer_ !== undefined) {\n    // build an extent around the coordinate, so that only features that\n    // intersect this extent are checked\n    hitExtent = buffer(createOrUpdateFromCoordinate(coordinate), resolution * this.renderBuffer_);\n  }\n\n  return this.replayHitDetection_(context,\n    coordinate, resolution, rotation, HIT_DETECTION_SIZE,\n    pixelRatio, opacity, skippedFeaturesHash,\n    /**\n     * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n     * @return {?} Callback result.\n     */\n    function(feature) {\n      const imageData = new Uint8Array(4);\n      gl.readPixels(0, 0, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, imageData);\n\n      if (imageData[3] > 0) {\n        const result = callback(feature);\n        if (result) {\n          return result;\n        }\n      }\n    }, true, hitExtent);\n};\n\n\n/**\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {module:ol/webgl/Context} context Context.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {module:ol/size~Size} size Size.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} opacity Global opacity.\n * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features to skip.\n * @return {boolean} Is there a feature at the given coordinate?\n */\nWebGLReplayGroup.prototype.hasFeatureAtCoordinate = function(\n  coordinate, context, center, resolution, rotation, size, pixelRatio,\n  opacity, skippedFeaturesHash) {\n  const gl = context.getGL();\n  gl.bindFramebuffer(\n    gl.FRAMEBUFFER, context.getHitDetectionFramebuffer());\n\n  const hasFeature = this.replayHitDetection_(context,\n    coordinate, resolution, rotation, HIT_DETECTION_SIZE,\n    pixelRatio, opacity, skippedFeaturesHash,\n    /**\n     * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n     * @return {boolean} Is there a feature?\n     */\n    function(feature) {\n      const imageData = new Uint8Array(4);\n      gl.readPixels(0, 0, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, imageData);\n      return imageData[3] > 0;\n    }, false);\n\n  return hasFeature !== undefined;\n};\n\nexport default WebGLReplayGroup;\n","/**\n * @module ol/render/webgl/Immediate\n */\nimport {inherits} from '../../util.js';\nimport {intersects} from '../../extent.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport ReplayType from '../ReplayType.js';\nimport VectorContext from '../VectorContext.js';\nimport WebGLReplayGroup from '../webgl/ReplayGroup.js';\n\n/**\n * @constructor\n * @extends {module:ol/render/VectorContext}\n * @param {module:ol/webgl/Context} context Context.\n * @param {module:ol/coordinate~Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {module:ol/size~Size} size Size.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} pixelRatio Pixel ratio.\n * @struct\n */\nconst WebGLImmediateRenderer = function(context, center, resolution, rotation, size, extent, pixelRatio) {\n  VectorContext.call(this);\n\n  /**\n   * @private\n   */\n  this.context_ = context;\n\n  /**\n   * @private\n   */\n  this.center_ = center;\n\n  /**\n   * @private\n   */\n  this.extent_ = extent;\n\n  /**\n   * @private\n   */\n  this.pixelRatio_ = pixelRatio;\n\n  /**\n   * @private\n   */\n  this.size_ = size;\n\n  /**\n   * @private\n   */\n  this.rotation_ = rotation;\n\n  /**\n   * @private\n   */\n  this.resolution_ = resolution;\n\n  /**\n   * @private\n   * @type {module:ol/style/Image}\n   */\n  this.imageStyle_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Fill}\n   */\n  this.fillStyle_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Stroke}\n   */\n  this.strokeStyle_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/style/Text}\n   */\n  this.textStyle_ = null;\n\n};\n\ninherits(WebGLImmediateRenderer, VectorContext);\n\n\n/**\n * @param {module:ol/render/webgl/ReplayGroup} replayGroup Replay group.\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\n * @private\n */\nWebGLImmediateRenderer.prototype.drawText_ = function(replayGroup, geometry) {\n  const context = this.context_;\n  const replay = /** @type {module:ol/render/webgl/TextReplay} */ (\n    replayGroup.getReplay(0, ReplayType.TEXT));\n  replay.setTextStyle(this.textStyle_);\n  replay.drawText(geometry, null);\n  replay.finish(context);\n  // default colors\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n};\n\n\n/**\n * Set the rendering style.  Note that since this is an immediate rendering API,\n * any `zIndex` on the provided style will be ignored.\n *\n * @param {module:ol/style/Style} style The rendering style.\n * @override\n * @api\n */\nWebGLImmediateRenderer.prototype.setStyle = function(style) {\n  this.setFillStrokeStyle(style.getFill(), style.getStroke());\n  this.setImageStyle(style.getImage());\n  this.setTextStyle(style.getText());\n};\n\n\n/**\n * Render a geometry into the canvas.  Call\n * {@link ol/render/webgl/Immediate#setStyle} first to set the rendering style.\n *\n * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry The geometry to render.\n * @override\n * @api\n */\nWebGLImmediateRenderer.prototype.drawGeometry = function(geometry) {\n  const type = geometry.getType();\n  switch (type) {\n    case GeometryType.POINT:\n      this.drawPoint(/** @type {module:ol/geom/Point} */ (geometry), null);\n      break;\n    case GeometryType.LINE_STRING:\n      this.drawLineString(/** @type {module:ol/geom/LineString} */ (geometry), null);\n      break;\n    case GeometryType.POLYGON:\n      this.drawPolygon(/** @type {module:ol/geom/Polygon} */ (geometry), null);\n      break;\n    case GeometryType.MULTI_POINT:\n      this.drawMultiPoint(/** @type {module:ol/geom/MultiPoint} */ (geometry), null);\n      break;\n    case GeometryType.MULTI_LINE_STRING:\n      this.drawMultiLineString(/** @type {module:ol/geom/MultiLineString} */ (geometry), null);\n      break;\n    case GeometryType.MULTI_POLYGON:\n      this.drawMultiPolygon(/** @type {module:ol/geom/MultiPolygon} */ (geometry), null);\n      break;\n    case GeometryType.GEOMETRY_COLLECTION:\n      this.drawGeometryCollection(/** @type {module:ol/geom/GeometryCollection} */ (geometry), null);\n      break;\n    case GeometryType.CIRCLE:\n      this.drawCircle(/** @type {module:ol/geom/Circle} */ (geometry), null);\n      break;\n    default:\n      // pass\n  }\n};\n\n\n/**\n * @inheritDoc\n * @api\n */\nWebGLImmediateRenderer.prototype.drawFeature = function(feature, style) {\n  const geometry = style.getGeometryFunction()(feature);\n  if (!geometry || !intersects(this.extent_, geometry.getExtent())) {\n    return;\n  }\n  this.setStyle(style);\n  this.drawGeometry(geometry);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawGeometryCollection = function(geometry, data) {\n  const geometries = geometry.getGeometriesArray();\n  let i, ii;\n  for (i = 0, ii = geometries.length; i < ii; ++i) {\n    this.drawGeometry(geometries[i]);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawPoint = function(geometry, data) {\n  const context = this.context_;\n  const replayGroup = new WebGLReplayGroup(1, this.extent_);\n  const replay = /** @type {module:ol/render/webgl/ImageReplay} */ (\n    replayGroup.getReplay(0, ReplayType.IMAGE));\n  replay.setImageStyle(this.imageStyle_);\n  replay.drawPoint(geometry, data);\n  replay.finish(context);\n  // default colors\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n\n  if (this.textStyle_) {\n    this.drawText_(replayGroup, geometry);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawMultiPoint = function(geometry, data) {\n  const context = this.context_;\n  const replayGroup = new WebGLReplayGroup(1, this.extent_);\n  const replay = /** @type {module:ol/render/webgl/ImageReplay} */ (\n    replayGroup.getReplay(0, ReplayType.IMAGE));\n  replay.setImageStyle(this.imageStyle_);\n  replay.drawMultiPoint(geometry, data);\n  replay.finish(context);\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n\n  if (this.textStyle_) {\n    this.drawText_(replayGroup, geometry);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawLineString = function(geometry, data) {\n  const context = this.context_;\n  const replayGroup = new WebGLReplayGroup(1, this.extent_);\n  const replay = /** @type {module:ol/render/webgl/LineStringReplay} */ (\n    replayGroup.getReplay(0, ReplayType.LINE_STRING));\n  replay.setFillStrokeStyle(null, this.strokeStyle_);\n  replay.drawLineString(geometry, data);\n  replay.finish(context);\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n\n  if (this.textStyle_) {\n    this.drawText_(replayGroup, geometry);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawMultiLineString = function(geometry, data) {\n  const context = this.context_;\n  const replayGroup = new WebGLReplayGroup(1, this.extent_);\n  const replay = /** @type {module:ol/render/webgl/LineStringReplay} */ (\n    replayGroup.getReplay(0, ReplayType.LINE_STRING));\n  replay.setFillStrokeStyle(null, this.strokeStyle_);\n  replay.drawMultiLineString(geometry, data);\n  replay.finish(context);\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n\n  if (this.textStyle_) {\n    this.drawText_(replayGroup, geometry);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawPolygon = function(geometry, data) {\n  const context = this.context_;\n  const replayGroup = new WebGLReplayGroup(1, this.extent_);\n  const replay = /** @type {module:ol/render/webgl/PolygonReplay} */ (\n    replayGroup.getReplay(0, ReplayType.POLYGON));\n  replay.setFillStrokeStyle(this.fillStyle_, this.strokeStyle_);\n  replay.drawPolygon(geometry, data);\n  replay.finish(context);\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n\n  if (this.textStyle_) {\n    this.drawText_(replayGroup, geometry);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawMultiPolygon = function(geometry, data) {\n  const context = this.context_;\n  const replayGroup = new WebGLReplayGroup(1, this.extent_);\n  const replay = /** @type {module:ol/render/webgl/PolygonReplay} */ (\n    replayGroup.getReplay(0, ReplayType.POLYGON));\n  replay.setFillStrokeStyle(this.fillStyle_, this.strokeStyle_);\n  replay.drawMultiPolygon(geometry, data);\n  replay.finish(context);\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n\n  if (this.textStyle_) {\n    this.drawText_(replayGroup, geometry);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.drawCircle = function(geometry, data) {\n  const context = this.context_;\n  const replayGroup = new WebGLReplayGroup(1, this.extent_);\n  const replay = /** @type {module:ol/render/webgl/CircleReplay} */ (\n    replayGroup.getReplay(0, ReplayType.CIRCLE));\n  replay.setFillStrokeStyle(this.fillStyle_, this.strokeStyle_);\n  replay.drawCircle(geometry, data);\n  replay.finish(context);\n  const opacity = 1;\n  const skippedFeatures = {};\n  let featureCallback;\n  const oneByOne = false;\n  replay.replay(this.context_, this.center_, this.resolution_, this.rotation_,\n    this.size_, this.pixelRatio_, opacity, skippedFeatures, featureCallback,\n    oneByOne);\n  replay.getDeleteResourcesFunction(context)();\n\n  if (this.textStyle_) {\n    this.drawText_(replayGroup, geometry);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.setImageStyle = function(imageStyle) {\n  this.imageStyle_ = imageStyle;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.setFillStrokeStyle = function(fillStyle, strokeStyle) {\n  this.fillStyle_ = fillStyle;\n  this.strokeStyle_ = strokeStyle;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImmediateRenderer.prototype.setTextStyle = function(textStyle) {\n  this.textStyle_ = textStyle;\n};\nexport default WebGLImmediateRenderer;\n","/**\n * @module ol/renderer/webgl/defaultmapshader\n */\n// This file is automatically generated, do not edit.\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG as DEBUG_WEBGL} from '../../webgl.js';\nimport WebGLFragment from '../../webgl/Fragment.js';\nimport WebGLVertex from '../../webgl/Vertex.js';\n\nexport const fragment = new WebGLFragment(DEBUG_WEBGL ?\n  'precision mediump float;\\nvarying vec2 v_texCoord;\\n\\n\\nuniform float u_opacity;\\nuniform sampler2D u_texture;\\n\\nvoid main(void) {\\n  vec4 texColor = texture2D(u_texture, v_texCoord);\\n  gl_FragColor.rgb = texColor.rgb;\\n  gl_FragColor.a = texColor.a * u_opacity;\\n}\\n' :\n  'precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}');\n\nexport const vertex = new WebGLVertex(DEBUG_WEBGL ?\n  'varying vec2 v_texCoord;\\n\\n\\nattribute vec2 a_position;\\nattribute vec2 a_texCoord;\\n\\nuniform mat4 u_texCoordMatrix;\\nuniform mat4 u_projectionMatrix;\\n\\nvoid main(void) {\\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\\n}\\n\\n\\n' :\n  'varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}');\n","/**\n * @module ol/renderer/webgl/defaultmapshader/Locations\n */\n// This file is automatically generated, do not edit\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG as DEBUG_WEBGL} from '../../../webgl.js';\n\n/**\n * @constructor\n * @param {WebGLRenderingContext} gl GL.\n * @param {WebGLProgram} program Program.\n * @struct\n */\nconst Locations = function(gl, program) {\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_texCoordMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_texCoordMatrix' : 'd');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_projectionMatrix = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_projectionMatrix' : 'e');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_opacity = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_opacity' : 'f');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_texture = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_texture' : 'g');\n\n  /**\n   * @type {number}\n   */\n  this.a_position = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_position' : 'b');\n\n  /**\n   * @type {number}\n   */\n  this.a_texCoord = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_texCoord' : 'c');\n};\n\nexport default Locations;\n","/**\n * @module ol/renderer/webgl/Layer\n */\nimport {inherits} from '../../util.js';\nimport RenderEvent from '../../render/Event.js';\nimport RenderEventType from '../../render/EventType.js';\nimport WebGLImmediateRenderer from '../../render/webgl/Immediate.js';\nimport LayerRenderer from '../Layer.js';\nimport {fragment, vertex} from '../webgl/defaultmapshader.js';\nimport Locations from '../webgl/defaultmapshader/Locations.js';\nimport {create as createTransform} from '../../transform.js';\nimport {create, fromTransform} from '../../vec/mat4.js';\nimport {ARRAY_BUFFER, FRAMEBUFFER, FLOAT, TEXTURE_2D,\n  TRIANGLE_STRIP, COLOR_ATTACHMENT0} from '../../webgl.js';\nimport WebGLBuffer from '../../webgl/Buffer.js';\nimport {createEmptyTexture} from '../../webgl/Context.js';\n\n/**\n * @constructor\n * @abstract\n * @extends {module:ol/renderer/Layer}\n * @param {module:ol/renderer/webgl/Map} mapRenderer Map renderer.\n * @param {module:ol/layer/Layer} layer Layer.\n */\nconst WebGLLayerRenderer = function(mapRenderer, layer) {\n\n  LayerRenderer.call(this, layer);\n\n  /**\n   * @protected\n   * @type {module:ol/renderer/webgl/Map}\n   */\n  this.mapRenderer = mapRenderer;\n\n  /**\n   * @private\n   * @type {module:ol/webgl/Buffer}\n   */\n  this.arrayBuffer_ = new WebGLBuffer([\n    -1, -1, 0, 0,\n    1, -1, 1, 0,\n    -1, 1, 0, 1,\n    1, 1, 1, 1\n  ]);\n\n  /**\n   * @protected\n   * @type {WebGLTexture}\n   */\n  this.texture = null;\n\n  /**\n   * @protected\n   * @type {WebGLFramebuffer}\n   */\n  this.framebuffer = null;\n\n  /**\n   * @protected\n   * @type {number|undefined}\n   */\n  this.framebufferDimension = undefined;\n\n  /**\n   * @protected\n   * @type {module:ol/transform~Transform}\n   */\n  this.texCoordMatrix = createTransform();\n\n  /**\n   * @protected\n   * @type {module:ol/transform~Transform}\n   */\n  this.projectionMatrix = createTransform();\n\n  /**\n   * @type {Array.<number>}\n   * @private\n   */\n  this.tmpMat4_ = create();\n\n  /**\n   * @private\n   * @type {module:ol/renderer/webgl/defaultmapshader/Locations}\n   */\n  this.defaultLocations_ = null;\n\n};\n\ninherits(WebGLLayerRenderer, LayerRenderer);\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {number} framebufferDimension Framebuffer dimension.\n * @protected\n */\nWebGLLayerRenderer.prototype.bindFramebuffer = function(frameState, framebufferDimension) {\n\n  const gl = this.mapRenderer.getGL();\n\n  if (this.framebufferDimension === undefined ||\n      this.framebufferDimension != framebufferDimension) {\n    /**\n     * @param {WebGLRenderingContext} gl GL.\n     * @param {WebGLFramebuffer} framebuffer Framebuffer.\n     * @param {WebGLTexture} texture Texture.\n     */\n    const postRenderFunction = function(gl, framebuffer, texture) {\n      if (!gl.isContextLost()) {\n        gl.deleteFramebuffer(framebuffer);\n        gl.deleteTexture(texture);\n      }\n    }.bind(null, gl, this.framebuffer, this.texture);\n\n    frameState.postRenderFunctions.push(\n      /** @type {module:ol/PluggableMap~PostRenderFunction} */ (postRenderFunction)\n    );\n\n    const texture = createEmptyTexture(\n      gl, framebufferDimension, framebufferDimension);\n\n    const framebuffer = gl.createFramebuffer();\n    gl.bindFramebuffer(FRAMEBUFFER, framebuffer);\n    gl.framebufferTexture2D(FRAMEBUFFER,\n      COLOR_ATTACHMENT0, TEXTURE_2D, texture, 0);\n\n    this.texture = texture;\n    this.framebuffer = framebuffer;\n    this.framebufferDimension = framebufferDimension;\n\n  } else {\n    gl.bindFramebuffer(FRAMEBUFFER, this.framebuffer);\n  }\n\n};\n\n\n/**\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {module:ol/webgl/Context} context Context.\n */\nWebGLLayerRenderer.prototype.composeFrame = function(frameState, layerState, context) {\n\n  this.dispatchComposeEvent_(RenderEventType.PRECOMPOSE, context, frameState);\n\n  context.bindBuffer(ARRAY_BUFFER, this.arrayBuffer_);\n\n  const gl = context.getGL();\n\n  const program = context.getProgram(fragment, vertex);\n\n  let locations;\n  if (!this.defaultLocations_) {\n    locations = new Locations(gl, program);\n    this.defaultLocations_ = locations;\n  } else {\n    locations = this.defaultLocations_;\n  }\n\n  if (context.useProgram(program)) {\n    gl.enableVertexAttribArray(locations.a_position);\n    gl.vertexAttribPointer(\n      locations.a_position, 2, FLOAT, false, 16, 0);\n    gl.enableVertexAttribArray(locations.a_texCoord);\n    gl.vertexAttribPointer(\n      locations.a_texCoord, 2, FLOAT, false, 16, 8);\n    gl.uniform1i(locations.u_texture, 0);\n  }\n\n  gl.uniformMatrix4fv(locations.u_texCoordMatrix, false,\n    fromTransform(this.tmpMat4_, this.getTexCoordMatrix()));\n  gl.uniformMatrix4fv(locations.u_projectionMatrix, false,\n    fromTransform(this.tmpMat4_, this.getProjectionMatrix()));\n  gl.uniform1f(locations.u_opacity, layerState.opacity);\n  gl.bindTexture(TEXTURE_2D, this.getTexture());\n  gl.drawArrays(TRIANGLE_STRIP, 0, 4);\n\n  this.dispatchComposeEvent_(RenderEventType.POSTCOMPOSE, context, frameState);\n};\n\n\n/**\n * @param {module:ol/render/EventType} type Event type.\n * @param {module:ol/webgl/Context} context WebGL context.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @private\n */\nWebGLLayerRenderer.prototype.dispatchComposeEvent_ = function(type, context, frameState) {\n  const layer = this.getLayer();\n  if (layer.hasListener(type)) {\n    const viewState = frameState.viewState;\n    const resolution = viewState.resolution;\n    const pixelRatio = frameState.pixelRatio;\n    const extent = frameState.extent;\n    const center = viewState.center;\n    const rotation = viewState.rotation;\n    const size = frameState.size;\n\n    const render = new WebGLImmediateRenderer(\n      context, center, resolution, rotation, size, extent, pixelRatio);\n    const composeEvent = new RenderEvent(\n      type, render, frameState, null, context);\n    layer.dispatchEvent(composeEvent);\n  }\n};\n\n\n/**\n * @return {!module:ol/transform~Transform} Matrix.\n */\nWebGLLayerRenderer.prototype.getTexCoordMatrix = function() {\n  return this.texCoordMatrix;\n};\n\n\n/**\n * @return {WebGLTexture} Texture.\n */\nWebGLLayerRenderer.prototype.getTexture = function() {\n  return this.texture;\n};\n\n\n/**\n * @return {!module:ol/transform~Transform} Matrix.\n */\nWebGLLayerRenderer.prototype.getProjectionMatrix = function() {\n  return this.projectionMatrix;\n};\n\n\n/**\n * Handle webglcontextlost.\n */\nWebGLLayerRenderer.prototype.handleWebGLContextLost = function() {\n  this.texture = null;\n  this.framebuffer = null;\n  this.framebufferDimension = undefined;\n};\n\n\n/**\n * @abstract\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @param {module:ol/layer/Layer~State} layerState Layer state.\n * @param {module:ol/webgl/Context} context Context.\n * @return {boolean} whether composeFrame should be called.\n */\nWebGLLayerRenderer.prototype.prepareFrame = function(frameState, layerState, context) {};\n\n\n/**\n * @abstract\n * @param {module:ol~Pixel} pixel Pixel.\n * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\n * @param {function(this: S, module:ol/layer/Layer, (Uint8ClampedArray|Uint8Array)): T} callback Layer\n *     callback.\n * @param {S} thisArg Value to use as `this` when executing `callback`.\n * @return {T|undefined} Callback result.\n * @template S,T,U\n */\nWebGLLayerRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, callback, thisArg) {};\nexport default WebGLLayerRenderer;\n","/**\n * @module ol/renderer/webgl/ImageLayer\n */\nimport {ENABLE_RASTER_REPROJECTION} from '../../reproj/common.js';\nimport {inherits} from '../../util.js';\nimport {TRUE, UNDEFINED} from '../../functions.js';\nimport LayerType from '../../LayerType.js';\nimport ViewHint from '../../ViewHint.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {getIntersection, isEmpty} from '../../extent.js';\nimport WebGLLayerRenderer from '../webgl/Layer.js';\nimport {\n  create as createTransform,\n  rotate as rotateTransform,\n  translate as translateTransform,\n  scale as scaleTransform,\n  reset as resetTransform,\n  apply as applyTransform,\n  invert as invertTransform,\n  multiply as multiplyTransform\n} from '../../transform.js';\nimport {CLAMP_TO_EDGE} from '../../webgl.js';\nimport {createTexture} from '../../webgl/Context.js';\n\n/**\n * @constructor\n * @extends {module:ol/renderer/webgl/Layer}\n * @param {module:ol/renderer/webgl/Map} mapRenderer Map renderer.\n * @param {module:ol/layer/Image} imageLayer Tile layer.\n * @api\n */\nconst WebGLImageLayerRenderer = function(mapRenderer, imageLayer) {\n\n  WebGLLayerRenderer.call(this, mapRenderer, imageLayer);\n\n  /**\n   * The last rendered image.\n   * @private\n   * @type {?module:ol/ImageBase}\n   */\n  this.image_ = null;\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.hitCanvasContext_ = null;\n\n  /**\n   * @private\n   * @type {?module:ol/transform~Transform}\n   */\n  this.hitTransformationMatrix_ = null;\n\n};\n\ninherits(WebGLImageLayerRenderer, WebGLLayerRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nWebGLImageLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.IMAGE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/webgl/ImageLayer} The layer renderer.\n */\nWebGLImageLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new WebGLImageLayerRenderer(\n    /** @type {module:ol/renderer/webgl/Map} */ (mapRenderer),\n    /** @type {module:ol/layer/Image} */ (layer)\n  );\n};\n\n\n/**\n * @param {module:ol/ImageBase} image Image.\n * @private\n * @return {WebGLTexture} Texture.\n */\nWebGLImageLayerRenderer.prototype.createTexture_ = function(image) {\n\n  // We meet the conditions to work with non-power of two textures.\n  // http://www.khronos.org/webgl/wiki/WebGL_and_OpenGL_Differences#Non-Power_of_Two_Texture_Support\n  // http://learningwebgl.com/blog/?p=2101\n\n  const imageElement = image.getImage();\n  const gl = this.mapRenderer.getGL();\n\n  return createTexture(\n    gl, imageElement, CLAMP_TO_EDGE, CLAMP_TO_EDGE);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageLayerRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  const layer = this.getLayer();\n  const source = layer.getSource();\n  const resolution = frameState.viewState.resolution;\n  const rotation = frameState.viewState.rotation;\n  const skippedFeatureUids = frameState.skippedFeatureUids;\n  return source.forEachFeatureAtCoordinate(\n    coordinate, resolution, rotation, hitTolerance, skippedFeatureUids,\n\n    /**\n     * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n     * @return {?} Callback result.\n     */\n    function(feature) {\n      return callback.call(thisArg, feature, layer);\n    });\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageLayerRenderer.prototype.prepareFrame = function(frameState, layerState, context) {\n\n  const gl = this.mapRenderer.getGL();\n\n  const pixelRatio = frameState.pixelRatio;\n  const viewState = frameState.viewState;\n  const viewCenter = viewState.center;\n  const viewResolution = viewState.resolution;\n  const viewRotation = viewState.rotation;\n\n  let image = this.image_;\n  let texture = this.texture;\n  const imageLayer = /** @type {module:ol/layer/Image} */ (this.getLayer());\n  const imageSource = imageLayer.getSource();\n\n  const hints = frameState.viewHints;\n\n  let renderedExtent = frameState.extent;\n  if (layerState.extent !== undefined) {\n    renderedExtent = getIntersection(renderedExtent, layerState.extent);\n  }\n  if (!hints[ViewHint.ANIMATING] && !hints[ViewHint.INTERACTING] &&\n      !isEmpty(renderedExtent)) {\n    let projection = viewState.projection;\n    if (!ENABLE_RASTER_REPROJECTION) {\n      const sourceProjection = imageSource.getProjection();\n      if (sourceProjection) {\n        projection = sourceProjection;\n      }\n    }\n    const image_ = imageSource.getImage(renderedExtent, viewResolution,\n      pixelRatio, projection);\n    if (image_) {\n      const loaded = this.loadImage(image_);\n      if (loaded) {\n        image = image_;\n        texture = this.createTexture_(image_);\n        if (this.texture) {\n          /**\n           * @param {WebGLRenderingContext} gl GL.\n           * @param {WebGLTexture} texture Texture.\n           */\n          const postRenderFunction = function(gl, texture) {\n            if (!gl.isContextLost()) {\n              gl.deleteTexture(texture);\n            }\n          }.bind(null, gl, this.texture);\n          frameState.postRenderFunctions.push(\n            /** @type {module:ol/PluggableMap~PostRenderFunction} */ (postRenderFunction)\n          );\n        }\n      }\n    }\n  }\n\n  if (image) {\n    const canvas = this.mapRenderer.getContext().getCanvas();\n\n    this.updateProjectionMatrix_(canvas.width, canvas.height,\n      pixelRatio, viewCenter, viewResolution, viewRotation,\n      image.getExtent());\n    this.hitTransformationMatrix_ = null;\n\n    // Translate and scale to flip the Y coord.\n    const texCoordMatrix = this.texCoordMatrix;\n    resetTransform(texCoordMatrix);\n    scaleTransform(texCoordMatrix, 1, -1);\n    translateTransform(texCoordMatrix, 0, -1);\n\n    this.image_ = image;\n    this.texture = texture;\n  }\n\n  return !!image;\n};\n\n\n/**\n * @param {number} canvasWidth Canvas width.\n * @param {number} canvasHeight Canvas height.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/coordinate~Coordinate} viewCenter View center.\n * @param {number} viewResolution View resolution.\n * @param {number} viewRotation View rotation.\n * @param {module:ol/extent~Extent} imageExtent Image extent.\n * @private\n */\nWebGLImageLayerRenderer.prototype.updateProjectionMatrix_ = function(canvasWidth, canvasHeight, pixelRatio,\n  viewCenter, viewResolution, viewRotation, imageExtent) {\n\n  const canvasExtentWidth = canvasWidth * viewResolution;\n  const canvasExtentHeight = canvasHeight * viewResolution;\n\n  const projectionMatrix = this.projectionMatrix;\n  resetTransform(projectionMatrix);\n  scaleTransform(projectionMatrix,\n    pixelRatio * 2 / canvasExtentWidth,\n    pixelRatio * 2 / canvasExtentHeight);\n  rotateTransform(projectionMatrix, -viewRotation);\n  translateTransform(projectionMatrix,\n    imageExtent[0] - viewCenter[0],\n    imageExtent[1] - viewCenter[1]);\n  scaleTransform(projectionMatrix,\n    (imageExtent[2] - imageExtent[0]) / 2,\n    (imageExtent[3] - imageExtent[1]) / 2);\n  translateTransform(projectionMatrix, 1, 1);\n\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageLayerRenderer.prototype.hasFeatureAtCoordinate = function(coordinate, frameState) {\n  const hasFeature = this.forEachFeatureAtCoordinate(coordinate, frameState, 0, TRUE, this);\n  return hasFeature !== undefined;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLImageLayerRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, callback, thisArg) {\n  if (!this.image_ || !this.image_.getImage()) {\n    return undefined;\n  }\n\n  if (this.getLayer().getSource().forEachFeatureAtCoordinate !== UNDEFINED) {\n    // for ImageCanvas sources use the original hit-detection logic,\n    // so that for example also transparent polygons are detected\n    const coordinate = applyTransform(\n      frameState.pixelToCoordinateTransform, pixel.slice());\n    const hasFeature = this.forEachFeatureAtCoordinate(coordinate, frameState, 0, TRUE, this);\n\n    if (hasFeature) {\n      return callback.call(thisArg, this.getLayer(), null);\n    } else {\n      return undefined;\n    }\n  } else {\n    const imageSize =\n        [this.image_.getImage().width, this.image_.getImage().height];\n\n    if (!this.hitTransformationMatrix_) {\n      this.hitTransformationMatrix_ = this.getHitTransformationMatrix_(\n        frameState.size, imageSize);\n    }\n\n    const pixelOnFrameBuffer = applyTransform(\n      this.hitTransformationMatrix_, pixel.slice());\n\n    if (pixelOnFrameBuffer[0] < 0 || pixelOnFrameBuffer[0] > imageSize[0] ||\n        pixelOnFrameBuffer[1] < 0 || pixelOnFrameBuffer[1] > imageSize[1]) {\n      // outside the image, no need to check\n      return undefined;\n    }\n\n    if (!this.hitCanvasContext_) {\n      this.hitCanvasContext_ = createCanvasContext2D(1, 1);\n    }\n\n    this.hitCanvasContext_.clearRect(0, 0, 1, 1);\n    this.hitCanvasContext_.drawImage(this.image_.getImage(),\n      pixelOnFrameBuffer[0], pixelOnFrameBuffer[1], 1, 1, 0, 0, 1, 1);\n\n    const imageData = this.hitCanvasContext_.getImageData(0, 0, 1, 1).data;\n    if (imageData[3] > 0) {\n      return callback.call(thisArg, this.getLayer(),  imageData);\n    } else {\n      return undefined;\n    }\n  }\n};\n\n\n/**\n * The transformation matrix to get the pixel on the image for a\n * pixel on the map.\n * @param {module:ol/size~Size} mapSize The map size.\n * @param {module:ol/size~Size} imageSize The image size.\n * @return {module:ol/transform~Transform} The transformation matrix.\n * @private\n */\nWebGLImageLayerRenderer.prototype.getHitTransformationMatrix_ = function(mapSize, imageSize) {\n  // the first matrix takes a map pixel, flips the y-axis and scales to\n  // a range between -1 ... 1\n  const mapCoordTransform = createTransform();\n  translateTransform(mapCoordTransform, -1, -1);\n  scaleTransform(mapCoordTransform, 2 / mapSize[0], 2 / mapSize[1]);\n  translateTransform(mapCoordTransform, 0, mapSize[1]);\n  scaleTransform(mapCoordTransform, 1, -1);\n\n  // the second matrix is the inverse of the projection matrix used in the\n  // shader for drawing\n  const projectionMatrixInv = invertTransform(this.projectionMatrix.slice());\n\n  // the third matrix scales to the image dimensions and flips the y-axis again\n  const transform = createTransform();\n  translateTransform(transform, 0, imageSize[1]);\n  scaleTransform(transform, 1, -1);\n  scaleTransform(transform, imageSize[0] / 2, imageSize[1] / 2);\n  translateTransform(transform, 1, 1);\n\n  multiplyTransform(transform, projectionMatrixInv);\n  multiplyTransform(transform, mapCoordTransform);\n\n  return transform;\n};\nexport default WebGLImageLayerRenderer;\n","/**\n * @module ol/renderer/webgl/Map\n */\n\nimport {inherits} from '../../util.js';\nimport {stableSort} from '../../array.js';\nimport {CLASS_UNSELECTABLE} from '../../css.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {listen} from '../../events.js';\nimport {visibleAtResolution} from '../../layer/Layer.js';\nimport RenderEvent from '../../render/Event.js';\nimport RenderEventType from '../../render/EventType.js';\nimport WebGLImmediateRenderer from '../../render/webgl/Immediate.js';\nimport MapRenderer, {sortByZIndex} from '../Map.js';\nimport SourceState from '../../source/State.js';\nimport LRUCache from '../../structs/LRUCache.js';\nimport PriorityQueue from '../../structs/PriorityQueue.js';\nimport {BLEND, CLAMP_TO_EDGE, COLOR_BUFFER_BIT, CULL_FACE, DEPTH_TEST, FRAMEBUFFER,\n  getContext, LINEAR, ONE, ONE_MINUS_SRC_ALPHA, RGBA, SCISSOR_TEST, SRC_ALPHA,\n  STENCIL_TEST, TEXTURE0, TEXTURE_2D, TEXTURE_MAG_FILTER, TEXTURE_MIN_FILTER,\n  TEXTURE_WRAP_S, TEXTURE_WRAP_T, UNSIGNED_BYTE} from '../../webgl.js';\nimport WebGLContext from '../../webgl/Context.js';\nimport ContextEventType from '../../webgl/ContextEventType.js';\n\n\n/**\n * @typedef {Object} TextureCacheEntry\n * @property {number} magFilter\n * @property {number} minFilter\n * @property {WebGLTexture} texture\n */\n\n\n/**\n * Texture cache high water mark.\n * @type {number}\n */\nconst WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK = 1024;\n\n\n/**\n * @constructor\n * @extends {module:ol/renderer/Map}\n * @param {module:ol/PluggableMap} map Map.\n * @api\n */\nconst WebGLMapRenderer = function(map) {\n  MapRenderer.call(this, map);\n\n  const container = map.getViewport();\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = /** @type {HTMLCanvasElement} */\n    (document.createElement('CANVAS'));\n  this.canvas_.style.width = '100%';\n  this.canvas_.style.height = '100%';\n  this.canvas_.style.display = 'block';\n  this.canvas_.className = CLASS_UNSELECTABLE;\n  container.insertBefore(this.canvas_, container.childNodes[0] || null);\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.clipTileCanvasWidth_ = 0;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.clipTileCanvasHeight_ = 0;\n\n  /**\n   * @private\n   * @type {CanvasRenderingContext2D}\n   */\n  this.clipTileContext_ = createCanvasContext2D();\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.renderedVisible_ = true;\n\n  /**\n   * @private\n   * @type {WebGLRenderingContext}\n   */\n  this.gl_ = getContext(this.canvas_, {\n    antialias: true,\n    depth: true,\n    failIfMajorPerformanceCaveat: true,\n    preserveDrawingBuffer: false,\n    stencil: true\n  });\n\n  /**\n   * @private\n   * @type {module:ol/webgl/Context}\n   */\n  this.context_ = new WebGLContext(this.canvas_, this.gl_);\n\n  listen(this.canvas_, ContextEventType.LOST,\n    this.handleWebGLContextLost, this);\n  listen(this.canvas_, ContextEventType.RESTORED,\n    this.handleWebGLContextRestored, this);\n\n  /**\n   * @private\n   * @type {module:ol/structs/LRUCache.<module:ol/renderer/webgl/Map~TextureCacheEntry|null>}\n   */\n  this.textureCache_ = new LRUCache();\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.focus_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/structs/PriorityQueue.<Array>}\n   */\n  this.tileTextureQueue_ = new PriorityQueue(\n    /**\n     * @param {Array.<*>} element Element.\n     * @return {number} Priority.\n     * @this {module:ol/renderer/webgl/Map}\n     */\n    (function(element) {\n      const tileCenter = /** @type {module:ol/coordinate~Coordinate} */ (element[1]);\n      const tileResolution = /** @type {number} */ (element[2]);\n      const deltaX = tileCenter[0] - this.focus_[0];\n      const deltaY = tileCenter[1] - this.focus_[1];\n      return 65536 * Math.log(tileResolution) +\n            Math.sqrt(deltaX * deltaX + deltaY * deltaY) / tileResolution;\n    }).bind(this),\n    /**\n     * @param {Array.<*>} element Element.\n     * @return {string} Key.\n     */\n    function(element) {\n      return (\n        /** @type {module:ol/Tile} */ (element[0]).getKey()\n      );\n    });\n\n\n  /**\n   * @param {module:ol/PluggableMap} map Map.\n   * @param {?module:ol/PluggableMap~FrameState} frameState Frame state.\n   * @return {boolean} false.\n   * @this {module:ol/renderer/webgl/Map}\n   */\n  this.loadNextTileTexture_ =\n      function(map, frameState) {\n        if (!this.tileTextureQueue_.isEmpty()) {\n          this.tileTextureQueue_.reprioritize();\n          const element = this.tileTextureQueue_.dequeue();\n          const tile = /** @type {module:ol/Tile} */ (element[0]);\n          const tileSize = /** @type {module:ol/size~Size} */ (element[3]);\n          const tileGutter = /** @type {number} */ (element[4]);\n          this.bindTileTexture(\n            tile, tileSize, tileGutter, LINEAR, LINEAR);\n        }\n        return false;\n      }.bind(this);\n\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.textureCacheFrameMarkerCount_ = 0;\n\n  this.initializeGL_();\n};\n\ninherits(WebGLMapRenderer, MapRenderer);\n\n\n/**\n * @param {module:ol/Tile} tile Tile.\n * @param {module:ol/size~Size} tileSize Tile size.\n * @param {number} tileGutter Tile gutter.\n * @param {number} magFilter Mag filter.\n * @param {number} minFilter Min filter.\n */\nWebGLMapRenderer.prototype.bindTileTexture = function(tile, tileSize, tileGutter, magFilter, minFilter) {\n  const gl = this.getGL();\n  const tileKey = tile.getKey();\n  if (this.textureCache_.containsKey(tileKey)) {\n    const textureCacheEntry = this.textureCache_.get(tileKey);\n    gl.bindTexture(TEXTURE_2D, textureCacheEntry.texture);\n    if (textureCacheEntry.magFilter != magFilter) {\n      gl.texParameteri(\n        TEXTURE_2D, TEXTURE_MAG_FILTER, magFilter);\n      textureCacheEntry.magFilter = magFilter;\n    }\n    if (textureCacheEntry.minFilter != minFilter) {\n      gl.texParameteri(\n        TEXTURE_2D, TEXTURE_MIN_FILTER, minFilter);\n      textureCacheEntry.minFilter = minFilter;\n    }\n  } else {\n    const texture = gl.createTexture();\n    gl.bindTexture(TEXTURE_2D, texture);\n    if (tileGutter > 0) {\n      const clipTileCanvas = this.clipTileContext_.canvas;\n      const clipTileContext = this.clipTileContext_;\n      if (this.clipTileCanvasWidth_ !== tileSize[0] ||\n          this.clipTileCanvasHeight_ !== tileSize[1]) {\n        clipTileCanvas.width = tileSize[0];\n        clipTileCanvas.height = tileSize[1];\n        this.clipTileCanvasWidth_ = tileSize[0];\n        this.clipTileCanvasHeight_ = tileSize[1];\n      } else {\n        clipTileContext.clearRect(0, 0, tileSize[0], tileSize[1]);\n      }\n      clipTileContext.drawImage(tile.getImage(), tileGutter, tileGutter,\n        tileSize[0], tileSize[1], 0, 0, tileSize[0], tileSize[1]);\n      gl.texImage2D(TEXTURE_2D, 0,\n        RGBA, RGBA,\n        UNSIGNED_BYTE, clipTileCanvas);\n    } else {\n      gl.texImage2D(TEXTURE_2D, 0,\n        RGBA, RGBA,\n        UNSIGNED_BYTE, tile.getImage());\n    }\n    gl.texParameteri(\n      TEXTURE_2D, TEXTURE_MAG_FILTER, magFilter);\n    gl.texParameteri(\n      TEXTURE_2D, TEXTURE_MIN_FILTER, minFilter);\n    gl.texParameteri(TEXTURE_2D, TEXTURE_WRAP_S,\n      CLAMP_TO_EDGE);\n    gl.texParameteri(TEXTURE_2D, TEXTURE_WRAP_T,\n      CLAMP_TO_EDGE);\n    this.textureCache_.set(tileKey, {\n      texture: texture,\n      magFilter: magFilter,\n      minFilter: minFilter\n    });\n  }\n};\n\n\n/**\n * @param {module:ol/render/EventType} type Event type.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @private\n */\nWebGLMapRenderer.prototype.dispatchComposeEvent_ = function(type, frameState) {\n  const map = this.getMap();\n  if (map.hasListener(type)) {\n    const context = this.context_;\n\n    const extent = frameState.extent;\n    const size = frameState.size;\n    const viewState = frameState.viewState;\n    const pixelRatio = frameState.pixelRatio;\n\n    const resolution = viewState.resolution;\n    const center = viewState.center;\n    const rotation = viewState.rotation;\n\n    const vectorContext = new WebGLImmediateRenderer(context,\n      center, resolution, rotation, size, extent, pixelRatio);\n    const composeEvent = new RenderEvent(type, vectorContext,\n      frameState, null, context);\n    map.dispatchEvent(composeEvent);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLMapRenderer.prototype.disposeInternal = function() {\n  const gl = this.getGL();\n  if (!gl.isContextLost()) {\n    this.textureCache_.forEach(\n      /**\n       * @param {?module:ol/renderer/webgl/Map~TextureCacheEntry} textureCacheEntry\n       *     Texture cache entry.\n       */\n      function(textureCacheEntry) {\n        if (textureCacheEntry) {\n          gl.deleteTexture(textureCacheEntry.texture);\n        }\n      });\n  }\n  this.context_.dispose();\n  MapRenderer.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @param {module:ol/PluggableMap} map Map.\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\n * @private\n */\nWebGLMapRenderer.prototype.expireCache_ = function(map, frameState) {\n  const gl = this.getGL();\n  let textureCacheEntry;\n  while (this.textureCache_.getCount() - this.textureCacheFrameMarkerCount_ >\n      WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK) {\n    textureCacheEntry = this.textureCache_.peekLast();\n    if (!textureCacheEntry) {\n      if (+this.textureCache_.peekLastKey() == frameState.index) {\n        break;\n      } else {\n        --this.textureCacheFrameMarkerCount_;\n      }\n    } else {\n      gl.deleteTexture(textureCacheEntry.texture);\n    }\n    this.textureCache_.pop();\n  }\n};\n\n\n/**\n * @return {module:ol/webgl/Context} The context.\n */\nWebGLMapRenderer.prototype.getContext = function() {\n  return this.context_;\n};\n\n\n/**\n * @return {WebGLRenderingContext} GL.\n */\nWebGLMapRenderer.prototype.getGL = function() {\n  return this.gl_;\n};\n\n\n/**\n * @return {module:ol/structs/PriorityQueue.<Array>} Tile texture queue.\n */\nWebGLMapRenderer.prototype.getTileTextureQueue = function() {\n  return this.tileTextureQueue_;\n};\n\n\n/**\n * @param {module:ol/events/Event} event Event.\n * @protected\n */\nWebGLMapRenderer.prototype.handleWebGLContextLost = function(event) {\n  event.preventDefault();\n  this.textureCache_.clear();\n  this.textureCacheFrameMarkerCount_ = 0;\n\n  const renderers = this.getLayerRenderers();\n  for (const id in renderers) {\n    const renderer = /** @type {module:ol/renderer/webgl/Layer} */ (renderers[id]);\n    renderer.handleWebGLContextLost();\n  }\n};\n\n\n/**\n * @protected\n */\nWebGLMapRenderer.prototype.handleWebGLContextRestored = function() {\n  this.initializeGL_();\n  this.getMap().render();\n};\n\n\n/**\n * @private\n */\nWebGLMapRenderer.prototype.initializeGL_ = function() {\n  const gl = this.gl_;\n  gl.activeTexture(TEXTURE0);\n  gl.blendFuncSeparate(\n    SRC_ALPHA, ONE_MINUS_SRC_ALPHA,\n    ONE, ONE_MINUS_SRC_ALPHA);\n  gl.disable(CULL_FACE);\n  gl.disable(DEPTH_TEST);\n  gl.disable(SCISSOR_TEST);\n  gl.disable(STENCIL_TEST);\n};\n\n\n/**\n * @param {module:ol/Tile} tile Tile.\n * @return {boolean} Is tile texture loaded.\n */\nWebGLMapRenderer.prototype.isTileTextureLoaded = function(tile) {\n  return this.textureCache_.containsKey(tile.getKey());\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLMapRenderer.prototype.renderFrame = function(frameState) {\n\n  const context = this.getContext();\n  const gl = this.getGL();\n\n  if (gl.isContextLost()) {\n    return false;\n  }\n\n  if (!frameState) {\n    if (this.renderedVisible_) {\n      this.canvas_.style.display = 'none';\n      this.renderedVisible_ = false;\n    }\n    return false;\n  }\n\n  this.focus_ = frameState.focus;\n\n  this.textureCache_.set((-frameState.index).toString(), null);\n  ++this.textureCacheFrameMarkerCount_;\n\n  this.dispatchComposeEvent_(RenderEventType.PRECOMPOSE, frameState);\n\n  /** @type {Array.<module:ol/layer/Layer~State>} */\n  const layerStatesToDraw = [];\n  const layerStatesArray = frameState.layerStatesArray;\n  stableSort(layerStatesArray, sortByZIndex);\n\n  const viewResolution = frameState.viewState.resolution;\n  let i, ii, layerRenderer, layerState;\n  for (i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n    layerState = layerStatesArray[i];\n    if (visibleAtResolution(layerState, viewResolution) &&\n        layerState.sourceState == SourceState.READY) {\n      layerRenderer = /** @type {module:ol/renderer/webgl/Layer} */ (this.getLayerRenderer(layerState.layer));\n      if (layerRenderer.prepareFrame(frameState, layerState, context)) {\n        layerStatesToDraw.push(layerState);\n      }\n    }\n  }\n\n  const width = frameState.size[0] * frameState.pixelRatio;\n  const height = frameState.size[1] * frameState.pixelRatio;\n  if (this.canvas_.width != width || this.canvas_.height != height) {\n    this.canvas_.width = width;\n    this.canvas_.height = height;\n  }\n\n  gl.bindFramebuffer(FRAMEBUFFER, null);\n\n  gl.clearColor(0, 0, 0, 0);\n  gl.clear(COLOR_BUFFER_BIT);\n  gl.enable(BLEND);\n  gl.viewport(0, 0, this.canvas_.width, this.canvas_.height);\n\n  for (i = 0, ii = layerStatesToDraw.length; i < ii; ++i) {\n    layerState = layerStatesToDraw[i];\n    layerRenderer = /** @type {module:ol/renderer/webgl/Layer} */ (this.getLayerRenderer(layerState.layer));\n    layerRenderer.composeFrame(frameState, layerState, context);\n  }\n\n  if (!this.renderedVisible_) {\n    this.canvas_.style.display = '';\n    this.renderedVisible_ = true;\n  }\n\n  this.calculateMatrices2D(frameState);\n\n  if (this.textureCache_.getCount() - this.textureCacheFrameMarkerCount_ >\n      WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK) {\n    frameState.postRenderFunctions.push(\n      /** @type {module:ol/PluggableMap~PostRenderFunction} */ (this.expireCache_.bind(this))\n    );\n  }\n\n  if (!this.tileTextureQueue_.isEmpty()) {\n    frameState.postRenderFunctions.push(this.loadNextTileTexture_);\n    frameState.animate = true;\n  }\n\n  this.dispatchComposeEvent_(RenderEventType.POSTCOMPOSE, frameState);\n\n  this.scheduleRemoveUnusedLayerRenderers(frameState);\n  this.scheduleExpireIconCache(frameState);\n\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLMapRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg,\n  layerFilter, thisArg2) {\n  let result;\n\n  if (this.getGL().isContextLost()) {\n    return false;\n  }\n\n  const viewState = frameState.viewState;\n\n  const layerStates = frameState.layerStatesArray;\n  const numLayers = layerStates.length;\n  let i;\n  for (i = numLayers - 1; i >= 0; --i) {\n    const layerState = layerStates[i];\n    const layer = layerState.layer;\n    if (visibleAtResolution(layerState, viewState.resolution) &&\n        layerFilter.call(thisArg2, layer)) {\n      const layerRenderer = this.getLayerRenderer(layer);\n      result = layerRenderer.forEachFeatureAtCoordinate(\n        coordinate, frameState, hitTolerance, callback, thisArg);\n      if (result) {\n        return result;\n      }\n    }\n  }\n  return undefined;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLMapRenderer.prototype.hasFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, layerFilter, thisArg) {\n  let hasFeature = false;\n\n  if (this.getGL().isContextLost()) {\n    return false;\n  }\n\n  const viewState = frameState.viewState;\n\n  const layerStates = frameState.layerStatesArray;\n  const numLayers = layerStates.length;\n  let i;\n  for (i = numLayers - 1; i >= 0; --i) {\n    const layerState = layerStates[i];\n    const layer = layerState.layer;\n    if (visibleAtResolution(layerState, viewState.resolution) &&\n        layerFilter.call(thisArg, layer)) {\n      const layerRenderer = this.getLayerRenderer(layer);\n      hasFeature =\n          layerRenderer.hasFeatureAtCoordinate(coordinate, frameState);\n      if (hasFeature) {\n        return true;\n      }\n    }\n  }\n  return hasFeature;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLMapRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, hitTolerance, callback, thisArg,\n  layerFilter, thisArg2) {\n  if (this.getGL().isContextLost()) {\n    return false;\n  }\n\n  const viewState = frameState.viewState;\n  let result;\n\n  const layerStates = frameState.layerStatesArray;\n  const numLayers = layerStates.length;\n  let i;\n  for (i = numLayers - 1; i >= 0; --i) {\n    const layerState = layerStates[i];\n    const layer = layerState.layer;\n    if (visibleAtResolution(layerState, viewState.resolution) &&\n        layerFilter.call(thisArg, layer)) {\n      const layerRenderer = /** @type {module:ol/renderer/webgl/Layer} */ (this.getLayerRenderer(layer));\n      result = layerRenderer.forEachLayerAtPixel(\n        pixel, frameState, callback, thisArg);\n      if (result) {\n        return result;\n      }\n    }\n  }\n  return undefined;\n};\n\nexport default WebGLMapRenderer;\n","/**\n * @module ol/renderer/webgl/tilelayershader\n */\n// This file is automatically generated, do not edit.\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG as DEBUG_WEBGL} from '../../webgl.js';\nimport WebGLFragment from '../../webgl/Fragment.js';\nimport WebGLVertex from '../../webgl/Vertex.js';\n\nexport const fragment = new WebGLFragment(DEBUG_WEBGL ?\n  'precision mediump float;\\nvarying vec2 v_texCoord;\\n\\n\\nuniform sampler2D u_texture;\\n\\nvoid main(void) {\\n  gl_FragColor = texture2D(u_texture, v_texCoord);\\n}\\n' :\n  'precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}');\n\nexport const vertex = new WebGLVertex(DEBUG_WEBGL ?\n  'varying vec2 v_texCoord;\\n\\n\\nattribute vec2 a_position;\\nattribute vec2 a_texCoord;\\nuniform vec4 u_tileOffset;\\n\\nvoid main(void) {\\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\\n  v_texCoord = a_texCoord;\\n}\\n\\n\\n' :\n  'varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}');\n","/**\n * @module ol/renderer/webgl/tilelayershader/Locations\n */\n// This file is automatically generated, do not edit\n// Run `make shaders` to generate, and commit the result.\n\nimport {DEBUG as DEBUG_WEBGL} from '../../../webgl.js';\n\n/**\n * @constructor\n * @param {WebGLRenderingContext} gl GL.\n * @param {WebGLProgram} program Program.\n * @struct\n */\nconst Locations = function(gl, program) {\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_tileOffset = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_tileOffset' : 'd');\n\n  /**\n   * @type {WebGLUniformLocation}\n   */\n  this.u_texture = gl.getUniformLocation(\n    program, DEBUG_WEBGL ? 'u_texture' : 'e');\n\n  /**\n   * @type {number}\n   */\n  this.a_position = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_position' : 'b');\n\n  /**\n   * @type {number}\n   */\n  this.a_texCoord = gl.getAttribLocation(\n    program, DEBUG_WEBGL ? 'a_texCoord' : 'c');\n};\n\nexport default Locations;\n","/**\n * @module ol/renderer/webgl/TileLayer\n */\n// FIXME large resolutions lead to too large framebuffers :-(\n// FIXME animated shaders! check in redraw\n\nimport {inherits} from '../../util.js';\nimport LayerType from '../../LayerType.js';\nimport TileRange from '../../TileRange.js';\nimport TileState from '../../TileState.js';\nimport {numberSafeCompareFunction} from '../../array.js';\nimport {createEmpty, intersects} from '../../extent.js';\nimport {roundUpToPowerOfTwo} from '../../math.js';\nimport WebGLLayerRenderer from '../webgl/Layer.js';\nimport {fragment, vertex} from '../webgl/tilelayershader.js';\nimport Locations from '../webgl/tilelayershader/Locations.js';\nimport {toSize} from '../../size.js';\nimport {\n  reset as resetTransform,\n  rotate as rotateTransform,\n  scale as scaleTransform,\n  translate as translateTransform,\n  apply as applyTransform\n} from '../../transform.js';\nimport {COLOR_BUFFER_BIT, BLEND, ARRAY_BUFFER, FLOAT, LINEAR, TRIANGLE_STRIP} from '../../webgl.js';\nimport WebGLBuffer from '../../webgl/Buffer.js';\n\n/**\n * @constructor\n * @extends {module:ol/renderer/webgl/Layer}\n * @param {module:ol/renderer/webgl/Map} mapRenderer Map renderer.\n * @param {module:ol/layer/Tile} tileLayer Tile layer.\n * @api\n */\nconst WebGLTileLayerRenderer = function(mapRenderer, tileLayer) {\n\n  WebGLLayerRenderer.call(this, mapRenderer, tileLayer);\n\n  /**\n   * @private\n   * @type {module:ol/webgl/Fragment}\n   */\n  this.fragmentShader_ = fragment;\n\n  /**\n   * @private\n   * @type {module:ol/webgl/Vertex}\n   */\n  this.vertexShader_ = vertex;\n\n  /**\n   * @private\n   * @type {module:ol/renderer/webgl/tilelayershader/Locations}\n   */\n  this.locations_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/webgl/Buffer}\n   */\n  this.renderArrayBuffer_ = new WebGLBuffer([\n    0, 0, 0, 1,\n    1, 0, 1, 1,\n    0, 1, 0, 0,\n    1, 1, 1, 0\n  ]);\n\n  /**\n   * @private\n   * @type {module:ol/TileRange}\n   */\n  this.renderedTileRange_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.renderedFramebufferExtent_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedRevision_ = -1;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.tmpSize_ = [0, 0];\n\n};\n\ninherits(WebGLTileLayerRenderer, WebGLLayerRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nWebGLTileLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.TILE;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/webgl/TileLayer} The layer renderer.\n */\nWebGLTileLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new WebGLTileLayerRenderer(\n    /** @type {module:ol/renderer/webgl/Map} */ (mapRenderer),\n    /** @type {module:ol/layer/Tile} */ (layer)\n  );\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTileLayerRenderer.prototype.disposeInternal = function() {\n  const context = this.mapRenderer.getContext();\n  context.deleteBuffer(this.renderArrayBuffer_);\n  WebGLLayerRenderer.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTileLayerRenderer.prototype.createLoadedTileFinder = function(source, projection, tiles) {\n  const mapRenderer = this.mapRenderer;\n\n  return (\n    /**\n     * @param {number} zoom Zoom level.\n     * @param {module:ol/TileRange} tileRange Tile range.\n     * @return {boolean} The tile range is fully loaded.\n     */\n    function(zoom, tileRange) {\n      function callback(tile) {\n        const loaded = mapRenderer.isTileTextureLoaded(tile);\n        if (loaded) {\n          if (!tiles[zoom]) {\n            tiles[zoom] = {};\n          }\n          tiles[zoom][tile.tileCoord.toString()] = tile;\n        }\n        return loaded;\n      }\n      return source.forEachLoadedTile(projection, zoom, tileRange, callback);\n    }\n  );\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTileLayerRenderer.prototype.handleWebGLContextLost = function() {\n  WebGLLayerRenderer.prototype.handleWebGLContextLost.call(this);\n  this.locations_ = null;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTileLayerRenderer.prototype.prepareFrame = function(frameState, layerState, context) {\n\n  const mapRenderer = this.mapRenderer;\n  const gl = context.getGL();\n\n  const viewState = frameState.viewState;\n  const projection = viewState.projection;\n\n  const tileLayer = /** @type {module:ol/layer/Tile} */ (this.getLayer());\n  const tileSource = tileLayer.getSource();\n  const tileGrid = tileSource.getTileGridForProjection(projection);\n  const z = tileGrid.getZForResolution(viewState.resolution);\n  const tileResolution = tileGrid.getResolution(z);\n\n  const tilePixelSize =\n      tileSource.getTilePixelSize(z, frameState.pixelRatio, projection);\n  const pixelRatio = tilePixelSize[0] /\n      toSize(tileGrid.getTileSize(z), this.tmpSize_)[0];\n  const tilePixelResolution = tileResolution / pixelRatio;\n  const tileGutter = tileSource.getTilePixelRatio(pixelRatio) * tileSource.getGutter(projection);\n\n  const center = viewState.center;\n  const extent = frameState.extent;\n  const tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);\n\n  let framebufferExtent;\n  if (this.renderedTileRange_ &&\n      this.renderedTileRange_.equals(tileRange) &&\n      this.renderedRevision_ == tileSource.getRevision()) {\n    framebufferExtent = this.renderedFramebufferExtent_;\n  } else {\n\n    const tileRangeSize = tileRange.getSize();\n\n    const maxDimension = Math.max(\n      tileRangeSize[0] * tilePixelSize[0],\n      tileRangeSize[1] * tilePixelSize[1]);\n    const framebufferDimension = roundUpToPowerOfTwo(maxDimension);\n    const framebufferExtentDimension = tilePixelResolution * framebufferDimension;\n    const origin = tileGrid.getOrigin(z);\n    const minX = origin[0] +\n        tileRange.minX * tilePixelSize[0] * tilePixelResolution;\n    const minY = origin[1] +\n        tileRange.minY * tilePixelSize[1] * tilePixelResolution;\n    framebufferExtent = [\n      minX, minY,\n      minX + framebufferExtentDimension, minY + framebufferExtentDimension\n    ];\n\n    this.bindFramebuffer(frameState, framebufferDimension);\n    gl.viewport(0, 0, framebufferDimension, framebufferDimension);\n\n    gl.clearColor(0, 0, 0, 0);\n    gl.clear(COLOR_BUFFER_BIT);\n    gl.disable(BLEND);\n\n    const program = context.getProgram(this.fragmentShader_, this.vertexShader_);\n    context.useProgram(program);\n    if (!this.locations_) {\n      this.locations_ = new Locations(gl, program);\n    }\n\n    context.bindBuffer(ARRAY_BUFFER, this.renderArrayBuffer_);\n    gl.enableVertexAttribArray(this.locations_.a_position);\n    gl.vertexAttribPointer(\n      this.locations_.a_position, 2, FLOAT, false, 16, 0);\n    gl.enableVertexAttribArray(this.locations_.a_texCoord);\n    gl.vertexAttribPointer(\n      this.locations_.a_texCoord, 2, FLOAT, false, 16, 8);\n    gl.uniform1i(this.locations_.u_texture, 0);\n\n    /**\n     * @type {Object.<number, Object.<string, module:ol/Tile>>}\n     */\n    const tilesToDrawByZ = {};\n    tilesToDrawByZ[z] = {};\n\n    const findLoadedTiles = this.createLoadedTileFinder(\n      tileSource, projection, tilesToDrawByZ);\n\n    const useInterimTilesOnError = tileLayer.getUseInterimTilesOnError();\n    let allTilesLoaded = true;\n    const tmpExtent = createEmpty();\n    const tmpTileRange = new TileRange(0, 0, 0, 0);\n    let childTileRange, drawable, fullyLoaded, tile, tileState;\n    let x, y, tileExtent;\n    for (x = tileRange.minX; x <= tileRange.maxX; ++x) {\n      for (y = tileRange.minY; y <= tileRange.maxY; ++y) {\n\n        tile = tileSource.getTile(z, x, y, pixelRatio, projection);\n        if (layerState.extent !== undefined) {\n          // ignore tiles outside layer extent\n          tileExtent = tileGrid.getTileCoordExtent(tile.tileCoord, tmpExtent);\n          if (!intersects(tileExtent, layerState.extent)) {\n            continue;\n          }\n        }\n        tileState = tile.getState();\n        drawable = tileState == TileState.LOADED ||\n            tileState == TileState.EMPTY ||\n            tileState == TileState.ERROR && !useInterimTilesOnError;\n        if (!drawable) {\n          tile = tile.getInterimTile();\n        }\n        tileState = tile.getState();\n        if (tileState == TileState.LOADED) {\n          if (mapRenderer.isTileTextureLoaded(tile)) {\n            tilesToDrawByZ[z][tile.tileCoord.toString()] = tile;\n            continue;\n          }\n        } else if (tileState == TileState.EMPTY ||\n                   (tileState == TileState.ERROR &&\n                    !useInterimTilesOnError)) {\n          continue;\n        }\n\n        allTilesLoaded = false;\n        fullyLoaded = tileGrid.forEachTileCoordParentTileRange(\n          tile.tileCoord, findLoadedTiles, null, tmpTileRange, tmpExtent);\n        if (!fullyLoaded) {\n          childTileRange = tileGrid.getTileCoordChildTileRange(\n            tile.tileCoord, tmpTileRange, tmpExtent);\n          if (childTileRange) {\n            findLoadedTiles(z + 1, childTileRange);\n          }\n        }\n\n      }\n\n    }\n\n    /** @type {Array.<number>} */\n    const zs = Object.keys(tilesToDrawByZ).map(Number);\n    zs.sort(numberSafeCompareFunction);\n    const u_tileOffset = new Float32Array(4);\n    for (let i = 0, ii = zs.length; i < ii; ++i) {\n      const tilesToDraw = tilesToDrawByZ[zs[i]];\n      for (const tileKey in tilesToDraw) {\n        tile = tilesToDraw[tileKey];\n        tileExtent = tileGrid.getTileCoordExtent(tile.tileCoord, tmpExtent);\n        u_tileOffset[0] = 2 * (tileExtent[2] - tileExtent[0]) /\n            framebufferExtentDimension;\n        u_tileOffset[1] = 2 * (tileExtent[3] - tileExtent[1]) /\n            framebufferExtentDimension;\n        u_tileOffset[2] = 2 * (tileExtent[0] - framebufferExtent[0]) /\n            framebufferExtentDimension - 1;\n        u_tileOffset[3] = 2 * (tileExtent[1] - framebufferExtent[1]) /\n            framebufferExtentDimension - 1;\n        gl.uniform4fv(this.locations_.u_tileOffset, u_tileOffset);\n        mapRenderer.bindTileTexture(tile, tilePixelSize,\n          tileGutter * pixelRatio, LINEAR, LINEAR);\n        gl.drawArrays(TRIANGLE_STRIP, 0, 4);\n      }\n    }\n\n    if (allTilesLoaded) {\n      this.renderedTileRange_ = tileRange;\n      this.renderedFramebufferExtent_ = framebufferExtent;\n      this.renderedRevision_ = tileSource.getRevision();\n    } else {\n      this.renderedTileRange_ = null;\n      this.renderedFramebufferExtent_ = null;\n      this.renderedRevision_ = -1;\n      frameState.animate = true;\n    }\n\n  }\n\n  this.updateUsedTiles(frameState.usedTiles, tileSource, z, tileRange);\n  const tileTextureQueue = mapRenderer.getTileTextureQueue();\n  this.manageTilePyramid(\n    frameState, tileSource, tileGrid, pixelRatio, projection, extent, z,\n    tileLayer.getPreload(),\n    /**\n     * @param {module:ol/Tile} tile Tile.\n     */\n    function(tile) {\n      if (tile.getState() == TileState.LOADED &&\n            !mapRenderer.isTileTextureLoaded(tile) &&\n            !tileTextureQueue.isKeyQueued(tile.getKey())) {\n        tileTextureQueue.enqueue([\n          tile,\n          tileGrid.getTileCoordCenter(tile.tileCoord),\n          tileGrid.getResolution(tile.tileCoord[0]),\n          tilePixelSize, tileGutter * pixelRatio\n        ]);\n      }\n    }, this);\n  this.scheduleExpireCache(frameState, tileSource);\n\n  const texCoordMatrix = this.texCoordMatrix;\n  resetTransform(texCoordMatrix);\n  translateTransform(texCoordMatrix,\n    (Math.round(center[0] / tileResolution) * tileResolution - framebufferExtent[0]) /\n          (framebufferExtent[2] - framebufferExtent[0]),\n    (Math.round(center[1] / tileResolution) * tileResolution - framebufferExtent[1]) /\n          (framebufferExtent[3] - framebufferExtent[1]));\n  if (viewState.rotation !== 0) {\n    rotateTransform(texCoordMatrix, viewState.rotation);\n  }\n  scaleTransform(texCoordMatrix,\n    frameState.size[0] * viewState.resolution /\n          (framebufferExtent[2] - framebufferExtent[0]),\n    frameState.size[1] * viewState.resolution /\n          (framebufferExtent[3] - framebufferExtent[1]));\n  translateTransform(texCoordMatrix, -0.5, -0.5);\n\n  return true;\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLTileLayerRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, callback, thisArg) {\n  if (!this.framebuffer) {\n    return undefined;\n  }\n\n  const pixelOnMapScaled = [\n    pixel[0] / frameState.size[0],\n    (frameState.size[1] - pixel[1]) / frameState.size[1]];\n\n  const pixelOnFrameBufferScaled = applyTransform(\n    this.texCoordMatrix, pixelOnMapScaled.slice());\n  const pixelOnFrameBuffer = [\n    pixelOnFrameBufferScaled[0] * this.framebufferDimension,\n    pixelOnFrameBufferScaled[1] * this.framebufferDimension];\n\n  const gl = this.mapRenderer.getContext().getGL();\n  gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\n  const imageData = new Uint8Array(4);\n  gl.readPixels(pixelOnFrameBuffer[0], pixelOnFrameBuffer[1], 1, 1,\n    gl.RGBA, gl.UNSIGNED_BYTE, imageData);\n\n  if (imageData[3] > 0) {\n    return callback.call(thisArg, this.getLayer(), imageData);\n  } else {\n    return undefined;\n  }\n};\nexport default WebGLTileLayerRenderer;\n","/**\n * @module ol/renderer/webgl/VectorLayer\n */\nimport {getUid, inherits} from '../../util.js';\nimport LayerType from '../../LayerType.js';\nimport ViewHint from '../../ViewHint.js';\nimport {buffer, containsExtent, createEmpty} from '../../extent.js';\nimport WebGLReplayGroup from '../../render/webgl/ReplayGroup.js';\nimport {defaultOrder as defaultRenderOrder, getTolerance as getRenderTolerance, getSquaredTolerance as getSquaredRenderTolerance, renderFeature} from '../vector.js';\nimport WebGLLayerRenderer from '../webgl/Layer.js';\nimport {apply as applyTransform} from '../../transform.js';\n\n/**\n * @constructor\n * @extends {module:ol/renderer/webgl/Layer}\n * @param {module:ol/renderer/webgl/Map} mapRenderer Map renderer.\n * @param {module:ol/layer/Vector} vectorLayer Vector layer.\n * @api\n */\nconst WebGLVectorLayerRenderer = function(mapRenderer, vectorLayer) {\n\n  WebGLLayerRenderer.call(this, mapRenderer, vectorLayer);\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.dirty_ = false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedRevision_ = -1;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.renderedResolution_ = NaN;\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.renderedExtent_ = createEmpty();\n\n  /**\n   * @private\n   * @type {function(module:ol/Feature, module:ol/Feature): number|null}\n   */\n  this.renderedRenderOrder_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/render/webgl/ReplayGroup}\n   */\n  this.replayGroup_ = null;\n\n  /**\n   * The last layer state.\n   * @private\n   * @type {?module:ol/layer/Layer~State}\n   */\n  this.layerState_ = null;\n\n};\n\ninherits(WebGLVectorLayerRenderer, WebGLLayerRenderer);\n\n\n/**\n * Determine if this renderer handles the provided layer.\n * @param {module:ol/layer/Layer} layer The candidate layer.\n * @return {boolean} The renderer can render the layer.\n */\nWebGLVectorLayerRenderer['handles'] = function(layer) {\n  return layer.getType() === LayerType.VECTOR;\n};\n\n\n/**\n * Create a layer renderer.\n * @param {module:ol/renderer/Map} mapRenderer The map renderer.\n * @param {module:ol/layer/Layer} layer The layer to be rendererd.\n * @return {module:ol/renderer/webgl/VectorLayer} The layer renderer.\n */\nWebGLVectorLayerRenderer['create'] = function(mapRenderer, layer) {\n  return new WebGLVectorLayerRenderer(\n    /** @type {module:ol/renderer/webgl/Map} */ (mapRenderer),\n    /** @type {module:ol/layer/Vector} */ (layer)\n  );\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLVectorLayerRenderer.prototype.composeFrame = function(frameState, layerState, context) {\n  this.layerState_ = layerState;\n  const viewState = frameState.viewState;\n  const replayGroup = this.replayGroup_;\n  const size = frameState.size;\n  const pixelRatio = frameState.pixelRatio;\n  const gl = this.mapRenderer.getGL();\n  if (replayGroup && !replayGroup.isEmpty()) {\n    gl.enable(gl.SCISSOR_TEST);\n    gl.scissor(0, 0, size[0] * pixelRatio, size[1] * pixelRatio);\n    replayGroup.replay(context,\n      viewState.center, viewState.resolution, viewState.rotation,\n      size, pixelRatio, layerState.opacity,\n      layerState.managed ? frameState.skippedFeatureUids : {});\n    gl.disable(gl.SCISSOR_TEST);\n  }\n\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLVectorLayerRenderer.prototype.disposeInternal = function() {\n  const replayGroup = this.replayGroup_;\n  if (replayGroup) {\n    const context = this.mapRenderer.getContext();\n    replayGroup.getDeleteResourcesFunction(context)();\n    this.replayGroup_ = null;\n  }\n  WebGLLayerRenderer.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLVectorLayerRenderer.prototype.forEachFeatureAtCoordinate = function(coordinate, frameState, hitTolerance, callback, thisArg) {\n  if (!this.replayGroup_ || !this.layerState_) {\n    return undefined;\n  } else {\n    const context = this.mapRenderer.getContext();\n    const viewState = frameState.viewState;\n    const layer = this.getLayer();\n    const layerState = this.layerState_;\n    /** @type {!Object.<string, boolean>} */\n    const features = {};\n    return this.replayGroup_.forEachFeatureAtCoordinate(coordinate,\n      context, viewState.center, viewState.resolution, viewState.rotation,\n      frameState.size, frameState.pixelRatio, layerState.opacity,\n      {},\n      /**\n       * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\n       * @return {?} Callback result.\n       */\n      function(feature) {\n        const key = getUid(feature).toString();\n        if (!(key in features)) {\n          features[key] = true;\n          return callback.call(thisArg, feature, layer);\n        }\n      });\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLVectorLayerRenderer.prototype.hasFeatureAtCoordinate = function(coordinate, frameState) {\n  if (!this.replayGroup_ || !this.layerState_) {\n    return false;\n  } else {\n    const context = this.mapRenderer.getContext();\n    const viewState = frameState.viewState;\n    const layerState = this.layerState_;\n    return this.replayGroup_.hasFeatureAtCoordinate(coordinate,\n      context, viewState.center, viewState.resolution, viewState.rotation,\n      frameState.size, frameState.pixelRatio, layerState.opacity,\n      frameState.skippedFeatureUids);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLVectorLayerRenderer.prototype.forEachLayerAtPixel = function(pixel, frameState, callback, thisArg) {\n  const coordinate = applyTransform(\n    frameState.pixelToCoordinateTransform, pixel.slice());\n  const hasFeature = this.hasFeatureAtCoordinate(coordinate, frameState);\n\n  if (hasFeature) {\n    return callback.call(thisArg, this.getLayer(), null);\n  } else {\n    return undefined;\n  }\n};\n\n\n/**\n * Handle changes in image style state.\n * @param {module:ol/events/Event} event Image style change event.\n * @private\n */\nWebGLVectorLayerRenderer.prototype.handleStyleImageChange_ = function(event) {\n  this.renderIfReadyAndVisible();\n};\n\n\n/**\n * @inheritDoc\n */\nWebGLVectorLayerRenderer.prototype.prepareFrame = function(frameState, layerState, context) {\n  const vectorLayer = /** @type {module:ol/layer/Vector} */ (this.getLayer());\n  const vectorSource = vectorLayer.getSource();\n\n  const animating = frameState.viewHints[ViewHint.ANIMATING];\n  const interacting = frameState.viewHints[ViewHint.INTERACTING];\n  const updateWhileAnimating = vectorLayer.getUpdateWhileAnimating();\n  const updateWhileInteracting = vectorLayer.getUpdateWhileInteracting();\n\n  if (!this.dirty_ && (!updateWhileAnimating && animating) ||\n      (!updateWhileInteracting && interacting)) {\n    return true;\n  }\n\n  const frameStateExtent = frameState.extent;\n  const viewState = frameState.viewState;\n  const projection = viewState.projection;\n  const resolution = viewState.resolution;\n  const pixelRatio = frameState.pixelRatio;\n  const vectorLayerRevision = vectorLayer.getRevision();\n  const vectorLayerRenderBuffer = vectorLayer.getRenderBuffer();\n  let vectorLayerRenderOrder = vectorLayer.getRenderOrder();\n\n  if (vectorLayerRenderOrder === undefined) {\n    vectorLayerRenderOrder = defaultRenderOrder;\n  }\n\n  const extent = buffer(frameStateExtent,\n    vectorLayerRenderBuffer * resolution);\n\n  if (!this.dirty_ &&\n      this.renderedResolution_ == resolution &&\n      this.renderedRevision_ == vectorLayerRevision &&\n      this.renderedRenderOrder_ == vectorLayerRenderOrder &&\n      containsExtent(this.renderedExtent_, extent)) {\n    return true;\n  }\n\n  if (this.replayGroup_) {\n    frameState.postRenderFunctions.push(\n      this.replayGroup_.getDeleteResourcesFunction(context));\n  }\n\n  this.dirty_ = false;\n\n  const replayGroup = new WebGLReplayGroup(\n    getRenderTolerance(resolution, pixelRatio),\n    extent, vectorLayer.getRenderBuffer());\n  vectorSource.loadFeatures(extent, resolution, projection);\n  /**\n   * @param {module:ol/Feature} feature Feature.\n   * @this {module:ol/renderer/webgl/VectorLayer}\n   */\n  const render = function(feature) {\n    let styles;\n    const styleFunction = feature.getStyleFunction() || vectorLayer.getStyleFunction();\n    if (styleFunction) {\n      styles = styleFunction(feature, resolution);\n    }\n    if (styles) {\n      const dirty = this.renderFeature(\n        feature, resolution, pixelRatio, styles, replayGroup);\n      this.dirty_ = this.dirty_ || dirty;\n    }\n  };\n  if (vectorLayerRenderOrder) {\n    /** @type {Array.<module:ol/Feature>} */\n    const features = [];\n    vectorSource.forEachFeatureInExtent(extent,\n      /**\n       * @param {module:ol/Feature} feature Feature.\n       */\n      function(feature) {\n        features.push(feature);\n      }, this);\n    features.sort(vectorLayerRenderOrder);\n    features.forEach(render.bind(this));\n  } else {\n    vectorSource.forEachFeatureInExtent(extent, render, this);\n  }\n  replayGroup.finish(context);\n\n  this.renderedResolution_ = resolution;\n  this.renderedRevision_ = vectorLayerRevision;\n  this.renderedRenderOrder_ = vectorLayerRenderOrder;\n  this.renderedExtent_ = extent;\n  this.replayGroup_ = replayGroup;\n\n  return true;\n};\n\n\n/**\n * @param {module:ol/Feature} feature Feature.\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @param {(module:ol/style/Style|Array.<module:ol/style/Style>)} styles The style or array of\n *     styles.\n * @param {module:ol/render/webgl/ReplayGroup} replayGroup Replay group.\n * @return {boolean} `true` if an image is loading.\n */\nWebGLVectorLayerRenderer.prototype.renderFeature = function(feature, resolution, pixelRatio, styles, replayGroup) {\n  if (!styles) {\n    return false;\n  }\n  let loading = false;\n  if (Array.isArray(styles)) {\n    for (let i = styles.length - 1, ii = 0; i >= ii; --i) {\n      loading = renderFeature(\n        replayGroup, feature, styles[i],\n        getSquaredRenderTolerance(resolution, pixelRatio),\n        this.handleStyleImageChange_, this) || loading;\n    }\n  } else {\n    loading = renderFeature(\n      replayGroup, feature, styles,\n      getSquaredRenderTolerance(resolution, pixelRatio),\n      this.handleStyleImageChange_, this) || loading;\n  }\n  return loading;\n};\nexport default WebGLVectorLayerRenderer;\n","/**\n * @module ol/WebGLMap\n */\nimport {inherits} from './util.js';\nimport PluggableMap from './PluggableMap.js';\nimport {defaults as defaultControls} from './control.js';\nimport {defaults as defaultInteractions} from './interaction.js';\nimport {assign} from './obj.js';\nimport WebGLImageLayerRenderer from './renderer/webgl/ImageLayer.js';\nimport WebGLMapRenderer from './renderer/webgl/Map.js';\nimport WebGLTileLayerRenderer from './renderer/webgl/TileLayer.js';\nimport WebGLVectorLayerRenderer from './renderer/webgl/VectorLayer.js';\n\n\n/**\n * @classdesc\n * The WebGLMap uses WebGL for rendering map layers.  This renderer has limited\n * support for vector data and no support for vector tiles.\n *\n *     import WebGLMap from 'ol/WebGLMap';\n *     import TileLayer from 'ol/layer/Tile';\n *     import OSM from 'ol/source/OSM';\n *     import View from 'ol/View';\n *\n *     var map = new WebGLMap({\n *       view: new View({\n *         center: [0, 0],\n *         zoom: 1\n *       }),\n *       layers: [\n *         new TileLayer({\n *           source: new OSM()\n *         })\n *       ],\n *       target: 'map'\n *     });\n *\n * The above snippet creates a map using a {@link module:ol/layer/Tile~Tile} to\n * display {@link module:ol/source/OSM~OSM} OSM data and render it to a DOM\n * element with the id `map`.\n *\n * The constructor places a viewport container (with CSS class name\n * `ol-viewport`) in the target element (see `getViewport()`), and then two\n * further elements within the viewport: one with CSS class name\n * `ol-overlaycontainer-stopevent` for controls and some overlays, and one with\n * CSS class name `ol-overlaycontainer` for other overlays (see the `stopEvent`\n * option of {@link module:ol/Overlay~Overlay} for the difference). The map\n * itself is placed in a further element within the viewport.\n *\n * Layers are stored as a {@link module:ol/Collection~Collection} in\n * layerGroups. A top-level group is provided by the library. This is what is\n * accessed by `getLayerGroup` and `setLayerGroup`. Layers entered in the\n * options are added to this group, and `addLayer` and `removeLayer` change the\n * layer collection in the group. `getLayers` is a convenience function for\n * `getLayerGroup().getLayers()`.\n * Note that {@link module:ol/layer/Group~Group} is a subclass of\n * {@link module:ol/layer/Base}, so layers entered in the options or added\n * with `addLayer` can be groups, which can contain further groups, and so on.\n *\n * @constructor\n * @extends {module:ol/PluggableMap}\n * @param {module:ol/PluggableMap~MapOptions} options Map options.\n * @fires module:ol/MapBrowserEvent~MapBrowserEvent\n * @fires module:ol/MapEvent~MapEvent\n * @fires module:ol/render/Event~RenderEvent#postcompose\n * @fires module:ol/render/Event~RenderEvent#precompose\n * @api\n */\nconst WebGLMap = function(options) {\n  options = assign({}, options);\n  if (!options.controls) {\n    options.controls = defaultControls();\n  }\n  if (!options.interactions) {\n    options.interactions = defaultInteractions();\n  }\n\n  PluggableMap.call(this, options);\n};\n\ninherits(WebGLMap, PluggableMap);\n\n\nWebGLMap.prototype.createRenderer = function() {\n  const renderer = new WebGLMapRenderer(this);\n  renderer.registerLayerRenderers([\n    WebGLImageLayerRenderer,\n    WebGLTileLayerRenderer,\n    WebGLVectorLayerRenderer\n  ]);\n  return renderer;\n};\n\nexport default WebGLMap;\n","/**\n * @module ol\n */\n\nexport {default as AssertionError} from './AssertionError.js';\nexport {default as Collection} from './Collection.js';\nexport {default as Disposable} from './Disposable.js';\nexport {default as Feature} from './Feature.js';\nexport {default as Geolocation} from './Geolocation.js';\nexport {default as Graticule} from './Graticule.js';\nexport {default as Image} from './Image.js';\nexport {default as ImageBase} from './ImageBase.js';\nexport {default as ImageCanvas} from './ImageCanvas.js';\nexport {default as ImageTile} from './ImageTile.js';\nexport {default as Kinetic} from './Kinetic.js';\nexport {default as Map} from './Map.js';\nexport {default as MapBrowserEvent} from './MapBrowserEvent.js';\nexport {default as MapBrowserEventHandler} from './MapBrowserEventHandler.js';\nexport {default as MapBrowserPointerEvent} from './MapBrowserPointerEvent.js';\nexport {default as MapEvent} from './MapEvent.js';\nexport {default as Object} from './Object.js';\nexport {default as Observable} from './Observable.js';\nexport {default as Overlay} from './Overlay.js';\nexport {default as PluggableMap} from './PluggableMap.js';\nexport {default as Tile} from './Tile.js';\nexport {default as TileCache} from './TileCache.js';\nexport {default as TileQueue} from './TileQueue.js';\nexport {default as TileRange} from './TileRange.js';\nexport {default as VectorImageTile} from './VectorImageTile.js';\nexport {default as VectorTile} from './VectorTile.js';\nexport {default as View} from './View.js';\nexport {default as WebGLMap} from './WebGLMap.js';\n\nexport {getUid, inherits, VERSION} from './util.js';\n\n/**\n * An array with two elements, representing a pixel. The first element is the\n * x-coordinate, the second the y-coordinate of the pixel.\n * @typedef {Array.<number>} Pixel\n * @api\n */\n","/**\n * @module ol/layer/TileProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  PRELOAD: 'preload',\n  USE_INTERIM_TILES_ON_ERROR: 'useInterimTilesOnError'\n};\n","/**\n * @module ol/layer/Tile\n */\nimport {inherits} from '../util.js';\nimport LayerType from '../LayerType.js';\nimport Layer from '../layer/Layer.js';\nimport TileProperty from '../layer/TileProperty.js';\nimport {assign} from '../obj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {module:ol/extent~Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex=0] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {number} [preload=0] Preload. Load low-resolution tiles up to `preload` levels. `0`\n * means no preloading.\n * @property {module:ol/source/Tile} [source] Source for this layer.\n * @property {module:ol/PluggableMap} [map] Sets the layer as overlay on a map. The map will not manage\n * this layer in its layers collection, and the layer will be rendered on top. This is useful for\n * temporary layers. The standard way to add a layer to a map and have it managed by the map is to\n * use {@link module:ol/Map#addLayer}.\n * @property {boolean} [useInterimTilesOnError=true] Use interim tiles on error.\n */\n\n\n/**\n * @classdesc\n * For layer sources that provide pre-rendered, tiled images in grids that are\n * organized by zoom levels for specific resolutions.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @constructor\n * @extends {module:ol/layer/Layer}\n * @fires module:ol/render/Event~RenderEvent\n * @param {module:ol/layer/Tile~Options=} opt_options Tile layer options.\n * @api\n */\nconst TileLayer = function(opt_options) {\n  const options = opt_options ? opt_options : {};\n\n  const baseOptions = assign({}, options);\n\n  delete baseOptions.preload;\n  delete baseOptions.useInterimTilesOnError;\n  Layer.call(this,  /** @type {module:ol/layer/Layer~Options} */ (baseOptions));\n\n  this.setPreload(options.preload !== undefined ? options.preload : 0);\n  this.setUseInterimTilesOnError(options.useInterimTilesOnError !== undefined ?\n    options.useInterimTilesOnError : true);\n\n  /**\n   * The layer type.\n   * @protected\n   * @type {module:ol/LayerType}\n   */\n  this.type = LayerType.TILE;\n\n};\n\ninherits(TileLayer, Layer);\n\n\n/**\n * Return the level as number to which we will preload tiles up to.\n * @return {number} The level to preload tiles up to.\n * @observable\n * @api\n */\nTileLayer.prototype.getPreload = function() {\n  return /** @type {number} */ (this.get(TileProperty.PRELOAD));\n};\n\n\n/**\n * Return the associated {@link module:ol/source/Tile tilesource} of the layer.\n * @function\n * @return {module:ol/source/Tile} Source.\n * @api\n */\nTileLayer.prototype.getSource;\n\n\n/**\n * Set the level as number to which we will preload tiles up to.\n * @param {number} preload The level to preload tiles up to.\n * @observable\n * @api\n */\nTileLayer.prototype.setPreload = function(preload) {\n  this.set(TileProperty.PRELOAD, preload);\n};\n\n\n/**\n * Whether we use interim tiles on error.\n * @return {boolean} Use interim tiles on error.\n * @observable\n * @api\n */\nTileLayer.prototype.getUseInterimTilesOnError = function() {\n  return /** @type {boolean} */ (this.get(TileProperty.USE_INTERIM_TILES_ON_ERROR));\n};\n\n\n/**\n * Set whether we use interim tiles on error.\n * @param {boolean} useInterimTilesOnError Use interim tiles on error.\n * @observable\n * @api\n */\nTileLayer.prototype.setUseInterimTilesOnError = function(useInterimTilesOnError) {\n  this.set(TileProperty.USE_INTERIM_TILES_ON_ERROR, useInterimTilesOnError);\n};\nexport default TileLayer;\n","/**\n * @module ol/reproj\n */\nimport {createCanvasContext2D} from './dom.js';\nimport {containsCoordinate, createEmpty, extend, getHeight, getTopLeft, getWidth} from './extent.js';\nimport {solveLinearSystem} from './math.js';\nimport {getPointResolution, transform} from './proj.js';\n\n\n/**\n * Calculates ideal resolution to use from the source in order to achieve\n * pixel mapping as close as possible to 1:1 during reprojection.\n * The resolution is calculated regardless of what resolutions\n * are actually available in the dataset (TileGrid, Image, ...).\n *\n * @param {module:ol/proj/Projection} sourceProj Source projection.\n * @param {module:ol/proj/Projection} targetProj Target projection.\n * @param {module:ol/coordinate~Coordinate} targetCenter Target center.\n * @param {number} targetResolution Target resolution.\n * @return {number} The best resolution to use. Can be +-Infinity, NaN or 0.\n */\nexport function calculateSourceResolution(sourceProj, targetProj,\n  targetCenter, targetResolution) {\n\n  const sourceCenter = transform(targetCenter, targetProj, sourceProj);\n\n  // calculate the ideal resolution of the source data\n  let sourceResolution = getPointResolution(targetProj, targetResolution, targetCenter);\n\n  const targetMetersPerUnit = targetProj.getMetersPerUnit();\n  if (targetMetersPerUnit !== undefined) {\n    sourceResolution *= targetMetersPerUnit;\n  }\n  const sourceMetersPerUnit = sourceProj.getMetersPerUnit();\n  if (sourceMetersPerUnit !== undefined) {\n    sourceResolution /= sourceMetersPerUnit;\n  }\n\n  // Based on the projection properties, the point resolution at the specified\n  // coordinates may be slightly different. We need to reverse-compensate this\n  // in order to achieve optimal results.\n\n  const sourceExtent = sourceProj.getExtent();\n  if (!sourceExtent || containsCoordinate(sourceExtent, sourceCenter)) {\n    const compensationFactor = getPointResolution(sourceProj, sourceResolution, sourceCenter) /\n        sourceResolution;\n    if (isFinite(compensationFactor) && compensationFactor > 0) {\n      sourceResolution /= compensationFactor;\n    }\n  }\n\n  return sourceResolution;\n}\n\n\n/**\n * Enlarge the clipping triangle point by 1 pixel to ensure the edges overlap\n * in order to mask gaps caused by antialiasing.\n *\n * @param {number} centroidX Centroid of the triangle (x coordinate in pixels).\n * @param {number} centroidY Centroid of the triangle (y coordinate in pixels).\n * @param {number} x X coordinate of the point (in pixels).\n * @param {number} y Y coordinate of the point (in pixels).\n * @return {module:ol/coordinate~Coordinate} New point 1 px farther from the centroid.\n */\nfunction enlargeClipPoint(centroidX, centroidY, x, y) {\n  const dX = x - centroidX;\n  const dY = y - centroidY;\n  const distance = Math.sqrt(dX * dX + dY * dY);\n  return [Math.round(x + dX / distance), Math.round(y + dY / distance)];\n}\n\n\n/**\n * Renders the source data into new canvas based on the triangulation.\n *\n * @param {number} width Width of the canvas.\n * @param {number} height Height of the canvas.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} sourceResolution Source resolution.\n * @param {module:ol/extent~Extent} sourceExtent Extent of the data source.\n * @param {number} targetResolution Target resolution.\n * @param {module:ol/extent~Extent} targetExtent Target extent.\n * @param {module:ol/reproj/Triangulation} triangulation\n * Calculated triangulation.\n * @param {Array.<{extent: module:ol/extent~Extent,\n *                 image: (HTMLCanvasElement|Image|HTMLVideoElement)}>} sources\n * Array of sources.\n * @param {number} gutter Gutter of the sources.\n * @param {boolean=} opt_renderEdges Render reprojection edges.\n * @return {HTMLCanvasElement} Canvas with reprojected data.\n */\nexport function render(width, height, pixelRatio,\n  sourceResolution, sourceExtent, targetResolution, targetExtent,\n  triangulation, sources, gutter, opt_renderEdges) {\n\n  const context = createCanvasContext2D(Math.round(pixelRatio * width),\n    Math.round(pixelRatio * height));\n\n  if (sources.length === 0) {\n    return context.canvas;\n  }\n\n  context.scale(pixelRatio, pixelRatio);\n\n  const sourceDataExtent = createEmpty();\n  sources.forEach(function(src, i, arr) {\n    extend(sourceDataExtent, src.extent);\n  });\n\n  const canvasWidthInUnits = getWidth(sourceDataExtent);\n  const canvasHeightInUnits = getHeight(sourceDataExtent);\n  const stitchContext = createCanvasContext2D(\n    Math.round(pixelRatio * canvasWidthInUnits / sourceResolution),\n    Math.round(pixelRatio * canvasHeightInUnits / sourceResolution));\n\n  const stitchScale = pixelRatio / sourceResolution;\n\n  sources.forEach(function(src, i, arr) {\n    const xPos = src.extent[0] - sourceDataExtent[0];\n    const yPos = -(src.extent[3] - sourceDataExtent[3]);\n    const srcWidth = getWidth(src.extent);\n    const srcHeight = getHeight(src.extent);\n\n    stitchContext.drawImage(\n      src.image,\n      gutter, gutter,\n      src.image.width - 2 * gutter, src.image.height - 2 * gutter,\n      xPos * stitchScale, yPos * stitchScale,\n      srcWidth * stitchScale, srcHeight * stitchScale);\n  });\n\n  const targetTopLeft = getTopLeft(targetExtent);\n\n  triangulation.getTriangles().forEach(function(triangle, i, arr) {\n    /* Calculate affine transform (src -> dst)\n     * Resulting matrix can be used to transform coordinate\n     * from `sourceProjection` to destination pixels.\n     *\n     * To optimize number of context calls and increase numerical stability,\n     * we also do the following operations:\n     * trans(-topLeftExtentCorner), scale(1 / targetResolution), scale(1, -1)\n     * here before solving the linear system so [ui, vi] are pixel coordinates.\n     *\n     * Src points: xi, yi\n     * Dst points: ui, vi\n     * Affine coefficients: aij\n     *\n     * | x0 y0 1  0  0 0 |   |a00|   |u0|\n     * | x1 y1 1  0  0 0 |   |a01|   |u1|\n     * | x2 y2 1  0  0 0 | x |a02| = |u2|\n     * |  0  0 0 x0 y0 1 |   |a10|   |v0|\n     * |  0  0 0 x1 y1 1 |   |a11|   |v1|\n     * |  0  0 0 x2 y2 1 |   |a12|   |v2|\n     */\n    const source = triangle.source;\n    const target = triangle.target;\n    let x0 = source[0][0], y0 = source[0][1];\n    let x1 = source[1][0], y1 = source[1][1];\n    let x2 = source[2][0], y2 = source[2][1];\n    const u0 = (target[0][0] - targetTopLeft[0]) / targetResolution;\n    const v0 = -(target[0][1] - targetTopLeft[1]) / targetResolution;\n    const u1 = (target[1][0] - targetTopLeft[0]) / targetResolution;\n    const v1 = -(target[1][1] - targetTopLeft[1]) / targetResolution;\n    const u2 = (target[2][0] - targetTopLeft[0]) / targetResolution;\n    const v2 = -(target[2][1] - targetTopLeft[1]) / targetResolution;\n\n    // Shift all the source points to improve numerical stability\n    // of all the subsequent calculations. The [x0, y0] is used here.\n    // This is also used to simplify the linear system.\n    const sourceNumericalShiftX = x0;\n    const sourceNumericalShiftY = y0;\n    x0 = 0;\n    y0 = 0;\n    x1 -= sourceNumericalShiftX;\n    y1 -= sourceNumericalShiftY;\n    x2 -= sourceNumericalShiftX;\n    y2 -= sourceNumericalShiftY;\n\n    const augmentedMatrix = [\n      [x1, y1, 0, 0, u1 - u0],\n      [x2, y2, 0, 0, u2 - u0],\n      [0, 0, x1, y1, v1 - v0],\n      [0, 0, x2, y2, v2 - v0]\n    ];\n    const affineCoefs = solveLinearSystem(augmentedMatrix);\n    if (!affineCoefs) {\n      return;\n    }\n\n    context.save();\n    context.beginPath();\n    const centroidX = (u0 + u1 + u2) / 3;\n    const centroidY = (v0 + v1 + v2) / 3;\n    const p0 = enlargeClipPoint(centroidX, centroidY, u0, v0);\n    const p1 = enlargeClipPoint(centroidX, centroidY, u1, v1);\n    const p2 = enlargeClipPoint(centroidX, centroidY, u2, v2);\n\n    context.moveTo(p1[0], p1[1]);\n    context.lineTo(p0[0], p0[1]);\n    context.lineTo(p2[0], p2[1]);\n    context.clip();\n\n    context.transform(\n      affineCoefs[0], affineCoefs[2], affineCoefs[1], affineCoefs[3], u0, v0);\n\n    context.translate(sourceDataExtent[0] - sourceNumericalShiftX,\n      sourceDataExtent[3] - sourceNumericalShiftY);\n\n    context.scale(sourceResolution / pixelRatio,\n      -sourceResolution / pixelRatio);\n\n    context.drawImage(stitchContext.canvas, 0, 0);\n    context.restore();\n  });\n\n  if (opt_renderEdges) {\n    context.save();\n\n    context.strokeStyle = 'black';\n    context.lineWidth = 1;\n\n    triangulation.getTriangles().forEach(function(triangle, i, arr) {\n      const target = triangle.target;\n      const u0 = (target[0][0] - targetTopLeft[0]) / targetResolution;\n      const v0 = -(target[0][1] - targetTopLeft[1]) / targetResolution;\n      const u1 = (target[1][0] - targetTopLeft[0]) / targetResolution;\n      const v1 = -(target[1][1] - targetTopLeft[1]) / targetResolution;\n      const u2 = (target[2][0] - targetTopLeft[0]) / targetResolution;\n      const v2 = -(target[2][1] - targetTopLeft[1]) / targetResolution;\n\n      context.beginPath();\n      context.moveTo(u1, v1);\n      context.lineTo(u0, v0);\n      context.lineTo(u2, v2);\n      context.closePath();\n      context.stroke();\n    });\n\n    context.restore();\n  }\n  return context.canvas;\n}\n","/**\n * @module ol/reproj/Triangulation\n */\nimport {boundingExtent, createEmpty, extendCoordinate, getBottomLeft, getBottomRight,\n  getTopLeft, getTopRight, getWidth, intersects} from '../extent.js';\nimport {modulo} from '../math.js';\nimport {getTransform} from '../proj.js';\n\n\n/**\n * Single triangle; consists of 3 source points and 3 target points.\n * @typedef {Object} Triangle\n * @property {Array.<module:ol/coordinate~Coordinate>} source\n * @property {Array.<module:ol/coordinate~Coordinate>} target\n */\n\n\n/**\n * Maximum number of subdivision steps during raster reprojection triangulation.\n * Prevents high memory usage and large number of proj4 calls (for certain\n * transformations and areas). At most `2*(2^this)` triangles are created for\n * each triangulated extent (tile/image).\n * @type {number}\n */\nconst MAX_SUBDIVISION = 10;\n\n\n/**\n * Maximum allowed size of triangle relative to world width. When transforming\n * corners of world extent between certain projections, the resulting\n * triangulation seems to have zero error and no subdivision is performed. If\n * the triangle width is more than this (relative to world width; 0-1),\n * subdivison is forced (up to `MAX_SUBDIVISION`). Default is `0.25`.\n * @type {number}\n */\nconst MAX_TRIANGLE_WIDTH = 0.25;\n\n\n/**\n * @classdesc\n * Class containing triangulation of the given target extent.\n * Used for determining source data and the reprojection itself.\n *\n * @param {module:ol/proj/Projection} sourceProj Source projection.\n * @param {module:ol/proj/Projection} targetProj Target projection.\n * @param {module:ol/extent~Extent} targetExtent Target extent to triangulate.\n * @param {module:ol/extent~Extent} maxSourceExtent Maximal source extent that can be used.\n * @param {number} errorThreshold Acceptable error (in source units).\n * @constructor\n */\nconst Triangulation = function(sourceProj, targetProj, targetExtent,\n  maxSourceExtent, errorThreshold) {\n\n  /**\n   * @type {module:ol/proj/Projection}\n   * @private\n   */\n  this.sourceProj_ = sourceProj;\n\n  /**\n   * @type {module:ol/proj/Projection}\n   * @private\n   */\n  this.targetProj_ = targetProj;\n\n  /** @type {!Object.<string, module:ol/coordinate~Coordinate>} */\n  let transformInvCache = {};\n  const transformInv = getTransform(this.targetProj_, this.sourceProj_);\n\n  /**\n   * @param {module:ol/coordinate~Coordinate} c A coordinate.\n   * @return {module:ol/coordinate~Coordinate} Transformed coordinate.\n   * @private\n   */\n  this.transformInv_ = function(c) {\n    const key = c[0] + '/' + c[1];\n    if (!transformInvCache[key]) {\n      transformInvCache[key] = transformInv(c);\n    }\n    return transformInvCache[key];\n  };\n\n  /**\n   * @type {module:ol/extent~Extent}\n   * @private\n   */\n  this.maxSourceExtent_ = maxSourceExtent;\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.errorThresholdSquared_ = errorThreshold * errorThreshold;\n\n  /**\n   * @type {Array.<module:ol/reproj/Triangulation~Triangle>}\n   * @private\n   */\n  this.triangles_ = [];\n\n  /**\n   * Indicates that the triangulation crosses edge of the source projection.\n   * @type {boolean}\n   * @private\n   */\n  this.wrapsXInSource_ = false;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.canWrapXInSource_ = this.sourceProj_.canWrapX() &&\n      !!maxSourceExtent &&\n      !!this.sourceProj_.getExtent() &&\n      (getWidth(maxSourceExtent) == getWidth(this.sourceProj_.getExtent()));\n\n  /**\n   * @type {?number}\n   * @private\n   */\n  this.sourceWorldWidth_ = this.sourceProj_.getExtent() ?\n    getWidth(this.sourceProj_.getExtent()) : null;\n\n  /**\n   * @type {?number}\n   * @private\n   */\n  this.targetWorldWidth_ = this.targetProj_.getExtent() ?\n    getWidth(this.targetProj_.getExtent()) : null;\n\n  const destinationTopLeft = getTopLeft(targetExtent);\n  const destinationTopRight = getTopRight(targetExtent);\n  const destinationBottomRight = getBottomRight(targetExtent);\n  const destinationBottomLeft = getBottomLeft(targetExtent);\n  const sourceTopLeft = this.transformInv_(destinationTopLeft);\n  const sourceTopRight = this.transformInv_(destinationTopRight);\n  const sourceBottomRight = this.transformInv_(destinationBottomRight);\n  const sourceBottomLeft = this.transformInv_(destinationBottomLeft);\n\n  this.addQuad_(\n    destinationTopLeft, destinationTopRight,\n    destinationBottomRight, destinationBottomLeft,\n    sourceTopLeft, sourceTopRight, sourceBottomRight, sourceBottomLeft,\n    MAX_SUBDIVISION);\n\n  if (this.wrapsXInSource_) {\n    let leftBound = Infinity;\n    this.triangles_.forEach(function(triangle, i, arr) {\n      leftBound = Math.min(leftBound,\n        triangle.source[0][0], triangle.source[1][0], triangle.source[2][0]);\n    });\n\n    // Shift triangles to be as close to `leftBound` as possible\n    // (if the distance is more than `worldWidth / 2` it can be closer.\n    this.triangles_.forEach(function(triangle) {\n      if (Math.max(triangle.source[0][0], triangle.source[1][0],\n        triangle.source[2][0]) - leftBound > this.sourceWorldWidth_ / 2) {\n        const newTriangle = [[triangle.source[0][0], triangle.source[0][1]],\n          [triangle.source[1][0], triangle.source[1][1]],\n          [triangle.source[2][0], triangle.source[2][1]]];\n        if ((newTriangle[0][0] - leftBound) > this.sourceWorldWidth_ / 2) {\n          newTriangle[0][0] -= this.sourceWorldWidth_;\n        }\n        if ((newTriangle[1][0] - leftBound) > this.sourceWorldWidth_ / 2) {\n          newTriangle[1][0] -= this.sourceWorldWidth_;\n        }\n        if ((newTriangle[2][0] - leftBound) > this.sourceWorldWidth_ / 2) {\n          newTriangle[2][0] -= this.sourceWorldWidth_;\n        }\n\n        // Rarely (if the extent contains both the dateline and prime meridian)\n        // the shift can in turn break some triangles.\n        // Detect this here and don't shift in such cases.\n        const minX = Math.min(\n          newTriangle[0][0], newTriangle[1][0], newTriangle[2][0]);\n        const maxX = Math.max(\n          newTriangle[0][0], newTriangle[1][0], newTriangle[2][0]);\n        if ((maxX - minX) < this.sourceWorldWidth_ / 2) {\n          triangle.source = newTriangle;\n        }\n      }\n    }.bind(this));\n  }\n\n  transformInvCache = {};\n};\n\n\n/**\n * Adds triangle to the triangulation.\n * @param {module:ol/coordinate~Coordinate} a The target a coordinate.\n * @param {module:ol/coordinate~Coordinate} b The target b coordinate.\n * @param {module:ol/coordinate~Coordinate} c The target c coordinate.\n * @param {module:ol/coordinate~Coordinate} aSrc The source a coordinate.\n * @param {module:ol/coordinate~Coordinate} bSrc The source b coordinate.\n * @param {module:ol/coordinate~Coordinate} cSrc The source c coordinate.\n * @private\n */\nTriangulation.prototype.addTriangle_ = function(a, b, c,\n  aSrc, bSrc, cSrc) {\n  this.triangles_.push({\n    source: [aSrc, bSrc, cSrc],\n    target: [a, b, c]\n  });\n};\n\n\n/**\n * Adds quad (points in clock-wise order) to the triangulation\n * (and reprojects the vertices) if valid.\n * Performs quad subdivision if needed to increase precision.\n *\n * @param {module:ol/coordinate~Coordinate} a The target a coordinate.\n * @param {module:ol/coordinate~Coordinate} b The target b coordinate.\n * @param {module:ol/coordinate~Coordinate} c The target c coordinate.\n * @param {module:ol/coordinate~Coordinate} d The target d coordinate.\n * @param {module:ol/coordinate~Coordinate} aSrc The source a coordinate.\n * @param {module:ol/coordinate~Coordinate} bSrc The source b coordinate.\n * @param {module:ol/coordinate~Coordinate} cSrc The source c coordinate.\n * @param {module:ol/coordinate~Coordinate} dSrc The source d coordinate.\n * @param {number} maxSubdivision Maximal allowed subdivision of the quad.\n * @private\n */\nTriangulation.prototype.addQuad_ = function(a, b, c, d,\n  aSrc, bSrc, cSrc, dSrc, maxSubdivision) {\n\n  const sourceQuadExtent = boundingExtent([aSrc, bSrc, cSrc, dSrc]);\n  const sourceCoverageX = this.sourceWorldWidth_ ?\n    getWidth(sourceQuadExtent) / this.sourceWorldWidth_ : null;\n  const sourceWorldWidth = /** @type {number} */ (this.sourceWorldWidth_);\n\n  // when the quad is wrapped in the source projection\n  // it covers most of the projection extent, but not fully\n  const wrapsX = this.sourceProj_.canWrapX() &&\n               sourceCoverageX > 0.5 && sourceCoverageX < 1;\n\n  let needsSubdivision = false;\n\n  if (maxSubdivision > 0) {\n    if (this.targetProj_.isGlobal() && this.targetWorldWidth_) {\n      const targetQuadExtent = boundingExtent([a, b, c, d]);\n      const targetCoverageX = getWidth(targetQuadExtent) / this.targetWorldWidth_;\n      needsSubdivision |=\n          targetCoverageX > MAX_TRIANGLE_WIDTH;\n    }\n    if (!wrapsX && this.sourceProj_.isGlobal() && sourceCoverageX) {\n      needsSubdivision |=\n          sourceCoverageX > MAX_TRIANGLE_WIDTH;\n    }\n  }\n\n  if (!needsSubdivision && this.maxSourceExtent_) {\n    if (!intersects(sourceQuadExtent, this.maxSourceExtent_)) {\n      // whole quad outside source projection extent -> ignore\n      return;\n    }\n  }\n\n  if (!needsSubdivision) {\n    if (!isFinite(aSrc[0]) || !isFinite(aSrc[1]) ||\n        !isFinite(bSrc[0]) || !isFinite(bSrc[1]) ||\n        !isFinite(cSrc[0]) || !isFinite(cSrc[1]) ||\n        !isFinite(dSrc[0]) || !isFinite(dSrc[1])) {\n      if (maxSubdivision > 0) {\n        needsSubdivision = true;\n      } else {\n        return;\n      }\n    }\n  }\n\n  if (maxSubdivision > 0) {\n    if (!needsSubdivision) {\n      const center = [(a[0] + c[0]) / 2, (a[1] + c[1]) / 2];\n      const centerSrc = this.transformInv_(center);\n\n      let dx;\n      if (wrapsX) {\n        const centerSrcEstimX =\n            (modulo(aSrc[0], sourceWorldWidth) +\n             modulo(cSrc[0], sourceWorldWidth)) / 2;\n        dx = centerSrcEstimX -\n            modulo(centerSrc[0], sourceWorldWidth);\n      } else {\n        dx = (aSrc[0] + cSrc[0]) / 2 - centerSrc[0];\n      }\n      const dy = (aSrc[1] + cSrc[1]) / 2 - centerSrc[1];\n      const centerSrcErrorSquared = dx * dx + dy * dy;\n      needsSubdivision = centerSrcErrorSquared > this.errorThresholdSquared_;\n    }\n    if (needsSubdivision) {\n      if (Math.abs(a[0] - c[0]) <= Math.abs(a[1] - c[1])) {\n        // split horizontally (top & bottom)\n        const bc = [(b[0] + c[0]) / 2, (b[1] + c[1]) / 2];\n        const bcSrc = this.transformInv_(bc);\n        const da = [(d[0] + a[0]) / 2, (d[1] + a[1]) / 2];\n        const daSrc = this.transformInv_(da);\n\n        this.addQuad_(\n          a, b, bc, da, aSrc, bSrc, bcSrc, daSrc, maxSubdivision - 1);\n        this.addQuad_(\n          da, bc, c, d, daSrc, bcSrc, cSrc, dSrc, maxSubdivision - 1);\n      } else {\n        // split vertically (left & right)\n        const ab = [(a[0] + b[0]) / 2, (a[1] + b[1]) / 2];\n        const abSrc = this.transformInv_(ab);\n        const cd = [(c[0] + d[0]) / 2, (c[1] + d[1]) / 2];\n        const cdSrc = this.transformInv_(cd);\n\n        this.addQuad_(\n          a, ab, cd, d, aSrc, abSrc, cdSrc, dSrc, maxSubdivision - 1);\n        this.addQuad_(\n          ab, b, c, cd, abSrc, bSrc, cSrc, cdSrc, maxSubdivision - 1);\n      }\n      return;\n    }\n  }\n\n  if (wrapsX) {\n    if (!this.canWrapXInSource_) {\n      return;\n    }\n    this.wrapsXInSource_ = true;\n  }\n\n  this.addTriangle_(a, c, d, aSrc, cSrc, dSrc);\n  this.addTriangle_(a, b, c, aSrc, bSrc, cSrc);\n};\n\n\n/**\n * Calculates extent of the 'source' coordinates from all the triangles.\n *\n * @return {module:ol/extent~Extent} Calculated extent.\n */\nTriangulation.prototype.calculateSourceExtent = function() {\n  const extent = createEmpty();\n\n  this.triangles_.forEach(function(triangle, i, arr) {\n    const src = triangle.source;\n    extendCoordinate(extent, src[0]);\n    extendCoordinate(extent, src[1]);\n    extendCoordinate(extent, src[2]);\n  });\n\n  return extent;\n};\n\n\n/**\n * @return {Array.<module:ol/reproj/Triangulation~Triangle>} Array of the calculated triangles.\n */\nTriangulation.prototype.getTriangles = function() {\n  return this.triangles_;\n};\nexport default Triangulation;\n","/**\n * @module ol/reproj/Tile\n */\nimport {ERROR_THRESHOLD} from './common.js';\nimport {inherits} from '../util.js';\nimport Tile from '../Tile.js';\nimport TileState from '../TileState.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getArea, getCenter, getIntersection} from '../extent.js';\nimport {clamp} from '../math.js';\nimport {calculateSourceResolution, render as renderReprojected} from '../reproj.js';\nimport Triangulation from '../reproj/Triangulation.js';\n\n\n/**\n * @typedef {function(number, number, number, number) : module:ol/Tile} FunctionType\n */\n\n\n/**\n * @classdesc\n * Class encapsulating single reprojected tile.\n * See {@link module:ol/source/TileImage~TileImage}.\n *\n * @constructor\n * @extends {module:ol/Tile}\n * @param {module:ol/proj/Projection} sourceProj Source projection.\n * @param {module:ol/tilegrid/TileGrid} sourceTileGrid Source tile grid.\n * @param {module:ol/proj/Projection} targetProj Target projection.\n * @param {module:ol/tilegrid/TileGrid} targetTileGrid Target tile grid.\n * @param {module:ol/tilecoord~TileCoord} tileCoord Coordinate of the tile.\n * @param {module:ol/tilecoord~TileCoord} wrappedTileCoord Coordinate of the tile wrapped in X.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} gutter Gutter of the source tiles.\n * @param {module:ol/reproj/Tile~FunctionType} getTileFunction\n *     Function returning source tiles (z, x, y, pixelRatio).\n * @param {number=} opt_errorThreshold Acceptable reprojection error (in px).\n * @param {boolean=} opt_renderEdges Render reprojection edges.\n */\nconst ReprojTile = function(sourceProj, sourceTileGrid,\n  targetProj, targetTileGrid, tileCoord, wrappedTileCoord,\n  pixelRatio, gutter, getTileFunction,\n  opt_errorThreshold, opt_renderEdges) {\n  Tile.call(this, tileCoord, TileState.IDLE);\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.renderEdges_ = opt_renderEdges !== undefined ? opt_renderEdges : false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.pixelRatio_ = pixelRatio;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.gutter_ = gutter;\n\n  /**\n   * @private\n   * @type {HTMLCanvasElement}\n   */\n  this.canvas_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/tilegrid/TileGrid}\n   */\n  this.sourceTileGrid_ = sourceTileGrid;\n\n  /**\n   * @private\n   * @type {module:ol/tilegrid/TileGrid}\n   */\n  this.targetTileGrid_ = targetTileGrid;\n\n  /**\n   * @private\n   * @type {module:ol/tilecoord~TileCoord}\n   */\n  this.wrappedTileCoord_ = wrappedTileCoord ? wrappedTileCoord : tileCoord;\n\n  /**\n   * @private\n   * @type {!Array.<module:ol/Tile>}\n   */\n  this.sourceTiles_ = [];\n\n  /**\n   * @private\n   * @type {Array.<module:ol/events~EventsKey>}\n   */\n  this.sourcesListenerKeys_ = null;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.sourceZ_ = 0;\n\n  const targetExtent = targetTileGrid.getTileCoordExtent(this.wrappedTileCoord_);\n  const maxTargetExtent = this.targetTileGrid_.getExtent();\n  let maxSourceExtent = this.sourceTileGrid_.getExtent();\n\n  const limitedTargetExtent = maxTargetExtent ?\n    getIntersection(targetExtent, maxTargetExtent) : targetExtent;\n\n  if (getArea(limitedTargetExtent) === 0) {\n    // Tile is completely outside range -> EMPTY\n    // TODO: is it actually correct that the source even creates the tile ?\n    this.state = TileState.EMPTY;\n    return;\n  }\n\n  const sourceProjExtent = sourceProj.getExtent();\n  if (sourceProjExtent) {\n    if (!maxSourceExtent) {\n      maxSourceExtent = sourceProjExtent;\n    } else {\n      maxSourceExtent = getIntersection(maxSourceExtent, sourceProjExtent);\n    }\n  }\n\n  const targetResolution = targetTileGrid.getResolution(\n    this.wrappedTileCoord_[0]);\n\n  const targetCenter = getCenter(limitedTargetExtent);\n  const sourceResolution = calculateSourceResolution(\n    sourceProj, targetProj, targetCenter, targetResolution);\n\n  if (!isFinite(sourceResolution) || sourceResolution <= 0) {\n    // invalid sourceResolution -> EMPTY\n    // probably edges of the projections when no extent is defined\n    this.state = TileState.EMPTY;\n    return;\n  }\n\n  const errorThresholdInPixels = opt_errorThreshold !== undefined ?\n    opt_errorThreshold : ERROR_THRESHOLD;\n\n  /**\n   * @private\n   * @type {!module:ol/reproj/Triangulation}\n   */\n  this.triangulation_ = new Triangulation(\n    sourceProj, targetProj, limitedTargetExtent, maxSourceExtent,\n    sourceResolution * errorThresholdInPixels);\n\n  if (this.triangulation_.getTriangles().length === 0) {\n    // no valid triangles -> EMPTY\n    this.state = TileState.EMPTY;\n    return;\n  }\n\n  this.sourceZ_ = sourceTileGrid.getZForResolution(sourceResolution);\n  let sourceExtent = this.triangulation_.calculateSourceExtent();\n\n  if (maxSourceExtent) {\n    if (sourceProj.canWrapX()) {\n      sourceExtent[1] = clamp(\n        sourceExtent[1], maxSourceExtent[1], maxSourceExtent[3]);\n      sourceExtent[3] = clamp(\n        sourceExtent[3], maxSourceExtent[1], maxSourceExtent[3]);\n    } else {\n      sourceExtent = getIntersection(sourceExtent, maxSourceExtent);\n    }\n  }\n\n  if (!getArea(sourceExtent)) {\n    this.state = TileState.EMPTY;\n  } else {\n    const sourceRange = sourceTileGrid.getTileRangeForExtentAndZ(\n      sourceExtent, this.sourceZ_);\n\n    for (let srcX = sourceRange.minX; srcX <= sourceRange.maxX; srcX++) {\n      for (let srcY = sourceRange.minY; srcY <= sourceRange.maxY; srcY++) {\n        const tile = getTileFunction(this.sourceZ_, srcX, srcY, pixelRatio);\n        if (tile) {\n          this.sourceTiles_.push(tile);\n        }\n      }\n    }\n\n    if (this.sourceTiles_.length === 0) {\n      this.state = TileState.EMPTY;\n    }\n  }\n};\n\ninherits(ReprojTile, Tile);\n\n\n/**\n * @inheritDoc\n */\nReprojTile.prototype.disposeInternal = function() {\n  if (this.state == TileState.LOADING) {\n    this.unlistenSources_();\n  }\n  Tile.prototype.disposeInternal.call(this);\n};\n\n\n/**\n * Get the HTML Canvas element for this tile.\n * @return {HTMLCanvasElement} Canvas.\n */\nReprojTile.prototype.getImage = function() {\n  return this.canvas_;\n};\n\n\n/**\n * @private\n */\nReprojTile.prototype.reproject_ = function() {\n  const sources = [];\n  this.sourceTiles_.forEach(function(tile, i, arr) {\n    if (tile && tile.getState() == TileState.LOADED) {\n      sources.push({\n        extent: this.sourceTileGrid_.getTileCoordExtent(tile.tileCoord),\n        image: tile.getImage()\n      });\n    }\n  }.bind(this));\n  this.sourceTiles_.length = 0;\n\n  if (sources.length === 0) {\n    this.state = TileState.ERROR;\n  } else {\n    const z = this.wrappedTileCoord_[0];\n    const size = this.targetTileGrid_.getTileSize(z);\n    const width = typeof size === 'number' ? size : size[0];\n    const height = typeof size === 'number' ? size : size[1];\n    const targetResolution = this.targetTileGrid_.getResolution(z);\n    const sourceResolution = this.sourceTileGrid_.getResolution(this.sourceZ_);\n\n    const targetExtent = this.targetTileGrid_.getTileCoordExtent(\n      this.wrappedTileCoord_);\n    this.canvas_ = renderReprojected(width, height, this.pixelRatio_,\n      sourceResolution, this.sourceTileGrid_.getExtent(),\n      targetResolution, targetExtent, this.triangulation_, sources,\n      this.gutter_, this.renderEdges_);\n\n    this.state = TileState.LOADED;\n  }\n  this.changed();\n};\n\n\n/**\n * @inheritDoc\n */\nReprojTile.prototype.load = function() {\n  if (this.state == TileState.IDLE) {\n    this.state = TileState.LOADING;\n    this.changed();\n\n    let leftToLoad = 0;\n\n    this.sourcesListenerKeys_ = [];\n    this.sourceTiles_.forEach(function(tile, i, arr) {\n      const state = tile.getState();\n      if (state == TileState.IDLE || state == TileState.LOADING) {\n        leftToLoad++;\n\n        const sourceListenKey = listen(tile, EventType.CHANGE,\n          function(e) {\n            const state = tile.getState();\n            if (state == TileState.LOADED ||\n                  state == TileState.ERROR ||\n                  state == TileState.EMPTY) {\n              unlistenByKey(sourceListenKey);\n              leftToLoad--;\n              if (leftToLoad === 0) {\n                this.unlistenSources_();\n                this.reproject_();\n              }\n            }\n          }, this);\n        this.sourcesListenerKeys_.push(sourceListenKey);\n      }\n    }.bind(this));\n\n    this.sourceTiles_.forEach(function(tile, i, arr) {\n      const state = tile.getState();\n      if (state == TileState.IDLE) {\n        tile.load();\n      }\n    });\n\n    if (leftToLoad === 0) {\n      setTimeout(this.reproject_.bind(this), 0);\n    }\n  }\n};\n\n\n/**\n * @private\n */\nReprojTile.prototype.unlistenSources_ = function() {\n  this.sourcesListenerKeys_.forEach(unlistenByKey);\n  this.sourcesListenerKeys_ = null;\n};\nexport default ReprojTile;\n","/**\n * @module ol/tileurlfunction\n */\nimport {assert} from './asserts.js';\nimport {modulo} from './math.js';\nimport {hash as tileCoordHash} from './tilecoord.js';\n\n\n/**\n * @param {string} template Template.\n * @param {module:ol/tilegrid/TileGrid} tileGrid Tile grid.\n * @return {module:ol/Tile~UrlFunction} Tile URL function.\n */\nexport function createFromTemplate(template, tileGrid) {\n  const zRegEx = /\\{z\\}/g;\n  const xRegEx = /\\{x\\}/g;\n  const yRegEx = /\\{y\\}/g;\n  const dashYRegEx = /\\{-y\\}/g;\n  return (\n    /**\n     * @param {module:ol/tilecoord~TileCoord} tileCoord Tile Coordinate.\n     * @param {number} pixelRatio Pixel ratio.\n     * @param {module:ol/proj/Projection} projection Projection.\n     * @return {string|undefined} Tile URL.\n     */\n    function(tileCoord, pixelRatio, projection) {\n      if (!tileCoord) {\n        return undefined;\n      } else {\n        return template.replace(zRegEx, tileCoord[0].toString())\n          .replace(xRegEx, tileCoord[1].toString())\n          .replace(yRegEx, function() {\n            const y = -tileCoord[2] - 1;\n            return y.toString();\n          })\n          .replace(dashYRegEx, function() {\n            const z = tileCoord[0];\n            const range = tileGrid.getFullTileRange(z);\n            assert(range, 55); // The {-y} placeholder requires a tile grid with extent\n            const y = range.getHeight() + tileCoord[2];\n            return y.toString();\n          });\n      }\n    }\n  );\n}\n\n\n/**\n * @param {Array.<string>} templates Templates.\n * @param {module:ol/tilegrid/TileGrid} tileGrid Tile grid.\n * @return {module:ol/Tile~UrlFunction} Tile URL function.\n */\nexport function createFromTemplates(templates, tileGrid) {\n  const len = templates.length;\n  const tileUrlFunctions = new Array(len);\n  for (let i = 0; i < len; ++i) {\n    tileUrlFunctions[i] = createFromTemplate(templates[i], tileGrid);\n  }\n  return createFromTileUrlFunctions(tileUrlFunctions);\n}\n\n\n/**\n * @param {Array.<module:ol/Tile~UrlFunction>} tileUrlFunctions Tile URL Functions.\n * @return {module:ol/Tile~UrlFunction} Tile URL function.\n */\nexport function createFromTileUrlFunctions(tileUrlFunctions) {\n  if (tileUrlFunctions.length === 1) {\n    return tileUrlFunctions[0];\n  }\n  return (\n    /**\n     * @param {module:ol/tilecoord~TileCoord} tileCoord Tile Coordinate.\n     * @param {number} pixelRatio Pixel ratio.\n     * @param {module:ol/proj/Projection} projection Projection.\n     * @return {string|undefined} Tile URL.\n     */\n    function(tileCoord, pixelRatio, projection) {\n      if (!tileCoord) {\n        return undefined;\n      } else {\n        const h = tileCoordHash(tileCoord);\n        const index = modulo(h, tileUrlFunctions.length);\n        return tileUrlFunctions[index](tileCoord, pixelRatio, projection);\n      }\n    }\n  );\n}\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {string|undefined} Tile URL.\n */\nexport function nullTileUrlFunction(tileCoord, pixelRatio, projection) {\n  return undefined;\n}\n\n\n/**\n * @param {string} url URL.\n * @return {Array.<string>} Array of urls.\n */\nexport function expandUrl(url) {\n  const urls = [];\n  let match = /\\{([a-z])-([a-z])\\}/.exec(url);\n  if (match) {\n    // char range\n    const startCharCode = match[1].charCodeAt(0);\n    const stopCharCode = match[2].charCodeAt(0);\n    let charCode;\n    for (charCode = startCharCode; charCode <= stopCharCode; ++charCode) {\n      urls.push(url.replace(match[0], String.fromCharCode(charCode)));\n    }\n    return urls;\n  }\n  match = match = /\\{(\\d+)-(\\d+)\\}/.exec(url);\n  if (match) {\n    // number range\n    const stop = parseInt(match[2], 10);\n    for (let i = parseInt(match[1], 10); i <= stop; i++) {\n      urls.push(url.replace(match[0], i.toString()));\n    }\n    return urls;\n  }\n  urls.push(url);\n  return urls;\n}\n","/**\n * @module ol/tilegrid/TileGrid\n */\nimport {DEFAULT_TILE_SIZE} from './common.js';\nimport {assert} from '../asserts.js';\nimport TileRange, {createOrUpdate as createOrUpdateTileRange} from '../TileRange.js';\nimport {isSorted, linearFindNearest} from '../array.js';\nimport {createOrUpdate, getTopLeft} from '../extent.js';\nimport {clamp} from '../math.js';\nimport {toSize} from '../size.js';\nimport {createOrUpdate as createOrUpdateTileCoord} from '../tilecoord.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/extent~Extent} [extent] Extent for the tile grid. No tiles outside this\n * extent will be requested by {@link module:ol/source/Tile} sources. When no `origin` or\n * `origins` are configured, the `origin` will be set to the top-left corner of the extent.\n * @property {number} [minZoom=0] Minimum zoom.\n * @property {module:ol/coordinate~Coordinate} [origin] The tile grid origin, i.e. where the `x`\n * and `y` axes meet (`[z, 0, 0]`). Tile coordinates increase left to right and upwards. If not\n * specified, `extent` or `origins` must be provided.\n * @property {Array.<module:ol/coordinate~Coordinate>} [origins] Tile grid origins, i.e. where\n * the `x` and `y` axes meet (`[z, 0, 0]`), for each zoom level. If given, the array length\n * should match the length of the `resolutions` array, i.e. each resolution can have a different\n * origin. Tile coordinates increase left to right and upwards. If not specified, `extent` or\n * `origin` must be provided.\n * @property {!Array.<number>} resolutions Resolutions. The array index of each resolution needs\n * to match the zoom level. This means that even if a `minZoom` is configured, the resolutions\n * array will have a length of `maxZoom + 1`.\n * @property {Array.<module:ol/size~Size>} [sizes] Sizes.\n * @property {number|module:ol/size~Size} [tileSize] Tile size.\n * Default is `[256, 256]`.\n * @property {Array.<module:ol/size~Size>} [tileSizes] Tile sizes. If given, the array length\n * should match the length of the `resolutions` array, i.e. each resolution can have a different\n * tile size.\n */\n\n\n/**\n * @classdesc\n * Base class for setting the grid pattern for sources accessing tiled-image\n * servers.\n *\n * @constructor\n * @param {module:ol/tilegrid/TileGrid~Options} options Tile grid options.\n * @struct\n * @api\n */\nconst TileGrid = function(options) {\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.minZoom = options.minZoom !== undefined ? options.minZoom : 0;\n\n  /**\n   * @private\n   * @type {!Array.<number>}\n   */\n  this.resolutions_ = options.resolutions;\n  assert(isSorted(this.resolutions_, function(a, b) {\n    return b - a;\n  }, true), 17); // `resolutions` must be sorted in descending order\n\n\n  // check if we've got a consistent zoom factor and origin\n  let zoomFactor;\n  if (!options.origins) {\n    for (let i = 0, ii = this.resolutions_.length - 1; i < ii; ++i) {\n      if (!zoomFactor) {\n        zoomFactor = this.resolutions_[i] / this.resolutions_[i + 1];\n      } else {\n        if (this.resolutions_[i] / this.resolutions_[i + 1] !== zoomFactor) {\n          zoomFactor = undefined;\n          break;\n        }\n      }\n    }\n  }\n\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.zoomFactor_ = zoomFactor;\n\n\n  /**\n   * @protected\n   * @type {number}\n   */\n  this.maxZoom = this.resolutions_.length - 1;\n\n  /**\n   * @private\n   * @type {module:ol/coordinate~Coordinate}\n   */\n  this.origin_ = options.origin !== undefined ? options.origin : null;\n\n  /**\n   * @private\n   * @type {Array.<module:ol/coordinate~Coordinate>}\n   */\n  this.origins_ = null;\n  if (options.origins !== undefined) {\n    this.origins_ = options.origins;\n    assert(this.origins_.length == this.resolutions_.length,\n      20); // Number of `origins` and `resolutions` must be equal\n  }\n\n  const extent = options.extent;\n\n  if (extent !== undefined &&\n      !this.origin_ && !this.origins_) {\n    this.origin_ = getTopLeft(extent);\n  }\n\n  assert(\n    (!this.origin_ && this.origins_) || (this.origin_ && !this.origins_),\n    18); // Either `origin` or `origins` must be configured, never both\n\n  /**\n   * @private\n   * @type {Array.<number|module:ol/size~Size>}\n   */\n  this.tileSizes_ = null;\n  if (options.tileSizes !== undefined) {\n    this.tileSizes_ = options.tileSizes;\n    assert(this.tileSizes_.length == this.resolutions_.length,\n      19); // Number of `tileSizes` and `resolutions` must be equal\n  }\n\n  /**\n   * @private\n   * @type {number|module:ol/size~Size}\n   */\n  this.tileSize_ = options.tileSize !== undefined ?\n    options.tileSize :\n    !this.tileSizes_ ? DEFAULT_TILE_SIZE : null;\n  assert(\n    (!this.tileSize_ && this.tileSizes_) ||\n      (this.tileSize_ && !this.tileSizes_),\n    22); // Either `tileSize` or `tileSizes` must be configured, never both\n\n  /**\n   * @private\n   * @type {module:ol/extent~Extent}\n   */\n  this.extent_ = extent !== undefined ? extent : null;\n\n\n  /**\n   * @private\n   * @type {Array.<module:ol/TileRange>}\n   */\n  this.fullTileRanges_ = null;\n\n  /**\n   * @private\n   * @type {module:ol/size~Size}\n   */\n  this.tmpSize_ = [0, 0];\n\n  if (options.sizes !== undefined) {\n    this.fullTileRanges_ = options.sizes.map(function(size, z) {\n      const tileRange = new TileRange(\n        Math.min(0, size[0]), Math.max(size[0] - 1, -1),\n        Math.min(0, size[1]), Math.max(size[1] - 1, -1));\n      return tileRange;\n    }, this);\n  } else if (extent) {\n    this.calculateTileRanges_(extent);\n  }\n\n};\n\n\n/**\n * @private\n * @type {module:ol/tilecoord~TileCoord}\n */\nconst tmpTileCoord = [0, 0, 0];\n\n\n/**\n * Call a function with each tile coordinate for a given extent and zoom level.\n *\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} zoom Integer zoom level.\n * @param {function(module:ol/tilecoord~TileCoord)} callback Function called with each tile coordinate.\n * @api\n */\nTileGrid.prototype.forEachTileCoord = function(extent, zoom, callback) {\n  const tileRange = this.getTileRangeForExtentAndZ(extent, zoom);\n  for (let i = tileRange.minX, ii = tileRange.maxX; i <= ii; ++i) {\n    for (let j = tileRange.minY, jj = tileRange.maxY; j <= jj; ++j) {\n      callback([zoom, i, j]);\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {function(this: T, number, module:ol/TileRange): boolean} callback Callback.\n * @param {T=} opt_this The object to use as `this` in `callback`.\n * @param {module:ol/TileRange=} opt_tileRange Temporary module:ol/TileRange object.\n * @param {module:ol/extent~Extent=} opt_extent Temporary module:ol/extent~Extent object.\n * @return {boolean} Callback succeeded.\n * @template T\n */\nTileGrid.prototype.forEachTileCoordParentTileRange = function(tileCoord, callback, opt_this, opt_tileRange, opt_extent) {\n  let tileRange, x, y;\n  let tileCoordExtent = null;\n  let z = tileCoord[0] - 1;\n  if (this.zoomFactor_ === 2) {\n    x = tileCoord[1];\n    y = tileCoord[2];\n  } else {\n    tileCoordExtent = this.getTileCoordExtent(tileCoord, opt_extent);\n  }\n  while (z >= this.minZoom) {\n    if (this.zoomFactor_ === 2) {\n      x = Math.floor(x / 2);\n      y = Math.floor(y / 2);\n      tileRange = createOrUpdateTileRange(x, x, y, y, opt_tileRange);\n    } else {\n      tileRange = this.getTileRangeForExtentAndZ(tileCoordExtent, z, opt_tileRange);\n    }\n    if (callback.call(opt_this, z, tileRange)) {\n      return true;\n    }\n    --z;\n  }\n  return false;\n};\n\n\n/**\n * Get the extent for this tile grid, if it was configured.\n * @return {module:ol/extent~Extent} Extent.\n */\nTileGrid.prototype.getExtent = function() {\n  return this.extent_;\n};\n\n\n/**\n * Get the maximum zoom level for the grid.\n * @return {number} Max zoom.\n * @api\n */\nTileGrid.prototype.getMaxZoom = function() {\n  return this.maxZoom;\n};\n\n\n/**\n * Get the minimum zoom level for the grid.\n * @return {number} Min zoom.\n * @api\n */\nTileGrid.prototype.getMinZoom = function() {\n  return this.minZoom;\n};\n\n\n/**\n * Get the origin for the grid at the given zoom level.\n * @param {number} z Integer zoom level.\n * @return {module:ol/coordinate~Coordinate} Origin.\n * @api\n */\nTileGrid.prototype.getOrigin = function(z) {\n  if (this.origin_) {\n    return this.origin_;\n  } else {\n    return this.origins_[z];\n  }\n};\n\n\n/**\n * Get the resolution for the given zoom level.\n * @param {number} z Integer zoom level.\n * @return {number} Resolution.\n * @api\n */\nTileGrid.prototype.getResolution = function(z) {\n  return this.resolutions_[z];\n};\n\n\n/**\n * Get the list of resolutions for the tile grid.\n * @return {Array.<number>} Resolutions.\n * @api\n */\nTileGrid.prototype.getResolutions = function() {\n  return this.resolutions_;\n};\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/TileRange=} opt_tileRange Temporary module:ol/TileRange object.\n * @param {module:ol/extent~Extent=} opt_extent Temporary module:ol/extent~Extent object.\n * @return {module:ol/TileRange} Tile range.\n */\nTileGrid.prototype.getTileCoordChildTileRange = function(tileCoord, opt_tileRange, opt_extent) {\n  if (tileCoord[0] < this.maxZoom) {\n    if (this.zoomFactor_ === 2) {\n      const minX = tileCoord[1] * 2;\n      const minY = tileCoord[2] * 2;\n      return createOrUpdateTileRange(minX, minX + 1, minY, minY + 1, opt_tileRange);\n    }\n    const tileCoordExtent = this.getTileCoordExtent(tileCoord, opt_extent);\n    return this.getTileRangeForExtentAndZ(\n      tileCoordExtent, tileCoord[0] + 1, opt_tileRange);\n  }\n  return null;\n};\n\n\n/**\n * Get the extent for a tile range.\n * @param {number} z Integer zoom level.\n * @param {module:ol/TileRange} tileRange Tile range.\n * @param {module:ol/extent~Extent=} opt_extent Temporary module:ol/extent~Extent object.\n * @return {module:ol/extent~Extent} Extent.\n */\nTileGrid.prototype.getTileRangeExtent = function(z, tileRange, opt_extent) {\n  const origin = this.getOrigin(z);\n  const resolution = this.getResolution(z);\n  const tileSize = toSize(this.getTileSize(z), this.tmpSize_);\n  const minX = origin[0] + tileRange.minX * tileSize[0] * resolution;\n  const maxX = origin[0] + (tileRange.maxX + 1) * tileSize[0] * resolution;\n  const minY = origin[1] + tileRange.minY * tileSize[1] * resolution;\n  const maxY = origin[1] + (tileRange.maxY + 1) * tileSize[1] * resolution;\n  return createOrUpdate(minX, minY, maxX, maxY, opt_extent);\n};\n\n\n/**\n * Get a tile range for the given extent and integer zoom level.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number} z Integer zoom level.\n * @param {module:ol/TileRange=} opt_tileRange Temporary tile range object.\n * @return {module:ol/TileRange} Tile range.\n */\nTileGrid.prototype.getTileRangeForExtentAndZ = function(extent, z, opt_tileRange) {\n  const tileCoord = tmpTileCoord;\n  this.getTileCoordForXYAndZ_(extent[0], extent[1], z, false, tileCoord);\n  const minX = tileCoord[1];\n  const minY = tileCoord[2];\n  this.getTileCoordForXYAndZ_(extent[2], extent[3], z, true, tileCoord);\n  return createOrUpdateTileRange(minX, tileCoord[1], minY, tileCoord[2], opt_tileRange);\n};\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @return {module:ol/coordinate~Coordinate} Tile center.\n */\nTileGrid.prototype.getTileCoordCenter = function(tileCoord) {\n  const origin = this.getOrigin(tileCoord[0]);\n  const resolution = this.getResolution(tileCoord[0]);\n  const tileSize = toSize(this.getTileSize(tileCoord[0]), this.tmpSize_);\n  return [\n    origin[0] + (tileCoord[1] + 0.5) * tileSize[0] * resolution,\n    origin[1] + (tileCoord[2] + 0.5) * tileSize[1] * resolution\n  ];\n};\n\n\n/**\n * Get the extent of a tile coordinate.\n *\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/extent~Extent=} opt_extent Temporary extent object.\n * @return {module:ol/extent~Extent} Extent.\n * @api\n */\nTileGrid.prototype.getTileCoordExtent = function(tileCoord, opt_extent) {\n  const origin = this.getOrigin(tileCoord[0]);\n  const resolution = this.getResolution(tileCoord[0]);\n  const tileSize = toSize(this.getTileSize(tileCoord[0]), this.tmpSize_);\n  const minX = origin[0] + tileCoord[1] * tileSize[0] * resolution;\n  const minY = origin[1] + tileCoord[2] * tileSize[1] * resolution;\n  const maxX = minX + tileSize[0] * resolution;\n  const maxY = minY + tileSize[1] * resolution;\n  return createOrUpdate(minX, minY, maxX, maxY, opt_extent);\n};\n\n\n/**\n * Get the tile coordinate for the given map coordinate and resolution.  This\n * method considers that coordinates that intersect tile boundaries should be\n * assigned the higher tile coordinate.\n *\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} resolution Resolution.\n * @param {module:ol/tilecoord~TileCoord=} opt_tileCoord Destination module:ol/tilecoord~TileCoord object.\n * @return {module:ol/tilecoord~TileCoord} Tile coordinate.\n * @api\n */\nTileGrid.prototype.getTileCoordForCoordAndResolution = function(coordinate, resolution, opt_tileCoord) {\n  return this.getTileCoordForXYAndResolution_(\n    coordinate[0], coordinate[1], resolution, false, opt_tileCoord);\n};\n\n\n/**\n * Note that this method should not be called for resolutions that correspond\n * to an integer zoom level.  Instead call the `getTileCoordForXYAndZ_` method.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {number} resolution Resolution (for a non-integer zoom level).\n * @param {boolean} reverseIntersectionPolicy Instead of letting edge\n *     intersections go to the higher tile coordinate, let edge intersections\n *     go to the lower tile coordinate.\n * @param {module:ol/tilecoord~TileCoord=} opt_tileCoord Temporary module:ol/tilecoord~TileCoord object.\n * @return {module:ol/tilecoord~TileCoord} Tile coordinate.\n * @private\n */\nTileGrid.prototype.getTileCoordForXYAndResolution_ = function(\n  x, y, resolution, reverseIntersectionPolicy, opt_tileCoord) {\n  const z = this.getZForResolution(resolution);\n  const scale = resolution / this.getResolution(z);\n  const origin = this.getOrigin(z);\n  const tileSize = toSize(this.getTileSize(z), this.tmpSize_);\n\n  const adjustX = reverseIntersectionPolicy ? 0.5 : 0;\n  const adjustY = reverseIntersectionPolicy ? 0 : 0.5;\n  const xFromOrigin = Math.floor((x - origin[0]) / resolution + adjustX);\n  const yFromOrigin = Math.floor((y - origin[1]) / resolution + adjustY);\n  let tileCoordX = scale * xFromOrigin / tileSize[0];\n  let tileCoordY = scale * yFromOrigin / tileSize[1];\n\n  if (reverseIntersectionPolicy) {\n    tileCoordX = Math.ceil(tileCoordX) - 1;\n    tileCoordY = Math.ceil(tileCoordY) - 1;\n  } else {\n    tileCoordX = Math.floor(tileCoordX);\n    tileCoordY = Math.floor(tileCoordY);\n  }\n\n  return createOrUpdateTileCoord(z, tileCoordX, tileCoordY, opt_tileCoord);\n};\n\n\n/**\n * Although there is repetition between this method and `getTileCoordForXYAndResolution_`,\n * they should have separate implementations.  This method is for integer zoom\n * levels.  The other method should only be called for resolutions corresponding\n * to non-integer zoom levels.\n * @param {number} x Map x coordinate.\n * @param {number} y Map y coordinate.\n * @param {number} z Integer zoom level.\n * @param {boolean} reverseIntersectionPolicy Instead of letting edge\n *     intersections go to the higher tile coordinate, let edge intersections\n *     go to the lower tile coordinate.\n * @param {module:ol/tilecoord~TileCoord=} opt_tileCoord Temporary module:ol/tilecoord~TileCoord object.\n * @return {module:ol/tilecoord~TileCoord} Tile coordinate.\n * @private\n */\nTileGrid.prototype.getTileCoordForXYAndZ_ = function(x, y, z, reverseIntersectionPolicy, opt_tileCoord) {\n  const origin = this.getOrigin(z);\n  const resolution = this.getResolution(z);\n  const tileSize = toSize(this.getTileSize(z), this.tmpSize_);\n\n  const adjustX = reverseIntersectionPolicy ? 0.5 : 0;\n  const adjustY = reverseIntersectionPolicy ? 0 : 0.5;\n  const xFromOrigin = Math.floor((x - origin[0]) / resolution + adjustX);\n  const yFromOrigin = Math.floor((y - origin[1]) / resolution + adjustY);\n  let tileCoordX = xFromOrigin / tileSize[0];\n  let tileCoordY = yFromOrigin / tileSize[1];\n\n  if (reverseIntersectionPolicy) {\n    tileCoordX = Math.ceil(tileCoordX) - 1;\n    tileCoordY = Math.ceil(tileCoordY) - 1;\n  } else {\n    tileCoordX = Math.floor(tileCoordX);\n    tileCoordY = Math.floor(tileCoordY);\n  }\n\n  return createOrUpdateTileCoord(z, tileCoordX, tileCoordY, opt_tileCoord);\n};\n\n\n/**\n * Get a tile coordinate given a map coordinate and zoom level.\n * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\n * @param {number} z Zoom level.\n * @param {module:ol/tilecoord~TileCoord=} opt_tileCoord Destination module:ol/tilecoord~TileCoord object.\n * @return {module:ol/tilecoord~TileCoord} Tile coordinate.\n * @api\n */\nTileGrid.prototype.getTileCoordForCoordAndZ = function(coordinate, z, opt_tileCoord) {\n  return this.getTileCoordForXYAndZ_(\n    coordinate[0], coordinate[1], z, false, opt_tileCoord);\n};\n\n\n/**\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @return {number} Tile resolution.\n */\nTileGrid.prototype.getTileCoordResolution = function(tileCoord) {\n  return this.resolutions_[tileCoord[0]];\n};\n\n\n/**\n * Get the tile size for a zoom level. The type of the return value matches the\n * `tileSize` or `tileSizes` that the tile grid was configured with. To always\n * get an `module:ol/size~Size`, run the result through `module:ol/size~Size.toSize()`.\n * @param {number} z Z.\n * @return {number|module:ol/size~Size} Tile size.\n * @api\n */\nTileGrid.prototype.getTileSize = function(z) {\n  if (this.tileSize_) {\n    return this.tileSize_;\n  } else {\n    return this.tileSizes_[z];\n  }\n};\n\n\n/**\n * @param {number} z Zoom level.\n * @return {module:ol/TileRange} Extent tile range for the specified zoom level.\n */\nTileGrid.prototype.getFullTileRange = function(z) {\n  if (!this.fullTileRanges_) {\n    return null;\n  } else {\n    return this.fullTileRanges_[z];\n  }\n};\n\n\n/**\n * @param {number} resolution Resolution.\n * @param {number=} opt_direction If 0, the nearest resolution will be used.\n *     If 1, the nearest lower resolution will be used. If -1, the nearest\n *     higher resolution will be used. Default is 0.\n * @return {number} Z.\n * @api\n */\nTileGrid.prototype.getZForResolution = function(resolution, opt_direction) {\n  const z = linearFindNearest(this.resolutions_, resolution, opt_direction || 0);\n  return clamp(z, this.minZoom, this.maxZoom);\n};\n\n\n/**\n * @param {!module:ol/extent~Extent} extent Extent for this tile grid.\n * @private\n */\nTileGrid.prototype.calculateTileRanges_ = function(extent) {\n  const length = this.resolutions_.length;\n  const fullTileRanges = new Array(length);\n  for (let z = this.minZoom; z < length; ++z) {\n    fullTileRanges[z] = this.getTileRangeForExtentAndZ(extent, z);\n  }\n  this.fullTileRanges_ = fullTileRanges;\n};\nexport default TileGrid;\n","/**\n * @module ol/tilegrid\n */\nimport {DEFAULT_MAX_ZOOM, DEFAULT_TILE_SIZE} from './tilegrid/common.js';\nimport {toSize} from './size.js';\nimport {containsCoordinate, createOrUpdate, getCorner, getHeight, getWidth} from './extent.js';\nimport Corner from './extent/Corner.js';\nimport {assign} from './obj.js';\nimport {get as getProjection, METERS_PER_UNIT} from './proj.js';\nimport Units from './proj/Units.js';\nimport TileGrid from './tilegrid/TileGrid.js';\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {!module:ol/tilegrid/TileGrid} Default tile grid for the\n * passed projection.\n */\nexport function getForProjection(projection) {\n  let tileGrid = projection.getDefaultTileGrid();\n  if (!tileGrid) {\n    tileGrid = createForProjection(projection);\n    projection.setDefaultTileGrid(tileGrid);\n  }\n  return tileGrid;\n}\n\n\n/**\n * @param {module:ol/tilegrid/TileGrid} tileGrid Tile grid.\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {module:ol/tilecoord~TileCoord} Tile coordinate.\n */\nexport function wrapX(tileGrid, tileCoord, projection) {\n  const z = tileCoord[0];\n  const center = tileGrid.getTileCoordCenter(tileCoord);\n  const projectionExtent = extentFromProjection(projection);\n  if (!containsCoordinate(projectionExtent, center)) {\n    const worldWidth = getWidth(projectionExtent);\n    const worldsAway = Math.ceil((projectionExtent[0] - center[0]) / worldWidth);\n    center[0] += worldWidth * worldsAway;\n    return tileGrid.getTileCoordForCoordAndZ(center, z);\n  } else {\n    return tileCoord;\n  }\n}\n\n\n/**\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number=} opt_maxZoom Maximum zoom level (default is\n *     DEFAULT_MAX_ZOOM).\n * @param {number|module:ol/size~Size=} opt_tileSize Tile size (default uses\n *     DEFAULT_TILE_SIZE).\n * @param {module:ol/extent/Corner=} opt_corner Extent corner (default is `'top-left'`).\n * @return {!module:ol/tilegrid/TileGrid} TileGrid instance.\n */\nexport function createForExtent(extent, opt_maxZoom, opt_tileSize, opt_corner) {\n  const corner = opt_corner !== undefined ? opt_corner : Corner.TOP_LEFT;\n\n  const resolutions = resolutionsFromExtent(extent, opt_maxZoom, opt_tileSize);\n\n  return new TileGrid({\n    extent: extent,\n    origin: getCorner(extent, corner),\n    resolutions: resolutions,\n    tileSize: opt_tileSize\n  });\n}\n\n\n/**\n * @typedef {Object} XYZOptions\n * @property {module:ol/extent~Extent} [extent] Extent for the tile grid. The origin for an XYZ tile grid is the\n * top-left corner of the extent. The zero level of the grid is defined by the resolution at which one tile fits in the\n * provided extent. If not provided, the extent of the EPSG:3857 projection is used.\n * @property {number} [maxZoom] Maximum zoom. The default is `42`. This determines the number of levels\n * in the grid set. For example, a `maxZoom` of 21 means there are 22 levels in the grid set.\n * @property {number} [minZoom=0] Minimum zoom.\n * @property {number|module:ol/size~Size} [tileSize=[256, 256]] Tile size in pixels.\n */\n\n\n/**\n * Creates a tile grid with a standard XYZ tiling scheme.\n * @param {module:ol/tilegrid~XYZOptions=} opt_options Tile grid options.\n * @return {!module:ol/tilegrid/TileGrid} Tile grid instance.\n * @api\n */\nexport function createXYZ(opt_options) {\n  const options = /** @type {module:ol/tilegrid/TileGrid~Options} */ ({});\n  assign(options, opt_options !== undefined ?\n    opt_options : /** @type {module:ol/tilegrid~XYZOptions} */ ({}));\n  if (options.extent === undefined) {\n    options.extent = getProjection('EPSG:3857').getExtent();\n  }\n  options.resolutions = resolutionsFromExtent(\n    options.extent, options.maxZoom, options.tileSize);\n  delete options.maxZoom;\n\n  return new TileGrid(options);\n}\n\n\n/**\n * Create a resolutions array from an extent.  A zoom factor of 2 is assumed.\n * @param {module:ol/extent~Extent} extent Extent.\n * @param {number=} opt_maxZoom Maximum zoom level (default is\n *     DEFAULT_MAX_ZOOM).\n * @param {number|module:ol/size~Size=} opt_tileSize Tile size (default uses\n *     DEFAULT_TILE_SIZE).\n * @return {!Array.<number>} Resolutions array.\n */\nfunction resolutionsFromExtent(extent, opt_maxZoom, opt_tileSize) {\n  const maxZoom = opt_maxZoom !== undefined ?\n    opt_maxZoom : DEFAULT_MAX_ZOOM;\n\n  const height = getHeight(extent);\n  const width = getWidth(extent);\n\n  const tileSize = toSize(opt_tileSize !== undefined ?\n    opt_tileSize : DEFAULT_TILE_SIZE);\n  const maxResolution = Math.max(\n    width / tileSize[0], height / tileSize[1]);\n\n  const length = maxZoom + 1;\n  const resolutions = new Array(length);\n  for (let z = 0; z < length; ++z) {\n    resolutions[z] = maxResolution / Math.pow(2, z);\n  }\n  return resolutions;\n}\n\n\n/**\n * @param {module:ol/proj~ProjectionLike} projection Projection.\n * @param {number=} opt_maxZoom Maximum zoom level (default is\n *     DEFAULT_MAX_ZOOM).\n * @param {number|module:ol/size~Size=} opt_tileSize Tile size (default uses\n *     DEFAULT_TILE_SIZE).\n * @param {module:ol/extent/Corner=} opt_corner Extent corner (default is `'top-left'`).\n * @return {!module:ol/tilegrid/TileGrid} TileGrid instance.\n */\nexport function createForProjection(projection, opt_maxZoom, opt_tileSize, opt_corner) {\n  const extent = extentFromProjection(projection);\n  return createForExtent(extent, opt_maxZoom, opt_tileSize, opt_corner);\n}\n\n\n/**\n * Generate a tile grid extent from a projection.  If the projection has an\n * extent, it is used.  If not, a global extent is assumed.\n * @param {module:ol/proj~ProjectionLike} projection Projection.\n * @return {module:ol/extent~Extent} Extent.\n */\nexport function extentFromProjection(projection) {\n  projection = getProjection(projection);\n  let extent = projection.getExtent();\n  if (!extent) {\n    const half = 180 * METERS_PER_UNIT[Units.DEGREES] / projection.getMetersPerUnit();\n    extent = createOrUpdate(-half, -half, half, half);\n  }\n  return extent;\n}\n","/**\n * @module ol/source/Tile\n */\nimport {inherits} from '../util.js';\nimport {UNDEFINED} from '../functions.js';\nimport TileCache from '../TileCache.js';\nimport TileState from '../TileState.js';\nimport Event from '../events/Event.js';\nimport {equivalent} from '../proj.js';\nimport {toSize, scale as scaleSize} from '../size.js';\nimport Source from '../source/Source.js';\nimport {getKeyZXY, withinExtentAndZ} from '../tilecoord.js';\nimport {wrapX, getForProjection as getTileGridForProjection} from '../tilegrid.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions]\n * @property {number} [cacheSize]\n * @property {module:ol/extent~Extent} [extent]\n * @property {boolean} [opaque]\n * @property {number} [tilePixelRatio]\n * @property {module:ol/proj~ProjectionLike} [projection]\n * @property {module:ol/source/State} [state]\n * @property {module:ol/tilegrid/TileGrid} [tileGrid]\n * @property {boolean} [wrapX=true]\n * @property {number} [transition]\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for sources providing images divided into a tile grid.\n *\n * @constructor\n * @abstract\n * @extends {module:ol/source/Source}\n * @param {module:ol/source/Tile~Options=} options SourceTile source options.\n * @api\n */\nconst TileSource = function(options) {\n\n  Source.call(this, {\n    attributions: options.attributions,\n    extent: options.extent,\n    projection: options.projection,\n    state: options.state,\n    wrapX: options.wrapX\n  });\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.opaque_ = options.opaque !== undefined ? options.opaque : false;\n\n  /**\n   * @private\n   * @type {number}\n   */\n  this.tilePixelRatio_ = options.tilePixelRatio !== undefined ?\n    options.tilePixelRatio : 1;\n\n  /**\n   * @protected\n   * @type {module:ol/tilegrid/TileGrid}\n   */\n  this.tileGrid = options.tileGrid !== undefined ? options.tileGrid : null;\n\n  /**\n   * @protected\n   * @type {module:ol/TileCache}\n   */\n  this.tileCache = new TileCache(options.cacheSize);\n\n  /**\n   * @protected\n   * @type {module:ol/size~Size}\n   */\n  this.tmpSize = [0, 0];\n\n  /**\n   * @private\n   * @type {string}\n   */\n  this.key_ = '';\n\n  /**\n   * @protected\n   * @type {module:ol/Tile~Options}\n   */\n  this.tileOptions = {transition: options.transition};\n\n};\n\ninherits(TileSource, Source);\n\n\n/**\n * @return {boolean} Can expire cache.\n */\nTileSource.prototype.canExpireCache = function() {\n  return this.tileCache.canExpireCache();\n};\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {!Object.<string, module:ol/TileRange>} usedTiles Used tiles.\n */\nTileSource.prototype.expireCache = function(projection, usedTiles) {\n  const tileCache = this.getTileCacheForProjection(projection);\n  if (tileCache) {\n    tileCache.expireCache(usedTiles);\n  }\n};\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {number} z Zoom level.\n * @param {module:ol/TileRange} tileRange Tile range.\n * @param {function(module:ol/Tile):(boolean|undefined)} callback Called with each\n *     loaded tile.  If the callback returns `false`, the tile will not be\n *     considered loaded.\n * @return {boolean} The tile range is fully covered with loaded tiles.\n */\nTileSource.prototype.forEachLoadedTile = function(projection, z, tileRange, callback) {\n  const tileCache = this.getTileCacheForProjection(projection);\n  if (!tileCache) {\n    return false;\n  }\n\n  let covered = true;\n  let tile, tileCoordKey, loaded;\n  for (let x = tileRange.minX; x <= tileRange.maxX; ++x) {\n    for (let y = tileRange.minY; y <= tileRange.maxY; ++y) {\n      tileCoordKey = getKeyZXY(z, x, y);\n      loaded = false;\n      if (tileCache.containsKey(tileCoordKey)) {\n        tile = /** @type {!module:ol/Tile} */ (tileCache.get(tileCoordKey));\n        loaded = tile.getState() === TileState.LOADED;\n        if (loaded) {\n          loaded = (callback(tile) !== false);\n        }\n      }\n      if (!loaded) {\n        covered = false;\n      }\n    }\n  }\n  return covered;\n};\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {number} Gutter.\n */\nTileSource.prototype.getGutter = function(projection) {\n  return 0;\n};\n\n\n/**\n * Return the key to be used for all tiles in the source.\n * @return {string} The key for all tiles.\n * @protected\n */\nTileSource.prototype.getKey = function() {\n  return this.key_;\n};\n\n\n/**\n * Set the value to be used as the key for all tiles in the source.\n * @param {string} key The key for tiles.\n * @protected\n */\nTileSource.prototype.setKey = function(key) {\n  if (this.key_ !== key) {\n    this.key_ = key;\n    this.changed();\n  }\n};\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {boolean} Opaque.\n */\nTileSource.prototype.getOpaque = function(projection) {\n  return this.opaque_;\n};\n\n\n/**\n * @inheritDoc\n */\nTileSource.prototype.getResolutions = function() {\n  return this.tileGrid.getResolutions();\n};\n\n\n/**\n * @abstract\n * @param {number} z Tile coordinate z.\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {!module:ol/Tile} Tile.\n */\nTileSource.prototype.getTile = function(z, x, y, pixelRatio, projection) {};\n\n\n/**\n * Return the tile grid of the tile source.\n * @return {module:ol/tilegrid/TileGrid} Tile grid.\n * @api\n */\nTileSource.prototype.getTileGrid = function() {\n  return this.tileGrid;\n};\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {!module:ol/tilegrid/TileGrid} Tile grid.\n */\nTileSource.prototype.getTileGridForProjection = function(projection) {\n  if (!this.tileGrid) {\n    return getTileGridForProjection(projection);\n  } else {\n    return this.tileGrid;\n  }\n};\n\n\n/**\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {module:ol/TileCache} Tile cache.\n * @protected\n */\nTileSource.prototype.getTileCacheForProjection = function(projection) {\n  const thisProj = this.getProjection();\n  if (thisProj && !equivalent(thisProj, projection)) {\n    return null;\n  } else {\n    return this.tileCache;\n  }\n};\n\n\n/**\n * Get the tile pixel ratio for this source. Subclasses may override this\n * method, which is meant to return a supported pixel ratio that matches the\n * provided `pixelRatio` as close as possible.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Tile pixel ratio.\n */\nTileSource.prototype.getTilePixelRatio = function(pixelRatio) {\n  return this.tilePixelRatio_;\n};\n\n\n/**\n * @param {number} z Z.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @return {module:ol/size~Size} Tile size.\n */\nTileSource.prototype.getTilePixelSize = function(z, pixelRatio, projection) {\n  const tileGrid = this.getTileGridForProjection(projection);\n  const tilePixelRatio = this.getTilePixelRatio(pixelRatio);\n  const tileSize = toSize(tileGrid.getTileSize(z), this.tmpSize);\n  if (tilePixelRatio == 1) {\n    return tileSize;\n  } else {\n    return scaleSize(tileSize, tilePixelRatio, this.tmpSize);\n  }\n};\n\n\n/**\n * Returns a tile coordinate wrapped around the x-axis. When the tile coordinate\n * is outside the resolution and extent range of the tile grid, `null` will be\n * returned.\n * @param {module:ol/tilecoord~TileCoord} tileCoord Tile coordinate.\n * @param {module:ol/proj/Projection=} opt_projection Projection.\n * @return {module:ol/tilecoord~TileCoord} Tile coordinate to be passed to the tileUrlFunction or\n *     null if no tile URL should be created for the passed `tileCoord`.\n */\nTileSource.prototype.getTileCoordForTileUrlFunction = function(tileCoord, opt_projection) {\n  const projection = opt_projection !== undefined ?\n    opt_projection : this.getProjection();\n  const tileGrid = this.getTileGridForProjection(projection);\n  if (this.getWrapX() && projection.isGlobal()) {\n    tileCoord = wrapX(tileGrid, tileCoord, projection);\n  }\n  return withinExtentAndZ(tileCoord, tileGrid) ? tileCoord : null;\n};\n\n\n/**\n * @inheritDoc\n */\nTileSource.prototype.refresh = function() {\n  this.tileCache.clear();\n  this.changed();\n};\n\n\n/**\n * Marks a tile coord as being used, without triggering a load.\n * @param {number} z Tile coordinate z.\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @param {module:ol/proj/Projection} projection Projection.\n */\nTileSource.prototype.useTile = UNDEFINED;\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/source/Tile~TileSource} instances are instances of this\n * type.\n *\n * @constructor\n * @extends {module:ol/events/Event}\n * @param {string} type Type.\n * @param {module:ol/Tile} tile The tile.\n */\nexport const TileSourceEvent = function(type, tile) {\n\n  Event.call(this, type);\n\n  /**\n   * The tile related to the event.\n   * @type {module:ol/Tile}\n   * @api\n   */\n  this.tile = tile;\n\n};\ninherits(TileSourceEvent, Event);\n\nexport default TileSource;\n","/**\n * @module ol/source/TileEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n\n  /**\n   * Triggered when a tile starts loading.\n   * @event module:ol/source/Tile~TileSourceEvent#tileloadstart\n   * @api\n   */\n  TILELOADSTART: 'tileloadstart',\n\n  /**\n   * Triggered when a tile finishes loading, either when its data is loaded,\n   * or when loading was aborted because the tile is no longer needed.\n   * @event module:ol/source/Tile~TileSourceEvent#tileloadend\n   * @api\n   */\n  TILELOADEND: 'tileloadend',\n\n  /**\n   * Triggered if tile loading results in an error.\n   * @event module:ol/source/Tile~TileSourceEvent#tileloaderror\n   * @api\n   */\n  TILELOADERROR: 'tileloaderror'\n\n};\n","/**\n * @module ol/source/UrlTile\n */\nimport {getUid, inherits} from '../util.js';\nimport TileState from '../TileState.js';\nimport {expandUrl, createFromTemplates, nullTileUrlFunction} from '../tileurlfunction.js';\nimport TileSource, {TileSourceEvent} from '../source/Tile.js';\nimport TileEventType from '../source/TileEventType.js';\nimport {getKeyZXY} from '../tilecoord.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions]\n * @property {number} [cacheSize]\n * @property {module:ol/extent~Extent} [extent]\n * @property {boolean} [opaque]\n * @property {module:ol/proj~ProjectionLike} [projection]\n * @property {module:ol/source/State} [state]\n * @property {module:ol/tilegrid/TileGrid} [tileGrid]\n * @property {module:ol/Tile~LoadFunction} tileLoadFunction\n * @property {number} [tilePixelRatio]\n * @property {module:ol/Tile~UrlFunction} [tileUrlFunction]\n * @property {string} [url]\n * @property {Array.<string>} [urls]\n * @property {boolean} [wrapX=true]\n * @property {number} [transition]\n */\n\n\n/**\n * @classdesc\n * Base class for sources providing tiles divided into a tile grid over http.\n *\n * @constructor\n * @abstract\n * @fires module:ol/source/TileEvent\n * @extends {module:ol/source/Tile}\n * @param {module:ol/source/UrlTile~Options=} options Image tile options.\n */\nconst UrlTile = function(options) {\n\n  TileSource.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize,\n    extent: options.extent,\n    opaque: options.opaque,\n    projection: options.projection,\n    state: options.state,\n    tileGrid: options.tileGrid,\n    tilePixelRatio: options.tilePixelRatio,\n    wrapX: options.wrapX,\n    transition: options.transition\n  });\n\n  /**\n   * @protected\n   * @type {module:ol/Tile~LoadFunction}\n   */\n  this.tileLoadFunction = options.tileLoadFunction;\n\n  /**\n   * @protected\n   * @type {module:ol/Tile~UrlFunction}\n   */\n  this.tileUrlFunction = this.fixedTileUrlFunction ?\n    this.fixedTileUrlFunction.bind(this) : nullTileUrlFunction;\n\n  /**\n   * @protected\n   * @type {!Array.<string>|null}\n   */\n  this.urls = null;\n\n  if (options.urls) {\n    this.setUrls(options.urls);\n  } else if (options.url) {\n    this.setUrl(options.url);\n  }\n  if (options.tileUrlFunction) {\n    this.setTileUrlFunction(options.tileUrlFunction);\n  }\n\n  /**\n   * @private\n   * @type {!Object.<number, boolean>}\n   */\n  this.tileLoadingKeys_ = {};\n\n};\n\ninherits(UrlTile, TileSource);\n\n\n/**\n * @type {module:ol/Tile~UrlFunction|undefined}\n * @protected\n */\nUrlTile.prototype.fixedTileUrlFunction;\n\n/**\n * Return the tile load function of the source.\n * @return {module:ol/Tile~LoadFunction} TileLoadFunction\n * @api\n */\nUrlTile.prototype.getTileLoadFunction = function() {\n  return this.tileLoadFunction;\n};\n\n\n/**\n * Return the tile URL function of the source.\n * @return {module:ol/Tile~UrlFunction} TileUrlFunction\n * @api\n */\nUrlTile.prototype.getTileUrlFunction = function() {\n  return this.tileUrlFunction;\n};\n\n\n/**\n * Return the URLs used for this source.\n * When a tileUrlFunction is used instead of url or urls,\n * null will be returned.\n * @return {!Array.<string>|null} URLs.\n * @api\n */\nUrlTile.prototype.getUrls = function() {\n  return this.urls;\n};\n\n\n/**\n * Handle tile change events.\n * @param {module:ol/events/Event} event Event.\n * @protected\n */\nUrlTile.prototype.handleTileChange = function(event) {\n  const tile = /** @type {module:ol/Tile} */ (event.target);\n  const uid = getUid(tile);\n  const tileState = tile.getState();\n  let type;\n  if (tileState == TileState.LOADING) {\n    this.tileLoadingKeys_[uid] = true;\n    type = TileEventType.TILELOADSTART;\n  } else if (uid in this.tileLoadingKeys_) {\n    delete this.tileLoadingKeys_[uid];\n    type = tileState == TileState.ERROR ? TileEventType.TILELOADERROR :\n      (tileState == TileState.LOADED || tileState == TileState.ABORT) ?\n        TileEventType.TILELOADEND : undefined;\n  }\n  if (type != undefined) {\n    this.dispatchEvent(new TileSourceEvent(type, tile));\n  }\n};\n\n\n/**\n * Set the tile load function of the source.\n * @param {module:ol/Tile~LoadFunction} tileLoadFunction Tile load function.\n * @api\n */\nUrlTile.prototype.setTileLoadFunction = function(tileLoadFunction) {\n  this.tileCache.clear();\n  this.tileLoadFunction = tileLoadFunction;\n  this.changed();\n};\n\n\n/**\n * Set the tile URL function of the source.\n * @param {module:ol/Tile~UrlFunction} tileUrlFunction Tile URL function.\n * @param {string=} opt_key Optional new tile key for the source.\n * @api\n */\nUrlTile.prototype.setTileUrlFunction = function(tileUrlFunction, opt_key) {\n  this.tileUrlFunction = tileUrlFunction;\n  this.tileCache.pruneExceptNewestZ();\n  if (typeof opt_key !== 'undefined') {\n    this.setKey(opt_key);\n  } else {\n    this.changed();\n  }\n};\n\n\n/**\n * Set the URL to use for requests.\n * @param {string} url URL.\n * @api\n */\nUrlTile.prototype.setUrl = function(url) {\n  const urls = this.urls = expandUrl(url);\n  this.setTileUrlFunction(this.fixedTileUrlFunction ?\n    this.fixedTileUrlFunction.bind(this) :\n    createFromTemplates(urls, this.tileGrid), url);\n};\n\n\n/**\n * Set the URLs to use for requests.\n * @param {Array.<string>} urls URLs.\n * @api\n */\nUrlTile.prototype.setUrls = function(urls) {\n  this.urls = urls;\n  const key = urls.join('\\n');\n  this.setTileUrlFunction(this.fixedTileUrlFunction ?\n    this.fixedTileUrlFunction.bind(this) :\n    createFromTemplates(urls, this.tileGrid), key);\n};\n\n\n/**\n * @inheritDoc\n */\nUrlTile.prototype.useTile = function(z, x, y) {\n  const tileCoordKey = getKeyZXY(z, x, y);\n  if (this.tileCache.containsKey(tileCoordKey)) {\n    this.tileCache.get(tileCoordKey);\n  }\n};\nexport default UrlTile;\n","/**\n * @module ol/source/TileImage\n */\nimport {ENABLE_RASTER_REPROJECTION} from '../reproj/common.js';\nimport {getUid, inherits} from '../util.js';\nimport ImageTile from '../ImageTile.js';\nimport TileCache from '../TileCache.js';\nimport TileState from '../TileState.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {equivalent, get as getProjection} from '../proj.js';\nimport ReprojTile from '../reproj/Tile.js';\nimport UrlTile from '../source/UrlTile.js';\nimport {getKey, getKeyZXY} from '../tilecoord.js';\nimport {getForProjection as getTileGridForProjection} from '../tilegrid.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize=2048] Cache size.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you are using the WebGL renderer or if you want to\n * access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {boolean} [opaque=true] Whether the layer is opaque.\n * @property {module:ol/proj~ProjectionLike} projection Projection.\n * @property {boolean} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {module:ol/source/State} [state] Source state.\n * @property {module:ol/ImageTile~TileClass} [tileClass] Class used to instantiate image tiles.\n * Default is {@link module:ol/ImageTile~ImageTile}.\n * @property {module:ol/tilegrid/TileGrid} [tileGrid] Tile grid.\n * @property {module:ol/Tile~LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {number} [tilePixelRatio=1] The pixel ratio used by the tile service. For example, if the tile\n * service advertizes 256px by 256px tiles but actually sends 512px\n * by 512px images (for retina/hidpi devices) then `tilePixelRatio`\n * should be set to `2`.\n * @property {module:ol/Tile~UrlFunction} [tileUrlFunction] Optional function to get tile URL given a tile coordinate and the projection.\n * @property {string} [url] URL template. Must include `{x}`, `{y}` or `{-y}`, and `{z}` placeholders.\n * A `{?-?}` template pattern, for example `subdomain{a-f}.domain.com`, may be\n * used instead of defining each one separately in the `urls` option.\n * @property {Array.<string>} [urls] An array of URL templates.\n * @property {boolean} [wrapX] Whether to wrap the world horizontally. The default, is to\n * request out-of-bounds tiles from the server. When set to `false`, only one\n * world will be rendered. When set to `true`, tiles will be requested for one\n * world only, but they will be wrapped horizontally to render multiple worlds.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n */\n\n\n/**\n * @classdesc\n * Base class for sources providing images divided into a tile grid.\n *\n * @constructor\n * @fires module:ol/source/Tile~TileSourceEvent\n * @extends {module:ol/source/UrlTile}\n * @param {module:ol/source/TileImage~Options=} options Image tile options.\n * @api\n */\nconst TileImage = function(options) {\n\n  UrlTile.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize,\n    extent: options.extent,\n    opaque: options.opaque,\n    projection: options.projection,\n    state: options.state,\n    tileGrid: options.tileGrid,\n    tileLoadFunction: options.tileLoadFunction ?\n      options.tileLoadFunction : defaultTileLoadFunction,\n    tilePixelRatio: options.tilePixelRatio,\n    tileUrlFunction: options.tileUrlFunction,\n    url: options.url,\n    urls: options.urls,\n    wrapX: options.wrapX,\n    transition: options.transition\n  });\n\n  /**\n   * @protected\n   * @type {?string}\n   */\n  this.crossOrigin =\n      options.crossOrigin !== undefined ? options.crossOrigin : null;\n\n  /**\n   * @protected\n   * @type {function(new: module:ol/ImageTile, module:ol/tilecoord~TileCoord, module:ol/TileState, string,\n   *        ?string, module:ol/Tile~LoadFunction, module:ol/Tile~Options=)}\n   */\n  this.tileClass = options.tileClass !== undefined ?\n    options.tileClass : ImageTile;\n\n  /**\n   * @protected\n   * @type {!Object.<string, module:ol/TileCache>}\n   */\n  this.tileCacheForProjection = {};\n\n  /**\n   * @protected\n   * @type {!Object.<string, module:ol/tilegrid/TileGrid>}\n   */\n  this.tileGridForProjection = {};\n\n  /**\n   * @private\n   * @type {number|undefined}\n   */\n  this.reprojectionErrorThreshold_ = options.reprojectionErrorThreshold;\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  this.renderReprojectionEdges_ = false;\n};\n\ninherits(TileImage, UrlTile);\n\n\n/**\n * @inheritDoc\n */\nTileImage.prototype.canExpireCache = function() {\n  if (!ENABLE_RASTER_REPROJECTION) {\n    return UrlTile.prototype.canExpireCache.call(this);\n  }\n  if (this.tileCache.canExpireCache()) {\n    return true;\n  } else {\n    for (const key in this.tileCacheForProjection) {\n      if (this.tileCacheForProjection[key].canExpireCache()) {\n        return true;\n      }\n    }\n  }\n  return false;\n};\n\n\n/**\n * @inheritDoc\n */\nTileImage.prototype.expireCache = function(projection, usedTiles) {\n  if (!ENABLE_RASTER_REPROJECTION) {\n    UrlTile.prototype.expireCache.call(this, projection, usedTiles);\n    return;\n  }\n  const usedTileCache = this.getTileCacheForProjection(projection);\n\n  this.tileCache.expireCache(this.tileCache == usedTileCache ? usedTiles : {});\n  for (const id in this.tileCacheForProjection) {\n    const tileCache = this.tileCacheForProjection[id];\n    tileCache.expireCache(tileCache == usedTileCache ? usedTiles : {});\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nTileImage.prototype.getGutter = function(projection) {\n  if (ENABLE_RASTER_REPROJECTION &&\n      this.getProjection() && projection && !equivalent(this.getProjection(), projection)) {\n    return 0;\n  } else {\n    return this.getGutterInternal();\n  }\n};\n\n\n/**\n * @protected\n * @return {number} Gutter.\n */\nTileImage.prototype.getGutterInternal = function() {\n  return 0;\n};\n\n\n/**\n * @inheritDoc\n */\nTileImage.prototype.getOpaque = function(projection) {\n  if (ENABLE_RASTER_REPROJECTION &&\n      this.getProjection() && projection && !equivalent(this.getProjection(), projection)) {\n    return false;\n  } else {\n    return UrlTile.prototype.getOpaque.call(this, projection);\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nTileImage.prototype.getTileGridForProjection = function(projection) {\n  if (!ENABLE_RASTER_REPROJECTION) {\n    return UrlTile.prototype.getTileGridForProjection.call(this, projection);\n  }\n  const thisProj = this.getProjection();\n  if (this.tileGrid && (!thisProj || equivalent(thisProj, projection))) {\n    return this.tileGrid;\n  } else {\n    const projKey = getUid(projection).toString();\n    if (!(projKey in this.tileGridForProjection)) {\n      this.tileGridForProjection[projKey] = getTileGridForProjection(projection);\n    }\n    return (\n      /** @type {!module:ol/tilegrid/TileGrid} */ (this.tileGridForProjection[projKey])\n    );\n  }\n};\n\n\n/**\n * @inheritDoc\n */\nTileImage.prototype.getTileCacheForProjection = function(projection) {\n  if (!ENABLE_RASTER_REPROJECTION) {\n    return UrlTile.prototype.getTileCacheForProjection.call(this, projection);\n  }\n  const thisProj = this.getProjection(); if (!thisProj || equivalent(thisProj, projection)) {\n    return this.tileCache;\n  } else {\n    const projKey = getUid(projection).toString();\n    if (!(projKey in this.tileCacheForProjection)) {\n      this.tileCacheForProjection[projKey] = new TileCache(this.tileCache.highWaterMark);\n    }\n    return this.tileCacheForProjection[projKey];\n  }\n};\n\n\n/**\n * @param {number} z Tile coordinate z.\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @param {number} pixelRatio Pixel ratio.\n * @param {module:ol/proj/Projection} projection Projection.\n * @param {string} key The key set on the tile.\n * @return {!module:ol/Tile} Tile.\n * @private\n */\nTileImage.prototype.createTile_ = function(z, x, y, pixelRatio, projection, key) {\n  const tileCoord = [z, x, y];\n  const urlTileCoord = this.getTileCoordForTileUrlFunction(\n    tileCoord, projection);\n  const tileUrl = urlTileCoord ?\n    this.tileUrlFunction(urlTileCoord, pixelRatio, projection) : undefined;\n  const tile = new this.tileClass(\n    tileCoord,\n    tileUrl !== undefined ? TileState.IDLE : TileState.EMPTY,\n    tileUrl !== undefined ? tileUrl : '',\n    this.crossOrigin,\n    this.tileLoadFunction,\n    this.tileOptions);\n  tile.key = key;\n  listen(tile, EventType.CHANGE,\n    this.handleTileChange, this);\n  return tile;\n};\n\n\n/**\n * @inheritDoc\n */\nTileImage.prototype.getTile = function(z, x, y, pixelRatio, projection) {\n  const sourceProjection = /** @type {!module:ol/proj/Projection} */ (this.getProjection());\n  if (!ENABLE_RASTER_REPROJECTION ||\n      !sourceProjection || !projection || equivalent(sourceProjection, projection)) {\n    return this.getTileInternal(z, x, y, pixelRatio, sourceProjection || projection);\n  } else {\n    const cache = this.getTileCacheForProjection(projection);\n    const tileCoord = [z, x, y];\n    let tile;\n    const tileCoordKey = getKey(tileCoord);\n    if (cache.containsKey(tileCoordKey)) {\n      tile = /** @type {!module:ol/Tile} */ (cache.get(tileCoordKey));\n    }\n    const key = this.getKey();\n    if (tile && tile.key == key) {\n      return tile;\n    } else {\n      const sourceTileGrid = this.getTileGridForProjection(sourceProjection);\n      const targetTileGrid = this.getTileGridForProjection(projection);\n      const wrappedTileCoord =\n          this.getTileCoordForTileUrlFunction(tileCoord, projection);\n      const newTile = new ReprojTile(\n        sourceProjection, sourceTileGrid,\n        projection, targetTileGrid,\n        tileCoord, wrappedTileCoord, this.getTilePixelRatio(pixelRatio),\n        this.getGutterInternal(),\n        function(z, x, y, pixelRatio) {\n          return this.getTileInternal(z, x, y, pixelRatio, sourceProjection);\n        }.bind(this), this.reprojectionErrorThreshold_,\n        this.renderReprojectionEdges_);\n      newTile.key = key;\n\n      if (tile) {\n        newTile.interimTile = tile;\n        newTile.refreshInterimChain();\n        cache.replace(tileCoordKey, newTile);\n      } else {\n        cache.set(tileCoordKey, newTile);\n      }\n      return newTile;\n    }\n  }\n};\n\n\n/**\n * @param {number} z Tile coordinate z.\n * @param {number} x Tile coordinate x.\n * @param {number} y Tile coordinate y.\n * @param {number} pixelRatio Pixel ratio.\n * @param {!module:ol/proj/Projection} projection Projection.\n * @return {!module:ol/Tile} Tile.\n * @protected\n */\nTileImage.prototype.getTileInternal = function(z, x, y, pixelRatio, projection) {\n  let tile = null;\n  const tileCoordKey = getKeyZXY(z, x, y);\n  const key = this.getKey();\n  if (!this.tileCache.containsKey(tileCoordKey)) {\n    tile = this.createTile_(z, x, y, pixelRatio, projection, key);\n    this.tileCache.set(tileCoordKey, tile);\n  } else {\n    tile = this.tileCache.get(tileCoordKey);\n    if (tile.key != key) {\n      // The source's params changed. If the tile has an interim tile and if we\n      // can use it then we use it. Otherwise we create a new tile.  In both\n      // cases we attempt to assign an interim tile to the new tile.\n      const interimTile = tile;\n      tile = this.createTile_(z, x, y, pixelRatio, projection, key);\n\n      //make the new tile the head of the list,\n      if (interimTile.getState() == TileState.IDLE) {\n        //the old tile hasn't begun loading yet, and is now outdated, so we can simply discard it\n        tile.interimTile = interimTile.interimTile;\n      } else {\n        tile.interimTile = interimTile;\n      }\n      tile.refreshInterimChain();\n      this.tileCache.replace(tileCoordKey, tile);\n    }\n  }\n  return tile;\n};\n\n\n/**\n * Sets whether to render reprojection edges or not (usually for debugging).\n * @param {boolean} render Render the edges.\n * @api\n */\nTileImage.prototype.setRenderReprojectionEdges = function(render) {\n  if (!ENABLE_RASTER_REPROJECTION ||\n      this.renderReprojectionEdges_ == render) {\n    return;\n  }\n  this.renderReprojectionEdges_ = render;\n  for (const id in this.tileCacheForProjection) {\n    this.tileCacheForProjection[id].clear();\n  }\n  this.changed();\n};\n\n\n/**\n * Sets the tile grid to use when reprojecting the tiles to the given\n * projection instead of the default tile grid for the projection.\n *\n * This can be useful when the default tile grid cannot be created\n * (e.g. projection has no extent defined) or\n * for optimization reasons (custom tile size, resolutions, ...).\n *\n * @param {module:ol/proj~ProjectionLike} projection Projection.\n * @param {module:ol/tilegrid/TileGrid} tilegrid Tile grid to use for the projection.\n * @api\n */\nTileImage.prototype.setTileGridForProjection = function(projection, tilegrid) {\n  if (ENABLE_RASTER_REPROJECTION) {\n    const proj = getProjection(projection);\n    if (proj) {\n      const projKey = getUid(proj).toString();\n      if (!(projKey in this.tileGridForProjection)) {\n        this.tileGridForProjection[projKey] = tilegrid;\n      }\n    }\n  }\n};\n\n\n/**\n * @param {module:ol/ImageTile} imageTile Image tile.\n * @param {string} src Source.\n */\nfunction defaultTileLoadFunction(imageTile, src) {\n  imageTile.getImage().src = src;\n}\n\nexport default TileImage;\n","/**\n * @module ol/source/XYZ\n */\nimport {inherits} from '../util.js';\nimport TileImage from '../source/TileImage.js';\nimport {createXYZ, extentFromProjection} from '../tilegrid.js';\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize=2048] Cache size.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you are using the WebGL renderer or if you want to\n * access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {boolean} [opaque=true] Whether the layer is opaque.\n * @property {module:ol/proj~ProjectionLike} [projection='EPSG:3857'] Projection.\n * @property {boolean} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {number} [maxZoom=18] Optional max zoom level.\n * @property {number} [minZoom=0] Optional min zoom level.\n * @property {module:ol/tilegrid/TileGrid} [tileGrid] Tile grid.\n * @property {module:ol/Tile~LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {number} [tilePixelRatio=1] The pixel ratio used by the tile service.\n * For example, if the tile service advertizes 256px by 256px tiles but actually sends 512px\n * by 512px images (for retina/hidpi devices) then `tilePixelRatio`\n * should be set to `2`.\n * @property {number|module:ol/size~Size} [tileSize=[256, 256]] The tile size used by the tile service.\n * @property {module:ol/Tile~UrlFunction} [tileUrlFunction] Optional function to get\n * tile URL given a tile coordinate and the projection.\n * Required if url or urls are not provided.\n * @property {string} [url] URL template. Must include `{x}`, `{y}` or `{-y}`,\n * and `{z}` placeholders. A `{?-?}` template pattern, for example `subdomain{a-f}.domain.com`,\n * may be used instead of defining each one separately in the `urls` option.\n * @property {Array.<string>} [urls] An array of URL templates.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n */\n\n\n/**\n * @classdesc\n * Layer source for tile data with URLs in a set XYZ format that are\n * defined in a URL template. By default, this follows the widely-used\n * Google grid where `x` 0 and `y` 0 are in the top left. Grids like\n * TMS where `x` 0 and `y` 0 are in the bottom left can be used by\n * using the `{-y}` placeholder in the URL template, so long as the\n * source does not have a custom tile grid. In this case,\n * {@link module:ol/source/TileImage} can be used with a `tileUrlFunction`\n * such as:\n *\n *  tileUrlFunction: function(coordinate) {\n *    return 'http://mapserver.com/' + coordinate[0] + '/' +\n *        coordinate[1] + '/' + coordinate[2] + '.png';\n *    }\n *\n *\n * @constructor\n * @extends {module:ol/source/TileImage}\n * @param {module:ol/source/XYZ~Options=} opt_options XYZ options.\n * @api\n */\nconst XYZ = function(opt_options) {\n  const options = opt_options || {};\n  const projection = options.projection !== undefined ?\n    options.projection : 'EPSG:3857';\n\n  const tileGrid = options.tileGrid !== undefined ? options.tileGrid :\n    createXYZ({\n      extent: extentFromProjection(projection),\n      maxZoom: options.maxZoom,\n      minZoom: options.minZoom,\n      tileSize: options.tileSize\n    });\n\n  TileImage.call(this, {\n    attributions: options.attributions,\n    cacheSize: options.cacheSize,\n    crossOrigin: options.crossOrigin,\n    opaque: options.opaque,\n    projection: projection,\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    tileGrid: tileGrid,\n    tileLoadFunction: options.tileLoadFunction,\n    tilePixelRatio: options.tilePixelRatio,\n    tileUrlFunction: options.tileUrlFunction,\n    url: options.url,\n    urls: options.urls,\n    wrapX: options.wrapX !== undefined ? options.wrapX : true,\n    transition: options.transition\n  });\n\n};\n\ninherits(XYZ, TileImage);\nexport default XYZ;\n","/**\n * @module ol/source/OSM\n */\nimport {inherits} from '../util.js';\nimport XYZ from '../source/XYZ.js';\n\n\n/**\n * The attribution containing a link to the OpenStreetMap Copyright and License\n * page.\n * @const\n * @type {string}\n * @api\n */\nexport const ATTRIBUTION = '&copy; ' +\n      '<a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> ' +\n      'contributors.';\n\n\n/**\n * @typedef {Object} Options\n * @property {module:ol/source/Source~AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize=2048] Cache size.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you are using the WebGL renderer or if you want to\n * access pixel data with the Canvas renderer.  See\n * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image} for more detail.\n * @property {number} [maxZoom=19] Max zoom.\n * @property {boolean} [opaque=true] Whether the layer is opaque.\n * @property {number} [reprojectionErrorThreshold=1.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {module:ol/Tile~LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {string} [url='https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png'] URL template.\n * Must include `{x}`, `{y}` or `{-y}`, and `{z}` placeholders.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n */\n\n\n/**\n * @classdesc\n * Layer source for the OpenStreetMap tile server.\n *\n * @constructor\n * @extends {module:ol/source/XYZ}\n * @param {module:ol/source/OSM~Options=} [opt_options] Open Street Map options.\n * @api\n */\nconst OSM = function(opt_options) {\n\n  const options = opt_options || {};\n\n  let attributions;\n  if (options.attributions !== undefined) {\n    attributions = options.attributions;\n  } else {\n    attributions = [ATTRIBUTION];\n  }\n\n  const crossOrigin = options.crossOrigin !== undefined ?\n    options.crossOrigin : 'anonymous';\n\n  const url = options.url !== undefined ?\n    options.url : 'https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png';\n\n  XYZ.call(this, {\n    attributions: attributions,\n    cacheSize: options.cacheSize,\n    crossOrigin: crossOrigin,\n    opaque: options.opaque !== undefined ? options.opaque : true,\n    maxZoom: options.maxZoom !== undefined ? options.maxZoom : 19,\n    reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n    tileLoadFunction: options.tileLoadFunction,\n    url: url,\n    wrapX: options.wrapX\n  });\n\n};\n\ninherits(OSM, XYZ);\n\nexport default OSM;\n","import 'ol/ol.css';\nimport {Map, View} from 'ol';\nimport TileLayer from 'ol/layer/Tile';\nimport OSM from 'ol/source/OSM';\n\nconst map = new Map({\n  target: 'map',\n  layers: [\n    new TileLayer({\n      source: new OSM()\n    })\n  ],\n  view: new View({\n    center: [0, 0],\n    zoom: 0\n  })\n});","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n"]}